{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/codemirror/addon/fold/brace-fold.js","webpack:///./node_modules/codemirror/addon/fold/foldcode.js","webpack:///./node_modules/codemirror/addon/fold/foldgutter.css?4604","webpack:///./node_modules/codemirror/addon/fold/foldgutter.js","webpack:///./node_modules/codemirror/addon/lint/lint.css?8e7d","webpack:///./node_modules/codemirror/addon/lint/lint.js","webpack:///./node_modules/codemirror/lib/codemirror.css?00fd","webpack:///./node_modules/codemirror/lib/codemirror.js","webpack:///./node_modules/codemirror/mode/javascript/javascript.js","webpack:///./node_modules/gl-matrix/esm/common.js","webpack:///./node_modules/gl-matrix/esm/index.js","webpack:///./node_modules/gl-matrix/esm/mat2.js","webpack:///./node_modules/gl-matrix/esm/mat2d.js","webpack:///./node_modules/gl-matrix/esm/mat3.js","webpack:///./node_modules/gl-matrix/esm/mat4.js","webpack:///./node_modules/gl-matrix/esm/quat.js","webpack:///./node_modules/gl-matrix/esm/quat2.js","webpack:///./node_modules/gl-matrix/esm/vec2.js","webpack:///./node_modules/gl-matrix/esm/vec3.js","webpack:///./node_modules/gl-matrix/esm/vec4.js","webpack:///./node_modules/glsl-editor/glsl.js","webpack:///./node_modules/lodash/_Symbol.js","webpack:///./node_modules/lodash/_baseGetTag.js","webpack:///./node_modules/lodash/_freeGlobal.js","webpack:///./node_modules/lodash/_getRawTag.js","webpack:///./node_modules/lodash/_objectToString.js","webpack:///./node_modules/lodash/_root.js","webpack:///./node_modules/lodash/debounce.js","webpack:///./node_modules/lodash/isObject.js","webpack:///./node_modules/lodash/isObjectLike.js","webpack:///./node_modules/lodash/isSymbol.js","webpack:///./node_modules/lodash/now.js","webpack:///./node_modules/lodash/throttle.js","webpack:///./node_modules/lodash/toNumber.js","webpack:///./node_modules/resize-observer-polyfill/dist/ResizeObserver.es.js","webpack:///(webpack)/buildin/global.js","webpack:///./src/main.ts","webpack:///./src/neuroglancer/annotation/annotation_layer_state.ts","webpack:///./src/neuroglancer/annotation/base.ts","webpack:///./src/neuroglancer/annotation/bounding_box.ts","webpack:///./src/neuroglancer/annotation/ellipsoid.ts","webpack:///./src/neuroglancer/annotation/frontend.ts","webpack:///./src/neuroglancer/annotation/frontend_source.ts","webpack:///./src/neuroglancer/annotation/index.ts","webpack:///./src/neuroglancer/annotation/line.ts","webpack:///./src/neuroglancer/annotation/point.ts","webpack:///./src/neuroglancer/annotation/renderlayer.ts","webpack:///./src/neuroglancer/annotation/selection.ts","webpack:///./src/neuroglancer/annotation/type_handler.ts","webpack:///./src/neuroglancer/annotation/user_layer.css?fb54","webpack:///./src/neuroglancer/annotation/user_layer.ts","webpack:///./src/neuroglancer/axes_lines.ts","webpack:///./src/neuroglancer/chunk_manager/base.ts","webpack:///./src/neuroglancer/chunk_manager/frontend.ts","webpack:///./src/neuroglancer/coordinate_transform.ts","webpack:///./src/neuroglancer/credentials_provider/chunk_source_frontend.ts","webpack:///./src/neuroglancer/credentials_provider/default_manager.ts","webpack:///./src/neuroglancer/credentials_provider/http_request.ts","webpack:///./src/neuroglancer/credentials_provider/index.ts","webpack:///./src/neuroglancer/credentials_provider/shared.ts","webpack:///./src/neuroglancer/credentials_provider/shared_common.ts","webpack:///./src/neuroglancer/data_panel_layout.css?acdd","webpack:///./src/neuroglancer/data_panel_layout.ts","webpack:///./src/neuroglancer/datasource/boss/api.ts","webpack:///./src/neuroglancer/datasource/boss/base.ts","webpack:///./src/neuroglancer/datasource/boss/credentials_provider.ts","webpack:///./src/neuroglancer/datasource/boss/frontend.ts","webpack:///./src/neuroglancer/datasource/boss/register_credentials_provider.ts","webpack:///./src/neuroglancer/datasource/boss/register_default.ts","webpack:///./src/neuroglancer/datasource/brainmaps/api.ts","webpack:///./src/neuroglancer/datasource/brainmaps/base.ts","webpack:///./src/neuroglancer/datasource/brainmaps/credentials_provider.ts","webpack:///./src/neuroglancer/datasource/brainmaps/frontend.ts","webpack:///./src/neuroglancer/datasource/brainmaps/register_credentials_provider.ts","webpack:///./src/neuroglancer/datasource/brainmaps/register_default.ts","webpack:///./src/neuroglancer/datasource/computed/base.ts","webpack:///./src/neuroglancer/datasource/computed/example/base.ts","webpack:///./src/neuroglancer/datasource/computed/example/frontend.ts","webpack:///./src/neuroglancer/datasource/computed/example/register_default.ts","webpack:///./src/neuroglancer/datasource/computed/frontend.ts","webpack:///./src/neuroglancer/datasource/computed/register_default.ts","webpack:///./src/neuroglancer/datasource/computed/tensorflow/base.ts","webpack:///./src/neuroglancer/datasource/computed/tensorflow/frontend.ts","webpack:///./src/neuroglancer/datasource/computed/tensorflow/register_default.ts","webpack:///./src/neuroglancer/datasource/default_provider.ts","webpack:///./src/neuroglancer/datasource/dvid/base.ts","webpack:///./src/neuroglancer/datasource/dvid/frontend.ts","webpack:///./src/neuroglancer/datasource/dvid/register_default.ts","webpack:///./src/neuroglancer/datasource/index.ts","webpack:///./src/neuroglancer/datasource/n5/base.ts","webpack:///./src/neuroglancer/datasource/n5/frontend.ts","webpack:///./src/neuroglancer/datasource/n5/register_default.ts","webpack:///./src/neuroglancer/datasource/nifti/base.ts","webpack:///./src/neuroglancer/datasource/nifti/frontend.ts","webpack:///./src/neuroglancer/datasource/nifti/register_default.ts","webpack:///./src/neuroglancer/datasource/precomputed/base.ts","webpack:///./src/neuroglancer/datasource/precomputed/frontend.ts","webpack:///./src/neuroglancer/datasource/precomputed/register_default.ts","webpack:///./src/neuroglancer/datasource/render/base.ts","webpack:///./src/neuroglancer/datasource/render/frontend.ts","webpack:///./src/neuroglancer/datasource/render/register_default.ts","webpack:///./src/neuroglancer/display_context.ts","webpack:///./src/neuroglancer/gpu_hash/hash_function.ts","webpack:///./src/neuroglancer/gpu_hash/hash_table.ts","webpack:///./src/neuroglancer/gpu_hash/shader.ts","webpack:///./src/neuroglancer/help/input_event_bindings.css?e5ca","webpack:///./src/neuroglancer/help/input_event_bindings.ts","webpack:///./src/neuroglancer/image_user_layer.css?2d35","webpack:///./src/neuroglancer/image_user_layer.ts","webpack:///./src/neuroglancer/layer.ts","webpack:///./src/neuroglancer/layer_dialog.css?dc11","webpack:///./src/neuroglancer/layer_dialog.ts","webpack:///./src/neuroglancer/layer_group_viewer.css?b175","webpack:///./src/neuroglancer/layer_group_viewer.ts","webpack:///./src/neuroglancer/layer_groups_layout.css?1a66","webpack:///./src/neuroglancer/layer_groups_layout.ts","webpack:///./src/neuroglancer/layer_panel.css?6b0a","webpack:///./src/neuroglancer/layer_panel.ts","webpack:///./src/neuroglancer/layer_specification.ts","webpack:///./src/neuroglancer/layout.ts","webpack:///./src/neuroglancer/maximize_button.css?3a43","webpack:///./src/neuroglancer/mesh/base.ts","webpack:///./src/neuroglancer/mesh/frontend.ts","webpack:///./src/neuroglancer/mesh/multiscale.ts","webpack:///./src/neuroglancer/navigation_state.ts","webpack:///./src/neuroglancer/noselect.css?b64e","webpack:///./src/neuroglancer/object_picking.ts","webpack:///./src/neuroglancer/overlay.css?f981","webpack:///./src/neuroglancer/overlay.ts","webpack:///./src/neuroglancer/perspective_view/base.ts","webpack:///./src/neuroglancer/perspective_view/panel.css?a7e6","webpack:///./src/neuroglancer/perspective_view/panel.ts","webpack:///./src/neuroglancer/perspective_view/render_layer.ts","webpack:///./src/neuroglancer/render_scale_statistics.ts","webpack:///./src/neuroglancer/rendered_data_panel.css?c27f","webpack:///./src/neuroglancer/rendered_data_panel.ts","webpack:///./src/neuroglancer/segment_color.ts","webpack:///./src/neuroglancer/segmentation_display_state/base.ts","webpack:///./src/neuroglancer/segmentation_display_state/frontend.ts","webpack:///./src/neuroglancer/segmentation_user_layer.css?c290","webpack:///./src/neuroglancer/segmentation_user_layer.ts","webpack:///./src/neuroglancer/shared_disjoint_sets.ts","webpack:///./src/neuroglancer/shared_watchable_value.ts","webpack:///./src/neuroglancer/single_mesh/base.ts","webpack:///./src/neuroglancer/single_mesh/frontend.ts","webpack:///./src/neuroglancer/single_mesh_user_layer.css?c39b","webpack:///./src/neuroglancer/single_mesh_user_layer.ts","webpack:///./src/neuroglancer/skeleton/base.ts","webpack:///./src/neuroglancer/skeleton/frontend.ts","webpack:///./src/neuroglancer/sliceview/base.ts","webpack:///./src/neuroglancer/sliceview/bounding_box_shader_helper.ts","webpack:///./src/neuroglancer/sliceview/chunk_format_handlers.ts","webpack:///./src/neuroglancer/sliceview/chunk_layout.ts","webpack:///./src/neuroglancer/sliceview/compressed_segmentation/chunk_format.ts","webpack:///./src/neuroglancer/sliceview/compressed_segmentation/decode_common.ts","webpack:///./src/neuroglancer/sliceview/compressed_segmentation/decode_uint32.ts","webpack:///./src/neuroglancer/sliceview/compressed_segmentation/decode_uint64.ts","webpack:///./src/neuroglancer/sliceview/frontend.ts","webpack:///./src/neuroglancer/sliceview/panel.ts","webpack:///./src/neuroglancer/sliceview/renderlayer.ts","webpack:///./src/neuroglancer/sliceview/single_texture_chunk_format.ts","webpack:///./src/neuroglancer/sliceview/uncompressed_chunk_format.ts","webpack:///./src/neuroglancer/sliceview/vector_graphics/base.ts","webpack:///./src/neuroglancer/sliceview/vector_graphics/frontend.ts","webpack:///./src/neuroglancer/sliceview/vector_graphics/vector_graphics_line_renderlayer.ts","webpack:///./src/neuroglancer/sliceview/volume/base.ts","webpack:///./src/neuroglancer/sliceview/volume/frontend.ts","webpack:///./src/neuroglancer/sliceview/volume/image_renderlayer.ts","webpack:///./src/neuroglancer/sliceview/volume/renderlayer.ts","webpack:///./src/neuroglancer/sliceview/volume/segmentation_renderlayer.ts","webpack:///./src/neuroglancer/status.css?5ce3","webpack:///./src/neuroglancer/status.ts","webpack:///./src/neuroglancer/trackable_alpha.ts","webpack:///./src/neuroglancer/trackable_blend.ts","webpack:///./src/neuroglancer/trackable_boolean.ts","webpack:///./src/neuroglancer/trackable_finite_float.ts","webpack:///./src/neuroglancer/trackable_value.ts","webpack:///./src/neuroglancer/trackable_vec3.ts","webpack:///./src/neuroglancer/ui/annotations.css?b609","webpack:///./src/neuroglancer/ui/annotations.ts","webpack:///./src/neuroglancer/ui/button.css?096a","webpack:///./src/neuroglancer/ui/context_menu.css?928f","webpack:///./src/neuroglancer/ui/context_menu.ts","webpack:///./src/neuroglancer/ui/default_clipboard_handling.ts","webpack:///./src/neuroglancer/ui/default_input_event_bindings.ts","webpack:///./src/neuroglancer/ui/default_viewer.css?47d7","webpack:///./src/neuroglancer/ui/default_viewer.ts","webpack:///./src/neuroglancer/ui/default_viewer_setup.ts","webpack:///./src/neuroglancer/ui/disable_default_actions.ts","webpack:///./src/neuroglancer/ui/drag_resize.css?dfe8","webpack:///./src/neuroglancer/ui/drag_resize.ts","webpack:///./src/neuroglancer/ui/layer_drag_and_drop.ts","webpack:///./src/neuroglancer/ui/layer_side_panel.css?5e3c","webpack:///./src/neuroglancer/ui/layer_side_panel.ts","webpack:///./src/neuroglancer/ui/minimal_viewer.ts","webpack:///./src/neuroglancer/ui/mouse_selection_state_tooltip.css?7346","webpack:///./src/neuroglancer/ui/mouse_selection_state_tooltip.ts","webpack:///./src/neuroglancer/ui/position_drag_and_drop.ts","webpack:///./src/neuroglancer/ui/state_editor.css?de1f","webpack:///./src/neuroglancer/ui/state_editor.ts","webpack:///./src/neuroglancer/ui/statistics.css?ee00","webpack:///./src/neuroglancer/ui/statistics.ts","webpack:///./src/neuroglancer/ui/tool.ts","webpack:///./src/neuroglancer/ui/url_hash_binding.ts","webpack:///./src/neuroglancer/uint64_map.ts","webpack:///./src/neuroglancer/uint64_set.ts","webpack:///./src/neuroglancer/user_layer_with_coordinate_transform.ts","webpack:///./src/neuroglancer/user_layer_with_volume_source.ts","webpack:///./src/neuroglancer/util/animation_frame_debounce.ts","webpack:///./src/neuroglancer/util/array.ts","webpack:///./src/neuroglancer/util/automatic_focus.ts","webpack:///./src/neuroglancer/util/cancellation.ts","webpack:///./src/neuroglancer/util/clipboard.ts","webpack:///./src/neuroglancer/util/color.ts","webpack:///./src/neuroglancer/util/colorspace.ts","webpack:///./src/neuroglancer/util/compare.ts","webpack:///./src/neuroglancer/util/completion.ts","webpack:///./src/neuroglancer/util/data_type.ts","webpack:///./src/neuroglancer/util/disjoint_sets.ts","webpack:///./src/neuroglancer/util/disposable.ts","webpack:///./src/neuroglancer/util/dom.ts","webpack:///./src/neuroglancer/util/drag_and_drop.ts","webpack:///./src/neuroglancer/util/dropdown.ts","webpack:///./src/neuroglancer/util/event_action_map.ts","webpack:///./src/neuroglancer/util/float32_to_string.ts","webpack:///./src/neuroglancer/util/geom.ts","webpack:///./src/neuroglancer/util/google_oauth2.ts","webpack:///./src/neuroglancer/util/hex.ts","webpack:///./src/neuroglancer/util/hierarchical_map.ts","webpack:///./src/neuroglancer/util/http_request.ts","webpack:///./src/neuroglancer/util/json.ts","webpack:///./src/neuroglancer/util/keyboard_bindings.ts","webpack:///./src/neuroglancer/util/linked_list.0.ts","webpack:///./src/neuroglancer/util/longest_common_prefix.ts","webpack:///./src/neuroglancer/util/memoize.ts","webpack:///./src/neuroglancer/util/mouse_bindings.ts","webpack:///./src/neuroglancer/util/mouse_drag.ts","webpack:///./src/neuroglancer/util/number_to_string.ts","webpack:///./src/neuroglancer/util/object_id.ts","webpack:///./src/neuroglancer/util/random.ts","webpack:///./src/neuroglancer/util/scroll_into_view.ts","webpack:///./src/neuroglancer/util/signal.ts","webpack:///./src/neuroglancer/util/signal_binding_updater.ts","webpack:///./src/neuroglancer/util/spatial_units.ts","webpack:///./src/neuroglancer/util/touch_bindings.ts","webpack:///./src/neuroglancer/util/trackable.ts","webpack:///./src/neuroglancer/util/trackable_enum.ts","webpack:///./src/neuroglancer/util/uint64.ts","webpack:///./src/neuroglancer/util/watchable_map.ts","webpack:///./src/neuroglancer/util/wheel_zoom.ts","webpack:///./src/neuroglancer/util/zorder.ts","webpack:///./src/neuroglancer/vector_graphics_user_layer.ts","webpack:///./src/neuroglancer/viewer.css?76e8","webpack:///./src/neuroglancer/viewer.ts","webpack:///./src/neuroglancer/visibility_priority/frontend.ts","webpack:///./src/neuroglancer/webgl/buffer.ts","webpack:///./src/neuroglancer/webgl/circles.ts","webpack:///./src/neuroglancer/webgl/colormaps.ts","webpack:///./src/neuroglancer/webgl/context.ts","webpack:///./src/neuroglancer/webgl/dynamic_shader.ts","webpack:///./src/neuroglancer/webgl/ellipse.ts","webpack:///./src/neuroglancer/webgl/index_emulation.ts","webpack:///./src/neuroglancer/webgl/lines.ts","webpack:///./src/neuroglancer/webgl/offscreen.ts","webpack:///./src/neuroglancer/webgl/quad.ts","webpack:///./src/neuroglancer/webgl/shader.ts","webpack:///./src/neuroglancer/webgl/shader_lib.ts","webpack:///./src/neuroglancer/webgl/shader_ui_controls.ts","webpack:///./src/neuroglancer/webgl/spheres.ts","webpack:///./src/neuroglancer/webgl/square_corners_buffer.ts","webpack:///./src/neuroglancer/webgl/texture.ts","webpack:///./src/neuroglancer/webgl/texture_access.ts","webpack:///./src/neuroglancer/webgl/trivial_shaders.ts","webpack:///./src/neuroglancer/widget/annotation_tool_status.css?3855","webpack:///./src/neuroglancer/widget/annotation_tool_status.ts","webpack:///./src/neuroglancer/widget/associate_label.ts","webpack:///./src/neuroglancer/widget/autocomplete.css?e47a","webpack:///./src/neuroglancer/widget/autocomplete.ts","webpack:///./src/neuroglancer/widget/close_button.ts","webpack:///./src/neuroglancer/widget/color.ts","webpack:///./src/neuroglancer/widget/coordinate_transform.css?0eee","webpack:///./src/neuroglancer/widget/coordinate_transform.ts","webpack:///./src/neuroglancer/widget/enum_widget.ts","webpack:///./src/neuroglancer/widget/hidden_submit_button.ts","webpack:///./src/neuroglancer/widget/layer_reference.ts","webpack:///./src/neuroglancer/widget/number_input_widget.ts","webpack:///./src/neuroglancer/widget/position_widget.css?abd9","webpack:///./src/neuroglancer/widget/position_widget.ts","webpack:///./src/neuroglancer/widget/range.css?3d96","webpack:///./src/neuroglancer/widget/range.ts","webpack:///./src/neuroglancer/widget/render_scale_widget.css?474e","webpack:///./src/neuroglancer/widget/render_scale_widget.ts","webpack:///./src/neuroglancer/widget/scale_bar.ts","webpack:///./src/neuroglancer/widget/segment_set_widget.css?29b2","webpack:///./src/neuroglancer/widget/segment_set_widget.ts","webpack:///./src/neuroglancer/widget/shader_code_widget.css?b3f5","webpack:///./src/neuroglancer/widget/shader_code_widget.ts","webpack:///./src/neuroglancer/widget/shader_controls.ts","webpack:///./src/neuroglancer/widget/tab_view.css?a495","webpack:///./src/neuroglancer/widget/tab_view.ts","webpack:///./src/neuroglancer/widget/text_icon_button.css?ea0a","webpack:///./src/neuroglancer/widget/text_icon_button.ts","webpack:///./src/neuroglancer/widget/tooltip.css?c785","webpack:///./src/neuroglancer/widget/tooltip.ts","webpack:///./src/neuroglancer/widget/uint64_entry_widget.css?65c9","webpack:///./src/neuroglancer/widget/uint64_entry_widget.ts","webpack:///./src/neuroglancer/widget/vec3.css?40c1","webpack:///./src/neuroglancer/widget/vec3_entry_widget.ts","webpack:///./src/neuroglancer/worker_rpc.ts"],"names":[],"mappings":";AAAA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,gBAAQ,oBAAoB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA,iDAAyC,8BAA8B;AACvE;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA,yCAAiC;;AAEjC;AACA;AACA;AACA,aAAK;AACL;AACA;AACA;AACA,cAAM;AACN;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAwB,kCAAkC;AAC1D,cAAM;AACN;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA,kDAA0C,oBAAoB,WAAW;;AAEzE;AACA;AACA;AACA;AACA,wBAAgB,uBAAuB;AACvC;;;AAGA;AACA;;;;;;;;;;;;AClMA;AACA;;AAEA;AACA,MAAM,IAAuD;AAC7D,QAAQ,mBAAO,CAAC,yEAAsB;AACtC,OAAO,EAGa;AACpB,CAAC;AACD;;AAEA;AACA;AACA;;AAEA;AACA,sCAAsC;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,qBAAqB,gBAAgB,2BAA2B;AAChE;AACA;AACA;AACA;;AAEA;AACA;AACA,2BAA2B,eAAe;AAC1C;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,SAAS,aAAa,aAAa;AAC/D;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D,QAAQ;AACtE,sDAAsD;AACtD,8BAA8B;AAC9B;AACA;;AAEA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA,UAAU;AACV,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA,UAAU;AACV;AACA,CAAC;;AAED,CAAC;;;;;;;;;;;;ACxGD;AACA;;AAEA;AACA,MAAM,IAAuD;AAC7D,QAAQ,mBAAO,CAAC,yEAAsB;AACtC,OAAO,EAGa;AACpB,CAAC;AACD;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,qBAAqB,kBAAkB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA,8BAA8B,kBAAkB,yCAAyC,EAAE;AAC3F;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA,mBAAmB,kBAAkB;AACrC;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD,QAAQ;AAC7D;AACA,KAAK;AACL;AACA;AACA;AACA,qDAAqD,QAAQ;AAC7D;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA,qBAAqB,kBAAkB;AACvC;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA,mBAAmB,oBAAoB;AACvC;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH,CAAC;;;;;;;;;;;;ACvJD,uC;;;;;;;;;;;ACAA;AACA;;AAEA;AACA,MAAM,IAAuD;AAC7D,QAAQ,mBAAO,CAAC,yEAAsB,GAAG,mBAAO,CAAC,oEAAY;AAC7D,OAAO,EAGa;AACpB,CAAC;AACD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,mBAAmB,kBAAkB;AACrC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,yBAAyB;AACzB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,sBAAsB,EAAE;AACxE;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;;;;;;;;;;ACjJD,uC;;;;;;;;;;;ACAA;AACA;;AAEA;AACA,MAAM,IAAuD;AAC7D,QAAQ,mBAAO,CAAC,yEAAsB;AACtC,OAAO,EAGa;AACpB,CAAC;AACD;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,QAAQ,EAAE;AACrC;;AAEA;AACA;AACA;AACA;AACA,oBAAoB,sBAAsB,gBAAgB;AAC1D;AACA;AACA,sCAAsC;AACtC;AACA;AACA,iBAAiB,QAAQ,OAAO;AAChC;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oCAAoC,oBAAoB;AACxD;AACA;;AAEA;AACA,6CAA6C;AAC7C;AACA;AACA;;AAEA;AACA;AACA;AACA,mBAAmB,yBAAyB;AAC5C;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,mBAAmB,wBAAwB;AAC3C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,+BAA+B;AAC9D,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,iCAAiC,0BAA0B;AAC3D,OAAO;AACP,oCAAoC,+BAA+B;AACnE;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,sBAAsB,2BAA2B;AACjD;AACA;;AAEA;AACA;;AAEA,qBAAqB,iBAAiB;AACtC;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,0CAA0C,kBAAkB;AAC5D;;AAEA;AACA;AACA;AACA,mBAAmB,wBAAwB;AAC3C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,8CAA8C,gBAAgB;;AAE9D;AACA,mBAAmB,kBAAkB;AACrC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,qBAAqB,oBAAoB;AACzC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;AACH,CAAC;;;;;;;;;;;;AC3PD,uC;;;;;;;;;;;ACAA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,EAAE,KAA4D;AAC9D,EAAE,SAC+B;AACjC,CAAC,qBAAqB;;AAEtB;AACA;AACA;AACA;;AAEA;AACA;AACA,sCAAsC,GAAG;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,uBAAuB,4CAA4C;AACnE,+CAA+C,gBAAgB,eAAe;AAC9E;AACA;AACA;;AAEA,2BAA2B;;AAE3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,yCAAyC,WAAW;AACpD,OAAO,6BAA6B;AACpC;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,oBAAoB,yBAAyB;AAC7C,gBAAgB,yBAAyB;AACzC,qCAAqC,iDAAiD;AACtF,uBAAuB,gBAAgB,oBAAoB,OAAO,2BAA2B,EAAE;AAC/F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA,IAAI;AACJ,QAAQ;AACR;AACA,SAAS,sCAAsC;AAC/C,cAAc;AACd;AACA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA,OAAO,0BAA0B;AACjC;AACA,OAAO;AACP;AACA,iCAAiC,oBAAoB;AACrD,4BAA4B;AAC5B,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,OAAO,wDAAwD;AAC/D;AACA;;AAEA;AACA;AACA,wCAAwC,8CAA8C;AACtF;AACA;AACA;AACA,mBAAmB,eAAe;AAClC,OAAO,0CAA0C,kBAAkB,EAAE;AACrE;AACA;;AAEA,oCAAoC,eAAe;AACnD;AACA,KAAK,+BAA+B,yBAAyB,uCAAuC,GAAG;AACvG;AACA,KAAK,+BAA+B,MAAM,eAAe,EAAE,aAAa,GAAG;;AAE3E;AACA;AACA,sBAAsB;AACtB;;AAEA;AACA,kBAAkB,aAAa;AAC/B;AACA,OAAO;AACP,SAAS,0BAA0B,EAAE;AACrC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,sBAAsB,qBAAqB;AAC3C;AACA,uDAAuD;AACvD;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;AAEA,4BAA4B;AAC5B;AACA;AACA;AACA;;AAEA;AACA,mBAAmB,kBAAkB;AACrC,OAAO,uBAAuB,WAAW;AACzC;AACA;;AAEA;AACA;;AAEA;AACA;AACA,cAAc,qBAAqB;;AAEnC;AACA,wBAAwB,cAAc,eAAe,iBAAiB,cAAc;;AAEpF;AACA;AACA;AACA,+BAA+B;AAC/B;AACA,0BAA0B,yBAAyB;AACnD;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,wBAAwB;AACxB;AACA;;AAEA;AACA;AACA;AACA,OAAO,sCAAsC;AAC7C;AACA;;AAEA,qBAAqB;;AAErB;AACA;AACA,mBAAmB,kBAAkB,OAAO,yBAAyB;AACrE;AACA;;AAEA;AACA;AACA,iEAAiE,OAAO;AACxE;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,gBAAgB,sBAAsB;AACtC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB,mEAAmE;AACnE;AACA;;AAEA;AACA,wBAAwB,uCAAuC,eAAe;AAC9E;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC;;AAEhC,0CAA0C;AAC1C;AACA,wFAAwF,YAAY;AACpG;AACA;;AAEA,8CAA8C;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,uBAAuB;AACvB;AACA,wBAAwB;AACxB,sBAAsB,UAAU;AAChC,YAAY,kBAAkB;AAC9B;AACA;;AAEA;;AAEA;AACA,iBAAiB;AACjB;AACA,mBAAmB,kBAAkB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,oBAAoB;AACrC;;AAEA;AACA;AACA;AACA;AACA,mBAAmB,kBAAkB;AACrC;AACA,yCAAyC;AACzC;AACA,uDAAuD,WAAW;AAClE,cAAc,eAAe;AAC7B;AACA;AACA,uDAAuD,WAAW;AAClE,cAAc,eAAe;AAC7B;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,gDAAgD;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB,gDAAgD;AAChD,gDAAgD;AAChD,gDAAgD;AAChD,kDAAkD;AAClD,gCAAgC;AAChC,YAAY;AACZ;;AAEA;AACA;;AAEA;AACA;AACA,uBAAuB;AACvB;;AAEA;AACA;;AAEA,uEAAuE;AACvE;AACA,qBAAqB,SAAS;AAC9B,SAAS,yCAAyC;;AAElD;AACA;AACA;AACA;AACA,yCAAyC,WAAW;AACpD;AACA,0BAA0B,mBAAmB;AAC7C,cAAc,aAAa;AAC3B;;AAEA;AACA;AACA;AACA;AACA;AACA,wCAAwC,WAAW;AACnD;AACA,0CAA0C,kBAAkB;AAC5D,yCAAyC,cAAc,qBAAqB,kBAAkB,EAAE;AAChG;;AAEA;AACA;AACA;AACA,0CAA0C,eAAe;AACzD;AACA,oEAAoE,kBAAkB;AACtF;AACA,oDAAoD,qBAAqB;AACzE;AACA;;AAEA;AACA;AACA;AACA;AACA,uBAAuB,WAAW;AAClC;AACA,4BAA4B,kBAAkB;AAC9C;AACA;AACA,6BAA6B,gCAAgC;AAC7D;AACA,2BAA2B,SAAS,OAAO,oBAAoB;AAC/D;AACA;AACA;;AAEA;AACA;AACA;AACA,0CAA0C,WAAW;AACrD;AACA,4CAA4C,kBAAkB;AAC9D,yCAAyC,gBAAgB;AACzD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,WAAW;AAClC;AACA;AACA,+BAA+B,6CAA6C;AAC5E;AACA;AACA;AACA,6BAA6B,aAAa,SAAS,wBAAwB;AAC3E;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,WAAW;AAClC;AACA;AACA,qBAAqB,4CAA4C;AACjE;AACA,SAAS;AACT;AACA,qBAAqB,gCAAgC;AACrD,6BAA6B,WAAW;AACxC;AACA,8BAA8B,gDAAgD;AAC9E;AACA,yBAAyB,2CAA2C;AACpE;AACA;AACA,aAAa,OAAO,OAAO;AAC3B;AACA,0BAA0B,gDAAgD;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,wBAAwB,yDAAyD;AACjF;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL,+DAA+D;AAC/D;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,WAAW,iEAAiE;AAC5E;AACA;AACA;;AAEA;AACA;AACA,2BAA2B;AAC3B;AACA,mBAAmB,qBAAqB,OAAO,+BAA+B;AAC9E;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO,MAAM,qCAAqC,8BAA8B,IAAI;AACpF;AACA;AACA;;AAEA;AACA;AACA,eAAe;AACf;AACA,mBAAmB,gBAAgB,OAAO;AAC1C,OAAO,kBAAkB,EAAE;AAC3B;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,2CAA2C;AAC3C,4CAA4C;AAC5C;;AAEA;AACA;;AAEA;AACA,2BAA2B,oBAAoB;AAC/C,UAAU,uBAAuB;AACjC;AACA;AACA,4BAA4B,qBAAqB;AACjD,UAAU,uBAAuB;AACjC;AACA;AACA;AACA;AACA,sBAAsB,oBAAoB;;AAE1C,wBAAwB;AACxB;AACA;AACA;AACA,yBAAyB,OAAO;AAChC,8BAA8B,OAAO;AACrC,8BAA8B,OAAO;AACrC;AACA,qCAAqC,OAAO;AAC5C;AACA;;AAEA;AACA;AACA;AACA;AACA,+BAA+B;AAC/B;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,2FAA2F;AACpG;AACA;AACA,yDAAyD,YAAY;AACrE;AACA;AACA;;AAEA;AACA;AACA;AACA,+BAA+B;AAC/B;AACA;AACA;AACA;AACA,qCAAqC,eAAe;AACpD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,oBAAoB;AACzC;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,GAAG,sBAAsB,iCAAiC;;AAE1D;AACA,SAAS;AACT,cAAc;AACd,GAAG;AACH;AACA,SAAS;AACT;AACA,sDAAsD;AACtD;AACA;;AAEA;AACA;AACA,wBAAwB;AACxB,qCAAqC;AACrC;AACA,GAAG;;AAEH;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;;AAEA;AACA,gBAAgB;;AAEhB;AACA;AACA;AACA;AACA;AACA,OAAO,8DAA8D;AACrE;AACA;;AAEA;AACA;AACA;;AAEA,2BAA2B,iBAAiB;AAC5C;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,qCAAqC,UAAU,aAAa;AAC5D;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA,kCAAkC,SAAS,WAAW;AACtD,UAAU,iBAAiB,aAAa;AACxC;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA,yCAAyC;AACzC,2CAA2C,qCAAqC;AAChF;AACA;AACA;AACA;AACA,0BAA0B,sCAAsC;AAChE,yBAAyB;AACzB,OAAO,0CAA0C,EAAE;;AAEnD;AACA;;AAEA;AACA;AACA;AACA;AACA,sGAAsG;AACtG;AACA;;AAEA;AACA,yBAAyB;AACzB,yBAAyB;AACzB;AACA;AACA;AACA,iCAAiC,sBAAsB;AACvD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC;AACvC;AACA;AACA;AACA,oBAAoB;AACpB;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,4CAA4C;AAC5C,4CAA4C;AAC5C,6CAA6C;AAC7C;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,mCAAmC,kBAAkB;AACrD,UAAU,sDAAsD;AAChE,aAAa,WAAW;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,6DAA6D,cAAc;AAC3E;AACA;AACA,kDAAkD;AAClD;AACA;AACA,qBAAqB,iBAAiB;AACtC;AACA,gDAAgD;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,kDAAkD;AACpF;AACA;AACA,gCAAgC,4BAA4B;AAC5D;AACA;AACA,KAAK;AACL;AACA,qCAAqC;AACrC,uCAAuC,6BAA6B;AACpE;AACA;AACA;AACA,+CAA+C;AAC/C;AACA;AACA,SAAS;AACT,aAAa,qBAAqB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA,sBAAsB;AACtB;AACA,qBAAqB,eAAe;AACpC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,8BAA8B;AACxD,4BAA4B,6BAA6B;AACzD;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,wCAAwC,qBAAqB,EAAE,EAAE;AACjE;AACA;;AAEA;AACA;AACA;AACA;AACA,eAAe,mBAAmB,GAAG,gBAAgB,kBAAkB,EAAE;AACzE;;AAEA;AACA;AACA;AACA,8BAA8B;AAC9B;AACA,gCAAgC,OAAO;AACvC,sBAAsB;AACtB,uCAAuC;AACvC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,uBAAuB,6BAA6B;AACpD;AACA,qBAAqB,eAAe;AACpC;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,UAAU,wBAAwB;AAClC;AACA,mBAAmB;AACnB;AACA;AACA;AACA;;AAEA,2BAA2B;;AAE3B;AACA;AACA;;AAEA;AACA;AACA;;AAEA,iCAAiC;AACjC;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAsB;;AAEtB,iCAAiC;;AAEjC,uBAAuB;AACvB,yBAAyB;AACzB,yBAAyB;;AAEzB;AACA;AACA,6BAA6B;AAC7B;AACA,+BAA+B;AAC/B;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA,qCAAqC;AACrC,sBAAsB;AACtB,UAAU;AACV;AACA;AACA;AACA,mBAAmB,kBAAkB,OAAO,iCAAiC;AAC7E;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,gDAAgD,uBAAuB;AACvE;AACA;;AAEA;AACA;;AAEA,2BAA2B;AAC3B;AACA,OAAO,0BAA0B;AACjC;AACA,YAAY;AACZ;AACA;;AAEA;AACA;AACA,gCAAgC,qBAAqB;AACrD;;AAEA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wEAAwE,4BAA4B,EAAE;AACtG;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,sCAAsC;AACnD;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,SAAS;AACT,gBAAgB,WAAW;AAC3B;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;;AAEA,mBAAmB,8BAA8B;;AAEjD,YAAY;AACZ;;AAEA;AACA;AACA;AACA;AACA;AACA,uBAAuB,4BAA4B;AACnD;AACA;AACA,2BAA2B,oCAAoC;AAC/D,mCAAmC,0BAA0B;AAC7D;AACA,SAAS,iFAAiF;AAC1F;AACA;AACA;;AAEA;AACA;AACA,+BAA+B;AAC/B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,kBAAkB,iCAAiC;AACnD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,oCAAoC;AACzD;AACA;AACA;AACA;AACA;;AAEA;AACA,yBAAyB;AACzB,0BAA0B;AAC1B;AACA,+BAA+B;AAC/B;;AAEA;AACA,mBAAmB,QAAQ;AAC3B,kBAAkB,wCAAwC;AAC1D;AACA,sCAAsC;AACtC;AACA;AACA;;AAEA;AACA,8BAA8B;AAC9B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,aAAa;AAC/B;AACA;AACA;AACA,oBAAoB,2EAA2E;AAC/F;AACA;AACA;;AAEA;AACA,eAAe,QAAQ;AACvB;AACA,uBAAuB;AACvB;AACA;AACA;AACA,SAAS,6BAA6B;AACtC;AACA,SAAS,oCAAoC;AAC7C,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,+BAA+B,wCAAwC;AACvE;AACA;AACA;AACA,qBAAqB,qEAAqE;AAC1F;AACA;AACA;AACA,yBAAyB,4CAA4C;AACrE;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,oBAAoB,sDAAsD;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,cAAc;AACtC,gCAAgC;AAChC;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,yCAAyC;AACzC;AACA,0BAA0B,cAAc;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,qBAAqB;AACrB;;AAEA;AACA;AACA,gBAAgB,gBAAgB,kBAAkB;AAClD;AACA,kCAAkC;AAClC,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,mBAAmB,kBAAkB;AACrC,OAAO,wBAAwB,gCAAgC,EAAE;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,gBAAgB,gBAAgB;AAC9C;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,cAAc,gBAAgB,gBAAgB;AAC9C;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA,gCAAgC;;AAEhC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,qBAAqB,kBAAkB;AACvC;AACA;AACA;AACA,uBAAuB,mBAAmB;AAC1C,8BAA8B,uDAAuD;AACrF;AACA;AACA;AACA;AACA;AACA,uBAAuB,mBAAmB;AAC1C;AACA,gCAAgC,qBAAqB;AACrD;AACA;AACA;AACA;AACA,2BAA2B,sCAAsC;AACjE;AACA,SAAS;AACT;AACA,yBAAyB,sCAAsC;AAC/D;AACA;AACA;AACA;AACA,gBAAgB,gCAAgC;AAChD,gCAAgC,8BAA8B;;AAE9D;AACA;AACA;AACA;AACA;AACA,SAAS,kBAAkB,oBAAoB;AAC/C,WAAW;AACX,aAAa,uFAAuF,EAAE,EAAE;AACxG,uBAAuB,WAAW;AAClC,SAAS,6BAA6B;AACtC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,mBAAmB,kBAAkB;AACrC;AACA;AACA,SAAS,sBAAsB;AAC/B;AACA,wBAAwB;AACxB;AACA;;AAEA;AACA;AACA;AACA;AACA,6BAA6B,gBAAgB,6BAA6B;AAC1E;AACA;AACA,WAAW,wCAAwC;AACnD,OAAO;AACP,KAAK;AACL,mBAAmB;AACnB,kBAAkB,mBAAmB;AACrC,mBAAmB,oBAAoB;AACvC;AACA,qBAAqB,kBAAkB;AACvC;AACA,6DAA6D;AAC7D;AACA;AACA,WAAW,gBAAgB,yBAAyB,EAAE;AACtD;AACA,WAAW,gBAAgB,qBAAqB,EAAE;AAClD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB;AACjB,mBAAmB,kBAAkB;AACrC,OAAO,kCAAkC;AACzC;AACA;AACA;AACA,iBAAiB;AACjB,mBAAmB,kBAAkB;AACrC,OAAO,kCAAkC;AACzC;AACA;;AAEA;AACA;AACA,8BAA8B;AAC9B,+BAA+B;;AAE/B;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA,kBAAkB;AAClB;AACA,gBAAgB;AAChB;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAc,+BAA+B,gBAAgB;AAC7D;AACA;AACA;AACA,SAAS,mBAAmB;AAC5B,KAAK;AACL;AACA;AACA,uCAAuC;AACvC,qCAAqC;;AAErC;AACA;AACA,cAAc,gBAAgB,gBAAgB;AAC9C;AACA;AACA,sEAAsE,mBAAmB;AACzF,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,gBAAgB,gBAAgB;AAC9C;AACA,iCAAiC;AACjC;AACA;AACA;AACA,qEAAqE;AACrE;AACA;AACA,SAAS;AACT,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,mCAAmC;AAC1C;AACA;;AAEA;AACA;AACA;AACA,OAAO,kCAAkC;AACzC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;;AAEA;AACA;AACA;AACA,iCAAiC;AACjC;AACA,mCAAmC;AACnC;AACA,OAAO,kCAAkC;AACzC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAc,+BAA+B,gBAAgB;AAC7D;AACA,iCAAiC;AACjC,4BAA4B;AAC5B,iCAAiC;AACjC;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,kCAAkC,6BAA6B;AAC/D;AACA;AACA;AACA;AACA,6CAA6C;AAC7C;AACA;;AAEA;AACA;AACA;;AAEA;AACA,mBAAmB,wBAAwB;AAC3C;AACA,4BAA4B;AAC5B,YAAY,kBAAkB;AAC9B;AACA,8BAA8B,GAAG;AACjC,uBAAuB,yBAAyB;AAChD;AACA,2BAA2B;AAC3B,cAAc,iBAAiB;AAC/B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,uCAAuC;AACvC;;AAEA;AACA;AACA;AACA;AACA;AACA,0BAA0B,wBAAwB;AAClD,sBAAsB,oBAAoB;AAC1C,6BAA6B,mBAAmB;AAChD;AACA;AACA;AACA,mCAAmC,mCAAmC;AACtE;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA,wCAAwC;AACxC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;;AAEA;AACA,mBAAmB,iDAAiD;AACpE;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,+DAA+D;AACxE;AACA;AACA;AACA;AACA;AACA,WAAW,iFAAiF;AAC5F;AACA,WAAW,uFAAuF;AAClG;;AAEA;AACA;AACA,SAAS,2FAA2F;;AAEpG;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,SAAS,mEAAmE;AAC5E;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS,gDAAgD;AACzD;;AAEA;AACA;AACA,OAAO,iFAAiF;;AAExF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,iBAAiB;AAClD;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,yCAAyC;AAC9E,gBAAgB,0BAA0B;AAC1C;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,qCAAqC,2CAA2C;AAChF,gBAAgB,4BAA4B;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,yBAAyB;AAChD,qBAAqB,uBAAuB;AAC5C;AACA;AACA,sCAAsC;AACtC,WAAW,4CAA4C,EAAE;AACzD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,8CAA8C;AAC9C;AACA,mBAAmB,iBAAiB;AACpC;AACA;AACA,SAAS,eAAe;AACxB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,uBAAuB,kBAAkB;AACzC;AACA,sDAAsD;AACtD;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,iBAAiB,2DAA2D;AAC5E;AACA;AACA,SAAS,sEAAsE;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,uBAAuB,qBAAqB;AAC5C,SAAS,wHAAwH;AACjI;AACA;;AAEA;AACA;AACA,WAAW;AACX,8BAA8B;AAC9B;AACA;AACA,yBAAyB;AACzB;AACA,uBAAuB,kBAAkB;AACzC;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA,8BAA8B,gCAAgC;AAC9D,wBAAwB,sBAAsB,gBAAgB;AAC9D,iDAAiD,sCAAsC;AACvF,oDAAoD,yDAAyD;AAC7G;AACA;AACA,0BAA0B,gCAAgC,mBAAmB;AAC7E;AACA;AACA,iBAAiB,gCAAgC,8BAA8B;AAC/E;AACA;AACA,eAAe,gBAAgB;AAC/B,WAAW;AACX;AACA;AACA;AACA,wBAAwB,kBAAkB,wBAAwB;AAClE,WAAW,wCAAwC,sCAAsC,EAAE,EAAE;;AAE7F,kDAAkD,kBAAkB,6BAA6B;AACjG,WAAW,qDAAqD,EAAE;AAClE;AACA;AACA;AACA,qCAAqC;AACrC,oCAAoC,mBAAmB;AACvD;AACA;AACA,uBAAuB;;AAEvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,8BAA8B,YAAY;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,wBAAwB,UAAU;AAClC;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,YAAY,sBAAsB;AAClC,SAAS,yBAAyB;AAClC,qBAAqB,sBAAsB;AAC3C;AACA;AACA,WAAW;AACX,aAAa,wEAAwE,EAAE;AACvF;AACA,KAAK;AACL;;AAEA;AACA;AACA,iBAAiB;;AAEjB,SAAS,4BAA4B;AACrC;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,6BAA6B,iCAAiC,EAAE;AAChE;;AAEA,mBAAmB,gBAAgB;AACnC;AACA;;AAEA;AACA;AACA;AACA,mBAAmB,oBAAoB,OAAO,cAAc;AAC5D;;AAEA;AACA;AACA;AACA;AACA,mBAAmB,6BAA6B;AAChD;AACA,2BAA2B,8BAA8B;AACzD,kCAAkC,6CAA6C;AAC/E,iCAAiC,iCAAiC;AAClE,kCAAkC,uCAAuC;AACzE;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,qEAAqE;AAC9E;AACA,iCAAiC,gCAAgC;AACjE;AACA;AACA;;AAEA;AACA;AACA,cAAc,qCAAqC;AACnD;AACA,gBAAgB,qCAAqC;AACrD,YAAY,iEAAiE,4BAA4B;AACzG,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,2BAA2B;AACpE;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO,iEAAiE;AACxE;AACA,OAAO,8BAA8B;AACrC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0HAA0H;AAC1H;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,yDAAyD;AAClE;AACA,SAAS;AACT;AACA;AACA,4EAA4E,qDAAqD;AACjI,oBAAoB,gBAAgB,mCAAmC;AACvE;AACA;AACA,WAAW;AACX,6EAA6E,6CAA6C;AAC1H,OAAO;AACP;AACA;;AAEA;AACA,6BAA6B,2BAA2B;AACxD,8DAA8D,MAAM;AACpE;AACA;AACA,SAAS,iCAAiC;AAC1C;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,wBAAwB,kCAAkC;AAC1D,0BAA0B,sCAAsC;;AAEhE;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,wBAAwB,gBAAgB,0BAA0B;AAClE,OAAO,mEAAmE,EAAE;AAC5E;;AAEA;AACA,wBAAwB;AACxB;AACA,sCAAsC,eAAe;AACrD;AACA,sCAAsC,+CAA+C;AACrF;AACA;AACA;AACA,SAAS,2DAA2D;AACpE;AACA,SAAS,wBAAwB;AACjC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,uDAAuD;AACrF;AACA;;AAEA;AACA,gCAAgC;AAChC;AACA,cAAc;AACd;AACA,4CAA4C;AAC5C;AACA,SAAS,wEAAwE,EAAE;AACnF;AACA,SAAS,iEAAiE,EAAE;AAC5E;AACA;AACA;AACA;;AAEA;AACA;AACA,6BAA6B,sBAAsB;AACnD;AACA;AACA,SAAS;AACT;AACA;;AAEA;;AAEA,gCAAgC;AAChC,iCAAiC;AACjC;AACA,iCAAiC;AACjC;AACA;AACA,gBAAgB;AAChB,kDAAkD,+BAA+B;AACjF;AACA;;AAEA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,aAAa,sDAAsD;AACnE;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO,SAAS,yDAAyD;AACzE,mBAAmB,0BAA0B;AAC7C,OAAO;AACP,SAAS,SAAS,iEAAiE,EAAE;AACrF,qBAAqB,4BAA4B;AACjD,OAAO;AACP,SAAS,SAAS,mFAAmF,EAAE;AACvG;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,YAAY,yBAAyB;AACrC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,OAAO,4CAA4C;;AAEnD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,0BAA0B,SAAS;AACnC;AACA;AACA;AACA,KAAK;AACL;AACA,SAAS,4DAA4D;AACrE;AACA;AACA;AACA;AACA;AACA,yBAAyB,6BAA6B;AACtD;AACA,YAAY;AACZ;AACA;AACA;;AAEA,kBAAkB;;AAElB;AACA;AACA;AACA;AACA,mBAAmB,mBAAmB;AACtC;AACA;AACA;AACA,kBAAkB;AAClB;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA;AACA,yBAAyB,oBAAoB;AAC7C;AACA;AACA;AACA;AACA,WAAW,iBAAiB;AAC5B;AACA,WAAW;AACX;AACA;AACA,WAAW;AACX;AACA,WAAW;AACX;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,YAAY;AACZ;;AAEA;AACA;AACA,yBAAyB,gBAAgB,kBAAkB;AAC3D,iDAAiD;AACjD,KAAK,EAAE,OAAO,iCAAiC,UAAU;AACzD,mDAAmD;AACnD,KAAK;AACL;AACA;;AAEA;AACA;AACA;;AAEA;AACA,6BAA6B;AAC7B,uBAAuB,SAAS,SAAS;AACzC,+FAA+F,SAAS;AACxG,+HAA+H,OAAO;AACtI;AACA,WAAW,gDAAgD;AAC3D;AACA,WAAW,sEAAsE;AACjF,oDAAoD;AACpD;AACA;AACA;AACA;AACA,kCAAkC,4DAA4D;AAC9F,KAAK,OAAO;AACZ,sBAAsB,2BAA2B;AACjD;AACA;AACA,SAAS,sDAAsD;AAC/D;AACA,SAAS,qCAAqC;AAC9C;AACA;AACA;AACA;AACA,SAAS,SAAS,mGAAmG;AACrH;AACA,SAAS,iBAAiB;AAC1B;;AAEA;AACA;AACA;AACA;AACA,UAAU,wBAAwB;AAClC,OAAO,wBAAwB,QAAQ;AACvC;AACA,kBAAkB;AAClB;AACA;AACA,oCAAoC,qBAAqB;AACzD,gDAAgD,oBAAoB,uBAAuB;;AAE3F;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,YAAY;AACZ;AACA;;AAEA;AACA;AACA;AACA;AACA,0BAA0B,gBAAgB,0BAA0B;AACpE,SAAS,iCAAiC,EAAE;AAC5C;AACA;;AAEA;AACA;AACA;AACA,mBAAmB,4BAA4B;AAC/C,OAAO,kDAAkD;AACzD;;AAEA;AACA;AACA;AACA,mCAAmC,kCAAkC;AACrE;AACA;;AAEA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;;AAEA;AACA;AACA,0BAA0B,gBAAgB,4BAA4B,OAAO;AAC7E,OAAO,4CAA4C,EAAE,EAAE;AACvD;AACA;;AAEA,iBAAiB,yBAAyB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA,4BAA4B;AAC5B,mBAAmB,mBAAmB;AACtC;AACA,6BAA6B,gCAAgC;AAC7D,UAAU,+BAA+B;AACzC;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA,qBAAqB;AACrB;AACA;;AAEA;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA,YAAY;AACZ;;AAEA;AACA,mBAAmB,qCAAqC;AACxD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,sDAAsD;AACjF;AACA;AACA,kBAAkB,kBAAkB,EAAE,OAAO,kBAAkB;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,iBAAiB;;AAEjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,oDAAoD;AAC5E;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,mCAAmC,uCAAuC;AAC1E;AACA;AACA,YAAY;AACZ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,oBAAoB;AACtC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA,OAAO;AACP,gBAAgB,OAAO;;AAEvB;AACA,WAAW;AACX;AACA;AACA,uBAAuB;AACvB;AACA,mCAAmC;AACnC;AACA;AACA;;AAEA;AACA;AACA;AACA,yCAAyC,qEAAqE,EAAE;AAChH,mCAAmC,6DAA6D,EAAE;AAClG,YAAY;AACZ;;AAEA;AACA,2BAA2B,sDAAsD;AACjF;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC,0CAA0C;AAC1C;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,+CAA+C,MAAM;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,yBAAyB;AAClC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,OAAO;AACzD;AACA,mBAAmB,kBAAkB;AACrC;AACA,2CAA2C;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,gCAAgC;AAChD;AACA,4BAA4B,SAAS,6CAA6C;AAClF,wBAAwB,SAAS,6CAA6C;AAC9E;AACA;;AAEA;AACA;AACA;AACA,2CAA2C;AAC3C;AACA;AACA;AACA;AACA,qBAAqB,QAAQ;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,mCAAmC;AACxD;AACA;AACA;;AAEA;AACA;AACA,0CAA0C;AAC1C;AACA;AACA;AACA;AACA,oBAAoB,iCAAiC;AACrD;AACA;;AAEA;AACA;AACA;AACA,iCAAiC;AACjC;AACA,6CAA6C,GAAG;AAChD;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC;;AAEvC;AACA,yBAAyB,gBAAgB,yBAAyB;AAClE,qCAAqC,yCAAyC;AAC9E,OAAO;;AAEP;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA,qCAAqC,mCAAmC;AACxE,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2EAA2E;;AAE3E;AACA;AACA,SAAS,4BAA4B,2BAA2B;AAChE,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iCAAiC;AACjC;AACA,gBAAgB;AAChB;AACA,mBAAmB,iBAAiB;AACpC;AACA,kBAAkB;AAClB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,qBAAqB;AAC5C,qBAAqB,iCAAiC;AACtD,mBAAmB,aAAa;;AAEhC;AACA;AACA;AACA,OAAO,kCAAkC;;AAEzC;;AAEA,iCAAiC;AACjC;AACA,SAAS,eAAe;AACxB,KAAK,mCAAmC;AACxC;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,KAAK,6DAA6D;AAClE;AACA,KAAK,qCAAqC;AAC1C;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK,iCAAiC;AACtC;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK,OAAO;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS,sBAAsB;AAC/B;AACA,SAAS,iCAAiC;AAC1C;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,iCAAiC;;AAExC,4DAA4D;AAC5D;AACA,gCAAgC;AAChC;AACA,mCAAmC,gBAAgB;AACnD;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO,SAAS,0BAA0B;AAC1C;AACA,mBAAmB,WAAW;AAC9B,OAAO,mBAAmB;AAC1B;AACA;AACA,uCAAuC;AACvC;AACA;AACA,OAAO;AACP;AACA;AACA,mBAAmB;AACnB;AACA;AACA,qDAAqD;AACrD;AACA;AACA;AACA,YAAY;AACZ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,SAAS,gFAAgF;AACzF;AACA,SAAS,4DAA4D;AACrE;AACA;AACA,SAAS,4EAA4E;AACrF;AACA,SAAS,6DAA6D;AACtE;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,mBAAmB,iBAAiB;AACpC;AACA,qEAAqE,SAAS;AAC9E;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,mBAAmB,2BAA2B;AAC9C,+CAA+C;AAC/C;AACA,kGAAkG;AAClG;AACA;AACA,SAAS,qDAAqD;AAC9D;AACA,SAAS,+CAA+C;AACxD;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,4BAA4B;;AAE5B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,oBAAoB,SAAS;AAC7B;AACA;AACA,wFAAwF,sBAAsB,kDAAkD,6DAA6D;AAC7N;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,2CAA2C;AAC3C;AACA;AACA;AACA;AACA;AACA,SAAS,OAAO;AAChB;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,gDAAgD;AAC3F;AACA;;AAEA,sDAAsD,iBAAiB;AACvE,0CAA0C,eAAe;AACzD,kDAAkD,eAAe;AACjE,wCAAwC,aAAa;AACrD,OAAO;AACP,cAAc;AACd;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS,qDAAqD;AAC9D;;AAEA;AACA;;AAEA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA,OAAO,4CAA4C,wEAAwE,EAAE;AAC7H,oCAAoC;AACpC;AACA,OAAO,+CAA+C;AACtD;;AAEA;AACA,4BAA4B,0BAA0B,aAAa;AACnE;;AAEA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA,KAAK,EAAE;AACP;;AAEA;AACA,qCAAqC,oCAAoC;;AAEzE,4CAA4C;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,yBAAyB,qCAAqC,EAAE,MAAM,EAAE;AAC7F;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC;;AAErC;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,yBAAyB,0BAA0B,EAAE,EAAE;AACnF;;AAEA;AACA;AACA;AACA;AACA;AACA,mBAAmB,yBAAyB;AAC5C;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,WAAW,0EAA0E;AACrF;AACA;AACA;AACA;AACA;AACA,uBAAuB,gBAAgB,qBAAqB;AAC5D,WAAW,iCAAiC,EAAE;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAuB,gBAAgB,yBAAyB;AAChE;AACA,mBAAmB,gCAAgC;AACnD,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,oBAAoB,OAAO,SAAS,OAAO,UAAU;AACrD;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,YAAY;AACZ;;AAEA;;AAEA;AACA;AACA;AACA,qDAAqD;;AAErD;AACA,iCAAiC,iBAAiB;AAClD,qGAAqG,kBAAkB;AACvH;AACA,uEAAuE,mGAAmG,0GAA0G,uDAAuD,wDAAwD;AACnY;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,yBAAyB,YAAY;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,WAAW;AAClC;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD,gBAAgB;AACxE;AACA;AACA;AACA,0DAA0D,gBAAgB;AAC1E;AACA,qBAAqB;AACrB;AACA;AACA;;AAEA;AACA;AACA;AACA,sCAAsC,0CAA0C;AAChF,uCAAuC,yCAAyC;AAChF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,cAAc;AACrC;AACA;AACA,0CAA0C,iCAAiC;AAC3E;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,gCAAgC,2BAA2B;AAC3D;;AAEA;AACA;AACA;AACA,kBAAkB,kCAAkC;AACpD;AACA,OAAO,uBAAuB;AAC9B;AACA,OAAO,iEAAiE;AACxE;AACA,OAAO,+DAA+D;AACtE;AACA;;AAEA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;;AAEA;AACA,iCAAiC,wBAAwB;AACzD,oBAAoB,yBAAyB;AAC7C,oBAAoB,wBAAwB;AAC5C;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,+CAA+C;AAC/C,iBAAiB,0BAA0B,SAAS,EAAE;AACtD;AACA,gBAAgB,yBAAyB;AACzC;AACA;;AAEA;AACA;AACA,+DAA+D;AAC/D;AACA;AACA,+CAA+C,qCAAqC;AACpF;;AAEA;AACA;AACA;AACA;AACA,0GAA0G;AAC1G;AACA;AACA,gDAAgD,sCAAsC;AACtF;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,8EAA8E;AAC9E;AACA,gBAAgB;;AAEhB;AACA,8BAA8B,oCAAoC;AAClE,KAAK;AACL;AACA,8BAA8B,wCAAwC;AACtE,KAAK;;AAEL;AACA;AACA,+BAA+B,gEAAgE;AAC/F;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA,wBAAwB,sBAAsB;AAC9C;AACA;;AAEA,YAAY;AACZ;;AAEA;AACA,uCAAuC,6BAA6B;AACpE,4BAA4B,iEAAiE;AAC7F;;AAEA;AACA,qCAAqC,2BAA2B;AAChE,2BAA2B,8DAA8D;AACzF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,kCAAkC;AAC5D,YAAY,+BAA+B;AAC3C;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,iDAAiD,SAAS,oBAAoB;AAC9E;AACA;AACA;;AAEA;AACA,mBAAmB,oCAAoC;AACvD;AACA;AACA,mBAAmB,mFAAmF;AACtG;AACA,SAAS,6BAA6B;AACtC;AACA,uCAAuC;AACvC;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK,OAAO,sCAAsC;AAClD;AACA;AACA;AACA;AACA,KAAK,OAAO,mCAAmC;AAC/C;;AAEA,wBAAwB;;AAExB;AACA;AACA;AACA;AACA,SAAS,6DAA6D;AACtE;;AAEA;AACA;AACA;AACA;AACA,+BAA+B,yBAAyB,iCAAiC,EAAE,KAAK;AAChG,OAAO;AACP;AACA,KAAK;AACL,iCAAiC,wBAAwB;AACzD,YAAY,0BAA0B;AACtC,KAAK;AACL;AACA,OAAO,8DAA8D;AACrE;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb,qBAAqB,sBAAsB;AAC3C,SAAS,8BAA8B;AACvC;AACA,KAAK,EAAE;AACP;;AAEA;AACA;AACA;AACA;AACA,mBAAmB,gBAAgB;AACnC,OAAO,yBAAyB;AAChC,qBAAqB,kBAAkB;AACvC,OAAO,2BAA2B;AAClC,qBAAqB,kBAAkB;AACvC,OAAO,2BAA2B;AAClC,qBAAqB,kBAAkB;AACvC,OAAO,2BAA2B;AAClC,qBAAqB,kBAAkB;AACvC,OAAO,+BAA+B;AACtC;;AAEA;AACA;AACA;AACA,2BAA2B,iBAAiB;;AAE5C;AACA;AACA;AACA;AACA;AACA,8CAA8C,0CAA0C;AACxF;;AAEA;AACA;AACA;;AAEA;AACA;AACA,4BAA4B,6BAA6B;;AAEzD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,OAAO,yDAAyD;AAChE;;AAEA;AACA;;AAEA;AACA;AACA;AACA,SAAS,qFAAqF;AAC9F;AACA;;AAEA;AACA;AACA,OAAO,iEAAiE;AACxE;AACA,OAAO,qCAAqC;AAC5C;AACA,OAAO,sCAAsC;;AAE7C,8BAA8B,kBAAkB;;AAEhD;AACA,OAAO,mCAAmC;AAC1C,oBAAoB,oBAAoB;AACxC;;AAEA;AACA;;AAEA,4BAA4B,kCAAkC;;AAE9D;AACA;AACA,OAAO,kDAAkD;;AAEzD;AACA,+BAA+B,gDAAgD;;AAE/E,gCAAgC,8CAA8C;AAC9E;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB,gBAAgB,mBAAmB;AACpD,OAAO,+BAA+B,2BAA2B,EAAE,EAAE;AACrE,mBAAmB,kBAAkB,uBAAuB;AAC5D,OAAO,kCAAkC,iCAAiC,EAAE,EAAE;;AAE9E;AACA,OAAO,+CAA+C;;AAEtD;AACA;AACA,OAAO,0CAA0C;AACjD;AACA,OAAO,oBAAoB;AAC3B;;AAEA;AACA;AACA,mBAAmB;AACnB;AACA,SAAS;AACT,aAAa,kBAAkB;AAC/B;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA,WAAW;AACX,eAAe,kBAAkB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA,WAAW;AACX,eAAe,oBAAoB;AACnC;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA,WAAW;AACX,eAAe,kBAAkB;AACjC;AACA;;AAEA;;AAEA;AACA;AACA,OAAO,yDAAyD;AAChE;;AAEA;AACA;AACA,qDAAqD;AACrD;AACA;AACA;;AAEA;AACA,gDAAgD;AAChD;AACA;AACA;AACA,yBAAyB,4BAA4B;AACrD;AACA;AACA,qBAAqB,4BAA4B;AACjD,0BAA0B,0BAA0B;AACpD;AACA;AACA,uBAAuB,mCAAmC,OAAO,2CAA2C;AAC5G,uBAAuB,iCAAiC;AACxD;AACA;AACA,OAAO;AACP;AACA,WAAW,qCAAqC;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,8BAA8B;AAC9B,qBAAqB,yBAAyB;AAC9C,SAAS,4CAA4C;AACrD,KAAK,EAAE;AACP;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAO,6BAA6B;AACpC;AACA;AACA;;AAEA,mBAAmB,wBAAwB;AAC3C,OAAO,sCAAsC;AAC7C;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,wBAAwB;AACxB;AACA,2DAA2D;AAC3D,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,gFAAgF;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,kEAAkE,8CAA8C;AAChH,0DAA0D,oCAAoC;AAC9F;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA,uBAAuB,wCAAwC;AAC/D;AACA,uBAAuB,oCAAoC;AAC3D;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA,2BAA2B;AAC3B;AACA;AACA;AACA,WAAW,aAAa,0FAA0F;AAClH;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,+CAA+C;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,wDAAwD;AACxD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS,6BAA6B;AACtC;AACA,SAAS,mCAAmC;AAC5C;AACA;;AAEA;AACA;AACA;AACA,mBAAmB,iBAAiB;AACpC;AACA,4BAA4B,oEAAoE;AAChG;AACA;AACA,OAAO,OAAO;AACd,sCAAsC,eAAe;AACrD;AACA;AACA;AACA,yDAAyD,sBAAsB;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,eAAe;AAChC;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,4FAA4F;AAC5F;AACA;AACA,mBAAmB,iBAAiB,OAAO;AAC3C;AACA;AACA,WAAW,kCAAkC;AAC7C;AACA,WAAW,4CAA4C;AACvD;AACA;AACA,kBAAkB,gBAAgB,kBAAkB;AACpD,SAAS,4BAA4B,EAAE;AACvC,KAAK;AACL;AACA,OAAO,sDAAsD;AAC7D;;AAEA;AACA;AACA;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,mBAAmB,oBAAoB;AACvC;AACA,oCAAoC,oBAAoB,uBAAuB;AAC/E;AACA,2BAA2B;AAC3B,cAAc,uBAAuB;AACrC;AACA,mBAAmB,8BAA8B;AACjD;AACA,yCAAyC,cAAc,iDAAiD,EAAE;AAC1G;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,kBAAkB;AACrC;AACA;AACA;AACA;AACA,kBAAkB,4BAA4B;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gEAAgE;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gEAAgE,+BAA+B,YAAY;AAC3G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,+BAA+B,6BAA6B,mCAAmC;AAC/F,wCAAwC,6BAA6B;;AAErE;AACA,8BAA8B,8BAA8B;AAC5D,YAAY,kBAAkB;AAC9B;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW,2BAA2B;AACtC,mBAAmB,yBAAyB;AAC5C,oBAAoB,0BAA0B;AAC9C,oBAAoB,2BAA2B;;AAE/C;AACA;AACA,gEAAgE,eAAe;AAC/E,8DAA8D,eAAe;AAC7E,0BAA0B,mBAAmB;AAC7C,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,kDAAkD;;AAElD;AACA;AACA;AACA;AACA;AACA,0DAA0D,eAAe;AACzE,uBAAuB,iBAAiB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,8EAA8E;AACvF;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,qBAAqB;AAC9B,iCAAiC;AACjC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,uBAAuB,sCAAsC;AAC7D,YAAY,kDAAkD;AAC9D,+BAA+B,sBAAsB;AACrD;;AAEA;AACA;AACA,gDAAgD;AAChD,6BAA6B;AAC7B;AACA,4CAA4C;AAC5C;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA,SAAS;AACT,OAAO;AACP,8BAA8B;AAC9B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,6CAA6C;;AAE7C;AACA;;AAEA,wBAAwB;AACxB,yFAAyF;AACzF,mBAAmB,wBAAwB;AAC3C;AACA,iGAAiG;AACjG;AACA;AACA;;AAEA;AACA;;AAEA;AACA,mBAAmB,wBAAwB;AAC3C,OAAO,sFAAsF;AAC7F;AACA;;AAEA;AACA;;AAEA,mBAAmB,wBAAwB;AAC3C,OAAO,iCAAiC,cAAc;AACtD;AACA;;AAEA;AACA;;AAEA,eAAe,WAAW;AAC1B,mBAAmB,wBAAwB;AAC3C;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA,yBAAyB;AACzB;;AAEA,sCAAsC;AACtC,oCAAoC;AACpC,uCAAuC;;AAEvC;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,gCAAgC,EAAE;AACnE;AACA,mBAAmB,mBAAmB;AACtC;AACA;AACA;AACA;AACA;AACA,6BAA6B,aAAa;AAC1C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;;AAEA;AACA;AACA;AACA,oCAAoC;AACpC,mCAAmC;;AAEnC;AACA,qCAAqC,2CAA2C;AAChF;AACA;;AAEA;AACA;AACA,mBAAmB,2BAA2B;AAC9C;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;;AAEA;AACA;AACA;AACA;AACA;AACA,mBAAmB,oBAAoB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,4BAA4B,wBAAwB;AACpD,wBAAwB,oBAAoB;AAC5C,KAAK;AACL;AACA;AACA;AACA,mBAAmB,eAAe;AAClC;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,SAAS;AAClC,SAAS,gEAAgE;AACzE;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,mBAAmB,+BAA+B;AAClD,yBAAyB,8BAA8B;AACvD,KAAK;AACL;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,uBAAuB,uCAAuC;AAC9D;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,uBAAuB,gBAAgB,uBAAuB;AAC9D;AACA,8BAA8B;AAC9B;AACA,wCAAwC;AACxC;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,mCAAmC,iBAAiB;AACpD;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,sBAAsB;AACtB;AACA,oCAAoC,gFAAgF,EAAE;AACtH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,wBAAwB,aAAa;AACrC,YAAY;AACZ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS,4CAA4C;AACrD,aAAa;AACb;AACA;AACA;AACA;AACA,mCAAmC,mBAAmB;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,gBAAgB,6BAA6B;AAC7C;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,uCAAuC;AAC9C;AACA,OAAO,wCAAwC;;AAE/C;AACA;AACA;AACA;AACA,OAAO,mCAAmC;AAC1C;;AAEA;AACA;AACA;AACA,OAAO,gBAAgB;AACvB;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS,wDAAwD,yBAAyB;AAC1F;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,mBAAmB,kBAAkB;AACrC,8CAA8C,YAAY,yBAAyB,EAAE;AACrF,qBAAqB,oBAAoB;AACzC;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,mBAAmB,wBAAwB;AAC3C,OAAO,uCAAuC;AAC9C;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf,qBAAqB;;AAErB,mBAAmB,gBAAgB;AACnC;AACA;AACA,8BAA8B,uBAAuB;AACrD;AACA,yBAAyB,mBAAmB;AAC5C,aAAa,uCAAuC,iBAAiB;AACrE;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,mBAAmB,mBAAmB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,oBAAoB;AACrC,qBAAqB,oBAAoB;AACzC;AACA,yBAAyB,oDAAoD;AAC7E,uBAAuB,2BAA2B;AAClD;AACA;AACA;AACA;AACA,SAAS,EAAE;AACX;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA,yBAAyB,yDAAyD;AAClF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,mBAAmB,2BAA2B;AAC9C,OAAO,iEAAiE;AACxE;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,uBAAuB,mBAAmB;AAC1C,WAAW;AACX,mEAAmE;AACnE,OAAO;AACP;AACA;AACA;AACA,iBAAiB,sDAAsD;AACvE,mCAAmC;AACnC,UAAU;AACV;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAO,gDAAgD;;AAEvD;AACA;AACA;;AAEA;AACA,OAAO,6BAA6B;AACpC;;AAEA;AACA,8BAA8B;;AAE9B;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,mBAAmB,uBAAuB;AAC1C;AACA;AACA;AACA;AACA;AACA,mBAAmB,8BAA8B;AACjD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,2BAA2B,gBAAgB,6BAA6B;AACxE;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC;AACpC,kBAAkB,IAAI;AACtB;AACA;AACA,wBAAwB;;AAExB;AACA;AACA;AACA,aAAa,8EAA8E;AAC3F;AACA,aAAa;AACb;;AAEA;AACA;AACA,WAAW,kEAAkE;AAC7E;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,iCAAiC;AACjC,YAAY;AACZ,KAAK;AACL,gDAAgD;AAChD,YAAY;AACZ,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,4BAA4B;AACvD;AACA,iBAAiB;AACjB,iBAAiB,+BAA+B;AAChD,eAAe,2BAA2B;AAC1C,iBAAiB,iBAAiB;AAClC,iCAAiC,qBAAqB;AACtD,MAAM;AACN;AACA,iBAAiB,6CAA6C;;AAE9D;AACA,mBAAmB,8BAA8B;AACjD;AACA;AACA,YAAY;AACZ;;AAEA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B,uCAAuC;AACvC;;AAEA;AACA;AACA,oBAAoB;AACpB;;AAEA;AACA;AACA;AACA;AACA,oCAAoC,QAAQ;AAC5C,SAAS,uBAAuB,0FAA0F,EAAE;AAC5H,KAAK;AACL;AACA;AACA;;AAEA;AACA,8FAA8F;AAC9F;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA,0CAA0C;;AAE1C;AACA;;AAEA;AACA;AACA;AACA,UAAU,mBAAmB;AAC7B;AACA;AACA,SAAS;AACT;AACA,6BAA6B;AAC7B;;AAEA,WAAW;AACX;AACA;AACA;AACA;AACA,oCAAoC,iBAAiB;AACrD;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO,OAAO;AACd;;AAEA;AACA;AACA;AACA;AACA,eAAe,kDAAkD;AACjE;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,yBAAyB,wBAAwB,yCAAyC,EAAE;AAC5F;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA,4CAA4C,UAAU;AACtD;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,wBAAwB;AACxB;AACA,kEAAkE;AAClE;AACA;AACA,MAAM,EAAE;AACR;AACA;AACA,kDAAkD,cAAc;AAChE,SAAS,oCAAoC;AAC7C;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA,4CAA4C;;AAE5C;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;;AAEA;;AAEA,oBAAoB,+CAA+C;AACnE,iBAAiB,oDAAoD;AACrE,UAAU,+BAA+B;AACzC;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA,OAAO,0BAA0B;;AAEjC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,+BAA+B,+BAA+B;AAC9D;;AAEA;AACA;;AAEA;AACA;AACA;AACA,OAAO,eAAe;AACtB;AACA,OAAO,sCAAsC;AAC7C;AACA,OAAO,gDAAgD;;AAEvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,oCAAoC;AAC9D,2BAA2B,+DAA+D;AAC1F;AACA;AACA;;AAEA;AACA;;AAEA,cAAc,WAAW;AACzB,4BAA4B,yDAAyD;AACrF,kCAAkC,6BAA6B;AAC/D,qBAAqB,+CAA+C;AACpE;;AAEA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,kBAAkB;AACrC;AACA;AACA,0BAA0B,iCAAiC,mBAAmB;AAC9E,uBAAuB,uBAAuB;AAC9C;AACA;AACA;AACA;AACA;AACA,uBAAuB,0BAA0B;AACjD;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oCAAoC,4CAA4C;AAChF,UAAU,qBAAqB;AAC/B,qBAAqB;AACrB,iCAAiC,uCAAuC;AACxE;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,mBAAmB,kBAAkB;AACrC;AACA;AACA;AACA;AACA;;AAEA;AACA,2BAA2B,2BAA2B;;AAEtD;AACA;AACA;;AAEA,kCAAkC,OAAO;AACzC;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA,qBAAqB,kBAAkB,OAAO,0BAA0B;AACxE,KAAK;;AAEL;AACA;AACA;;AAEA,0BAA0B,QAAQ;AAClC,SAAS,4BAA4B,cAAc;AACnD;AACA;;AAEA;AACA;;AAEA;AACA;AACA,mBAAmB,qBAAqB;AACxC;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,2BAA2B,mBAAmB;;AAE9C;AACA;;AAEA;AACA,qBAAqB,0BAA0B;AAC/C;AACA;AACA;AACA;AACA;AACA,yBAAyB,gCAAgC,qBAAqB;AAC9E,+BAA+B;AAC/B;AACA,SAAS,OAAO,UAAU;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA,qBAAqB,0BAA0B,OAAO,oCAAoC;AAC1F,KAAK;;AAEL;AACA;;AAEA;AACA;AACA,qBAAqB,0BAA0B;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,0BAA0B;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,uCAAuC;AACvC;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,KAAK;;AAEL;AACA;;AAEA,qBAAqB,0BAA0B;AAC/C;AACA;AACA;AACA,0CAA0C;AAC1C,iCAAiC;AACjC;AACA,SAAS,OAAO,UAAU;AAC1B;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA,kBAAkB,2BAA2B;AAC7C,OAAO,4BAA4B,EAAE,EAAE;AACvC;AACA;AACA;;AAEA;AACA;;AAEA;AACA,4BAA4B;AAC5B,mBAAmB,eAAe,OAAO,uBAAuB,mBAAmB,EAAE;AACrF,qBAAqB,qBAAqB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,gBAAgB;AAChB,wCAAwC,4CAA4C;AACpF;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA,OAAO,0BAA0B;AACjC;;AAEA;AACA;AACA;AACA,iCAAiC,gCAAgC;AACjE;AACA;AACA,oCAAoC,sBAAsB;AAC1D,YAAY,uFAAuF;AACnG;AACA;AACA;AACA;AACA,2BAA2B,mCAAmC;AAC9D;AACA;AACA;AACA,KAAK;AACL,aAAa,qGAAqG;AAClH;AACA;;AAEA;;AAEA;AACA;AACA;AACA,MAAM,iBAAiB;AACvB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,iCAAiC;AACjC;AACA,iBAAiB,oBAAoB;AACrC;AACA;AACA,kBAAkB,kDAAkD;AACpE;AACA;AACA,mBAAmB,uBAAuB;AAC1C;AACA;AACA,oCAAoC,yCAAyC;AAC7E;AACA,8BAA8B,oBAAoB;AAClD,gCAAgC,oBAAoB;AACpD;AACA;AACA;AACA,SAAS,gDAAgD;AACzD;AACA,2DAA2D,kBAAkB,yBAAyB;AACtG;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL,8CAA8C,6BAA6B;AAC3E;AACA;AACA;AACA;AACA,eAAe,0BAA0B;AACzC;AACA,aAAa,sDAAsD;AACnE,iBAAiB,kBAAkB;AACnC,sBAAsB,qBAAqB;AAC3C;;AAEA,iEAAiE;AACjE,QAAQ;AACR;AACA;AACA;AACA;AACA;;AAEA,kDAAkD,UAAU;AAC5D;AACA,mBAAmB,uBAAuB;AAC1C;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA,oBAAoB;AACpB;;AAEA;AACA;AACA;AACA;;AAEA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,+CAA+C;AAC1D;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA,SAAS,wEAAwE;AACjF;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oCAAoC;AACpC;AACA,kCAAkC;;AAElC;AACA,kBAAkB,iCAAiC;AACnD;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,uCAAuC,4DAA4D;AACnG,+BAA+B,qCAAqC;AACpE;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA,OAAO,0BAA0B,uCAAuC,gBAAgB;;AAExF;AACA;AACA;AACA,SAAS,sBAAsB;AAC/B,qDAAqD,2BAA2B;AAChF;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,2BAA2B;AAC3B,oCAAoC,2BAA2B;AAC/D,KAAK,EAAE;;AAEP,8BAA8B,8CAA8C,uBAAuB,EAAE,EAAE;;AAEvG;AACA;AACA;AACA,SAAS,oBAAoB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,+BAA+B;AACzD;AACA,SAAS,uCAAuC;AAChD;AACA;AACA,SAAS,wBAAwB,cAAc,OAAO,8BAA8B,EAAE;AACtF,0BAA0B,0BAA0B;AACpD;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,mBAAmB,oBAAoB;AACvC,OAAO,4BAA4B;AACnC;;AAEA;AACA;;AAEA,iCAAiC;AACjC;AACA,mBAAmB,yBAAyB;AAC5C,OAAO,2BAA2B;AAClC;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,6CAA6C;AAChE;AACA,qBAAqB,uBAAuB;AAC5C,SAAS,8BAA8B,SAAS;AAChD;AACA,KAAK;AACL;AACA;;AAEA;AACA,4FAA4F,iBAAiB,EAAE;AAC/G;;AAEA;AACA,mBAAmB,oBAAoB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,mDAAmD,uBAAuB,EAAE;AAC5E,qBAAqB,2BAA2B;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,mBAAmB,oBAAoB;AACvC;;AAEA;AACA;AACA,iCAAiC;AACjC,4BAA4B,eAAe;;AAE3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,kCAAkC,8BAA8B;AAChE,qBAAqB,mCAAmC;AACxD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,8CAA8C;AAC7D,YAAY,sDAAsD;AAClE,KAAK;;AAEL;AACA;AACA;AACA,qBAAqB,kBAAkB,OAAO,2BAA2B;AACzE;AACA,KAAK;AACL,6BAA6B,sCAAsC,EAAE;;AAErE;AACA;;AAEA;AACA;AACA,8BAA8B;AAC9B;AACA,KAAK;AACL;AACA;AACA,wBAAwB;AACxB,oFAAoF;AACpF,oBAAoB,+BAA+B;AACnD;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,8BAA8B;AAC9B;AACA,KAAK;;AAEL,6BAA6B,iCAAiC,oBAAoB;;AAElF,mCAAmC,yBAAyB,8BAA8B;AAC1F,mCAAmC,oBAAoB;;AAEvD;AACA,oCAAoC,4BAA4B;AAChE;AACA,KAAK;;AAEL,2BAA2B,iBAAiB;AAC5C,2BAA2B,kBAAkB;AAC7C,0BAA0B,kCAAkC;;AAE5D,4BAA4B,0BAA0B;;AAEtD;AACA;AACA,6CAA6C,qBAAqB;AAClE,mCAAmC,uBAAuB;AAC1D,oEAAoE,qBAAqB;AACzF,YAAY,uBAAuB;AACnC;AACA,KAAK;AACL,gCAAgC,yBAAyB;AACzD,mCAAmC,oCAAoC;;AAEvE;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA,2BAA2B;AAC3B;AACA,qBAAqB,mBAAmB;AACxC,SAAS;AACT,4DAA4D;AAC5D,4BAA4B,2DAA2D;AACvF;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA,qBAAqB,mBAAmB;AACxC;AACA;AACA;AACA,8BAA8B;AAC9B,YAAY;AACZ,KAAK;AACL;AACA;;AAEA;AACA,qBAAqB,mBAAmB;AACxC;AACA,gCAAgC,mDAAmD;AACnF;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,qBAAqB,4BAA4B;AACjD,SAAS,eAAe;AACxB;AACA,KAAK;AACL;AACA;;AAEA;AACA,qBAAqB,uBAAuB;AAC5C;AACA,sBAAsB;AACtB;AACA;AACA,wCAAwC,UAAU;AAClD,SAAS,kCAAkC;AAC3C,mBAAmB,0CAA0C;AAC7D,yBAAyB,8BAA8B;AACvD,KAAK;AACL,kCAAkC,qCAAqC;AACvE,kCAAkC,qCAAqC;AACvE,2CAA2C,2CAA2C;AACtF,2CAA2C,2CAA2C;;AAEtF,iCAAiC,mBAAmB;AACpD,8BAA8B,mBAAmB;;AAEjD;AACA;AACA,qBAAqB,sBAAsB,OAAO,4BAA4B,QAAQ,EAAE;AACxF,uBAAuB,0BAA0B,SAAS,gCAAgC,UAAU,EAAE;AACtG,cAAc;AACd,KAAK;AACL,8BAA8B,wDAAwD;;AAEtF;AACA;AACA,KAAK;AACL;AACA;AACA,SAAS,+EAA+E;AACxF;AACA,KAAK;AACL;AACA;AACA,KAAK;;AAEL;AACA,cAAc;AACd;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,oEAAoE;AACpE;AACA,yCAAyC,2BAA2B;AACpE;AACA,OAAO;AACP,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;AACA,8CAA8C,2BAA2B;AACzE;AACA,WAAW;AACX;AACA,OAAO;AACP,KAAK;;AAEL;AACA;AACA;AACA,kCAAkC;AAClC;AACA;AACA,oBAAoB;AACpB,OAAO;AACP;AACA,wBAAwB;AACxB;AACA,cAAc;AACd;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,0BAA0B,kBAAkB;AAC5C,mDAAmD;AACnD,cAAc,yBAAyB;AACvC;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB,+BAA+B,mBAAmB;AAClD;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;;AAEL;AACA;AACA,KAAK;AACL,wCAAwC,gBAAgB,EAAE;;AAE1D;AACA;AACA,KAAK;AACL;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,kBAAkB,gBAAgB,kBAAkB;AACpD;AACA;AACA;AACA,WAAW,iDAAiD;AAC5D,OAAO;AACP;AACA,KAAK;AACL;AACA,iCAAiC;AACjC;AACA;AACA;AACA,oBAAoB,gBAAgB,kBAAkB;AACtD;AACA;AACA;AACA;AACA;AACA,aAAa,+CAA+C;AAC5D,SAAS;AACT;AACA,OAAO;AACP;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,kBAAkB,gBAAgB,gBAAgB;AAClD,WAAW,2BAA2B,6BAA6B,EAAE,EAAE;AACvE,OAAO;AACP;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,uBAAuB,UAAU;AACjC;AACA;AACA,OAAO;AACP;AACA,KAAK;AACL;AACA;AACA;AACA,sDAAsD;AACtD;AACA,0DAA0D;AAC1D;AACA,OAAO;AACP;AACA,KAAK;;AAEL;AACA;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA,qBAAqB,cAAc;AACnC;AACA,wDAAwD,qBAAqB;AAC7E,kDAAkD,iBAAiB;AACnE;AACA,+BAA+B;AAC/B,OAAO,EAAE,0CAA0C,0CAA0C;AAC7F,sBAAsB,0DAA0D;AAChF;AACA;AACA,KAAK;AACL;AACA;;AAEA,wCAAwC,mBAAmB;AAC3D,wBAAwB,gBAAgB,wBAAwB;AAChE;AACA,gCAAgC;AAChC;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,0CAA0C,8BAA8B,EAAE;AAC1E;AACA;AACA;AACA;AACA,KAAK;AACL,iCAAiC,qBAAqB;;AAEtD,yBAAyB,iBAAiB;AAC1C,2BAA2B,eAAe;;AAE1C;AACA,yBAAyB;AACzB;AACA,KAAK;AACL,+BAA+B,8BAA8B;;AAE7D;AACA,yBAAyB,aAAa;AACtC,kCAAkC;AAClC;AACA,iCAAiC,0BAA0B,EAAE;AAC7D,oBAAoB,2BAA2B;AAC/C,KAAK;AACL,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,aAAa,sBAAsB;AACnC;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA,oCAAoC,EAAE,kBAAkB,cAAc;AACtE;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,qBAAqB,OAAO,OAAO,uBAAuB;AAC1D,KAAK,OAAO;AACZ;AACA;AACA;AACA;AACA,gCAAgC,iCAAiC,EAAE;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,gCAAgC;AAC7C;AACA,yBAAyB,kBAAkB,uBAAuB;AAClE,aAAa,4EAA4E,EAAE;AAC3F;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,uEAAuE,WAAW;AAClF,gEAAgE;;AAEhE;AACA;;AAEA;AACA;AACA;AACA,wDAAwD,SAAS,QAAQ;AACzE,gCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,iCAAiC;AACpD;AACA;;AAEA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,2CAA2C;AAC3C;AACA,mBAAmB,oBAAoB;AACvC;AACA,eAAe,kBAAkB;AACjC;AACA,yBAAyB;AACzB,qBAAqB,oBAAoB,OAAO,eAAe;AAC/D,KAAK,EAAE;AACP;;AAEA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC;AAChC;AACA;AACA,OAAO,OAAO;AACd,KAAK;AACL;AACA,oCAAoC,kCAAkC,EAAE;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA,qBAAqB;AACrB;AACA;AACA;;AAEA;AACA,iBAAiB,QAAQ,OAAO,iDAAiD;AACjF;AACA,oBAAoB,WAAW,SAAS,0CAA0C;AAClF;AACA,mBAAmB,WAAW,SAAS,yDAAyD;;AAEhG;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,mBAAmB,sBAAsB;AACzC;AACA,wCAAwC,YAAY;AACpD,uCAAuC,YAAY;AACnD,iDAAiD,aAAa;AAC9D,yCAAyC,cAAc;AACvD,YAAY;AACZ;AACA,cAAc,sBAAsB;AACpC,eAAe,uBAAuB;AACtC,cAAc,sBAAsB;AACpC,gBAAgB,wBAAwB;AACxC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA,6DAA6D;AAC7D,2BAA2B,wBAAwB;;AAEnD;AACA,qBAAqB,iBAAiB;AACtC;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,oBAAoB,kBAAkB;AACtC,+BAA+B;AAC/B;AACA;AACA,KAAK;AACL,4BAA4B,2BAA2B;AACvD;AACA;;AAEA;AACA;AACA;AACA,0BAA0B;AAC1B,0BAA0B;AAC1B,yCAAyC;;AAEzC;AACA;AACA,SAAS;AACT,qBAAqB,+BAA+B;AACpD;AACA,qBAAqB;AACrB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,wCAAwC,sBAAsB;AAC9D,0EAA0E,uBAAuB;AACjG,yEAAyE,sBAAsB;AAC/F,wDAAwD,wBAAwB;AAChF;AACA;;AAEA;AACA;AACA,yDAAyD;AACzD;AACA,4CAA4C;AAC5C;AACA;AACA,2CAA2C,mBAAmB;AAC9D;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,mBAAmB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,QAAQ;AAC3C,SAAS,+DAA+D;AACxE;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,2DAA2D,EAAE;AACrG,mCAAmC,wCAAwC;AAC3E,SAAS,OAAO,oCAAoC;AACpD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,kCAAkC,wEAAwE;AAC1G;AACA;AACA,qCAAqC,SAAS,gCAAgC;AAC9E;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,sDAAsD;AACtD;AACA,2CAA2C;;AAE3C,YAAY,uCAAuC;AACnD;AACA;AACA;AACA,8CAA8C;AAC9C;AACA,0EAA0E;AAC1E;AACA;;AAEA;AACA;AACA,cAAc;;AAEd;AACA;AACA;AACA;AACA,gBAAgB;AAChB;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,oCAAoC,sFAAsF,EAAE;AAC5H,6BAA6B;AAC7B;AACA;AACA;AACA,WAAW,SAAS,kDAAkD;AACtE;AACA,WAAW,SAAS,gDAAgD;AACpE,OAAO;AACP,gBAAgB;AAChB;AACA,KAAK,EAAE,EAAE;AACT,+BAA+B,kDAAkD;AACjF;AACA;AACA,KAAK,EAAE,EAAE,EAAE,EAAE;AACb,gCAAgC,kDAAkD;AAClF;AACA,KAAK,EAAE,EAAE,EAAE,EAAE;AACb,uCAAuC;AACvC;AACA,mCAAmC,kBAAkB;AACrD,cAAc;AACd,KAAK,EAAE,EAAE;AACT,wCAAwC;AACxC;AACA,oCAAoC,qDAAqD;AACzF,cAAc;AACd,KAAK,EAAE,EAAE;AACT,yBAAyB,kBAAkB,EAAE;AAC7C,yBAAyB,kBAAkB,EAAE;AAC7C,kCAAkC,2BAA2B,EAAE;AAC/D,kCAAkC,2BAA2B,EAAE;AAC/D,+BAA+B,mDAAmD,EAAE;AACpF,6BAA6B,+CAA+C,EAAE;AAC9E,gCAAgC,gDAAgD,uCAAuC,EAAE;AACzH,OAAO;AACP,MAAM,EAAE;AACR,qCAAqC,gDAAgD,uCAAuC,EAAE;AAC9H,OAAO;AACP,MAAM,EAAE;AACR,8BAA8B,gDAAgD,qCAAqC,EAAE;AACrH,OAAO;AACP,MAAM,EAAE;AACR,gCAAgC;AAChC;AACA,4BAA4B,qDAAqD;AACjF,KAAK,YAAY,EAAE;AACnB,+BAA+B;AAC/B;AACA,4BAA4B,kBAAkB;AAC9C,KAAK,YAAY,EAAE;AACnB,oCAAoC;AACpC;AACA,+BAA+B,kBAAkB;AACjD,uDAAuD;AACvD;AACA,KAAK,YAAY,EAAE;AACnB,6BAA6B,6BAA6B,EAAE;AAC5D,+BAA+B,4BAA4B,EAAE;AAC7D,6BAA6B,6BAA6B,EAAE;AAC5D,+BAA+B,4BAA4B,EAAE;AAC7D,+BAA+B,6BAA6B,EAAE;AAC9D,gCAAgC,4BAA4B,EAAE;AAC9D,iCAAiC,+BAA+B,EAAE;AAClE,kCAAkC,8BAA8B,EAAE;AAClE,+BAA+B,6BAA6B,EAAE;AAC9D,iCAAiC,6BAA6B,EAAE;AAChE,gCAAgC,8BAA8B,EAAE;AAChE,gCAAgC,4BAA4B,EAAE;AAC9D,kCAAkC,+BAA+B,EAAE;AACnE,iCAAiC,8BAA8B,EAAE;AACjE,kCAAkC,+BAA+B,EAAE;AACnE,iCAAiC,8BAA8B,EAAE;AACjE,mCAAmC,gCAAgC,EAAE;AACrE,kCAAkC,+BAA+B,EAAE;AACnE,+BAA+B,oCAAoC,EAAE;AACrE,+BAA+B,kCAAkC,EAAE;AACnE,+BAA+B,uCAAuC,EAAE;AACxE,8BAA8B,kCAAkC,EAAE;AAClE;AACA;AACA,qBAAqB,mBAAmB;AACxC;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,mCAAmC,2BAA2B;AAC9D,YAAY,6BAA6B;AACzC,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC;AACnC;AACA,qBAAqB,mBAAmB;AACxC,iCAAiC;AACjC;AACA;AACA,sCAAsC,qCAAqC;AAC3E;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK,EAAE,EAAE;AACT,qCAAqC;AACrC;AACA,mCAAmC,QAAQ;AAC3C,SAAS,iFAAiF;AAC1F;AACA,uBAAuB,mBAAmB;AAC1C,SAAS,kDAAkD;AAC3D;AACA,KAAK,EAAE,EAAE;AACT,6BAA6B,2CAA2C,EAAE;AAC1E,oCAAoC,6BAA6B;AACjE;;;AAGA;AACA;AACA;AACA,yBAAyB,wBAAwB;AACjD;AACA;AACA;AACA;AACA;AACA,yBAAyB,wBAAwB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,+BAA+B;AAC3D,sBAAsB,0BAA0B;AAChD;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA,mBAAmB,6BAA6B;AAChD;AACA,mBAAmB;AACnB;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,gCAAgC;AAChC;AACA,SAAS,wBAAwB;AACjC;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS,EAAE;AACX,8DAA8D;AAC9D;AACA;AACA;;AAEA;AACA;;AAEA;AACA,OAAO,wBAAwB;AAC/B;AACA,OAAO,4CAA4C;;AAEnD;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,gBAAgB;;AAEhB;AACA;AACA;AACA;AACA,+DAA+D,qCAAqC,EAAE;AACtG;AACA;AACA,kBAAkB;AAClB,cAAc;AACd,KAAK;AACL,oDAAoD,+BAA+B,EAAE;AACrF;AACA;;AAEA;AACA;AACA,4DAA4D,qCAAqC,EAAE;AACnG;;AAEA;AACA;AACA;AACA;AACA,gCAAgC;AAChC;AACA,mDAAmD,uBAAuB;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,sCAAsC;AAC/C;;AAEA;AACA;AACA,OAAO,mBAAmB;AAC1B;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,0BAA0B,4BAA4B;AACtD;AACA;;AAEA;AACA;AACA,8GAA8G;AAC9G;AACA,8CAA8C,sBAAsB,qBAAqB;AACzF,4EAA4E;AAC5E;AACA;AACA,uBAAuB;AACvB,uCAAuC;AACvC;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wFAAwF;AACxF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,gCAAgC,0CAA0C,EAAE;AAC5E;AACA;AACA;AACA,+BAA+B;AAC/B;AACA;;AAEA;AACA;AACA,OAAO,2BAA2B;;AAElC,gEAAgE;;AAEhE;AACA,gBAAgB,oCAAoC;AACpD,iDAAiD,qBAAqB;AACtE,KAAK;AACL,gBAAgB,8BAA8B;AAC9C,8BAA8B,8BAA8B,EAAE;AAC9D,KAAK;AACL,8BAA8B,mCAAmC;AACjE,YAAY,oBAAoB;AAChC;AACA;;AAEA;AACA;AACA,6BAA6B,wBAAwB;AACrD,kCAAkC,wBAAwB;AAC1D;;AAEA;AACA,qCAAqC,yBAAyB;AAC9D,mBAAmB;AACnB;AACA;AACA,8BAA8B,+BAA+B;AAC7D;AACA,OAAO;AACP;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,gDAAgD;AAChG,+BAA+B,oDAAoD;AACnF,mCAAmC,0DAA0D;AAC7F;AACA;;AAEA;AACA,aAAa,sCAAsC;AACnD,UAAU,8BAA8B;;AAExC;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO,+CAA+C;AACtD;AACA,OAAO,4CAA4C;AACnD;;AAEA;AACA;AACA;AACA;AACA;AACA,mBAAmB,oCAAoC;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,2DAA2D;AACtE;AACA;AACA,WAAW,yBAAyB,2CAA2C,wBAAwB,MAAM;AAC7G;AACA,WAAW,uBAAuB;AAClC;AACA,KAAK;AACL;AACA;AACA;AACA,iCAAiC,qBAAqB;AACtD;AACA,iBAAiB,mCAAmC;AACpD;AACA;AACA;AACA,oCAAoC,6BAA6B;AACjE;AACA;AACA;AACA;;AAEA;AACA,4BAA4B,8BAA8B,EAAE;AAC5D;;AAEA;AACA,yBAAyB;AACzB,yBAAyB;AACzB,yBAAyB;AACzB;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS,6BAA6B;AACtC;AACA,SAAS,oCAAoC;AAC7C,KAAK;AACL;AACA;AACA;;AAEA;AACA,6BAA6B,oCAAoC;AACjE;AACA;AACA,KAAK;AACL;AACA;AACA,SAAS,mFAAmF;AAC5F;AACA,SAAS,qBAAqB;AAC9B;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,oBAAoB,gCAAgC;AACpD,KAAK;AACL;AACA,oBAAoB,gCAAgC;AACpD;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA,mCAAmC;AACnC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA,aAAa,gEAAgE;AAC7E;AACA,aAAa,yFAAyF;AACtG;AACA,6BAA6B,sCAAsC;AACnE;AACA,sBAAsB,gCAAgC;AACtD;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,WAAW,uCAAuC,0BAA0B,WAAW,GAAG,QAAQ;AAClG,OAAO;AACP;AACA,sBAAsB;AACtB,oCAAoC;AACpC;AACA;AACA,SAAS,OAAO;AAChB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,4CAA4C,SAAS;AACrD,YAAY,WAAW;AACvB,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,iEAAiE;AACjE;AACA,iBAAiB;AACjB;AACA,yDAAyD;AACzD;AACA,oDAAoD;;AAEpD;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS,oBAAoB;AAC7B;AACA,SAAS,oBAAoB;AAC7B;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,WAAW,gBAAgB,gBAAgB;AAC3C,gBAAgB;AAChB;AACA,6EAA6E;AAC7E,kBAAkB,qBAAqB;;AAEvC;AACA;;AAEA,uDAAuD;AACvD;;AAEA,mBAAmB,mCAAmC;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,qEAAqE;AACrE,+CAA+C;AAC/C,6BAA6B,mCAAmC;AAChE;;AAEA;AACA,+CAA+C;AAC/C;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,cAAc,qBAAqB;;AAEnC;AACA;;AAEA;AACA;;AAEA;AACA;AACA,mBAAmB;AACnB,6CAA6C,kBAAkB,sBAAsB,GAAG,UAAU;AAClG;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,4CAA4C,yBAAyB,EAAE;AACvE;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,iBAAiB;AACjB;AACA;AACA,0BAA0B;AAC1B;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA,OAAO;AACP,wCAAwC,QAAQ;AAChD,SAAS,+FAA+F;AACxG,KAAK;AACL;AACA;AACA,wBAAwB,cAAc;AACtC,KAAK;AACL,mFAAmF,qBAAqB,EAAE;AAC1G;AACA;AACA;AACA,KAAK;AACL,oDAAoD,4CAA4C,EAAE;AAClG,qDAAqD,6CAA6C,EAAE;AACpG,wDAAwD,gDAAgD,EAAE;AAC1G;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,gCAAgC,uBAAuB;AACvD,wBAAwB,+BAA+B;AACvD,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL,+DAA+D,6BAA6B,EAAE;AAC9F;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA,sDAAsD,gBAAgB,EAAE;AACxE;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,sDAAsD,WAAW,0BAA0B,GAAG;AAC9F;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,uCAAuC,EAAE;AAC1F;AACA,gDAAgD,qBAAqB,EAAE;AACvE;AACA;AACA,iBAAiB,kCAAkC;AACnD,KAAK;;AAEL,iDAAiD,yDAAyD,EAAE;AAC5G;AACA,mDAAmD,iCAAiC,EAAE;AACtF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,6BAA6B,EAAE;AAC3D;;AAEA;AACA;;AAEA;AACA;;AAEA,wCAAwC;;AAExC;AACA;AACA;;AAEA;AACA,iCAAiC,kFAAkF;AACnH,4BAA4B,+BAA+B;AAC3D;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO,sDAAsD;AAC7D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,uCAAuC,uBAAuB;;AAE9D;AACA;AACA,gCAAgC,yBAAyB,yCAAyC,EAAE,MAAM;;AAE1G;AACA;;AAEA;AACA;AACA;;AAEA;AACA,OAAO,qCAAqC;AAC5C;AACA,OAAO,cAAc;;AAErB,qCAAqC;AACrC,OAAO,iDAAiD,EAAE;AAC1D;AACA,6BAA6B,0BAA0B;AACvD,mBAAmB,sBAAsB,OAAO,sBAAsB;AACtE;AACA;AACA;AACA;AACA;AACA,OAAO,8CAA8C;AACrD;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,oCAAoC;AACpC;AACA,2EAA2E;AAC3E;AACA;AACA;AACA,OAAO,GAAG;AACV;AACA,OAAO,0CAA0C,qDAAqD,EAAE,EAAE;AAC1G;AACA;AACA;AACA,gDAAgD,6BAA6B,EAAE;;AAE/E;AACA,oCAAoC;AACpC;AACA;AACA,gDAAgD,6BAA6B,EAAE;AAC/E;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA,+BAA+B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,0BAA0B,4BAA4B;AACtD,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,6BAA6B;AACxC;AACA,WAAW,4BAA4B;AACvC;AACA,WAAW,4EAA4E;AACvF;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA,+CAA+C,6BAA6B,EAAE;AAC9E,mDAAmD,6BAA6B,EAAE;;AAElF;AACA,yCAAyC,uDAAuD,EAAE;;AAElG;AACA,2BAA2B,6BAA6B,WAAW,GAAG;AACtE,0BAA0B,6BAA6B,mBAAmB,WAAW,GAAG;AACxF,2BAA2B,2BAA2B,EAAE;AACxD;AACA,2BAA2B,6BAA6B,qBAAqB;AAC7E;;AAEA;AACA,mCAAmC,4BAA4B,EAAE;AACjE;AACA;AACA,mCAAmC,uBAAuB,EAAE;AAC5D,kCAAkC,sBAAsB,EAAE;AAC1D;;AAEA;AACA,4CAA4C,0BAA0B;;AAEtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,aAAa;AACnC;AACA;AACA;AACA,6BAA6B,cAAc;AAC3C,YAAY,uCAAuC;AACnD;;AAEA;AACA;AACA,0BAA0B,wBAAwB;AAClD;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA,0BAA0B,kEAAkE;AAC5F,YAAY,iBAAiB;AAC7B,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA,OAAO,gDAAgD,GAAG,OAAO,eAAe,uBAAuB;AACvG,4BAA4B,6CAA6C;;AAEzE;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,uBAAuB,6BAA6B;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,4BAA4B,+BAA+B;AAC3D;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAe,eAAe;;AAE9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,4BAA4B;AACrD,aAAa,qDAAqD;AAClE;AACA,OAAO;AACP,kDAAkD,YAAY,EAAE;AAChE;AACA;;AAEA;AACA;AACA,yCAAyC,UAAU;AACnD;AACA;AACA;AACA;AACA,WAAW,0CAA0C;AACrD;AACA,WAAW,+FAA+F;AAC1G;AACA,WAAW,+BAA+B;AAC1C;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA,OAAO,+BAA+B;;AAEtC;AACA,mCAAmC,oCAAoC;AACvE;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS,0BAA0B,qDAAqD,EAAE,EAAE;AAC5F;AACA;AACA;;AAEA;AACA;AACA,+DAA+D;AAC/D;;AAEA,uCAAuC,QAAQ;AAC/C;AACA,+FAA+F;AAC/F;AACA;AACA;AACA,uBAAuB,+BAA+B;AACtD,WAAW;AACX;AACA;AACA,WAAW;AACX,OAAO;AACP;AACA,WAAW,wDAAwD;AACnE;AACA,qBAAqB,0DAA0D;AAC/E;AACA;;AAEA;AACA;AACA,mBAAmB,8BAA8B;AACjD;AACA,uBAAuB;AACvB;AACA;AACA;AACA,YAAY;AACZ;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,6DAA6D,cAAc,YAAY,YAAY,aAAa;AAChH,uDAAuD,oBAAoB,YAAY,aAAa;AACpG;AACA;AACA;AACA;AACA,iBAAiB,2BAA2B;AAC5C,UAAU,gCAAgC;AAC1C,oBAAoB;AACpB,cAAc,qCAAqC;AACnD;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,wBAAwB,eAAe,6BAA6B;;AAEpE;AACA;AACA,2DAA2D;AAC3D;AACA;AACA,WAAW,2DAA2D;AACtE;AACA,OAAO;;AAEP,mCAAmC,4BAA4B;AAC/D,0BAA0B,gBAAgB;;AAE1C;AACA;AACA,OAAO;AACP;AACA;AACA,uBAAuB,iBAAiB;AACxC,WAAW;AACX;AACA;AACA,WAAW;AACX,OAAO;;AAEP;AACA;AACA,8BAA8B;AAC9B;AACA,sBAAsB;AACtB,mEAAmE;AACnE,yCAAyC,yBAAyB,EAAE;AACpE;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA,uBAAuB,qBAAqB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA,4BAA4B,mDAAmD;AAC/E,gBAAgB,gCAAgC;AAChD;AACA,kCAAkC,sCAAsC;AACxE,OAAO;AACP;AACA;;AAEA;AACA,uBAAuB,mBAAmB;AAC1C;AACA;AACA;AACA;AACA;AACA,+BAA+B,SAAS;AACxC,eAAe,4BAA4B;AAC3C;AACA;AACA,eAAe,wFAAwF;AACvG,WAAW;AACX;AACA;AACA,gDAAgD,6BAA6B;AAC7E;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA;AACA,sBAAsB,kBAAkB;AACxC,cAAc,QAAQ;AACtB;AACA,sDAAsD,aAAa;AACnE,8CAA8C,kBAAkB;AAChE,gBAAgB,4BAA4B;AAC5C,SAAS;AACT;AACA;AACA,OAAO;;AAEP;AACA;AACA,8BAA8B;AAC9B;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;;AAEA;AACA,4CAA4C;AAC5C;AACA;AACA,iCAAiC,8BAA8B;AAC/D,SAAS;AACT,yBAAyB,uBAAuB;AAChD;AACA,sBAAsB,iBAAiB;AACvC;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA,yBAAyB,2BAA2B;AACpD;AACA;AACA,aAAa,qBAAqB;AAClC;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA,4BAA4B,qBAAqB;AACjD,4CAA4C,gCAAgC;AAC5E,cAAc,+CAA+C;AAC7D;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA,OAAO;;AAEP;AACA,wCAAwC,qBAAqB;AAC7D;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,sCAAsC,uBAAuB;AAC7D,iCAAiC,aAAa,YAAY;AAC1D;AACA,SAAS;AACT;AACA;AACA,+CAA+C,gBAAgB;AAC/D;AACA,OAAO;;AAEP,qCAAqC,kCAAkC;AACvE,oCAAoC,iCAAiC;;AAErE,+BAA+B,SAAS,sDAAsD;;AAE9F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,sEAAsE;AACtE;AACA,aAAa,mCAAmC;AAChD;AACA,aAAa,kBAAkB;AAC/B;AACA,aAAa,kCAAkC;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,gCAAgC,UAAU;AAC1C,uCAAuC,2DAA2D;AAClG;AACA;AACA;AACA,WAAW,uBAAuB,sFAAsF,EAAE;AAC1H,OAAO;;AAEP;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW;AACX,OAAO;;AAEP,gDAAgD,6BAA6B,EAAE;;AAE/E;AACA;;AAEA;AACA,yBAAyB,UAAU,kBAAkB;AACrD;AACA,uBAAuB,YAAY;AACnC;AACA,4BAA4B;AAC5B;AACA;AACA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA,aAAa;AACb;AACA,aAAa;AACb,SAAS;AACT,OAAO;;AAEP;AACA;AACA;AACA,WAAW,2CAA2C;AACtD;AACA,WAAW;AACX;AACA,8BAA8B,+BAA+B,IAAI;AACjE,WAAW,EAAE;AACb,OAAO;;AAEP;AACA;;AAEA;AACA,yBAAyB,UAAU,kBAAkB;AACrD;AACA,uBAAuB,YAAY;AACnC;AACA,0BAA0B,iBAAiB;AAC3C,gBAAgB,iBAAiB;AACjC;AACA,4BAA4B;AAC5B;AACA;AACA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,4CAA4C,oCAAoC;AAChF;AACA;AACA;AACA,aAAa,0EAA0E;AACvF;AACA,SAAS;AACT,2BAA2B,gBAAgB,2BAA2B;AACtE,WAAW,yCAAyC,EAAE;AACtD,OAAO;;AAEP;AACA;AACA;AACA;AACA;AACA;AACA,wEAAwE,SAAS,EAAE,OAAO,OAAO;AACjG;AACA;AACA,6BAA6B,+BAA+B;AAC5D,oDAAoD,sBAAsB;AAC1E,6BAA6B,4CAA4C;AACzE,8DAA8D,SAAS;AACvE,gEAAgE,OAAO;AACvE;AACA;AACA,OAAO;;AAEP;AACA,6DAA6D;AAC7D;AACA,WAAW,0DAA0D;AACrE;AACA,WAAW,yDAAyD;;AAEpE;AACA,OAAO;AACP,4BAA4B,sDAAsD;AAClF,8BAA8B,wDAAwD;;AAEtF,0CAA0C,4BAA4B,EAAE;AACxE;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA,sBAAsB;AACtB,+BAA+B,0CAA0C;AACzE,SAAS;AACT,sBAAsB;AACtB,SAAS;AACT,sBAAsB;AACtB;AACA,2BAA2B,6BAA6B;AACxD;;AAEA;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;;AAEP;AACA;;AAEA,wCAAwC,+EAA+E;AACvH,4BAA4B,qDAAqD;AACjF,6BAA6B,uDAAuD;AACpF,wCAAwC,iCAAiC;AACzE;AACA;AACA,6BAA6B,gBAAgB,yBAAyB;AACtE,aAAa,iCAAiC,4CAA4C,QAAQ,EAAE;AACpG;AACA,SAAS;AACT;AACA;AACA,OAAO;;AAEP,6BAA6B,wBAAwB;AACrD,iCAAiC,4BAA4B;AAC7D,+BAA+B,0BAA0B;;AAEzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,2BAA2B;AACtC;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA,uCAAuC,4BAA4B;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA,OAAO;;AAEP,gCAAgC,qCAAqC;AACrE,oCAAoC,4BAA4B;AAChE,qCAAqC,6BAA6B;AAClE,mCAAmC;AACnC;AACA;;AAEA;AACA,0CAA0C,qCAAqC,aAAa;AAC5F;AACA;AACA;AACA;AACA,kCAAkC,4BAA4B;AAC9D;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW,2DAA2D;AACtE;AACA,WAAW;AACX,OAAO;AACP;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA,6BAA6B;AAC7B,2CAA2C;AAC3C;AACA;AACA;AACA;AACA;AACA,uCAAuC,YAAY;AACnD;AACA,wBAAwB,QAAQ,YAAY;AAC5C;AACA;;AAEA,mBAAmB,gBAAgB;AACnC,2CAA2C;AAC3C;AACA;AACA;AACA,yCAAyC,uBAAuB;AAChE;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,KAAK;AACL;AACA;AACA;AACA,WAAW;AACX;AACA,4BAA4B;AAC5B,+CAA+C,uBAAuB;AACtE;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,wDAAwD;AACxD;AACA,6BAA6B,uCAAuC,+BAA+B,EAAE,OAAO;AAC5G,KAAK;;AAEL;AACA,0BAA0B;AAC1B,KAAK;AACL;AACA,8BAA8B,qBAAqB,2BAA2B;AAC9E,KAAK;AACL;AACA;AACA,8CAA8C,0BAA0B;AACxE;AACA;AACA,KAAK;;AAEL,uCAAuC,oCAAoC,EAAE;;AAE7E;AACA,8BAA8B,0BAA0B;AACxD,KAAK;;AAEL;AACA,kCAAkC;AAClC;AACA,uBAAuB,0CAA0C;AACjE,8BAA8B,sCAAsC;AACpE,OAAO;AACP;AACA,OAAO;AACP;AACA,uBAAuB,kCAAkC;AACzD;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,8BAA8B;AAC5D,OAAO;AACP;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,gDAAgD;AAChD,kCAAkC,6BAA6B;AAC/D;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;;AAEA;AACA;AACA;AACA;;AAEA;AACA,SAAS,6DAA6D;AACtE,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,0CAA0C,mBAAmB;AAC7D,uBAAuB,yBAAyB;AAChD;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS,kCAAkC,gDAAgD,EAAE,EAAE;AAC/F,KAAK;AACL;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,yCAAyC;AACzC,uCAAuC;AACvC;;AAEA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS,mDAAmD;AAC5D;AACA;AACA;AACA,qDAAqD,iBAAiB;AACtE,yDAAyD;;AAEzD,8DAA8D;;AAE9D;AACA;AACA;AACA,OAAO,sBAAsB;AAC7B;AACA,OAAO,+BAA+B,+CAA+C,EAAE,EAAE;;AAEzF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,sFAAsF;AACtF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,sDAAsD;AACtF;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA,yBAAyB;AACzB;AACA,mCAAmC,kCAAkC;AACrE,KAAK,EAAE;AACP;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO,kEAAkE;AACzE;AACA,OAAO,0BAA0B;AACjC,uEAAuE;;AAEvE;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA,oBAAoB;AACpB;AACA;AACA;AACA,yCAAyC,eAAe,eAAe,UAAU;AACjF,0CAA0C,iBAAiB,iBAAiB,YAAY;AACxF,YAAY;AACZ;;AAEA;AACA;AACA;AACA,OAAO,YAAY;AACnB;AACA;AACA;AACA;AACA;AACA,OAAO,UAAU;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,sCAAsC;AACtC;AACA;AACA;AACA,oCAAoC,yBAAyB;AAC7D,cAAc;AACd;AACA;AACA,KAAK;AACL;;AAEA;AACA;;AAEA;AACA,OAAO,+BAA+B,6BAA6B,EAAE,EAAE;AACvE;;AAEA;AACA;AACA;;AAEA;AACA,4CAA4C;AAC5C;AACA;AACA,OAAO,kHAAkH;AACzH;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,+BAA+B;AAC/B;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,yBAAyB,MAAM;AAC/B,OAAO,wDAAwD,cAAc;AAC7E;AACA;;AAEA,6BAA6B,WAAW,gBAAgB,EAAE;;AAE1D;AACA;AACA,kCAAkC,2BAA2B,wBAAwB,EAAE;AACvF;AACA;AACA;AACA,6BAA6B,iBAAiB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,uEAAuE;AACpF;AACA;AACA,8DAA8D;AAC9D;AACA,2EAA2E;;AAE3E,sBAAsB,SAAS;AAC/B,uBAAuB,4BAA4B;AACnD,WAAW,0BAA0B;;AAErC,+CAA+C,uBAAuB;AACtE,sBAAsB,gBAAgB;AACtC,OAAO;AACP;AACA;AACA;AACA,WAAW;AACX;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,sBAAsB;AACtB,kBAAkB;AAClB,KAAK;AACL,4BAA4B;AAC5B,0DAA0D;AAC1D,+EAA+E;AAC/E;AACA;AACA,mBAAmB,4BAA4B;AAC/C;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA,4CAA4C;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,mBAAmB,oCAAoC;AACvD;AACA,2CAA2C,8BAA8B;AACzE;;AAEA;AACA,sBAAsB,8BAA8B;AACpD;AACA,uBAAuB,mBAAmB;AAC1C;AACA;AACA;AACA;AACA,oDAAoD,mCAAmC;AACvF;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;;AAEhB;AACA,mGAAmG,OAAO;AAC1G;AACA;AACA,SAAS;AACT;AACA,SAAS,kCAAkC;AAC3C;AACA,+DAA+D,QAAQ;AACvE;AACA;AACA,SAAS;AACT;AACA,SAAS,qCAAqC;AAC9C;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA,cAAc,wBAAwB;;AAEtC;AACA,yDAAyD,4BAA4B;AACrF;AACA,KAAK;;AAEL;AACA,wDAAwD;;AAExD;AACA;AACA,KAAK;;AAEL;AACA,kCAAkC;AAClC;AACA,uBAAuB,0CAA0C;AACjE,OAAO;AACP;AACA,OAAO;AACP;AACA,uBAAuB,kCAAkC;AACzD;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,4BAA4B,kCAAkC;AAC9D;AACA;AACA;;AAEA;AACA,+DAA+D;AAC/D;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,uCAAuC,qBAAqB;AAC5D,KAAK;;AAEL;AACA;AACA,4BAA4B,+BAA+B;AAC3D;AACA;AACA,uDAAuD,kCAAkC;AACzF;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,oDAAoD;AACpD;AACA;AACA;AACA;AACA;AACA,6BAA6B,4BAA4B;AACzD,kCAAkC,6BAA6B;AAC/D,KAAK;AACL;AACA,kCAAkC,0BAA0B;AAC5D;AACA;;AAEA,kDAAkD;;AAElD,uDAAuD;;AAEvD;AACA;AACA,WAAW,uBAAuB;AAClC,kBAAkB;AAClB;AACA;;AAEA,8CAA8C,sBAAsB;;AAEpE;AACA;AACA;;AAEA,uDAAuD,iBAAiB;;AAExE;AACA;AACA;AACA;;AAEA,2BAA2B;AAC3B;AACA;AACA,oCAAoC,mBAAmB;AACvD,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,cAAc;AAC9C,YAAY,0BAA0B;AACtC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA,uDAAuD;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,0CAA0C,sBAAsB;AAChE,4BAA4B,cAAc;AAC1C;AACA;AACA;AACA,6EAA6E,QAAQ;;AAErF;AACA;AACA;;AAEA;AACA,0DAA0D,qCAAqC;AAC/F,YAAY,yBAAyB;;AAErC;AACA;AACA;AACA,4CAA4C,kCAAkC;AAC9E;AACA,KAAK;AACL;AACA;;AAEA;AACA,0CAA0C,0BAA0B;AACpE;;AAEA;AACA,gCAAgC,0BAA0B;AAC1D;AACA;;AAEA;AACA;AACA,mCAAmC,4BAA4B;AAC/D;AACA,yBAAyB,SAAS;;AAElC;AACA;AACA;AACA;AACA,OAAO,2EAA2E;;AAElF;AACA;AACA;AACA,2CAA2C,aAAa,cAAc,wDAAwD,mDAAmD,sBAAsB,uEAAuE,sBAAsB,iBAAiB,eAAe,kBAAkB,cAAc,0BAA0B;AAC9X;AACA,iBAAiB,6BAA6B,EAAE;AAChD;AACA,iBAAiB,mCAAmC;AACpD;AACA;AACA,kCAAkC,kCAAkC;AACpE;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA,8BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C;AAC/C;AACA;AACA;AACA,iCAAiC,yEAAyE;;AAE1G;AACA;AACA,4CAA4C,wBAAwB;AACpE;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,gCAAgC,wBAAwB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA,eAAe,cAAc;AAC7B;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,OAAO,sCAAsC;AAC7C;AACA,OAAO,4CAA4C;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,qBAAqB;;AAErB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA,oCAAoC,iBAAiB;AACrD;AACA,8BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,mCAAmC;AAChD;AACA;AACA;;AAEA;AACA,yCAAyC,qEAAqE,EAAE;AAChH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA,mCAAmC;AACnC,KAAK;AACL,yBAAyB;AACzB,KAAK,uBAAuB,EAAE;;AAE9B;AACA,4BAA4B;;AAE5B;AACA;AACA;AACA;AACA,sDAAsD,iCAAiC;AACvF;AACA;;AAEA;;AAEA;AACA,6CAA6C,UAAU,0BAA0B,2BAA2B,GAAG,EAAE,EAAE;AACnH;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,CAAC;;;;;;;;;;;;AC1hTD;AACA;;AAEA;AACA,MAAM,IAAuD;AAC7D,QAAQ,mBAAO,CAAC,yEAAsB;AACtC,OAAO,EAGa;AACpB,CAAC;AACD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,uBAAuB,QAAQ;AAC/B;AACA,2CAA2C;;AAE3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK,kBAAkB,MAAM;AAC7B;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,kEAAkE;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,eAAe;AACf,6CAA6C,GAAG,IAAI;AACpD;AACA;;AAEA;AACA,6BAA6B,UAAU;AACvC;AACA;AACA;AACA,qBAAqB,OAAO,OAAO;AACnC,2BAA2B,oCAAoC,OAAO;AACtE,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,qBAAqB;;AAErB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,iCAAiC,GAAG;AACpC;AACA,gCAAgC,IAAI;AACpC,2BAA2B,GAAG;AAC9B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,qBAAqB,oBAAoB,8BAA8B;;AAEvE;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,YAAY;AACZ;AACA,sCAAsC,QAAQ;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,GAAG;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,uCAAuC,kBAAkB,kBAAkB;AAC3E,4BAA4B,kBAAkB;;AAE9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,2CAA2C;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,2BAA2B,eAAe;AAC1C;AACA;AACA;AACA;;AAEA;AACA,8EAA8E;AAC9E;AACA;AACA,+HAA+H;AAC/H,iDAAiD;AACjD,kBAAkB,yBAAyB;AAC3C,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,+FAA+F;AAC/F,4DAA4D,cAAc;AAC1E,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,2EAA2E,cAAc;AACzF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,4DAA4D,uBAAuB,uDAAuD;AAC1I;AACA;AACA;AACA;AACA,kBAAkB,kCAAkC;AACpD;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,EAAE;AACxB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,wBAAwB;AAClD,kBAAkB;AAClB;AACA;AACA;AACA,gCAAgC,uBAAuB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C;AAC5C;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,uBAAuB,iCAAiC;AACpF;AACA;AACA,4BAA4B,uBAAuB,mCAAmC;AACtF;AACA;AACA;AACA,6CAA6C;AAC7C;AACA;AACA,6BAA6B,uBAAuB;AACpD;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,+BAA+B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,yBAAyB,yBAAyB,MAAM;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,uBAAuB;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,sBAAsB;AAChD;AACA;AACA;AACA,oCAAoC,uBAAuB;AAC3D,6BAA6B,iBAAiB,eAAe;AAC7D;AACA;AACA,kBAAkB,sCAAsC;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB,yCAAyC,uBAAuB;AAChE;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C,6BAA6B,gBAAgB;AAC7C;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C,6BAA6B,gBAAgB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,uBAAuB,qBAAqB;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,gBAAgB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,yBAAyB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,uBAAuB,iCAAiC,IAAI;AACnF,6BAA6B,uBAAuB,kCAAkC,IAAI;AAC1F,kBAAkB,uCAAuC,wBAAwB;AACjF;AACA;AACA;AACA,wBAAwB,uBAAuB,iCAAiC;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,qCAAqC;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,uBAAuB,yBAAyB;AACxE;AACA;AACA,0BAA0B,uBAAuB,yBAAyB;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,cAAc,2BAA2B;AAC5F;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,0EAA0E,IAAI;AAC9E,uCAAuC;AACvC;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,0EAA0E,QAAQ;AAClF;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,gDAAgD;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL,gDAAgD,GAAG;AACnD;AACA;AACA;AACA;AACA;AACA,0BAA0B;;AAE1B;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;;AAEA;AACA;AACA;AACA;AACA;AACA,2CAA2C,+BAA+B;AAC1E,6CAA6C,+BAA+B;AAC5E,8CAA8C,iCAAiC;AAC/E,0CAA0C,uCAAuC;AACjF,iDAAiD,uCAAuC;;AAExF,CAAC;;;;;;;;;;;;;ACv5BD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACO;AACA;AACA;AACP;AACA;AACA;AACA,WAAW,KAAK;AAChB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;;AAEO;AACP;AACA,C;;;;;;;;;;;;ACvCA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAwC;AACN;AACE;AACF;AACA;AACA;AACE;AACF;AACA;AACA;;;;;;;;;;;;;ACTlC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAwC;AACxC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,KAAK;AAClB;;AAEO;AACP,gBAAgB,qDAAmB;;AAEnC,MAAM,qDAAmB;AACzB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP,gBAAgB,qDAAmB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP,gBAAgB,qDAAmB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA,gBAAgB;;AAEhB;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,aAAa,OAAO;AACpB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,aAAa,OAAO;AACpB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,aAAa,OAAO;AACpB;;AAEO;AACP;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,QAAQ;AACrB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,QAAQ;AACrB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,kDAAgB,qEAAqE,kDAAgB,qEAAqE,kDAAgB,qEAAqE,kDAAgB;AAC7S;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;;AAEO;AACP;AACA,cAAc;AACd;AACA;;AAEO,mB;;;;;;;;;;;;AC/aP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAwC;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,MAAM;AACnB;;AAEO;AACP,gBAAgB,qDAAmB;;AAEnC,MAAM,qDAAmB;AACzB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,aAAa,MAAM;AACnB;;AAEO;AACP,gBAAgB,qDAAmB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,aAAa,MAAM;AACnB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,aAAa,MAAM;AACnB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,MAAM;AACnB;;AAEO;AACP,gBAAgB,qDAAmB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,MAAM;AACnB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,aAAa,MAAM;AACnB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,aAAa,OAAO;AACpB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,aAAa,MAAM;AACnB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,WAAW,OAAO;AAClB,aAAa,MAAM;AACnB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,WAAW,KAAK;AAChB,aAAa,MAAM;AACnB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,WAAW,KAAK;AAChB,aAAa,MAAM;AACnB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,OAAO;AAClB,aAAa,MAAM;AACnB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,KAAK;AAChB,aAAa,MAAM;AACnB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,KAAK;AAChB,aAAa,MAAM;AACnB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,aAAa,OAAO;AACpB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,aAAa,OAAO;AACpB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,aAAa,MAAM;AACnB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,aAAa,MAAM;AACnB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,WAAW,OAAO;AAClB,aAAa,MAAM;AACnB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,WAAW,OAAO;AAClB,aAAa,MAAM;AACnB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,aAAa,QAAQ;AACrB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,aAAa,QAAQ;AACrB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,kDAAgB,qEAAqE,kDAAgB,qEAAqE,kDAAgB,qEAAqE,kDAAgB,qEAAqE,kDAAgB,qEAAqE,kDAAgB;AACvd;AACA;AACA,cAAc;AACd;AACA;;AAEO;AACP;AACA,cAAc;AACd;AACA;;AAEO,mB;;;;;;;;;;;;ACreP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAwC;AACxC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,KAAK;AAClB;;AAEO;AACP,gBAAgB,qDAAmB;;AAEnC,MAAM,qDAAmB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP,gBAAgB,qDAAmB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP,gBAAgB,qDAAmB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC;;AAElC;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,aAAa,OAAO;AACpB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,MAAM;AACjB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,KAAK;AACf,UAAU,KAAK;AACf;AACA,YAAY,KAAK;AACjB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,KAAK;AACf,UAAU,KAAK;AACf;AACA,YAAY,KAAK;AACjB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC;;AAElC;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,aAAa,OAAO;AACpB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,aAAa,OAAO;AACpB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,QAAQ;AACrB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,QAAQ;AACrB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,kDAAgB,qEAAqE,kDAAgB,qEAAqE,kDAAgB,qEAAqE,kDAAgB,qEAAqE,kDAAgB,qEAAqE,kDAAgB,qEAAqE,kDAAgB,qEAAqE,kDAAgB,qEAAqE,kDAAgB;AACttB;AACA;AACA,cAAc;AACd;AACA;;AAEO;AACP;AACA,cAAc;AACd;AACA;;AAEO,mB;;;;;;;;;;;;AC1wBP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAwC;AACxC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,KAAK;AAClB;;AAEO;AACP,gBAAgB,qDAAmB;;AAEnC,MAAM,qDAAmB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP,gBAAgB,qDAAmB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP,gBAAgB,qDAAmB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC;;AAElC;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,aAAa,OAAO;AACpB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC;;AAElC;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;;AAElB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,YAAY,kDAAgB;AAC5B;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;;AAEd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;;AAEtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;;AAGH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;;AAGH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;;AAGH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;;AAEA,YAAY,kDAAgB;AAC5B;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;;AAEZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA,wBAAwB;;AAExB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA,wBAAwB;;AAExB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA,wBAAwB;;AAExB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,MAAM;AACjB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,MAAM;AACjB,aAAa,KAAK;AAClB;;AAEO;AACP,wBAAwB,qDAAmB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD;;AAExD;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,KAAK;AACjB,YAAY,KAAK;AACjB,YAAY,KAAK;AACjB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,KAAK;AACjB,YAAY,KAAK;AACjB,YAAY,KAAK;AACjB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,YAAY,KAAK;AACjB;;AAEO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,MAAM;AACjB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,MAAM;AACjB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB;AACA,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,iCAAiC,kDAAgB,+BAA+B,kDAAgB,+BAA+B,kDAAgB;AAC/I;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,aAAa,OAAO;AACpB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,aAAa,OAAO;AACpB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,QAAQ;AACrB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,QAAQ;AACrB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,kDAAgB,qEAAqE,kDAAgB,qEAAqE,kDAAgB,qEAAqE,kDAAgB,qEAAqE,kDAAgB,qEAAqE,kDAAgB,qEAAqE,kDAAgB,qEAAqE,kDAAgB,qEAAqE,kDAAgB,qEAAqE,kDAAgB,uEAAuE,kDAAgB,yEAAyE,kDAAgB,yEAAyE,kDAAgB,yEAAyE,kDAAgB,yEAAyE,kDAAgB,yEAAyE,kDAAgB;AAC/zC;AACA;AACA,cAAc;AACd;AACA;;AAEO;AACP;AACA,cAAc;AACd;AACA;;AAEO,mB;;;;;;;;;;;;ACzwDP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAwC;AACN;AACA;AACA;AAClC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,KAAK;AAClB;;AAEO;AACP,gBAAgB,qDAAmB;;AAEnC,MAAM,qDAAmB;AACzB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,KAAK;AACjB,YAAY,KAAK;AACjB,YAAY,OAAO;AACnB;;AAEO;AACP;AACA;;AAEA,UAAU,kDAAgB;AAC1B;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C;;AAE1C,gDAAgD;;AAEhD;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;;AAGH,oBAAoB,kDAAgB;AACpC;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;;;AAGH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA,WAAW,iDAAe;AAC1B,WAAW,iDAAe;AAC1B,WAAW,iDAAe;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA,mCAAmC;;AAEnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;AACA;;AAEO;AACP;AACA;AACA;AACA;;AAEA;AACA;AACA,oCAAoC;;AAEpC;AACA,wBAAwB;;AAExB;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,EAAE;AACb,WAAW,EAAE;AACb,WAAW,EAAE;AACb,aAAa,KAAK;AAClB;AACA;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,aAAa,OAAO;AACpB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;AACA;;AAEO,YAAY,8CAAU;AAC7B;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;AACA;;AAEO,iBAAiB,mDAAe;AACvC;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;AACA;;AAEO,WAAW,6CAAS;AAC3B;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;AACA;;AAEO,UAAU,4CAAQ;AACzB;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;AACA;;AAEO,UAAU,4CAAQ;AACzB;AACA,cAAc;AACd;AACA;;AAEO;AACP;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;AACA;;AAEO,YAAY,8CAAU;AAC7B;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,OAAO;AACpB;AACA;;AAEO,UAAU,4CAAQ;AACzB;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;AACA;;AAEO,WAAW,6CAAS;AAC3B;AACA;AACA;AACA,WAAW,KAAK;AAChB,aAAa,OAAO;AACpB;;AAEO,aAAa,+CAAW;AAC/B;AACA,cAAc;AACd;AACA;;AAEO;AACP;AACA;AACA;AACA,WAAW,KAAK;AAChB,aAAa,OAAO;AACpB;AACA;;AAEO,oBAAoB,sDAAkB;AAC7C;AACA,cAAc;AACd;AACA;;AAEO;AACP;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;AACA;;AAEO,gBAAgB,kDAAc;AACrC;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,QAAQ;AACrB;;AAEO,kBAAkB,oDAAgB;AACzC;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,QAAQ;AACrB;;AAEO,aAAa,+CAAW;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP,gBAAgB,+CAAW;AAC3B,kBAAkB,mDAAe;AACjC,kBAAkB,mDAAe;AACjC;AACA,cAAc,4CAAQ;;AAEtB;AACA,MAAM,8CAAU;AAChB,UAAU,4CAAQ,sBAAsB,8CAAU;AAClD,MAAM,kDAAc;AACpB;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,MAAM,8CAAU;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP,aAAa,+CAAW;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,G;;;;;;;;;;;;AC/nBD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAwC;AACN;AACA;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,MAAM;AACnB;;AAEO;AACP,eAAe,qDAAmB;;AAElC,MAAM,qDAAmB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,aAAa,MAAM;AACnB;AACA;;AAEO;AACP,eAAe,qDAAmB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,MAAM;AACnB;AACA;;AAEO;AACP,eAAe,qDAAmB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,MAAM;AACnB;AACA;;AAEO;AACP,eAAe,qDAAmB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,MAAM;AACnB;AACA;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,KAAK;AAChB,aAAa,MAAM;AACnB;AACA;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,KAAK;AAChB,aAAa,MAAM;AACnB;AACA;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,KAAK;AAChB,aAAa,MAAM;AACnB;AACA;;AAEO;AACP;AACA,cAAc,+CAAW;AACzB,EAAE,oDAAgB;AAClB,cAAc,qDAAmB;AACjC,EAAE,uDAAmB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,aAAa,MAAM;AACnB;AACA;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,aAAa,MAAM;AACnB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,MAAM;AACnB;AACA;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,KAAK;AACjB,YAAY,MAAM;AAClB,YAAY,KAAK;AACjB;;AAEO,cAAc,6CAAS;AAC9B;AACA;AACA,YAAY,KAAK;AACjB,YAAY,MAAM;AAClB,YAAY,KAAK;AACjB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,KAAK;AAChB,aAAa,MAAM;AACnB;AACA;;AAEO,cAAc,6CAAS;AAC9B;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,KAAK;AAChB,aAAa,MAAM;AACnB;AACA;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,KAAK;AACjB,YAAY,MAAM;AAClB,YAAY,KAAK;AACjB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,WAAW,KAAK;AAChB,aAAa,MAAM;AACnB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,WAAW,OAAO;AAClB,aAAa,MAAM;AACnB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,gDAAY;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,WAAW,OAAO;AAClB,aAAa,MAAM;AACnB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,gDAAY;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,WAAW,OAAO;AAClB,aAAa,MAAM;AACnB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,gDAAY;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,WAAW,KAAK;AAChB,aAAa,MAAM;AACnB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,KAAK;AAChB,WAAW,MAAM;AACjB,aAAa,MAAM;AACnB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,MAAM;AACnB;;AAEO;AACP;AACA,sBAAsB,kDAAgB;AACtC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,aAAa,MAAM;AACnB;AACA;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,aAAa,MAAM;AACnB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;;AAEO;AACP;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,WAAW,OAAO;AAClB,aAAa,MAAM;AACnB;AACA;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,aAAa,OAAO;AACpB;AACA;;AAEO,UAAU,4CAAQ;AACzB;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,WAAW,OAAO;AAClB,aAAa,MAAM;AACnB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,aAAa,MAAM;AACnB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,aAAa,MAAM;AACnB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,aAAa,OAAO;AACpB;AACA;;AAEO,aAAa,+CAAW;AAC/B;AACA,cAAc;AACd;AACA;;AAEO;AACP;AACA;AACA;AACA,WAAW,MAAM;AACjB,aAAa,OAAO;AACpB;AACA;;AAEO,oBAAoB,sDAAkB;AAC7C;AACA,cAAc;AACd;AACA;;AAEO;AACP;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,aAAa,MAAM;AACnB;AACA;;AAEO;AACP;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,aAAa,OAAO;AACpB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,aAAa,QAAQ;AACrB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,aAAa,QAAQ;AACrB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,kDAAgB,qEAAqE,kDAAgB,qEAAqE,kDAAgB,qEAAqE,kDAAgB,qEAAqE,kDAAgB,qEAAqE,kDAAgB,qEAAqE,kDAAgB,qEAAqE,kDAAgB;AACjoB,C;;;;;;;;;;;;ACl0BA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAwC;AACxC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,KAAK;AAClB;;AAEO;AACP,gBAAgB,qDAAmB;;AAEnC,MAAM,qDAAmB;AACzB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP,gBAAgB,qDAAmB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP,gBAAgB,qDAAmB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,OAAO;AACpB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,OAAO;AACpB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,aAAa,OAAO;AACpB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,aAAa,OAAO;AACpB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,OAAO;AACpB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA,UAAU,iDAAe;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,MAAM;AACjB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA,yBAAyB;;AAEzB;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,OAAO;AACpB;;AAEO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,aAAa,OAAO;AACpB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,QAAQ;AACrB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,QAAQ;AACrB;;AAEO;AACP;AACA;AACA;AACA;AACA,8BAA8B,kDAAgB,qEAAqE,kDAAgB;AACnI;AACA;AACA,cAAc;AACd;AACA;;AAEO;AACP;AACA,cAAc;AACd;AACA;;AAEO;AACP;AACA,cAAc;AACd;AACA;;AAEO;AACP;AACA,cAAc;AACd;AACA;;AAEO;AACP;AACA,cAAc;AACd;AACA;;AAEO;AACP;AACA,cAAc;AACd;AACA;;AAEO;AACP;AACA,cAAc;AACd;AACA;;AAEO;AACP;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,WAAW,OAAO;AAClB,aAAa,MAAM;AACnB;AACA;;AAEO;AACP;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;;AAEA,oBAAoB,OAAO;AAC3B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,CAAC,G;;;;;;;;;;;;AChoBD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAwC;AACxC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,KAAK;AAClB;;AAEO;AACP,gBAAgB,qDAAmB;;AAEnC,MAAM,qDAAmB;AACzB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP,gBAAgB,qDAAmB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,aAAa,OAAO;AACpB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP,gBAAgB,qDAAmB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,OAAO;AACpB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,OAAO;AACpB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,aAAa,OAAO;AACpB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,OAAO;AACpB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA,UAAU,iDAAe;AACzB,UAAU,iDAAe;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;;AAEA;AACA;AACA,4BAA4B;;AAE5B;AACA;AACA,iCAAiC;;AAEjC;AACA;AACA;AACA,YAAY;;AAEZ;AACA;AACA,YAAY;;AAEZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA,aAAa;;AAEb;AACA;AACA,qBAAqB;;AAErB;AACA;AACA,iDAAiD;;AAEjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA,aAAa;;AAEb;AACA;AACA,qBAAqB;;AAErB;AACA;AACA,iDAAiD;;AAEjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA,aAAa;;AAEb;AACA;AACA,qBAAqB;;AAErB;AACA;AACA,cAAc;;AAEd;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,OAAO;AACpB;;AAEO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,aAAa,OAAO;AACpB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,QAAQ;AACrB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,QAAQ;AACrB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,kDAAgB,qEAAqE,kDAAgB,qEAAqE,kDAAgB;AACxN;AACA;AACA,cAAc;AACd;AACA;;AAEO;AACP;AACA,cAAc;AACd;AACA;;AAEO;AACP;AACA,cAAc;AACd;AACA;;AAEO;AACP;AACA,cAAc;AACd;AACA;;AAEO;AACP;AACA,cAAc;AACd;AACA;;AAEO;AACP;AACA,cAAc;AACd;AACA;;AAEO;AACP;AACA,cAAc;AACd;AACA;;AAEO;AACP;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,WAAW,OAAO;AAClB,aAAa,MAAM;AACnB;AACA;;AAEO;AACP;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;;AAEA,oBAAoB,OAAO;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,CAAC,G;;;;;;;;;;;;ACpxBD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAwC;AACxC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,KAAK;AAClB;;AAEO;AACP,gBAAgB,qDAAmB;;AAEnC,MAAM,qDAAmB;AACzB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP,gBAAgB,qDAAmB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP,gBAAgB,qDAAmB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,OAAO;AACpB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,OAAO;AACpB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,aAAa,OAAO;AACpB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,aAAa,OAAO;AACpB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,OAAO;AACpB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,OAAO;AAClB,aAAa,KAAK;AAClB;;AAEO;AACP,uBAAuB;AACvB;AACA;;AAEA;AACA;;AAEA;AACA,SAAS,iDAAe;AACxB,SAAS,iDAAe;AACxB;AACA,GAAG;;AAEH;AACA,SAAS,iDAAe;AACxB,SAAS,iDAAe;AACxB;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;;AAEhB;AACA;AACA;AACA,qCAAqC;;AAErC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,aAAa,KAAK;AAClB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,aAAa,OAAO;AACpB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,QAAQ;AACrB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa,QAAQ;AACrB;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,kDAAgB,qEAAqE,kDAAgB,qEAAqE,kDAAgB,qEAAqE,kDAAgB;AAC7S;AACA;AACA,cAAc;AACd;AACA;;AAEO;AACP;AACA,cAAc;AACd;AACA;;AAEO;AACP;AACA,cAAc;AACd;AACA;;AAEO;AACP;AACA,cAAc;AACd;AACA;;AAEO;AACP;AACA,cAAc;AACd;AACA;;AAEO;AACP;AACA,cAAc;AACd;AACA;;AAEO;AACP;AACA,cAAc;AACd;AACA;;AAEO;AACP;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,WAAW,OAAO;AAClB,aAAa,MAAM;AACnB;AACA;;AAEO;AACP;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;;AAEA,oBAAoB,OAAO;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,CAAC,G;;;;;;;;;;;ACvpBD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC;AACxC;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,MAAM;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,0CAA0C,WAAW;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,0BAA0B;AAC1B,8BAA8B,yCAAyC;AACvE;AACA;AACA,8BAA8B;AAC9B;AACA,4BAA4B;AAC5B;AACA;AACA;AACA,+BAA+B;AAC/B;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA,2EAA2E;AAC3E;AACA;AACA,OAAO;;AAEP,wBAAwB;AACxB;AACA,GAAG;;AAEH;AACA,gBAAgB;AAChB,mBAAmB,kBAAkB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd,KAAK;AACL,GAAG;AACH;;;;;;;;;;;;AC9MA,WAAW,mBAAO,CAAC,+CAAS;;AAE5B;AACA;;AAEA;;;;;;;;;;;;ACLA,aAAa,mBAAO,CAAC,mDAAW;AAChC,gBAAgB,mBAAO,CAAC,yDAAc;AACtC,qBAAqB,mBAAO,CAAC,mEAAmB;;AAEhD;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,EAAE;AACb,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;AC3BA;AACA;;AAEA;;;;;;;;;;;;;ACHA,aAAa,mBAAO,CAAC,mDAAW;;AAEhC;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,EAAE;AACb,aAAa,OAAO;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;AC7CA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,EAAE;AACb,aAAa,OAAO;AACpB;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;ACrBA,iBAAiB,mBAAO,CAAC,2DAAe;;AAExC;AACA;;AAEA;AACA;;AAEA;;;;;;;;;;;;ACRA,eAAe,mBAAO,CAAC,qDAAY;AACnC,UAAU,mBAAO,CAAC,2CAAO;AACzB,eAAe,mBAAO,CAAC,qDAAY;;AAEnC;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB,WAAW,OAAO;AAClB,WAAW,OAAO,YAAY;AAC9B,WAAW,QAAQ;AACnB;AACA,WAAW,OAAO;AAClB;AACA,WAAW,QAAQ;AACnB;AACA,aAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,8CAA8C,kBAAkB;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;AC7LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,EAAE;AACb,aAAa,QAAQ;AACrB;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,EAAE;AACb,aAAa,QAAQ;AACrB;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;AC5BA,iBAAiB,mBAAO,CAAC,2DAAe;AACxC,mBAAmB,mBAAO,CAAC,6DAAgB;;AAE3C;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,EAAE;AACb,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;AC5BA,WAAW,mBAAO,CAAC,+CAAS;;AAE5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;ACtBA,eAAe,mBAAO,CAAC,qDAAY;AACnC,eAAe,mBAAO,CAAC,qDAAY;;AAEnC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB,WAAW,OAAO;AAClB,WAAW,OAAO,YAAY;AAC9B,WAAW,QAAQ;AACnB;AACA,WAAW,QAAQ;AACnB;AACA,aAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,oBAAoB;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;;;;;;;;;;;;ACpEA,eAAe,mBAAO,CAAC,qDAAY;AACnC,eAAe,mBAAO,CAAC,qDAAY;;AAEnC;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,EAAE;AACb,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;;ACjEA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,aAAa;AAC5B,eAAe,EAAE;AACjB,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,SAAS;AACT;AACA,mBAAmB,EAAE;AACrB,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,EAAE;AACrB,mBAAmB,EAAE;AACrB,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,EAAE;AACrB,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,EAAE;AACrB,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,mBAAmB,SAAS;AAC5B,mBAAmB,EAAE;AACrB,qBAAqB;AACrB;AACA;AACA,iCAAiC,YAAY;AAC7C,mDAAmD,gBAAgB;AACnE;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,CAAC;;AAED;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,gCAAgC,6BAA6B,EAAE,aAAa;AAC5G,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB,WAAW,OAAO;AAClB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,kBAAkB;AACjC,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,kBAAkB;AACjC,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,QAAQ;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,qDAAqD,mCAAmC,EAAE;AAC1F;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,gBAAgB;AAC/B,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,OAAO;AACpB;AACA;AACA,6CAA6C,gBAAgB;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,WAAW,cAAc;AACzB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,oBAAoB;AAC/B,WAAW,UAAU;AACrB,aAAa;AACb;AACA;AACA;AACA,oBAAoB,uBAAuB;AAC3C;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,WAAW,oBAAoB;AAC/B,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA,6CAA6C,yBAAyB;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,mBAAmB;AAC9B;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,YAAY;AACvB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,kCAAkC,iEAAiE;AACnG;AACA;AACA;AACA;AACA,8BAA8B;AAC9B,8CAA8C;AAC9C,CAAC;AACD;AACA;AACA;AACA,WAAW,QAAQ;AACnB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,YAAY;AACvB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa;AACb;AACA;AACA,YAAY;AACZ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,YAAY;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA,eAAe,QAAQ;AACvB,eAAe,YAAY;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,2CAA2C;AAC7E;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA,eAAe,uBAAuB;AACtC;AACA,eAAe,yBAAyB;AACxC;AACA,eAAe,eAAe;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,QAAQ;AACvB,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,QAAQ;AACvB,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,uBAAuB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAEc,oEAAK,EAAC;;;;;;;;;;;;;AC/5BrB;;AAEA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;;AAEA;AACA;AACA,4CAA4C;;AAE5C;;;;;;;;;;;;;ACnBA;AAAA;AAAA;;;;;;;;;;;;;;GAcG;AAEH;;GAEG;AACqE;AAExE,MAAM,CAAC,gBAAgB,CAAC,kBAAkB,EAAE,GAAG,EAAE;IAC/C,+FAAkB,EAAE,CAAC;AACvB,CAAC,CAAC,CAAC;;;;;;;;;;;;;ACvBH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;;GAcG;AAImE;AACnB;AAGa;AACJ;AAEG;AACnB;AAErC,MAAM,oBAAqB,SAC9B,2EAAyD;CAAG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AC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAChF,OAAO;QACL,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACV,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACpB,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACV,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAClF,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAClF,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAA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","file":"main.bundle.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t};\n\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"main\": 0\n \t};\n\n\n\n \t// script path function\n \tfunction jsonpScriptSrc(chunkId) {\n \t\treturn __webpack_require__.p + \"\" + ({\"tfjs-library\":\"tfjs-library\"}[chunkId]||chunkId) + \".bundle.js\"\n \t}\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n \t// This file contains only the entry chunk.\n \t// The chunk loading function for additional chunks\n \t__webpack_require__.e = function requireEnsure(chunkId) {\n \t\tvar promises = [];\n\n\n \t\t// JSONP chunk loading for javascript\n\n \t\tvar installedChunkData = installedChunks[chunkId];\n \t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n \t\t\t// a Promise means \"currently loading\".\n \t\t\tif(installedChunkData) {\n \t\t\t\tpromises.push(installedChunkData[2]);\n \t\t\t} else {\n \t\t\t\t// setup Promise in chunk cache\n \t\t\t\tvar promise = new Promise(function(resolve, reject) {\n \t\t\t\t\tinstalledChunkData = installedChunks[chunkId] = [resolve, reject];\n \t\t\t\t});\n \t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n \t\t\t\t// start chunk loading\n \t\t\t\tvar script = document.createElement('script');\n \t\t\t\tvar onScriptComplete;\n\n \t\t\t\tscript.charset = 'utf-8';\n \t\t\t\tscript.timeout = 120;\n \t\t\t\tif (__webpack_require__.nc) {\n \t\t\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n \t\t\t\t}\n \t\t\t\tscript.src = jsonpScriptSrc(chunkId);\n\n \t\t\t\tonScriptComplete = function (event) {\n \t\t\t\t\t// avoid mem leaks in IE.\n \t\t\t\t\tscript.onerror = script.onload = null;\n \t\t\t\t\tclearTimeout(timeout);\n \t\t\t\t\tvar chunk = installedChunks[chunkId];\n \t\t\t\t\tif(chunk !== 0) {\n \t\t\t\t\t\tif(chunk) {\n \t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n \t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n \t\t\t\t\t\t\tvar error = new Error('Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')');\n \t\t\t\t\t\t\terror.type = errorType;\n \t\t\t\t\t\t\terror.request = realSrc;\n \t\t\t\t\t\t\tchunk[1](error);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tinstalledChunks[chunkId] = undefined;\n \t\t\t\t\t}\n \t\t\t\t};\n \t\t\t\tvar timeout = setTimeout(function(){\n \t\t\t\t\tonScriptComplete({ type: 'timeout', target: script });\n \t\t\t\t}, 120000);\n \t\t\t\tscript.onerror = script.onload = onScriptComplete;\n \t\t\t\tdocument.head.appendChild(script);\n \t\t\t}\n \t\t}\n \t\treturn Promise.all(promises);\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// on error function for async loading\n \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n\"use strict\";\n\nCodeMirror.registerHelper(\"fold\", \"brace\", function(cm, start) {\n  var line = start.line, lineText = cm.getLine(line);\n  var tokenType;\n\n  function findOpening(openCh) {\n    for (var at = start.ch, pass = 0;;) {\n      var found = at <= 0 ? -1 : lineText.lastIndexOf(openCh, at - 1);\n      if (found == -1) {\n        if (pass == 1) break;\n        pass = 1;\n        at = lineText.length;\n        continue;\n      }\n      if (pass == 1 && found < start.ch) break;\n      tokenType = cm.getTokenTypeAt(CodeMirror.Pos(line, found + 1));\n      if (!/^(comment|string)/.test(tokenType)) return found + 1;\n      at = found - 1;\n    }\n  }\n\n  var startToken = \"{\", endToken = \"}\", startCh = findOpening(\"{\");\n  if (startCh == null) {\n    startToken = \"[\", endToken = \"]\";\n    startCh = findOpening(\"[\");\n  }\n\n  if (startCh == null) return;\n  var count = 1, lastLine = cm.lastLine(), end, endCh;\n  outer: for (var i = line; i <= lastLine; ++i) {\n    var text = cm.getLine(i), pos = i == line ? startCh : 0;\n    for (;;) {\n      var nextOpen = text.indexOf(startToken, pos), nextClose = text.indexOf(endToken, pos);\n      if (nextOpen < 0) nextOpen = text.length;\n      if (nextClose < 0) nextClose = text.length;\n      pos = Math.min(nextOpen, nextClose);\n      if (pos == text.length) break;\n      if (cm.getTokenTypeAt(CodeMirror.Pos(i, pos + 1)) == tokenType) {\n        if (pos == nextOpen) ++count;\n        else if (!--count) { end = i; endCh = pos; break outer; }\n      }\n      ++pos;\n    }\n  }\n  if (end == null || line == end) return;\n  return {from: CodeMirror.Pos(line, startCh),\n          to: CodeMirror.Pos(end, endCh)};\n});\n\nCodeMirror.registerHelper(\"fold\", \"import\", function(cm, start) {\n  function hasImport(line) {\n    if (line < cm.firstLine() || line > cm.lastLine()) return null;\n    var start = cm.getTokenAt(CodeMirror.Pos(line, 1));\n    if (!/\\S/.test(start.string)) start = cm.getTokenAt(CodeMirror.Pos(line, start.end + 1));\n    if (start.type != \"keyword\" || start.string != \"import\") return null;\n    // Now find closing semicolon, return its position\n    for (var i = line, e = Math.min(cm.lastLine(), line + 10); i <= e; ++i) {\n      var text = cm.getLine(i), semi = text.indexOf(\";\");\n      if (semi != -1) return {startCh: start.end, end: CodeMirror.Pos(i, semi)};\n    }\n  }\n\n  var startLine = start.line, has = hasImport(startLine), prev;\n  if (!has || hasImport(startLine - 1) || ((prev = hasImport(startLine - 2)) && prev.end.line == startLine - 1))\n    return null;\n  for (var end = has.end;;) {\n    var next = hasImport(end.line + 1);\n    if (next == null) break;\n    end = next.end;\n  }\n  return {from: cm.clipPos(CodeMirror.Pos(startLine, has.startCh + 1)), to: end};\n});\n\nCodeMirror.registerHelper(\"fold\", \"include\", function(cm, start) {\n  function hasInclude(line) {\n    if (line < cm.firstLine() || line > cm.lastLine()) return null;\n    var start = cm.getTokenAt(CodeMirror.Pos(line, 1));\n    if (!/\\S/.test(start.string)) start = cm.getTokenAt(CodeMirror.Pos(line, start.end + 1));\n    if (start.type == \"meta\" && start.string.slice(0, 8) == \"#include\") return start.start + 8;\n  }\n\n  var startLine = start.line, has = hasInclude(startLine);\n  if (has == null || hasInclude(startLine - 1) != null) return null;\n  for (var end = startLine;;) {\n    var next = hasInclude(end + 1);\n    if (next == null) break;\n    ++end;\n  }\n  return {from: CodeMirror.Pos(startLine, has + 1),\n          to: cm.clipPos(CodeMirror.Pos(end))};\n});\n\n});\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  function doFold(cm, pos, options, force) {\n    if (options && options.call) {\n      var finder = options;\n      options = null;\n    } else {\n      var finder = getOption(cm, options, \"rangeFinder\");\n    }\n    if (typeof pos == \"number\") pos = CodeMirror.Pos(pos, 0);\n    var minSize = getOption(cm, options, \"minFoldSize\");\n\n    function getRange(allowFolded) {\n      var range = finder(cm, pos);\n      if (!range || range.to.line - range.from.line < minSize) return null;\n      var marks = cm.findMarksAt(range.from);\n      for (var i = 0; i < marks.length; ++i) {\n        if (marks[i].__isFold && force !== \"fold\") {\n          if (!allowFolded) return null;\n          range.cleared = true;\n          marks[i].clear();\n        }\n      }\n      return range;\n    }\n\n    var range = getRange(true);\n    if (getOption(cm, options, \"scanUp\")) while (!range && pos.line > cm.firstLine()) {\n      pos = CodeMirror.Pos(pos.line - 1, 0);\n      range = getRange(false);\n    }\n    if (!range || range.cleared || force === \"unfold\") return;\n\n    var myWidget = makeWidget(cm, options);\n    CodeMirror.on(myWidget, \"mousedown\", function(e) {\n      myRange.clear();\n      CodeMirror.e_preventDefault(e);\n    });\n    var myRange = cm.markText(range.from, range.to, {\n      replacedWith: myWidget,\n      clearOnEnter: getOption(cm, options, \"clearOnEnter\"),\n      __isFold: true\n    });\n    myRange.on(\"clear\", function(from, to) {\n      CodeMirror.signal(cm, \"unfold\", cm, from, to);\n    });\n    CodeMirror.signal(cm, \"fold\", cm, range.from, range.to);\n  }\n\n  function makeWidget(cm, options) {\n    var widget = getOption(cm, options, \"widget\");\n    if (typeof widget == \"string\") {\n      var text = document.createTextNode(widget);\n      widget = document.createElement(\"span\");\n      widget.appendChild(text);\n      widget.className = \"CodeMirror-foldmarker\";\n    } else if (widget) {\n      widget = widget.cloneNode(true)\n    }\n    return widget;\n  }\n\n  // Clumsy backwards-compatible interface\n  CodeMirror.newFoldFunction = function(rangeFinder, widget) {\n    return function(cm, pos) { doFold(cm, pos, {rangeFinder: rangeFinder, widget: widget}); };\n  };\n\n  // New-style interface\n  CodeMirror.defineExtension(\"foldCode\", function(pos, options, force) {\n    doFold(this, pos, options, force);\n  });\n\n  CodeMirror.defineExtension(\"isFolded\", function(pos) {\n    var marks = this.findMarksAt(pos);\n    for (var i = 0; i < marks.length; ++i)\n      if (marks[i].__isFold) return true;\n  });\n\n  CodeMirror.commands.toggleFold = function(cm) {\n    cm.foldCode(cm.getCursor());\n  };\n  CodeMirror.commands.fold = function(cm) {\n    cm.foldCode(cm.getCursor(), null, \"fold\");\n  };\n  CodeMirror.commands.unfold = function(cm) {\n    cm.foldCode(cm.getCursor(), null, \"unfold\");\n  };\n  CodeMirror.commands.foldAll = function(cm) {\n    cm.operation(function() {\n      for (var i = cm.firstLine(), e = cm.lastLine(); i <= e; i++)\n        cm.foldCode(CodeMirror.Pos(i, 0), null, \"fold\");\n    });\n  };\n  CodeMirror.commands.unfoldAll = function(cm) {\n    cm.operation(function() {\n      for (var i = cm.firstLine(), e = cm.lastLine(); i <= e; i++)\n        cm.foldCode(CodeMirror.Pos(i, 0), null, \"unfold\");\n    });\n  };\n\n  CodeMirror.registerHelper(\"fold\", \"combine\", function() {\n    var funcs = Array.prototype.slice.call(arguments, 0);\n    return function(cm, start) {\n      for (var i = 0; i < funcs.length; ++i) {\n        var found = funcs[i](cm, start);\n        if (found) return found;\n      }\n    };\n  });\n\n  CodeMirror.registerHelper(\"fold\", \"auto\", function(cm, start) {\n    var helpers = cm.getHelpers(start, \"fold\");\n    for (var i = 0; i < helpers.length; i++) {\n      var cur = helpers[i](cm, start);\n      if (cur) return cur;\n    }\n  });\n\n  var defaultOptions = {\n    rangeFinder: CodeMirror.fold.auto,\n    widget: \"\\u2194\",\n    minFoldSize: 0,\n    scanUp: false,\n    clearOnEnter: true\n  };\n\n  CodeMirror.defineOption(\"foldOptions\", null);\n\n  function getOption(cm, options, name) {\n    if (options && options[name] !== undefined)\n      return options[name];\n    var editorOptions = cm.options.foldOptions;\n    if (editorOptions && editorOptions[name] !== undefined)\n      return editorOptions[name];\n    return defaultOptions[name];\n  }\n\n  CodeMirror.defineExtension(\"foldOption\", function(options, name) {\n    return getOption(this, options, name);\n  });\n});\n","// extracted by mini-css-extract-plugin","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"), require(\"./foldcode\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\", \"./foldcode\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  CodeMirror.defineOption(\"foldGutter\", false, function(cm, val, old) {\n    if (old && old != CodeMirror.Init) {\n      cm.clearGutter(cm.state.foldGutter.options.gutter);\n      cm.state.foldGutter = null;\n      cm.off(\"gutterClick\", onGutterClick);\n      cm.off(\"change\", onChange);\n      cm.off(\"viewportChange\", onViewportChange);\n      cm.off(\"fold\", onFold);\n      cm.off(\"unfold\", onFold);\n      cm.off(\"swapDoc\", onChange);\n    }\n    if (val) {\n      cm.state.foldGutter = new State(parseOptions(val));\n      updateInViewport(cm);\n      cm.on(\"gutterClick\", onGutterClick);\n      cm.on(\"change\", onChange);\n      cm.on(\"viewportChange\", onViewportChange);\n      cm.on(\"fold\", onFold);\n      cm.on(\"unfold\", onFold);\n      cm.on(\"swapDoc\", onChange);\n    }\n  });\n\n  var Pos = CodeMirror.Pos;\n\n  function State(options) {\n    this.options = options;\n    this.from = this.to = 0;\n  }\n\n  function parseOptions(opts) {\n    if (opts === true) opts = {};\n    if (opts.gutter == null) opts.gutter = \"CodeMirror-foldgutter\";\n    if (opts.indicatorOpen == null) opts.indicatorOpen = \"CodeMirror-foldgutter-open\";\n    if (opts.indicatorFolded == null) opts.indicatorFolded = \"CodeMirror-foldgutter-folded\";\n    return opts;\n  }\n\n  function isFolded(cm, line) {\n    var marks = cm.findMarks(Pos(line, 0), Pos(line + 1, 0));\n    for (var i = 0; i < marks.length; ++i)\n      if (marks[i].__isFold && marks[i].find().from.line == line) return marks[i];\n  }\n\n  function marker(spec) {\n    if (typeof spec == \"string\") {\n      var elt = document.createElement(\"div\");\n      elt.className = spec + \" CodeMirror-guttermarker-subtle\";\n      return elt;\n    } else {\n      return spec.cloneNode(true);\n    }\n  }\n\n  function updateFoldInfo(cm, from, to) {\n    var opts = cm.state.foldGutter.options, cur = from;\n    var minSize = cm.foldOption(opts, \"minFoldSize\");\n    var func = cm.foldOption(opts, \"rangeFinder\");\n    cm.eachLine(from, to, function(line) {\n      var mark = null;\n      if (isFolded(cm, cur)) {\n        mark = marker(opts.indicatorFolded);\n      } else {\n        var pos = Pos(cur, 0);\n        var range = func && func(cm, pos);\n        if (range && range.to.line - range.from.line >= minSize)\n          mark = marker(opts.indicatorOpen);\n      }\n      cm.setGutterMarker(line, opts.gutter, mark);\n      ++cur;\n    });\n  }\n\n  function updateInViewport(cm) {\n    var vp = cm.getViewport(), state = cm.state.foldGutter;\n    if (!state) return;\n    cm.operation(function() {\n      updateFoldInfo(cm, vp.from, vp.to);\n    });\n    state.from = vp.from; state.to = vp.to;\n  }\n\n  function onGutterClick(cm, line, gutter) {\n    var state = cm.state.foldGutter;\n    if (!state) return;\n    var opts = state.options;\n    if (gutter != opts.gutter) return;\n    var folded = isFolded(cm, line);\n    if (folded) folded.clear();\n    else cm.foldCode(Pos(line, 0), opts.rangeFinder);\n  }\n\n  function onChange(cm) {\n    var state = cm.state.foldGutter;\n    if (!state) return;\n    var opts = state.options;\n    state.from = state.to = 0;\n    clearTimeout(state.changeUpdate);\n    state.changeUpdate = setTimeout(function() { updateInViewport(cm); }, opts.foldOnChangeTimeSpan || 600);\n  }\n\n  function onViewportChange(cm) {\n    var state = cm.state.foldGutter;\n    if (!state) return;\n    var opts = state.options;\n    clearTimeout(state.changeUpdate);\n    state.changeUpdate = setTimeout(function() {\n      var vp = cm.getViewport();\n      if (state.from == state.to || vp.from - state.to > 20 || state.from - vp.to > 20) {\n        updateInViewport(cm);\n      } else {\n        cm.operation(function() {\n          if (vp.from < state.from) {\n            updateFoldInfo(cm, vp.from, state.from);\n            state.from = vp.from;\n          }\n          if (vp.to > state.to) {\n            updateFoldInfo(cm, state.to, vp.to);\n            state.to = vp.to;\n          }\n        });\n      }\n    }, opts.updateViewportTimeSpan || 400);\n  }\n\n  function onFold(cm, from) {\n    var state = cm.state.foldGutter;\n    if (!state) return;\n    var line = from.line;\n    if (line >= state.from && line < state.to)\n      updateFoldInfo(cm, line, line + 1);\n  }\n});\n","// extracted by mini-css-extract-plugin","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n  var GUTTER_ID = \"CodeMirror-lint-markers\";\n\n  function showTooltip(e, content) {\n    var tt = document.createElement(\"div\");\n    tt.className = \"CodeMirror-lint-tooltip\";\n    tt.appendChild(content.cloneNode(true));\n    document.body.appendChild(tt);\n\n    function position(e) {\n      if (!tt.parentNode) return CodeMirror.off(document, \"mousemove\", position);\n      tt.style.top = Math.max(0, e.clientY - tt.offsetHeight - 5) + \"px\";\n      tt.style.left = (e.clientX + 5) + \"px\";\n    }\n    CodeMirror.on(document, \"mousemove\", position);\n    position(e);\n    if (tt.style.opacity != null) tt.style.opacity = 1;\n    return tt;\n  }\n  function rm(elt) {\n    if (elt.parentNode) elt.parentNode.removeChild(elt);\n  }\n  function hideTooltip(tt) {\n    if (!tt.parentNode) return;\n    if (tt.style.opacity == null) rm(tt);\n    tt.style.opacity = 0;\n    setTimeout(function() { rm(tt); }, 600);\n  }\n\n  function showTooltipFor(e, content, node) {\n    var tooltip = showTooltip(e, content);\n    function hide() {\n      CodeMirror.off(node, \"mouseout\", hide);\n      if (tooltip) { hideTooltip(tooltip); tooltip = null; }\n    }\n    var poll = setInterval(function() {\n      if (tooltip) for (var n = node;; n = n.parentNode) {\n        if (n && n.nodeType == 11) n = n.host;\n        if (n == document.body) return;\n        if (!n) { hide(); break; }\n      }\n      if (!tooltip) return clearInterval(poll);\n    }, 400);\n    CodeMirror.on(node, \"mouseout\", hide);\n  }\n\n  function LintState(cm, options, hasGutter) {\n    this.marked = [];\n    this.options = options;\n    this.timeout = null;\n    this.hasGutter = hasGutter;\n    this.onMouseOver = function(e) { onMouseOver(cm, e); };\n    this.waitingFor = 0\n  }\n\n  function parseOptions(_cm, options) {\n    if (options instanceof Function) return {getAnnotations: options};\n    if (!options || options === true) options = {};\n    return options;\n  }\n\n  function clearMarks(cm) {\n    var state = cm.state.lint;\n    if (state.hasGutter) cm.clearGutter(GUTTER_ID);\n    for (var i = 0; i < state.marked.length; ++i)\n      state.marked[i].clear();\n    state.marked.length = 0;\n  }\n\n  function makeMarker(labels, severity, multiple, tooltips) {\n    var marker = document.createElement(\"div\"), inner = marker;\n    marker.className = \"CodeMirror-lint-marker-\" + severity;\n    if (multiple) {\n      inner = marker.appendChild(document.createElement(\"div\"));\n      inner.className = \"CodeMirror-lint-marker-multiple\";\n    }\n\n    if (tooltips != false) CodeMirror.on(inner, \"mouseover\", function(e) {\n      showTooltipFor(e, labels, inner);\n    });\n\n    return marker;\n  }\n\n  function getMaxSeverity(a, b) {\n    if (a == \"error\") return a;\n    else return b;\n  }\n\n  function groupByLine(annotations) {\n    var lines = [];\n    for (var i = 0; i < annotations.length; ++i) {\n      var ann = annotations[i], line = ann.from.line;\n      (lines[line] || (lines[line] = [])).push(ann);\n    }\n    return lines;\n  }\n\n  function annotationTooltip(ann) {\n    var severity = ann.severity;\n    if (!severity) severity = \"error\";\n    var tip = document.createElement(\"div\");\n    tip.className = \"CodeMirror-lint-message-\" + severity;\n    if (typeof ann.messageHTML != 'undefined') {\n        tip.innerHTML = ann.messageHTML;\n    } else {\n        tip.appendChild(document.createTextNode(ann.message));\n    }\n    return tip;\n  }\n\n  function lintAsync(cm, getAnnotations, passOptions) {\n    var state = cm.state.lint\n    var id = ++state.waitingFor\n    function abort() {\n      id = -1\n      cm.off(\"change\", abort)\n    }\n    cm.on(\"change\", abort)\n    getAnnotations(cm.getValue(), function(annotations, arg2) {\n      cm.off(\"change\", abort)\n      if (state.waitingFor != id) return\n      if (arg2 && annotations instanceof CodeMirror) annotations = arg2\n      cm.operation(function() {updateLinting(cm, annotations)})\n    }, passOptions, cm);\n  }\n\n  function startLinting(cm) {\n    var state = cm.state.lint, options = state.options;\n    /*\n     * Passing rules in `options` property prevents JSHint (and other linters) from complaining\n     * about unrecognized rules like `onUpdateLinting`, `delay`, `lintOnChange`, etc.\n     */\n    var passOptions = options.options || options;\n    var getAnnotations = options.getAnnotations || cm.getHelper(CodeMirror.Pos(0, 0), \"lint\");\n    if (!getAnnotations) return;\n    if (options.async || getAnnotations.async) {\n      lintAsync(cm, getAnnotations, passOptions)\n    } else {\n      var annotations = getAnnotations(cm.getValue(), passOptions, cm);\n      if (!annotations) return;\n      if (annotations.then) annotations.then(function(issues) {\n        cm.operation(function() {updateLinting(cm, issues)})\n      });\n      else cm.operation(function() {updateLinting(cm, annotations)})\n    }\n  }\n\n  function updateLinting(cm, annotationsNotSorted) {\n    clearMarks(cm);\n    var state = cm.state.lint, options = state.options;\n\n    var annotations = groupByLine(annotationsNotSorted);\n\n    for (var line = 0; line < annotations.length; ++line) {\n      var anns = annotations[line];\n      if (!anns) continue;\n\n      var maxSeverity = null;\n      var tipLabel = state.hasGutter && document.createDocumentFragment();\n\n      for (var i = 0; i < anns.length; ++i) {\n        var ann = anns[i];\n        var severity = ann.severity;\n        if (!severity) severity = \"error\";\n        maxSeverity = getMaxSeverity(maxSeverity, severity);\n\n        if (options.formatAnnotation) ann = options.formatAnnotation(ann);\n        if (state.hasGutter) tipLabel.appendChild(annotationTooltip(ann));\n\n        if (ann.to) state.marked.push(cm.markText(ann.from, ann.to, {\n          className: \"CodeMirror-lint-mark-\" + severity,\n          __annotation: ann\n        }));\n      }\n\n      if (state.hasGutter)\n        cm.setGutterMarker(line, GUTTER_ID, makeMarker(tipLabel, maxSeverity, anns.length > 1,\n                                                       state.options.tooltips));\n    }\n    if (options.onUpdateLinting) options.onUpdateLinting(annotationsNotSorted, annotations, cm);\n  }\n\n  function onChange(cm) {\n    var state = cm.state.lint;\n    if (!state) return;\n    clearTimeout(state.timeout);\n    state.timeout = setTimeout(function(){startLinting(cm);}, state.options.delay || 500);\n  }\n\n  function popupTooltips(annotations, e) {\n    var target = e.target || e.srcElement;\n    var tooltip = document.createDocumentFragment();\n    for (var i = 0; i < annotations.length; i++) {\n      var ann = annotations[i];\n      tooltip.appendChild(annotationTooltip(ann));\n    }\n    showTooltipFor(e, tooltip, target);\n  }\n\n  function onMouseOver(cm, e) {\n    var target = e.target || e.srcElement;\n    if (!/\\bCodeMirror-lint-mark-/.test(target.className)) return;\n    var box = target.getBoundingClientRect(), x = (box.left + box.right) / 2, y = (box.top + box.bottom) / 2;\n    var spans = cm.findMarksAt(cm.coordsChar({left: x, top: y}, \"client\"));\n\n    var annotations = [];\n    for (var i = 0; i < spans.length; ++i) {\n      var ann = spans[i].__annotation;\n      if (ann) annotations.push(ann);\n    }\n    if (annotations.length) popupTooltips(annotations, e);\n  }\n\n  CodeMirror.defineOption(\"lint\", false, function(cm, val, old) {\n    if (old && old != CodeMirror.Init) {\n      clearMarks(cm);\n      if (cm.state.lint.options.lintOnChange !== false)\n        cm.off(\"change\", onChange);\n      CodeMirror.off(cm.getWrapperElement(), \"mouseover\", cm.state.lint.onMouseOver);\n      clearTimeout(cm.state.lint.timeout);\n      delete cm.state.lint;\n    }\n\n    if (val) {\n      var gutters = cm.getOption(\"gutters\"), hasLintGutter = false;\n      for (var i = 0; i < gutters.length; ++i) if (gutters[i] == GUTTER_ID) hasLintGutter = true;\n      var state = cm.state.lint = new LintState(cm, parseOptions(cm, val), hasLintGutter);\n      if (state.options.lintOnChange !== false)\n        cm.on(\"change\", onChange);\n      if (state.options.tooltips != false && state.options.tooltips != \"gutter\")\n        CodeMirror.on(cm.getWrapperElement(), \"mouseover\", state.onMouseOver);\n\n      startLinting(cm);\n    }\n  });\n\n  CodeMirror.defineExtension(\"performLint\", function() {\n    if (this.state.lint) startLinting(this);\n  });\n});\n","// extracted by mini-css-extract-plugin","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n// This is CodeMirror (https://codemirror.net), a code editor\n// implemented in JavaScript on top of the browser's DOM.\n//\n// You can find some technical background for some of the code below\n// at http://marijnhaverbeke.nl/blog/#cm-internals .\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global.CodeMirror = factory());\n}(this, (function () { 'use strict';\n\n  // Kludges for bugs and behavior differences that can't be feature\n  // detected are enabled based on userAgent etc sniffing.\n  var userAgent = navigator.userAgent;\n  var platform = navigator.platform;\n\n  var gecko = /gecko\\/\\d/i.test(userAgent);\n  var ie_upto10 = /MSIE \\d/.test(userAgent);\n  var ie_11up = /Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(userAgent);\n  var edge = /Edge\\/(\\d+)/.exec(userAgent);\n  var ie = ie_upto10 || ie_11up || edge;\n  var ie_version = ie && (ie_upto10 ? document.documentMode || 6 : +(edge || ie_11up)[1]);\n  var webkit = !edge && /WebKit\\//.test(userAgent);\n  var qtwebkit = webkit && /Qt\\/\\d+\\.\\d+/.test(userAgent);\n  var chrome = !edge && /Chrome\\//.test(userAgent);\n  var presto = /Opera\\//.test(userAgent);\n  var safari = /Apple Computer/.test(navigator.vendor);\n  var mac_geMountainLion = /Mac OS X 1\\d\\D([8-9]|\\d\\d)\\D/.test(userAgent);\n  var phantom = /PhantomJS/.test(userAgent);\n\n  var ios = !edge && /AppleWebKit/.test(userAgent) && /Mobile\\/\\w+/.test(userAgent);\n  var android = /Android/.test(userAgent);\n  // This is woefully incomplete. Suggestions for alternative methods welcome.\n  var mobile = ios || android || /webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(userAgent);\n  var mac = ios || /Mac/.test(platform);\n  var chromeOS = /\\bCrOS\\b/.test(userAgent);\n  var windows = /win/i.test(platform);\n\n  var presto_version = presto && userAgent.match(/Version\\/(\\d*\\.\\d*)/);\n  if (presto_version) { presto_version = Number(presto_version[1]); }\n  if (presto_version && presto_version >= 15) { presto = false; webkit = true; }\n  // Some browsers use the wrong event properties to signal cmd/ctrl on OS X\n  var flipCtrlCmd = mac && (qtwebkit || presto && (presto_version == null || presto_version < 12.11));\n  var captureRightClick = gecko || (ie && ie_version >= 9);\n\n  function classTest(cls) { return new RegExp(\"(^|\\\\s)\" + cls + \"(?:$|\\\\s)\\\\s*\") }\n\n  var rmClass = function(node, cls) {\n    var current = node.className;\n    var match = classTest(cls).exec(current);\n    if (match) {\n      var after = current.slice(match.index + match[0].length);\n      node.className = current.slice(0, match.index) + (after ? match[1] + after : \"\");\n    }\n  };\n\n  function removeChildren(e) {\n    for (var count = e.childNodes.length; count > 0; --count)\n      { e.removeChild(e.firstChild); }\n    return e\n  }\n\n  function removeChildrenAndAdd(parent, e) {\n    return removeChildren(parent).appendChild(e)\n  }\n\n  function elt(tag, content, className, style) {\n    var e = document.createElement(tag);\n    if (className) { e.className = className; }\n    if (style) { e.style.cssText = style; }\n    if (typeof content == \"string\") { e.appendChild(document.createTextNode(content)); }\n    else if (content) { for (var i = 0; i < content.length; ++i) { e.appendChild(content[i]); } }\n    return e\n  }\n  // wrapper for elt, which removes the elt from the accessibility tree\n  function eltP(tag, content, className, style) {\n    var e = elt(tag, content, className, style);\n    e.setAttribute(\"role\", \"presentation\");\n    return e\n  }\n\n  var range;\n  if (document.createRange) { range = function(node, start, end, endNode) {\n    var r = document.createRange();\n    r.setEnd(endNode || node, end);\n    r.setStart(node, start);\n    return r\n  }; }\n  else { range = function(node, start, end) {\n    var r = document.body.createTextRange();\n    try { r.moveToElementText(node.parentNode); }\n    catch(e) { return r }\n    r.collapse(true);\n    r.moveEnd(\"character\", end);\n    r.moveStart(\"character\", start);\n    return r\n  }; }\n\n  function contains(parent, child) {\n    if (child.nodeType == 3) // Android browser always returns false when child is a textnode\n      { child = child.parentNode; }\n    if (parent.contains)\n      { return parent.contains(child) }\n    do {\n      if (child.nodeType == 11) { child = child.host; }\n      if (child == parent) { return true }\n    } while (child = child.parentNode)\n  }\n\n  function activeElt() {\n    // IE and Edge may throw an \"Unspecified Error\" when accessing document.activeElement.\n    // IE < 10 will throw when accessed while the page is loading or in an iframe.\n    // IE > 9 and Edge will throw when accessed in an iframe if document.body is unavailable.\n    var activeElement;\n    try {\n      activeElement = document.activeElement;\n    } catch(e) {\n      activeElement = document.body || null;\n    }\n    while (activeElement && activeElement.shadowRoot && activeElement.shadowRoot.activeElement)\n      { activeElement = activeElement.shadowRoot.activeElement; }\n    return activeElement\n  }\n\n  function addClass(node, cls) {\n    var current = node.className;\n    if (!classTest(cls).test(current)) { node.className += (current ? \" \" : \"\") + cls; }\n  }\n  function joinClasses(a, b) {\n    var as = a.split(\" \");\n    for (var i = 0; i < as.length; i++)\n      { if (as[i] && !classTest(as[i]).test(b)) { b += \" \" + as[i]; } }\n    return b\n  }\n\n  var selectInput = function(node) { node.select(); };\n  if (ios) // Mobile Safari apparently has a bug where select() is broken.\n    { selectInput = function(node) { node.selectionStart = 0; node.selectionEnd = node.value.length; }; }\n  else if (ie) // Suppress mysterious IE10 errors\n    { selectInput = function(node) { try { node.select(); } catch(_e) {} }; }\n\n  function bind(f) {\n    var args = Array.prototype.slice.call(arguments, 1);\n    return function(){return f.apply(null, args)}\n  }\n\n  function copyObj(obj, target, overwrite) {\n    if (!target) { target = {}; }\n    for (var prop in obj)\n      { if (obj.hasOwnProperty(prop) && (overwrite !== false || !target.hasOwnProperty(prop)))\n        { target[prop] = obj[prop]; } }\n    return target\n  }\n\n  // Counts the column offset in a string, taking tabs into account.\n  // Used mostly to find indentation.\n  function countColumn(string, end, tabSize, startIndex, startValue) {\n    if (end == null) {\n      end = string.search(/[^\\s\\u00a0]/);\n      if (end == -1) { end = string.length; }\n    }\n    for (var i = startIndex || 0, n = startValue || 0;;) {\n      var nextTab = string.indexOf(\"\\t\", i);\n      if (nextTab < 0 || nextTab >= end)\n        { return n + (end - i) }\n      n += nextTab - i;\n      n += tabSize - (n % tabSize);\n      i = nextTab + 1;\n    }\n  }\n\n  var Delayed = function() {this.id = null;};\n  Delayed.prototype.set = function (ms, f) {\n    clearTimeout(this.id);\n    this.id = setTimeout(f, ms);\n  };\n\n  function indexOf(array, elt) {\n    for (var i = 0; i < array.length; ++i)\n      { if (array[i] == elt) { return i } }\n    return -1\n  }\n\n  // Number of pixels added to scroller and sizer to hide scrollbar\n  var scrollerGap = 30;\n\n  // Returned or thrown by various protocols to signal 'I'm not\n  // handling this'.\n  var Pass = {toString: function(){return \"CodeMirror.Pass\"}};\n\n  // Reused option objects for setSelection & friends\n  var sel_dontScroll = {scroll: false}, sel_mouse = {origin: \"*mouse\"}, sel_move = {origin: \"+move\"};\n\n  // The inverse of countColumn -- find the offset that corresponds to\n  // a particular column.\n  function findColumn(string, goal, tabSize) {\n    for (var pos = 0, col = 0;;) {\n      var nextTab = string.indexOf(\"\\t\", pos);\n      if (nextTab == -1) { nextTab = string.length; }\n      var skipped = nextTab - pos;\n      if (nextTab == string.length || col + skipped >= goal)\n        { return pos + Math.min(skipped, goal - col) }\n      col += nextTab - pos;\n      col += tabSize - (col % tabSize);\n      pos = nextTab + 1;\n      if (col >= goal) { return pos }\n    }\n  }\n\n  var spaceStrs = [\"\"];\n  function spaceStr(n) {\n    while (spaceStrs.length <= n)\n      { spaceStrs.push(lst(spaceStrs) + \" \"); }\n    return spaceStrs[n]\n  }\n\n  function lst(arr) { return arr[arr.length-1] }\n\n  function map(array, f) {\n    var out = [];\n    for (var i = 0; i < array.length; i++) { out[i] = f(array[i], i); }\n    return out\n  }\n\n  function insertSorted(array, value, score) {\n    var pos = 0, priority = score(value);\n    while (pos < array.length && score(array[pos]) <= priority) { pos++; }\n    array.splice(pos, 0, value);\n  }\n\n  function nothing() {}\n\n  function createObj(base, props) {\n    var inst;\n    if (Object.create) {\n      inst = Object.create(base);\n    } else {\n      nothing.prototype = base;\n      inst = new nothing();\n    }\n    if (props) { copyObj(props, inst); }\n    return inst\n  }\n\n  var nonASCIISingleCaseWordChar = /[\\u00df\\u0587\\u0590-\\u05f4\\u0600-\\u06ff\\u3040-\\u309f\\u30a0-\\u30ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\uac00-\\ud7af]/;\n  function isWordCharBasic(ch) {\n    return /\\w/.test(ch) || ch > \"\\x80\" &&\n      (ch.toUpperCase() != ch.toLowerCase() || nonASCIISingleCaseWordChar.test(ch))\n  }\n  function isWordChar(ch, helper) {\n    if (!helper) { return isWordCharBasic(ch) }\n    if (helper.source.indexOf(\"\\\\w\") > -1 && isWordCharBasic(ch)) { return true }\n    return helper.test(ch)\n  }\n\n  function isEmpty(obj) {\n    for (var n in obj) { if (obj.hasOwnProperty(n) && obj[n]) { return false } }\n    return true\n  }\n\n  // Extending unicode characters. A series of a non-extending char +\n  // any number of extending chars is treated as a single unit as far\n  // as editing and measuring is concerned. This is not fully correct,\n  // since some scripts/fonts/browsers also treat other configurations\n  // of code points as a group.\n  var extendingChars = /[\\u0300-\\u036f\\u0483-\\u0489\\u0591-\\u05bd\\u05bf\\u05c1\\u05c2\\u05c4\\u05c5\\u05c7\\u0610-\\u061a\\u064b-\\u065e\\u0670\\u06d6-\\u06dc\\u06de-\\u06e4\\u06e7\\u06e8\\u06ea-\\u06ed\\u0711\\u0730-\\u074a\\u07a6-\\u07b0\\u07eb-\\u07f3\\u0816-\\u0819\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0900-\\u0902\\u093c\\u0941-\\u0948\\u094d\\u0951-\\u0955\\u0962\\u0963\\u0981\\u09bc\\u09be\\u09c1-\\u09c4\\u09cd\\u09d7\\u09e2\\u09e3\\u0a01\\u0a02\\u0a3c\\u0a41\\u0a42\\u0a47\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a70\\u0a71\\u0a75\\u0a81\\u0a82\\u0abc\\u0ac1-\\u0ac5\\u0ac7\\u0ac8\\u0acd\\u0ae2\\u0ae3\\u0b01\\u0b3c\\u0b3e\\u0b3f\\u0b41-\\u0b44\\u0b4d\\u0b56\\u0b57\\u0b62\\u0b63\\u0b82\\u0bbe\\u0bc0\\u0bcd\\u0bd7\\u0c3e-\\u0c40\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55\\u0c56\\u0c62\\u0c63\\u0cbc\\u0cbf\\u0cc2\\u0cc6\\u0ccc\\u0ccd\\u0cd5\\u0cd6\\u0ce2\\u0ce3\\u0d3e\\u0d41-\\u0d44\\u0d4d\\u0d57\\u0d62\\u0d63\\u0dca\\u0dcf\\u0dd2-\\u0dd4\\u0dd6\\u0ddf\\u0e31\\u0e34-\\u0e3a\\u0e47-\\u0e4e\\u0eb1\\u0eb4-\\u0eb9\\u0ebb\\u0ebc\\u0ec8-\\u0ecd\\u0f18\\u0f19\\u0f35\\u0f37\\u0f39\\u0f71-\\u0f7e\\u0f80-\\u0f84\\u0f86\\u0f87\\u0f90-\\u0f97\\u0f99-\\u0fbc\\u0fc6\\u102d-\\u1030\\u1032-\\u1037\\u1039\\u103a\\u103d\\u103e\\u1058\\u1059\\u105e-\\u1060\\u1071-\\u1074\\u1082\\u1085\\u1086\\u108d\\u109d\\u135f\\u1712-\\u1714\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u17b7-\\u17bd\\u17c6\\u17c9-\\u17d3\\u17dd\\u180b-\\u180d\\u18a9\\u1920-\\u1922\\u1927\\u1928\\u1932\\u1939-\\u193b\\u1a17\\u1a18\\u1a56\\u1a58-\\u1a5e\\u1a60\\u1a62\\u1a65-\\u1a6c\\u1a73-\\u1a7c\\u1a7f\\u1b00-\\u1b03\\u1b34\\u1b36-\\u1b3a\\u1b3c\\u1b42\\u1b6b-\\u1b73\\u1b80\\u1b81\\u1ba2-\\u1ba5\\u1ba8\\u1ba9\\u1c2c-\\u1c33\\u1c36\\u1c37\\u1cd0-\\u1cd2\\u1cd4-\\u1ce0\\u1ce2-\\u1ce8\\u1ced\\u1dc0-\\u1de6\\u1dfd-\\u1dff\\u200c\\u200d\\u20d0-\\u20f0\\u2cef-\\u2cf1\\u2de0-\\u2dff\\u302a-\\u302f\\u3099\\u309a\\ua66f-\\ua672\\ua67c\\ua67d\\ua6f0\\ua6f1\\ua802\\ua806\\ua80b\\ua825\\ua826\\ua8c4\\ua8e0-\\ua8f1\\ua926-\\ua92d\\ua947-\\ua951\\ua980-\\ua982\\ua9b3\\ua9b6-\\ua9b9\\ua9bc\\uaa29-\\uaa2e\\uaa31\\uaa32\\uaa35\\uaa36\\uaa43\\uaa4c\\uaab0\\uaab2-\\uaab4\\uaab7\\uaab8\\uaabe\\uaabf\\uaac1\\uabe5\\uabe8\\uabed\\udc00-\\udfff\\ufb1e\\ufe00-\\ufe0f\\ufe20-\\ufe26\\uff9e\\uff9f]/;\n  function isExtendingChar(ch) { return ch.charCodeAt(0) >= 768 && extendingChars.test(ch) }\n\n  // Returns a number from the range [`0`; `str.length`] unless `pos` is outside that range.\n  function skipExtendingChars(str, pos, dir) {\n    while ((dir < 0 ? pos > 0 : pos < str.length) && isExtendingChar(str.charAt(pos))) { pos += dir; }\n    return pos\n  }\n\n  // Returns the value from the range [`from`; `to`] that satisfies\n  // `pred` and is closest to `from`. Assumes that at least `to`\n  // satisfies `pred`. Supports `from` being greater than `to`.\n  function findFirst(pred, from, to) {\n    // At any point we are certain `to` satisfies `pred`, don't know\n    // whether `from` does.\n    var dir = from > to ? -1 : 1;\n    for (;;) {\n      if (from == to) { return from }\n      var midF = (from + to) / 2, mid = dir < 0 ? Math.ceil(midF) : Math.floor(midF);\n      if (mid == from) { return pred(mid) ? from : to }\n      if (pred(mid)) { to = mid; }\n      else { from = mid + dir; }\n    }\n  }\n\n  // BIDI HELPERS\n\n  function iterateBidiSections(order, from, to, f) {\n    if (!order) { return f(from, to, \"ltr\", 0) }\n    var found = false;\n    for (var i = 0; i < order.length; ++i) {\n      var part = order[i];\n      if (part.from < to && part.to > from || from == to && part.to == from) {\n        f(Math.max(part.from, from), Math.min(part.to, to), part.level == 1 ? \"rtl\" : \"ltr\", i);\n        found = true;\n      }\n    }\n    if (!found) { f(from, to, \"ltr\"); }\n  }\n\n  var bidiOther = null;\n  function getBidiPartAt(order, ch, sticky) {\n    var found;\n    bidiOther = null;\n    for (var i = 0; i < order.length; ++i) {\n      var cur = order[i];\n      if (cur.from < ch && cur.to > ch) { return i }\n      if (cur.to == ch) {\n        if (cur.from != cur.to && sticky == \"before\") { found = i; }\n        else { bidiOther = i; }\n      }\n      if (cur.from == ch) {\n        if (cur.from != cur.to && sticky != \"before\") { found = i; }\n        else { bidiOther = i; }\n      }\n    }\n    return found != null ? found : bidiOther\n  }\n\n  // Bidirectional ordering algorithm\n  // See http://unicode.org/reports/tr9/tr9-13.html for the algorithm\n  // that this (partially) implements.\n\n  // One-char codes used for character types:\n  // L (L):   Left-to-Right\n  // R (R):   Right-to-Left\n  // r (AL):  Right-to-Left Arabic\n  // 1 (EN):  European Number\n  // + (ES):  European Number Separator\n  // % (ET):  European Number Terminator\n  // n (AN):  Arabic Number\n  // , (CS):  Common Number Separator\n  // m (NSM): Non-Spacing Mark\n  // b (BN):  Boundary Neutral\n  // s (B):   Paragraph Separator\n  // t (S):   Segment Separator\n  // w (WS):  Whitespace\n  // N (ON):  Other Neutrals\n\n  // Returns null if characters are ordered as they appear\n  // (left-to-right), or an array of sections ({from, to, level}\n  // objects) in the order in which they occur visually.\n  var bidiOrdering = (function() {\n    // Character types for codepoints 0 to 0xff\n    var lowTypes = \"bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN\";\n    // Character types for codepoints 0x600 to 0x6f9\n    var arabicTypes = \"nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111\";\n    function charType(code) {\n      if (code <= 0xf7) { return lowTypes.charAt(code) }\n      else if (0x590 <= code && code <= 0x5f4) { return \"R\" }\n      else if (0x600 <= code && code <= 0x6f9) { return arabicTypes.charAt(code - 0x600) }\n      else if (0x6ee <= code && code <= 0x8ac) { return \"r\" }\n      else if (0x2000 <= code && code <= 0x200b) { return \"w\" }\n      else if (code == 0x200c) { return \"b\" }\n      else { return \"L\" }\n    }\n\n    var bidiRE = /[\\u0590-\\u05f4\\u0600-\\u06ff\\u0700-\\u08ac]/;\n    var isNeutral = /[stwN]/, isStrong = /[LRr]/, countsAsLeft = /[Lb1n]/, countsAsNum = /[1n]/;\n\n    function BidiSpan(level, from, to) {\n      this.level = level;\n      this.from = from; this.to = to;\n    }\n\n    return function(str, direction) {\n      var outerType = direction == \"ltr\" ? \"L\" : \"R\";\n\n      if (str.length == 0 || direction == \"ltr\" && !bidiRE.test(str)) { return false }\n      var len = str.length, types = [];\n      for (var i = 0; i < len; ++i)\n        { types.push(charType(str.charCodeAt(i))); }\n\n      // W1. Examine each non-spacing mark (NSM) in the level run, and\n      // change the type of the NSM to the type of the previous\n      // character. If the NSM is at the start of the level run, it will\n      // get the type of sor.\n      for (var i$1 = 0, prev = outerType; i$1 < len; ++i$1) {\n        var type = types[i$1];\n        if (type == \"m\") { types[i$1] = prev; }\n        else { prev = type; }\n      }\n\n      // W2. Search backwards from each instance of a European number\n      // until the first strong type (R, L, AL, or sor) is found. If an\n      // AL is found, change the type of the European number to Arabic\n      // number.\n      // W3. Change all ALs to R.\n      for (var i$2 = 0, cur = outerType; i$2 < len; ++i$2) {\n        var type$1 = types[i$2];\n        if (type$1 == \"1\" && cur == \"r\") { types[i$2] = \"n\"; }\n        else if (isStrong.test(type$1)) { cur = type$1; if (type$1 == \"r\") { types[i$2] = \"R\"; } }\n      }\n\n      // W4. A single European separator between two European numbers\n      // changes to a European number. A single common separator between\n      // two numbers of the same type changes to that type.\n      for (var i$3 = 1, prev$1 = types[0]; i$3 < len - 1; ++i$3) {\n        var type$2 = types[i$3];\n        if (type$2 == \"+\" && prev$1 == \"1\" && types[i$3+1] == \"1\") { types[i$3] = \"1\"; }\n        else if (type$2 == \",\" && prev$1 == types[i$3+1] &&\n                 (prev$1 == \"1\" || prev$1 == \"n\")) { types[i$3] = prev$1; }\n        prev$1 = type$2;\n      }\n\n      // W5. A sequence of European terminators adjacent to European\n      // numbers changes to all European numbers.\n      // W6. Otherwise, separators and terminators change to Other\n      // Neutral.\n      for (var i$4 = 0; i$4 < len; ++i$4) {\n        var type$3 = types[i$4];\n        if (type$3 == \",\") { types[i$4] = \"N\"; }\n        else if (type$3 == \"%\") {\n          var end = (void 0);\n          for (end = i$4 + 1; end < len && types[end] == \"%\"; ++end) {}\n          var replace = (i$4 && types[i$4-1] == \"!\") || (end < len && types[end] == \"1\") ? \"1\" : \"N\";\n          for (var j = i$4; j < end; ++j) { types[j] = replace; }\n          i$4 = end - 1;\n        }\n      }\n\n      // W7. Search backwards from each instance of a European number\n      // until the first strong type (R, L, or sor) is found. If an L is\n      // found, then change the type of the European number to L.\n      for (var i$5 = 0, cur$1 = outerType; i$5 < len; ++i$5) {\n        var type$4 = types[i$5];\n        if (cur$1 == \"L\" && type$4 == \"1\") { types[i$5] = \"L\"; }\n        else if (isStrong.test(type$4)) { cur$1 = type$4; }\n      }\n\n      // N1. A sequence of neutrals takes the direction of the\n      // surrounding strong text if the text on both sides has the same\n      // direction. European and Arabic numbers act as if they were R in\n      // terms of their influence on neutrals. Start-of-level-run (sor)\n      // and end-of-level-run (eor) are used at level run boundaries.\n      // N2. Any remaining neutrals take the embedding direction.\n      for (var i$6 = 0; i$6 < len; ++i$6) {\n        if (isNeutral.test(types[i$6])) {\n          var end$1 = (void 0);\n          for (end$1 = i$6 + 1; end$1 < len && isNeutral.test(types[end$1]); ++end$1) {}\n          var before = (i$6 ? types[i$6-1] : outerType) == \"L\";\n          var after = (end$1 < len ? types[end$1] : outerType) == \"L\";\n          var replace$1 = before == after ? (before ? \"L\" : \"R\") : outerType;\n          for (var j$1 = i$6; j$1 < end$1; ++j$1) { types[j$1] = replace$1; }\n          i$6 = end$1 - 1;\n        }\n      }\n\n      // Here we depart from the documented algorithm, in order to avoid\n      // building up an actual levels array. Since there are only three\n      // levels (0, 1, 2) in an implementation that doesn't take\n      // explicit embedding into account, we can build up the order on\n      // the fly, without following the level-based algorithm.\n      var order = [], m;\n      for (var i$7 = 0; i$7 < len;) {\n        if (countsAsLeft.test(types[i$7])) {\n          var start = i$7;\n          for (++i$7; i$7 < len && countsAsLeft.test(types[i$7]); ++i$7) {}\n          order.push(new BidiSpan(0, start, i$7));\n        } else {\n          var pos = i$7, at = order.length;\n          for (++i$7; i$7 < len && types[i$7] != \"L\"; ++i$7) {}\n          for (var j$2 = pos; j$2 < i$7;) {\n            if (countsAsNum.test(types[j$2])) {\n              if (pos < j$2) { order.splice(at, 0, new BidiSpan(1, pos, j$2)); }\n              var nstart = j$2;\n              for (++j$2; j$2 < i$7 && countsAsNum.test(types[j$2]); ++j$2) {}\n              order.splice(at, 0, new BidiSpan(2, nstart, j$2));\n              pos = j$2;\n            } else { ++j$2; }\n          }\n          if (pos < i$7) { order.splice(at, 0, new BidiSpan(1, pos, i$7)); }\n        }\n      }\n      if (direction == \"ltr\") {\n        if (order[0].level == 1 && (m = str.match(/^\\s+/))) {\n          order[0].from = m[0].length;\n          order.unshift(new BidiSpan(0, 0, m[0].length));\n        }\n        if (lst(order).level == 1 && (m = str.match(/\\s+$/))) {\n          lst(order).to -= m[0].length;\n          order.push(new BidiSpan(0, len - m[0].length, len));\n        }\n      }\n\n      return direction == \"rtl\" ? order.reverse() : order\n    }\n  })();\n\n  // Get the bidi ordering for the given line (and cache it). Returns\n  // false for lines that are fully left-to-right, and an array of\n  // BidiSpan objects otherwise.\n  function getOrder(line, direction) {\n    var order = line.order;\n    if (order == null) { order = line.order = bidiOrdering(line.text, direction); }\n    return order\n  }\n\n  // EVENT HANDLING\n\n  // Lightweight event framework. on/off also work on DOM nodes,\n  // registering native DOM handlers.\n\n  var noHandlers = [];\n\n  var on = function(emitter, type, f) {\n    if (emitter.addEventListener) {\n      emitter.addEventListener(type, f, false);\n    } else if (emitter.attachEvent) {\n      emitter.attachEvent(\"on\" + type, f);\n    } else {\n      var map$$1 = emitter._handlers || (emitter._handlers = {});\n      map$$1[type] = (map$$1[type] || noHandlers).concat(f);\n    }\n  };\n\n  function getHandlers(emitter, type) {\n    return emitter._handlers && emitter._handlers[type] || noHandlers\n  }\n\n  function off(emitter, type, f) {\n    if (emitter.removeEventListener) {\n      emitter.removeEventListener(type, f, false);\n    } else if (emitter.detachEvent) {\n      emitter.detachEvent(\"on\" + type, f);\n    } else {\n      var map$$1 = emitter._handlers, arr = map$$1 && map$$1[type];\n      if (arr) {\n        var index = indexOf(arr, f);\n        if (index > -1)\n          { map$$1[type] = arr.slice(0, index).concat(arr.slice(index + 1)); }\n      }\n    }\n  }\n\n  function signal(emitter, type /*, values...*/) {\n    var handlers = getHandlers(emitter, type);\n    if (!handlers.length) { return }\n    var args = Array.prototype.slice.call(arguments, 2);\n    for (var i = 0; i < handlers.length; ++i) { handlers[i].apply(null, args); }\n  }\n\n  // The DOM events that CodeMirror handles can be overridden by\n  // registering a (non-DOM) handler on the editor for the event name,\n  // and preventDefault-ing the event in that handler.\n  function signalDOMEvent(cm, e, override) {\n    if (typeof e == \"string\")\n      { e = {type: e, preventDefault: function() { this.defaultPrevented = true; }}; }\n    signal(cm, override || e.type, cm, e);\n    return e_defaultPrevented(e) || e.codemirrorIgnore\n  }\n\n  function signalCursorActivity(cm) {\n    var arr = cm._handlers && cm._handlers.cursorActivity;\n    if (!arr) { return }\n    var set = cm.curOp.cursorActivityHandlers || (cm.curOp.cursorActivityHandlers = []);\n    for (var i = 0; i < arr.length; ++i) { if (indexOf(set, arr[i]) == -1)\n      { set.push(arr[i]); } }\n  }\n\n  function hasHandler(emitter, type) {\n    return getHandlers(emitter, type).length > 0\n  }\n\n  // Add on and off methods to a constructor's prototype, to make\n  // registering events on such objects more convenient.\n  function eventMixin(ctor) {\n    ctor.prototype.on = function(type, f) {on(this, type, f);};\n    ctor.prototype.off = function(type, f) {off(this, type, f);};\n  }\n\n  // Due to the fact that we still support jurassic IE versions, some\n  // compatibility wrappers are needed.\n\n  function e_preventDefault(e) {\n    if (e.preventDefault) { e.preventDefault(); }\n    else { e.returnValue = false; }\n  }\n  function e_stopPropagation(e) {\n    if (e.stopPropagation) { e.stopPropagation(); }\n    else { e.cancelBubble = true; }\n  }\n  function e_defaultPrevented(e) {\n    return e.defaultPrevented != null ? e.defaultPrevented : e.returnValue == false\n  }\n  function e_stop(e) {e_preventDefault(e); e_stopPropagation(e);}\n\n  function e_target(e) {return e.target || e.srcElement}\n  function e_button(e) {\n    var b = e.which;\n    if (b == null) {\n      if (e.button & 1) { b = 1; }\n      else if (e.button & 2) { b = 3; }\n      else if (e.button & 4) { b = 2; }\n    }\n    if (mac && e.ctrlKey && b == 1) { b = 3; }\n    return b\n  }\n\n  // Detect drag-and-drop\n  var dragAndDrop = function() {\n    // There is *some* kind of drag-and-drop support in IE6-8, but I\n    // couldn't get it to work yet.\n    if (ie && ie_version < 9) { return false }\n    var div = elt('div');\n    return \"draggable\" in div || \"dragDrop\" in div\n  }();\n\n  var zwspSupported;\n  function zeroWidthElement(measure) {\n    if (zwspSupported == null) {\n      var test = elt(\"span\", \"\\u200b\");\n      removeChildrenAndAdd(measure, elt(\"span\", [test, document.createTextNode(\"x\")]));\n      if (measure.firstChild.offsetHeight != 0)\n        { zwspSupported = test.offsetWidth <= 1 && test.offsetHeight > 2 && !(ie && ie_version < 8); }\n    }\n    var node = zwspSupported ? elt(\"span\", \"\\u200b\") :\n      elt(\"span\", \"\\u00a0\", null, \"display: inline-block; width: 1px; margin-right: -1px\");\n    node.setAttribute(\"cm-text\", \"\");\n    return node\n  }\n\n  // Feature-detect IE's crummy client rect reporting for bidi text\n  var badBidiRects;\n  function hasBadBidiRects(measure) {\n    if (badBidiRects != null) { return badBidiRects }\n    var txt = removeChildrenAndAdd(measure, document.createTextNode(\"A\\u062eA\"));\n    var r0 = range(txt, 0, 1).getBoundingClientRect();\n    var r1 = range(txt, 1, 2).getBoundingClientRect();\n    removeChildren(measure);\n    if (!r0 || r0.left == r0.right) { return false } // Safari returns null in some cases (#2780)\n    return badBidiRects = (r1.right - r0.right < 3)\n  }\n\n  // See if \"\".split is the broken IE version, if so, provide an\n  // alternative way to split lines.\n  var splitLinesAuto = \"\\n\\nb\".split(/\\n/).length != 3 ? function (string) {\n    var pos = 0, result = [], l = string.length;\n    while (pos <= l) {\n      var nl = string.indexOf(\"\\n\", pos);\n      if (nl == -1) { nl = string.length; }\n      var line = string.slice(pos, string.charAt(nl - 1) == \"\\r\" ? nl - 1 : nl);\n      var rt = line.indexOf(\"\\r\");\n      if (rt != -1) {\n        result.push(line.slice(0, rt));\n        pos += rt + 1;\n      } else {\n        result.push(line);\n        pos = nl + 1;\n      }\n    }\n    return result\n  } : function (string) { return string.split(/\\r\\n?|\\n/); };\n\n  var hasSelection = window.getSelection ? function (te) {\n    try { return te.selectionStart != te.selectionEnd }\n    catch(e) { return false }\n  } : function (te) {\n    var range$$1;\n    try {range$$1 = te.ownerDocument.selection.createRange();}\n    catch(e) {}\n    if (!range$$1 || range$$1.parentElement() != te) { return false }\n    return range$$1.compareEndPoints(\"StartToEnd\", range$$1) != 0\n  };\n\n  var hasCopyEvent = (function () {\n    var e = elt(\"div\");\n    if (\"oncopy\" in e) { return true }\n    e.setAttribute(\"oncopy\", \"return;\");\n    return typeof e.oncopy == \"function\"\n  })();\n\n  var badZoomedRects = null;\n  function hasBadZoomedRects(measure) {\n    if (badZoomedRects != null) { return badZoomedRects }\n    var node = removeChildrenAndAdd(measure, elt(\"span\", \"x\"));\n    var normal = node.getBoundingClientRect();\n    var fromRange = range(node, 0, 1).getBoundingClientRect();\n    return badZoomedRects = Math.abs(normal.left - fromRange.left) > 1\n  }\n\n  // Known modes, by name and by MIME\n  var modes = {}, mimeModes = {};\n\n  // Extra arguments are stored as the mode's dependencies, which is\n  // used by (legacy) mechanisms like loadmode.js to automatically\n  // load a mode. (Preferred mechanism is the require/define calls.)\n  function defineMode(name, mode) {\n    if (arguments.length > 2)\n      { mode.dependencies = Array.prototype.slice.call(arguments, 2); }\n    modes[name] = mode;\n  }\n\n  function defineMIME(mime, spec) {\n    mimeModes[mime] = spec;\n  }\n\n  // Given a MIME type, a {name, ...options} config object, or a name\n  // string, return a mode config object.\n  function resolveMode(spec) {\n    if (typeof spec == \"string\" && mimeModes.hasOwnProperty(spec)) {\n      spec = mimeModes[spec];\n    } else if (spec && typeof spec.name == \"string\" && mimeModes.hasOwnProperty(spec.name)) {\n      var found = mimeModes[spec.name];\n      if (typeof found == \"string\") { found = {name: found}; }\n      spec = createObj(found, spec);\n      spec.name = found.name;\n    } else if (typeof spec == \"string\" && /^[\\w\\-]+\\/[\\w\\-]+\\+xml$/.test(spec)) {\n      return resolveMode(\"application/xml\")\n    } else if (typeof spec == \"string\" && /^[\\w\\-]+\\/[\\w\\-]+\\+json$/.test(spec)) {\n      return resolveMode(\"application/json\")\n    }\n    if (typeof spec == \"string\") { return {name: spec} }\n    else { return spec || {name: \"null\"} }\n  }\n\n  // Given a mode spec (anything that resolveMode accepts), find and\n  // initialize an actual mode object.\n  function getMode(options, spec) {\n    spec = resolveMode(spec);\n    var mfactory = modes[spec.name];\n    if (!mfactory) { return getMode(options, \"text/plain\") }\n    var modeObj = mfactory(options, spec);\n    if (modeExtensions.hasOwnProperty(spec.name)) {\n      var exts = modeExtensions[spec.name];\n      for (var prop in exts) {\n        if (!exts.hasOwnProperty(prop)) { continue }\n        if (modeObj.hasOwnProperty(prop)) { modeObj[\"_\" + prop] = modeObj[prop]; }\n        modeObj[prop] = exts[prop];\n      }\n    }\n    modeObj.name = spec.name;\n    if (spec.helperType) { modeObj.helperType = spec.helperType; }\n    if (spec.modeProps) { for (var prop$1 in spec.modeProps)\n      { modeObj[prop$1] = spec.modeProps[prop$1]; } }\n\n    return modeObj\n  }\n\n  // This can be used to attach properties to mode objects from\n  // outside the actual mode definition.\n  var modeExtensions = {};\n  function extendMode(mode, properties) {\n    var exts = modeExtensions.hasOwnProperty(mode) ? modeExtensions[mode] : (modeExtensions[mode] = {});\n    copyObj(properties, exts);\n  }\n\n  function copyState(mode, state) {\n    if (state === true) { return state }\n    if (mode.copyState) { return mode.copyState(state) }\n    var nstate = {};\n    for (var n in state) {\n      var val = state[n];\n      if (val instanceof Array) { val = val.concat([]); }\n      nstate[n] = val;\n    }\n    return nstate\n  }\n\n  // Given a mode and a state (for that mode), find the inner mode and\n  // state at the position that the state refers to.\n  function innerMode(mode, state) {\n    var info;\n    while (mode.innerMode) {\n      info = mode.innerMode(state);\n      if (!info || info.mode == mode) { break }\n      state = info.state;\n      mode = info.mode;\n    }\n    return info || {mode: mode, state: state}\n  }\n\n  function startState(mode, a1, a2) {\n    return mode.startState ? mode.startState(a1, a2) : true\n  }\n\n  // STRING STREAM\n\n  // Fed to the mode parsers, provides helper functions to make\n  // parsers more succinct.\n\n  var StringStream = function(string, tabSize, lineOracle) {\n    this.pos = this.start = 0;\n    this.string = string;\n    this.tabSize = tabSize || 8;\n    this.lastColumnPos = this.lastColumnValue = 0;\n    this.lineStart = 0;\n    this.lineOracle = lineOracle;\n  };\n\n  StringStream.prototype.eol = function () {return this.pos >= this.string.length};\n  StringStream.prototype.sol = function () {return this.pos == this.lineStart};\n  StringStream.prototype.peek = function () {return this.string.charAt(this.pos) || undefined};\n  StringStream.prototype.next = function () {\n    if (this.pos < this.string.length)\n      { return this.string.charAt(this.pos++) }\n  };\n  StringStream.prototype.eat = function (match) {\n    var ch = this.string.charAt(this.pos);\n    var ok;\n    if (typeof match == \"string\") { ok = ch == match; }\n    else { ok = ch && (match.test ? match.test(ch) : match(ch)); }\n    if (ok) {++this.pos; return ch}\n  };\n  StringStream.prototype.eatWhile = function (match) {\n    var start = this.pos;\n    while (this.eat(match)){}\n    return this.pos > start\n  };\n  StringStream.prototype.eatSpace = function () {\n      var this$1 = this;\n\n    var start = this.pos;\n    while (/[\\s\\u00a0]/.test(this.string.charAt(this.pos))) { ++this$1.pos; }\n    return this.pos > start\n  };\n  StringStream.prototype.skipToEnd = function () {this.pos = this.string.length;};\n  StringStream.prototype.skipTo = function (ch) {\n    var found = this.string.indexOf(ch, this.pos);\n    if (found > -1) {this.pos = found; return true}\n  };\n  StringStream.prototype.backUp = function (n) {this.pos -= n;};\n  StringStream.prototype.column = function () {\n    if (this.lastColumnPos < this.start) {\n      this.lastColumnValue = countColumn(this.string, this.start, this.tabSize, this.lastColumnPos, this.lastColumnValue);\n      this.lastColumnPos = this.start;\n    }\n    return this.lastColumnValue - (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0)\n  };\n  StringStream.prototype.indentation = function () {\n    return countColumn(this.string, null, this.tabSize) -\n      (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0)\n  };\n  StringStream.prototype.match = function (pattern, consume, caseInsensitive) {\n    if (typeof pattern == \"string\") {\n      var cased = function (str) { return caseInsensitive ? str.toLowerCase() : str; };\n      var substr = this.string.substr(this.pos, pattern.length);\n      if (cased(substr) == cased(pattern)) {\n        if (consume !== false) { this.pos += pattern.length; }\n        return true\n      }\n    } else {\n      var match = this.string.slice(this.pos).match(pattern);\n      if (match && match.index > 0) { return null }\n      if (match && consume !== false) { this.pos += match[0].length; }\n      return match\n    }\n  };\n  StringStream.prototype.current = function (){return this.string.slice(this.start, this.pos)};\n  StringStream.prototype.hideFirstChars = function (n, inner) {\n    this.lineStart += n;\n    try { return inner() }\n    finally { this.lineStart -= n; }\n  };\n  StringStream.prototype.lookAhead = function (n) {\n    var oracle = this.lineOracle;\n    return oracle && oracle.lookAhead(n)\n  };\n  StringStream.prototype.baseToken = function () {\n    var oracle = this.lineOracle;\n    return oracle && oracle.baseToken(this.pos)\n  };\n\n  // Find the line object corresponding to the given line number.\n  function getLine(doc, n) {\n    n -= doc.first;\n    if (n < 0 || n >= doc.size) { throw new Error(\"There is no line \" + (n + doc.first) + \" in the document.\") }\n    var chunk = doc;\n    while (!chunk.lines) {\n      for (var i = 0;; ++i) {\n        var child = chunk.children[i], sz = child.chunkSize();\n        if (n < sz) { chunk = child; break }\n        n -= sz;\n      }\n    }\n    return chunk.lines[n]\n  }\n\n  // Get the part of a document between two positions, as an array of\n  // strings.\n  function getBetween(doc, start, end) {\n    var out = [], n = start.line;\n    doc.iter(start.line, end.line + 1, function (line) {\n      var text = line.text;\n      if (n == end.line) { text = text.slice(0, end.ch); }\n      if (n == start.line) { text = text.slice(start.ch); }\n      out.push(text);\n      ++n;\n    });\n    return out\n  }\n  // Get the lines between from and to, as array of strings.\n  function getLines(doc, from, to) {\n    var out = [];\n    doc.iter(from, to, function (line) { out.push(line.text); }); // iter aborts when callback returns truthy value\n    return out\n  }\n\n  // Update the height of a line, propagating the height change\n  // upwards to parent nodes.\n  function updateLineHeight(line, height) {\n    var diff = height - line.height;\n    if (diff) { for (var n = line; n; n = n.parent) { n.height += diff; } }\n  }\n\n  // Given a line object, find its line number by walking up through\n  // its parent links.\n  function lineNo(line) {\n    if (line.parent == null) { return null }\n    var cur = line.parent, no = indexOf(cur.lines, line);\n    for (var chunk = cur.parent; chunk; cur = chunk, chunk = chunk.parent) {\n      for (var i = 0;; ++i) {\n        if (chunk.children[i] == cur) { break }\n        no += chunk.children[i].chunkSize();\n      }\n    }\n    return no + cur.first\n  }\n\n  // Find the line at the given vertical position, using the height\n  // information in the document tree.\n  function lineAtHeight(chunk, h) {\n    var n = chunk.first;\n    outer: do {\n      for (var i$1 = 0; i$1 < chunk.children.length; ++i$1) {\n        var child = chunk.children[i$1], ch = child.height;\n        if (h < ch) { chunk = child; continue outer }\n        h -= ch;\n        n += child.chunkSize();\n      }\n      return n\n    } while (!chunk.lines)\n    var i = 0;\n    for (; i < chunk.lines.length; ++i) {\n      var line = chunk.lines[i], lh = line.height;\n      if (h < lh) { break }\n      h -= lh;\n    }\n    return n + i\n  }\n\n  function isLine(doc, l) {return l >= doc.first && l < doc.first + doc.size}\n\n  function lineNumberFor(options, i) {\n    return String(options.lineNumberFormatter(i + options.firstLineNumber))\n  }\n\n  // A Pos instance represents a position within the text.\n  function Pos(line, ch, sticky) {\n    if ( sticky === void 0 ) sticky = null;\n\n    if (!(this instanceof Pos)) { return new Pos(line, ch, sticky) }\n    this.line = line;\n    this.ch = ch;\n    this.sticky = sticky;\n  }\n\n  // Compare two positions, return 0 if they are the same, a negative\n  // number when a is less, and a positive number otherwise.\n  function cmp(a, b) { return a.line - b.line || a.ch - b.ch }\n\n  function equalCursorPos(a, b) { return a.sticky == b.sticky && cmp(a, b) == 0 }\n\n  function copyPos(x) {return Pos(x.line, x.ch)}\n  function maxPos(a, b) { return cmp(a, b) < 0 ? b : a }\n  function minPos(a, b) { return cmp(a, b) < 0 ? a : b }\n\n  // Most of the external API clips given positions to make sure they\n  // actually exist within the document.\n  function clipLine(doc, n) {return Math.max(doc.first, Math.min(n, doc.first + doc.size - 1))}\n  function clipPos(doc, pos) {\n    if (pos.line < doc.first) { return Pos(doc.first, 0) }\n    var last = doc.first + doc.size - 1;\n    if (pos.line > last) { return Pos(last, getLine(doc, last).text.length) }\n    return clipToLen(pos, getLine(doc, pos.line).text.length)\n  }\n  function clipToLen(pos, linelen) {\n    var ch = pos.ch;\n    if (ch == null || ch > linelen) { return Pos(pos.line, linelen) }\n    else if (ch < 0) { return Pos(pos.line, 0) }\n    else { return pos }\n  }\n  function clipPosArray(doc, array) {\n    var out = [];\n    for (var i = 0; i < array.length; i++) { out[i] = clipPos(doc, array[i]); }\n    return out\n  }\n\n  var SavedContext = function(state, lookAhead) {\n    this.state = state;\n    this.lookAhead = lookAhead;\n  };\n\n  var Context = function(doc, state, line, lookAhead) {\n    this.state = state;\n    this.doc = doc;\n    this.line = line;\n    this.maxLookAhead = lookAhead || 0;\n    this.baseTokens = null;\n    this.baseTokenPos = 1;\n  };\n\n  Context.prototype.lookAhead = function (n) {\n    var line = this.doc.getLine(this.line + n);\n    if (line != null && n > this.maxLookAhead) { this.maxLookAhead = n; }\n    return line\n  };\n\n  Context.prototype.baseToken = function (n) {\n      var this$1 = this;\n\n    if (!this.baseTokens) { return null }\n    while (this.baseTokens[this.baseTokenPos] <= n)\n      { this$1.baseTokenPos += 2; }\n    var type = this.baseTokens[this.baseTokenPos + 1];\n    return {type: type && type.replace(/( |^)overlay .*/, \"\"),\n            size: this.baseTokens[this.baseTokenPos] - n}\n  };\n\n  Context.prototype.nextLine = function () {\n    this.line++;\n    if (this.maxLookAhead > 0) { this.maxLookAhead--; }\n  };\n\n  Context.fromSaved = function (doc, saved, line) {\n    if (saved instanceof SavedContext)\n      { return new Context(doc, copyState(doc.mode, saved.state), line, saved.lookAhead) }\n    else\n      { return new Context(doc, copyState(doc.mode, saved), line) }\n  };\n\n  Context.prototype.save = function (copy) {\n    var state = copy !== false ? copyState(this.doc.mode, this.state) : this.state;\n    return this.maxLookAhead > 0 ? new SavedContext(state, this.maxLookAhead) : state\n  };\n\n\n  // Compute a style array (an array starting with a mode generation\n  // -- for invalidation -- followed by pairs of end positions and\n  // style strings), which is used to highlight the tokens on the\n  // line.\n  function highlightLine(cm, line, context, forceToEnd) {\n    // A styles array always starts with a number identifying the\n    // mode/overlays that it is based on (for easy invalidation).\n    var st = [cm.state.modeGen], lineClasses = {};\n    // Compute the base array of styles\n    runMode(cm, line.text, cm.doc.mode, context, function (end, style) { return st.push(end, style); },\n            lineClasses, forceToEnd);\n    var state = context.state;\n\n    // Run overlays, adjust style array.\n    var loop = function ( o ) {\n      context.baseTokens = st;\n      var overlay = cm.state.overlays[o], i = 1, at = 0;\n      context.state = true;\n      runMode(cm, line.text, overlay.mode, context, function (end, style) {\n        var start = i;\n        // Ensure there's a token end at the current position, and that i points at it\n        while (at < end) {\n          var i_end = st[i];\n          if (i_end > end)\n            { st.splice(i, 1, end, st[i+1], i_end); }\n          i += 2;\n          at = Math.min(end, i_end);\n        }\n        if (!style) { return }\n        if (overlay.opaque) {\n          st.splice(start, i - start, end, \"overlay \" + style);\n          i = start + 2;\n        } else {\n          for (; start < i; start += 2) {\n            var cur = st[start+1];\n            st[start+1] = (cur ? cur + \" \" : \"\") + \"overlay \" + style;\n          }\n        }\n      }, lineClasses);\n      context.state = state;\n      context.baseTokens = null;\n      context.baseTokenPos = 1;\n    };\n\n    for (var o = 0; o < cm.state.overlays.length; ++o) loop( o );\n\n    return {styles: st, classes: lineClasses.bgClass || lineClasses.textClass ? lineClasses : null}\n  }\n\n  function getLineStyles(cm, line, updateFrontier) {\n    if (!line.styles || line.styles[0] != cm.state.modeGen) {\n      var context = getContextBefore(cm, lineNo(line));\n      var resetState = line.text.length > cm.options.maxHighlightLength && copyState(cm.doc.mode, context.state);\n      var result = highlightLine(cm, line, context);\n      if (resetState) { context.state = resetState; }\n      line.stateAfter = context.save(!resetState);\n      line.styles = result.styles;\n      if (result.classes) { line.styleClasses = result.classes; }\n      else if (line.styleClasses) { line.styleClasses = null; }\n      if (updateFrontier === cm.doc.highlightFrontier)\n        { cm.doc.modeFrontier = Math.max(cm.doc.modeFrontier, ++cm.doc.highlightFrontier); }\n    }\n    return line.styles\n  }\n\n  function getContextBefore(cm, n, precise) {\n    var doc = cm.doc, display = cm.display;\n    if (!doc.mode.startState) { return new Context(doc, true, n) }\n    var start = findStartLine(cm, n, precise);\n    var saved = start > doc.first && getLine(doc, start - 1).stateAfter;\n    var context = saved ? Context.fromSaved(doc, saved, start) : new Context(doc, startState(doc.mode), start);\n\n    doc.iter(start, n, function (line) {\n      processLine(cm, line.text, context);\n      var pos = context.line;\n      line.stateAfter = pos == n - 1 || pos % 5 == 0 || pos >= display.viewFrom && pos < display.viewTo ? context.save() : null;\n      context.nextLine();\n    });\n    if (precise) { doc.modeFrontier = context.line; }\n    return context\n  }\n\n  // Lightweight form of highlight -- proceed over this line and\n  // update state, but don't save a style array. Used for lines that\n  // aren't currently visible.\n  function processLine(cm, text, context, startAt) {\n    var mode = cm.doc.mode;\n    var stream = new StringStream(text, cm.options.tabSize, context);\n    stream.start = stream.pos = startAt || 0;\n    if (text == \"\") { callBlankLine(mode, context.state); }\n    while (!stream.eol()) {\n      readToken(mode, stream, context.state);\n      stream.start = stream.pos;\n    }\n  }\n\n  function callBlankLine(mode, state) {\n    if (mode.blankLine) { return mode.blankLine(state) }\n    if (!mode.innerMode) { return }\n    var inner = innerMode(mode, state);\n    if (inner.mode.blankLine) { return inner.mode.blankLine(inner.state) }\n  }\n\n  function readToken(mode, stream, state, inner) {\n    for (var i = 0; i < 10; i++) {\n      if (inner) { inner[0] = innerMode(mode, state).mode; }\n      var style = mode.token(stream, state);\n      if (stream.pos > stream.start) { return style }\n    }\n    throw new Error(\"Mode \" + mode.name + \" failed to advance stream.\")\n  }\n\n  var Token = function(stream, type, state) {\n    this.start = stream.start; this.end = stream.pos;\n    this.string = stream.current();\n    this.type = type || null;\n    this.state = state;\n  };\n\n  // Utility for getTokenAt and getLineTokens\n  function takeToken(cm, pos, precise, asArray) {\n    var doc = cm.doc, mode = doc.mode, style;\n    pos = clipPos(doc, pos);\n    var line = getLine(doc, pos.line), context = getContextBefore(cm, pos.line, precise);\n    var stream = new StringStream(line.text, cm.options.tabSize, context), tokens;\n    if (asArray) { tokens = []; }\n    while ((asArray || stream.pos < pos.ch) && !stream.eol()) {\n      stream.start = stream.pos;\n      style = readToken(mode, stream, context.state);\n      if (asArray) { tokens.push(new Token(stream, style, copyState(doc.mode, context.state))); }\n    }\n    return asArray ? tokens : new Token(stream, style, context.state)\n  }\n\n  function extractLineClasses(type, output) {\n    if (type) { for (;;) {\n      var lineClass = type.match(/(?:^|\\s+)line-(background-)?(\\S+)/);\n      if (!lineClass) { break }\n      type = type.slice(0, lineClass.index) + type.slice(lineClass.index + lineClass[0].length);\n      var prop = lineClass[1] ? \"bgClass\" : \"textClass\";\n      if (output[prop] == null)\n        { output[prop] = lineClass[2]; }\n      else if (!(new RegExp(\"(?:^|\\s)\" + lineClass[2] + \"(?:$|\\s)\")).test(output[prop]))\n        { output[prop] += \" \" + lineClass[2]; }\n    } }\n    return type\n  }\n\n  // Run the given mode's parser over a line, calling f for each token.\n  function runMode(cm, text, mode, context, f, lineClasses, forceToEnd) {\n    var flattenSpans = mode.flattenSpans;\n    if (flattenSpans == null) { flattenSpans = cm.options.flattenSpans; }\n    var curStart = 0, curStyle = null;\n    var stream = new StringStream(text, cm.options.tabSize, context), style;\n    var inner = cm.options.addModeClass && [null];\n    if (text == \"\") { extractLineClasses(callBlankLine(mode, context.state), lineClasses); }\n    while (!stream.eol()) {\n      if (stream.pos > cm.options.maxHighlightLength) {\n        flattenSpans = false;\n        if (forceToEnd) { processLine(cm, text, context, stream.pos); }\n        stream.pos = text.length;\n        style = null;\n      } else {\n        style = extractLineClasses(readToken(mode, stream, context.state, inner), lineClasses);\n      }\n      if (inner) {\n        var mName = inner[0].name;\n        if (mName) { style = \"m-\" + (style ? mName + \" \" + style : mName); }\n      }\n      if (!flattenSpans || curStyle != style) {\n        while (curStart < stream.start) {\n          curStart = Math.min(stream.start, curStart + 5000);\n          f(curStart, curStyle);\n        }\n        curStyle = style;\n      }\n      stream.start = stream.pos;\n    }\n    while (curStart < stream.pos) {\n      // Webkit seems to refuse to render text nodes longer than 57444\n      // characters, and returns inaccurate measurements in nodes\n      // starting around 5000 chars.\n      var pos = Math.min(stream.pos, curStart + 5000);\n      f(pos, curStyle);\n      curStart = pos;\n    }\n  }\n\n  // Finds the line to start with when starting a parse. Tries to\n  // find a line with a stateAfter, so that it can start with a\n  // valid state. If that fails, it returns the line with the\n  // smallest indentation, which tends to need the least context to\n  // parse correctly.\n  function findStartLine(cm, n, precise) {\n    var minindent, minline, doc = cm.doc;\n    var lim = precise ? -1 : n - (cm.doc.mode.innerMode ? 1000 : 100);\n    for (var search = n; search > lim; --search) {\n      if (search <= doc.first) { return doc.first }\n      var line = getLine(doc, search - 1), after = line.stateAfter;\n      if (after && (!precise || search + (after instanceof SavedContext ? after.lookAhead : 0) <= doc.modeFrontier))\n        { return search }\n      var indented = countColumn(line.text, null, cm.options.tabSize);\n      if (minline == null || minindent > indented) {\n        minline = search - 1;\n        minindent = indented;\n      }\n    }\n    return minline\n  }\n\n  function retreatFrontier(doc, n) {\n    doc.modeFrontier = Math.min(doc.modeFrontier, n);\n    if (doc.highlightFrontier < n - 10) { return }\n    var start = doc.first;\n    for (var line = n - 1; line > start; line--) {\n      var saved = getLine(doc, line).stateAfter;\n      // change is on 3\n      // state on line 1 looked ahead 2 -- so saw 3\n      // test 1 + 2 < 3 should cover this\n      if (saved && (!(saved instanceof SavedContext) || line + saved.lookAhead < n)) {\n        start = line + 1;\n        break\n      }\n    }\n    doc.highlightFrontier = Math.min(doc.highlightFrontier, start);\n  }\n\n  // Optimize some code when these features are not used.\n  var sawReadOnlySpans = false, sawCollapsedSpans = false;\n\n  function seeReadOnlySpans() {\n    sawReadOnlySpans = true;\n  }\n\n  function seeCollapsedSpans() {\n    sawCollapsedSpans = true;\n  }\n\n  // TEXTMARKER SPANS\n\n  function MarkedSpan(marker, from, to) {\n    this.marker = marker;\n    this.from = from; this.to = to;\n  }\n\n  // Search an array of spans for a span matching the given marker.\n  function getMarkedSpanFor(spans, marker) {\n    if (spans) { for (var i = 0; i < spans.length; ++i) {\n      var span = spans[i];\n      if (span.marker == marker) { return span }\n    } }\n  }\n  // Remove a span from an array, returning undefined if no spans are\n  // left (we don't store arrays for lines without spans).\n  function removeMarkedSpan(spans, span) {\n    var r;\n    for (var i = 0; i < spans.length; ++i)\n      { if (spans[i] != span) { (r || (r = [])).push(spans[i]); } }\n    return r\n  }\n  // Add a span to a line.\n  function addMarkedSpan(line, span) {\n    line.markedSpans = line.markedSpans ? line.markedSpans.concat([span]) : [span];\n    span.marker.attachLine(line);\n  }\n\n  // Used for the algorithm that adjusts markers for a change in the\n  // document. These functions cut an array of spans at a given\n  // character position, returning an array of remaining chunks (or\n  // undefined if nothing remains).\n  function markedSpansBefore(old, startCh, isInsert) {\n    var nw;\n    if (old) { for (var i = 0; i < old.length; ++i) {\n      var span = old[i], marker = span.marker;\n      var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= startCh : span.from < startCh);\n      if (startsBefore || span.from == startCh && marker.type == \"bookmark\" && (!isInsert || !span.marker.insertLeft)) {\n        var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= startCh : span.to > startCh)\n        ;(nw || (nw = [])).push(new MarkedSpan(marker, span.from, endsAfter ? null : span.to));\n      }\n    } }\n    return nw\n  }\n  function markedSpansAfter(old, endCh, isInsert) {\n    var nw;\n    if (old) { for (var i = 0; i < old.length; ++i) {\n      var span = old[i], marker = span.marker;\n      var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= endCh : span.to > endCh);\n      if (endsAfter || span.from == endCh && marker.type == \"bookmark\" && (!isInsert || span.marker.insertLeft)) {\n        var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= endCh : span.from < endCh)\n        ;(nw || (nw = [])).push(new MarkedSpan(marker, startsBefore ? null : span.from - endCh,\n                                              span.to == null ? null : span.to - endCh));\n      }\n    } }\n    return nw\n  }\n\n  // Given a change object, compute the new set of marker spans that\n  // cover the line in which the change took place. Removes spans\n  // entirely within the change, reconnects spans belonging to the\n  // same marker that appear on both sides of the change, and cuts off\n  // spans partially within the change. Returns an array of span\n  // arrays with one element for each line in (after) the change.\n  function stretchSpansOverChange(doc, change) {\n    if (change.full) { return null }\n    var oldFirst = isLine(doc, change.from.line) && getLine(doc, change.from.line).markedSpans;\n    var oldLast = isLine(doc, change.to.line) && getLine(doc, change.to.line).markedSpans;\n    if (!oldFirst && !oldLast) { return null }\n\n    var startCh = change.from.ch, endCh = change.to.ch, isInsert = cmp(change.from, change.to) == 0;\n    // Get the spans that 'stick out' on both sides\n    var first = markedSpansBefore(oldFirst, startCh, isInsert);\n    var last = markedSpansAfter(oldLast, endCh, isInsert);\n\n    // Next, merge those two ends\n    var sameLine = change.text.length == 1, offset = lst(change.text).length + (sameLine ? startCh : 0);\n    if (first) {\n      // Fix up .to properties of first\n      for (var i = 0; i < first.length; ++i) {\n        var span = first[i];\n        if (span.to == null) {\n          var found = getMarkedSpanFor(last, span.marker);\n          if (!found) { span.to = startCh; }\n          else if (sameLine) { span.to = found.to == null ? null : found.to + offset; }\n        }\n      }\n    }\n    if (last) {\n      // Fix up .from in last (or move them into first in case of sameLine)\n      for (var i$1 = 0; i$1 < last.length; ++i$1) {\n        var span$1 = last[i$1];\n        if (span$1.to != null) { span$1.to += offset; }\n        if (span$1.from == null) {\n          var found$1 = getMarkedSpanFor(first, span$1.marker);\n          if (!found$1) {\n            span$1.from = offset;\n            if (sameLine) { (first || (first = [])).push(span$1); }\n          }\n        } else {\n          span$1.from += offset;\n          if (sameLine) { (first || (first = [])).push(span$1); }\n        }\n      }\n    }\n    // Make sure we didn't create any zero-length spans\n    if (first) { first = clearEmptySpans(first); }\n    if (last && last != first) { last = clearEmptySpans(last); }\n\n    var newMarkers = [first];\n    if (!sameLine) {\n      // Fill gap with whole-line-spans\n      var gap = change.text.length - 2, gapMarkers;\n      if (gap > 0 && first)\n        { for (var i$2 = 0; i$2 < first.length; ++i$2)\n          { if (first[i$2].to == null)\n            { (gapMarkers || (gapMarkers = [])).push(new MarkedSpan(first[i$2].marker, null, null)); } } }\n      for (var i$3 = 0; i$3 < gap; ++i$3)\n        { newMarkers.push(gapMarkers); }\n      newMarkers.push(last);\n    }\n    return newMarkers\n  }\n\n  // Remove spans that are empty and don't have a clearWhenEmpty\n  // option of false.\n  function clearEmptySpans(spans) {\n    for (var i = 0; i < spans.length; ++i) {\n      var span = spans[i];\n      if (span.from != null && span.from == span.to && span.marker.clearWhenEmpty !== false)\n        { spans.splice(i--, 1); }\n    }\n    if (!spans.length) { return null }\n    return spans\n  }\n\n  // Used to 'clip' out readOnly ranges when making a change.\n  function removeReadOnlyRanges(doc, from, to) {\n    var markers = null;\n    doc.iter(from.line, to.line + 1, function (line) {\n      if (line.markedSpans) { for (var i = 0; i < line.markedSpans.length; ++i) {\n        var mark = line.markedSpans[i].marker;\n        if (mark.readOnly && (!markers || indexOf(markers, mark) == -1))\n          { (markers || (markers = [])).push(mark); }\n      } }\n    });\n    if (!markers) { return null }\n    var parts = [{from: from, to: to}];\n    for (var i = 0; i < markers.length; ++i) {\n      var mk = markers[i], m = mk.find(0);\n      for (var j = 0; j < parts.length; ++j) {\n        var p = parts[j];\n        if (cmp(p.to, m.from) < 0 || cmp(p.from, m.to) > 0) { continue }\n        var newParts = [j, 1], dfrom = cmp(p.from, m.from), dto = cmp(p.to, m.to);\n        if (dfrom < 0 || !mk.inclusiveLeft && !dfrom)\n          { newParts.push({from: p.from, to: m.from}); }\n        if (dto > 0 || !mk.inclusiveRight && !dto)\n          { newParts.push({from: m.to, to: p.to}); }\n        parts.splice.apply(parts, newParts);\n        j += newParts.length - 3;\n      }\n    }\n    return parts\n  }\n\n  // Connect or disconnect spans from a line.\n  function detachMarkedSpans(line) {\n    var spans = line.markedSpans;\n    if (!spans) { return }\n    for (var i = 0; i < spans.length; ++i)\n      { spans[i].marker.detachLine(line); }\n    line.markedSpans = null;\n  }\n  function attachMarkedSpans(line, spans) {\n    if (!spans) { return }\n    for (var i = 0; i < spans.length; ++i)\n      { spans[i].marker.attachLine(line); }\n    line.markedSpans = spans;\n  }\n\n  // Helpers used when computing which overlapping collapsed span\n  // counts as the larger one.\n  function extraLeft(marker) { return marker.inclusiveLeft ? -1 : 0 }\n  function extraRight(marker) { return marker.inclusiveRight ? 1 : 0 }\n\n  // Returns a number indicating which of two overlapping collapsed\n  // spans is larger (and thus includes the other). Falls back to\n  // comparing ids when the spans cover exactly the same range.\n  function compareCollapsedMarkers(a, b) {\n    var lenDiff = a.lines.length - b.lines.length;\n    if (lenDiff != 0) { return lenDiff }\n    var aPos = a.find(), bPos = b.find();\n    var fromCmp = cmp(aPos.from, bPos.from) || extraLeft(a) - extraLeft(b);\n    if (fromCmp) { return -fromCmp }\n    var toCmp = cmp(aPos.to, bPos.to) || extraRight(a) - extraRight(b);\n    if (toCmp) { return toCmp }\n    return b.id - a.id\n  }\n\n  // Find out whether a line ends or starts in a collapsed span. If\n  // so, return the marker for that span.\n  function collapsedSpanAtSide(line, start) {\n    var sps = sawCollapsedSpans && line.markedSpans, found;\n    if (sps) { for (var sp = (void 0), i = 0; i < sps.length; ++i) {\n      sp = sps[i];\n      if (sp.marker.collapsed && (start ? sp.from : sp.to) == null &&\n          (!found || compareCollapsedMarkers(found, sp.marker) < 0))\n        { found = sp.marker; }\n    } }\n    return found\n  }\n  function collapsedSpanAtStart(line) { return collapsedSpanAtSide(line, true) }\n  function collapsedSpanAtEnd(line) { return collapsedSpanAtSide(line, false) }\n\n  function collapsedSpanAround(line, ch) {\n    var sps = sawCollapsedSpans && line.markedSpans, found;\n    if (sps) { for (var i = 0; i < sps.length; ++i) {\n      var sp = sps[i];\n      if (sp.marker.collapsed && (sp.from == null || sp.from < ch) && (sp.to == null || sp.to > ch) &&\n          (!found || compareCollapsedMarkers(found, sp.marker) < 0)) { found = sp.marker; }\n    } }\n    return found\n  }\n\n  // Test whether there exists a collapsed span that partially\n  // overlaps (covers the start or end, but not both) of a new span.\n  // Such overlap is not allowed.\n  function conflictingCollapsedRange(doc, lineNo$$1, from, to, marker) {\n    var line = getLine(doc, lineNo$$1);\n    var sps = sawCollapsedSpans && line.markedSpans;\n    if (sps) { for (var i = 0; i < sps.length; ++i) {\n      var sp = sps[i];\n      if (!sp.marker.collapsed) { continue }\n      var found = sp.marker.find(0);\n      var fromCmp = cmp(found.from, from) || extraLeft(sp.marker) - extraLeft(marker);\n      var toCmp = cmp(found.to, to) || extraRight(sp.marker) - extraRight(marker);\n      if (fromCmp >= 0 && toCmp <= 0 || fromCmp <= 0 && toCmp >= 0) { continue }\n      if (fromCmp <= 0 && (sp.marker.inclusiveRight && marker.inclusiveLeft ? cmp(found.to, from) >= 0 : cmp(found.to, from) > 0) ||\n          fromCmp >= 0 && (sp.marker.inclusiveRight && marker.inclusiveLeft ? cmp(found.from, to) <= 0 : cmp(found.from, to) < 0))\n        { return true }\n    } }\n  }\n\n  // A visual line is a line as drawn on the screen. Folding, for\n  // example, can cause multiple logical lines to appear on the same\n  // visual line. This finds the start of the visual line that the\n  // given line is part of (usually that is the line itself).\n  function visualLine(line) {\n    var merged;\n    while (merged = collapsedSpanAtStart(line))\n      { line = merged.find(-1, true).line; }\n    return line\n  }\n\n  function visualLineEnd(line) {\n    var merged;\n    while (merged = collapsedSpanAtEnd(line))\n      { line = merged.find(1, true).line; }\n    return line\n  }\n\n  // Returns an array of logical lines that continue the visual line\n  // started by the argument, or undefined if there are no such lines.\n  function visualLineContinued(line) {\n    var merged, lines;\n    while (merged = collapsedSpanAtEnd(line)) {\n      line = merged.find(1, true).line\n      ;(lines || (lines = [])).push(line);\n    }\n    return lines\n  }\n\n  // Get the line number of the start of the visual line that the\n  // given line number is part of.\n  function visualLineNo(doc, lineN) {\n    var line = getLine(doc, lineN), vis = visualLine(line);\n    if (line == vis) { return lineN }\n    return lineNo(vis)\n  }\n\n  // Get the line number of the start of the next visual line after\n  // the given line.\n  function visualLineEndNo(doc, lineN) {\n    if (lineN > doc.lastLine()) { return lineN }\n    var line = getLine(doc, lineN), merged;\n    if (!lineIsHidden(doc, line)) { return lineN }\n    while (merged = collapsedSpanAtEnd(line))\n      { line = merged.find(1, true).line; }\n    return lineNo(line) + 1\n  }\n\n  // Compute whether a line is hidden. Lines count as hidden when they\n  // are part of a visual line that starts with another line, or when\n  // they are entirely covered by collapsed, non-widget span.\n  function lineIsHidden(doc, line) {\n    var sps = sawCollapsedSpans && line.markedSpans;\n    if (sps) { for (var sp = (void 0), i = 0; i < sps.length; ++i) {\n      sp = sps[i];\n      if (!sp.marker.collapsed) { continue }\n      if (sp.from == null) { return true }\n      if (sp.marker.widgetNode) { continue }\n      if (sp.from == 0 && sp.marker.inclusiveLeft && lineIsHiddenInner(doc, line, sp))\n        { return true }\n    } }\n  }\n  function lineIsHiddenInner(doc, line, span) {\n    if (span.to == null) {\n      var end = span.marker.find(1, true);\n      return lineIsHiddenInner(doc, end.line, getMarkedSpanFor(end.line.markedSpans, span.marker))\n    }\n    if (span.marker.inclusiveRight && span.to == line.text.length)\n      { return true }\n    for (var sp = (void 0), i = 0; i < line.markedSpans.length; ++i) {\n      sp = line.markedSpans[i];\n      if (sp.marker.collapsed && !sp.marker.widgetNode && sp.from == span.to &&\n          (sp.to == null || sp.to != span.from) &&\n          (sp.marker.inclusiveLeft || span.marker.inclusiveRight) &&\n          lineIsHiddenInner(doc, line, sp)) { return true }\n    }\n  }\n\n  // Find the height above the given line.\n  function heightAtLine(lineObj) {\n    lineObj = visualLine(lineObj);\n\n    var h = 0, chunk = lineObj.parent;\n    for (var i = 0; i < chunk.lines.length; ++i) {\n      var line = chunk.lines[i];\n      if (line == lineObj) { break }\n      else { h += line.height; }\n    }\n    for (var p = chunk.parent; p; chunk = p, p = chunk.parent) {\n      for (var i$1 = 0; i$1 < p.children.length; ++i$1) {\n        var cur = p.children[i$1];\n        if (cur == chunk) { break }\n        else { h += cur.height; }\n      }\n    }\n    return h\n  }\n\n  // Compute the character length of a line, taking into account\n  // collapsed ranges (see markText) that might hide parts, and join\n  // other lines onto it.\n  function lineLength(line) {\n    if (line.height == 0) { return 0 }\n    var len = line.text.length, merged, cur = line;\n    while (merged = collapsedSpanAtStart(cur)) {\n      var found = merged.find(0, true);\n      cur = found.from.line;\n      len += found.from.ch - found.to.ch;\n    }\n    cur = line;\n    while (merged = collapsedSpanAtEnd(cur)) {\n      var found$1 = merged.find(0, true);\n      len -= cur.text.length - found$1.from.ch;\n      cur = found$1.to.line;\n      len += cur.text.length - found$1.to.ch;\n    }\n    return len\n  }\n\n  // Find the longest line in the document.\n  function findMaxLine(cm) {\n    var d = cm.display, doc = cm.doc;\n    d.maxLine = getLine(doc, doc.first);\n    d.maxLineLength = lineLength(d.maxLine);\n    d.maxLineChanged = true;\n    doc.iter(function (line) {\n      var len = lineLength(line);\n      if (len > d.maxLineLength) {\n        d.maxLineLength = len;\n        d.maxLine = line;\n      }\n    });\n  }\n\n  // LINE DATA STRUCTURE\n\n  // Line objects. These hold state related to a line, including\n  // highlighting info (the styles array).\n  var Line = function(text, markedSpans, estimateHeight) {\n    this.text = text;\n    attachMarkedSpans(this, markedSpans);\n    this.height = estimateHeight ? estimateHeight(this) : 1;\n  };\n\n  Line.prototype.lineNo = function () { return lineNo(this) };\n  eventMixin(Line);\n\n  // Change the content (text, markers) of a line. Automatically\n  // invalidates cached information and tries to re-estimate the\n  // line's height.\n  function updateLine(line, text, markedSpans, estimateHeight) {\n    line.text = text;\n    if (line.stateAfter) { line.stateAfter = null; }\n    if (line.styles) { line.styles = null; }\n    if (line.order != null) { line.order = null; }\n    detachMarkedSpans(line);\n    attachMarkedSpans(line, markedSpans);\n    var estHeight = estimateHeight ? estimateHeight(line) : 1;\n    if (estHeight != line.height) { updateLineHeight(line, estHeight); }\n  }\n\n  // Detach a line from the document tree and its markers.\n  function cleanUpLine(line) {\n    line.parent = null;\n    detachMarkedSpans(line);\n  }\n\n  // Convert a style as returned by a mode (either null, or a string\n  // containing one or more styles) to a CSS style. This is cached,\n  // and also looks for line-wide styles.\n  var styleToClassCache = {}, styleToClassCacheWithMode = {};\n  function interpretTokenStyle(style, options) {\n    if (!style || /^\\s*$/.test(style)) { return null }\n    var cache = options.addModeClass ? styleToClassCacheWithMode : styleToClassCache;\n    return cache[style] ||\n      (cache[style] = style.replace(/\\S+/g, \"cm-$&\"))\n  }\n\n  // Render the DOM representation of the text of a line. Also builds\n  // up a 'line map', which points at the DOM nodes that represent\n  // specific stretches of text, and is used by the measuring code.\n  // The returned object contains the DOM node, this map, and\n  // information about line-wide styles that were set by the mode.\n  function buildLineContent(cm, lineView) {\n    // The padding-right forces the element to have a 'border', which\n    // is needed on Webkit to be able to get line-level bounding\n    // rectangles for it (in measureChar).\n    var content = eltP(\"span\", null, null, webkit ? \"padding-right: .1px\" : null);\n    var builder = {pre: eltP(\"pre\", [content], \"CodeMirror-line\"), content: content,\n                   col: 0, pos: 0, cm: cm,\n                   trailingSpace: false,\n                   splitSpaces: cm.getOption(\"lineWrapping\")};\n    lineView.measure = {};\n\n    // Iterate over the logical lines that make up this visual line.\n    for (var i = 0; i <= (lineView.rest ? lineView.rest.length : 0); i++) {\n      var line = i ? lineView.rest[i - 1] : lineView.line, order = (void 0);\n      builder.pos = 0;\n      builder.addToken = buildToken;\n      // Optionally wire in some hacks into the token-rendering\n      // algorithm, to deal with browser quirks.\n      if (hasBadBidiRects(cm.display.measure) && (order = getOrder(line, cm.doc.direction)))\n        { builder.addToken = buildTokenBadBidi(builder.addToken, order); }\n      builder.map = [];\n      var allowFrontierUpdate = lineView != cm.display.externalMeasured && lineNo(line);\n      insertLineContent(line, builder, getLineStyles(cm, line, allowFrontierUpdate));\n      if (line.styleClasses) {\n        if (line.styleClasses.bgClass)\n          { builder.bgClass = joinClasses(line.styleClasses.bgClass, builder.bgClass || \"\"); }\n        if (line.styleClasses.textClass)\n          { builder.textClass = joinClasses(line.styleClasses.textClass, builder.textClass || \"\"); }\n      }\n\n      // Ensure at least a single node is present, for measuring.\n      if (builder.map.length == 0)\n        { builder.map.push(0, 0, builder.content.appendChild(zeroWidthElement(cm.display.measure))); }\n\n      // Store the map and a cache object for the current logical line\n      if (i == 0) {\n        lineView.measure.map = builder.map;\n        lineView.measure.cache = {};\n      } else {\n  (lineView.measure.maps || (lineView.measure.maps = [])).push(builder.map)\n        ;(lineView.measure.caches || (lineView.measure.caches = [])).push({});\n      }\n    }\n\n    // See issue #2901\n    if (webkit) {\n      var last = builder.content.lastChild;\n      if (/\\bcm-tab\\b/.test(last.className) || (last.querySelector && last.querySelector(\".cm-tab\")))\n        { builder.content.className = \"cm-tab-wrap-hack\"; }\n    }\n\n    signal(cm, \"renderLine\", cm, lineView.line, builder.pre);\n    if (builder.pre.className)\n      { builder.textClass = joinClasses(builder.pre.className, builder.textClass || \"\"); }\n\n    return builder\n  }\n\n  function defaultSpecialCharPlaceholder(ch) {\n    var token = elt(\"span\", \"\\u2022\", \"cm-invalidchar\");\n    token.title = \"\\\\u\" + ch.charCodeAt(0).toString(16);\n    token.setAttribute(\"aria-label\", token.title);\n    return token\n  }\n\n  // Build up the DOM representation for a single token, and add it to\n  // the line map. Takes care to render special characters separately.\n  function buildToken(builder, text, style, startStyle, endStyle, css, attributes) {\n    if (!text) { return }\n    var displayText = builder.splitSpaces ? splitSpaces(text, builder.trailingSpace) : text;\n    var special = builder.cm.state.specialChars, mustWrap = false;\n    var content;\n    if (!special.test(text)) {\n      builder.col += text.length;\n      content = document.createTextNode(displayText);\n      builder.map.push(builder.pos, builder.pos + text.length, content);\n      if (ie && ie_version < 9) { mustWrap = true; }\n      builder.pos += text.length;\n    } else {\n      content = document.createDocumentFragment();\n      var pos = 0;\n      while (true) {\n        special.lastIndex = pos;\n        var m = special.exec(text);\n        var skipped = m ? m.index - pos : text.length - pos;\n        if (skipped) {\n          var txt = document.createTextNode(displayText.slice(pos, pos + skipped));\n          if (ie && ie_version < 9) { content.appendChild(elt(\"span\", [txt])); }\n          else { content.appendChild(txt); }\n          builder.map.push(builder.pos, builder.pos + skipped, txt);\n          builder.col += skipped;\n          builder.pos += skipped;\n        }\n        if (!m) { break }\n        pos += skipped + 1;\n        var txt$1 = (void 0);\n        if (m[0] == \"\\t\") {\n          var tabSize = builder.cm.options.tabSize, tabWidth = tabSize - builder.col % tabSize;\n          txt$1 = content.appendChild(elt(\"span\", spaceStr(tabWidth), \"cm-tab\"));\n          txt$1.setAttribute(\"role\", \"presentation\");\n          txt$1.setAttribute(\"cm-text\", \"\\t\");\n          builder.col += tabWidth;\n        } else if (m[0] == \"\\r\" || m[0] == \"\\n\") {\n          txt$1 = content.appendChild(elt(\"span\", m[0] == \"\\r\" ? \"\\u240d\" : \"\\u2424\", \"cm-invalidchar\"));\n          txt$1.setAttribute(\"cm-text\", m[0]);\n          builder.col += 1;\n        } else {\n          txt$1 = builder.cm.options.specialCharPlaceholder(m[0]);\n          txt$1.setAttribute(\"cm-text\", m[0]);\n          if (ie && ie_version < 9) { content.appendChild(elt(\"span\", [txt$1])); }\n          else { content.appendChild(txt$1); }\n          builder.col += 1;\n        }\n        builder.map.push(builder.pos, builder.pos + 1, txt$1);\n        builder.pos++;\n      }\n    }\n    builder.trailingSpace = displayText.charCodeAt(text.length - 1) == 32;\n    if (style || startStyle || endStyle || mustWrap || css) {\n      var fullStyle = style || \"\";\n      if (startStyle) { fullStyle += startStyle; }\n      if (endStyle) { fullStyle += endStyle; }\n      var token = elt(\"span\", [content], fullStyle, css);\n      if (attributes) {\n        for (var attr in attributes) { if (attributes.hasOwnProperty(attr) && attr != \"style\" && attr != \"class\")\n          { token.setAttribute(attr, attributes[attr]); } }\n      }\n      return builder.content.appendChild(token)\n    }\n    builder.content.appendChild(content);\n  }\n\n  // Change some spaces to NBSP to prevent the browser from collapsing\n  // trailing spaces at the end of a line when rendering text (issue #1362).\n  function splitSpaces(text, trailingBefore) {\n    if (text.length > 1 && !/  /.test(text)) { return text }\n    var spaceBefore = trailingBefore, result = \"\";\n    for (var i = 0; i < text.length; i++) {\n      var ch = text.charAt(i);\n      if (ch == \" \" && spaceBefore && (i == text.length - 1 || text.charCodeAt(i + 1) == 32))\n        { ch = \"\\u00a0\"; }\n      result += ch;\n      spaceBefore = ch == \" \";\n    }\n    return result\n  }\n\n  // Work around nonsense dimensions being reported for stretches of\n  // right-to-left text.\n  function buildTokenBadBidi(inner, order) {\n    return function (builder, text, style, startStyle, endStyle, css, attributes) {\n      style = style ? style + \" cm-force-border\" : \"cm-force-border\";\n      var start = builder.pos, end = start + text.length;\n      for (;;) {\n        // Find the part that overlaps with the start of this text\n        var part = (void 0);\n        for (var i = 0; i < order.length; i++) {\n          part = order[i];\n          if (part.to > start && part.from <= start) { break }\n        }\n        if (part.to >= end) { return inner(builder, text, style, startStyle, endStyle, css, attributes) }\n        inner(builder, text.slice(0, part.to - start), style, startStyle, null, css, attributes);\n        startStyle = null;\n        text = text.slice(part.to - start);\n        start = part.to;\n      }\n    }\n  }\n\n  function buildCollapsedSpan(builder, size, marker, ignoreWidget) {\n    var widget = !ignoreWidget && marker.widgetNode;\n    if (widget) { builder.map.push(builder.pos, builder.pos + size, widget); }\n    if (!ignoreWidget && builder.cm.display.input.needsContentAttribute) {\n      if (!widget)\n        { widget = builder.content.appendChild(document.createElement(\"span\")); }\n      widget.setAttribute(\"cm-marker\", marker.id);\n    }\n    if (widget) {\n      builder.cm.display.input.setUneditable(widget);\n      builder.content.appendChild(widget);\n    }\n    builder.pos += size;\n    builder.trailingSpace = false;\n  }\n\n  // Outputs a number of spans to make up a line, taking highlighting\n  // and marked text into account.\n  function insertLineContent(line, builder, styles) {\n    var spans = line.markedSpans, allText = line.text, at = 0;\n    if (!spans) {\n      for (var i$1 = 1; i$1 < styles.length; i$1+=2)\n        { builder.addToken(builder, allText.slice(at, at = styles[i$1]), interpretTokenStyle(styles[i$1+1], builder.cm.options)); }\n      return\n    }\n\n    var len = allText.length, pos = 0, i = 1, text = \"\", style, css;\n    var nextChange = 0, spanStyle, spanEndStyle, spanStartStyle, collapsed, attributes;\n    for (;;) {\n      if (nextChange == pos) { // Update current marker set\n        spanStyle = spanEndStyle = spanStartStyle = css = \"\";\n        attributes = null;\n        collapsed = null; nextChange = Infinity;\n        var foundBookmarks = [], endStyles = (void 0);\n        for (var j = 0; j < spans.length; ++j) {\n          var sp = spans[j], m = sp.marker;\n          if (m.type == \"bookmark\" && sp.from == pos && m.widgetNode) {\n            foundBookmarks.push(m);\n          } else if (sp.from <= pos && (sp.to == null || sp.to > pos || m.collapsed && sp.to == pos && sp.from == pos)) {\n            if (sp.to != null && sp.to != pos && nextChange > sp.to) {\n              nextChange = sp.to;\n              spanEndStyle = \"\";\n            }\n            if (m.className) { spanStyle += \" \" + m.className; }\n            if (m.css) { css = (css ? css + \";\" : \"\") + m.css; }\n            if (m.startStyle && sp.from == pos) { spanStartStyle += \" \" + m.startStyle; }\n            if (m.endStyle && sp.to == nextChange) { (endStyles || (endStyles = [])).push(m.endStyle, sp.to); }\n            // support for the old title property\n            // https://github.com/codemirror/CodeMirror/pull/5673\n            if (m.title) { (attributes || (attributes = {})).title = m.title; }\n            if (m.attributes) {\n              for (var attr in m.attributes)\n                { (attributes || (attributes = {}))[attr] = m.attributes[attr]; }\n            }\n            if (m.collapsed && (!collapsed || compareCollapsedMarkers(collapsed.marker, m) < 0))\n              { collapsed = sp; }\n          } else if (sp.from > pos && nextChange > sp.from) {\n            nextChange = sp.from;\n          }\n        }\n        if (endStyles) { for (var j$1 = 0; j$1 < endStyles.length; j$1 += 2)\n          { if (endStyles[j$1 + 1] == nextChange) { spanEndStyle += \" \" + endStyles[j$1]; } } }\n\n        if (!collapsed || collapsed.from == pos) { for (var j$2 = 0; j$2 < foundBookmarks.length; ++j$2)\n          { buildCollapsedSpan(builder, 0, foundBookmarks[j$2]); } }\n        if (collapsed && (collapsed.from || 0) == pos) {\n          buildCollapsedSpan(builder, (collapsed.to == null ? len + 1 : collapsed.to) - pos,\n                             collapsed.marker, collapsed.from == null);\n          if (collapsed.to == null) { return }\n          if (collapsed.to == pos) { collapsed = false; }\n        }\n      }\n      if (pos >= len) { break }\n\n      var upto = Math.min(len, nextChange);\n      while (true) {\n        if (text) {\n          var end = pos + text.length;\n          if (!collapsed) {\n            var tokenText = end > upto ? text.slice(0, upto - pos) : text;\n            builder.addToken(builder, tokenText, style ? style + spanStyle : spanStyle,\n                             spanStartStyle, pos + tokenText.length == nextChange ? spanEndStyle : \"\", css, attributes);\n          }\n          if (end >= upto) {text = text.slice(upto - pos); pos = upto; break}\n          pos = end;\n          spanStartStyle = \"\";\n        }\n        text = allText.slice(at, at = styles[i++]);\n        style = interpretTokenStyle(styles[i++], builder.cm.options);\n      }\n    }\n  }\n\n\n  // These objects are used to represent the visible (currently drawn)\n  // part of the document. A LineView may correspond to multiple\n  // logical lines, if those are connected by collapsed ranges.\n  function LineView(doc, line, lineN) {\n    // The starting line\n    this.line = line;\n    // Continuing lines, if any\n    this.rest = visualLineContinued(line);\n    // Number of logical lines in this visual line\n    this.size = this.rest ? lineNo(lst(this.rest)) - lineN + 1 : 1;\n    this.node = this.text = null;\n    this.hidden = lineIsHidden(doc, line);\n  }\n\n  // Create a range of LineView objects for the given lines.\n  function buildViewArray(cm, from, to) {\n    var array = [], nextPos;\n    for (var pos = from; pos < to; pos = nextPos) {\n      var view = new LineView(cm.doc, getLine(cm.doc, pos), pos);\n      nextPos = pos + view.size;\n      array.push(view);\n    }\n    return array\n  }\n\n  var operationGroup = null;\n\n  function pushOperation(op) {\n    if (operationGroup) {\n      operationGroup.ops.push(op);\n    } else {\n      op.ownsGroup = operationGroup = {\n        ops: [op],\n        delayedCallbacks: []\n      };\n    }\n  }\n\n  function fireCallbacksForOps(group) {\n    // Calls delayed callbacks and cursorActivity handlers until no\n    // new ones appear\n    var callbacks = group.delayedCallbacks, i = 0;\n    do {\n      for (; i < callbacks.length; i++)\n        { callbacks[i].call(null); }\n      for (var j = 0; j < group.ops.length; j++) {\n        var op = group.ops[j];\n        if (op.cursorActivityHandlers)\n          { while (op.cursorActivityCalled < op.cursorActivityHandlers.length)\n            { op.cursorActivityHandlers[op.cursorActivityCalled++].call(null, op.cm); } }\n      }\n    } while (i < callbacks.length)\n  }\n\n  function finishOperation(op, endCb) {\n    var group = op.ownsGroup;\n    if (!group) { return }\n\n    try { fireCallbacksForOps(group); }\n    finally {\n      operationGroup = null;\n      endCb(group);\n    }\n  }\n\n  var orphanDelayedCallbacks = null;\n\n  // Often, we want to signal events at a point where we are in the\n  // middle of some work, but don't want the handler to start calling\n  // other methods on the editor, which might be in an inconsistent\n  // state or simply not expect any other events to happen.\n  // signalLater looks whether there are any handlers, and schedules\n  // them to be executed when the last operation ends, or, if no\n  // operation is active, when a timeout fires.\n  function signalLater(emitter, type /*, values...*/) {\n    var arr = getHandlers(emitter, type);\n    if (!arr.length) { return }\n    var args = Array.prototype.slice.call(arguments, 2), list;\n    if (operationGroup) {\n      list = operationGroup.delayedCallbacks;\n    } else if (orphanDelayedCallbacks) {\n      list = orphanDelayedCallbacks;\n    } else {\n      list = orphanDelayedCallbacks = [];\n      setTimeout(fireOrphanDelayed, 0);\n    }\n    var loop = function ( i ) {\n      list.push(function () { return arr[i].apply(null, args); });\n    };\n\n    for (var i = 0; i < arr.length; ++i)\n      loop( i );\n  }\n\n  function fireOrphanDelayed() {\n    var delayed = orphanDelayedCallbacks;\n    orphanDelayedCallbacks = null;\n    for (var i = 0; i < delayed.length; ++i) { delayed[i](); }\n  }\n\n  // When an aspect of a line changes, a string is added to\n  // lineView.changes. This updates the relevant part of the line's\n  // DOM structure.\n  function updateLineForChanges(cm, lineView, lineN, dims) {\n    for (var j = 0; j < lineView.changes.length; j++) {\n      var type = lineView.changes[j];\n      if (type == \"text\") { updateLineText(cm, lineView); }\n      else if (type == \"gutter\") { updateLineGutter(cm, lineView, lineN, dims); }\n      else if (type == \"class\") { updateLineClasses(cm, lineView); }\n      else if (type == \"widget\") { updateLineWidgets(cm, lineView, dims); }\n    }\n    lineView.changes = null;\n  }\n\n  // Lines with gutter elements, widgets or a background class need to\n  // be wrapped, and have the extra elements added to the wrapper div\n  function ensureLineWrapped(lineView) {\n    if (lineView.node == lineView.text) {\n      lineView.node = elt(\"div\", null, null, \"position: relative\");\n      if (lineView.text.parentNode)\n        { lineView.text.parentNode.replaceChild(lineView.node, lineView.text); }\n      lineView.node.appendChild(lineView.text);\n      if (ie && ie_version < 8) { lineView.node.style.zIndex = 2; }\n    }\n    return lineView.node\n  }\n\n  function updateLineBackground(cm, lineView) {\n    var cls = lineView.bgClass ? lineView.bgClass + \" \" + (lineView.line.bgClass || \"\") : lineView.line.bgClass;\n    if (cls) { cls += \" CodeMirror-linebackground\"; }\n    if (lineView.background) {\n      if (cls) { lineView.background.className = cls; }\n      else { lineView.background.parentNode.removeChild(lineView.background); lineView.background = null; }\n    } else if (cls) {\n      var wrap = ensureLineWrapped(lineView);\n      lineView.background = wrap.insertBefore(elt(\"div\", null, cls), wrap.firstChild);\n      cm.display.input.setUneditable(lineView.background);\n    }\n  }\n\n  // Wrapper around buildLineContent which will reuse the structure\n  // in display.externalMeasured when possible.\n  function getLineContent(cm, lineView) {\n    var ext = cm.display.externalMeasured;\n    if (ext && ext.line == lineView.line) {\n      cm.display.externalMeasured = null;\n      lineView.measure = ext.measure;\n      return ext.built\n    }\n    return buildLineContent(cm, lineView)\n  }\n\n  // Redraw the line's text. Interacts with the background and text\n  // classes because the mode may output tokens that influence these\n  // classes.\n  function updateLineText(cm, lineView) {\n    var cls = lineView.text.className;\n    var built = getLineContent(cm, lineView);\n    if (lineView.text == lineView.node) { lineView.node = built.pre; }\n    lineView.text.parentNode.replaceChild(built.pre, lineView.text);\n    lineView.text = built.pre;\n    if (built.bgClass != lineView.bgClass || built.textClass != lineView.textClass) {\n      lineView.bgClass = built.bgClass;\n      lineView.textClass = built.textClass;\n      updateLineClasses(cm, lineView);\n    } else if (cls) {\n      lineView.text.className = cls;\n    }\n  }\n\n  function updateLineClasses(cm, lineView) {\n    updateLineBackground(cm, lineView);\n    if (lineView.line.wrapClass)\n      { ensureLineWrapped(lineView).className = lineView.line.wrapClass; }\n    else if (lineView.node != lineView.text)\n      { lineView.node.className = \"\"; }\n    var textClass = lineView.textClass ? lineView.textClass + \" \" + (lineView.line.textClass || \"\") : lineView.line.textClass;\n    lineView.text.className = textClass || \"\";\n  }\n\n  function updateLineGutter(cm, lineView, lineN, dims) {\n    if (lineView.gutter) {\n      lineView.node.removeChild(lineView.gutter);\n      lineView.gutter = null;\n    }\n    if (lineView.gutterBackground) {\n      lineView.node.removeChild(lineView.gutterBackground);\n      lineView.gutterBackground = null;\n    }\n    if (lineView.line.gutterClass) {\n      var wrap = ensureLineWrapped(lineView);\n      lineView.gutterBackground = elt(\"div\", null, \"CodeMirror-gutter-background \" + lineView.line.gutterClass,\n                                      (\"left: \" + (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) + \"px; width: \" + (dims.gutterTotalWidth) + \"px\"));\n      cm.display.input.setUneditable(lineView.gutterBackground);\n      wrap.insertBefore(lineView.gutterBackground, lineView.text);\n    }\n    var markers = lineView.line.gutterMarkers;\n    if (cm.options.lineNumbers || markers) {\n      var wrap$1 = ensureLineWrapped(lineView);\n      var gutterWrap = lineView.gutter = elt(\"div\", null, \"CodeMirror-gutter-wrapper\", (\"left: \" + (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) + \"px\"));\n      cm.display.input.setUneditable(gutterWrap);\n      wrap$1.insertBefore(gutterWrap, lineView.text);\n      if (lineView.line.gutterClass)\n        { gutterWrap.className += \" \" + lineView.line.gutterClass; }\n      if (cm.options.lineNumbers && (!markers || !markers[\"CodeMirror-linenumbers\"]))\n        { lineView.lineNumber = gutterWrap.appendChild(\n          elt(\"div\", lineNumberFor(cm.options, lineN),\n              \"CodeMirror-linenumber CodeMirror-gutter-elt\",\n              (\"left: \" + (dims.gutterLeft[\"CodeMirror-linenumbers\"]) + \"px; width: \" + (cm.display.lineNumInnerWidth) + \"px\"))); }\n      if (markers) { for (var k = 0; k < cm.display.gutterSpecs.length; ++k) {\n        var id = cm.display.gutterSpecs[k].className, found = markers.hasOwnProperty(id) && markers[id];\n        if (found)\n          { gutterWrap.appendChild(elt(\"div\", [found], \"CodeMirror-gutter-elt\",\n                                     (\"left: \" + (dims.gutterLeft[id]) + \"px; width: \" + (dims.gutterWidth[id]) + \"px\"))); }\n      } }\n    }\n  }\n\n  function updateLineWidgets(cm, lineView, dims) {\n    if (lineView.alignable) { lineView.alignable = null; }\n    for (var node = lineView.node.firstChild, next = (void 0); node; node = next) {\n      next = node.nextSibling;\n      if (node.className == \"CodeMirror-linewidget\")\n        { lineView.node.removeChild(node); }\n    }\n    insertLineWidgets(cm, lineView, dims);\n  }\n\n  // Build a line's DOM representation from scratch\n  function buildLineElement(cm, lineView, lineN, dims) {\n    var built = getLineContent(cm, lineView);\n    lineView.text = lineView.node = built.pre;\n    if (built.bgClass) { lineView.bgClass = built.bgClass; }\n    if (built.textClass) { lineView.textClass = built.textClass; }\n\n    updateLineClasses(cm, lineView);\n    updateLineGutter(cm, lineView, lineN, dims);\n    insertLineWidgets(cm, lineView, dims);\n    return lineView.node\n  }\n\n  // A lineView may contain multiple logical lines (when merged by\n  // collapsed spans). The widgets for all of them need to be drawn.\n  function insertLineWidgets(cm, lineView, dims) {\n    insertLineWidgetsFor(cm, lineView.line, lineView, dims, true);\n    if (lineView.rest) { for (var i = 0; i < lineView.rest.length; i++)\n      { insertLineWidgetsFor(cm, lineView.rest[i], lineView, dims, false); } }\n  }\n\n  function insertLineWidgetsFor(cm, line, lineView, dims, allowAbove) {\n    if (!line.widgets) { return }\n    var wrap = ensureLineWrapped(lineView);\n    for (var i = 0, ws = line.widgets; i < ws.length; ++i) {\n      var widget = ws[i], node = elt(\"div\", [widget.node], \"CodeMirror-linewidget\");\n      if (!widget.handleMouseEvents) { node.setAttribute(\"cm-ignore-events\", \"true\"); }\n      positionLineWidget(widget, node, lineView, dims);\n      cm.display.input.setUneditable(node);\n      if (allowAbove && widget.above)\n        { wrap.insertBefore(node, lineView.gutter || lineView.text); }\n      else\n        { wrap.appendChild(node); }\n      signalLater(widget, \"redraw\");\n    }\n  }\n\n  function positionLineWidget(widget, node, lineView, dims) {\n    if (widget.noHScroll) {\n  (lineView.alignable || (lineView.alignable = [])).push(node);\n      var width = dims.wrapperWidth;\n      node.style.left = dims.fixedPos + \"px\";\n      if (!widget.coverGutter) {\n        width -= dims.gutterTotalWidth;\n        node.style.paddingLeft = dims.gutterTotalWidth + \"px\";\n      }\n      node.style.width = width + \"px\";\n    }\n    if (widget.coverGutter) {\n      node.style.zIndex = 5;\n      node.style.position = \"relative\";\n      if (!widget.noHScroll) { node.style.marginLeft = -dims.gutterTotalWidth + \"px\"; }\n    }\n  }\n\n  function widgetHeight(widget) {\n    if (widget.height != null) { return widget.height }\n    var cm = widget.doc.cm;\n    if (!cm) { return 0 }\n    if (!contains(document.body, widget.node)) {\n      var parentStyle = \"position: relative;\";\n      if (widget.coverGutter)\n        { parentStyle += \"margin-left: -\" + cm.display.gutters.offsetWidth + \"px;\"; }\n      if (widget.noHScroll)\n        { parentStyle += \"width: \" + cm.display.wrapper.clientWidth + \"px;\"; }\n      removeChildrenAndAdd(cm.display.measure, elt(\"div\", [widget.node], null, parentStyle));\n    }\n    return widget.height = widget.node.parentNode.offsetHeight\n  }\n\n  // Return true when the given mouse event happened in a widget\n  function eventInWidget(display, e) {\n    for (var n = e_target(e); n != display.wrapper; n = n.parentNode) {\n      if (!n || (n.nodeType == 1 && n.getAttribute(\"cm-ignore-events\") == \"true\") ||\n          (n.parentNode == display.sizer && n != display.mover))\n        { return true }\n    }\n  }\n\n  // POSITION MEASUREMENT\n\n  function paddingTop(display) {return display.lineSpace.offsetTop}\n  function paddingVert(display) {return display.mover.offsetHeight - display.lineSpace.offsetHeight}\n  function paddingH(display) {\n    if (display.cachedPaddingH) { return display.cachedPaddingH }\n    var e = removeChildrenAndAdd(display.measure, elt(\"pre\", \"x\"));\n    var style = window.getComputedStyle ? window.getComputedStyle(e) : e.currentStyle;\n    var data = {left: parseInt(style.paddingLeft), right: parseInt(style.paddingRight)};\n    if (!isNaN(data.left) && !isNaN(data.right)) { display.cachedPaddingH = data; }\n    return data\n  }\n\n  function scrollGap(cm) { return scrollerGap - cm.display.nativeBarWidth }\n  function displayWidth(cm) {\n    return cm.display.scroller.clientWidth - scrollGap(cm) - cm.display.barWidth\n  }\n  function displayHeight(cm) {\n    return cm.display.scroller.clientHeight - scrollGap(cm) - cm.display.barHeight\n  }\n\n  // Ensure the lineView.wrapping.heights array is populated. This is\n  // an array of bottom offsets for the lines that make up a drawn\n  // line. When lineWrapping is on, there might be more than one\n  // height.\n  function ensureLineHeights(cm, lineView, rect) {\n    var wrapping = cm.options.lineWrapping;\n    var curWidth = wrapping && displayWidth(cm);\n    if (!lineView.measure.heights || wrapping && lineView.measure.width != curWidth) {\n      var heights = lineView.measure.heights = [];\n      if (wrapping) {\n        lineView.measure.width = curWidth;\n        var rects = lineView.text.firstChild.getClientRects();\n        for (var i = 0; i < rects.length - 1; i++) {\n          var cur = rects[i], next = rects[i + 1];\n          if (Math.abs(cur.bottom - next.bottom) > 2)\n            { heights.push((cur.bottom + next.top) / 2 - rect.top); }\n        }\n      }\n      heights.push(rect.bottom - rect.top);\n    }\n  }\n\n  // Find a line map (mapping character offsets to text nodes) and a\n  // measurement cache for the given line number. (A line view might\n  // contain multiple lines when collapsed ranges are present.)\n  function mapFromLineView(lineView, line, lineN) {\n    if (lineView.line == line)\n      { return {map: lineView.measure.map, cache: lineView.measure.cache} }\n    for (var i = 0; i < lineView.rest.length; i++)\n      { if (lineView.rest[i] == line)\n        { return {map: lineView.measure.maps[i], cache: lineView.measure.caches[i]} } }\n    for (var i$1 = 0; i$1 < lineView.rest.length; i$1++)\n      { if (lineNo(lineView.rest[i$1]) > lineN)\n        { return {map: lineView.measure.maps[i$1], cache: lineView.measure.caches[i$1], before: true} } }\n  }\n\n  // Render a line into the hidden node display.externalMeasured. Used\n  // when measurement is needed for a line that's not in the viewport.\n  function updateExternalMeasurement(cm, line) {\n    line = visualLine(line);\n    var lineN = lineNo(line);\n    var view = cm.display.externalMeasured = new LineView(cm.doc, line, lineN);\n    view.lineN = lineN;\n    var built = view.built = buildLineContent(cm, view);\n    view.text = built.pre;\n    removeChildrenAndAdd(cm.display.lineMeasure, built.pre);\n    return view\n  }\n\n  // Get a {top, bottom, left, right} box (in line-local coordinates)\n  // for a given character.\n  function measureChar(cm, line, ch, bias) {\n    return measureCharPrepared(cm, prepareMeasureForLine(cm, line), ch, bias)\n  }\n\n  // Find a line view that corresponds to the given line number.\n  function findViewForLine(cm, lineN) {\n    if (lineN >= cm.display.viewFrom && lineN < cm.display.viewTo)\n      { return cm.display.view[findViewIndex(cm, lineN)] }\n    var ext = cm.display.externalMeasured;\n    if (ext && lineN >= ext.lineN && lineN < ext.lineN + ext.size)\n      { return ext }\n  }\n\n  // Measurement can be split in two steps, the set-up work that\n  // applies to the whole line, and the measurement of the actual\n  // character. Functions like coordsChar, that need to do a lot of\n  // measurements in a row, can thus ensure that the set-up work is\n  // only done once.\n  function prepareMeasureForLine(cm, line) {\n    var lineN = lineNo(line);\n    var view = findViewForLine(cm, lineN);\n    if (view && !view.text) {\n      view = null;\n    } else if (view && view.changes) {\n      updateLineForChanges(cm, view, lineN, getDimensions(cm));\n      cm.curOp.forceUpdate = true;\n    }\n    if (!view)\n      { view = updateExternalMeasurement(cm, line); }\n\n    var info = mapFromLineView(view, line, lineN);\n    return {\n      line: line, view: view, rect: null,\n      map: info.map, cache: info.cache, before: info.before,\n      hasHeights: false\n    }\n  }\n\n  // Given a prepared measurement object, measures the position of an\n  // actual character (or fetches it from the cache).\n  function measureCharPrepared(cm, prepared, ch, bias, varHeight) {\n    if (prepared.before) { ch = -1; }\n    var key = ch + (bias || \"\"), found;\n    if (prepared.cache.hasOwnProperty(key)) {\n      found = prepared.cache[key];\n    } else {\n      if (!prepared.rect)\n        { prepared.rect = prepared.view.text.getBoundingClientRect(); }\n      if (!prepared.hasHeights) {\n        ensureLineHeights(cm, prepared.view, prepared.rect);\n        prepared.hasHeights = true;\n      }\n      found = measureCharInner(cm, prepared, ch, bias);\n      if (!found.bogus) { prepared.cache[key] = found; }\n    }\n    return {left: found.left, right: found.right,\n            top: varHeight ? found.rtop : found.top,\n            bottom: varHeight ? found.rbottom : found.bottom}\n  }\n\n  var nullRect = {left: 0, right: 0, top: 0, bottom: 0};\n\n  function nodeAndOffsetInLineMap(map$$1, ch, bias) {\n    var node, start, end, collapse, mStart, mEnd;\n    // First, search the line map for the text node corresponding to,\n    // or closest to, the target character.\n    for (var i = 0; i < map$$1.length; i += 3) {\n      mStart = map$$1[i];\n      mEnd = map$$1[i + 1];\n      if (ch < mStart) {\n        start = 0; end = 1;\n        collapse = \"left\";\n      } else if (ch < mEnd) {\n        start = ch - mStart;\n        end = start + 1;\n      } else if (i == map$$1.length - 3 || ch == mEnd && map$$1[i + 3] > ch) {\n        end = mEnd - mStart;\n        start = end - 1;\n        if (ch >= mEnd) { collapse = \"right\"; }\n      }\n      if (start != null) {\n        node = map$$1[i + 2];\n        if (mStart == mEnd && bias == (node.insertLeft ? \"left\" : \"right\"))\n          { collapse = bias; }\n        if (bias == \"left\" && start == 0)\n          { while (i && map$$1[i - 2] == map$$1[i - 3] && map$$1[i - 1].insertLeft) {\n            node = map$$1[(i -= 3) + 2];\n            collapse = \"left\";\n          } }\n        if (bias == \"right\" && start == mEnd - mStart)\n          { while (i < map$$1.length - 3 && map$$1[i + 3] == map$$1[i + 4] && !map$$1[i + 5].insertLeft) {\n            node = map$$1[(i += 3) + 2];\n            collapse = \"right\";\n          } }\n        break\n      }\n    }\n    return {node: node, start: start, end: end, collapse: collapse, coverStart: mStart, coverEnd: mEnd}\n  }\n\n  function getUsefulRect(rects, bias) {\n    var rect = nullRect;\n    if (bias == \"left\") { for (var i = 0; i < rects.length; i++) {\n      if ((rect = rects[i]).left != rect.right) { break }\n    } } else { for (var i$1 = rects.length - 1; i$1 >= 0; i$1--) {\n      if ((rect = rects[i$1]).left != rect.right) { break }\n    } }\n    return rect\n  }\n\n  function measureCharInner(cm, prepared, ch, bias) {\n    var place = nodeAndOffsetInLineMap(prepared.map, ch, bias);\n    var node = place.node, start = place.start, end = place.end, collapse = place.collapse;\n\n    var rect;\n    if (node.nodeType == 3) { // If it is a text node, use a range to retrieve the coordinates.\n      for (var i$1 = 0; i$1 < 4; i$1++) { // Retry a maximum of 4 times when nonsense rectangles are returned\n        while (start && isExtendingChar(prepared.line.text.charAt(place.coverStart + start))) { --start; }\n        while (place.coverStart + end < place.coverEnd && isExtendingChar(prepared.line.text.charAt(place.coverStart + end))) { ++end; }\n        if (ie && ie_version < 9 && start == 0 && end == place.coverEnd - place.coverStart)\n          { rect = node.parentNode.getBoundingClientRect(); }\n        else\n          { rect = getUsefulRect(range(node, start, end).getClientRects(), bias); }\n        if (rect.left || rect.right || start == 0) { break }\n        end = start;\n        start = start - 1;\n        collapse = \"right\";\n      }\n      if (ie && ie_version < 11) { rect = maybeUpdateRectForZooming(cm.display.measure, rect); }\n    } else { // If it is a widget, simply get the box for the whole widget.\n      if (start > 0) { collapse = bias = \"right\"; }\n      var rects;\n      if (cm.options.lineWrapping && (rects = node.getClientRects()).length > 1)\n        { rect = rects[bias == \"right\" ? rects.length - 1 : 0]; }\n      else\n        { rect = node.getBoundingClientRect(); }\n    }\n    if (ie && ie_version < 9 && !start && (!rect || !rect.left && !rect.right)) {\n      var rSpan = node.parentNode.getClientRects()[0];\n      if (rSpan)\n        { rect = {left: rSpan.left, right: rSpan.left + charWidth(cm.display), top: rSpan.top, bottom: rSpan.bottom}; }\n      else\n        { rect = nullRect; }\n    }\n\n    var rtop = rect.top - prepared.rect.top, rbot = rect.bottom - prepared.rect.top;\n    var mid = (rtop + rbot) / 2;\n    var heights = prepared.view.measure.heights;\n    var i = 0;\n    for (; i < heights.length - 1; i++)\n      { if (mid < heights[i]) { break } }\n    var top = i ? heights[i - 1] : 0, bot = heights[i];\n    var result = {left: (collapse == \"right\" ? rect.right : rect.left) - prepared.rect.left,\n                  right: (collapse == \"left\" ? rect.left : rect.right) - prepared.rect.left,\n                  top: top, bottom: bot};\n    if (!rect.left && !rect.right) { result.bogus = true; }\n    if (!cm.options.singleCursorHeightPerLine) { result.rtop = rtop; result.rbottom = rbot; }\n\n    return result\n  }\n\n  // Work around problem with bounding client rects on ranges being\n  // returned incorrectly when zoomed on IE10 and below.\n  function maybeUpdateRectForZooming(measure, rect) {\n    if (!window.screen || screen.logicalXDPI == null ||\n        screen.logicalXDPI == screen.deviceXDPI || !hasBadZoomedRects(measure))\n      { return rect }\n    var scaleX = screen.logicalXDPI / screen.deviceXDPI;\n    var scaleY = screen.logicalYDPI / screen.deviceYDPI;\n    return {left: rect.left * scaleX, right: rect.right * scaleX,\n            top: rect.top * scaleY, bottom: rect.bottom * scaleY}\n  }\n\n  function clearLineMeasurementCacheFor(lineView) {\n    if (lineView.measure) {\n      lineView.measure.cache = {};\n      lineView.measure.heights = null;\n      if (lineView.rest) { for (var i = 0; i < lineView.rest.length; i++)\n        { lineView.measure.caches[i] = {}; } }\n    }\n  }\n\n  function clearLineMeasurementCache(cm) {\n    cm.display.externalMeasure = null;\n    removeChildren(cm.display.lineMeasure);\n    for (var i = 0; i < cm.display.view.length; i++)\n      { clearLineMeasurementCacheFor(cm.display.view[i]); }\n  }\n\n  function clearCaches(cm) {\n    clearLineMeasurementCache(cm);\n    cm.display.cachedCharWidth = cm.display.cachedTextHeight = cm.display.cachedPaddingH = null;\n    if (!cm.options.lineWrapping) { cm.display.maxLineChanged = true; }\n    cm.display.lineNumChars = null;\n  }\n\n  function pageScrollX() {\n    // Work around https://bugs.chromium.org/p/chromium/issues/detail?id=489206\n    // which causes page_Offset and bounding client rects to use\n    // different reference viewports and invalidate our calculations.\n    if (chrome && android) { return -(document.body.getBoundingClientRect().left - parseInt(getComputedStyle(document.body).marginLeft)) }\n    return window.pageXOffset || (document.documentElement || document.body).scrollLeft\n  }\n  function pageScrollY() {\n    if (chrome && android) { return -(document.body.getBoundingClientRect().top - parseInt(getComputedStyle(document.body).marginTop)) }\n    return window.pageYOffset || (document.documentElement || document.body).scrollTop\n  }\n\n  function widgetTopHeight(lineObj) {\n    var height = 0;\n    if (lineObj.widgets) { for (var i = 0; i < lineObj.widgets.length; ++i) { if (lineObj.widgets[i].above)\n      { height += widgetHeight(lineObj.widgets[i]); } } }\n    return height\n  }\n\n  // Converts a {top, bottom, left, right} box from line-local\n  // coordinates into another coordinate system. Context may be one of\n  // \"line\", \"div\" (display.lineDiv), \"local\"./null (editor), \"window\",\n  // or \"page\".\n  function intoCoordSystem(cm, lineObj, rect, context, includeWidgets) {\n    if (!includeWidgets) {\n      var height = widgetTopHeight(lineObj);\n      rect.top += height; rect.bottom += height;\n    }\n    if (context == \"line\") { return rect }\n    if (!context) { context = \"local\"; }\n    var yOff = heightAtLine(lineObj);\n    if (context == \"local\") { yOff += paddingTop(cm.display); }\n    else { yOff -= cm.display.viewOffset; }\n    if (context == \"page\" || context == \"window\") {\n      var lOff = cm.display.lineSpace.getBoundingClientRect();\n      yOff += lOff.top + (context == \"window\" ? 0 : pageScrollY());\n      var xOff = lOff.left + (context == \"window\" ? 0 : pageScrollX());\n      rect.left += xOff; rect.right += xOff;\n    }\n    rect.top += yOff; rect.bottom += yOff;\n    return rect\n  }\n\n  // Coverts a box from \"div\" coords to another coordinate system.\n  // Context may be \"window\", \"page\", \"div\", or \"local\"./null.\n  function fromCoordSystem(cm, coords, context) {\n    if (context == \"div\") { return coords }\n    var left = coords.left, top = coords.top;\n    // First move into \"page\" coordinate system\n    if (context == \"page\") {\n      left -= pageScrollX();\n      top -= pageScrollY();\n    } else if (context == \"local\" || !context) {\n      var localBox = cm.display.sizer.getBoundingClientRect();\n      left += localBox.left;\n      top += localBox.top;\n    }\n\n    var lineSpaceBox = cm.display.lineSpace.getBoundingClientRect();\n    return {left: left - lineSpaceBox.left, top: top - lineSpaceBox.top}\n  }\n\n  function charCoords(cm, pos, context, lineObj, bias) {\n    if (!lineObj) { lineObj = getLine(cm.doc, pos.line); }\n    return intoCoordSystem(cm, lineObj, measureChar(cm, lineObj, pos.ch, bias), context)\n  }\n\n  // Returns a box for a given cursor position, which may have an\n  // 'other' property containing the position of the secondary cursor\n  // on a bidi boundary.\n  // A cursor Pos(line, char, \"before\") is on the same visual line as `char - 1`\n  // and after `char - 1` in writing order of `char - 1`\n  // A cursor Pos(line, char, \"after\") is on the same visual line as `char`\n  // and before `char` in writing order of `char`\n  // Examples (upper-case letters are RTL, lower-case are LTR):\n  //     Pos(0, 1, ...)\n  //     before   after\n  // ab     a|b     a|b\n  // aB     a|B     aB|\n  // Ab     |Ab     A|b\n  // AB     B|A     B|A\n  // Every position after the last character on a line is considered to stick\n  // to the last character on the line.\n  function cursorCoords(cm, pos, context, lineObj, preparedMeasure, varHeight) {\n    lineObj = lineObj || getLine(cm.doc, pos.line);\n    if (!preparedMeasure) { preparedMeasure = prepareMeasureForLine(cm, lineObj); }\n    function get(ch, right) {\n      var m = measureCharPrepared(cm, preparedMeasure, ch, right ? \"right\" : \"left\", varHeight);\n      if (right) { m.left = m.right; } else { m.right = m.left; }\n      return intoCoordSystem(cm, lineObj, m, context)\n    }\n    var order = getOrder(lineObj, cm.doc.direction), ch = pos.ch, sticky = pos.sticky;\n    if (ch >= lineObj.text.length) {\n      ch = lineObj.text.length;\n      sticky = \"before\";\n    } else if (ch <= 0) {\n      ch = 0;\n      sticky = \"after\";\n    }\n    if (!order) { return get(sticky == \"before\" ? ch - 1 : ch, sticky == \"before\") }\n\n    function getBidi(ch, partPos, invert) {\n      var part = order[partPos], right = part.level == 1;\n      return get(invert ? ch - 1 : ch, right != invert)\n    }\n    var partPos = getBidiPartAt(order, ch, sticky);\n    var other = bidiOther;\n    var val = getBidi(ch, partPos, sticky == \"before\");\n    if (other != null) { val.other = getBidi(ch, other, sticky != \"before\"); }\n    return val\n  }\n\n  // Used to cheaply estimate the coordinates for a position. Used for\n  // intermediate scroll updates.\n  function estimateCoords(cm, pos) {\n    var left = 0;\n    pos = clipPos(cm.doc, pos);\n    if (!cm.options.lineWrapping) { left = charWidth(cm.display) * pos.ch; }\n    var lineObj = getLine(cm.doc, pos.line);\n    var top = heightAtLine(lineObj) + paddingTop(cm.display);\n    return {left: left, right: left, top: top, bottom: top + lineObj.height}\n  }\n\n  // Positions returned by coordsChar contain some extra information.\n  // xRel is the relative x position of the input coordinates compared\n  // to the found position (so xRel > 0 means the coordinates are to\n  // the right of the character position, for example). When outside\n  // is true, that means the coordinates lie outside the line's\n  // vertical range.\n  function PosWithInfo(line, ch, sticky, outside, xRel) {\n    var pos = Pos(line, ch, sticky);\n    pos.xRel = xRel;\n    if (outside) { pos.outside = true; }\n    return pos\n  }\n\n  // Compute the character position closest to the given coordinates.\n  // Input must be lineSpace-local (\"div\" coordinate system).\n  function coordsChar(cm, x, y) {\n    var doc = cm.doc;\n    y += cm.display.viewOffset;\n    if (y < 0) { return PosWithInfo(doc.first, 0, null, true, -1) }\n    var lineN = lineAtHeight(doc, y), last = doc.first + doc.size - 1;\n    if (lineN > last)\n      { return PosWithInfo(doc.first + doc.size - 1, getLine(doc, last).text.length, null, true, 1) }\n    if (x < 0) { x = 0; }\n\n    var lineObj = getLine(doc, lineN);\n    for (;;) {\n      var found = coordsCharInner(cm, lineObj, lineN, x, y);\n      var collapsed = collapsedSpanAround(lineObj, found.ch + (found.xRel > 0 ? 1 : 0));\n      if (!collapsed) { return found }\n      var rangeEnd = collapsed.find(1);\n      if (rangeEnd.line == lineN) { return rangeEnd }\n      lineObj = getLine(doc, lineN = rangeEnd.line);\n    }\n  }\n\n  function wrappedLineExtent(cm, lineObj, preparedMeasure, y) {\n    y -= widgetTopHeight(lineObj);\n    var end = lineObj.text.length;\n    var begin = findFirst(function (ch) { return measureCharPrepared(cm, preparedMeasure, ch - 1).bottom <= y; }, end, 0);\n    end = findFirst(function (ch) { return measureCharPrepared(cm, preparedMeasure, ch).top > y; }, begin, end);\n    return {begin: begin, end: end}\n  }\n\n  function wrappedLineExtentChar(cm, lineObj, preparedMeasure, target) {\n    if (!preparedMeasure) { preparedMeasure = prepareMeasureForLine(cm, lineObj); }\n    var targetTop = intoCoordSystem(cm, lineObj, measureCharPrepared(cm, preparedMeasure, target), \"line\").top;\n    return wrappedLineExtent(cm, lineObj, preparedMeasure, targetTop)\n  }\n\n  // Returns true if the given side of a box is after the given\n  // coordinates, in top-to-bottom, left-to-right order.\n  function boxIsAfter(box, x, y, left) {\n    return box.bottom <= y ? false : box.top > y ? true : (left ? box.left : box.right) > x\n  }\n\n  function coordsCharInner(cm, lineObj, lineNo$$1, x, y) {\n    // Move y into line-local coordinate space\n    y -= heightAtLine(lineObj);\n    var preparedMeasure = prepareMeasureForLine(cm, lineObj);\n    // When directly calling `measureCharPrepared`, we have to adjust\n    // for the widgets at this line.\n    var widgetHeight$$1 = widgetTopHeight(lineObj);\n    var begin = 0, end = lineObj.text.length, ltr = true;\n\n    var order = getOrder(lineObj, cm.doc.direction);\n    // If the line isn't plain left-to-right text, first figure out\n    // which bidi section the coordinates fall into.\n    if (order) {\n      var part = (cm.options.lineWrapping ? coordsBidiPartWrapped : coordsBidiPart)\n                   (cm, lineObj, lineNo$$1, preparedMeasure, order, x, y);\n      ltr = part.level != 1;\n      // The awkward -1 offsets are needed because findFirst (called\n      // on these below) will treat its first bound as inclusive,\n      // second as exclusive, but we want to actually address the\n      // characters in the part's range\n      begin = ltr ? part.from : part.to - 1;\n      end = ltr ? part.to : part.from - 1;\n    }\n\n    // A binary search to find the first character whose bounding box\n    // starts after the coordinates. If we run across any whose box wrap\n    // the coordinates, store that.\n    var chAround = null, boxAround = null;\n    var ch = findFirst(function (ch) {\n      var box = measureCharPrepared(cm, preparedMeasure, ch);\n      box.top += widgetHeight$$1; box.bottom += widgetHeight$$1;\n      if (!boxIsAfter(box, x, y, false)) { return false }\n      if (box.top <= y && box.left <= x) {\n        chAround = ch;\n        boxAround = box;\n      }\n      return true\n    }, begin, end);\n\n    var baseX, sticky, outside = false;\n    // If a box around the coordinates was found, use that\n    if (boxAround) {\n      // Distinguish coordinates nearer to the left or right side of the box\n      var atLeft = x - boxAround.left < boxAround.right - x, atStart = atLeft == ltr;\n      ch = chAround + (atStart ? 0 : 1);\n      sticky = atStart ? \"after\" : \"before\";\n      baseX = atLeft ? boxAround.left : boxAround.right;\n    } else {\n      // (Adjust for extended bound, if necessary.)\n      if (!ltr && (ch == end || ch == begin)) { ch++; }\n      // To determine which side to associate with, get the box to the\n      // left of the character and compare it's vertical position to the\n      // coordinates\n      sticky = ch == 0 ? \"after\" : ch == lineObj.text.length ? \"before\" :\n        (measureCharPrepared(cm, preparedMeasure, ch - (ltr ? 1 : 0)).bottom + widgetHeight$$1 <= y) == ltr ?\n        \"after\" : \"before\";\n      // Now get accurate coordinates for this place, in order to get a\n      // base X position\n      var coords = cursorCoords(cm, Pos(lineNo$$1, ch, sticky), \"line\", lineObj, preparedMeasure);\n      baseX = coords.left;\n      outside = y < coords.top || y >= coords.bottom;\n    }\n\n    ch = skipExtendingChars(lineObj.text, ch, 1);\n    return PosWithInfo(lineNo$$1, ch, sticky, outside, x - baseX)\n  }\n\n  function coordsBidiPart(cm, lineObj, lineNo$$1, preparedMeasure, order, x, y) {\n    // Bidi parts are sorted left-to-right, and in a non-line-wrapping\n    // situation, we can take this ordering to correspond to the visual\n    // ordering. This finds the first part whose end is after the given\n    // coordinates.\n    var index = findFirst(function (i) {\n      var part = order[i], ltr = part.level != 1;\n      return boxIsAfter(cursorCoords(cm, Pos(lineNo$$1, ltr ? part.to : part.from, ltr ? \"before\" : \"after\"),\n                                     \"line\", lineObj, preparedMeasure), x, y, true)\n    }, 0, order.length - 1);\n    var part = order[index];\n    // If this isn't the first part, the part's start is also after\n    // the coordinates, and the coordinates aren't on the same line as\n    // that start, move one part back.\n    if (index > 0) {\n      var ltr = part.level != 1;\n      var start = cursorCoords(cm, Pos(lineNo$$1, ltr ? part.from : part.to, ltr ? \"after\" : \"before\"),\n                               \"line\", lineObj, preparedMeasure);\n      if (boxIsAfter(start, x, y, true) && start.top > y)\n        { part = order[index - 1]; }\n    }\n    return part\n  }\n\n  function coordsBidiPartWrapped(cm, lineObj, _lineNo, preparedMeasure, order, x, y) {\n    // In a wrapped line, rtl text on wrapping boundaries can do things\n    // that don't correspond to the ordering in our `order` array at\n    // all, so a binary search doesn't work, and we want to return a\n    // part that only spans one line so that the binary search in\n    // coordsCharInner is safe. As such, we first find the extent of the\n    // wrapped line, and then do a flat search in which we discard any\n    // spans that aren't on the line.\n    var ref = wrappedLineExtent(cm, lineObj, preparedMeasure, y);\n    var begin = ref.begin;\n    var end = ref.end;\n    if (/\\s/.test(lineObj.text.charAt(end - 1))) { end--; }\n    var part = null, closestDist = null;\n    for (var i = 0; i < order.length; i++) {\n      var p = order[i];\n      if (p.from >= end || p.to <= begin) { continue }\n      var ltr = p.level != 1;\n      var endX = measureCharPrepared(cm, preparedMeasure, ltr ? Math.min(end, p.to) - 1 : Math.max(begin, p.from)).right;\n      // Weigh against spans ending before this, so that they are only\n      // picked if nothing ends after\n      var dist = endX < x ? x - endX + 1e9 : endX - x;\n      if (!part || closestDist > dist) {\n        part = p;\n        closestDist = dist;\n      }\n    }\n    if (!part) { part = order[order.length - 1]; }\n    // Clip the part to the wrapped line.\n    if (part.from < begin) { part = {from: begin, to: part.to, level: part.level}; }\n    if (part.to > end) { part = {from: part.from, to: end, level: part.level}; }\n    return part\n  }\n\n  var measureText;\n  // Compute the default text height.\n  function textHeight(display) {\n    if (display.cachedTextHeight != null) { return display.cachedTextHeight }\n    if (measureText == null) {\n      measureText = elt(\"pre\");\n      // Measure a bunch of lines, for browsers that compute\n      // fractional heights.\n      for (var i = 0; i < 49; ++i) {\n        measureText.appendChild(document.createTextNode(\"x\"));\n        measureText.appendChild(elt(\"br\"));\n      }\n      measureText.appendChild(document.createTextNode(\"x\"));\n    }\n    removeChildrenAndAdd(display.measure, measureText);\n    var height = measureText.offsetHeight / 50;\n    if (height > 3) { display.cachedTextHeight = height; }\n    removeChildren(display.measure);\n    return height || 1\n  }\n\n  // Compute the default character width.\n  function charWidth(display) {\n    if (display.cachedCharWidth != null) { return display.cachedCharWidth }\n    var anchor = elt(\"span\", \"xxxxxxxxxx\");\n    var pre = elt(\"pre\", [anchor]);\n    removeChildrenAndAdd(display.measure, pre);\n    var rect = anchor.getBoundingClientRect(), width = (rect.right - rect.left) / 10;\n    if (width > 2) { display.cachedCharWidth = width; }\n    return width || 10\n  }\n\n  // Do a bulk-read of the DOM positions and sizes needed to draw the\n  // view, so that we don't interleave reading and writing to the DOM.\n  function getDimensions(cm) {\n    var d = cm.display, left = {}, width = {};\n    var gutterLeft = d.gutters.clientLeft;\n    for (var n = d.gutters.firstChild, i = 0; n; n = n.nextSibling, ++i) {\n      var id = cm.display.gutterSpecs[i].className;\n      left[id] = n.offsetLeft + n.clientLeft + gutterLeft;\n      width[id] = n.clientWidth;\n    }\n    return {fixedPos: compensateForHScroll(d),\n            gutterTotalWidth: d.gutters.offsetWidth,\n            gutterLeft: left,\n            gutterWidth: width,\n            wrapperWidth: d.wrapper.clientWidth}\n  }\n\n  // Computes display.scroller.scrollLeft + display.gutters.offsetWidth,\n  // but using getBoundingClientRect to get a sub-pixel-accurate\n  // result.\n  function compensateForHScroll(display) {\n    return display.scroller.getBoundingClientRect().left - display.sizer.getBoundingClientRect().left\n  }\n\n  // Returns a function that estimates the height of a line, to use as\n  // first approximation until the line becomes visible (and is thus\n  // properly measurable).\n  function estimateHeight(cm) {\n    var th = textHeight(cm.display), wrapping = cm.options.lineWrapping;\n    var perLine = wrapping && Math.max(5, cm.display.scroller.clientWidth / charWidth(cm.display) - 3);\n    return function (line) {\n      if (lineIsHidden(cm.doc, line)) { return 0 }\n\n      var widgetsHeight = 0;\n      if (line.widgets) { for (var i = 0; i < line.widgets.length; i++) {\n        if (line.widgets[i].height) { widgetsHeight += line.widgets[i].height; }\n      } }\n\n      if (wrapping)\n        { return widgetsHeight + (Math.ceil(line.text.length / perLine) || 1) * th }\n      else\n        { return widgetsHeight + th }\n    }\n  }\n\n  function estimateLineHeights(cm) {\n    var doc = cm.doc, est = estimateHeight(cm);\n    doc.iter(function (line) {\n      var estHeight = est(line);\n      if (estHeight != line.height) { updateLineHeight(line, estHeight); }\n    });\n  }\n\n  // Given a mouse event, find the corresponding position. If liberal\n  // is false, it checks whether a gutter or scrollbar was clicked,\n  // and returns null if it was. forRect is used by rectangular\n  // selections, and tries to estimate a character position even for\n  // coordinates beyond the right of the text.\n  function posFromMouse(cm, e, liberal, forRect) {\n    var display = cm.display;\n    if (!liberal && e_target(e).getAttribute(\"cm-not-content\") == \"true\") { return null }\n\n    var x, y, space = display.lineSpace.getBoundingClientRect();\n    // Fails unpredictably on IE[67] when mouse is dragged around quickly.\n    try { x = e.clientX - space.left; y = e.clientY - space.top; }\n    catch (e) { return null }\n    var coords = coordsChar(cm, x, y), line;\n    if (forRect && coords.xRel == 1 && (line = getLine(cm.doc, coords.line).text).length == coords.ch) {\n      var colDiff = countColumn(line, line.length, cm.options.tabSize) - line.length;\n      coords = Pos(coords.line, Math.max(0, Math.round((x - paddingH(cm.display).left) / charWidth(cm.display)) - colDiff));\n    }\n    return coords\n  }\n\n  // Find the view element corresponding to a given line. Return null\n  // when the line isn't visible.\n  function findViewIndex(cm, n) {\n    if (n >= cm.display.viewTo) { return null }\n    n -= cm.display.viewFrom;\n    if (n < 0) { return null }\n    var view = cm.display.view;\n    for (var i = 0; i < view.length; i++) {\n      n -= view[i].size;\n      if (n < 0) { return i }\n    }\n  }\n\n  // Updates the display.view data structure for a given change to the\n  // document. From and to are in pre-change coordinates. Lendiff is\n  // the amount of lines added or subtracted by the change. This is\n  // used for changes that span multiple lines, or change the way\n  // lines are divided into visual lines. regLineChange (below)\n  // registers single-line changes.\n  function regChange(cm, from, to, lendiff) {\n    if (from == null) { from = cm.doc.first; }\n    if (to == null) { to = cm.doc.first + cm.doc.size; }\n    if (!lendiff) { lendiff = 0; }\n\n    var display = cm.display;\n    if (lendiff && to < display.viewTo &&\n        (display.updateLineNumbers == null || display.updateLineNumbers > from))\n      { display.updateLineNumbers = from; }\n\n    cm.curOp.viewChanged = true;\n\n    if (from >= display.viewTo) { // Change after\n      if (sawCollapsedSpans && visualLineNo(cm.doc, from) < display.viewTo)\n        { resetView(cm); }\n    } else if (to <= display.viewFrom) { // Change before\n      if (sawCollapsedSpans && visualLineEndNo(cm.doc, to + lendiff) > display.viewFrom) {\n        resetView(cm);\n      } else {\n        display.viewFrom += lendiff;\n        display.viewTo += lendiff;\n      }\n    } else if (from <= display.viewFrom && to >= display.viewTo) { // Full overlap\n      resetView(cm);\n    } else if (from <= display.viewFrom) { // Top overlap\n      var cut = viewCuttingPoint(cm, to, to + lendiff, 1);\n      if (cut) {\n        display.view = display.view.slice(cut.index);\n        display.viewFrom = cut.lineN;\n        display.viewTo += lendiff;\n      } else {\n        resetView(cm);\n      }\n    } else if (to >= display.viewTo) { // Bottom overlap\n      var cut$1 = viewCuttingPoint(cm, from, from, -1);\n      if (cut$1) {\n        display.view = display.view.slice(0, cut$1.index);\n        display.viewTo = cut$1.lineN;\n      } else {\n        resetView(cm);\n      }\n    } else { // Gap in the middle\n      var cutTop = viewCuttingPoint(cm, from, from, -1);\n      var cutBot = viewCuttingPoint(cm, to, to + lendiff, 1);\n      if (cutTop && cutBot) {\n        display.view = display.view.slice(0, cutTop.index)\n          .concat(buildViewArray(cm, cutTop.lineN, cutBot.lineN))\n          .concat(display.view.slice(cutBot.index));\n        display.viewTo += lendiff;\n      } else {\n        resetView(cm);\n      }\n    }\n\n    var ext = display.externalMeasured;\n    if (ext) {\n      if (to < ext.lineN)\n        { ext.lineN += lendiff; }\n      else if (from < ext.lineN + ext.size)\n        { display.externalMeasured = null; }\n    }\n  }\n\n  // Register a change to a single line. Type must be one of \"text\",\n  // \"gutter\", \"class\", \"widget\"\n  function regLineChange(cm, line, type) {\n    cm.curOp.viewChanged = true;\n    var display = cm.display, ext = cm.display.externalMeasured;\n    if (ext && line >= ext.lineN && line < ext.lineN + ext.size)\n      { display.externalMeasured = null; }\n\n    if (line < display.viewFrom || line >= display.viewTo) { return }\n    var lineView = display.view[findViewIndex(cm, line)];\n    if (lineView.node == null) { return }\n    var arr = lineView.changes || (lineView.changes = []);\n    if (indexOf(arr, type) == -1) { arr.push(type); }\n  }\n\n  // Clear the view.\n  function resetView(cm) {\n    cm.display.viewFrom = cm.display.viewTo = cm.doc.first;\n    cm.display.view = [];\n    cm.display.viewOffset = 0;\n  }\n\n  function viewCuttingPoint(cm, oldN, newN, dir) {\n    var index = findViewIndex(cm, oldN), diff, view = cm.display.view;\n    if (!sawCollapsedSpans || newN == cm.doc.first + cm.doc.size)\n      { return {index: index, lineN: newN} }\n    var n = cm.display.viewFrom;\n    for (var i = 0; i < index; i++)\n      { n += view[i].size; }\n    if (n != oldN) {\n      if (dir > 0) {\n        if (index == view.length - 1) { return null }\n        diff = (n + view[index].size) - oldN;\n        index++;\n      } else {\n        diff = n - oldN;\n      }\n      oldN += diff; newN += diff;\n    }\n    while (visualLineNo(cm.doc, newN) != newN) {\n      if (index == (dir < 0 ? 0 : view.length - 1)) { return null }\n      newN += dir * view[index - (dir < 0 ? 1 : 0)].size;\n      index += dir;\n    }\n    return {index: index, lineN: newN}\n  }\n\n  // Force the view to cover a given range, adding empty view element\n  // or clipping off existing ones as needed.\n  function adjustView(cm, from, to) {\n    var display = cm.display, view = display.view;\n    if (view.length == 0 || from >= display.viewTo || to <= display.viewFrom) {\n      display.view = buildViewArray(cm, from, to);\n      display.viewFrom = from;\n    } else {\n      if (display.viewFrom > from)\n        { display.view = buildViewArray(cm, from, display.viewFrom).concat(display.view); }\n      else if (display.viewFrom < from)\n        { display.view = display.view.slice(findViewIndex(cm, from)); }\n      display.viewFrom = from;\n      if (display.viewTo < to)\n        { display.view = display.view.concat(buildViewArray(cm, display.viewTo, to)); }\n      else if (display.viewTo > to)\n        { display.view = display.view.slice(0, findViewIndex(cm, to)); }\n    }\n    display.viewTo = to;\n  }\n\n  // Count the number of lines in the view whose DOM representation is\n  // out of date (or nonexistent).\n  function countDirtyView(cm) {\n    var view = cm.display.view, dirty = 0;\n    for (var i = 0; i < view.length; i++) {\n      var lineView = view[i];\n      if (!lineView.hidden && (!lineView.node || lineView.changes)) { ++dirty; }\n    }\n    return dirty\n  }\n\n  function updateSelection(cm) {\n    cm.display.input.showSelection(cm.display.input.prepareSelection());\n  }\n\n  function prepareSelection(cm, primary) {\n    if ( primary === void 0 ) primary = true;\n\n    var doc = cm.doc, result = {};\n    var curFragment = result.cursors = document.createDocumentFragment();\n    var selFragment = result.selection = document.createDocumentFragment();\n\n    for (var i = 0; i < doc.sel.ranges.length; i++) {\n      if (!primary && i == doc.sel.primIndex) { continue }\n      var range$$1 = doc.sel.ranges[i];\n      if (range$$1.from().line >= cm.display.viewTo || range$$1.to().line < cm.display.viewFrom) { continue }\n      var collapsed = range$$1.empty();\n      if (collapsed || cm.options.showCursorWhenSelecting)\n        { drawSelectionCursor(cm, range$$1.head, curFragment); }\n      if (!collapsed)\n        { drawSelectionRange(cm, range$$1, selFragment); }\n    }\n    return result\n  }\n\n  // Draws a cursor for the given range\n  function drawSelectionCursor(cm, head, output) {\n    var pos = cursorCoords(cm, head, \"div\", null, null, !cm.options.singleCursorHeightPerLine);\n\n    var cursor = output.appendChild(elt(\"div\", \"\\u00a0\", \"CodeMirror-cursor\"));\n    cursor.style.left = pos.left + \"px\";\n    cursor.style.top = pos.top + \"px\";\n    cursor.style.height = Math.max(0, pos.bottom - pos.top) * cm.options.cursorHeight + \"px\";\n\n    if (pos.other) {\n      // Secondary cursor, shown when on a 'jump' in bi-directional text\n      var otherCursor = output.appendChild(elt(\"div\", \"\\u00a0\", \"CodeMirror-cursor CodeMirror-secondarycursor\"));\n      otherCursor.style.display = \"\";\n      otherCursor.style.left = pos.other.left + \"px\";\n      otherCursor.style.top = pos.other.top + \"px\";\n      otherCursor.style.height = (pos.other.bottom - pos.other.top) * .85 + \"px\";\n    }\n  }\n\n  function cmpCoords(a, b) { return a.top - b.top || a.left - b.left }\n\n  // Draws the given range as a highlighted selection\n  function drawSelectionRange(cm, range$$1, output) {\n    var display = cm.display, doc = cm.doc;\n    var fragment = document.createDocumentFragment();\n    var padding = paddingH(cm.display), leftSide = padding.left;\n    var rightSide = Math.max(display.sizerWidth, displayWidth(cm) - display.sizer.offsetLeft) - padding.right;\n    var docLTR = doc.direction == \"ltr\";\n\n    function add(left, top, width, bottom) {\n      if (top < 0) { top = 0; }\n      top = Math.round(top);\n      bottom = Math.round(bottom);\n      fragment.appendChild(elt(\"div\", null, \"CodeMirror-selected\", (\"position: absolute; left: \" + left + \"px;\\n                             top: \" + top + \"px; width: \" + (width == null ? rightSide - left : width) + \"px;\\n                             height: \" + (bottom - top) + \"px\")));\n    }\n\n    function drawForLine(line, fromArg, toArg) {\n      var lineObj = getLine(doc, line);\n      var lineLen = lineObj.text.length;\n      var start, end;\n      function coords(ch, bias) {\n        return charCoords(cm, Pos(line, ch), \"div\", lineObj, bias)\n      }\n\n      function wrapX(pos, dir, side) {\n        var extent = wrappedLineExtentChar(cm, lineObj, null, pos);\n        var prop = (dir == \"ltr\") == (side == \"after\") ? \"left\" : \"right\";\n        var ch = side == \"after\" ? extent.begin : extent.end - (/\\s/.test(lineObj.text.charAt(extent.end - 1)) ? 2 : 1);\n        return coords(ch, prop)[prop]\n      }\n\n      var order = getOrder(lineObj, doc.direction);\n      iterateBidiSections(order, fromArg || 0, toArg == null ? lineLen : toArg, function (from, to, dir, i) {\n        var ltr = dir == \"ltr\";\n        var fromPos = coords(from, ltr ? \"left\" : \"right\");\n        var toPos = coords(to - 1, ltr ? \"right\" : \"left\");\n\n        var openStart = fromArg == null && from == 0, openEnd = toArg == null && to == lineLen;\n        var first = i == 0, last = !order || i == order.length - 1;\n        if (toPos.top - fromPos.top <= 3) { // Single line\n          var openLeft = (docLTR ? openStart : openEnd) && first;\n          var openRight = (docLTR ? openEnd : openStart) && last;\n          var left = openLeft ? leftSide : (ltr ? fromPos : toPos).left;\n          var right = openRight ? rightSide : (ltr ? toPos : fromPos).right;\n          add(left, fromPos.top, right - left, fromPos.bottom);\n        } else { // Multiple lines\n          var topLeft, topRight, botLeft, botRight;\n          if (ltr) {\n            topLeft = docLTR && openStart && first ? leftSide : fromPos.left;\n            topRight = docLTR ? rightSide : wrapX(from, dir, \"before\");\n            botLeft = docLTR ? leftSide : wrapX(to, dir, \"after\");\n            botRight = docLTR && openEnd && last ? rightSide : toPos.right;\n          } else {\n            topLeft = !docLTR ? leftSide : wrapX(from, dir, \"before\");\n            topRight = !docLTR && openStart && first ? rightSide : fromPos.right;\n            botLeft = !docLTR && openEnd && last ? leftSide : toPos.left;\n            botRight = !docLTR ? rightSide : wrapX(to, dir, \"after\");\n          }\n          add(topLeft, fromPos.top, topRight - topLeft, fromPos.bottom);\n          if (fromPos.bottom < toPos.top) { add(leftSide, fromPos.bottom, null, toPos.top); }\n          add(botLeft, toPos.top, botRight - botLeft, toPos.bottom);\n        }\n\n        if (!start || cmpCoords(fromPos, start) < 0) { start = fromPos; }\n        if (cmpCoords(toPos, start) < 0) { start = toPos; }\n        if (!end || cmpCoords(fromPos, end) < 0) { end = fromPos; }\n        if (cmpCoords(toPos, end) < 0) { end = toPos; }\n      });\n      return {start: start, end: end}\n    }\n\n    var sFrom = range$$1.from(), sTo = range$$1.to();\n    if (sFrom.line == sTo.line) {\n      drawForLine(sFrom.line, sFrom.ch, sTo.ch);\n    } else {\n      var fromLine = getLine(doc, sFrom.line), toLine = getLine(doc, sTo.line);\n      var singleVLine = visualLine(fromLine) == visualLine(toLine);\n      var leftEnd = drawForLine(sFrom.line, sFrom.ch, singleVLine ? fromLine.text.length + 1 : null).end;\n      var rightStart = drawForLine(sTo.line, singleVLine ? 0 : null, sTo.ch).start;\n      if (singleVLine) {\n        if (leftEnd.top < rightStart.top - 2) {\n          add(leftEnd.right, leftEnd.top, null, leftEnd.bottom);\n          add(leftSide, rightStart.top, rightStart.left, rightStart.bottom);\n        } else {\n          add(leftEnd.right, leftEnd.top, rightStart.left - leftEnd.right, leftEnd.bottom);\n        }\n      }\n      if (leftEnd.bottom < rightStart.top)\n        { add(leftSide, leftEnd.bottom, null, rightStart.top); }\n    }\n\n    output.appendChild(fragment);\n  }\n\n  // Cursor-blinking\n  function restartBlink(cm) {\n    if (!cm.state.focused) { return }\n    var display = cm.display;\n    clearInterval(display.blinker);\n    var on = true;\n    display.cursorDiv.style.visibility = \"\";\n    if (cm.options.cursorBlinkRate > 0)\n      { display.blinker = setInterval(function () { return display.cursorDiv.style.visibility = (on = !on) ? \"\" : \"hidden\"; },\n        cm.options.cursorBlinkRate); }\n    else if (cm.options.cursorBlinkRate < 0)\n      { display.cursorDiv.style.visibility = \"hidden\"; }\n  }\n\n  function ensureFocus(cm) {\n    if (!cm.state.focused) { cm.display.input.focus(); onFocus(cm); }\n  }\n\n  function delayBlurEvent(cm) {\n    cm.state.delayingBlurEvent = true;\n    setTimeout(function () { if (cm.state.delayingBlurEvent) {\n      cm.state.delayingBlurEvent = false;\n      onBlur(cm);\n    } }, 100);\n  }\n\n  function onFocus(cm, e) {\n    if (cm.state.delayingBlurEvent) { cm.state.delayingBlurEvent = false; }\n\n    if (cm.options.readOnly == \"nocursor\") { return }\n    if (!cm.state.focused) {\n      signal(cm, \"focus\", cm, e);\n      cm.state.focused = true;\n      addClass(cm.display.wrapper, \"CodeMirror-focused\");\n      // This test prevents this from firing when a context\n      // menu is closed (since the input reset would kill the\n      // select-all detection hack)\n      if (!cm.curOp && cm.display.selForContextMenu != cm.doc.sel) {\n        cm.display.input.reset();\n        if (webkit) { setTimeout(function () { return cm.display.input.reset(true); }, 20); } // Issue #1730\n      }\n      cm.display.input.receivedFocus();\n    }\n    restartBlink(cm);\n  }\n  function onBlur(cm, e) {\n    if (cm.state.delayingBlurEvent) { return }\n\n    if (cm.state.focused) {\n      signal(cm, \"blur\", cm, e);\n      cm.state.focused = false;\n      rmClass(cm.display.wrapper, \"CodeMirror-focused\");\n    }\n    clearInterval(cm.display.blinker);\n    setTimeout(function () { if (!cm.state.focused) { cm.display.shift = false; } }, 150);\n  }\n\n  // Read the actual heights of the rendered lines, and update their\n  // stored heights to match.\n  function updateHeightsInViewport(cm) {\n    var display = cm.display;\n    var prevBottom = display.lineDiv.offsetTop;\n    for (var i = 0; i < display.view.length; i++) {\n      var cur = display.view[i], wrapping = cm.options.lineWrapping;\n      var height = (void 0), width = 0;\n      if (cur.hidden) { continue }\n      if (ie && ie_version < 8) {\n        var bot = cur.node.offsetTop + cur.node.offsetHeight;\n        height = bot - prevBottom;\n        prevBottom = bot;\n      } else {\n        var box = cur.node.getBoundingClientRect();\n        height = box.bottom - box.top;\n        // Check that lines don't extend past the right of the current\n        // editor width\n        if (!wrapping && cur.text.firstChild)\n          { width = cur.text.firstChild.getBoundingClientRect().right - box.left - 1; }\n      }\n      var diff = cur.line.height - height;\n      if (diff > .005 || diff < -.005) {\n        updateLineHeight(cur.line, height);\n        updateWidgetHeight(cur.line);\n        if (cur.rest) { for (var j = 0; j < cur.rest.length; j++)\n          { updateWidgetHeight(cur.rest[j]); } }\n      }\n      if (width > cm.display.sizerWidth) {\n        var chWidth = Math.ceil(width / charWidth(cm.display));\n        if (chWidth > cm.display.maxLineLength) {\n          cm.display.maxLineLength = chWidth;\n          cm.display.maxLine = cur.line;\n          cm.display.maxLineChanged = true;\n        }\n      }\n    }\n  }\n\n  // Read and store the height of line widgets associated with the\n  // given line.\n  function updateWidgetHeight(line) {\n    if (line.widgets) { for (var i = 0; i < line.widgets.length; ++i) {\n      var w = line.widgets[i], parent = w.node.parentNode;\n      if (parent) { w.height = parent.offsetHeight; }\n    } }\n  }\n\n  // Compute the lines that are visible in a given viewport (defaults\n  // the the current scroll position). viewport may contain top,\n  // height, and ensure (see op.scrollToPos) properties.\n  function visibleLines(display, doc, viewport) {\n    var top = viewport && viewport.top != null ? Math.max(0, viewport.top) : display.scroller.scrollTop;\n    top = Math.floor(top - paddingTop(display));\n    var bottom = viewport && viewport.bottom != null ? viewport.bottom : top + display.wrapper.clientHeight;\n\n    var from = lineAtHeight(doc, top), to = lineAtHeight(doc, bottom);\n    // Ensure is a {from: {line, ch}, to: {line, ch}} object, and\n    // forces those lines into the viewport (if possible).\n    if (viewport && viewport.ensure) {\n      var ensureFrom = viewport.ensure.from.line, ensureTo = viewport.ensure.to.line;\n      if (ensureFrom < from) {\n        from = ensureFrom;\n        to = lineAtHeight(doc, heightAtLine(getLine(doc, ensureFrom)) + display.wrapper.clientHeight);\n      } else if (Math.min(ensureTo, doc.lastLine()) >= to) {\n        from = lineAtHeight(doc, heightAtLine(getLine(doc, ensureTo)) - display.wrapper.clientHeight);\n        to = ensureTo;\n      }\n    }\n    return {from: from, to: Math.max(to, from + 1)}\n  }\n\n  // SCROLLING THINGS INTO VIEW\n\n  // If an editor sits on the top or bottom of the window, partially\n  // scrolled out of view, this ensures that the cursor is visible.\n  function maybeScrollWindow(cm, rect) {\n    if (signalDOMEvent(cm, \"scrollCursorIntoView\")) { return }\n\n    var display = cm.display, box = display.sizer.getBoundingClientRect(), doScroll = null;\n    if (rect.top + box.top < 0) { doScroll = true; }\n    else if (rect.bottom + box.top > (window.innerHeight || document.documentElement.clientHeight)) { doScroll = false; }\n    if (doScroll != null && !phantom) {\n      var scrollNode = elt(\"div\", \"\\u200b\", null, (\"position: absolute;\\n                         top: \" + (rect.top - display.viewOffset - paddingTop(cm.display)) + \"px;\\n                         height: \" + (rect.bottom - rect.top + scrollGap(cm) + display.barHeight) + \"px;\\n                         left: \" + (rect.left) + \"px; width: \" + (Math.max(2, rect.right - rect.left)) + \"px;\"));\n      cm.display.lineSpace.appendChild(scrollNode);\n      scrollNode.scrollIntoView(doScroll);\n      cm.display.lineSpace.removeChild(scrollNode);\n    }\n  }\n\n  // Scroll a given position into view (immediately), verifying that\n  // it actually became visible (as line heights are accurately\n  // measured, the position of something may 'drift' during drawing).\n  function scrollPosIntoView(cm, pos, end, margin) {\n    if (margin == null) { margin = 0; }\n    var rect;\n    if (!cm.options.lineWrapping && pos == end) {\n      // Set pos and end to the cursor positions around the character pos sticks to\n      // If pos.sticky == \"before\", that is around pos.ch - 1, otherwise around pos.ch\n      // If pos == Pos(_, 0, \"before\"), pos and end are unchanged\n      pos = pos.ch ? Pos(pos.line, pos.sticky == \"before\" ? pos.ch - 1 : pos.ch, \"after\") : pos;\n      end = pos.sticky == \"before\" ? Pos(pos.line, pos.ch + 1, \"before\") : pos;\n    }\n    for (var limit = 0; limit < 5; limit++) {\n      var changed = false;\n      var coords = cursorCoords(cm, pos);\n      var endCoords = !end || end == pos ? coords : cursorCoords(cm, end);\n      rect = {left: Math.min(coords.left, endCoords.left),\n              top: Math.min(coords.top, endCoords.top) - margin,\n              right: Math.max(coords.left, endCoords.left),\n              bottom: Math.max(coords.bottom, endCoords.bottom) + margin};\n      var scrollPos = calculateScrollPos(cm, rect);\n      var startTop = cm.doc.scrollTop, startLeft = cm.doc.scrollLeft;\n      if (scrollPos.scrollTop != null) {\n        updateScrollTop(cm, scrollPos.scrollTop);\n        if (Math.abs(cm.doc.scrollTop - startTop) > 1) { changed = true; }\n      }\n      if (scrollPos.scrollLeft != null) {\n        setScrollLeft(cm, scrollPos.scrollLeft);\n        if (Math.abs(cm.doc.scrollLeft - startLeft) > 1) { changed = true; }\n      }\n      if (!changed) { break }\n    }\n    return rect\n  }\n\n  // Scroll a given set of coordinates into view (immediately).\n  function scrollIntoView(cm, rect) {\n    var scrollPos = calculateScrollPos(cm, rect);\n    if (scrollPos.scrollTop != null) { updateScrollTop(cm, scrollPos.scrollTop); }\n    if (scrollPos.scrollLeft != null) { setScrollLeft(cm, scrollPos.scrollLeft); }\n  }\n\n  // Calculate a new scroll position needed to scroll the given\n  // rectangle into view. Returns an object with scrollTop and\n  // scrollLeft properties. When these are undefined, the\n  // vertical/horizontal position does not need to be adjusted.\n  function calculateScrollPos(cm, rect) {\n    var display = cm.display, snapMargin = textHeight(cm.display);\n    if (rect.top < 0) { rect.top = 0; }\n    var screentop = cm.curOp && cm.curOp.scrollTop != null ? cm.curOp.scrollTop : display.scroller.scrollTop;\n    var screen = displayHeight(cm), result = {};\n    if (rect.bottom - rect.top > screen) { rect.bottom = rect.top + screen; }\n    var docBottom = cm.doc.height + paddingVert(display);\n    var atTop = rect.top < snapMargin, atBottom = rect.bottom > docBottom - snapMargin;\n    if (rect.top < screentop) {\n      result.scrollTop = atTop ? 0 : rect.top;\n    } else if (rect.bottom > screentop + screen) {\n      var newTop = Math.min(rect.top, (atBottom ? docBottom : rect.bottom) - screen);\n      if (newTop != screentop) { result.scrollTop = newTop; }\n    }\n\n    var screenleft = cm.curOp && cm.curOp.scrollLeft != null ? cm.curOp.scrollLeft : display.scroller.scrollLeft;\n    var screenw = displayWidth(cm) - (cm.options.fixedGutter ? display.gutters.offsetWidth : 0);\n    var tooWide = rect.right - rect.left > screenw;\n    if (tooWide) { rect.right = rect.left + screenw; }\n    if (rect.left < 10)\n      { result.scrollLeft = 0; }\n    else if (rect.left < screenleft)\n      { result.scrollLeft = Math.max(0, rect.left - (tooWide ? 0 : 10)); }\n    else if (rect.right > screenw + screenleft - 3)\n      { result.scrollLeft = rect.right + (tooWide ? 0 : 10) - screenw; }\n    return result\n  }\n\n  // Store a relative adjustment to the scroll position in the current\n  // operation (to be applied when the operation finishes).\n  function addToScrollTop(cm, top) {\n    if (top == null) { return }\n    resolveScrollToPos(cm);\n    cm.curOp.scrollTop = (cm.curOp.scrollTop == null ? cm.doc.scrollTop : cm.curOp.scrollTop) + top;\n  }\n\n  // Make sure that at the end of the operation the current cursor is\n  // shown.\n  function ensureCursorVisible(cm) {\n    resolveScrollToPos(cm);\n    var cur = cm.getCursor();\n    cm.curOp.scrollToPos = {from: cur, to: cur, margin: cm.options.cursorScrollMargin};\n  }\n\n  function scrollToCoords(cm, x, y) {\n    if (x != null || y != null) { resolveScrollToPos(cm); }\n    if (x != null) { cm.curOp.scrollLeft = x; }\n    if (y != null) { cm.curOp.scrollTop = y; }\n  }\n\n  function scrollToRange(cm, range$$1) {\n    resolveScrollToPos(cm);\n    cm.curOp.scrollToPos = range$$1;\n  }\n\n  // When an operation has its scrollToPos property set, and another\n  // scroll action is applied before the end of the operation, this\n  // 'simulates' scrolling that position into view in a cheap way, so\n  // that the effect of intermediate scroll commands is not ignored.\n  function resolveScrollToPos(cm) {\n    var range$$1 = cm.curOp.scrollToPos;\n    if (range$$1) {\n      cm.curOp.scrollToPos = null;\n      var from = estimateCoords(cm, range$$1.from), to = estimateCoords(cm, range$$1.to);\n      scrollToCoordsRange(cm, from, to, range$$1.margin);\n    }\n  }\n\n  function scrollToCoordsRange(cm, from, to, margin) {\n    var sPos = calculateScrollPos(cm, {\n      left: Math.min(from.left, to.left),\n      top: Math.min(from.top, to.top) - margin,\n      right: Math.max(from.right, to.right),\n      bottom: Math.max(from.bottom, to.bottom) + margin\n    });\n    scrollToCoords(cm, sPos.scrollLeft, sPos.scrollTop);\n  }\n\n  // Sync the scrollable area and scrollbars, ensure the viewport\n  // covers the visible area.\n  function updateScrollTop(cm, val) {\n    if (Math.abs(cm.doc.scrollTop - val) < 2) { return }\n    if (!gecko) { updateDisplaySimple(cm, {top: val}); }\n    setScrollTop(cm, val, true);\n    if (gecko) { updateDisplaySimple(cm); }\n    startWorker(cm, 100);\n  }\n\n  function setScrollTop(cm, val, forceScroll) {\n    val = Math.min(cm.display.scroller.scrollHeight - cm.display.scroller.clientHeight, val);\n    if (cm.display.scroller.scrollTop == val && !forceScroll) { return }\n    cm.doc.scrollTop = val;\n    cm.display.scrollbars.setScrollTop(val);\n    if (cm.display.scroller.scrollTop != val) { cm.display.scroller.scrollTop = val; }\n  }\n\n  // Sync scroller and scrollbar, ensure the gutter elements are\n  // aligned.\n  function setScrollLeft(cm, val, isScroller, forceScroll) {\n    val = Math.min(val, cm.display.scroller.scrollWidth - cm.display.scroller.clientWidth);\n    if ((isScroller ? val == cm.doc.scrollLeft : Math.abs(cm.doc.scrollLeft - val) < 2) && !forceScroll) { return }\n    cm.doc.scrollLeft = val;\n    alignHorizontally(cm);\n    if (cm.display.scroller.scrollLeft != val) { cm.display.scroller.scrollLeft = val; }\n    cm.display.scrollbars.setScrollLeft(val);\n  }\n\n  // SCROLLBARS\n\n  // Prepare DOM reads needed to update the scrollbars. Done in one\n  // shot to minimize update/measure roundtrips.\n  function measureForScrollbars(cm) {\n    var d = cm.display, gutterW = d.gutters.offsetWidth;\n    var docH = Math.round(cm.doc.height + paddingVert(cm.display));\n    return {\n      clientHeight: d.scroller.clientHeight,\n      viewHeight: d.wrapper.clientHeight,\n      scrollWidth: d.scroller.scrollWidth, clientWidth: d.scroller.clientWidth,\n      viewWidth: d.wrapper.clientWidth,\n      barLeft: cm.options.fixedGutter ? gutterW : 0,\n      docHeight: docH,\n      scrollHeight: docH + scrollGap(cm) + d.barHeight,\n      nativeBarWidth: d.nativeBarWidth,\n      gutterWidth: gutterW\n    }\n  }\n\n  var NativeScrollbars = function(place, scroll, cm) {\n    this.cm = cm;\n    var vert = this.vert = elt(\"div\", [elt(\"div\", null, null, \"min-width: 1px\")], \"CodeMirror-vscrollbar\");\n    var horiz = this.horiz = elt(\"div\", [elt(\"div\", null, null, \"height: 100%; min-height: 1px\")], \"CodeMirror-hscrollbar\");\n    vert.tabIndex = horiz.tabIndex = -1;\n    place(vert); place(horiz);\n\n    on(vert, \"scroll\", function () {\n      if (vert.clientHeight) { scroll(vert.scrollTop, \"vertical\"); }\n    });\n    on(horiz, \"scroll\", function () {\n      if (horiz.clientWidth) { scroll(horiz.scrollLeft, \"horizontal\"); }\n    });\n\n    this.checkedZeroWidth = false;\n    // Need to set a minimum width to see the scrollbar on IE7 (but must not set it on IE8).\n    if (ie && ie_version < 8) { this.horiz.style.minHeight = this.vert.style.minWidth = \"18px\"; }\n  };\n\n  NativeScrollbars.prototype.update = function (measure) {\n    var needsH = measure.scrollWidth > measure.clientWidth + 1;\n    var needsV = measure.scrollHeight > measure.clientHeight + 1;\n    var sWidth = measure.nativeBarWidth;\n\n    if (needsV) {\n      this.vert.style.display = \"block\";\n      this.vert.style.bottom = needsH ? sWidth + \"px\" : \"0\";\n      var totalHeight = measure.viewHeight - (needsH ? sWidth : 0);\n      // A bug in IE8 can cause this value to be negative, so guard it.\n      this.vert.firstChild.style.height =\n        Math.max(0, measure.scrollHeight - measure.clientHeight + totalHeight) + \"px\";\n    } else {\n      this.vert.style.display = \"\";\n      this.vert.firstChild.style.height = \"0\";\n    }\n\n    if (needsH) {\n      this.horiz.style.display = \"block\";\n      this.horiz.style.right = needsV ? sWidth + \"px\" : \"0\";\n      this.horiz.style.left = measure.barLeft + \"px\";\n      var totalWidth = measure.viewWidth - measure.barLeft - (needsV ? sWidth : 0);\n      this.horiz.firstChild.style.width =\n        Math.max(0, measure.scrollWidth - measure.clientWidth + totalWidth) + \"px\";\n    } else {\n      this.horiz.style.display = \"\";\n      this.horiz.firstChild.style.width = \"0\";\n    }\n\n    if (!this.checkedZeroWidth && measure.clientHeight > 0) {\n      if (sWidth == 0) { this.zeroWidthHack(); }\n      this.checkedZeroWidth = true;\n    }\n\n    return {right: needsV ? sWidth : 0, bottom: needsH ? sWidth : 0}\n  };\n\n  NativeScrollbars.prototype.setScrollLeft = function (pos) {\n    if (this.horiz.scrollLeft != pos) { this.horiz.scrollLeft = pos; }\n    if (this.disableHoriz) { this.enableZeroWidthBar(this.horiz, this.disableHoriz, \"horiz\"); }\n  };\n\n  NativeScrollbars.prototype.setScrollTop = function (pos) {\n    if (this.vert.scrollTop != pos) { this.vert.scrollTop = pos; }\n    if (this.disableVert) { this.enableZeroWidthBar(this.vert, this.disableVert, \"vert\"); }\n  };\n\n  NativeScrollbars.prototype.zeroWidthHack = function () {\n    var w = mac && !mac_geMountainLion ? \"12px\" : \"18px\";\n    this.horiz.style.height = this.vert.style.width = w;\n    this.horiz.style.pointerEvents = this.vert.style.pointerEvents = \"none\";\n    this.disableHoriz = new Delayed;\n    this.disableVert = new Delayed;\n  };\n\n  NativeScrollbars.prototype.enableZeroWidthBar = function (bar, delay, type) {\n    bar.style.pointerEvents = \"auto\";\n    function maybeDisable() {\n      // To find out whether the scrollbar is still visible, we\n      // check whether the element under the pixel in the bottom\n      // right corner of the scrollbar box is the scrollbar box\n      // itself (when the bar is still visible) or its filler child\n      // (when the bar is hidden). If it is still visible, we keep\n      // it enabled, if it's hidden, we disable pointer events.\n      var box = bar.getBoundingClientRect();\n      var elt$$1 = type == \"vert\" ? document.elementFromPoint(box.right - 1, (box.top + box.bottom) / 2)\n          : document.elementFromPoint((box.right + box.left) / 2, box.bottom - 1);\n      if (elt$$1 != bar) { bar.style.pointerEvents = \"none\"; }\n      else { delay.set(1000, maybeDisable); }\n    }\n    delay.set(1000, maybeDisable);\n  };\n\n  NativeScrollbars.prototype.clear = function () {\n    var parent = this.horiz.parentNode;\n    parent.removeChild(this.horiz);\n    parent.removeChild(this.vert);\n  };\n\n  var NullScrollbars = function () {};\n\n  NullScrollbars.prototype.update = function () { return {bottom: 0, right: 0} };\n  NullScrollbars.prototype.setScrollLeft = function () {};\n  NullScrollbars.prototype.setScrollTop = function () {};\n  NullScrollbars.prototype.clear = function () {};\n\n  function updateScrollbars(cm, measure) {\n    if (!measure) { measure = measureForScrollbars(cm); }\n    var startWidth = cm.display.barWidth, startHeight = cm.display.barHeight;\n    updateScrollbarsInner(cm, measure);\n    for (var i = 0; i < 4 && startWidth != cm.display.barWidth || startHeight != cm.display.barHeight; i++) {\n      if (startWidth != cm.display.barWidth && cm.options.lineWrapping)\n        { updateHeightsInViewport(cm); }\n      updateScrollbarsInner(cm, measureForScrollbars(cm));\n      startWidth = cm.display.barWidth; startHeight = cm.display.barHeight;\n    }\n  }\n\n  // Re-synchronize the fake scrollbars with the actual size of the\n  // content.\n  function updateScrollbarsInner(cm, measure) {\n    var d = cm.display;\n    var sizes = d.scrollbars.update(measure);\n\n    d.sizer.style.paddingRight = (d.barWidth = sizes.right) + \"px\";\n    d.sizer.style.paddingBottom = (d.barHeight = sizes.bottom) + \"px\";\n    d.heightForcer.style.borderBottom = sizes.bottom + \"px solid transparent\";\n\n    if (sizes.right && sizes.bottom) {\n      d.scrollbarFiller.style.display = \"block\";\n      d.scrollbarFiller.style.height = sizes.bottom + \"px\";\n      d.scrollbarFiller.style.width = sizes.right + \"px\";\n    } else { d.scrollbarFiller.style.display = \"\"; }\n    if (sizes.bottom && cm.options.coverGutterNextToScrollbar && cm.options.fixedGutter) {\n      d.gutterFiller.style.display = \"block\";\n      d.gutterFiller.style.height = sizes.bottom + \"px\";\n      d.gutterFiller.style.width = measure.gutterWidth + \"px\";\n    } else { d.gutterFiller.style.display = \"\"; }\n  }\n\n  var scrollbarModel = {\"native\": NativeScrollbars, \"null\": NullScrollbars};\n\n  function initScrollbars(cm) {\n    if (cm.display.scrollbars) {\n      cm.display.scrollbars.clear();\n      if (cm.display.scrollbars.addClass)\n        { rmClass(cm.display.wrapper, cm.display.scrollbars.addClass); }\n    }\n\n    cm.display.scrollbars = new scrollbarModel[cm.options.scrollbarStyle](function (node) {\n      cm.display.wrapper.insertBefore(node, cm.display.scrollbarFiller);\n      // Prevent clicks in the scrollbars from killing focus\n      on(node, \"mousedown\", function () {\n        if (cm.state.focused) { setTimeout(function () { return cm.display.input.focus(); }, 0); }\n      });\n      node.setAttribute(\"cm-not-content\", \"true\");\n    }, function (pos, axis) {\n      if (axis == \"horizontal\") { setScrollLeft(cm, pos); }\n      else { updateScrollTop(cm, pos); }\n    }, cm);\n    if (cm.display.scrollbars.addClass)\n      { addClass(cm.display.wrapper, cm.display.scrollbars.addClass); }\n  }\n\n  // Operations are used to wrap a series of changes to the editor\n  // state in such a way that each change won't have to update the\n  // cursor and display (which would be awkward, slow, and\n  // error-prone). Instead, display updates are batched and then all\n  // combined and executed at once.\n\n  var nextOpId = 0;\n  // Start a new operation.\n  function startOperation(cm) {\n    cm.curOp = {\n      cm: cm,\n      viewChanged: false,      // Flag that indicates that lines might need to be redrawn\n      startHeight: cm.doc.height, // Used to detect need to update scrollbar\n      forceUpdate: false,      // Used to force a redraw\n      updateInput: 0,       // Whether to reset the input textarea\n      typing: false,           // Whether this reset should be careful to leave existing text (for compositing)\n      changeObjs: null,        // Accumulated changes, for firing change events\n      cursorActivityHandlers: null, // Set of handlers to fire cursorActivity on\n      cursorActivityCalled: 0, // Tracks which cursorActivity handlers have been called already\n      selectionChanged: false, // Whether the selection needs to be redrawn\n      updateMaxLine: false,    // Set when the widest line needs to be determined anew\n      scrollLeft: null, scrollTop: null, // Intermediate scroll position, not pushed to DOM yet\n      scrollToPos: null,       // Used to scroll to a specific position\n      focus: false,\n      id: ++nextOpId           // Unique ID\n    };\n    pushOperation(cm.curOp);\n  }\n\n  // Finish an operation, updating the display and signalling delayed events\n  function endOperation(cm) {\n    var op = cm.curOp;\n    if (op) { finishOperation(op, function (group) {\n      for (var i = 0; i < group.ops.length; i++)\n        { group.ops[i].cm.curOp = null; }\n      endOperations(group);\n    }); }\n  }\n\n  // The DOM updates done when an operation finishes are batched so\n  // that the minimum number of relayouts are required.\n  function endOperations(group) {\n    var ops = group.ops;\n    for (var i = 0; i < ops.length; i++) // Read DOM\n      { endOperation_R1(ops[i]); }\n    for (var i$1 = 0; i$1 < ops.length; i$1++) // Write DOM (maybe)\n      { endOperation_W1(ops[i$1]); }\n    for (var i$2 = 0; i$2 < ops.length; i$2++) // Read DOM\n      { endOperation_R2(ops[i$2]); }\n    for (var i$3 = 0; i$3 < ops.length; i$3++) // Write DOM (maybe)\n      { endOperation_W2(ops[i$3]); }\n    for (var i$4 = 0; i$4 < ops.length; i$4++) // Read DOM\n      { endOperation_finish(ops[i$4]); }\n  }\n\n  function endOperation_R1(op) {\n    var cm = op.cm, display = cm.display;\n    maybeClipScrollbars(cm);\n    if (op.updateMaxLine) { findMaxLine(cm); }\n\n    op.mustUpdate = op.viewChanged || op.forceUpdate || op.scrollTop != null ||\n      op.scrollToPos && (op.scrollToPos.from.line < display.viewFrom ||\n                         op.scrollToPos.to.line >= display.viewTo) ||\n      display.maxLineChanged && cm.options.lineWrapping;\n    op.update = op.mustUpdate &&\n      new DisplayUpdate(cm, op.mustUpdate && {top: op.scrollTop, ensure: op.scrollToPos}, op.forceUpdate);\n  }\n\n  function endOperation_W1(op) {\n    op.updatedDisplay = op.mustUpdate && updateDisplayIfNeeded(op.cm, op.update);\n  }\n\n  function endOperation_R2(op) {\n    var cm = op.cm, display = cm.display;\n    if (op.updatedDisplay) { updateHeightsInViewport(cm); }\n\n    op.barMeasure = measureForScrollbars(cm);\n\n    // If the max line changed since it was last measured, measure it,\n    // and ensure the document's width matches it.\n    // updateDisplay_W2 will use these properties to do the actual resizing\n    if (display.maxLineChanged && !cm.options.lineWrapping) {\n      op.adjustWidthTo = measureChar(cm, display.maxLine, display.maxLine.text.length).left + 3;\n      cm.display.sizerWidth = op.adjustWidthTo;\n      op.barMeasure.scrollWidth =\n        Math.max(display.scroller.clientWidth, display.sizer.offsetLeft + op.adjustWidthTo + scrollGap(cm) + cm.display.barWidth);\n      op.maxScrollLeft = Math.max(0, display.sizer.offsetLeft + op.adjustWidthTo - displayWidth(cm));\n    }\n\n    if (op.updatedDisplay || op.selectionChanged)\n      { op.preparedSelection = display.input.prepareSelection(); }\n  }\n\n  function endOperation_W2(op) {\n    var cm = op.cm;\n\n    if (op.adjustWidthTo != null) {\n      cm.display.sizer.style.minWidth = op.adjustWidthTo + \"px\";\n      if (op.maxScrollLeft < cm.doc.scrollLeft)\n        { setScrollLeft(cm, Math.min(cm.display.scroller.scrollLeft, op.maxScrollLeft), true); }\n      cm.display.maxLineChanged = false;\n    }\n\n    var takeFocus = op.focus && op.focus == activeElt();\n    if (op.preparedSelection)\n      { cm.display.input.showSelection(op.preparedSelection, takeFocus); }\n    if (op.updatedDisplay || op.startHeight != cm.doc.height)\n      { updateScrollbars(cm, op.barMeasure); }\n    if (op.updatedDisplay)\n      { setDocumentHeight(cm, op.barMeasure); }\n\n    if (op.selectionChanged) { restartBlink(cm); }\n\n    if (cm.state.focused && op.updateInput)\n      { cm.display.input.reset(op.typing); }\n    if (takeFocus) { ensureFocus(op.cm); }\n  }\n\n  function endOperation_finish(op) {\n    var cm = op.cm, display = cm.display, doc = cm.doc;\n\n    if (op.updatedDisplay) { postUpdateDisplay(cm, op.update); }\n\n    // Abort mouse wheel delta measurement, when scrolling explicitly\n    if (display.wheelStartX != null && (op.scrollTop != null || op.scrollLeft != null || op.scrollToPos))\n      { display.wheelStartX = display.wheelStartY = null; }\n\n    // Propagate the scroll position to the actual DOM scroller\n    if (op.scrollTop != null) { setScrollTop(cm, op.scrollTop, op.forceScroll); }\n\n    if (op.scrollLeft != null) { setScrollLeft(cm, op.scrollLeft, true, true); }\n    // If we need to scroll a specific position into view, do so.\n    if (op.scrollToPos) {\n      var rect = scrollPosIntoView(cm, clipPos(doc, op.scrollToPos.from),\n                                   clipPos(doc, op.scrollToPos.to), op.scrollToPos.margin);\n      maybeScrollWindow(cm, rect);\n    }\n\n    // Fire events for markers that are hidden/unidden by editing or\n    // undoing\n    var hidden = op.maybeHiddenMarkers, unhidden = op.maybeUnhiddenMarkers;\n    if (hidden) { for (var i = 0; i < hidden.length; ++i)\n      { if (!hidden[i].lines.length) { signal(hidden[i], \"hide\"); } } }\n    if (unhidden) { for (var i$1 = 0; i$1 < unhidden.length; ++i$1)\n      { if (unhidden[i$1].lines.length) { signal(unhidden[i$1], \"unhide\"); } } }\n\n    if (display.wrapper.offsetHeight)\n      { doc.scrollTop = cm.display.scroller.scrollTop; }\n\n    // Fire change events, and delayed event handlers\n    if (op.changeObjs)\n      { signal(cm, \"changes\", cm, op.changeObjs); }\n    if (op.update)\n      { op.update.finish(); }\n  }\n\n  // Run the given function in an operation\n  function runInOp(cm, f) {\n    if (cm.curOp) { return f() }\n    startOperation(cm);\n    try { return f() }\n    finally { endOperation(cm); }\n  }\n  // Wraps a function in an operation. Returns the wrapped function.\n  function operation(cm, f) {\n    return function() {\n      if (cm.curOp) { return f.apply(cm, arguments) }\n      startOperation(cm);\n      try { return f.apply(cm, arguments) }\n      finally { endOperation(cm); }\n    }\n  }\n  // Used to add methods to editor and doc instances, wrapping them in\n  // operations.\n  function methodOp(f) {\n    return function() {\n      if (this.curOp) { return f.apply(this, arguments) }\n      startOperation(this);\n      try { return f.apply(this, arguments) }\n      finally { endOperation(this); }\n    }\n  }\n  function docMethodOp(f) {\n    return function() {\n      var cm = this.cm;\n      if (!cm || cm.curOp) { return f.apply(this, arguments) }\n      startOperation(cm);\n      try { return f.apply(this, arguments) }\n      finally { endOperation(cm); }\n    }\n  }\n\n  // HIGHLIGHT WORKER\n\n  function startWorker(cm, time) {\n    if (cm.doc.highlightFrontier < cm.display.viewTo)\n      { cm.state.highlight.set(time, bind(highlightWorker, cm)); }\n  }\n\n  function highlightWorker(cm) {\n    var doc = cm.doc;\n    if (doc.highlightFrontier >= cm.display.viewTo) { return }\n    var end = +new Date + cm.options.workTime;\n    var context = getContextBefore(cm, doc.highlightFrontier);\n    var changedLines = [];\n\n    doc.iter(context.line, Math.min(doc.first + doc.size, cm.display.viewTo + 500), function (line) {\n      if (context.line >= cm.display.viewFrom) { // Visible\n        var oldStyles = line.styles;\n        var resetState = line.text.length > cm.options.maxHighlightLength ? copyState(doc.mode, context.state) : null;\n        var highlighted = highlightLine(cm, line, context, true);\n        if (resetState) { context.state = resetState; }\n        line.styles = highlighted.styles;\n        var oldCls = line.styleClasses, newCls = highlighted.classes;\n        if (newCls) { line.styleClasses = newCls; }\n        else if (oldCls) { line.styleClasses = null; }\n        var ischange = !oldStyles || oldStyles.length != line.styles.length ||\n          oldCls != newCls && (!oldCls || !newCls || oldCls.bgClass != newCls.bgClass || oldCls.textClass != newCls.textClass);\n        for (var i = 0; !ischange && i < oldStyles.length; ++i) { ischange = oldStyles[i] != line.styles[i]; }\n        if (ischange) { changedLines.push(context.line); }\n        line.stateAfter = context.save();\n        context.nextLine();\n      } else {\n        if (line.text.length <= cm.options.maxHighlightLength)\n          { processLine(cm, line.text, context); }\n        line.stateAfter = context.line % 5 == 0 ? context.save() : null;\n        context.nextLine();\n      }\n      if (+new Date > end) {\n        startWorker(cm, cm.options.workDelay);\n        return true\n      }\n    });\n    doc.highlightFrontier = context.line;\n    doc.modeFrontier = Math.max(doc.modeFrontier, context.line);\n    if (changedLines.length) { runInOp(cm, function () {\n      for (var i = 0; i < changedLines.length; i++)\n        { regLineChange(cm, changedLines[i], \"text\"); }\n    }); }\n  }\n\n  // DISPLAY DRAWING\n\n  var DisplayUpdate = function(cm, viewport, force) {\n    var display = cm.display;\n\n    this.viewport = viewport;\n    // Store some values that we'll need later (but don't want to force a relayout for)\n    this.visible = visibleLines(display, cm.doc, viewport);\n    this.editorIsHidden = !display.wrapper.offsetWidth;\n    this.wrapperHeight = display.wrapper.clientHeight;\n    this.wrapperWidth = display.wrapper.clientWidth;\n    this.oldDisplayWidth = displayWidth(cm);\n    this.force = force;\n    this.dims = getDimensions(cm);\n    this.events = [];\n  };\n\n  DisplayUpdate.prototype.signal = function (emitter, type) {\n    if (hasHandler(emitter, type))\n      { this.events.push(arguments); }\n  };\n  DisplayUpdate.prototype.finish = function () {\n      var this$1 = this;\n\n    for (var i = 0; i < this.events.length; i++)\n      { signal.apply(null, this$1.events[i]); }\n  };\n\n  function maybeClipScrollbars(cm) {\n    var display = cm.display;\n    if (!display.scrollbarsClipped && display.scroller.offsetWidth) {\n      display.nativeBarWidth = display.scroller.offsetWidth - display.scroller.clientWidth;\n      display.heightForcer.style.height = scrollGap(cm) + \"px\";\n      display.sizer.style.marginBottom = -display.nativeBarWidth + \"px\";\n      display.sizer.style.borderRightWidth = scrollGap(cm) + \"px\";\n      display.scrollbarsClipped = true;\n    }\n  }\n\n  function selectionSnapshot(cm) {\n    if (cm.hasFocus()) { return null }\n    var active = activeElt();\n    if (!active || !contains(cm.display.lineDiv, active)) { return null }\n    var result = {activeElt: active};\n    if (window.getSelection) {\n      var sel = window.getSelection();\n      if (sel.anchorNode && sel.extend && contains(cm.display.lineDiv, sel.anchorNode)) {\n        result.anchorNode = sel.anchorNode;\n        result.anchorOffset = sel.anchorOffset;\n        result.focusNode = sel.focusNode;\n        result.focusOffset = sel.focusOffset;\n      }\n    }\n    return result\n  }\n\n  function restoreSelection(snapshot) {\n    if (!snapshot || !snapshot.activeElt || snapshot.activeElt == activeElt()) { return }\n    snapshot.activeElt.focus();\n    if (snapshot.anchorNode && contains(document.body, snapshot.anchorNode) && contains(document.body, snapshot.focusNode)) {\n      var sel = window.getSelection(), range$$1 = document.createRange();\n      range$$1.setEnd(snapshot.anchorNode, snapshot.anchorOffset);\n      range$$1.collapse(false);\n      sel.removeAllRanges();\n      sel.addRange(range$$1);\n      sel.extend(snapshot.focusNode, snapshot.focusOffset);\n    }\n  }\n\n  // Does the actual updating of the line display. Bails out\n  // (returning false) when there is nothing to be done and forced is\n  // false.\n  function updateDisplayIfNeeded(cm, update) {\n    var display = cm.display, doc = cm.doc;\n\n    if (update.editorIsHidden) {\n      resetView(cm);\n      return false\n    }\n\n    // Bail out if the visible area is already rendered and nothing changed.\n    if (!update.force &&\n        update.visible.from >= display.viewFrom && update.visible.to <= display.viewTo &&\n        (display.updateLineNumbers == null || display.updateLineNumbers >= display.viewTo) &&\n        display.renderedView == display.view && countDirtyView(cm) == 0)\n      { return false }\n\n    if (maybeUpdateLineNumberWidth(cm)) {\n      resetView(cm);\n      update.dims = getDimensions(cm);\n    }\n\n    // Compute a suitable new viewport (from & to)\n    var end = doc.first + doc.size;\n    var from = Math.max(update.visible.from - cm.options.viewportMargin, doc.first);\n    var to = Math.min(end, update.visible.to + cm.options.viewportMargin);\n    if (display.viewFrom < from && from - display.viewFrom < 20) { from = Math.max(doc.first, display.viewFrom); }\n    if (display.viewTo > to && display.viewTo - to < 20) { to = Math.min(end, display.viewTo); }\n    if (sawCollapsedSpans) {\n      from = visualLineNo(cm.doc, from);\n      to = visualLineEndNo(cm.doc, to);\n    }\n\n    var different = from != display.viewFrom || to != display.viewTo ||\n      display.lastWrapHeight != update.wrapperHeight || display.lastWrapWidth != update.wrapperWidth;\n    adjustView(cm, from, to);\n\n    display.viewOffset = heightAtLine(getLine(cm.doc, display.viewFrom));\n    // Position the mover div to align with the current scroll position\n    cm.display.mover.style.top = display.viewOffset + \"px\";\n\n    var toUpdate = countDirtyView(cm);\n    if (!different && toUpdate == 0 && !update.force && display.renderedView == display.view &&\n        (display.updateLineNumbers == null || display.updateLineNumbers >= display.viewTo))\n      { return false }\n\n    // For big changes, we hide the enclosing element during the\n    // update, since that speeds up the operations on most browsers.\n    var selSnapshot = selectionSnapshot(cm);\n    if (toUpdate > 4) { display.lineDiv.style.display = \"none\"; }\n    patchDisplay(cm, display.updateLineNumbers, update.dims);\n    if (toUpdate > 4) { display.lineDiv.style.display = \"\"; }\n    display.renderedView = display.view;\n    // There might have been a widget with a focused element that got\n    // hidden or updated, if so re-focus it.\n    restoreSelection(selSnapshot);\n\n    // Prevent selection and cursors from interfering with the scroll\n    // width and height.\n    removeChildren(display.cursorDiv);\n    removeChildren(display.selectionDiv);\n    display.gutters.style.height = display.sizer.style.minHeight = 0;\n\n    if (different) {\n      display.lastWrapHeight = update.wrapperHeight;\n      display.lastWrapWidth = update.wrapperWidth;\n      startWorker(cm, 400);\n    }\n\n    display.updateLineNumbers = null;\n\n    return true\n  }\n\n  function postUpdateDisplay(cm, update) {\n    var viewport = update.viewport;\n\n    for (var first = true;; first = false) {\n      if (!first || !cm.options.lineWrapping || update.oldDisplayWidth == displayWidth(cm)) {\n        // Clip forced viewport to actual scrollable area.\n        if (viewport && viewport.top != null)\n          { viewport = {top: Math.min(cm.doc.height + paddingVert(cm.display) - displayHeight(cm), viewport.top)}; }\n        // Updated line heights might result in the drawn area not\n        // actually covering the viewport. Keep looping until it does.\n        update.visible = visibleLines(cm.display, cm.doc, viewport);\n        if (update.visible.from >= cm.display.viewFrom && update.visible.to <= cm.display.viewTo)\n          { break }\n      }\n      if (!updateDisplayIfNeeded(cm, update)) { break }\n      updateHeightsInViewport(cm);\n      var barMeasure = measureForScrollbars(cm);\n      updateSelection(cm);\n      updateScrollbars(cm, barMeasure);\n      setDocumentHeight(cm, barMeasure);\n      update.force = false;\n    }\n\n    update.signal(cm, \"update\", cm);\n    if (cm.display.viewFrom != cm.display.reportedViewFrom || cm.display.viewTo != cm.display.reportedViewTo) {\n      update.signal(cm, \"viewportChange\", cm, cm.display.viewFrom, cm.display.viewTo);\n      cm.display.reportedViewFrom = cm.display.viewFrom; cm.display.reportedViewTo = cm.display.viewTo;\n    }\n  }\n\n  function updateDisplaySimple(cm, viewport) {\n    var update = new DisplayUpdate(cm, viewport);\n    if (updateDisplayIfNeeded(cm, update)) {\n      updateHeightsInViewport(cm);\n      postUpdateDisplay(cm, update);\n      var barMeasure = measureForScrollbars(cm);\n      updateSelection(cm);\n      updateScrollbars(cm, barMeasure);\n      setDocumentHeight(cm, barMeasure);\n      update.finish();\n    }\n  }\n\n  // Sync the actual display DOM structure with display.view, removing\n  // nodes for lines that are no longer in view, and creating the ones\n  // that are not there yet, and updating the ones that are out of\n  // date.\n  function patchDisplay(cm, updateNumbersFrom, dims) {\n    var display = cm.display, lineNumbers = cm.options.lineNumbers;\n    var container = display.lineDiv, cur = container.firstChild;\n\n    function rm(node) {\n      var next = node.nextSibling;\n      // Works around a throw-scroll bug in OS X Webkit\n      if (webkit && mac && cm.display.currentWheelTarget == node)\n        { node.style.display = \"none\"; }\n      else\n        { node.parentNode.removeChild(node); }\n      return next\n    }\n\n    var view = display.view, lineN = display.viewFrom;\n    // Loop over the elements in the view, syncing cur (the DOM nodes\n    // in display.lineDiv) with the view as we go.\n    for (var i = 0; i < view.length; i++) {\n      var lineView = view[i];\n      if (lineView.hidden) ; else if (!lineView.node || lineView.node.parentNode != container) { // Not drawn yet\n        var node = buildLineElement(cm, lineView, lineN, dims);\n        container.insertBefore(node, cur);\n      } else { // Already drawn\n        while (cur != lineView.node) { cur = rm(cur); }\n        var updateNumber = lineNumbers && updateNumbersFrom != null &&\n          updateNumbersFrom <= lineN && lineView.lineNumber;\n        if (lineView.changes) {\n          if (indexOf(lineView.changes, \"gutter\") > -1) { updateNumber = false; }\n          updateLineForChanges(cm, lineView, lineN, dims);\n        }\n        if (updateNumber) {\n          removeChildren(lineView.lineNumber);\n          lineView.lineNumber.appendChild(document.createTextNode(lineNumberFor(cm.options, lineN)));\n        }\n        cur = lineView.node.nextSibling;\n      }\n      lineN += lineView.size;\n    }\n    while (cur) { cur = rm(cur); }\n  }\n\n  function updateGutterSpace(display) {\n    var width = display.gutters.offsetWidth;\n    display.sizer.style.marginLeft = width + \"px\";\n  }\n\n  function setDocumentHeight(cm, measure) {\n    cm.display.sizer.style.minHeight = measure.docHeight + \"px\";\n    cm.display.heightForcer.style.top = measure.docHeight + \"px\";\n    cm.display.gutters.style.height = (measure.docHeight + cm.display.barHeight + scrollGap(cm)) + \"px\";\n  }\n\n  // Re-align line numbers and gutter marks to compensate for\n  // horizontal scrolling.\n  function alignHorizontally(cm) {\n    var display = cm.display, view = display.view;\n    if (!display.alignWidgets && (!display.gutters.firstChild || !cm.options.fixedGutter)) { return }\n    var comp = compensateForHScroll(display) - display.scroller.scrollLeft + cm.doc.scrollLeft;\n    var gutterW = display.gutters.offsetWidth, left = comp + \"px\";\n    for (var i = 0; i < view.length; i++) { if (!view[i].hidden) {\n      if (cm.options.fixedGutter) {\n        if (view[i].gutter)\n          { view[i].gutter.style.left = left; }\n        if (view[i].gutterBackground)\n          { view[i].gutterBackground.style.left = left; }\n      }\n      var align = view[i].alignable;\n      if (align) { for (var j = 0; j < align.length; j++)\n        { align[j].style.left = left; } }\n    } }\n    if (cm.options.fixedGutter)\n      { display.gutters.style.left = (comp + gutterW) + \"px\"; }\n  }\n\n  // Used to ensure that the line number gutter is still the right\n  // size for the current document size. Returns true when an update\n  // is needed.\n  function maybeUpdateLineNumberWidth(cm) {\n    if (!cm.options.lineNumbers) { return false }\n    var doc = cm.doc, last = lineNumberFor(cm.options, doc.first + doc.size - 1), display = cm.display;\n    if (last.length != display.lineNumChars) {\n      var test = display.measure.appendChild(elt(\"div\", [elt(\"div\", last)],\n                                                 \"CodeMirror-linenumber CodeMirror-gutter-elt\"));\n      var innerW = test.firstChild.offsetWidth, padding = test.offsetWidth - innerW;\n      display.lineGutter.style.width = \"\";\n      display.lineNumInnerWidth = Math.max(innerW, display.lineGutter.offsetWidth - padding) + 1;\n      display.lineNumWidth = display.lineNumInnerWidth + padding;\n      display.lineNumChars = display.lineNumInnerWidth ? last.length : -1;\n      display.lineGutter.style.width = display.lineNumWidth + \"px\";\n      updateGutterSpace(cm.display);\n      return true\n    }\n    return false\n  }\n\n  function getGutters(gutters, lineNumbers) {\n    var result = [], sawLineNumbers = false;\n    for (var i = 0; i < gutters.length; i++) {\n      var name = gutters[i], style = null;\n      if (typeof name != \"string\") { style = name.style; name = name.className; }\n      if (name == \"CodeMirror-linenumbers\") {\n        if (!lineNumbers) { continue }\n        else { sawLineNumbers = true; }\n      }\n      result.push({className: name, style: style});\n    }\n    if (lineNumbers && !sawLineNumbers) { result.push({className: \"CodeMirror-linenumbers\", style: null}); }\n    return result\n  }\n\n  // Rebuild the gutter elements, ensure the margin to the left of the\n  // code matches their width.\n  function renderGutters(display) {\n    var gutters = display.gutters, specs = display.gutterSpecs;\n    removeChildren(gutters);\n    display.lineGutter = null;\n    for (var i = 0; i < specs.length; ++i) {\n      var ref = specs[i];\n      var className = ref.className;\n      var style = ref.style;\n      var gElt = gutters.appendChild(elt(\"div\", null, \"CodeMirror-gutter \" + className));\n      if (style) { gElt.style.cssText = style; }\n      if (className == \"CodeMirror-linenumbers\") {\n        display.lineGutter = gElt;\n        gElt.style.width = (display.lineNumWidth || 1) + \"px\";\n      }\n    }\n    gutters.style.display = specs.length ? \"\" : \"none\";\n    updateGutterSpace(display);\n  }\n\n  function updateGutters(cm) {\n    renderGutters(cm.display);\n    regChange(cm);\n    alignHorizontally(cm);\n  }\n\n  // The display handles the DOM integration, both for input reading\n  // and content drawing. It holds references to DOM nodes and\n  // display-related state.\n\n  function Display(place, doc, input, options) {\n    var d = this;\n    this.input = input;\n\n    // Covers bottom-right square when both scrollbars are present.\n    d.scrollbarFiller = elt(\"div\", null, \"CodeMirror-scrollbar-filler\");\n    d.scrollbarFiller.setAttribute(\"cm-not-content\", \"true\");\n    // Covers bottom of gutter when coverGutterNextToScrollbar is on\n    // and h scrollbar is present.\n    d.gutterFiller = elt(\"div\", null, \"CodeMirror-gutter-filler\");\n    d.gutterFiller.setAttribute(\"cm-not-content\", \"true\");\n    // Will contain the actual code, positioned to cover the viewport.\n    d.lineDiv = eltP(\"div\", null, \"CodeMirror-code\");\n    // Elements are added to these to represent selection and cursors.\n    d.selectionDiv = elt(\"div\", null, null, \"position: relative; z-index: 1\");\n    d.cursorDiv = elt(\"div\", null, \"CodeMirror-cursors\");\n    // A visibility: hidden element used to find the size of things.\n    d.measure = elt(\"div\", null, \"CodeMirror-measure\");\n    // When lines outside of the viewport are measured, they are drawn in this.\n    d.lineMeasure = elt(\"div\", null, \"CodeMirror-measure\");\n    // Wraps everything that needs to exist inside the vertically-padded coordinate system\n    d.lineSpace = eltP(\"div\", [d.measure, d.lineMeasure, d.selectionDiv, d.cursorDiv, d.lineDiv],\n                      null, \"position: relative; outline: none\");\n    var lines = eltP(\"div\", [d.lineSpace], \"CodeMirror-lines\");\n    // Moved around its parent to cover visible view.\n    d.mover = elt(\"div\", [lines], null, \"position: relative\");\n    // Set to the height of the document, allowing scrolling.\n    d.sizer = elt(\"div\", [d.mover], \"CodeMirror-sizer\");\n    d.sizerWidth = null;\n    // Behavior of elts with overflow: auto and padding is\n    // inconsistent across browsers. This is used to ensure the\n    // scrollable area is big enough.\n    d.heightForcer = elt(\"div\", null, null, \"position: absolute; height: \" + scrollerGap + \"px; width: 1px;\");\n    // Will contain the gutters, if any.\n    d.gutters = elt(\"div\", null, \"CodeMirror-gutters\");\n    d.lineGutter = null;\n    // Actual scrollable element.\n    d.scroller = elt(\"div\", [d.sizer, d.heightForcer, d.gutters], \"CodeMirror-scroll\");\n    d.scroller.setAttribute(\"tabIndex\", \"-1\");\n    // The element in which the editor lives.\n    d.wrapper = elt(\"div\", [d.scrollbarFiller, d.gutterFiller, d.scroller], \"CodeMirror\");\n\n    // Work around IE7 z-index bug (not perfect, hence IE7 not really being supported)\n    if (ie && ie_version < 8) { d.gutters.style.zIndex = -1; d.scroller.style.paddingRight = 0; }\n    if (!webkit && !(gecko && mobile)) { d.scroller.draggable = true; }\n\n    if (place) {\n      if (place.appendChild) { place.appendChild(d.wrapper); }\n      else { place(d.wrapper); }\n    }\n\n    // Current rendered range (may be bigger than the view window).\n    d.viewFrom = d.viewTo = doc.first;\n    d.reportedViewFrom = d.reportedViewTo = doc.first;\n    // Information about the rendered lines.\n    d.view = [];\n    d.renderedView = null;\n    // Holds info about a single rendered line when it was rendered\n    // for measurement, while not in view.\n    d.externalMeasured = null;\n    // Empty space (in pixels) above the view\n    d.viewOffset = 0;\n    d.lastWrapHeight = d.lastWrapWidth = 0;\n    d.updateLineNumbers = null;\n\n    d.nativeBarWidth = d.barHeight = d.barWidth = 0;\n    d.scrollbarsClipped = false;\n\n    // Used to only resize the line number gutter when necessary (when\n    // the amount of lines crosses a boundary that makes its width change)\n    d.lineNumWidth = d.lineNumInnerWidth = d.lineNumChars = null;\n    // Set to true when a non-horizontal-scrolling line widget is\n    // added. As an optimization, line widget aligning is skipped when\n    // this is false.\n    d.alignWidgets = false;\n\n    d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null;\n\n    // Tracks the maximum line length so that the horizontal scrollbar\n    // can be kept static when scrolling.\n    d.maxLine = null;\n    d.maxLineLength = 0;\n    d.maxLineChanged = false;\n\n    // Used for measuring wheel scrolling granularity\n    d.wheelDX = d.wheelDY = d.wheelStartX = d.wheelStartY = null;\n\n    // True when shift is held down.\n    d.shift = false;\n\n    // Used to track whether anything happened since the context menu\n    // was opened.\n    d.selForContextMenu = null;\n\n    d.activeTouch = null;\n\n    d.gutterSpecs = getGutters(options.gutters, options.lineNumbers);\n    renderGutters(d);\n\n    input.init(d);\n  }\n\n  // Since the delta values reported on mouse wheel events are\n  // unstandardized between browsers and even browser versions, and\n  // generally horribly unpredictable, this code starts by measuring\n  // the scroll effect that the first few mouse wheel events have,\n  // and, from that, detects the way it can convert deltas to pixel\n  // offsets afterwards.\n  //\n  // The reason we want to know the amount a wheel event will scroll\n  // is that it gives us a chance to update the display before the\n  // actual scrolling happens, reducing flickering.\n\n  var wheelSamples = 0, wheelPixelsPerUnit = null;\n  // Fill in a browser-detected starting value on browsers where we\n  // know one. These don't have to be accurate -- the result of them\n  // being wrong would just be a slight flicker on the first wheel\n  // scroll (if it is large enough).\n  if (ie) { wheelPixelsPerUnit = -.53; }\n  else if (gecko) { wheelPixelsPerUnit = 15; }\n  else if (chrome) { wheelPixelsPerUnit = -.7; }\n  else if (safari) { wheelPixelsPerUnit = -1/3; }\n\n  function wheelEventDelta(e) {\n    var dx = e.wheelDeltaX, dy = e.wheelDeltaY;\n    if (dx == null && e.detail && e.axis == e.HORIZONTAL_AXIS) { dx = e.detail; }\n    if (dy == null && e.detail && e.axis == e.VERTICAL_AXIS) { dy = e.detail; }\n    else if (dy == null) { dy = e.wheelDelta; }\n    return {x: dx, y: dy}\n  }\n  function wheelEventPixels(e) {\n    var delta = wheelEventDelta(e);\n    delta.x *= wheelPixelsPerUnit;\n    delta.y *= wheelPixelsPerUnit;\n    return delta\n  }\n\n  function onScrollWheel(cm, e) {\n    var delta = wheelEventDelta(e), dx = delta.x, dy = delta.y;\n\n    var display = cm.display, scroll = display.scroller;\n    // Quit if there's nothing to scroll here\n    var canScrollX = scroll.scrollWidth > scroll.clientWidth;\n    var canScrollY = scroll.scrollHeight > scroll.clientHeight;\n    if (!(dx && canScrollX || dy && canScrollY)) { return }\n\n    // Webkit browsers on OS X abort momentum scrolls when the target\n    // of the scroll event is removed from the scrollable element.\n    // This hack (see related code in patchDisplay) makes sure the\n    // element is kept around.\n    if (dy && mac && webkit) {\n      outer: for (var cur = e.target, view = display.view; cur != scroll; cur = cur.parentNode) {\n        for (var i = 0; i < view.length; i++) {\n          if (view[i].node == cur) {\n            cm.display.currentWheelTarget = cur;\n            break outer\n          }\n        }\n      }\n    }\n\n    // On some browsers, horizontal scrolling will cause redraws to\n    // happen before the gutter has been realigned, causing it to\n    // wriggle around in a most unseemly way. When we have an\n    // estimated pixels/delta value, we just handle horizontal\n    // scrolling entirely here. It'll be slightly off from native, but\n    // better than glitching out.\n    if (dx && !gecko && !presto && wheelPixelsPerUnit != null) {\n      if (dy && canScrollY)\n        { updateScrollTop(cm, Math.max(0, scroll.scrollTop + dy * wheelPixelsPerUnit)); }\n      setScrollLeft(cm, Math.max(0, scroll.scrollLeft + dx * wheelPixelsPerUnit));\n      // Only prevent default scrolling if vertical scrolling is\n      // actually possible. Otherwise, it causes vertical scroll\n      // jitter on OSX trackpads when deltaX is small and deltaY\n      // is large (issue #3579)\n      if (!dy || (dy && canScrollY))\n        { e_preventDefault(e); }\n      display.wheelStartX = null; // Abort measurement, if in progress\n      return\n    }\n\n    // 'Project' the visible viewport to cover the area that is being\n    // scrolled into view (if we know enough to estimate it).\n    if (dy && wheelPixelsPerUnit != null) {\n      var pixels = dy * wheelPixelsPerUnit;\n      var top = cm.doc.scrollTop, bot = top + display.wrapper.clientHeight;\n      if (pixels < 0) { top = Math.max(0, top + pixels - 50); }\n      else { bot = Math.min(cm.doc.height, bot + pixels + 50); }\n      updateDisplaySimple(cm, {top: top, bottom: bot});\n    }\n\n    if (wheelSamples < 20) {\n      if (display.wheelStartX == null) {\n        display.wheelStartX = scroll.scrollLeft; display.wheelStartY = scroll.scrollTop;\n        display.wheelDX = dx; display.wheelDY = dy;\n        setTimeout(function () {\n          if (display.wheelStartX == null) { return }\n          var movedX = scroll.scrollLeft - display.wheelStartX;\n          var movedY = scroll.scrollTop - display.wheelStartY;\n          var sample = (movedY && display.wheelDY && movedY / display.wheelDY) ||\n            (movedX && display.wheelDX && movedX / display.wheelDX);\n          display.wheelStartX = display.wheelStartY = null;\n          if (!sample) { return }\n          wheelPixelsPerUnit = (wheelPixelsPerUnit * wheelSamples + sample) / (wheelSamples + 1);\n          ++wheelSamples;\n        }, 200);\n      } else {\n        display.wheelDX += dx; display.wheelDY += dy;\n      }\n    }\n  }\n\n  // Selection objects are immutable. A new one is created every time\n  // the selection changes. A selection is one or more non-overlapping\n  // (and non-touching) ranges, sorted, and an integer that indicates\n  // which one is the primary selection (the one that's scrolled into\n  // view, that getCursor returns, etc).\n  var Selection = function(ranges, primIndex) {\n    this.ranges = ranges;\n    this.primIndex = primIndex;\n  };\n\n  Selection.prototype.primary = function () { return this.ranges[this.primIndex] };\n\n  Selection.prototype.equals = function (other) {\n      var this$1 = this;\n\n    if (other == this) { return true }\n    if (other.primIndex != this.primIndex || other.ranges.length != this.ranges.length) { return false }\n    for (var i = 0; i < this.ranges.length; i++) {\n      var here = this$1.ranges[i], there = other.ranges[i];\n      if (!equalCursorPos(here.anchor, there.anchor) || !equalCursorPos(here.head, there.head)) { return false }\n    }\n    return true\n  };\n\n  Selection.prototype.deepCopy = function () {\n      var this$1 = this;\n\n    var out = [];\n    for (var i = 0; i < this.ranges.length; i++)\n      { out[i] = new Range(copyPos(this$1.ranges[i].anchor), copyPos(this$1.ranges[i].head)); }\n    return new Selection(out, this.primIndex)\n  };\n\n  Selection.prototype.somethingSelected = function () {\n      var this$1 = this;\n\n    for (var i = 0; i < this.ranges.length; i++)\n      { if (!this$1.ranges[i].empty()) { return true } }\n    return false\n  };\n\n  Selection.prototype.contains = function (pos, end) {\n      var this$1 = this;\n\n    if (!end) { end = pos; }\n    for (var i = 0; i < this.ranges.length; i++) {\n      var range = this$1.ranges[i];\n      if (cmp(end, range.from()) >= 0 && cmp(pos, range.to()) <= 0)\n        { return i }\n    }\n    return -1\n  };\n\n  var Range = function(anchor, head) {\n    this.anchor = anchor; this.head = head;\n  };\n\n  Range.prototype.from = function () { return minPos(this.anchor, this.head) };\n  Range.prototype.to = function () { return maxPos(this.anchor, this.head) };\n  Range.prototype.empty = function () { return this.head.line == this.anchor.line && this.head.ch == this.anchor.ch };\n\n  // Take an unsorted, potentially overlapping set of ranges, and\n  // build a selection out of it. 'Consumes' ranges array (modifying\n  // it).\n  function normalizeSelection(cm, ranges, primIndex) {\n    var mayTouch = cm && cm.options.selectionsMayTouch;\n    var prim = ranges[primIndex];\n    ranges.sort(function (a, b) { return cmp(a.from(), b.from()); });\n    primIndex = indexOf(ranges, prim);\n    for (var i = 1; i < ranges.length; i++) {\n      var cur = ranges[i], prev = ranges[i - 1];\n      var diff = cmp(prev.to(), cur.from());\n      if (mayTouch && !cur.empty() ? diff > 0 : diff >= 0) {\n        var from = minPos(prev.from(), cur.from()), to = maxPos(prev.to(), cur.to());\n        var inv = prev.empty() ? cur.from() == cur.head : prev.from() == prev.head;\n        if (i <= primIndex) { --primIndex; }\n        ranges.splice(--i, 2, new Range(inv ? to : from, inv ? from : to));\n      }\n    }\n    return new Selection(ranges, primIndex)\n  }\n\n  function simpleSelection(anchor, head) {\n    return new Selection([new Range(anchor, head || anchor)], 0)\n  }\n\n  // Compute the position of the end of a change (its 'to' property\n  // refers to the pre-change end).\n  function changeEnd(change) {\n    if (!change.text) { return change.to }\n    return Pos(change.from.line + change.text.length - 1,\n               lst(change.text).length + (change.text.length == 1 ? change.from.ch : 0))\n  }\n\n  // Adjust a position to refer to the post-change position of the\n  // same text, or the end of the change if the change covers it.\n  function adjustForChange(pos, change) {\n    if (cmp(pos, change.from) < 0) { return pos }\n    if (cmp(pos, change.to) <= 0) { return changeEnd(change) }\n\n    var line = pos.line + change.text.length - (change.to.line - change.from.line) - 1, ch = pos.ch;\n    if (pos.line == change.to.line) { ch += changeEnd(change).ch - change.to.ch; }\n    return Pos(line, ch)\n  }\n\n  function computeSelAfterChange(doc, change) {\n    var out = [];\n    for (var i = 0; i < doc.sel.ranges.length; i++) {\n      var range = doc.sel.ranges[i];\n      out.push(new Range(adjustForChange(range.anchor, change),\n                         adjustForChange(range.head, change)));\n    }\n    return normalizeSelection(doc.cm, out, doc.sel.primIndex)\n  }\n\n  function offsetPos(pos, old, nw) {\n    if (pos.line == old.line)\n      { return Pos(nw.line, pos.ch - old.ch + nw.ch) }\n    else\n      { return Pos(nw.line + (pos.line - old.line), pos.ch) }\n  }\n\n  // Used by replaceSelections to allow moving the selection to the\n  // start or around the replaced test. Hint may be \"start\" or \"around\".\n  function computeReplacedSel(doc, changes, hint) {\n    var out = [];\n    var oldPrev = Pos(doc.first, 0), newPrev = oldPrev;\n    for (var i = 0; i < changes.length; i++) {\n      var change = changes[i];\n      var from = offsetPos(change.from, oldPrev, newPrev);\n      var to = offsetPos(changeEnd(change), oldPrev, newPrev);\n      oldPrev = change.to;\n      newPrev = to;\n      if (hint == \"around\") {\n        var range = doc.sel.ranges[i], inv = cmp(range.head, range.anchor) < 0;\n        out[i] = new Range(inv ? to : from, inv ? from : to);\n      } else {\n        out[i] = new Range(from, from);\n      }\n    }\n    return new Selection(out, doc.sel.primIndex)\n  }\n\n  // Used to get the editor into a consistent state again when options change.\n\n  function loadMode(cm) {\n    cm.doc.mode = getMode(cm.options, cm.doc.modeOption);\n    resetModeState(cm);\n  }\n\n  function resetModeState(cm) {\n    cm.doc.iter(function (line) {\n      if (line.stateAfter) { line.stateAfter = null; }\n      if (line.styles) { line.styles = null; }\n    });\n    cm.doc.modeFrontier = cm.doc.highlightFrontier = cm.doc.first;\n    startWorker(cm, 100);\n    cm.state.modeGen++;\n    if (cm.curOp) { regChange(cm); }\n  }\n\n  // DOCUMENT DATA STRUCTURE\n\n  // By default, updates that start and end at the beginning of a line\n  // are treated specially, in order to make the association of line\n  // widgets and marker elements with the text behave more intuitive.\n  function isWholeLineUpdate(doc, change) {\n    return change.from.ch == 0 && change.to.ch == 0 && lst(change.text) == \"\" &&\n      (!doc.cm || doc.cm.options.wholeLineUpdateBefore)\n  }\n\n  // Perform a change on the document data structure.\n  function updateDoc(doc, change, markedSpans, estimateHeight$$1) {\n    function spansFor(n) {return markedSpans ? markedSpans[n] : null}\n    function update(line, text, spans) {\n      updateLine(line, text, spans, estimateHeight$$1);\n      signalLater(line, \"change\", line, change);\n    }\n    function linesFor(start, end) {\n      var result = [];\n      for (var i = start; i < end; ++i)\n        { result.push(new Line(text[i], spansFor(i), estimateHeight$$1)); }\n      return result\n    }\n\n    var from = change.from, to = change.to, text = change.text;\n    var firstLine = getLine(doc, from.line), lastLine = getLine(doc, to.line);\n    var lastText = lst(text), lastSpans = spansFor(text.length - 1), nlines = to.line - from.line;\n\n    // Adjust the line structure\n    if (change.full) {\n      doc.insert(0, linesFor(0, text.length));\n      doc.remove(text.length, doc.size - text.length);\n    } else if (isWholeLineUpdate(doc, change)) {\n      // This is a whole-line replace. Treated specially to make\n      // sure line objects move the way they are supposed to.\n      var added = linesFor(0, text.length - 1);\n      update(lastLine, lastLine.text, lastSpans);\n      if (nlines) { doc.remove(from.line, nlines); }\n      if (added.length) { doc.insert(from.line, added); }\n    } else if (firstLine == lastLine) {\n      if (text.length == 1) {\n        update(firstLine, firstLine.text.slice(0, from.ch) + lastText + firstLine.text.slice(to.ch), lastSpans);\n      } else {\n        var added$1 = linesFor(1, text.length - 1);\n        added$1.push(new Line(lastText + firstLine.text.slice(to.ch), lastSpans, estimateHeight$$1));\n        update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0));\n        doc.insert(from.line + 1, added$1);\n      }\n    } else if (text.length == 1) {\n      update(firstLine, firstLine.text.slice(0, from.ch) + text[0] + lastLine.text.slice(to.ch), spansFor(0));\n      doc.remove(from.line + 1, nlines);\n    } else {\n      update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0));\n      update(lastLine, lastText + lastLine.text.slice(to.ch), lastSpans);\n      var added$2 = linesFor(1, text.length - 1);\n      if (nlines > 1) { doc.remove(from.line + 1, nlines - 1); }\n      doc.insert(from.line + 1, added$2);\n    }\n\n    signalLater(doc, \"change\", doc, change);\n  }\n\n  // Call f for all linked documents.\n  function linkedDocs(doc, f, sharedHistOnly) {\n    function propagate(doc, skip, sharedHist) {\n      if (doc.linked) { for (var i = 0; i < doc.linked.length; ++i) {\n        var rel = doc.linked[i];\n        if (rel.doc == skip) { continue }\n        var shared = sharedHist && rel.sharedHist;\n        if (sharedHistOnly && !shared) { continue }\n        f(rel.doc, shared);\n        propagate(rel.doc, doc, shared);\n      } }\n    }\n    propagate(doc, null, true);\n  }\n\n  // Attach a document to an editor.\n  function attachDoc(cm, doc) {\n    if (doc.cm) { throw new Error(\"This document is already in use.\") }\n    cm.doc = doc;\n    doc.cm = cm;\n    estimateLineHeights(cm);\n    loadMode(cm);\n    setDirectionClass(cm);\n    if (!cm.options.lineWrapping) { findMaxLine(cm); }\n    cm.options.mode = doc.modeOption;\n    regChange(cm);\n  }\n\n  function setDirectionClass(cm) {\n  (cm.doc.direction == \"rtl\" ? addClass : rmClass)(cm.display.lineDiv, \"CodeMirror-rtl\");\n  }\n\n  function directionChanged(cm) {\n    runInOp(cm, function () {\n      setDirectionClass(cm);\n      regChange(cm);\n    });\n  }\n\n  function History(startGen) {\n    // Arrays of change events and selections. Doing something adds an\n    // event to done and clears undo. Undoing moves events from done\n    // to undone, redoing moves them in the other direction.\n    this.done = []; this.undone = [];\n    this.undoDepth = Infinity;\n    // Used to track when changes can be merged into a single undo\n    // event\n    this.lastModTime = this.lastSelTime = 0;\n    this.lastOp = this.lastSelOp = null;\n    this.lastOrigin = this.lastSelOrigin = null;\n    // Used by the isClean() method\n    this.generation = this.maxGeneration = startGen || 1;\n  }\n\n  // Create a history change event from an updateDoc-style change\n  // object.\n  function historyChangeFromChange(doc, change) {\n    var histChange = {from: copyPos(change.from), to: changeEnd(change), text: getBetween(doc, change.from, change.to)};\n    attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1);\n    linkedDocs(doc, function (doc) { return attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1); }, true);\n    return histChange\n  }\n\n  // Pop all selection events off the end of a history array. Stop at\n  // a change event.\n  function clearSelectionEvents(array) {\n    while (array.length) {\n      var last = lst(array);\n      if (last.ranges) { array.pop(); }\n      else { break }\n    }\n  }\n\n  // Find the top change event in the history. Pop off selection\n  // events that are in the way.\n  function lastChangeEvent(hist, force) {\n    if (force) {\n      clearSelectionEvents(hist.done);\n      return lst(hist.done)\n    } else if (hist.done.length && !lst(hist.done).ranges) {\n      return lst(hist.done)\n    } else if (hist.done.length > 1 && !hist.done[hist.done.length - 2].ranges) {\n      hist.done.pop();\n      return lst(hist.done)\n    }\n  }\n\n  // Register a change in the history. Merges changes that are within\n  // a single operation, or are close together with an origin that\n  // allows merging (starting with \"+\") into a single event.\n  function addChangeToHistory(doc, change, selAfter, opId) {\n    var hist = doc.history;\n    hist.undone.length = 0;\n    var time = +new Date, cur;\n    var last;\n\n    if ((hist.lastOp == opId ||\n         hist.lastOrigin == change.origin && change.origin &&\n         ((change.origin.charAt(0) == \"+\" && hist.lastModTime > time - (doc.cm ? doc.cm.options.historyEventDelay : 500)) ||\n          change.origin.charAt(0) == \"*\")) &&\n        (cur = lastChangeEvent(hist, hist.lastOp == opId))) {\n      // Merge this change into the last event\n      last = lst(cur.changes);\n      if (cmp(change.from, change.to) == 0 && cmp(change.from, last.to) == 0) {\n        // Optimized case for simple insertion -- don't want to add\n        // new changesets for every character typed\n        last.to = changeEnd(change);\n      } else {\n        // Add new sub-event\n        cur.changes.push(historyChangeFromChange(doc, change));\n      }\n    } else {\n      // Can not be merged, start a new event.\n      var before = lst(hist.done);\n      if (!before || !before.ranges)\n        { pushSelectionToHistory(doc.sel, hist.done); }\n      cur = {changes: [historyChangeFromChange(doc, change)],\n             generation: hist.generation};\n      hist.done.push(cur);\n      while (hist.done.length > hist.undoDepth) {\n        hist.done.shift();\n        if (!hist.done[0].ranges) { hist.done.shift(); }\n      }\n    }\n    hist.done.push(selAfter);\n    hist.generation = ++hist.maxGeneration;\n    hist.lastModTime = hist.lastSelTime = time;\n    hist.lastOp = hist.lastSelOp = opId;\n    hist.lastOrigin = hist.lastSelOrigin = change.origin;\n\n    if (!last) { signal(doc, \"historyAdded\"); }\n  }\n\n  function selectionEventCanBeMerged(doc, origin, prev, sel) {\n    var ch = origin.charAt(0);\n    return ch == \"*\" ||\n      ch == \"+\" &&\n      prev.ranges.length == sel.ranges.length &&\n      prev.somethingSelected() == sel.somethingSelected() &&\n      new Date - doc.history.lastSelTime <= (doc.cm ? doc.cm.options.historyEventDelay : 500)\n  }\n\n  // Called whenever the selection changes, sets the new selection as\n  // the pending selection in the history, and pushes the old pending\n  // selection into the 'done' array when it was significantly\n  // different (in number of selected ranges, emptiness, or time).\n  function addSelectionToHistory(doc, sel, opId, options) {\n    var hist = doc.history, origin = options && options.origin;\n\n    // A new event is started when the previous origin does not match\n    // the current, or the origins don't allow matching. Origins\n    // starting with * are always merged, those starting with + are\n    // merged when similar and close together in time.\n    if (opId == hist.lastSelOp ||\n        (origin && hist.lastSelOrigin == origin &&\n         (hist.lastModTime == hist.lastSelTime && hist.lastOrigin == origin ||\n          selectionEventCanBeMerged(doc, origin, lst(hist.done), sel))))\n      { hist.done[hist.done.length - 1] = sel; }\n    else\n      { pushSelectionToHistory(sel, hist.done); }\n\n    hist.lastSelTime = +new Date;\n    hist.lastSelOrigin = origin;\n    hist.lastSelOp = opId;\n    if (options && options.clearRedo !== false)\n      { clearSelectionEvents(hist.undone); }\n  }\n\n  function pushSelectionToHistory(sel, dest) {\n    var top = lst(dest);\n    if (!(top && top.ranges && top.equals(sel)))\n      { dest.push(sel); }\n  }\n\n  // Used to store marked span information in the history.\n  function attachLocalSpans(doc, change, from, to) {\n    var existing = change[\"spans_\" + doc.id], n = 0;\n    doc.iter(Math.max(doc.first, from), Math.min(doc.first + doc.size, to), function (line) {\n      if (line.markedSpans)\n        { (existing || (existing = change[\"spans_\" + doc.id] = {}))[n] = line.markedSpans; }\n      ++n;\n    });\n  }\n\n  // When un/re-doing restores text containing marked spans, those\n  // that have been explicitly cleared should not be restored.\n  function removeClearedSpans(spans) {\n    if (!spans) { return null }\n    var out;\n    for (var i = 0; i < spans.length; ++i) {\n      if (spans[i].marker.explicitlyCleared) { if (!out) { out = spans.slice(0, i); } }\n      else if (out) { out.push(spans[i]); }\n    }\n    return !out ? spans : out.length ? out : null\n  }\n\n  // Retrieve and filter the old marked spans stored in a change event.\n  function getOldSpans(doc, change) {\n    var found = change[\"spans_\" + doc.id];\n    if (!found) { return null }\n    var nw = [];\n    for (var i = 0; i < change.text.length; ++i)\n      { nw.push(removeClearedSpans(found[i])); }\n    return nw\n  }\n\n  // Used for un/re-doing changes from the history. Combines the\n  // result of computing the existing spans with the set of spans that\n  // existed in the history (so that deleting around a span and then\n  // undoing brings back the span).\n  function mergeOldSpans(doc, change) {\n    var old = getOldSpans(doc, change);\n    var stretched = stretchSpansOverChange(doc, change);\n    if (!old) { return stretched }\n    if (!stretched) { return old }\n\n    for (var i = 0; i < old.length; ++i) {\n      var oldCur = old[i], stretchCur = stretched[i];\n      if (oldCur && stretchCur) {\n        spans: for (var j = 0; j < stretchCur.length; ++j) {\n          var span = stretchCur[j];\n          for (var k = 0; k < oldCur.length; ++k)\n            { if (oldCur[k].marker == span.marker) { continue spans } }\n          oldCur.push(span);\n        }\n      } else if (stretchCur) {\n        old[i] = stretchCur;\n      }\n    }\n    return old\n  }\n\n  // Used both to provide a JSON-safe object in .getHistory, and, when\n  // detaching a document, to split the history in two\n  function copyHistoryArray(events, newGroup, instantiateSel) {\n    var copy = [];\n    for (var i = 0; i < events.length; ++i) {\n      var event = events[i];\n      if (event.ranges) {\n        copy.push(instantiateSel ? Selection.prototype.deepCopy.call(event) : event);\n        continue\n      }\n      var changes = event.changes, newChanges = [];\n      copy.push({changes: newChanges});\n      for (var j = 0; j < changes.length; ++j) {\n        var change = changes[j], m = (void 0);\n        newChanges.push({from: change.from, to: change.to, text: change.text});\n        if (newGroup) { for (var prop in change) { if (m = prop.match(/^spans_(\\d+)$/)) {\n          if (indexOf(newGroup, Number(m[1])) > -1) {\n            lst(newChanges)[prop] = change[prop];\n            delete change[prop];\n          }\n        } } }\n      }\n    }\n    return copy\n  }\n\n  // The 'scroll' parameter given to many of these indicated whether\n  // the new cursor position should be scrolled into view after\n  // modifying the selection.\n\n  // If shift is held or the extend flag is set, extends a range to\n  // include a given position (and optionally a second position).\n  // Otherwise, simply returns the range between the given positions.\n  // Used for cursor motion and such.\n  function extendRange(range, head, other, extend) {\n    if (extend) {\n      var anchor = range.anchor;\n      if (other) {\n        var posBefore = cmp(head, anchor) < 0;\n        if (posBefore != (cmp(other, anchor) < 0)) {\n          anchor = head;\n          head = other;\n        } else if (posBefore != (cmp(head, other) < 0)) {\n          head = other;\n        }\n      }\n      return new Range(anchor, head)\n    } else {\n      return new Range(other || head, head)\n    }\n  }\n\n  // Extend the primary selection range, discard the rest.\n  function extendSelection(doc, head, other, options, extend) {\n    if (extend == null) { extend = doc.cm && (doc.cm.display.shift || doc.extend); }\n    setSelection(doc, new Selection([extendRange(doc.sel.primary(), head, other, extend)], 0), options);\n  }\n\n  // Extend all selections (pos is an array of selections with length\n  // equal the number of selections)\n  function extendSelections(doc, heads, options) {\n    var out = [];\n    var extend = doc.cm && (doc.cm.display.shift || doc.extend);\n    for (var i = 0; i < doc.sel.ranges.length; i++)\n      { out[i] = extendRange(doc.sel.ranges[i], heads[i], null, extend); }\n    var newSel = normalizeSelection(doc.cm, out, doc.sel.primIndex);\n    setSelection(doc, newSel, options);\n  }\n\n  // Updates a single range in the selection.\n  function replaceOneSelection(doc, i, range, options) {\n    var ranges = doc.sel.ranges.slice(0);\n    ranges[i] = range;\n    setSelection(doc, normalizeSelection(doc.cm, ranges, doc.sel.primIndex), options);\n  }\n\n  // Reset the selection to a single range.\n  function setSimpleSelection(doc, anchor, head, options) {\n    setSelection(doc, simpleSelection(anchor, head), options);\n  }\n\n  // Give beforeSelectionChange handlers a change to influence a\n  // selection update.\n  function filterSelectionChange(doc, sel, options) {\n    var obj = {\n      ranges: sel.ranges,\n      update: function(ranges) {\n        var this$1 = this;\n\n        this.ranges = [];\n        for (var i = 0; i < ranges.length; i++)\n          { this$1.ranges[i] = new Range(clipPos(doc, ranges[i].anchor),\n                                     clipPos(doc, ranges[i].head)); }\n      },\n      origin: options && options.origin\n    };\n    signal(doc, \"beforeSelectionChange\", doc, obj);\n    if (doc.cm) { signal(doc.cm, \"beforeSelectionChange\", doc.cm, obj); }\n    if (obj.ranges != sel.ranges) { return normalizeSelection(doc.cm, obj.ranges, obj.ranges.length - 1) }\n    else { return sel }\n  }\n\n  function setSelectionReplaceHistory(doc, sel, options) {\n    var done = doc.history.done, last = lst(done);\n    if (last && last.ranges) {\n      done[done.length - 1] = sel;\n      setSelectionNoUndo(doc, sel, options);\n    } else {\n      setSelection(doc, sel, options);\n    }\n  }\n\n  // Set a new selection.\n  function setSelection(doc, sel, options) {\n    setSelectionNoUndo(doc, sel, options);\n    addSelectionToHistory(doc, doc.sel, doc.cm ? doc.cm.curOp.id : NaN, options);\n  }\n\n  function setSelectionNoUndo(doc, sel, options) {\n    if (hasHandler(doc, \"beforeSelectionChange\") || doc.cm && hasHandler(doc.cm, \"beforeSelectionChange\"))\n      { sel = filterSelectionChange(doc, sel, options); }\n\n    var bias = options && options.bias ||\n      (cmp(sel.primary().head, doc.sel.primary().head) < 0 ? -1 : 1);\n    setSelectionInner(doc, skipAtomicInSelection(doc, sel, bias, true));\n\n    if (!(options && options.scroll === false) && doc.cm)\n      { ensureCursorVisible(doc.cm); }\n  }\n\n  function setSelectionInner(doc, sel) {\n    if (sel.equals(doc.sel)) { return }\n\n    doc.sel = sel;\n\n    if (doc.cm) {\n      doc.cm.curOp.updateInput = 1;\n      doc.cm.curOp.selectionChanged = true;\n      signalCursorActivity(doc.cm);\n    }\n    signalLater(doc, \"cursorActivity\", doc);\n  }\n\n  // Verify that the selection does not partially select any atomic\n  // marked ranges.\n  function reCheckSelection(doc) {\n    setSelectionInner(doc, skipAtomicInSelection(doc, doc.sel, null, false));\n  }\n\n  // Return a selection that does not partially select any atomic\n  // ranges.\n  function skipAtomicInSelection(doc, sel, bias, mayClear) {\n    var out;\n    for (var i = 0; i < sel.ranges.length; i++) {\n      var range = sel.ranges[i];\n      var old = sel.ranges.length == doc.sel.ranges.length && doc.sel.ranges[i];\n      var newAnchor = skipAtomic(doc, range.anchor, old && old.anchor, bias, mayClear);\n      var newHead = skipAtomic(doc, range.head, old && old.head, bias, mayClear);\n      if (out || newAnchor != range.anchor || newHead != range.head) {\n        if (!out) { out = sel.ranges.slice(0, i); }\n        out[i] = new Range(newAnchor, newHead);\n      }\n    }\n    return out ? normalizeSelection(doc.cm, out, sel.primIndex) : sel\n  }\n\n  function skipAtomicInner(doc, pos, oldPos, dir, mayClear) {\n    var line = getLine(doc, pos.line);\n    if (line.markedSpans) { for (var i = 0; i < line.markedSpans.length; ++i) {\n      var sp = line.markedSpans[i], m = sp.marker;\n      if ((sp.from == null || (m.inclusiveLeft ? sp.from <= pos.ch : sp.from < pos.ch)) &&\n          (sp.to == null || (m.inclusiveRight ? sp.to >= pos.ch : sp.to > pos.ch))) {\n        if (mayClear) {\n          signal(m, \"beforeCursorEnter\");\n          if (m.explicitlyCleared) {\n            if (!line.markedSpans) { break }\n            else {--i; continue}\n          }\n        }\n        if (!m.atomic) { continue }\n\n        if (oldPos) {\n          var near = m.find(dir < 0 ? 1 : -1), diff = (void 0);\n          if (dir < 0 ? m.inclusiveRight : m.inclusiveLeft)\n            { near = movePos(doc, near, -dir, near && near.line == pos.line ? line : null); }\n          if (near && near.line == pos.line && (diff = cmp(near, oldPos)) && (dir < 0 ? diff < 0 : diff > 0))\n            { return skipAtomicInner(doc, near, pos, dir, mayClear) }\n        }\n\n        var far = m.find(dir < 0 ? -1 : 1);\n        if (dir < 0 ? m.inclusiveLeft : m.inclusiveRight)\n          { far = movePos(doc, far, dir, far.line == pos.line ? line : null); }\n        return far ? skipAtomicInner(doc, far, pos, dir, mayClear) : null\n      }\n    } }\n    return pos\n  }\n\n  // Ensure a given position is not inside an atomic range.\n  function skipAtomic(doc, pos, oldPos, bias, mayClear) {\n    var dir = bias || 1;\n    var found = skipAtomicInner(doc, pos, oldPos, dir, mayClear) ||\n        (!mayClear && skipAtomicInner(doc, pos, oldPos, dir, true)) ||\n        skipAtomicInner(doc, pos, oldPos, -dir, mayClear) ||\n        (!mayClear && skipAtomicInner(doc, pos, oldPos, -dir, true));\n    if (!found) {\n      doc.cantEdit = true;\n      return Pos(doc.first, 0)\n    }\n    return found\n  }\n\n  function movePos(doc, pos, dir, line) {\n    if (dir < 0 && pos.ch == 0) {\n      if (pos.line > doc.first) { return clipPos(doc, Pos(pos.line - 1)) }\n      else { return null }\n    } else if (dir > 0 && pos.ch == (line || getLine(doc, pos.line)).text.length) {\n      if (pos.line < doc.first + doc.size - 1) { return Pos(pos.line + 1, 0) }\n      else { return null }\n    } else {\n      return new Pos(pos.line, pos.ch + dir)\n    }\n  }\n\n  function selectAll(cm) {\n    cm.setSelection(Pos(cm.firstLine(), 0), Pos(cm.lastLine()), sel_dontScroll);\n  }\n\n  // UPDATING\n\n  // Allow \"beforeChange\" event handlers to influence a change\n  function filterChange(doc, change, update) {\n    var obj = {\n      canceled: false,\n      from: change.from,\n      to: change.to,\n      text: change.text,\n      origin: change.origin,\n      cancel: function () { return obj.canceled = true; }\n    };\n    if (update) { obj.update = function (from, to, text, origin) {\n      if (from) { obj.from = clipPos(doc, from); }\n      if (to) { obj.to = clipPos(doc, to); }\n      if (text) { obj.text = text; }\n      if (origin !== undefined) { obj.origin = origin; }\n    }; }\n    signal(doc, \"beforeChange\", doc, obj);\n    if (doc.cm) { signal(doc.cm, \"beforeChange\", doc.cm, obj); }\n\n    if (obj.canceled) {\n      if (doc.cm) { doc.cm.curOp.updateInput = 2; }\n      return null\n    }\n    return {from: obj.from, to: obj.to, text: obj.text, origin: obj.origin}\n  }\n\n  // Apply a change to a document, and add it to the document's\n  // history, and propagating it to all linked documents.\n  function makeChange(doc, change, ignoreReadOnly) {\n    if (doc.cm) {\n      if (!doc.cm.curOp) { return operation(doc.cm, makeChange)(doc, change, ignoreReadOnly) }\n      if (doc.cm.state.suppressEdits) { return }\n    }\n\n    if (hasHandler(doc, \"beforeChange\") || doc.cm && hasHandler(doc.cm, \"beforeChange\")) {\n      change = filterChange(doc, change, true);\n      if (!change) { return }\n    }\n\n    // Possibly split or suppress the update based on the presence\n    // of read-only spans in its range.\n    var split = sawReadOnlySpans && !ignoreReadOnly && removeReadOnlyRanges(doc, change.from, change.to);\n    if (split) {\n      for (var i = split.length - 1; i >= 0; --i)\n        { makeChangeInner(doc, {from: split[i].from, to: split[i].to, text: i ? [\"\"] : change.text, origin: change.origin}); }\n    } else {\n      makeChangeInner(doc, change);\n    }\n  }\n\n  function makeChangeInner(doc, change) {\n    if (change.text.length == 1 && change.text[0] == \"\" && cmp(change.from, change.to) == 0) { return }\n    var selAfter = computeSelAfterChange(doc, change);\n    addChangeToHistory(doc, change, selAfter, doc.cm ? doc.cm.curOp.id : NaN);\n\n    makeChangeSingleDoc(doc, change, selAfter, stretchSpansOverChange(doc, change));\n    var rebased = [];\n\n    linkedDocs(doc, function (doc, sharedHist) {\n      if (!sharedHist && indexOf(rebased, doc.history) == -1) {\n        rebaseHist(doc.history, change);\n        rebased.push(doc.history);\n      }\n      makeChangeSingleDoc(doc, change, null, stretchSpansOverChange(doc, change));\n    });\n  }\n\n  // Revert a change stored in a document's history.\n  function makeChangeFromHistory(doc, type, allowSelectionOnly) {\n    var suppress = doc.cm && doc.cm.state.suppressEdits;\n    if (suppress && !allowSelectionOnly) { return }\n\n    var hist = doc.history, event, selAfter = doc.sel;\n    var source = type == \"undo\" ? hist.done : hist.undone, dest = type == \"undo\" ? hist.undone : hist.done;\n\n    // Verify that there is a useable event (so that ctrl-z won't\n    // needlessly clear selection events)\n    var i = 0;\n    for (; i < source.length; i++) {\n      event = source[i];\n      if (allowSelectionOnly ? event.ranges && !event.equals(doc.sel) : !event.ranges)\n        { break }\n    }\n    if (i == source.length) { return }\n    hist.lastOrigin = hist.lastSelOrigin = null;\n\n    for (;;) {\n      event = source.pop();\n      if (event.ranges) {\n        pushSelectionToHistory(event, dest);\n        if (allowSelectionOnly && !event.equals(doc.sel)) {\n          setSelection(doc, event, {clearRedo: false});\n          return\n        }\n        selAfter = event;\n      } else if (suppress) {\n        source.push(event);\n        return\n      } else { break }\n    }\n\n    // Build up a reverse change object to add to the opposite history\n    // stack (redo when undoing, and vice versa).\n    var antiChanges = [];\n    pushSelectionToHistory(selAfter, dest);\n    dest.push({changes: antiChanges, generation: hist.generation});\n    hist.generation = event.generation || ++hist.maxGeneration;\n\n    var filter = hasHandler(doc, \"beforeChange\") || doc.cm && hasHandler(doc.cm, \"beforeChange\");\n\n    var loop = function ( i ) {\n      var change = event.changes[i];\n      change.origin = type;\n      if (filter && !filterChange(doc, change, false)) {\n        source.length = 0;\n        return {}\n      }\n\n      antiChanges.push(historyChangeFromChange(doc, change));\n\n      var after = i ? computeSelAfterChange(doc, change) : lst(source);\n      makeChangeSingleDoc(doc, change, after, mergeOldSpans(doc, change));\n      if (!i && doc.cm) { doc.cm.scrollIntoView({from: change.from, to: changeEnd(change)}); }\n      var rebased = [];\n\n      // Propagate to the linked documents\n      linkedDocs(doc, function (doc, sharedHist) {\n        if (!sharedHist && indexOf(rebased, doc.history) == -1) {\n          rebaseHist(doc.history, change);\n          rebased.push(doc.history);\n        }\n        makeChangeSingleDoc(doc, change, null, mergeOldSpans(doc, change));\n      });\n    };\n\n    for (var i$1 = event.changes.length - 1; i$1 >= 0; --i$1) {\n      var returned = loop( i$1 );\n\n      if ( returned ) return returned.v;\n    }\n  }\n\n  // Sub-views need their line numbers shifted when text is added\n  // above or below them in the parent document.\n  function shiftDoc(doc, distance) {\n    if (distance == 0) { return }\n    doc.first += distance;\n    doc.sel = new Selection(map(doc.sel.ranges, function (range) { return new Range(\n      Pos(range.anchor.line + distance, range.anchor.ch),\n      Pos(range.head.line + distance, range.head.ch)\n    ); }), doc.sel.primIndex);\n    if (doc.cm) {\n      regChange(doc.cm, doc.first, doc.first - distance, distance);\n      for (var d = doc.cm.display, l = d.viewFrom; l < d.viewTo; l++)\n        { regLineChange(doc.cm, l, \"gutter\"); }\n    }\n  }\n\n  // More lower-level change function, handling only a single document\n  // (not linked ones).\n  function makeChangeSingleDoc(doc, change, selAfter, spans) {\n    if (doc.cm && !doc.cm.curOp)\n      { return operation(doc.cm, makeChangeSingleDoc)(doc, change, selAfter, spans) }\n\n    if (change.to.line < doc.first) {\n      shiftDoc(doc, change.text.length - 1 - (change.to.line - change.from.line));\n      return\n    }\n    if (change.from.line > doc.lastLine()) { return }\n\n    // Clip the change to the size of this doc\n    if (change.from.line < doc.first) {\n      var shift = change.text.length - 1 - (doc.first - change.from.line);\n      shiftDoc(doc, shift);\n      change = {from: Pos(doc.first, 0), to: Pos(change.to.line + shift, change.to.ch),\n                text: [lst(change.text)], origin: change.origin};\n    }\n    var last = doc.lastLine();\n    if (change.to.line > last) {\n      change = {from: change.from, to: Pos(last, getLine(doc, last).text.length),\n                text: [change.text[0]], origin: change.origin};\n    }\n\n    change.removed = getBetween(doc, change.from, change.to);\n\n    if (!selAfter) { selAfter = computeSelAfterChange(doc, change); }\n    if (doc.cm) { makeChangeSingleDocInEditor(doc.cm, change, spans); }\n    else { updateDoc(doc, change, spans); }\n    setSelectionNoUndo(doc, selAfter, sel_dontScroll);\n  }\n\n  // Handle the interaction of a change to a document with the editor\n  // that this document is part of.\n  function makeChangeSingleDocInEditor(cm, change, spans) {\n    var doc = cm.doc, display = cm.display, from = change.from, to = change.to;\n\n    var recomputeMaxLength = false, checkWidthStart = from.line;\n    if (!cm.options.lineWrapping) {\n      checkWidthStart = lineNo(visualLine(getLine(doc, from.line)));\n      doc.iter(checkWidthStart, to.line + 1, function (line) {\n        if (line == display.maxLine) {\n          recomputeMaxLength = true;\n          return true\n        }\n      });\n    }\n\n    if (doc.sel.contains(change.from, change.to) > -1)\n      { signalCursorActivity(cm); }\n\n    updateDoc(doc, change, spans, estimateHeight(cm));\n\n    if (!cm.options.lineWrapping) {\n      doc.iter(checkWidthStart, from.line + change.text.length, function (line) {\n        var len = lineLength(line);\n        if (len > display.maxLineLength) {\n          display.maxLine = line;\n          display.maxLineLength = len;\n          display.maxLineChanged = true;\n          recomputeMaxLength = false;\n        }\n      });\n      if (recomputeMaxLength) { cm.curOp.updateMaxLine = true; }\n    }\n\n    retreatFrontier(doc, from.line);\n    startWorker(cm, 400);\n\n    var lendiff = change.text.length - (to.line - from.line) - 1;\n    // Remember that these lines changed, for updating the display\n    if (change.full)\n      { regChange(cm); }\n    else if (from.line == to.line && change.text.length == 1 && !isWholeLineUpdate(cm.doc, change))\n      { regLineChange(cm, from.line, \"text\"); }\n    else\n      { regChange(cm, from.line, to.line + 1, lendiff); }\n\n    var changesHandler = hasHandler(cm, \"changes\"), changeHandler = hasHandler(cm, \"change\");\n    if (changeHandler || changesHandler) {\n      var obj = {\n        from: from, to: to,\n        text: change.text,\n        removed: change.removed,\n        origin: change.origin\n      };\n      if (changeHandler) { signalLater(cm, \"change\", cm, obj); }\n      if (changesHandler) { (cm.curOp.changeObjs || (cm.curOp.changeObjs = [])).push(obj); }\n    }\n    cm.display.selForContextMenu = null;\n  }\n\n  function replaceRange(doc, code, from, to, origin) {\n    var assign;\n\n    if (!to) { to = from; }\n    if (cmp(to, from) < 0) { (assign = [to, from], from = assign[0], to = assign[1]); }\n    if (typeof code == \"string\") { code = doc.splitLines(code); }\n    makeChange(doc, {from: from, to: to, text: code, origin: origin});\n  }\n\n  // Rebasing/resetting history to deal with externally-sourced changes\n\n  function rebaseHistSelSingle(pos, from, to, diff) {\n    if (to < pos.line) {\n      pos.line += diff;\n    } else if (from < pos.line) {\n      pos.line = from;\n      pos.ch = 0;\n    }\n  }\n\n  // Tries to rebase an array of history events given a change in the\n  // document. If the change touches the same lines as the event, the\n  // event, and everything 'behind' it, is discarded. If the change is\n  // before the event, the event's positions are updated. Uses a\n  // copy-on-write scheme for the positions, to avoid having to\n  // reallocate them all on every rebase, but also avoid problems with\n  // shared position objects being unsafely updated.\n  function rebaseHistArray(array, from, to, diff) {\n    for (var i = 0; i < array.length; ++i) {\n      var sub = array[i], ok = true;\n      if (sub.ranges) {\n        if (!sub.copied) { sub = array[i] = sub.deepCopy(); sub.copied = true; }\n        for (var j = 0; j < sub.ranges.length; j++) {\n          rebaseHistSelSingle(sub.ranges[j].anchor, from, to, diff);\n          rebaseHistSelSingle(sub.ranges[j].head, from, to, diff);\n        }\n        continue\n      }\n      for (var j$1 = 0; j$1 < sub.changes.length; ++j$1) {\n        var cur = sub.changes[j$1];\n        if (to < cur.from.line) {\n          cur.from = Pos(cur.from.line + diff, cur.from.ch);\n          cur.to = Pos(cur.to.line + diff, cur.to.ch);\n        } else if (from <= cur.to.line) {\n          ok = false;\n          break\n        }\n      }\n      if (!ok) {\n        array.splice(0, i + 1);\n        i = 0;\n      }\n    }\n  }\n\n  function rebaseHist(hist, change) {\n    var from = change.from.line, to = change.to.line, diff = change.text.length - (to - from) - 1;\n    rebaseHistArray(hist.done, from, to, diff);\n    rebaseHistArray(hist.undone, from, to, diff);\n  }\n\n  // Utility for applying a change to a line by handle or number,\n  // returning the number and optionally registering the line as\n  // changed.\n  function changeLine(doc, handle, changeType, op) {\n    var no = handle, line = handle;\n    if (typeof handle == \"number\") { line = getLine(doc, clipLine(doc, handle)); }\n    else { no = lineNo(handle); }\n    if (no == null) { return null }\n    if (op(line, no) && doc.cm) { regLineChange(doc.cm, no, changeType); }\n    return line\n  }\n\n  // The document is represented as a BTree consisting of leaves, with\n  // chunk of lines in them, and branches, with up to ten leaves or\n  // other branch nodes below them. The top node is always a branch\n  // node, and is the document object itself (meaning it has\n  // additional methods and properties).\n  //\n  // All nodes have parent links. The tree is used both to go from\n  // line numbers to line objects, and to go from objects to numbers.\n  // It also indexes by height, and is used to convert between height\n  // and line object, and to find the total height of the document.\n  //\n  // See also http://marijnhaverbeke.nl/blog/codemirror-line-tree.html\n\n  function LeafChunk(lines) {\n    var this$1 = this;\n\n    this.lines = lines;\n    this.parent = null;\n    var height = 0;\n    for (var i = 0; i < lines.length; ++i) {\n      lines[i].parent = this$1;\n      height += lines[i].height;\n    }\n    this.height = height;\n  }\n\n  LeafChunk.prototype = {\n    chunkSize: function() { return this.lines.length },\n\n    // Remove the n lines at offset 'at'.\n    removeInner: function(at, n) {\n      var this$1 = this;\n\n      for (var i = at, e = at + n; i < e; ++i) {\n        var line = this$1.lines[i];\n        this$1.height -= line.height;\n        cleanUpLine(line);\n        signalLater(line, \"delete\");\n      }\n      this.lines.splice(at, n);\n    },\n\n    // Helper used to collapse a small branch into a single leaf.\n    collapse: function(lines) {\n      lines.push.apply(lines, this.lines);\n    },\n\n    // Insert the given array of lines at offset 'at', count them as\n    // having the given height.\n    insertInner: function(at, lines, height) {\n      var this$1 = this;\n\n      this.height += height;\n      this.lines = this.lines.slice(0, at).concat(lines).concat(this.lines.slice(at));\n      for (var i = 0; i < lines.length; ++i) { lines[i].parent = this$1; }\n    },\n\n    // Used to iterate over a part of the tree.\n    iterN: function(at, n, op) {\n      var this$1 = this;\n\n      for (var e = at + n; at < e; ++at)\n        { if (op(this$1.lines[at])) { return true } }\n    }\n  };\n\n  function BranchChunk(children) {\n    var this$1 = this;\n\n    this.children = children;\n    var size = 0, height = 0;\n    for (var i = 0; i < children.length; ++i) {\n      var ch = children[i];\n      size += ch.chunkSize(); height += ch.height;\n      ch.parent = this$1;\n    }\n    this.size = size;\n    this.height = height;\n    this.parent = null;\n  }\n\n  BranchChunk.prototype = {\n    chunkSize: function() { return this.size },\n\n    removeInner: function(at, n) {\n      var this$1 = this;\n\n      this.size -= n;\n      for (var i = 0; i < this.children.length; ++i) {\n        var child = this$1.children[i], sz = child.chunkSize();\n        if (at < sz) {\n          var rm = Math.min(n, sz - at), oldHeight = child.height;\n          child.removeInner(at, rm);\n          this$1.height -= oldHeight - child.height;\n          if (sz == rm) { this$1.children.splice(i--, 1); child.parent = null; }\n          if ((n -= rm) == 0) { break }\n          at = 0;\n        } else { at -= sz; }\n      }\n      // If the result is smaller than 25 lines, ensure that it is a\n      // single leaf node.\n      if (this.size - n < 25 &&\n          (this.children.length > 1 || !(this.children[0] instanceof LeafChunk))) {\n        var lines = [];\n        this.collapse(lines);\n        this.children = [new LeafChunk(lines)];\n        this.children[0].parent = this;\n      }\n    },\n\n    collapse: function(lines) {\n      var this$1 = this;\n\n      for (var i = 0; i < this.children.length; ++i) { this$1.children[i].collapse(lines); }\n    },\n\n    insertInner: function(at, lines, height) {\n      var this$1 = this;\n\n      this.size += lines.length;\n      this.height += height;\n      for (var i = 0; i < this.children.length; ++i) {\n        var child = this$1.children[i], sz = child.chunkSize();\n        if (at <= sz) {\n          child.insertInner(at, lines, height);\n          if (child.lines && child.lines.length > 50) {\n            // To avoid memory thrashing when child.lines is huge (e.g. first view of a large file), it's never spliced.\n            // Instead, small slices are taken. They're taken in order because sequential memory accesses are fastest.\n            var remaining = child.lines.length % 25 + 25;\n            for (var pos = remaining; pos < child.lines.length;) {\n              var leaf = new LeafChunk(child.lines.slice(pos, pos += 25));\n              child.height -= leaf.height;\n              this$1.children.splice(++i, 0, leaf);\n              leaf.parent = this$1;\n            }\n            child.lines = child.lines.slice(0, remaining);\n            this$1.maybeSpill();\n          }\n          break\n        }\n        at -= sz;\n      }\n    },\n\n    // When a node has grown, check whether it should be split.\n    maybeSpill: function() {\n      if (this.children.length <= 10) { return }\n      var me = this;\n      do {\n        var spilled = me.children.splice(me.children.length - 5, 5);\n        var sibling = new BranchChunk(spilled);\n        if (!me.parent) { // Become the parent node\n          var copy = new BranchChunk(me.children);\n          copy.parent = me;\n          me.children = [copy, sibling];\n          me = copy;\n       } else {\n          me.size -= sibling.size;\n          me.height -= sibling.height;\n          var myIndex = indexOf(me.parent.children, me);\n          me.parent.children.splice(myIndex + 1, 0, sibling);\n        }\n        sibling.parent = me.parent;\n      } while (me.children.length > 10)\n      me.parent.maybeSpill();\n    },\n\n    iterN: function(at, n, op) {\n      var this$1 = this;\n\n      for (var i = 0; i < this.children.length; ++i) {\n        var child = this$1.children[i], sz = child.chunkSize();\n        if (at < sz) {\n          var used = Math.min(n, sz - at);\n          if (child.iterN(at, used, op)) { return true }\n          if ((n -= used) == 0) { break }\n          at = 0;\n        } else { at -= sz; }\n      }\n    }\n  };\n\n  // Line widgets are block elements displayed above or below a line.\n\n  var LineWidget = function(doc, node, options) {\n    var this$1 = this;\n\n    if (options) { for (var opt in options) { if (options.hasOwnProperty(opt))\n      { this$1[opt] = options[opt]; } } }\n    this.doc = doc;\n    this.node = node;\n  };\n\n  LineWidget.prototype.clear = function () {\n      var this$1 = this;\n\n    var cm = this.doc.cm, ws = this.line.widgets, line = this.line, no = lineNo(line);\n    if (no == null || !ws) { return }\n    for (var i = 0; i < ws.length; ++i) { if (ws[i] == this$1) { ws.splice(i--, 1); } }\n    if (!ws.length) { line.widgets = null; }\n    var height = widgetHeight(this);\n    updateLineHeight(line, Math.max(0, line.height - height));\n    if (cm) {\n      runInOp(cm, function () {\n        adjustScrollWhenAboveVisible(cm, line, -height);\n        regLineChange(cm, no, \"widget\");\n      });\n      signalLater(cm, \"lineWidgetCleared\", cm, this, no);\n    }\n  };\n\n  LineWidget.prototype.changed = function () {\n      var this$1 = this;\n\n    var oldH = this.height, cm = this.doc.cm, line = this.line;\n    this.height = null;\n    var diff = widgetHeight(this) - oldH;\n    if (!diff) { return }\n    if (!lineIsHidden(this.doc, line)) { updateLineHeight(line, line.height + diff); }\n    if (cm) {\n      runInOp(cm, function () {\n        cm.curOp.forceUpdate = true;\n        adjustScrollWhenAboveVisible(cm, line, diff);\n        signalLater(cm, \"lineWidgetChanged\", cm, this$1, lineNo(line));\n      });\n    }\n  };\n  eventMixin(LineWidget);\n\n  function adjustScrollWhenAboveVisible(cm, line, diff) {\n    if (heightAtLine(line) < ((cm.curOp && cm.curOp.scrollTop) || cm.doc.scrollTop))\n      { addToScrollTop(cm, diff); }\n  }\n\n  function addLineWidget(doc, handle, node, options) {\n    var widget = new LineWidget(doc, node, options);\n    var cm = doc.cm;\n    if (cm && widget.noHScroll) { cm.display.alignWidgets = true; }\n    changeLine(doc, handle, \"widget\", function (line) {\n      var widgets = line.widgets || (line.widgets = []);\n      if (widget.insertAt == null) { widgets.push(widget); }\n      else { widgets.splice(Math.min(widgets.length - 1, Math.max(0, widget.insertAt)), 0, widget); }\n      widget.line = line;\n      if (cm && !lineIsHidden(doc, line)) {\n        var aboveVisible = heightAtLine(line) < doc.scrollTop;\n        updateLineHeight(line, line.height + widgetHeight(widget));\n        if (aboveVisible) { addToScrollTop(cm, widget.height); }\n        cm.curOp.forceUpdate = true;\n      }\n      return true\n    });\n    if (cm) { signalLater(cm, \"lineWidgetAdded\", cm, widget, typeof handle == \"number\" ? handle : lineNo(handle)); }\n    return widget\n  }\n\n  // TEXTMARKERS\n\n  // Created with markText and setBookmark methods. A TextMarker is a\n  // handle that can be used to clear or find a marked position in the\n  // document. Line objects hold arrays (markedSpans) containing\n  // {from, to, marker} object pointing to such marker objects, and\n  // indicating that such a marker is present on that line. Multiple\n  // lines may point to the same marker when it spans across lines.\n  // The spans will have null for their from/to properties when the\n  // marker continues beyond the start/end of the line. Markers have\n  // links back to the lines they currently touch.\n\n  // Collapsed markers have unique ids, in order to be able to order\n  // them, which is needed for uniquely determining an outer marker\n  // when they overlap (they may nest, but not partially overlap).\n  var nextMarkerId = 0;\n\n  var TextMarker = function(doc, type) {\n    this.lines = [];\n    this.type = type;\n    this.doc = doc;\n    this.id = ++nextMarkerId;\n  };\n\n  // Clear the marker.\n  TextMarker.prototype.clear = function () {\n      var this$1 = this;\n\n    if (this.explicitlyCleared) { return }\n    var cm = this.doc.cm, withOp = cm && !cm.curOp;\n    if (withOp) { startOperation(cm); }\n    if (hasHandler(this, \"clear\")) {\n      var found = this.find();\n      if (found) { signalLater(this, \"clear\", found.from, found.to); }\n    }\n    var min = null, max = null;\n    for (var i = 0; i < this.lines.length; ++i) {\n      var line = this$1.lines[i];\n      var span = getMarkedSpanFor(line.markedSpans, this$1);\n      if (cm && !this$1.collapsed) { regLineChange(cm, lineNo(line), \"text\"); }\n      else if (cm) {\n        if (span.to != null) { max = lineNo(line); }\n        if (span.from != null) { min = lineNo(line); }\n      }\n      line.markedSpans = removeMarkedSpan(line.markedSpans, span);\n      if (span.from == null && this$1.collapsed && !lineIsHidden(this$1.doc, line) && cm)\n        { updateLineHeight(line, textHeight(cm.display)); }\n    }\n    if (cm && this.collapsed && !cm.options.lineWrapping) { for (var i$1 = 0; i$1 < this.lines.length; ++i$1) {\n      var visual = visualLine(this$1.lines[i$1]), len = lineLength(visual);\n      if (len > cm.display.maxLineLength) {\n        cm.display.maxLine = visual;\n        cm.display.maxLineLength = len;\n        cm.display.maxLineChanged = true;\n      }\n    } }\n\n    if (min != null && cm && this.collapsed) { regChange(cm, min, max + 1); }\n    this.lines.length = 0;\n    this.explicitlyCleared = true;\n    if (this.atomic && this.doc.cantEdit) {\n      this.doc.cantEdit = false;\n      if (cm) { reCheckSelection(cm.doc); }\n    }\n    if (cm) { signalLater(cm, \"markerCleared\", cm, this, min, max); }\n    if (withOp) { endOperation(cm); }\n    if (this.parent) { this.parent.clear(); }\n  };\n\n  // Find the position of the marker in the document. Returns a {from,\n  // to} object by default. Side can be passed to get a specific side\n  // -- 0 (both), -1 (left), or 1 (right). When lineObj is true, the\n  // Pos objects returned contain a line object, rather than a line\n  // number (used to prevent looking up the same line twice).\n  TextMarker.prototype.find = function (side, lineObj) {\n      var this$1 = this;\n\n    if (side == null && this.type == \"bookmark\") { side = 1; }\n    var from, to;\n    for (var i = 0; i < this.lines.length; ++i) {\n      var line = this$1.lines[i];\n      var span = getMarkedSpanFor(line.markedSpans, this$1);\n      if (span.from != null) {\n        from = Pos(lineObj ? line : lineNo(line), span.from);\n        if (side == -1) { return from }\n      }\n      if (span.to != null) {\n        to = Pos(lineObj ? line : lineNo(line), span.to);\n        if (side == 1) { return to }\n      }\n    }\n    return from && {from: from, to: to}\n  };\n\n  // Signals that the marker's widget changed, and surrounding layout\n  // should be recomputed.\n  TextMarker.prototype.changed = function () {\n      var this$1 = this;\n\n    var pos = this.find(-1, true), widget = this, cm = this.doc.cm;\n    if (!pos || !cm) { return }\n    runInOp(cm, function () {\n      var line = pos.line, lineN = lineNo(pos.line);\n      var view = findViewForLine(cm, lineN);\n      if (view) {\n        clearLineMeasurementCacheFor(view);\n        cm.curOp.selectionChanged = cm.curOp.forceUpdate = true;\n      }\n      cm.curOp.updateMaxLine = true;\n      if (!lineIsHidden(widget.doc, line) && widget.height != null) {\n        var oldHeight = widget.height;\n        widget.height = null;\n        var dHeight = widgetHeight(widget) - oldHeight;\n        if (dHeight)\n          { updateLineHeight(line, line.height + dHeight); }\n      }\n      signalLater(cm, \"markerChanged\", cm, this$1);\n    });\n  };\n\n  TextMarker.prototype.attachLine = function (line) {\n    if (!this.lines.length && this.doc.cm) {\n      var op = this.doc.cm.curOp;\n      if (!op.maybeHiddenMarkers || indexOf(op.maybeHiddenMarkers, this) == -1)\n        { (op.maybeUnhiddenMarkers || (op.maybeUnhiddenMarkers = [])).push(this); }\n    }\n    this.lines.push(line);\n  };\n\n  TextMarker.prototype.detachLine = function (line) {\n    this.lines.splice(indexOf(this.lines, line), 1);\n    if (!this.lines.length && this.doc.cm) {\n      var op = this.doc.cm.curOp\n      ;(op.maybeHiddenMarkers || (op.maybeHiddenMarkers = [])).push(this);\n    }\n  };\n  eventMixin(TextMarker);\n\n  // Create a marker, wire it up to the right lines, and\n  function markText(doc, from, to, options, type) {\n    // Shared markers (across linked documents) are handled separately\n    // (markTextShared will call out to this again, once per\n    // document).\n    if (options && options.shared) { return markTextShared(doc, from, to, options, type) }\n    // Ensure we are in an operation.\n    if (doc.cm && !doc.cm.curOp) { return operation(doc.cm, markText)(doc, from, to, options, type) }\n\n    var marker = new TextMarker(doc, type), diff = cmp(from, to);\n    if (options) { copyObj(options, marker, false); }\n    // Don't connect empty markers unless clearWhenEmpty is false\n    if (diff > 0 || diff == 0 && marker.clearWhenEmpty !== false)\n      { return marker }\n    if (marker.replacedWith) {\n      // Showing up as a widget implies collapsed (widget replaces text)\n      marker.collapsed = true;\n      marker.widgetNode = eltP(\"span\", [marker.replacedWith], \"CodeMirror-widget\");\n      if (!options.handleMouseEvents) { marker.widgetNode.setAttribute(\"cm-ignore-events\", \"true\"); }\n      if (options.insertLeft) { marker.widgetNode.insertLeft = true; }\n    }\n    if (marker.collapsed) {\n      if (conflictingCollapsedRange(doc, from.line, from, to, marker) ||\n          from.line != to.line && conflictingCollapsedRange(doc, to.line, from, to, marker))\n        { throw new Error(\"Inserting collapsed marker partially overlapping an existing one\") }\n      seeCollapsedSpans();\n    }\n\n    if (marker.addToHistory)\n      { addChangeToHistory(doc, {from: from, to: to, origin: \"markText\"}, doc.sel, NaN); }\n\n    var curLine = from.line, cm = doc.cm, updateMaxLine;\n    doc.iter(curLine, to.line + 1, function (line) {\n      if (cm && marker.collapsed && !cm.options.lineWrapping && visualLine(line) == cm.display.maxLine)\n        { updateMaxLine = true; }\n      if (marker.collapsed && curLine != from.line) { updateLineHeight(line, 0); }\n      addMarkedSpan(line, new MarkedSpan(marker,\n                                         curLine == from.line ? from.ch : null,\n                                         curLine == to.line ? to.ch : null));\n      ++curLine;\n    });\n    // lineIsHidden depends on the presence of the spans, so needs a second pass\n    if (marker.collapsed) { doc.iter(from.line, to.line + 1, function (line) {\n      if (lineIsHidden(doc, line)) { updateLineHeight(line, 0); }\n    }); }\n\n    if (marker.clearOnEnter) { on(marker, \"beforeCursorEnter\", function () { return marker.clear(); }); }\n\n    if (marker.readOnly) {\n      seeReadOnlySpans();\n      if (doc.history.done.length || doc.history.undone.length)\n        { doc.clearHistory(); }\n    }\n    if (marker.collapsed) {\n      marker.id = ++nextMarkerId;\n      marker.atomic = true;\n    }\n    if (cm) {\n      // Sync editor state\n      if (updateMaxLine) { cm.curOp.updateMaxLine = true; }\n      if (marker.collapsed)\n        { regChange(cm, from.line, to.line + 1); }\n      else if (marker.className || marker.startStyle || marker.endStyle || marker.css ||\n               marker.attributes || marker.title)\n        { for (var i = from.line; i <= to.line; i++) { regLineChange(cm, i, \"text\"); } }\n      if (marker.atomic) { reCheckSelection(cm.doc); }\n      signalLater(cm, \"markerAdded\", cm, marker);\n    }\n    return marker\n  }\n\n  // SHARED TEXTMARKERS\n\n  // A shared marker spans multiple linked documents. It is\n  // implemented as a meta-marker-object controlling multiple normal\n  // markers.\n  var SharedTextMarker = function(markers, primary) {\n    var this$1 = this;\n\n    this.markers = markers;\n    this.primary = primary;\n    for (var i = 0; i < markers.length; ++i)\n      { markers[i].parent = this$1; }\n  };\n\n  SharedTextMarker.prototype.clear = function () {\n      var this$1 = this;\n\n    if (this.explicitlyCleared) { return }\n    this.explicitlyCleared = true;\n    for (var i = 0; i < this.markers.length; ++i)\n      { this$1.markers[i].clear(); }\n    signalLater(this, \"clear\");\n  };\n\n  SharedTextMarker.prototype.find = function (side, lineObj) {\n    return this.primary.find(side, lineObj)\n  };\n  eventMixin(SharedTextMarker);\n\n  function markTextShared(doc, from, to, options, type) {\n    options = copyObj(options);\n    options.shared = false;\n    var markers = [markText(doc, from, to, options, type)], primary = markers[0];\n    var widget = options.widgetNode;\n    linkedDocs(doc, function (doc) {\n      if (widget) { options.widgetNode = widget.cloneNode(true); }\n      markers.push(markText(doc, clipPos(doc, from), clipPos(doc, to), options, type));\n      for (var i = 0; i < doc.linked.length; ++i)\n        { if (doc.linked[i].isParent) { return } }\n      primary = lst(markers);\n    });\n    return new SharedTextMarker(markers, primary)\n  }\n\n  function findSharedMarkers(doc) {\n    return doc.findMarks(Pos(doc.first, 0), doc.clipPos(Pos(doc.lastLine())), function (m) { return m.parent; })\n  }\n\n  function copySharedMarkers(doc, markers) {\n    for (var i = 0; i < markers.length; i++) {\n      var marker = markers[i], pos = marker.find();\n      var mFrom = doc.clipPos(pos.from), mTo = doc.clipPos(pos.to);\n      if (cmp(mFrom, mTo)) {\n        var subMark = markText(doc, mFrom, mTo, marker.primary, marker.primary.type);\n        marker.markers.push(subMark);\n        subMark.parent = marker;\n      }\n    }\n  }\n\n  function detachSharedMarkers(markers) {\n    var loop = function ( i ) {\n      var marker = markers[i], linked = [marker.primary.doc];\n      linkedDocs(marker.primary.doc, function (d) { return linked.push(d); });\n      for (var j = 0; j < marker.markers.length; j++) {\n        var subMarker = marker.markers[j];\n        if (indexOf(linked, subMarker.doc) == -1) {\n          subMarker.parent = null;\n          marker.markers.splice(j--, 1);\n        }\n      }\n    };\n\n    for (var i = 0; i < markers.length; i++) loop( i );\n  }\n\n  var nextDocId = 0;\n  var Doc = function(text, mode, firstLine, lineSep, direction) {\n    if (!(this instanceof Doc)) { return new Doc(text, mode, firstLine, lineSep, direction) }\n    if (firstLine == null) { firstLine = 0; }\n\n    BranchChunk.call(this, [new LeafChunk([new Line(\"\", null)])]);\n    this.first = firstLine;\n    this.scrollTop = this.scrollLeft = 0;\n    this.cantEdit = false;\n    this.cleanGeneration = 1;\n    this.modeFrontier = this.highlightFrontier = firstLine;\n    var start = Pos(firstLine, 0);\n    this.sel = simpleSelection(start);\n    this.history = new History(null);\n    this.id = ++nextDocId;\n    this.modeOption = mode;\n    this.lineSep = lineSep;\n    this.direction = (direction == \"rtl\") ? \"rtl\" : \"ltr\";\n    this.extend = false;\n\n    if (typeof text == \"string\") { text = this.splitLines(text); }\n    updateDoc(this, {from: start, to: start, text: text});\n    setSelection(this, simpleSelection(start), sel_dontScroll);\n  };\n\n  Doc.prototype = createObj(BranchChunk.prototype, {\n    constructor: Doc,\n    // Iterate over the document. Supports two forms -- with only one\n    // argument, it calls that for each line in the document. With\n    // three, it iterates over the range given by the first two (with\n    // the second being non-inclusive).\n    iter: function(from, to, op) {\n      if (op) { this.iterN(from - this.first, to - from, op); }\n      else { this.iterN(this.first, this.first + this.size, from); }\n    },\n\n    // Non-public interface for adding and removing lines.\n    insert: function(at, lines) {\n      var height = 0;\n      for (var i = 0; i < lines.length; ++i) { height += lines[i].height; }\n      this.insertInner(at - this.first, lines, height);\n    },\n    remove: function(at, n) { this.removeInner(at - this.first, n); },\n\n    // From here, the methods are part of the public interface. Most\n    // are also available from CodeMirror (editor) instances.\n\n    getValue: function(lineSep) {\n      var lines = getLines(this, this.first, this.first + this.size);\n      if (lineSep === false) { return lines }\n      return lines.join(lineSep || this.lineSeparator())\n    },\n    setValue: docMethodOp(function(code) {\n      var top = Pos(this.first, 0), last = this.first + this.size - 1;\n      makeChange(this, {from: top, to: Pos(last, getLine(this, last).text.length),\n                        text: this.splitLines(code), origin: \"setValue\", full: true}, true);\n      if (this.cm) { scrollToCoords(this.cm, 0, 0); }\n      setSelection(this, simpleSelection(top), sel_dontScroll);\n    }),\n    replaceRange: function(code, from, to, origin) {\n      from = clipPos(this, from);\n      to = to ? clipPos(this, to) : from;\n      replaceRange(this, code, from, to, origin);\n    },\n    getRange: function(from, to, lineSep) {\n      var lines = getBetween(this, clipPos(this, from), clipPos(this, to));\n      if (lineSep === false) { return lines }\n      return lines.join(lineSep || this.lineSeparator())\n    },\n\n    getLine: function(line) {var l = this.getLineHandle(line); return l && l.text},\n\n    getLineHandle: function(line) {if (isLine(this, line)) { return getLine(this, line) }},\n    getLineNumber: function(line) {return lineNo(line)},\n\n    getLineHandleVisualStart: function(line) {\n      if (typeof line == \"number\") { line = getLine(this, line); }\n      return visualLine(line)\n    },\n\n    lineCount: function() {return this.size},\n    firstLine: function() {return this.first},\n    lastLine: function() {return this.first + this.size - 1},\n\n    clipPos: function(pos) {return clipPos(this, pos)},\n\n    getCursor: function(start) {\n      var range$$1 = this.sel.primary(), pos;\n      if (start == null || start == \"head\") { pos = range$$1.head; }\n      else if (start == \"anchor\") { pos = range$$1.anchor; }\n      else if (start == \"end\" || start == \"to\" || start === false) { pos = range$$1.to(); }\n      else { pos = range$$1.from(); }\n      return pos\n    },\n    listSelections: function() { return this.sel.ranges },\n    somethingSelected: function() {return this.sel.somethingSelected()},\n\n    setCursor: docMethodOp(function(line, ch, options) {\n      setSimpleSelection(this, clipPos(this, typeof line == \"number\" ? Pos(line, ch || 0) : line), null, options);\n    }),\n    setSelection: docMethodOp(function(anchor, head, options) {\n      setSimpleSelection(this, clipPos(this, anchor), clipPos(this, head || anchor), options);\n    }),\n    extendSelection: docMethodOp(function(head, other, options) {\n      extendSelection(this, clipPos(this, head), other && clipPos(this, other), options);\n    }),\n    extendSelections: docMethodOp(function(heads, options) {\n      extendSelections(this, clipPosArray(this, heads), options);\n    }),\n    extendSelectionsBy: docMethodOp(function(f, options) {\n      var heads = map(this.sel.ranges, f);\n      extendSelections(this, clipPosArray(this, heads), options);\n    }),\n    setSelections: docMethodOp(function(ranges, primary, options) {\n      var this$1 = this;\n\n      if (!ranges.length) { return }\n      var out = [];\n      for (var i = 0; i < ranges.length; i++)\n        { out[i] = new Range(clipPos(this$1, ranges[i].anchor),\n                           clipPos(this$1, ranges[i].head)); }\n      if (primary == null) { primary = Math.min(ranges.length - 1, this.sel.primIndex); }\n      setSelection(this, normalizeSelection(this.cm, out, primary), options);\n    }),\n    addSelection: docMethodOp(function(anchor, head, options) {\n      var ranges = this.sel.ranges.slice(0);\n      ranges.push(new Range(clipPos(this, anchor), clipPos(this, head || anchor)));\n      setSelection(this, normalizeSelection(this.cm, ranges, ranges.length - 1), options);\n    }),\n\n    getSelection: function(lineSep) {\n      var this$1 = this;\n\n      var ranges = this.sel.ranges, lines;\n      for (var i = 0; i < ranges.length; i++) {\n        var sel = getBetween(this$1, ranges[i].from(), ranges[i].to());\n        lines = lines ? lines.concat(sel) : sel;\n      }\n      if (lineSep === false) { return lines }\n      else { return lines.join(lineSep || this.lineSeparator()) }\n    },\n    getSelections: function(lineSep) {\n      var this$1 = this;\n\n      var parts = [], ranges = this.sel.ranges;\n      for (var i = 0; i < ranges.length; i++) {\n        var sel = getBetween(this$1, ranges[i].from(), ranges[i].to());\n        if (lineSep !== false) { sel = sel.join(lineSep || this$1.lineSeparator()); }\n        parts[i] = sel;\n      }\n      return parts\n    },\n    replaceSelection: function(code, collapse, origin) {\n      var dup = [];\n      for (var i = 0; i < this.sel.ranges.length; i++)\n        { dup[i] = code; }\n      this.replaceSelections(dup, collapse, origin || \"+input\");\n    },\n    replaceSelections: docMethodOp(function(code, collapse, origin) {\n      var this$1 = this;\n\n      var changes = [], sel = this.sel;\n      for (var i = 0; i < sel.ranges.length; i++) {\n        var range$$1 = sel.ranges[i];\n        changes[i] = {from: range$$1.from(), to: range$$1.to(), text: this$1.splitLines(code[i]), origin: origin};\n      }\n      var newSel = collapse && collapse != \"end\" && computeReplacedSel(this, changes, collapse);\n      for (var i$1 = changes.length - 1; i$1 >= 0; i$1--)\n        { makeChange(this$1, changes[i$1]); }\n      if (newSel) { setSelectionReplaceHistory(this, newSel); }\n      else if (this.cm) { ensureCursorVisible(this.cm); }\n    }),\n    undo: docMethodOp(function() {makeChangeFromHistory(this, \"undo\");}),\n    redo: docMethodOp(function() {makeChangeFromHistory(this, \"redo\");}),\n    undoSelection: docMethodOp(function() {makeChangeFromHistory(this, \"undo\", true);}),\n    redoSelection: docMethodOp(function() {makeChangeFromHistory(this, \"redo\", true);}),\n\n    setExtending: function(val) {this.extend = val;},\n    getExtending: function() {return this.extend},\n\n    historySize: function() {\n      var hist = this.history, done = 0, undone = 0;\n      for (var i = 0; i < hist.done.length; i++) { if (!hist.done[i].ranges) { ++done; } }\n      for (var i$1 = 0; i$1 < hist.undone.length; i$1++) { if (!hist.undone[i$1].ranges) { ++undone; } }\n      return {undo: done, redo: undone}\n    },\n    clearHistory: function() {this.history = new History(this.history.maxGeneration);},\n\n    markClean: function() {\n      this.cleanGeneration = this.changeGeneration(true);\n    },\n    changeGeneration: function(forceSplit) {\n      if (forceSplit)\n        { this.history.lastOp = this.history.lastSelOp = this.history.lastOrigin = null; }\n      return this.history.generation\n    },\n    isClean: function (gen) {\n      return this.history.generation == (gen || this.cleanGeneration)\n    },\n\n    getHistory: function() {\n      return {done: copyHistoryArray(this.history.done),\n              undone: copyHistoryArray(this.history.undone)}\n    },\n    setHistory: function(histData) {\n      var hist = this.history = new History(this.history.maxGeneration);\n      hist.done = copyHistoryArray(histData.done.slice(0), null, true);\n      hist.undone = copyHistoryArray(histData.undone.slice(0), null, true);\n    },\n\n    setGutterMarker: docMethodOp(function(line, gutterID, value) {\n      return changeLine(this, line, \"gutter\", function (line) {\n        var markers = line.gutterMarkers || (line.gutterMarkers = {});\n        markers[gutterID] = value;\n        if (!value && isEmpty(markers)) { line.gutterMarkers = null; }\n        return true\n      })\n    }),\n\n    clearGutter: docMethodOp(function(gutterID) {\n      var this$1 = this;\n\n      this.iter(function (line) {\n        if (line.gutterMarkers && line.gutterMarkers[gutterID]) {\n          changeLine(this$1, line, \"gutter\", function () {\n            line.gutterMarkers[gutterID] = null;\n            if (isEmpty(line.gutterMarkers)) { line.gutterMarkers = null; }\n            return true\n          });\n        }\n      });\n    }),\n\n    lineInfo: function(line) {\n      var n;\n      if (typeof line == \"number\") {\n        if (!isLine(this, line)) { return null }\n        n = line;\n        line = getLine(this, line);\n        if (!line) { return null }\n      } else {\n        n = lineNo(line);\n        if (n == null) { return null }\n      }\n      return {line: n, handle: line, text: line.text, gutterMarkers: line.gutterMarkers,\n              textClass: line.textClass, bgClass: line.bgClass, wrapClass: line.wrapClass,\n              widgets: line.widgets}\n    },\n\n    addLineClass: docMethodOp(function(handle, where, cls) {\n      return changeLine(this, handle, where == \"gutter\" ? \"gutter\" : \"class\", function (line) {\n        var prop = where == \"text\" ? \"textClass\"\n                 : where == \"background\" ? \"bgClass\"\n                 : where == \"gutter\" ? \"gutterClass\" : \"wrapClass\";\n        if (!line[prop]) { line[prop] = cls; }\n        else if (classTest(cls).test(line[prop])) { return false }\n        else { line[prop] += \" \" + cls; }\n        return true\n      })\n    }),\n    removeLineClass: docMethodOp(function(handle, where, cls) {\n      return changeLine(this, handle, where == \"gutter\" ? \"gutter\" : \"class\", function (line) {\n        var prop = where == \"text\" ? \"textClass\"\n                 : where == \"background\" ? \"bgClass\"\n                 : where == \"gutter\" ? \"gutterClass\" : \"wrapClass\";\n        var cur = line[prop];\n        if (!cur) { return false }\n        else if (cls == null) { line[prop] = null; }\n        else {\n          var found = cur.match(classTest(cls));\n          if (!found) { return false }\n          var end = found.index + found[0].length;\n          line[prop] = cur.slice(0, found.index) + (!found.index || end == cur.length ? \"\" : \" \") + cur.slice(end) || null;\n        }\n        return true\n      })\n    }),\n\n    addLineWidget: docMethodOp(function(handle, node, options) {\n      return addLineWidget(this, handle, node, options)\n    }),\n    removeLineWidget: function(widget) { widget.clear(); },\n\n    markText: function(from, to, options) {\n      return markText(this, clipPos(this, from), clipPos(this, to), options, options && options.type || \"range\")\n    },\n    setBookmark: function(pos, options) {\n      var realOpts = {replacedWith: options && (options.nodeType == null ? options.widget : options),\n                      insertLeft: options && options.insertLeft,\n                      clearWhenEmpty: false, shared: options && options.shared,\n                      handleMouseEvents: options && options.handleMouseEvents};\n      pos = clipPos(this, pos);\n      return markText(this, pos, pos, realOpts, \"bookmark\")\n    },\n    findMarksAt: function(pos) {\n      pos = clipPos(this, pos);\n      var markers = [], spans = getLine(this, pos.line).markedSpans;\n      if (spans) { for (var i = 0; i < spans.length; ++i) {\n        var span = spans[i];\n        if ((span.from == null || span.from <= pos.ch) &&\n            (span.to == null || span.to >= pos.ch))\n          { markers.push(span.marker.parent || span.marker); }\n      } }\n      return markers\n    },\n    findMarks: function(from, to, filter) {\n      from = clipPos(this, from); to = clipPos(this, to);\n      var found = [], lineNo$$1 = from.line;\n      this.iter(from.line, to.line + 1, function (line) {\n        var spans = line.markedSpans;\n        if (spans) { for (var i = 0; i < spans.length; i++) {\n          var span = spans[i];\n          if (!(span.to != null && lineNo$$1 == from.line && from.ch >= span.to ||\n                span.from == null && lineNo$$1 != from.line ||\n                span.from != null && lineNo$$1 == to.line && span.from >= to.ch) &&\n              (!filter || filter(span.marker)))\n            { found.push(span.marker.parent || span.marker); }\n        } }\n        ++lineNo$$1;\n      });\n      return found\n    },\n    getAllMarks: function() {\n      var markers = [];\n      this.iter(function (line) {\n        var sps = line.markedSpans;\n        if (sps) { for (var i = 0; i < sps.length; ++i)\n          { if (sps[i].from != null) { markers.push(sps[i].marker); } } }\n      });\n      return markers\n    },\n\n    posFromIndex: function(off) {\n      var ch, lineNo$$1 = this.first, sepSize = this.lineSeparator().length;\n      this.iter(function (line) {\n        var sz = line.text.length + sepSize;\n        if (sz > off) { ch = off; return true }\n        off -= sz;\n        ++lineNo$$1;\n      });\n      return clipPos(this, Pos(lineNo$$1, ch))\n    },\n    indexFromPos: function (coords) {\n      coords = clipPos(this, coords);\n      var index = coords.ch;\n      if (coords.line < this.first || coords.ch < 0) { return 0 }\n      var sepSize = this.lineSeparator().length;\n      this.iter(this.first, coords.line, function (line) { // iter aborts when callback returns a truthy value\n        index += line.text.length + sepSize;\n      });\n      return index\n    },\n\n    copy: function(copyHistory) {\n      var doc = new Doc(getLines(this, this.first, this.first + this.size),\n                        this.modeOption, this.first, this.lineSep, this.direction);\n      doc.scrollTop = this.scrollTop; doc.scrollLeft = this.scrollLeft;\n      doc.sel = this.sel;\n      doc.extend = false;\n      if (copyHistory) {\n        doc.history.undoDepth = this.history.undoDepth;\n        doc.setHistory(this.getHistory());\n      }\n      return doc\n    },\n\n    linkedDoc: function(options) {\n      if (!options) { options = {}; }\n      var from = this.first, to = this.first + this.size;\n      if (options.from != null && options.from > from) { from = options.from; }\n      if (options.to != null && options.to < to) { to = options.to; }\n      var copy = new Doc(getLines(this, from, to), options.mode || this.modeOption, from, this.lineSep, this.direction);\n      if (options.sharedHist) { copy.history = this.history\n      ; }(this.linked || (this.linked = [])).push({doc: copy, sharedHist: options.sharedHist});\n      copy.linked = [{doc: this, isParent: true, sharedHist: options.sharedHist}];\n      copySharedMarkers(copy, findSharedMarkers(this));\n      return copy\n    },\n    unlinkDoc: function(other) {\n      var this$1 = this;\n\n      if (other instanceof CodeMirror) { other = other.doc; }\n      if (this.linked) { for (var i = 0; i < this.linked.length; ++i) {\n        var link = this$1.linked[i];\n        if (link.doc != other) { continue }\n        this$1.linked.splice(i, 1);\n        other.unlinkDoc(this$1);\n        detachSharedMarkers(findSharedMarkers(this$1));\n        break\n      } }\n      // If the histories were shared, split them again\n      if (other.history == this.history) {\n        var splitIds = [other.id];\n        linkedDocs(other, function (doc) { return splitIds.push(doc.id); }, true);\n        other.history = new History(null);\n        other.history.done = copyHistoryArray(this.history.done, splitIds);\n        other.history.undone = copyHistoryArray(this.history.undone, splitIds);\n      }\n    },\n    iterLinkedDocs: function(f) {linkedDocs(this, f);},\n\n    getMode: function() {return this.mode},\n    getEditor: function() {return this.cm},\n\n    splitLines: function(str) {\n      if (this.lineSep) { return str.split(this.lineSep) }\n      return splitLinesAuto(str)\n    },\n    lineSeparator: function() { return this.lineSep || \"\\n\" },\n\n    setDirection: docMethodOp(function (dir) {\n      if (dir != \"rtl\") { dir = \"ltr\"; }\n      if (dir == this.direction) { return }\n      this.direction = dir;\n      this.iter(function (line) { return line.order = null; });\n      if (this.cm) { directionChanged(this.cm); }\n    })\n  });\n\n  // Public alias.\n  Doc.prototype.eachLine = Doc.prototype.iter;\n\n  // Kludge to work around strange IE behavior where it'll sometimes\n  // re-fire a series of drag-related events right after the drop (#1551)\n  var lastDrop = 0;\n\n  function onDrop(e) {\n    var cm = this;\n    clearDragCursor(cm);\n    if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e))\n      { return }\n    e_preventDefault(e);\n    if (ie) { lastDrop = +new Date; }\n    var pos = posFromMouse(cm, e, true), files = e.dataTransfer.files;\n    if (!pos || cm.isReadOnly()) { return }\n    // Might be a file drop, in which case we simply extract the text\n    // and insert it.\n    if (files && files.length && window.FileReader && window.File) {\n      var n = files.length, text = Array(n), read = 0;\n      var loadFile = function (file, i) {\n        if (cm.options.allowDropFileTypes &&\n            indexOf(cm.options.allowDropFileTypes, file.type) == -1)\n          { return }\n\n        var reader = new FileReader;\n        reader.onload = operation(cm, function () {\n          var content = reader.result;\n          if (/[\\x00-\\x08\\x0e-\\x1f]{2}/.test(content)) { content = \"\"; }\n          text[i] = content;\n          if (++read == n) {\n            pos = clipPos(cm.doc, pos);\n            var change = {from: pos, to: pos,\n                          text: cm.doc.splitLines(text.join(cm.doc.lineSeparator())),\n                          origin: \"paste\"};\n            makeChange(cm.doc, change);\n            setSelectionReplaceHistory(cm.doc, simpleSelection(pos, changeEnd(change)));\n          }\n        });\n        reader.readAsText(file);\n      };\n      for (var i = 0; i < n; ++i) { loadFile(files[i], i); }\n    } else { // Normal drop\n      // Don't do a replace if the drop happened inside of the selected text.\n      if (cm.state.draggingText && cm.doc.sel.contains(pos) > -1) {\n        cm.state.draggingText(e);\n        // Ensure the editor is re-focused\n        setTimeout(function () { return cm.display.input.focus(); }, 20);\n        return\n      }\n      try {\n        var text$1 = e.dataTransfer.getData(\"Text\");\n        if (text$1) {\n          var selected;\n          if (cm.state.draggingText && !cm.state.draggingText.copy)\n            { selected = cm.listSelections(); }\n          setSelectionNoUndo(cm.doc, simpleSelection(pos, pos));\n          if (selected) { for (var i$1 = 0; i$1 < selected.length; ++i$1)\n            { replaceRange(cm.doc, \"\", selected[i$1].anchor, selected[i$1].head, \"drag\"); } }\n          cm.replaceSelection(text$1, \"around\", \"paste\");\n          cm.display.input.focus();\n        }\n      }\n      catch(e){}\n    }\n  }\n\n  function onDragStart(cm, e) {\n    if (ie && (!cm.state.draggingText || +new Date - lastDrop < 100)) { e_stop(e); return }\n    if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e)) { return }\n\n    e.dataTransfer.setData(\"Text\", cm.getSelection());\n    e.dataTransfer.effectAllowed = \"copyMove\";\n\n    // Use dummy image instead of default browsers image.\n    // Recent Safari (~6.0.2) have a tendency to segfault when this happens, so we don't do it there.\n    if (e.dataTransfer.setDragImage && !safari) {\n      var img = elt(\"img\", null, null, \"position: fixed; left: 0; top: 0;\");\n      img.src = \"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\";\n      if (presto) {\n        img.width = img.height = 1;\n        cm.display.wrapper.appendChild(img);\n        // Force a relayout, or Opera won't use our image for some obscure reason\n        img._top = img.offsetTop;\n      }\n      e.dataTransfer.setDragImage(img, 0, 0);\n      if (presto) { img.parentNode.removeChild(img); }\n    }\n  }\n\n  function onDragOver(cm, e) {\n    var pos = posFromMouse(cm, e);\n    if (!pos) { return }\n    var frag = document.createDocumentFragment();\n    drawSelectionCursor(cm, pos, frag);\n    if (!cm.display.dragCursor) {\n      cm.display.dragCursor = elt(\"div\", null, \"CodeMirror-cursors CodeMirror-dragcursors\");\n      cm.display.lineSpace.insertBefore(cm.display.dragCursor, cm.display.cursorDiv);\n    }\n    removeChildrenAndAdd(cm.display.dragCursor, frag);\n  }\n\n  function clearDragCursor(cm) {\n    if (cm.display.dragCursor) {\n      cm.display.lineSpace.removeChild(cm.display.dragCursor);\n      cm.display.dragCursor = null;\n    }\n  }\n\n  // These must be handled carefully, because naively registering a\n  // handler for each editor will cause the editors to never be\n  // garbage collected.\n\n  function forEachCodeMirror(f) {\n    if (!document.getElementsByClassName) { return }\n    var byClass = document.getElementsByClassName(\"CodeMirror\"), editors = [];\n    for (var i = 0; i < byClass.length; i++) {\n      var cm = byClass[i].CodeMirror;\n      if (cm) { editors.push(cm); }\n    }\n    if (editors.length) { editors[0].operation(function () {\n      for (var i = 0; i < editors.length; i++) { f(editors[i]); }\n    }); }\n  }\n\n  var globalsRegistered = false;\n  function ensureGlobalHandlers() {\n    if (globalsRegistered) { return }\n    registerGlobalHandlers();\n    globalsRegistered = true;\n  }\n  function registerGlobalHandlers() {\n    // When the window resizes, we need to refresh active editors.\n    var resizeTimer;\n    on(window, \"resize\", function () {\n      if (resizeTimer == null) { resizeTimer = setTimeout(function () {\n        resizeTimer = null;\n        forEachCodeMirror(onResize);\n      }, 100); }\n    });\n    // When the window loses focus, we want to show the editor as blurred\n    on(window, \"blur\", function () { return forEachCodeMirror(onBlur); });\n  }\n  // Called when the window resizes\n  function onResize(cm) {\n    var d = cm.display;\n    // Might be a text scaling operation, clear size caches.\n    d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null;\n    d.scrollbarsClipped = false;\n    cm.setSize();\n  }\n\n  var keyNames = {\n    3: \"Pause\", 8: \"Backspace\", 9: \"Tab\", 13: \"Enter\", 16: \"Shift\", 17: \"Ctrl\", 18: \"Alt\",\n    19: \"Pause\", 20: \"CapsLock\", 27: \"Esc\", 32: \"Space\", 33: \"PageUp\", 34: \"PageDown\", 35: \"End\",\n    36: \"Home\", 37: \"Left\", 38: \"Up\", 39: \"Right\", 40: \"Down\", 44: \"PrintScrn\", 45: \"Insert\",\n    46: \"Delete\", 59: \";\", 61: \"=\", 91: \"Mod\", 92: \"Mod\", 93: \"Mod\",\n    106: \"*\", 107: \"=\", 109: \"-\", 110: \".\", 111: \"/\", 145: \"ScrollLock\",\n    173: \"-\", 186: \";\", 187: \"=\", 188: \",\", 189: \"-\", 190: \".\", 191: \"/\", 192: \"`\", 219: \"[\", 220: \"\\\\\",\n    221: \"]\", 222: \"'\", 63232: \"Up\", 63233: \"Down\", 63234: \"Left\", 63235: \"Right\", 63272: \"Delete\",\n    63273: \"Home\", 63275: \"End\", 63276: \"PageUp\", 63277: \"PageDown\", 63302: \"Insert\"\n  };\n\n  // Number keys\n  for (var i = 0; i < 10; i++) { keyNames[i + 48] = keyNames[i + 96] = String(i); }\n  // Alphabetic keys\n  for (var i$1 = 65; i$1 <= 90; i$1++) { keyNames[i$1] = String.fromCharCode(i$1); }\n  // Function keys\n  for (var i$2 = 1; i$2 <= 12; i$2++) { keyNames[i$2 + 111] = keyNames[i$2 + 63235] = \"F\" + i$2; }\n\n  var keyMap = {};\n\n  keyMap.basic = {\n    \"Left\": \"goCharLeft\", \"Right\": \"goCharRight\", \"Up\": \"goLineUp\", \"Down\": \"goLineDown\",\n    \"End\": \"goLineEnd\", \"Home\": \"goLineStartSmart\", \"PageUp\": \"goPageUp\", \"PageDown\": \"goPageDown\",\n    \"Delete\": \"delCharAfter\", \"Backspace\": \"delCharBefore\", \"Shift-Backspace\": \"delCharBefore\",\n    \"Tab\": \"defaultTab\", \"Shift-Tab\": \"indentAuto\",\n    \"Enter\": \"newlineAndIndent\", \"Insert\": \"toggleOverwrite\",\n    \"Esc\": \"singleSelection\"\n  };\n  // Note that the save and find-related commands aren't defined by\n  // default. User code or addons can define them. Unknown commands\n  // are simply ignored.\n  keyMap.pcDefault = {\n    \"Ctrl-A\": \"selectAll\", \"Ctrl-D\": \"deleteLine\", \"Ctrl-Z\": \"undo\", \"Shift-Ctrl-Z\": \"redo\", \"Ctrl-Y\": \"redo\",\n    \"Ctrl-Home\": \"goDocStart\", \"Ctrl-End\": \"goDocEnd\", \"Ctrl-Up\": \"goLineUp\", \"Ctrl-Down\": \"goLineDown\",\n    \"Ctrl-Left\": \"goGroupLeft\", \"Ctrl-Right\": \"goGroupRight\", \"Alt-Left\": \"goLineStart\", \"Alt-Right\": \"goLineEnd\",\n    \"Ctrl-Backspace\": \"delGroupBefore\", \"Ctrl-Delete\": \"delGroupAfter\", \"Ctrl-S\": \"save\", \"Ctrl-F\": \"find\",\n    \"Ctrl-G\": \"findNext\", \"Shift-Ctrl-G\": \"findPrev\", \"Shift-Ctrl-F\": \"replace\", \"Shift-Ctrl-R\": \"replaceAll\",\n    \"Ctrl-[\": \"indentLess\", \"Ctrl-]\": \"indentMore\",\n    \"Ctrl-U\": \"undoSelection\", \"Shift-Ctrl-U\": \"redoSelection\", \"Alt-U\": \"redoSelection\",\n    \"fallthrough\": \"basic\"\n  };\n  // Very basic readline/emacs-style bindings, which are standard on Mac.\n  keyMap.emacsy = {\n    \"Ctrl-F\": \"goCharRight\", \"Ctrl-B\": \"goCharLeft\", \"Ctrl-P\": \"goLineUp\", \"Ctrl-N\": \"goLineDown\",\n    \"Alt-F\": \"goWordRight\", \"Alt-B\": \"goWordLeft\", \"Ctrl-A\": \"goLineStart\", \"Ctrl-E\": \"goLineEnd\",\n    \"Ctrl-V\": \"goPageDown\", \"Shift-Ctrl-V\": \"goPageUp\", \"Ctrl-D\": \"delCharAfter\", \"Ctrl-H\": \"delCharBefore\",\n    \"Alt-D\": \"delWordAfter\", \"Alt-Backspace\": \"delWordBefore\", \"Ctrl-K\": \"killLine\", \"Ctrl-T\": \"transposeChars\",\n    \"Ctrl-O\": \"openLine\"\n  };\n  keyMap.macDefault = {\n    \"Cmd-A\": \"selectAll\", \"Cmd-D\": \"deleteLine\", \"Cmd-Z\": \"undo\", \"Shift-Cmd-Z\": \"redo\", \"Cmd-Y\": \"redo\",\n    \"Cmd-Home\": \"goDocStart\", \"Cmd-Up\": \"goDocStart\", \"Cmd-End\": \"goDocEnd\", \"Cmd-Down\": \"goDocEnd\", \"Alt-Left\": \"goGroupLeft\",\n    \"Alt-Right\": \"goGroupRight\", \"Cmd-Left\": \"goLineLeft\", \"Cmd-Right\": \"goLineRight\", \"Alt-Backspace\": \"delGroupBefore\",\n    \"Ctrl-Alt-Backspace\": \"delGroupAfter\", \"Alt-Delete\": \"delGroupAfter\", \"Cmd-S\": \"save\", \"Cmd-F\": \"find\",\n    \"Cmd-G\": \"findNext\", \"Shift-Cmd-G\": \"findPrev\", \"Cmd-Alt-F\": \"replace\", \"Shift-Cmd-Alt-F\": \"replaceAll\",\n    \"Cmd-[\": \"indentLess\", \"Cmd-]\": \"indentMore\", \"Cmd-Backspace\": \"delWrappedLineLeft\", \"Cmd-Delete\": \"delWrappedLineRight\",\n    \"Cmd-U\": \"undoSelection\", \"Shift-Cmd-U\": \"redoSelection\", \"Ctrl-Up\": \"goDocStart\", \"Ctrl-Down\": \"goDocEnd\",\n    \"fallthrough\": [\"basic\", \"emacsy\"]\n  };\n  keyMap[\"default\"] = mac ? keyMap.macDefault : keyMap.pcDefault;\n\n  // KEYMAP DISPATCH\n\n  function normalizeKeyName(name) {\n    var parts = name.split(/-(?!$)/);\n    name = parts[parts.length - 1];\n    var alt, ctrl, shift, cmd;\n    for (var i = 0; i < parts.length - 1; i++) {\n      var mod = parts[i];\n      if (/^(cmd|meta|m)$/i.test(mod)) { cmd = true; }\n      else if (/^a(lt)?$/i.test(mod)) { alt = true; }\n      else if (/^(c|ctrl|control)$/i.test(mod)) { ctrl = true; }\n      else if (/^s(hift)?$/i.test(mod)) { shift = true; }\n      else { throw new Error(\"Unrecognized modifier name: \" + mod) }\n    }\n    if (alt) { name = \"Alt-\" + name; }\n    if (ctrl) { name = \"Ctrl-\" + name; }\n    if (cmd) { name = \"Cmd-\" + name; }\n    if (shift) { name = \"Shift-\" + name; }\n    return name\n  }\n\n  // This is a kludge to keep keymaps mostly working as raw objects\n  // (backwards compatibility) while at the same time support features\n  // like normalization and multi-stroke key bindings. It compiles a\n  // new normalized keymap, and then updates the old object to reflect\n  // this.\n  function normalizeKeyMap(keymap) {\n    var copy = {};\n    for (var keyname in keymap) { if (keymap.hasOwnProperty(keyname)) {\n      var value = keymap[keyname];\n      if (/^(name|fallthrough|(de|at)tach)$/.test(keyname)) { continue }\n      if (value == \"...\") { delete keymap[keyname]; continue }\n\n      var keys = map(keyname.split(\" \"), normalizeKeyName);\n      for (var i = 0; i < keys.length; i++) {\n        var val = (void 0), name = (void 0);\n        if (i == keys.length - 1) {\n          name = keys.join(\" \");\n          val = value;\n        } else {\n          name = keys.slice(0, i + 1).join(\" \");\n          val = \"...\";\n        }\n        var prev = copy[name];\n        if (!prev) { copy[name] = val; }\n        else if (prev != val) { throw new Error(\"Inconsistent bindings for \" + name) }\n      }\n      delete keymap[keyname];\n    } }\n    for (var prop in copy) { keymap[prop] = copy[prop]; }\n    return keymap\n  }\n\n  function lookupKey(key, map$$1, handle, context) {\n    map$$1 = getKeyMap(map$$1);\n    var found = map$$1.call ? map$$1.call(key, context) : map$$1[key];\n    if (found === false) { return \"nothing\" }\n    if (found === \"...\") { return \"multi\" }\n    if (found != null && handle(found)) { return \"handled\" }\n\n    if (map$$1.fallthrough) {\n      if (Object.prototype.toString.call(map$$1.fallthrough) != \"[object Array]\")\n        { return lookupKey(key, map$$1.fallthrough, handle, context) }\n      for (var i = 0; i < map$$1.fallthrough.length; i++) {\n        var result = lookupKey(key, map$$1.fallthrough[i], handle, context);\n        if (result) { return result }\n      }\n    }\n  }\n\n  // Modifier key presses don't count as 'real' key presses for the\n  // purpose of keymap fallthrough.\n  function isModifierKey(value) {\n    var name = typeof value == \"string\" ? value : keyNames[value.keyCode];\n    return name == \"Ctrl\" || name == \"Alt\" || name == \"Shift\" || name == \"Mod\"\n  }\n\n  function addModifierNames(name, event, noShift) {\n    var base = name;\n    if (event.altKey && base != \"Alt\") { name = \"Alt-\" + name; }\n    if ((flipCtrlCmd ? event.metaKey : event.ctrlKey) && base != \"Ctrl\") { name = \"Ctrl-\" + name; }\n    if ((flipCtrlCmd ? event.ctrlKey : event.metaKey) && base != \"Cmd\") { name = \"Cmd-\" + name; }\n    if (!noShift && event.shiftKey && base != \"Shift\") { name = \"Shift-\" + name; }\n    return name\n  }\n\n  // Look up the name of a key as indicated by an event object.\n  function keyName(event, noShift) {\n    if (presto && event.keyCode == 34 && event[\"char\"]) { return false }\n    var name = keyNames[event.keyCode];\n    if (name == null || event.altGraphKey) { return false }\n    // Ctrl-ScrollLock has keyCode 3, same as Ctrl-Pause,\n    // so we'll use event.code when available (Chrome 48+, FF 38+, Safari 10.1+)\n    if (event.keyCode == 3 && event.code) { name = event.code; }\n    return addModifierNames(name, event, noShift)\n  }\n\n  function getKeyMap(val) {\n    return typeof val == \"string\" ? keyMap[val] : val\n  }\n\n  // Helper for deleting text near the selection(s), used to implement\n  // backspace, delete, and similar functionality.\n  function deleteNearSelection(cm, compute) {\n    var ranges = cm.doc.sel.ranges, kill = [];\n    // Build up a set of ranges to kill first, merging overlapping\n    // ranges.\n    for (var i = 0; i < ranges.length; i++) {\n      var toKill = compute(ranges[i]);\n      while (kill.length && cmp(toKill.from, lst(kill).to) <= 0) {\n        var replaced = kill.pop();\n        if (cmp(replaced.from, toKill.from) < 0) {\n          toKill.from = replaced.from;\n          break\n        }\n      }\n      kill.push(toKill);\n    }\n    // Next, remove those actual ranges.\n    runInOp(cm, function () {\n      for (var i = kill.length - 1; i >= 0; i--)\n        { replaceRange(cm.doc, \"\", kill[i].from, kill[i].to, \"+delete\"); }\n      ensureCursorVisible(cm);\n    });\n  }\n\n  function moveCharLogically(line, ch, dir) {\n    var target = skipExtendingChars(line.text, ch + dir, dir);\n    return target < 0 || target > line.text.length ? null : target\n  }\n\n  function moveLogically(line, start, dir) {\n    var ch = moveCharLogically(line, start.ch, dir);\n    return ch == null ? null : new Pos(start.line, ch, dir < 0 ? \"after\" : \"before\")\n  }\n\n  function endOfLine(visually, cm, lineObj, lineNo, dir) {\n    if (visually) {\n      var order = getOrder(lineObj, cm.doc.direction);\n      if (order) {\n        var part = dir < 0 ? lst(order) : order[0];\n        var moveInStorageOrder = (dir < 0) == (part.level == 1);\n        var sticky = moveInStorageOrder ? \"after\" : \"before\";\n        var ch;\n        // With a wrapped rtl chunk (possibly spanning multiple bidi parts),\n        // it could be that the last bidi part is not on the last visual line,\n        // since visual lines contain content order-consecutive chunks.\n        // Thus, in rtl, we are looking for the first (content-order) character\n        // in the rtl chunk that is on the last line (that is, the same line\n        // as the last (content-order) character).\n        if (part.level > 0 || cm.doc.direction == \"rtl\") {\n          var prep = prepareMeasureForLine(cm, lineObj);\n          ch = dir < 0 ? lineObj.text.length - 1 : 0;\n          var targetTop = measureCharPrepared(cm, prep, ch).top;\n          ch = findFirst(function (ch) { return measureCharPrepared(cm, prep, ch).top == targetTop; }, (dir < 0) == (part.level == 1) ? part.from : part.to - 1, ch);\n          if (sticky == \"before\") { ch = moveCharLogically(lineObj, ch, 1); }\n        } else { ch = dir < 0 ? part.to : part.from; }\n        return new Pos(lineNo, ch, sticky)\n      }\n    }\n    return new Pos(lineNo, dir < 0 ? lineObj.text.length : 0, dir < 0 ? \"before\" : \"after\")\n  }\n\n  function moveVisually(cm, line, start, dir) {\n    var bidi = getOrder(line, cm.doc.direction);\n    if (!bidi) { return moveLogically(line, start, dir) }\n    if (start.ch >= line.text.length) {\n      start.ch = line.text.length;\n      start.sticky = \"before\";\n    } else if (start.ch <= 0) {\n      start.ch = 0;\n      start.sticky = \"after\";\n    }\n    var partPos = getBidiPartAt(bidi, start.ch, start.sticky), part = bidi[partPos];\n    if (cm.doc.direction == \"ltr\" && part.level % 2 == 0 && (dir > 0 ? part.to > start.ch : part.from < start.ch)) {\n      // Case 1: We move within an ltr part in an ltr editor. Even with wrapped lines,\n      // nothing interesting happens.\n      return moveLogically(line, start, dir)\n    }\n\n    var mv = function (pos, dir) { return moveCharLogically(line, pos instanceof Pos ? pos.ch : pos, dir); };\n    var prep;\n    var getWrappedLineExtent = function (ch) {\n      if (!cm.options.lineWrapping) { return {begin: 0, end: line.text.length} }\n      prep = prep || prepareMeasureForLine(cm, line);\n      return wrappedLineExtentChar(cm, line, prep, ch)\n    };\n    var wrappedLineExtent = getWrappedLineExtent(start.sticky == \"before\" ? mv(start, -1) : start.ch);\n\n    if (cm.doc.direction == \"rtl\" || part.level == 1) {\n      var moveInStorageOrder = (part.level == 1) == (dir < 0);\n      var ch = mv(start, moveInStorageOrder ? 1 : -1);\n      if (ch != null && (!moveInStorageOrder ? ch >= part.from && ch >= wrappedLineExtent.begin : ch <= part.to && ch <= wrappedLineExtent.end)) {\n        // Case 2: We move within an rtl part or in an rtl editor on the same visual line\n        var sticky = moveInStorageOrder ? \"before\" : \"after\";\n        return new Pos(start.line, ch, sticky)\n      }\n    }\n\n    // Case 3: Could not move within this bidi part in this visual line, so leave\n    // the current bidi part\n\n    var searchInVisualLine = function (partPos, dir, wrappedLineExtent) {\n      var getRes = function (ch, moveInStorageOrder) { return moveInStorageOrder\n        ? new Pos(start.line, mv(ch, 1), \"before\")\n        : new Pos(start.line, ch, \"after\"); };\n\n      for (; partPos >= 0 && partPos < bidi.length; partPos += dir) {\n        var part = bidi[partPos];\n        var moveInStorageOrder = (dir > 0) == (part.level != 1);\n        var ch = moveInStorageOrder ? wrappedLineExtent.begin : mv(wrappedLineExtent.end, -1);\n        if (part.from <= ch && ch < part.to) { return getRes(ch, moveInStorageOrder) }\n        ch = moveInStorageOrder ? part.from : mv(part.to, -1);\n        if (wrappedLineExtent.begin <= ch && ch < wrappedLineExtent.end) { return getRes(ch, moveInStorageOrder) }\n      }\n    };\n\n    // Case 3a: Look for other bidi parts on the same visual line\n    var res = searchInVisualLine(partPos + dir, dir, wrappedLineExtent);\n    if (res) { return res }\n\n    // Case 3b: Look for other bidi parts on the next visual line\n    var nextCh = dir > 0 ? wrappedLineExtent.end : mv(wrappedLineExtent.begin, -1);\n    if (nextCh != null && !(dir > 0 && nextCh == line.text.length)) {\n      res = searchInVisualLine(dir > 0 ? 0 : bidi.length - 1, dir, getWrappedLineExtent(nextCh));\n      if (res) { return res }\n    }\n\n    // Case 4: Nowhere to move\n    return null\n  }\n\n  // Commands are parameter-less actions that can be performed on an\n  // editor, mostly used for keybindings.\n  var commands = {\n    selectAll: selectAll,\n    singleSelection: function (cm) { return cm.setSelection(cm.getCursor(\"anchor\"), cm.getCursor(\"head\"), sel_dontScroll); },\n    killLine: function (cm) { return deleteNearSelection(cm, function (range) {\n      if (range.empty()) {\n        var len = getLine(cm.doc, range.head.line).text.length;\n        if (range.head.ch == len && range.head.line < cm.lastLine())\n          { return {from: range.head, to: Pos(range.head.line + 1, 0)} }\n        else\n          { return {from: range.head, to: Pos(range.head.line, len)} }\n      } else {\n        return {from: range.from(), to: range.to()}\n      }\n    }); },\n    deleteLine: function (cm) { return deleteNearSelection(cm, function (range) { return ({\n      from: Pos(range.from().line, 0),\n      to: clipPos(cm.doc, Pos(range.to().line + 1, 0))\n    }); }); },\n    delLineLeft: function (cm) { return deleteNearSelection(cm, function (range) { return ({\n      from: Pos(range.from().line, 0), to: range.from()\n    }); }); },\n    delWrappedLineLeft: function (cm) { return deleteNearSelection(cm, function (range) {\n      var top = cm.charCoords(range.head, \"div\").top + 5;\n      var leftPos = cm.coordsChar({left: 0, top: top}, \"div\");\n      return {from: leftPos, to: range.from()}\n    }); },\n    delWrappedLineRight: function (cm) { return deleteNearSelection(cm, function (range) {\n      var top = cm.charCoords(range.head, \"div\").top + 5;\n      var rightPos = cm.coordsChar({left: cm.display.lineDiv.offsetWidth + 100, top: top}, \"div\");\n      return {from: range.from(), to: rightPos }\n    }); },\n    undo: function (cm) { return cm.undo(); },\n    redo: function (cm) { return cm.redo(); },\n    undoSelection: function (cm) { return cm.undoSelection(); },\n    redoSelection: function (cm) { return cm.redoSelection(); },\n    goDocStart: function (cm) { return cm.extendSelection(Pos(cm.firstLine(), 0)); },\n    goDocEnd: function (cm) { return cm.extendSelection(Pos(cm.lastLine())); },\n    goLineStart: function (cm) { return cm.extendSelectionsBy(function (range) { return lineStart(cm, range.head.line); },\n      {origin: \"+move\", bias: 1}\n    ); },\n    goLineStartSmart: function (cm) { return cm.extendSelectionsBy(function (range) { return lineStartSmart(cm, range.head); },\n      {origin: \"+move\", bias: 1}\n    ); },\n    goLineEnd: function (cm) { return cm.extendSelectionsBy(function (range) { return lineEnd(cm, range.head.line); },\n      {origin: \"+move\", bias: -1}\n    ); },\n    goLineRight: function (cm) { return cm.extendSelectionsBy(function (range) {\n      var top = cm.cursorCoords(range.head, \"div\").top + 5;\n      return cm.coordsChar({left: cm.display.lineDiv.offsetWidth + 100, top: top}, \"div\")\n    }, sel_move); },\n    goLineLeft: function (cm) { return cm.extendSelectionsBy(function (range) {\n      var top = cm.cursorCoords(range.head, \"div\").top + 5;\n      return cm.coordsChar({left: 0, top: top}, \"div\")\n    }, sel_move); },\n    goLineLeftSmart: function (cm) { return cm.extendSelectionsBy(function (range) {\n      var top = cm.cursorCoords(range.head, \"div\").top + 5;\n      var pos = cm.coordsChar({left: 0, top: top}, \"div\");\n      if (pos.ch < cm.getLine(pos.line).search(/\\S/)) { return lineStartSmart(cm, range.head) }\n      return pos\n    }, sel_move); },\n    goLineUp: function (cm) { return cm.moveV(-1, \"line\"); },\n    goLineDown: function (cm) { return cm.moveV(1, \"line\"); },\n    goPageUp: function (cm) { return cm.moveV(-1, \"page\"); },\n    goPageDown: function (cm) { return cm.moveV(1, \"page\"); },\n    goCharLeft: function (cm) { return cm.moveH(-1, \"char\"); },\n    goCharRight: function (cm) { return cm.moveH(1, \"char\"); },\n    goColumnLeft: function (cm) { return cm.moveH(-1, \"column\"); },\n    goColumnRight: function (cm) { return cm.moveH(1, \"column\"); },\n    goWordLeft: function (cm) { return cm.moveH(-1, \"word\"); },\n    goGroupRight: function (cm) { return cm.moveH(1, \"group\"); },\n    goGroupLeft: function (cm) { return cm.moveH(-1, \"group\"); },\n    goWordRight: function (cm) { return cm.moveH(1, \"word\"); },\n    delCharBefore: function (cm) { return cm.deleteH(-1, \"char\"); },\n    delCharAfter: function (cm) { return cm.deleteH(1, \"char\"); },\n    delWordBefore: function (cm) { return cm.deleteH(-1, \"word\"); },\n    delWordAfter: function (cm) { return cm.deleteH(1, \"word\"); },\n    delGroupBefore: function (cm) { return cm.deleteH(-1, \"group\"); },\n    delGroupAfter: function (cm) { return cm.deleteH(1, \"group\"); },\n    indentAuto: function (cm) { return cm.indentSelection(\"smart\"); },\n    indentMore: function (cm) { return cm.indentSelection(\"add\"); },\n    indentLess: function (cm) { return cm.indentSelection(\"subtract\"); },\n    insertTab: function (cm) { return cm.replaceSelection(\"\\t\"); },\n    insertSoftTab: function (cm) {\n      var spaces = [], ranges = cm.listSelections(), tabSize = cm.options.tabSize;\n      for (var i = 0; i < ranges.length; i++) {\n        var pos = ranges[i].from();\n        var col = countColumn(cm.getLine(pos.line), pos.ch, tabSize);\n        spaces.push(spaceStr(tabSize - col % tabSize));\n      }\n      cm.replaceSelections(spaces);\n    },\n    defaultTab: function (cm) {\n      if (cm.somethingSelected()) { cm.indentSelection(\"add\"); }\n      else { cm.execCommand(\"insertTab\"); }\n    },\n    // Swap the two chars left and right of each selection's head.\n    // Move cursor behind the two swapped characters afterwards.\n    //\n    // Doesn't consider line feeds a character.\n    // Doesn't scan more than one line above to find a character.\n    // Doesn't do anything on an empty line.\n    // Doesn't do anything with non-empty selections.\n    transposeChars: function (cm) { return runInOp(cm, function () {\n      var ranges = cm.listSelections(), newSel = [];\n      for (var i = 0; i < ranges.length; i++) {\n        if (!ranges[i].empty()) { continue }\n        var cur = ranges[i].head, line = getLine(cm.doc, cur.line).text;\n        if (line) {\n          if (cur.ch == line.length) { cur = new Pos(cur.line, cur.ch - 1); }\n          if (cur.ch > 0) {\n            cur = new Pos(cur.line, cur.ch + 1);\n            cm.replaceRange(line.charAt(cur.ch - 1) + line.charAt(cur.ch - 2),\n                            Pos(cur.line, cur.ch - 2), cur, \"+transpose\");\n          } else if (cur.line > cm.doc.first) {\n            var prev = getLine(cm.doc, cur.line - 1).text;\n            if (prev) {\n              cur = new Pos(cur.line, 1);\n              cm.replaceRange(line.charAt(0) + cm.doc.lineSeparator() +\n                              prev.charAt(prev.length - 1),\n                              Pos(cur.line - 1, prev.length - 1), cur, \"+transpose\");\n            }\n          }\n        }\n        newSel.push(new Range(cur, cur));\n      }\n      cm.setSelections(newSel);\n    }); },\n    newlineAndIndent: function (cm) { return runInOp(cm, function () {\n      var sels = cm.listSelections();\n      for (var i = sels.length - 1; i >= 0; i--)\n        { cm.replaceRange(cm.doc.lineSeparator(), sels[i].anchor, sels[i].head, \"+input\"); }\n      sels = cm.listSelections();\n      for (var i$1 = 0; i$1 < sels.length; i$1++)\n        { cm.indentLine(sels[i$1].from().line, null, true); }\n      ensureCursorVisible(cm);\n    }); },\n    openLine: function (cm) { return cm.replaceSelection(\"\\n\", \"start\"); },\n    toggleOverwrite: function (cm) { return cm.toggleOverwrite(); }\n  };\n\n\n  function lineStart(cm, lineN) {\n    var line = getLine(cm.doc, lineN);\n    var visual = visualLine(line);\n    if (visual != line) { lineN = lineNo(visual); }\n    return endOfLine(true, cm, visual, lineN, 1)\n  }\n  function lineEnd(cm, lineN) {\n    var line = getLine(cm.doc, lineN);\n    var visual = visualLineEnd(line);\n    if (visual != line) { lineN = lineNo(visual); }\n    return endOfLine(true, cm, line, lineN, -1)\n  }\n  function lineStartSmart(cm, pos) {\n    var start = lineStart(cm, pos.line);\n    var line = getLine(cm.doc, start.line);\n    var order = getOrder(line, cm.doc.direction);\n    if (!order || order[0].level == 0) {\n      var firstNonWS = Math.max(0, line.text.search(/\\S/));\n      var inWS = pos.line == start.line && pos.ch <= firstNonWS && pos.ch;\n      return Pos(start.line, inWS ? 0 : firstNonWS, start.sticky)\n    }\n    return start\n  }\n\n  // Run a handler that was bound to a key.\n  function doHandleBinding(cm, bound, dropShift) {\n    if (typeof bound == \"string\") {\n      bound = commands[bound];\n      if (!bound) { return false }\n    }\n    // Ensure previous input has been read, so that the handler sees a\n    // consistent view of the document\n    cm.display.input.ensurePolled();\n    var prevShift = cm.display.shift, done = false;\n    try {\n      if (cm.isReadOnly()) { cm.state.suppressEdits = true; }\n      if (dropShift) { cm.display.shift = false; }\n      done = bound(cm) != Pass;\n    } finally {\n      cm.display.shift = prevShift;\n      cm.state.suppressEdits = false;\n    }\n    return done\n  }\n\n  function lookupKeyForEditor(cm, name, handle) {\n    for (var i = 0; i < cm.state.keyMaps.length; i++) {\n      var result = lookupKey(name, cm.state.keyMaps[i], handle, cm);\n      if (result) { return result }\n    }\n    return (cm.options.extraKeys && lookupKey(name, cm.options.extraKeys, handle, cm))\n      || lookupKey(name, cm.options.keyMap, handle, cm)\n  }\n\n  // Note that, despite the name, this function is also used to check\n  // for bound mouse clicks.\n\n  var stopSeq = new Delayed;\n\n  function dispatchKey(cm, name, e, handle) {\n    var seq = cm.state.keySeq;\n    if (seq) {\n      if (isModifierKey(name)) { return \"handled\" }\n      if (/\\'$/.test(name))\n        { cm.state.keySeq = null; }\n      else\n        { stopSeq.set(50, function () {\n          if (cm.state.keySeq == seq) {\n            cm.state.keySeq = null;\n            cm.display.input.reset();\n          }\n        }); }\n      if (dispatchKeyInner(cm, seq + \" \" + name, e, handle)) { return true }\n    }\n    return dispatchKeyInner(cm, name, e, handle)\n  }\n\n  function dispatchKeyInner(cm, name, e, handle) {\n    var result = lookupKeyForEditor(cm, name, handle);\n\n    if (result == \"multi\")\n      { cm.state.keySeq = name; }\n    if (result == \"handled\")\n      { signalLater(cm, \"keyHandled\", cm, name, e); }\n\n    if (result == \"handled\" || result == \"multi\") {\n      e_preventDefault(e);\n      restartBlink(cm);\n    }\n\n    return !!result\n  }\n\n  // Handle a key from the keydown event.\n  function handleKeyBinding(cm, e) {\n    var name = keyName(e, true);\n    if (!name) { return false }\n\n    if (e.shiftKey && !cm.state.keySeq) {\n      // First try to resolve full name (including 'Shift-'). Failing\n      // that, see if there is a cursor-motion command (starting with\n      // 'go') bound to the keyname without 'Shift-'.\n      return dispatchKey(cm, \"Shift-\" + name, e, function (b) { return doHandleBinding(cm, b, true); })\n          || dispatchKey(cm, name, e, function (b) {\n               if (typeof b == \"string\" ? /^go[A-Z]/.test(b) : b.motion)\n                 { return doHandleBinding(cm, b) }\n             })\n    } else {\n      return dispatchKey(cm, name, e, function (b) { return doHandleBinding(cm, b); })\n    }\n  }\n\n  // Handle a key from the keypress event\n  function handleCharBinding(cm, e, ch) {\n    return dispatchKey(cm, \"'\" + ch + \"'\", e, function (b) { return doHandleBinding(cm, b, true); })\n  }\n\n  var lastStoppedKey = null;\n  function onKeyDown(e) {\n    var cm = this;\n    cm.curOp.focus = activeElt();\n    if (signalDOMEvent(cm, e)) { return }\n    // IE does strange things with escape.\n    if (ie && ie_version < 11 && e.keyCode == 27) { e.returnValue = false; }\n    var code = e.keyCode;\n    cm.display.shift = code == 16 || e.shiftKey;\n    var handled = handleKeyBinding(cm, e);\n    if (presto) {\n      lastStoppedKey = handled ? code : null;\n      // Opera has no cut event... we try to at least catch the key combo\n      if (!handled && code == 88 && !hasCopyEvent && (mac ? e.metaKey : e.ctrlKey))\n        { cm.replaceSelection(\"\", null, \"cut\"); }\n    }\n\n    // Turn mouse into crosshair when Alt is held on Mac.\n    if (code == 18 && !/\\bCodeMirror-crosshair\\b/.test(cm.display.lineDiv.className))\n      { showCrossHair(cm); }\n  }\n\n  function showCrossHair(cm) {\n    var lineDiv = cm.display.lineDiv;\n    addClass(lineDiv, \"CodeMirror-crosshair\");\n\n    function up(e) {\n      if (e.keyCode == 18 || !e.altKey) {\n        rmClass(lineDiv, \"CodeMirror-crosshair\");\n        off(document, \"keyup\", up);\n        off(document, \"mouseover\", up);\n      }\n    }\n    on(document, \"keyup\", up);\n    on(document, \"mouseover\", up);\n  }\n\n  function onKeyUp(e) {\n    if (e.keyCode == 16) { this.doc.sel.shift = false; }\n    signalDOMEvent(this, e);\n  }\n\n  function onKeyPress(e) {\n    var cm = this;\n    if (eventInWidget(cm.display, e) || signalDOMEvent(cm, e) || e.ctrlKey && !e.altKey || mac && e.metaKey) { return }\n    var keyCode = e.keyCode, charCode = e.charCode;\n    if (presto && keyCode == lastStoppedKey) {lastStoppedKey = null; e_preventDefault(e); return}\n    if ((presto && (!e.which || e.which < 10)) && handleKeyBinding(cm, e)) { return }\n    var ch = String.fromCharCode(charCode == null ? keyCode : charCode);\n    // Some browsers fire keypress events for backspace\n    if (ch == \"\\x08\") { return }\n    if (handleCharBinding(cm, e, ch)) { return }\n    cm.display.input.onKeyPress(e);\n  }\n\n  var DOUBLECLICK_DELAY = 400;\n\n  var PastClick = function(time, pos, button) {\n    this.time = time;\n    this.pos = pos;\n    this.button = button;\n  };\n\n  PastClick.prototype.compare = function (time, pos, button) {\n    return this.time + DOUBLECLICK_DELAY > time &&\n      cmp(pos, this.pos) == 0 && button == this.button\n  };\n\n  var lastClick, lastDoubleClick;\n  function clickRepeat(pos, button) {\n    var now = +new Date;\n    if (lastDoubleClick && lastDoubleClick.compare(now, pos, button)) {\n      lastClick = lastDoubleClick = null;\n      return \"triple\"\n    } else if (lastClick && lastClick.compare(now, pos, button)) {\n      lastDoubleClick = new PastClick(now, pos, button);\n      lastClick = null;\n      return \"double\"\n    } else {\n      lastClick = new PastClick(now, pos, button);\n      lastDoubleClick = null;\n      return \"single\"\n    }\n  }\n\n  // A mouse down can be a single click, double click, triple click,\n  // start of selection drag, start of text drag, new cursor\n  // (ctrl-click), rectangle drag (alt-drag), or xwin\n  // middle-click-paste. Or it might be a click on something we should\n  // not interfere with, such as a scrollbar or widget.\n  function onMouseDown(e) {\n    var cm = this, display = cm.display;\n    if (signalDOMEvent(cm, e) || display.activeTouch && display.input.supportsTouch()) { return }\n    display.input.ensurePolled();\n    display.shift = e.shiftKey;\n\n    if (eventInWidget(display, e)) {\n      if (!webkit) {\n        // Briefly turn off draggability, to allow widgets to do\n        // normal dragging things.\n        display.scroller.draggable = false;\n        setTimeout(function () { return display.scroller.draggable = true; }, 100);\n      }\n      return\n    }\n    if (clickInGutter(cm, e)) { return }\n    var pos = posFromMouse(cm, e), button = e_button(e), repeat = pos ? clickRepeat(pos, button) : \"single\";\n    window.focus();\n\n    // #3261: make sure, that we're not starting a second selection\n    if (button == 1 && cm.state.selectingText)\n      { cm.state.selectingText(e); }\n\n    if (pos && handleMappedButton(cm, button, pos, repeat, e)) { return }\n\n    if (button == 1) {\n      if (pos) { leftButtonDown(cm, pos, repeat, e); }\n      else if (e_target(e) == display.scroller) { e_preventDefault(e); }\n    } else if (button == 2) {\n      if (pos) { extendSelection(cm.doc, pos); }\n      setTimeout(function () { return display.input.focus(); }, 20);\n    } else if (button == 3) {\n      if (captureRightClick) { cm.display.input.onContextMenu(e); }\n      else { delayBlurEvent(cm); }\n    }\n  }\n\n  function handleMappedButton(cm, button, pos, repeat, event) {\n    var name = \"Click\";\n    if (repeat == \"double\") { name = \"Double\" + name; }\n    else if (repeat == \"triple\") { name = \"Triple\" + name; }\n    name = (button == 1 ? \"Left\" : button == 2 ? \"Middle\" : \"Right\") + name;\n\n    return dispatchKey(cm,  addModifierNames(name, event), event, function (bound) {\n      if (typeof bound == \"string\") { bound = commands[bound]; }\n      if (!bound) { return false }\n      var done = false;\n      try {\n        if (cm.isReadOnly()) { cm.state.suppressEdits = true; }\n        done = bound(cm, pos) != Pass;\n      } finally {\n        cm.state.suppressEdits = false;\n      }\n      return done\n    })\n  }\n\n  function configureMouse(cm, repeat, event) {\n    var option = cm.getOption(\"configureMouse\");\n    var value = option ? option(cm, repeat, event) : {};\n    if (value.unit == null) {\n      var rect = chromeOS ? event.shiftKey && event.metaKey : event.altKey;\n      value.unit = rect ? \"rectangle\" : repeat == \"single\" ? \"char\" : repeat == \"double\" ? \"word\" : \"line\";\n    }\n    if (value.extend == null || cm.doc.extend) { value.extend = cm.doc.extend || event.shiftKey; }\n    if (value.addNew == null) { value.addNew = mac ? event.metaKey : event.ctrlKey; }\n    if (value.moveOnDrag == null) { value.moveOnDrag = !(mac ? event.altKey : event.ctrlKey); }\n    return value\n  }\n\n  function leftButtonDown(cm, pos, repeat, event) {\n    if (ie) { setTimeout(bind(ensureFocus, cm), 0); }\n    else { cm.curOp.focus = activeElt(); }\n\n    var behavior = configureMouse(cm, repeat, event);\n\n    var sel = cm.doc.sel, contained;\n    if (cm.options.dragDrop && dragAndDrop && !cm.isReadOnly() &&\n        repeat == \"single\" && (contained = sel.contains(pos)) > -1 &&\n        (cmp((contained = sel.ranges[contained]).from(), pos) < 0 || pos.xRel > 0) &&\n        (cmp(contained.to(), pos) > 0 || pos.xRel < 0))\n      { leftButtonStartDrag(cm, event, pos, behavior); }\n    else\n      { leftButtonSelect(cm, event, pos, behavior); }\n  }\n\n  // Start a text drag. When it ends, see if any dragging actually\n  // happen, and treat as a click if it didn't.\n  function leftButtonStartDrag(cm, event, pos, behavior) {\n    var display = cm.display, moved = false;\n    var dragEnd = operation(cm, function (e) {\n      if (webkit) { display.scroller.draggable = false; }\n      cm.state.draggingText = false;\n      off(display.wrapper.ownerDocument, \"mouseup\", dragEnd);\n      off(display.wrapper.ownerDocument, \"mousemove\", mouseMove);\n      off(display.scroller, \"dragstart\", dragStart);\n      off(display.scroller, \"drop\", dragEnd);\n      if (!moved) {\n        e_preventDefault(e);\n        if (!behavior.addNew)\n          { extendSelection(cm.doc, pos, null, null, behavior.extend); }\n        // Work around unexplainable focus problem in IE9 (#2127) and Chrome (#3081)\n        if (webkit || ie && ie_version == 9)\n          { setTimeout(function () {display.wrapper.ownerDocument.body.focus(); display.input.focus();}, 20); }\n        else\n          { display.input.focus(); }\n      }\n    });\n    var mouseMove = function(e2) {\n      moved = moved || Math.abs(event.clientX - e2.clientX) + Math.abs(event.clientY - e2.clientY) >= 10;\n    };\n    var dragStart = function () { return moved = true; };\n    // Let the drag handler handle this.\n    if (webkit) { display.scroller.draggable = true; }\n    cm.state.draggingText = dragEnd;\n    dragEnd.copy = !behavior.moveOnDrag;\n    // IE's approach to draggable\n    if (display.scroller.dragDrop) { display.scroller.dragDrop(); }\n    on(display.wrapper.ownerDocument, \"mouseup\", dragEnd);\n    on(display.wrapper.ownerDocument, \"mousemove\", mouseMove);\n    on(display.scroller, \"dragstart\", dragStart);\n    on(display.scroller, \"drop\", dragEnd);\n\n    delayBlurEvent(cm);\n    setTimeout(function () { return display.input.focus(); }, 20);\n  }\n\n  function rangeForUnit(cm, pos, unit) {\n    if (unit == \"char\") { return new Range(pos, pos) }\n    if (unit == \"word\") { return cm.findWordAt(pos) }\n    if (unit == \"line\") { return new Range(Pos(pos.line, 0), clipPos(cm.doc, Pos(pos.line + 1, 0))) }\n    var result = unit(cm, pos);\n    return new Range(result.from, result.to)\n  }\n\n  // Normal selection, as opposed to text dragging.\n  function leftButtonSelect(cm, event, start, behavior) {\n    var display = cm.display, doc = cm.doc;\n    e_preventDefault(event);\n\n    var ourRange, ourIndex, startSel = doc.sel, ranges = startSel.ranges;\n    if (behavior.addNew && !behavior.extend) {\n      ourIndex = doc.sel.contains(start);\n      if (ourIndex > -1)\n        { ourRange = ranges[ourIndex]; }\n      else\n        { ourRange = new Range(start, start); }\n    } else {\n      ourRange = doc.sel.primary();\n      ourIndex = doc.sel.primIndex;\n    }\n\n    if (behavior.unit == \"rectangle\") {\n      if (!behavior.addNew) { ourRange = new Range(start, start); }\n      start = posFromMouse(cm, event, true, true);\n      ourIndex = -1;\n    } else {\n      var range$$1 = rangeForUnit(cm, start, behavior.unit);\n      if (behavior.extend)\n        { ourRange = extendRange(ourRange, range$$1.anchor, range$$1.head, behavior.extend); }\n      else\n        { ourRange = range$$1; }\n    }\n\n    if (!behavior.addNew) {\n      ourIndex = 0;\n      setSelection(doc, new Selection([ourRange], 0), sel_mouse);\n      startSel = doc.sel;\n    } else if (ourIndex == -1) {\n      ourIndex = ranges.length;\n      setSelection(doc, normalizeSelection(cm, ranges.concat([ourRange]), ourIndex),\n                   {scroll: false, origin: \"*mouse\"});\n    } else if (ranges.length > 1 && ranges[ourIndex].empty() && behavior.unit == \"char\" && !behavior.extend) {\n      setSelection(doc, normalizeSelection(cm, ranges.slice(0, ourIndex).concat(ranges.slice(ourIndex + 1)), 0),\n                   {scroll: false, origin: \"*mouse\"});\n      startSel = doc.sel;\n    } else {\n      replaceOneSelection(doc, ourIndex, ourRange, sel_mouse);\n    }\n\n    var lastPos = start;\n    function extendTo(pos) {\n      if (cmp(lastPos, pos) == 0) { return }\n      lastPos = pos;\n\n      if (behavior.unit == \"rectangle\") {\n        var ranges = [], tabSize = cm.options.tabSize;\n        var startCol = countColumn(getLine(doc, start.line).text, start.ch, tabSize);\n        var posCol = countColumn(getLine(doc, pos.line).text, pos.ch, tabSize);\n        var left = Math.min(startCol, posCol), right = Math.max(startCol, posCol);\n        for (var line = Math.min(start.line, pos.line), end = Math.min(cm.lastLine(), Math.max(start.line, pos.line));\n             line <= end; line++) {\n          var text = getLine(doc, line).text, leftPos = findColumn(text, left, tabSize);\n          if (left == right)\n            { ranges.push(new Range(Pos(line, leftPos), Pos(line, leftPos))); }\n          else if (text.length > leftPos)\n            { ranges.push(new Range(Pos(line, leftPos), Pos(line, findColumn(text, right, tabSize)))); }\n        }\n        if (!ranges.length) { ranges.push(new Range(start, start)); }\n        setSelection(doc, normalizeSelection(cm, startSel.ranges.slice(0, ourIndex).concat(ranges), ourIndex),\n                     {origin: \"*mouse\", scroll: false});\n        cm.scrollIntoView(pos);\n      } else {\n        var oldRange = ourRange;\n        var range$$1 = rangeForUnit(cm, pos, behavior.unit);\n        var anchor = oldRange.anchor, head;\n        if (cmp(range$$1.anchor, anchor) > 0) {\n          head = range$$1.head;\n          anchor = minPos(oldRange.from(), range$$1.anchor);\n        } else {\n          head = range$$1.anchor;\n          anchor = maxPos(oldRange.to(), range$$1.head);\n        }\n        var ranges$1 = startSel.ranges.slice(0);\n        ranges$1[ourIndex] = bidiSimplify(cm, new Range(clipPos(doc, anchor), head));\n        setSelection(doc, normalizeSelection(cm, ranges$1, ourIndex), sel_mouse);\n      }\n    }\n\n    var editorSize = display.wrapper.getBoundingClientRect();\n    // Used to ensure timeout re-tries don't fire when another extend\n    // happened in the meantime (clearTimeout isn't reliable -- at\n    // least on Chrome, the timeouts still happen even when cleared,\n    // if the clear happens after their scheduled firing time).\n    var counter = 0;\n\n    function extend(e) {\n      var curCount = ++counter;\n      var cur = posFromMouse(cm, e, true, behavior.unit == \"rectangle\");\n      if (!cur) { return }\n      if (cmp(cur, lastPos) != 0) {\n        cm.curOp.focus = activeElt();\n        extendTo(cur);\n        var visible = visibleLines(display, doc);\n        if (cur.line >= visible.to || cur.line < visible.from)\n          { setTimeout(operation(cm, function () {if (counter == curCount) { extend(e); }}), 150); }\n      } else {\n        var outside = e.clientY < editorSize.top ? -20 : e.clientY > editorSize.bottom ? 20 : 0;\n        if (outside) { setTimeout(operation(cm, function () {\n          if (counter != curCount) { return }\n          display.scroller.scrollTop += outside;\n          extend(e);\n        }), 50); }\n      }\n    }\n\n    function done(e) {\n      cm.state.selectingText = false;\n      counter = Infinity;\n      // If e is null or undefined we interpret this as someone trying\n      // to explicitly cancel the selection rather than the user\n      // letting go of the mouse button.\n      if (e) {\n        e_preventDefault(e);\n        display.input.focus();\n      }\n      off(display.wrapper.ownerDocument, \"mousemove\", move);\n      off(display.wrapper.ownerDocument, \"mouseup\", up);\n      doc.history.lastSelOrigin = null;\n    }\n\n    var move = operation(cm, function (e) {\n      if (e.buttons === 0 || !e_button(e)) { done(e); }\n      else { extend(e); }\n    });\n    var up = operation(cm, done);\n    cm.state.selectingText = up;\n    on(display.wrapper.ownerDocument, \"mousemove\", move);\n    on(display.wrapper.ownerDocument, \"mouseup\", up);\n  }\n\n  // Used when mouse-selecting to adjust the anchor to the proper side\n  // of a bidi jump depending on the visual position of the head.\n  function bidiSimplify(cm, range$$1) {\n    var anchor = range$$1.anchor;\n    var head = range$$1.head;\n    var anchorLine = getLine(cm.doc, anchor.line);\n    if (cmp(anchor, head) == 0 && anchor.sticky == head.sticky) { return range$$1 }\n    var order = getOrder(anchorLine);\n    if (!order) { return range$$1 }\n    var index = getBidiPartAt(order, anchor.ch, anchor.sticky), part = order[index];\n    if (part.from != anchor.ch && part.to != anchor.ch) { return range$$1 }\n    var boundary = index + ((part.from == anchor.ch) == (part.level != 1) ? 0 : 1);\n    if (boundary == 0 || boundary == order.length) { return range$$1 }\n\n    // Compute the relative visual position of the head compared to the\n    // anchor (<0 is to the left, >0 to the right)\n    var leftSide;\n    if (head.line != anchor.line) {\n      leftSide = (head.line - anchor.line) * (cm.doc.direction == \"ltr\" ? 1 : -1) > 0;\n    } else {\n      var headIndex = getBidiPartAt(order, head.ch, head.sticky);\n      var dir = headIndex - index || (head.ch - anchor.ch) * (part.level == 1 ? -1 : 1);\n      if (headIndex == boundary - 1 || headIndex == boundary)\n        { leftSide = dir < 0; }\n      else\n        { leftSide = dir > 0; }\n    }\n\n    var usePart = order[boundary + (leftSide ? -1 : 0)];\n    var from = leftSide == (usePart.level == 1);\n    var ch = from ? usePart.from : usePart.to, sticky = from ? \"after\" : \"before\";\n    return anchor.ch == ch && anchor.sticky == sticky ? range$$1 : new Range(new Pos(anchor.line, ch, sticky), head)\n  }\n\n\n  // Determines whether an event happened in the gutter, and fires the\n  // handlers for the corresponding event.\n  function gutterEvent(cm, e, type, prevent) {\n    var mX, mY;\n    if (e.touches) {\n      mX = e.touches[0].clientX;\n      mY = e.touches[0].clientY;\n    } else {\n      try { mX = e.clientX; mY = e.clientY; }\n      catch(e) { return false }\n    }\n    if (mX >= Math.floor(cm.display.gutters.getBoundingClientRect().right)) { return false }\n    if (prevent) { e_preventDefault(e); }\n\n    var display = cm.display;\n    var lineBox = display.lineDiv.getBoundingClientRect();\n\n    if (mY > lineBox.bottom || !hasHandler(cm, type)) { return e_defaultPrevented(e) }\n    mY -= lineBox.top - display.viewOffset;\n\n    for (var i = 0; i < cm.display.gutterSpecs.length; ++i) {\n      var g = display.gutters.childNodes[i];\n      if (g && g.getBoundingClientRect().right >= mX) {\n        var line = lineAtHeight(cm.doc, mY);\n        var gutter = cm.display.gutterSpecs[i];\n        signal(cm, type, cm, line, gutter.className, e);\n        return e_defaultPrevented(e)\n      }\n    }\n  }\n\n  function clickInGutter(cm, e) {\n    return gutterEvent(cm, e, \"gutterClick\", true)\n  }\n\n  // CONTEXT MENU HANDLING\n\n  // To make the context menu work, we need to briefly unhide the\n  // textarea (making it as unobtrusive as possible) to let the\n  // right-click take effect on it.\n  function onContextMenu(cm, e) {\n    if (eventInWidget(cm.display, e) || contextMenuInGutter(cm, e)) { return }\n    if (signalDOMEvent(cm, e, \"contextmenu\")) { return }\n    if (!captureRightClick) { cm.display.input.onContextMenu(e); }\n  }\n\n  function contextMenuInGutter(cm, e) {\n    if (!hasHandler(cm, \"gutterContextMenu\")) { return false }\n    return gutterEvent(cm, e, \"gutterContextMenu\", false)\n  }\n\n  function themeChanged(cm) {\n    cm.display.wrapper.className = cm.display.wrapper.className.replace(/\\s*cm-s-\\S+/g, \"\") +\n      cm.options.theme.replace(/(^|\\s)\\s*/g, \" cm-s-\");\n    clearCaches(cm);\n  }\n\n  var Init = {toString: function(){return \"CodeMirror.Init\"}};\n\n  var defaults = {};\n  var optionHandlers = {};\n\n  function defineOptions(CodeMirror) {\n    var optionHandlers = CodeMirror.optionHandlers;\n\n    function option(name, deflt, handle, notOnInit) {\n      CodeMirror.defaults[name] = deflt;\n      if (handle) { optionHandlers[name] =\n        notOnInit ? function (cm, val, old) {if (old != Init) { handle(cm, val, old); }} : handle; }\n    }\n\n    CodeMirror.defineOption = option;\n\n    // Passed to option handlers when there is no old value.\n    CodeMirror.Init = Init;\n\n    // These two are, on init, called from the constructor because they\n    // have to be initialized before the editor can start at all.\n    option(\"value\", \"\", function (cm, val) { return cm.setValue(val); }, true);\n    option(\"mode\", null, function (cm, val) {\n      cm.doc.modeOption = val;\n      loadMode(cm);\n    }, true);\n\n    option(\"indentUnit\", 2, loadMode, true);\n    option(\"indentWithTabs\", false);\n    option(\"smartIndent\", true);\n    option(\"tabSize\", 4, function (cm) {\n      resetModeState(cm);\n      clearCaches(cm);\n      regChange(cm);\n    }, true);\n\n    option(\"lineSeparator\", null, function (cm, val) {\n      cm.doc.lineSep = val;\n      if (!val) { return }\n      var newBreaks = [], lineNo = cm.doc.first;\n      cm.doc.iter(function (line) {\n        for (var pos = 0;;) {\n          var found = line.text.indexOf(val, pos);\n          if (found == -1) { break }\n          pos = found + val.length;\n          newBreaks.push(Pos(lineNo, found));\n        }\n        lineNo++;\n      });\n      for (var i = newBreaks.length - 1; i >= 0; i--)\n        { replaceRange(cm.doc, val, newBreaks[i], Pos(newBreaks[i].line, newBreaks[i].ch + val.length)); }\n    });\n    option(\"specialChars\", /[\\u0000-\\u001f\\u007f-\\u009f\\u00ad\\u061c\\u200b-\\u200f\\u2028\\u2029\\ufeff]/g, function (cm, val, old) {\n      cm.state.specialChars = new RegExp(val.source + (val.test(\"\\t\") ? \"\" : \"|\\t\"), \"g\");\n      if (old != Init) { cm.refresh(); }\n    });\n    option(\"specialCharPlaceholder\", defaultSpecialCharPlaceholder, function (cm) { return cm.refresh(); }, true);\n    option(\"electricChars\", true);\n    option(\"inputStyle\", mobile ? \"contenteditable\" : \"textarea\", function () {\n      throw new Error(\"inputStyle can not (yet) be changed in a running editor\") // FIXME\n    }, true);\n    option(\"spellcheck\", false, function (cm, val) { return cm.getInputField().spellcheck = val; }, true);\n    option(\"autocorrect\", false, function (cm, val) { return cm.getInputField().autocorrect = val; }, true);\n    option(\"autocapitalize\", false, function (cm, val) { return cm.getInputField().autocapitalize = val; }, true);\n    option(\"rtlMoveVisually\", !windows);\n    option(\"wholeLineUpdateBefore\", true);\n\n    option(\"theme\", \"default\", function (cm) {\n      themeChanged(cm);\n      updateGutters(cm);\n    }, true);\n    option(\"keyMap\", \"default\", function (cm, val, old) {\n      var next = getKeyMap(val);\n      var prev = old != Init && getKeyMap(old);\n      if (prev && prev.detach) { prev.detach(cm, next); }\n      if (next.attach) { next.attach(cm, prev || null); }\n    });\n    option(\"extraKeys\", null);\n    option(\"configureMouse\", null);\n\n    option(\"lineWrapping\", false, wrappingChanged, true);\n    option(\"gutters\", [], function (cm, val) {\n      cm.display.gutterSpecs = getGutters(val, cm.options.lineNumbers);\n      updateGutters(cm);\n    }, true);\n    option(\"fixedGutter\", true, function (cm, val) {\n      cm.display.gutters.style.left = val ? compensateForHScroll(cm.display) + \"px\" : \"0\";\n      cm.refresh();\n    }, true);\n    option(\"coverGutterNextToScrollbar\", false, function (cm) { return updateScrollbars(cm); }, true);\n    option(\"scrollbarStyle\", \"native\", function (cm) {\n      initScrollbars(cm);\n      updateScrollbars(cm);\n      cm.display.scrollbars.setScrollTop(cm.doc.scrollTop);\n      cm.display.scrollbars.setScrollLeft(cm.doc.scrollLeft);\n    }, true);\n    option(\"lineNumbers\", false, function (cm, val) {\n      cm.display.gutterSpecs = getGutters(cm.options.gutters, val);\n      updateGutters(cm);\n    }, true);\n    option(\"firstLineNumber\", 1, updateGutters, true);\n    option(\"lineNumberFormatter\", function (integer) { return integer; }, updateGutters, true);\n    option(\"showCursorWhenSelecting\", false, updateSelection, true);\n\n    option(\"resetSelectionOnContextMenu\", true);\n    option(\"lineWiseCopyCut\", true);\n    option(\"pasteLinesPerSelection\", true);\n    option(\"selectionsMayTouch\", false);\n\n    option(\"readOnly\", false, function (cm, val) {\n      if (val == \"nocursor\") {\n        onBlur(cm);\n        cm.display.input.blur();\n      }\n      cm.display.input.readOnlyChanged(val);\n    });\n    option(\"disableInput\", false, function (cm, val) {if (!val) { cm.display.input.reset(); }}, true);\n    option(\"dragDrop\", true, dragDropChanged);\n    option(\"allowDropFileTypes\", null);\n\n    option(\"cursorBlinkRate\", 530);\n    option(\"cursorScrollMargin\", 0);\n    option(\"cursorHeight\", 1, updateSelection, true);\n    option(\"singleCursorHeightPerLine\", true, updateSelection, true);\n    option(\"workTime\", 100);\n    option(\"workDelay\", 100);\n    option(\"flattenSpans\", true, resetModeState, true);\n    option(\"addModeClass\", false, resetModeState, true);\n    option(\"pollInterval\", 100);\n    option(\"undoDepth\", 200, function (cm, val) { return cm.doc.history.undoDepth = val; });\n    option(\"historyEventDelay\", 1250);\n    option(\"viewportMargin\", 10, function (cm) { return cm.refresh(); }, true);\n    option(\"maxHighlightLength\", 10000, resetModeState, true);\n    option(\"moveInputWithCursor\", true, function (cm, val) {\n      if (!val) { cm.display.input.resetPosition(); }\n    });\n\n    option(\"tabindex\", null, function (cm, val) { return cm.display.input.getField().tabIndex = val || \"\"; });\n    option(\"autofocus\", null);\n    option(\"direction\", \"ltr\", function (cm, val) { return cm.doc.setDirection(val); }, true);\n    option(\"phrases\", null);\n  }\n\n  function dragDropChanged(cm, value, old) {\n    var wasOn = old && old != Init;\n    if (!value != !wasOn) {\n      var funcs = cm.display.dragFunctions;\n      var toggle = value ? on : off;\n      toggle(cm.display.scroller, \"dragstart\", funcs.start);\n      toggle(cm.display.scroller, \"dragenter\", funcs.enter);\n      toggle(cm.display.scroller, \"dragover\", funcs.over);\n      toggle(cm.display.scroller, \"dragleave\", funcs.leave);\n      toggle(cm.display.scroller, \"drop\", funcs.drop);\n    }\n  }\n\n  function wrappingChanged(cm) {\n    if (cm.options.lineWrapping) {\n      addClass(cm.display.wrapper, \"CodeMirror-wrap\");\n      cm.display.sizer.style.minWidth = \"\";\n      cm.display.sizerWidth = null;\n    } else {\n      rmClass(cm.display.wrapper, \"CodeMirror-wrap\");\n      findMaxLine(cm);\n    }\n    estimateLineHeights(cm);\n    regChange(cm);\n    clearCaches(cm);\n    setTimeout(function () { return updateScrollbars(cm); }, 100);\n  }\n\n  // A CodeMirror instance represents an editor. This is the object\n  // that user code is usually dealing with.\n\n  function CodeMirror(place, options) {\n    var this$1 = this;\n\n    if (!(this instanceof CodeMirror)) { return new CodeMirror(place, options) }\n\n    this.options = options = options ? copyObj(options) : {};\n    // Determine effective options based on given values and defaults.\n    copyObj(defaults, options, false);\n\n    var doc = options.value;\n    if (typeof doc == \"string\") { doc = new Doc(doc, options.mode, null, options.lineSeparator, options.direction); }\n    else if (options.mode) { doc.modeOption = options.mode; }\n    this.doc = doc;\n\n    var input = new CodeMirror.inputStyles[options.inputStyle](this);\n    var display = this.display = new Display(place, doc, input, options);\n    display.wrapper.CodeMirror = this;\n    themeChanged(this);\n    if (options.lineWrapping)\n      { this.display.wrapper.className += \" CodeMirror-wrap\"; }\n    initScrollbars(this);\n\n    this.state = {\n      keyMaps: [],  // stores maps added by addKeyMap\n      overlays: [], // highlighting overlays, as added by addOverlay\n      modeGen: 0,   // bumped when mode/overlay changes, used to invalidate highlighting info\n      overwrite: false,\n      delayingBlurEvent: false,\n      focused: false,\n      suppressEdits: false, // used to disable editing during key handlers when in readOnly mode\n      pasteIncoming: -1, cutIncoming: -1, // help recognize paste/cut edits in input.poll\n      selectingText: false,\n      draggingText: false,\n      highlight: new Delayed(), // stores highlight worker timeout\n      keySeq: null,  // Unfinished key sequence\n      specialChars: null\n    };\n\n    if (options.autofocus && !mobile) { display.input.focus(); }\n\n    // Override magic textarea content restore that IE sometimes does\n    // on our hidden textarea on reload\n    if (ie && ie_version < 11) { setTimeout(function () { return this$1.display.input.reset(true); }, 20); }\n\n    registerEventHandlers(this);\n    ensureGlobalHandlers();\n\n    startOperation(this);\n    this.curOp.forceUpdate = true;\n    attachDoc(this, doc);\n\n    if ((options.autofocus && !mobile) || this.hasFocus())\n      { setTimeout(bind(onFocus, this), 20); }\n    else\n      { onBlur(this); }\n\n    for (var opt in optionHandlers) { if (optionHandlers.hasOwnProperty(opt))\n      { optionHandlers[opt](this$1, options[opt], Init); } }\n    maybeUpdateLineNumberWidth(this);\n    if (options.finishInit) { options.finishInit(this); }\n    for (var i = 0; i < initHooks.length; ++i) { initHooks[i](this$1); }\n    endOperation(this);\n    // Suppress optimizelegibility in Webkit, since it breaks text\n    // measuring on line wrapping boundaries.\n    if (webkit && options.lineWrapping &&\n        getComputedStyle(display.lineDiv).textRendering == \"optimizelegibility\")\n      { display.lineDiv.style.textRendering = \"auto\"; }\n  }\n\n  // The default configuration options.\n  CodeMirror.defaults = defaults;\n  // Functions to run when options are changed.\n  CodeMirror.optionHandlers = optionHandlers;\n\n  // Attach the necessary event handlers when initializing the editor\n  function registerEventHandlers(cm) {\n    var d = cm.display;\n    on(d.scroller, \"mousedown\", operation(cm, onMouseDown));\n    // Older IE's will not fire a second mousedown for a double click\n    if (ie && ie_version < 11)\n      { on(d.scroller, \"dblclick\", operation(cm, function (e) {\n        if (signalDOMEvent(cm, e)) { return }\n        var pos = posFromMouse(cm, e);\n        if (!pos || clickInGutter(cm, e) || eventInWidget(cm.display, e)) { return }\n        e_preventDefault(e);\n        var word = cm.findWordAt(pos);\n        extendSelection(cm.doc, word.anchor, word.head);\n      })); }\n    else\n      { on(d.scroller, \"dblclick\", function (e) { return signalDOMEvent(cm, e) || e_preventDefault(e); }); }\n    // Some browsers fire contextmenu *after* opening the menu, at\n    // which point we can't mess with it anymore. Context menu is\n    // handled in onMouseDown for these browsers.\n    on(d.scroller, \"contextmenu\", function (e) { return onContextMenu(cm, e); });\n\n    // Used to suppress mouse event handling when a touch happens\n    var touchFinished, prevTouch = {end: 0};\n    function finishTouch() {\n      if (d.activeTouch) {\n        touchFinished = setTimeout(function () { return d.activeTouch = null; }, 1000);\n        prevTouch = d.activeTouch;\n        prevTouch.end = +new Date;\n      }\n    }\n    function isMouseLikeTouchEvent(e) {\n      if (e.touches.length != 1) { return false }\n      var touch = e.touches[0];\n      return touch.radiusX <= 1 && touch.radiusY <= 1\n    }\n    function farAway(touch, other) {\n      if (other.left == null) { return true }\n      var dx = other.left - touch.left, dy = other.top - touch.top;\n      return dx * dx + dy * dy > 20 * 20\n    }\n    on(d.scroller, \"touchstart\", function (e) {\n      if (!signalDOMEvent(cm, e) && !isMouseLikeTouchEvent(e) && !clickInGutter(cm, e)) {\n        d.input.ensurePolled();\n        clearTimeout(touchFinished);\n        var now = +new Date;\n        d.activeTouch = {start: now, moved: false,\n                         prev: now - prevTouch.end <= 300 ? prevTouch : null};\n        if (e.touches.length == 1) {\n          d.activeTouch.left = e.touches[0].pageX;\n          d.activeTouch.top = e.touches[0].pageY;\n        }\n      }\n    });\n    on(d.scroller, \"touchmove\", function () {\n      if (d.activeTouch) { d.activeTouch.moved = true; }\n    });\n    on(d.scroller, \"touchend\", function (e) {\n      var touch = d.activeTouch;\n      if (touch && !eventInWidget(d, e) && touch.left != null &&\n          !touch.moved && new Date - touch.start < 300) {\n        var pos = cm.coordsChar(d.activeTouch, \"page\"), range;\n        if (!touch.prev || farAway(touch, touch.prev)) // Single tap\n          { range = new Range(pos, pos); }\n        else if (!touch.prev.prev || farAway(touch, touch.prev.prev)) // Double tap\n          { range = cm.findWordAt(pos); }\n        else // Triple tap\n          { range = new Range(Pos(pos.line, 0), clipPos(cm.doc, Pos(pos.line + 1, 0))); }\n        cm.setSelection(range.anchor, range.head);\n        cm.focus();\n        e_preventDefault(e);\n      }\n      finishTouch();\n    });\n    on(d.scroller, \"touchcancel\", finishTouch);\n\n    // Sync scrolling between fake scrollbars and real scrollable\n    // area, ensure viewport is updated when scrolling.\n    on(d.scroller, \"scroll\", function () {\n      if (d.scroller.clientHeight) {\n        updateScrollTop(cm, d.scroller.scrollTop);\n        setScrollLeft(cm, d.scroller.scrollLeft, true);\n        signal(cm, \"scroll\", cm);\n      }\n    });\n\n    // Listen to wheel events in order to try and update the viewport on time.\n    on(d.scroller, \"mousewheel\", function (e) { return onScrollWheel(cm, e); });\n    on(d.scroller, \"DOMMouseScroll\", function (e) { return onScrollWheel(cm, e); });\n\n    // Prevent wrapper from ever scrolling\n    on(d.wrapper, \"scroll\", function () { return d.wrapper.scrollTop = d.wrapper.scrollLeft = 0; });\n\n    d.dragFunctions = {\n      enter: function (e) {if (!signalDOMEvent(cm, e)) { e_stop(e); }},\n      over: function (e) {if (!signalDOMEvent(cm, e)) { onDragOver(cm, e); e_stop(e); }},\n      start: function (e) { return onDragStart(cm, e); },\n      drop: operation(cm, onDrop),\n      leave: function (e) {if (!signalDOMEvent(cm, e)) { clearDragCursor(cm); }}\n    };\n\n    var inp = d.input.getField();\n    on(inp, \"keyup\", function (e) { return onKeyUp.call(cm, e); });\n    on(inp, \"keydown\", operation(cm, onKeyDown));\n    on(inp, \"keypress\", operation(cm, onKeyPress));\n    on(inp, \"focus\", function (e) { return onFocus(cm, e); });\n    on(inp, \"blur\", function (e) { return onBlur(cm, e); });\n  }\n\n  var initHooks = [];\n  CodeMirror.defineInitHook = function (f) { return initHooks.push(f); };\n\n  // Indent the given line. The how parameter can be \"smart\",\n  // \"add\"/null, \"subtract\", or \"prev\". When aggressive is false\n  // (typically set to true for forced single-line indents), empty\n  // lines are not indented, and places where the mode returns Pass\n  // are left alone.\n  function indentLine(cm, n, how, aggressive) {\n    var doc = cm.doc, state;\n    if (how == null) { how = \"add\"; }\n    if (how == \"smart\") {\n      // Fall back to \"prev\" when the mode doesn't have an indentation\n      // method.\n      if (!doc.mode.indent) { how = \"prev\"; }\n      else { state = getContextBefore(cm, n).state; }\n    }\n\n    var tabSize = cm.options.tabSize;\n    var line = getLine(doc, n), curSpace = countColumn(line.text, null, tabSize);\n    if (line.stateAfter) { line.stateAfter = null; }\n    var curSpaceString = line.text.match(/^\\s*/)[0], indentation;\n    if (!aggressive && !/\\S/.test(line.text)) {\n      indentation = 0;\n      how = \"not\";\n    } else if (how == \"smart\") {\n      indentation = doc.mode.indent(state, line.text.slice(curSpaceString.length), line.text);\n      if (indentation == Pass || indentation > 150) {\n        if (!aggressive) { return }\n        how = \"prev\";\n      }\n    }\n    if (how == \"prev\") {\n      if (n > doc.first) { indentation = countColumn(getLine(doc, n-1).text, null, tabSize); }\n      else { indentation = 0; }\n    } else if (how == \"add\") {\n      indentation = curSpace + cm.options.indentUnit;\n    } else if (how == \"subtract\") {\n      indentation = curSpace - cm.options.indentUnit;\n    } else if (typeof how == \"number\") {\n      indentation = curSpace + how;\n    }\n    indentation = Math.max(0, indentation);\n\n    var indentString = \"\", pos = 0;\n    if (cm.options.indentWithTabs)\n      { for (var i = Math.floor(indentation / tabSize); i; --i) {pos += tabSize; indentString += \"\\t\";} }\n    if (pos < indentation) { indentString += spaceStr(indentation - pos); }\n\n    if (indentString != curSpaceString) {\n      replaceRange(doc, indentString, Pos(n, 0), Pos(n, curSpaceString.length), \"+input\");\n      line.stateAfter = null;\n      return true\n    } else {\n      // Ensure that, if the cursor was in the whitespace at the start\n      // of the line, it is moved to the end of that space.\n      for (var i$1 = 0; i$1 < doc.sel.ranges.length; i$1++) {\n        var range = doc.sel.ranges[i$1];\n        if (range.head.line == n && range.head.ch < curSpaceString.length) {\n          var pos$1 = Pos(n, curSpaceString.length);\n          replaceOneSelection(doc, i$1, new Range(pos$1, pos$1));\n          break\n        }\n      }\n    }\n  }\n\n  // This will be set to a {lineWise: bool, text: [string]} object, so\n  // that, when pasting, we know what kind of selections the copied\n  // text was made out of.\n  var lastCopied = null;\n\n  function setLastCopied(newLastCopied) {\n    lastCopied = newLastCopied;\n  }\n\n  function applyTextInput(cm, inserted, deleted, sel, origin) {\n    var doc = cm.doc;\n    cm.display.shift = false;\n    if (!sel) { sel = doc.sel; }\n\n    var recent = +new Date - 200;\n    var paste = origin == \"paste\" || cm.state.pasteIncoming > recent;\n    var textLines = splitLinesAuto(inserted), multiPaste = null;\n    // When pasting N lines into N selections, insert one line per selection\n    if (paste && sel.ranges.length > 1) {\n      if (lastCopied && lastCopied.text.join(\"\\n\") == inserted) {\n        if (sel.ranges.length % lastCopied.text.length == 0) {\n          multiPaste = [];\n          for (var i = 0; i < lastCopied.text.length; i++)\n            { multiPaste.push(doc.splitLines(lastCopied.text[i])); }\n        }\n      } else if (textLines.length == sel.ranges.length && cm.options.pasteLinesPerSelection) {\n        multiPaste = map(textLines, function (l) { return [l]; });\n      }\n    }\n\n    var updateInput = cm.curOp.updateInput;\n    // Normal behavior is to insert the new text into every selection\n    for (var i$1 = sel.ranges.length - 1; i$1 >= 0; i$1--) {\n      var range$$1 = sel.ranges[i$1];\n      var from = range$$1.from(), to = range$$1.to();\n      if (range$$1.empty()) {\n        if (deleted && deleted > 0) // Handle deletion\n          { from = Pos(from.line, from.ch - deleted); }\n        else if (cm.state.overwrite && !paste) // Handle overwrite\n          { to = Pos(to.line, Math.min(getLine(doc, to.line).text.length, to.ch + lst(textLines).length)); }\n        else if (paste && lastCopied && lastCopied.lineWise && lastCopied.text.join(\"\\n\") == inserted)\n          { from = to = Pos(from.line, 0); }\n      }\n      var changeEvent = {from: from, to: to, text: multiPaste ? multiPaste[i$1 % multiPaste.length] : textLines,\n                         origin: origin || (paste ? \"paste\" : cm.state.cutIncoming > recent ? \"cut\" : \"+input\")};\n      makeChange(cm.doc, changeEvent);\n      signalLater(cm, \"inputRead\", cm, changeEvent);\n    }\n    if (inserted && !paste)\n      { triggerElectric(cm, inserted); }\n\n    ensureCursorVisible(cm);\n    if (cm.curOp.updateInput < 2) { cm.curOp.updateInput = updateInput; }\n    cm.curOp.typing = true;\n    cm.state.pasteIncoming = cm.state.cutIncoming = -1;\n  }\n\n  function handlePaste(e, cm) {\n    var pasted = e.clipboardData && e.clipboardData.getData(\"Text\");\n    if (pasted) {\n      e.preventDefault();\n      if (!cm.isReadOnly() && !cm.options.disableInput)\n        { runInOp(cm, function () { return applyTextInput(cm, pasted, 0, null, \"paste\"); }); }\n      return true\n    }\n  }\n\n  function triggerElectric(cm, inserted) {\n    // When an 'electric' character is inserted, immediately trigger a reindent\n    if (!cm.options.electricChars || !cm.options.smartIndent) { return }\n    var sel = cm.doc.sel;\n\n    for (var i = sel.ranges.length - 1; i >= 0; i--) {\n      var range$$1 = sel.ranges[i];\n      if (range$$1.head.ch > 100 || (i && sel.ranges[i - 1].head.line == range$$1.head.line)) { continue }\n      var mode = cm.getModeAt(range$$1.head);\n      var indented = false;\n      if (mode.electricChars) {\n        for (var j = 0; j < mode.electricChars.length; j++)\n          { if (inserted.indexOf(mode.electricChars.charAt(j)) > -1) {\n            indented = indentLine(cm, range$$1.head.line, \"smart\");\n            break\n          } }\n      } else if (mode.electricInput) {\n        if (mode.electricInput.test(getLine(cm.doc, range$$1.head.line).text.slice(0, range$$1.head.ch)))\n          { indented = indentLine(cm, range$$1.head.line, \"smart\"); }\n      }\n      if (indented) { signalLater(cm, \"electricInput\", cm, range$$1.head.line); }\n    }\n  }\n\n  function copyableRanges(cm) {\n    var text = [], ranges = [];\n    for (var i = 0; i < cm.doc.sel.ranges.length; i++) {\n      var line = cm.doc.sel.ranges[i].head.line;\n      var lineRange = {anchor: Pos(line, 0), head: Pos(line + 1, 0)};\n      ranges.push(lineRange);\n      text.push(cm.getRange(lineRange.anchor, lineRange.head));\n    }\n    return {text: text, ranges: ranges}\n  }\n\n  function disableBrowserMagic(field, spellcheck, autocorrect, autocapitalize) {\n    field.setAttribute(\"autocorrect\", autocorrect ? \"\" : \"off\");\n    field.setAttribute(\"autocapitalize\", autocapitalize ? \"\" : \"off\");\n    field.setAttribute(\"spellcheck\", !!spellcheck);\n  }\n\n  function hiddenTextarea() {\n    var te = elt(\"textarea\", null, null, \"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none\");\n    var div = elt(\"div\", [te], null, \"overflow: hidden; position: relative; width: 3px; height: 0px;\");\n    // The textarea is kept positioned near the cursor to prevent the\n    // fact that it'll be scrolled into view on input from scrolling\n    // our fake cursor out of view. On webkit, when wrap=off, paste is\n    // very slow. So make the area wide instead.\n    if (webkit) { te.style.width = \"1000px\"; }\n    else { te.setAttribute(\"wrap\", \"off\"); }\n    // If border: 0; -- iOS fails to open keyboard (issue #1287)\n    if (ios) { te.style.border = \"1px solid black\"; }\n    disableBrowserMagic(te);\n    return div\n  }\n\n  // The publicly visible API. Note that methodOp(f) means\n  // 'wrap f in an operation, performed on its `this` parameter'.\n\n  // This is not the complete set of editor methods. Most of the\n  // methods defined on the Doc type are also injected into\n  // CodeMirror.prototype, for backwards compatibility and\n  // convenience.\n\n  function addEditorMethods(CodeMirror) {\n    var optionHandlers = CodeMirror.optionHandlers;\n\n    var helpers = CodeMirror.helpers = {};\n\n    CodeMirror.prototype = {\n      constructor: CodeMirror,\n      focus: function(){window.focus(); this.display.input.focus();},\n\n      setOption: function(option, value) {\n        var options = this.options, old = options[option];\n        if (options[option] == value && option != \"mode\") { return }\n        options[option] = value;\n        if (optionHandlers.hasOwnProperty(option))\n          { operation(this, optionHandlers[option])(this, value, old); }\n        signal(this, \"optionChange\", this, option);\n      },\n\n      getOption: function(option) {return this.options[option]},\n      getDoc: function() {return this.doc},\n\n      addKeyMap: function(map$$1, bottom) {\n        this.state.keyMaps[bottom ? \"push\" : \"unshift\"](getKeyMap(map$$1));\n      },\n      removeKeyMap: function(map$$1) {\n        var maps = this.state.keyMaps;\n        for (var i = 0; i < maps.length; ++i)\n          { if (maps[i] == map$$1 || maps[i].name == map$$1) {\n            maps.splice(i, 1);\n            return true\n          } }\n      },\n\n      addOverlay: methodOp(function(spec, options) {\n        var mode = spec.token ? spec : CodeMirror.getMode(this.options, spec);\n        if (mode.startState) { throw new Error(\"Overlays may not be stateful.\") }\n        insertSorted(this.state.overlays,\n                     {mode: mode, modeSpec: spec, opaque: options && options.opaque,\n                      priority: (options && options.priority) || 0},\n                     function (overlay) { return overlay.priority; });\n        this.state.modeGen++;\n        regChange(this);\n      }),\n      removeOverlay: methodOp(function(spec) {\n        var this$1 = this;\n\n        var overlays = this.state.overlays;\n        for (var i = 0; i < overlays.length; ++i) {\n          var cur = overlays[i].modeSpec;\n          if (cur == spec || typeof spec == \"string\" && cur.name == spec) {\n            overlays.splice(i, 1);\n            this$1.state.modeGen++;\n            regChange(this$1);\n            return\n          }\n        }\n      }),\n\n      indentLine: methodOp(function(n, dir, aggressive) {\n        if (typeof dir != \"string\" && typeof dir != \"number\") {\n          if (dir == null) { dir = this.options.smartIndent ? \"smart\" : \"prev\"; }\n          else { dir = dir ? \"add\" : \"subtract\"; }\n        }\n        if (isLine(this.doc, n)) { indentLine(this, n, dir, aggressive); }\n      }),\n      indentSelection: methodOp(function(how) {\n        var this$1 = this;\n\n        var ranges = this.doc.sel.ranges, end = -1;\n        for (var i = 0; i < ranges.length; i++) {\n          var range$$1 = ranges[i];\n          if (!range$$1.empty()) {\n            var from = range$$1.from(), to = range$$1.to();\n            var start = Math.max(end, from.line);\n            end = Math.min(this$1.lastLine(), to.line - (to.ch ? 0 : 1)) + 1;\n            for (var j = start; j < end; ++j)\n              { indentLine(this$1, j, how); }\n            var newRanges = this$1.doc.sel.ranges;\n            if (from.ch == 0 && ranges.length == newRanges.length && newRanges[i].from().ch > 0)\n              { replaceOneSelection(this$1.doc, i, new Range(from, newRanges[i].to()), sel_dontScroll); }\n          } else if (range$$1.head.line > end) {\n            indentLine(this$1, range$$1.head.line, how, true);\n            end = range$$1.head.line;\n            if (i == this$1.doc.sel.primIndex) { ensureCursorVisible(this$1); }\n          }\n        }\n      }),\n\n      // Fetch the parser token for a given character. Useful for hacks\n      // that want to inspect the mode state (say, for completion).\n      getTokenAt: function(pos, precise) {\n        return takeToken(this, pos, precise)\n      },\n\n      getLineTokens: function(line, precise) {\n        return takeToken(this, Pos(line), precise, true)\n      },\n\n      getTokenTypeAt: function(pos) {\n        pos = clipPos(this.doc, pos);\n        var styles = getLineStyles(this, getLine(this.doc, pos.line));\n        var before = 0, after = (styles.length - 1) / 2, ch = pos.ch;\n        var type;\n        if (ch == 0) { type = styles[2]; }\n        else { for (;;) {\n          var mid = (before + after) >> 1;\n          if ((mid ? styles[mid * 2 - 1] : 0) >= ch) { after = mid; }\n          else if (styles[mid * 2 + 1] < ch) { before = mid + 1; }\n          else { type = styles[mid * 2 + 2]; break }\n        } }\n        var cut = type ? type.indexOf(\"overlay \") : -1;\n        return cut < 0 ? type : cut == 0 ? null : type.slice(0, cut - 1)\n      },\n\n      getModeAt: function(pos) {\n        var mode = this.doc.mode;\n        if (!mode.innerMode) { return mode }\n        return CodeMirror.innerMode(mode, this.getTokenAt(pos).state).mode\n      },\n\n      getHelper: function(pos, type) {\n        return this.getHelpers(pos, type)[0]\n      },\n\n      getHelpers: function(pos, type) {\n        var this$1 = this;\n\n        var found = [];\n        if (!helpers.hasOwnProperty(type)) { return found }\n        var help = helpers[type], mode = this.getModeAt(pos);\n        if (typeof mode[type] == \"string\") {\n          if (help[mode[type]]) { found.push(help[mode[type]]); }\n        } else if (mode[type]) {\n          for (var i = 0; i < mode[type].length; i++) {\n            var val = help[mode[type][i]];\n            if (val) { found.push(val); }\n          }\n        } else if (mode.helperType && help[mode.helperType]) {\n          found.push(help[mode.helperType]);\n        } else if (help[mode.name]) {\n          found.push(help[mode.name]);\n        }\n        for (var i$1 = 0; i$1 < help._global.length; i$1++) {\n          var cur = help._global[i$1];\n          if (cur.pred(mode, this$1) && indexOf(found, cur.val) == -1)\n            { found.push(cur.val); }\n        }\n        return found\n      },\n\n      getStateAfter: function(line, precise) {\n        var doc = this.doc;\n        line = clipLine(doc, line == null ? doc.first + doc.size - 1: line);\n        return getContextBefore(this, line + 1, precise).state\n      },\n\n      cursorCoords: function(start, mode) {\n        var pos, range$$1 = this.doc.sel.primary();\n        if (start == null) { pos = range$$1.head; }\n        else if (typeof start == \"object\") { pos = clipPos(this.doc, start); }\n        else { pos = start ? range$$1.from() : range$$1.to(); }\n        return cursorCoords(this, pos, mode || \"page\")\n      },\n\n      charCoords: function(pos, mode) {\n        return charCoords(this, clipPos(this.doc, pos), mode || \"page\")\n      },\n\n      coordsChar: function(coords, mode) {\n        coords = fromCoordSystem(this, coords, mode || \"page\");\n        return coordsChar(this, coords.left, coords.top)\n      },\n\n      lineAtHeight: function(height, mode) {\n        height = fromCoordSystem(this, {top: height, left: 0}, mode || \"page\").top;\n        return lineAtHeight(this.doc, height + this.display.viewOffset)\n      },\n      heightAtLine: function(line, mode, includeWidgets) {\n        var end = false, lineObj;\n        if (typeof line == \"number\") {\n          var last = this.doc.first + this.doc.size - 1;\n          if (line < this.doc.first) { line = this.doc.first; }\n          else if (line > last) { line = last; end = true; }\n          lineObj = getLine(this.doc, line);\n        } else {\n          lineObj = line;\n        }\n        return intoCoordSystem(this, lineObj, {top: 0, left: 0}, mode || \"page\", includeWidgets || end).top +\n          (end ? this.doc.height - heightAtLine(lineObj) : 0)\n      },\n\n      defaultTextHeight: function() { return textHeight(this.display) },\n      defaultCharWidth: function() { return charWidth(this.display) },\n\n      getViewport: function() { return {from: this.display.viewFrom, to: this.display.viewTo}},\n\n      addWidget: function(pos, node, scroll, vert, horiz) {\n        var display = this.display;\n        pos = cursorCoords(this, clipPos(this.doc, pos));\n        var top = pos.bottom, left = pos.left;\n        node.style.position = \"absolute\";\n        node.setAttribute(\"cm-ignore-events\", \"true\");\n        this.display.input.setUneditable(node);\n        display.sizer.appendChild(node);\n        if (vert == \"over\") {\n          top = pos.top;\n        } else if (vert == \"above\" || vert == \"near\") {\n          var vspace = Math.max(display.wrapper.clientHeight, this.doc.height),\n          hspace = Math.max(display.sizer.clientWidth, display.lineSpace.clientWidth);\n          // Default to positioning above (if specified and possible); otherwise default to positioning below\n          if ((vert == 'above' || pos.bottom + node.offsetHeight > vspace) && pos.top > node.offsetHeight)\n            { top = pos.top - node.offsetHeight; }\n          else if (pos.bottom + node.offsetHeight <= vspace)\n            { top = pos.bottom; }\n          if (left + node.offsetWidth > hspace)\n            { left = hspace - node.offsetWidth; }\n        }\n        node.style.top = top + \"px\";\n        node.style.left = node.style.right = \"\";\n        if (horiz == \"right\") {\n          left = display.sizer.clientWidth - node.offsetWidth;\n          node.style.right = \"0px\";\n        } else {\n          if (horiz == \"left\") { left = 0; }\n          else if (horiz == \"middle\") { left = (display.sizer.clientWidth - node.offsetWidth) / 2; }\n          node.style.left = left + \"px\";\n        }\n        if (scroll)\n          { scrollIntoView(this, {left: left, top: top, right: left + node.offsetWidth, bottom: top + node.offsetHeight}); }\n      },\n\n      triggerOnKeyDown: methodOp(onKeyDown),\n      triggerOnKeyPress: methodOp(onKeyPress),\n      triggerOnKeyUp: onKeyUp,\n      triggerOnMouseDown: methodOp(onMouseDown),\n\n      execCommand: function(cmd) {\n        if (commands.hasOwnProperty(cmd))\n          { return commands[cmd].call(null, this) }\n      },\n\n      triggerElectric: methodOp(function(text) { triggerElectric(this, text); }),\n\n      findPosH: function(from, amount, unit, visually) {\n        var this$1 = this;\n\n        var dir = 1;\n        if (amount < 0) { dir = -1; amount = -amount; }\n        var cur = clipPos(this.doc, from);\n        for (var i = 0; i < amount; ++i) {\n          cur = findPosH(this$1.doc, cur, dir, unit, visually);\n          if (cur.hitSide) { break }\n        }\n        return cur\n      },\n\n      moveH: methodOp(function(dir, unit) {\n        var this$1 = this;\n\n        this.extendSelectionsBy(function (range$$1) {\n          if (this$1.display.shift || this$1.doc.extend || range$$1.empty())\n            { return findPosH(this$1.doc, range$$1.head, dir, unit, this$1.options.rtlMoveVisually) }\n          else\n            { return dir < 0 ? range$$1.from() : range$$1.to() }\n        }, sel_move);\n      }),\n\n      deleteH: methodOp(function(dir, unit) {\n        var sel = this.doc.sel, doc = this.doc;\n        if (sel.somethingSelected())\n          { doc.replaceSelection(\"\", null, \"+delete\"); }\n        else\n          { deleteNearSelection(this, function (range$$1) {\n            var other = findPosH(doc, range$$1.head, dir, unit, false);\n            return dir < 0 ? {from: other, to: range$$1.head} : {from: range$$1.head, to: other}\n          }); }\n      }),\n\n      findPosV: function(from, amount, unit, goalColumn) {\n        var this$1 = this;\n\n        var dir = 1, x = goalColumn;\n        if (amount < 0) { dir = -1; amount = -amount; }\n        var cur = clipPos(this.doc, from);\n        for (var i = 0; i < amount; ++i) {\n          var coords = cursorCoords(this$1, cur, \"div\");\n          if (x == null) { x = coords.left; }\n          else { coords.left = x; }\n          cur = findPosV(this$1, coords, dir, unit);\n          if (cur.hitSide) { break }\n        }\n        return cur\n      },\n\n      moveV: methodOp(function(dir, unit) {\n        var this$1 = this;\n\n        var doc = this.doc, goals = [];\n        var collapse = !this.display.shift && !doc.extend && doc.sel.somethingSelected();\n        doc.extendSelectionsBy(function (range$$1) {\n          if (collapse)\n            { return dir < 0 ? range$$1.from() : range$$1.to() }\n          var headPos = cursorCoords(this$1, range$$1.head, \"div\");\n          if (range$$1.goalColumn != null) { headPos.left = range$$1.goalColumn; }\n          goals.push(headPos.left);\n          var pos = findPosV(this$1, headPos, dir, unit);\n          if (unit == \"page\" && range$$1 == doc.sel.primary())\n            { addToScrollTop(this$1, charCoords(this$1, pos, \"div\").top - headPos.top); }\n          return pos\n        }, sel_move);\n        if (goals.length) { for (var i = 0; i < doc.sel.ranges.length; i++)\n          { doc.sel.ranges[i].goalColumn = goals[i]; } }\n      }),\n\n      // Find the word at the given position (as returned by coordsChar).\n      findWordAt: function(pos) {\n        var doc = this.doc, line = getLine(doc, pos.line).text;\n        var start = pos.ch, end = pos.ch;\n        if (line) {\n          var helper = this.getHelper(pos, \"wordChars\");\n          if ((pos.sticky == \"before\" || end == line.length) && start) { --start; } else { ++end; }\n          var startChar = line.charAt(start);\n          var check = isWordChar(startChar, helper)\n            ? function (ch) { return isWordChar(ch, helper); }\n            : /\\s/.test(startChar) ? function (ch) { return /\\s/.test(ch); }\n            : function (ch) { return (!/\\s/.test(ch) && !isWordChar(ch)); };\n          while (start > 0 && check(line.charAt(start - 1))) { --start; }\n          while (end < line.length && check(line.charAt(end))) { ++end; }\n        }\n        return new Range(Pos(pos.line, start), Pos(pos.line, end))\n      },\n\n      toggleOverwrite: function(value) {\n        if (value != null && value == this.state.overwrite) { return }\n        if (this.state.overwrite = !this.state.overwrite)\n          { addClass(this.display.cursorDiv, \"CodeMirror-overwrite\"); }\n        else\n          { rmClass(this.display.cursorDiv, \"CodeMirror-overwrite\"); }\n\n        signal(this, \"overwriteToggle\", this, this.state.overwrite);\n      },\n      hasFocus: function() { return this.display.input.getField() == activeElt() },\n      isReadOnly: function() { return !!(this.options.readOnly || this.doc.cantEdit) },\n\n      scrollTo: methodOp(function (x, y) { scrollToCoords(this, x, y); }),\n      getScrollInfo: function() {\n        var scroller = this.display.scroller;\n        return {left: scroller.scrollLeft, top: scroller.scrollTop,\n                height: scroller.scrollHeight - scrollGap(this) - this.display.barHeight,\n                width: scroller.scrollWidth - scrollGap(this) - this.display.barWidth,\n                clientHeight: displayHeight(this), clientWidth: displayWidth(this)}\n      },\n\n      scrollIntoView: methodOp(function(range$$1, margin) {\n        if (range$$1 == null) {\n          range$$1 = {from: this.doc.sel.primary().head, to: null};\n          if (margin == null) { margin = this.options.cursorScrollMargin; }\n        } else if (typeof range$$1 == \"number\") {\n          range$$1 = {from: Pos(range$$1, 0), to: null};\n        } else if (range$$1.from == null) {\n          range$$1 = {from: range$$1, to: null};\n        }\n        if (!range$$1.to) { range$$1.to = range$$1.from; }\n        range$$1.margin = margin || 0;\n\n        if (range$$1.from.line != null) {\n          scrollToRange(this, range$$1);\n        } else {\n          scrollToCoordsRange(this, range$$1.from, range$$1.to, range$$1.margin);\n        }\n      }),\n\n      setSize: methodOp(function(width, height) {\n        var this$1 = this;\n\n        var interpret = function (val) { return typeof val == \"number\" || /^\\d+$/.test(String(val)) ? val + \"px\" : val; };\n        if (width != null) { this.display.wrapper.style.width = interpret(width); }\n        if (height != null) { this.display.wrapper.style.height = interpret(height); }\n        if (this.options.lineWrapping) { clearLineMeasurementCache(this); }\n        var lineNo$$1 = this.display.viewFrom;\n        this.doc.iter(lineNo$$1, this.display.viewTo, function (line) {\n          if (line.widgets) { for (var i = 0; i < line.widgets.length; i++)\n            { if (line.widgets[i].noHScroll) { regLineChange(this$1, lineNo$$1, \"widget\"); break } } }\n          ++lineNo$$1;\n        });\n        this.curOp.forceUpdate = true;\n        signal(this, \"refresh\", this);\n      }),\n\n      operation: function(f){return runInOp(this, f)},\n      startOperation: function(){return startOperation(this)},\n      endOperation: function(){return endOperation(this)},\n\n      refresh: methodOp(function() {\n        var oldHeight = this.display.cachedTextHeight;\n        regChange(this);\n        this.curOp.forceUpdate = true;\n        clearCaches(this);\n        scrollToCoords(this, this.doc.scrollLeft, this.doc.scrollTop);\n        updateGutterSpace(this.display);\n        if (oldHeight == null || Math.abs(oldHeight - textHeight(this.display)) > .5)\n          { estimateLineHeights(this); }\n        signal(this, \"refresh\", this);\n      }),\n\n      swapDoc: methodOp(function(doc) {\n        var old = this.doc;\n        old.cm = null;\n        // Cancel the current text selection if any (#5821)\n        if (this.state.selectingText) { this.state.selectingText(); }\n        attachDoc(this, doc);\n        clearCaches(this);\n        this.display.input.reset();\n        scrollToCoords(this, doc.scrollLeft, doc.scrollTop);\n        this.curOp.forceScroll = true;\n        signalLater(this, \"swapDoc\", this, old);\n        return old\n      }),\n\n      phrase: function(phraseText) {\n        var phrases = this.options.phrases;\n        return phrases && Object.prototype.hasOwnProperty.call(phrases, phraseText) ? phrases[phraseText] : phraseText\n      },\n\n      getInputField: function(){return this.display.input.getField()},\n      getWrapperElement: function(){return this.display.wrapper},\n      getScrollerElement: function(){return this.display.scroller},\n      getGutterElement: function(){return this.display.gutters}\n    };\n    eventMixin(CodeMirror);\n\n    CodeMirror.registerHelper = function(type, name, value) {\n      if (!helpers.hasOwnProperty(type)) { helpers[type] = CodeMirror[type] = {_global: []}; }\n      helpers[type][name] = value;\n    };\n    CodeMirror.registerGlobalHelper = function(type, name, predicate, value) {\n      CodeMirror.registerHelper(type, name, value);\n      helpers[type]._global.push({pred: predicate, val: value});\n    };\n  }\n\n  // Used for horizontal relative motion. Dir is -1 or 1 (left or\n  // right), unit can be \"char\", \"column\" (like char, but doesn't\n  // cross line boundaries), \"word\" (across next word), or \"group\" (to\n  // the start of next group of word or non-word-non-whitespace\n  // chars). The visually param controls whether, in right-to-left\n  // text, direction 1 means to move towards the next index in the\n  // string, or towards the character to the right of the current\n  // position. The resulting position will have a hitSide=true\n  // property if it reached the end of the document.\n  function findPosH(doc, pos, dir, unit, visually) {\n    var oldPos = pos;\n    var origDir = dir;\n    var lineObj = getLine(doc, pos.line);\n    function findNextLine() {\n      var l = pos.line + dir;\n      if (l < doc.first || l >= doc.first + doc.size) { return false }\n      pos = new Pos(l, pos.ch, pos.sticky);\n      return lineObj = getLine(doc, l)\n    }\n    function moveOnce(boundToLine) {\n      var next;\n      if (visually) {\n        next = moveVisually(doc.cm, lineObj, pos, dir);\n      } else {\n        next = moveLogically(lineObj, pos, dir);\n      }\n      if (next == null) {\n        if (!boundToLine && findNextLine())\n          { pos = endOfLine(visually, doc.cm, lineObj, pos.line, dir); }\n        else\n          { return false }\n      } else {\n        pos = next;\n      }\n      return true\n    }\n\n    if (unit == \"char\") {\n      moveOnce();\n    } else if (unit == \"column\") {\n      moveOnce(true);\n    } else if (unit == \"word\" || unit == \"group\") {\n      var sawType = null, group = unit == \"group\";\n      var helper = doc.cm && doc.cm.getHelper(pos, \"wordChars\");\n      for (var first = true;; first = false) {\n        if (dir < 0 && !moveOnce(!first)) { break }\n        var cur = lineObj.text.charAt(pos.ch) || \"\\n\";\n        var type = isWordChar(cur, helper) ? \"w\"\n          : group && cur == \"\\n\" ? \"n\"\n          : !group || /\\s/.test(cur) ? null\n          : \"p\";\n        if (group && !first && !type) { type = \"s\"; }\n        if (sawType && sawType != type) {\n          if (dir < 0) {dir = 1; moveOnce(); pos.sticky = \"after\";}\n          break\n        }\n\n        if (type) { sawType = type; }\n        if (dir > 0 && !moveOnce(!first)) { break }\n      }\n    }\n    var result = skipAtomic(doc, pos, oldPos, origDir, true);\n    if (equalCursorPos(oldPos, result)) { result.hitSide = true; }\n    return result\n  }\n\n  // For relative vertical movement. Dir may be -1 or 1. Unit can be\n  // \"page\" or \"line\". The resulting position will have a hitSide=true\n  // property if it reached the end of the document.\n  function findPosV(cm, pos, dir, unit) {\n    var doc = cm.doc, x = pos.left, y;\n    if (unit == \"page\") {\n      var pageSize = Math.min(cm.display.wrapper.clientHeight, window.innerHeight || document.documentElement.clientHeight);\n      var moveAmount = Math.max(pageSize - .5 * textHeight(cm.display), 3);\n      y = (dir > 0 ? pos.bottom : pos.top) + dir * moveAmount;\n\n    } else if (unit == \"line\") {\n      y = dir > 0 ? pos.bottom + 3 : pos.top - 3;\n    }\n    var target;\n    for (;;) {\n      target = coordsChar(cm, x, y);\n      if (!target.outside) { break }\n      if (dir < 0 ? y <= 0 : y >= doc.height) { target.hitSide = true; break }\n      y += dir * 5;\n    }\n    return target\n  }\n\n  // CONTENTEDITABLE INPUT STYLE\n\n  var ContentEditableInput = function(cm) {\n    this.cm = cm;\n    this.lastAnchorNode = this.lastAnchorOffset = this.lastFocusNode = this.lastFocusOffset = null;\n    this.polling = new Delayed();\n    this.composing = null;\n    this.gracePeriod = false;\n    this.readDOMTimeout = null;\n  };\n\n  ContentEditableInput.prototype.init = function (display) {\n      var this$1 = this;\n\n    var input = this, cm = input.cm;\n    var div = input.div = display.lineDiv;\n    disableBrowserMagic(div, cm.options.spellcheck, cm.options.autocorrect, cm.options.autocapitalize);\n\n    on(div, \"paste\", function (e) {\n      if (signalDOMEvent(cm, e) || handlePaste(e, cm)) { return }\n      // IE doesn't fire input events, so we schedule a read for the pasted content in this way\n      if (ie_version <= 11) { setTimeout(operation(cm, function () { return this$1.updateFromDOM(); }), 20); }\n    });\n\n    on(div, \"compositionstart\", function (e) {\n      this$1.composing = {data: e.data, done: false};\n    });\n    on(div, \"compositionupdate\", function (e) {\n      if (!this$1.composing) { this$1.composing = {data: e.data, done: false}; }\n    });\n    on(div, \"compositionend\", function (e) {\n      if (this$1.composing) {\n        if (e.data != this$1.composing.data) { this$1.readFromDOMSoon(); }\n        this$1.composing.done = true;\n      }\n    });\n\n    on(div, \"touchstart\", function () { return input.forceCompositionEnd(); });\n\n    on(div, \"input\", function () {\n      if (!this$1.composing) { this$1.readFromDOMSoon(); }\n    });\n\n    function onCopyCut(e) {\n      if (signalDOMEvent(cm, e)) { return }\n      if (cm.somethingSelected()) {\n        setLastCopied({lineWise: false, text: cm.getSelections()});\n        if (e.type == \"cut\") { cm.replaceSelection(\"\", null, \"cut\"); }\n      } else if (!cm.options.lineWiseCopyCut) {\n        return\n      } else {\n        var ranges = copyableRanges(cm);\n        setLastCopied({lineWise: true, text: ranges.text});\n        if (e.type == \"cut\") {\n          cm.operation(function () {\n            cm.setSelections(ranges.ranges, 0, sel_dontScroll);\n            cm.replaceSelection(\"\", null, \"cut\");\n          });\n        }\n      }\n      if (e.clipboardData) {\n        e.clipboardData.clearData();\n        var content = lastCopied.text.join(\"\\n\");\n        // iOS exposes the clipboard API, but seems to discard content inserted into it\n        e.clipboardData.setData(\"Text\", content);\n        if (e.clipboardData.getData(\"Text\") == content) {\n          e.preventDefault();\n          return\n        }\n      }\n      // Old-fashioned briefly-focus-a-textarea hack\n      var kludge = hiddenTextarea(), te = kludge.firstChild;\n      cm.display.lineSpace.insertBefore(kludge, cm.display.lineSpace.firstChild);\n      te.value = lastCopied.text.join(\"\\n\");\n      var hadFocus = document.activeElement;\n      selectInput(te);\n      setTimeout(function () {\n        cm.display.lineSpace.removeChild(kludge);\n        hadFocus.focus();\n        if (hadFocus == div) { input.showPrimarySelection(); }\n      }, 50);\n    }\n    on(div, \"copy\", onCopyCut);\n    on(div, \"cut\", onCopyCut);\n  };\n\n  ContentEditableInput.prototype.prepareSelection = function () {\n    var result = prepareSelection(this.cm, false);\n    result.focus = this.cm.state.focused;\n    return result\n  };\n\n  ContentEditableInput.prototype.showSelection = function (info, takeFocus) {\n    if (!info || !this.cm.display.view.length) { return }\n    if (info.focus || takeFocus) { this.showPrimarySelection(); }\n    this.showMultipleSelections(info);\n  };\n\n  ContentEditableInput.prototype.getSelection = function () {\n    return this.cm.display.wrapper.ownerDocument.getSelection()\n  };\n\n  ContentEditableInput.prototype.showPrimarySelection = function () {\n    var sel = this.getSelection(), cm = this.cm, prim = cm.doc.sel.primary();\n    var from = prim.from(), to = prim.to();\n\n    if (cm.display.viewTo == cm.display.viewFrom || from.line >= cm.display.viewTo || to.line < cm.display.viewFrom) {\n      sel.removeAllRanges();\n      return\n    }\n\n    var curAnchor = domToPos(cm, sel.anchorNode, sel.anchorOffset);\n    var curFocus = domToPos(cm, sel.focusNode, sel.focusOffset);\n    if (curAnchor && !curAnchor.bad && curFocus && !curFocus.bad &&\n        cmp(minPos(curAnchor, curFocus), from) == 0 &&\n        cmp(maxPos(curAnchor, curFocus), to) == 0)\n      { return }\n\n    var view = cm.display.view;\n    var start = (from.line >= cm.display.viewFrom && posToDOM(cm, from)) ||\n        {node: view[0].measure.map[2], offset: 0};\n    var end = to.line < cm.display.viewTo && posToDOM(cm, to);\n    if (!end) {\n      var measure = view[view.length - 1].measure;\n      var map$$1 = measure.maps ? measure.maps[measure.maps.length - 1] : measure.map;\n      end = {node: map$$1[map$$1.length - 1], offset: map$$1[map$$1.length - 2] - map$$1[map$$1.length - 3]};\n    }\n\n    if (!start || !end) {\n      sel.removeAllRanges();\n      return\n    }\n\n    var old = sel.rangeCount && sel.getRangeAt(0), rng;\n    try { rng = range(start.node, start.offset, end.offset, end.node); }\n    catch(e) {} // Our model of the DOM might be outdated, in which case the range we try to set can be impossible\n    if (rng) {\n      if (!gecko && cm.state.focused) {\n        sel.collapse(start.node, start.offset);\n        if (!rng.collapsed) {\n          sel.removeAllRanges();\n          sel.addRange(rng);\n        }\n      } else {\n        sel.removeAllRanges();\n        sel.addRange(rng);\n      }\n      if (old && sel.anchorNode == null) { sel.addRange(old); }\n      else if (gecko) { this.startGracePeriod(); }\n    }\n    this.rememberSelection();\n  };\n\n  ContentEditableInput.prototype.startGracePeriod = function () {\n      var this$1 = this;\n\n    clearTimeout(this.gracePeriod);\n    this.gracePeriod = setTimeout(function () {\n      this$1.gracePeriod = false;\n      if (this$1.selectionChanged())\n        { this$1.cm.operation(function () { return this$1.cm.curOp.selectionChanged = true; }); }\n    }, 20);\n  };\n\n  ContentEditableInput.prototype.showMultipleSelections = function (info) {\n    removeChildrenAndAdd(this.cm.display.cursorDiv, info.cursors);\n    removeChildrenAndAdd(this.cm.display.selectionDiv, info.selection);\n  };\n\n  ContentEditableInput.prototype.rememberSelection = function () {\n    var sel = this.getSelection();\n    this.lastAnchorNode = sel.anchorNode; this.lastAnchorOffset = sel.anchorOffset;\n    this.lastFocusNode = sel.focusNode; this.lastFocusOffset = sel.focusOffset;\n  };\n\n  ContentEditableInput.prototype.selectionInEditor = function () {\n    var sel = this.getSelection();\n    if (!sel.rangeCount) { return false }\n    var node = sel.getRangeAt(0).commonAncestorContainer;\n    return contains(this.div, node)\n  };\n\n  ContentEditableInput.prototype.focus = function () {\n    if (this.cm.options.readOnly != \"nocursor\") {\n      if (!this.selectionInEditor())\n        { this.showSelection(this.prepareSelection(), true); }\n      this.div.focus();\n    }\n  };\n  ContentEditableInput.prototype.blur = function () { this.div.blur(); };\n  ContentEditableInput.prototype.getField = function () { return this.div };\n\n  ContentEditableInput.prototype.supportsTouch = function () { return true };\n\n  ContentEditableInput.prototype.receivedFocus = function () {\n    var input = this;\n    if (this.selectionInEditor())\n      { this.pollSelection(); }\n    else\n      { runInOp(this.cm, function () { return input.cm.curOp.selectionChanged = true; }); }\n\n    function poll() {\n      if (input.cm.state.focused) {\n        input.pollSelection();\n        input.polling.set(input.cm.options.pollInterval, poll);\n      }\n    }\n    this.polling.set(this.cm.options.pollInterval, poll);\n  };\n\n  ContentEditableInput.prototype.selectionChanged = function () {\n    var sel = this.getSelection();\n    return sel.anchorNode != this.lastAnchorNode || sel.anchorOffset != this.lastAnchorOffset ||\n      sel.focusNode != this.lastFocusNode || sel.focusOffset != this.lastFocusOffset\n  };\n\n  ContentEditableInput.prototype.pollSelection = function () {\n    if (this.readDOMTimeout != null || this.gracePeriod || !this.selectionChanged()) { return }\n    var sel = this.getSelection(), cm = this.cm;\n    // On Android Chrome (version 56, at least), backspacing into an\n    // uneditable block element will put the cursor in that element,\n    // and then, because it's not editable, hide the virtual keyboard.\n    // Because Android doesn't allow us to actually detect backspace\n    // presses in a sane way, this code checks for when that happens\n    // and simulates a backspace press in this case.\n    if (android && chrome && this.cm.display.gutterSpecs.length && isInGutter(sel.anchorNode)) {\n      this.cm.triggerOnKeyDown({type: \"keydown\", keyCode: 8, preventDefault: Math.abs});\n      this.blur();\n      this.focus();\n      return\n    }\n    if (this.composing) { return }\n    this.rememberSelection();\n    var anchor = domToPos(cm, sel.anchorNode, sel.anchorOffset);\n    var head = domToPos(cm, sel.focusNode, sel.focusOffset);\n    if (anchor && head) { runInOp(cm, function () {\n      setSelection(cm.doc, simpleSelection(anchor, head), sel_dontScroll);\n      if (anchor.bad || head.bad) { cm.curOp.selectionChanged = true; }\n    }); }\n  };\n\n  ContentEditableInput.prototype.pollContent = function () {\n    if (this.readDOMTimeout != null) {\n      clearTimeout(this.readDOMTimeout);\n      this.readDOMTimeout = null;\n    }\n\n    var cm = this.cm, display = cm.display, sel = cm.doc.sel.primary();\n    var from = sel.from(), to = sel.to();\n    if (from.ch == 0 && from.line > cm.firstLine())\n      { from = Pos(from.line - 1, getLine(cm.doc, from.line - 1).length); }\n    if (to.ch == getLine(cm.doc, to.line).text.length && to.line < cm.lastLine())\n      { to = Pos(to.line + 1, 0); }\n    if (from.line < display.viewFrom || to.line > display.viewTo - 1) { return false }\n\n    var fromIndex, fromLine, fromNode;\n    if (from.line == display.viewFrom || (fromIndex = findViewIndex(cm, from.line)) == 0) {\n      fromLine = lineNo(display.view[0].line);\n      fromNode = display.view[0].node;\n    } else {\n      fromLine = lineNo(display.view[fromIndex].line);\n      fromNode = display.view[fromIndex - 1].node.nextSibling;\n    }\n    var toIndex = findViewIndex(cm, to.line);\n    var toLine, toNode;\n    if (toIndex == display.view.length - 1) {\n      toLine = display.viewTo - 1;\n      toNode = display.lineDiv.lastChild;\n    } else {\n      toLine = lineNo(display.view[toIndex + 1].line) - 1;\n      toNode = display.view[toIndex + 1].node.previousSibling;\n    }\n\n    if (!fromNode) { return false }\n    var newText = cm.doc.splitLines(domTextBetween(cm, fromNode, toNode, fromLine, toLine));\n    var oldText = getBetween(cm.doc, Pos(fromLine, 0), Pos(toLine, getLine(cm.doc, toLine).text.length));\n    while (newText.length > 1 && oldText.length > 1) {\n      if (lst(newText) == lst(oldText)) { newText.pop(); oldText.pop(); toLine--; }\n      else if (newText[0] == oldText[0]) { newText.shift(); oldText.shift(); fromLine++; }\n      else { break }\n    }\n\n    var cutFront = 0, cutEnd = 0;\n    var newTop = newText[0], oldTop = oldText[0], maxCutFront = Math.min(newTop.length, oldTop.length);\n    while (cutFront < maxCutFront && newTop.charCodeAt(cutFront) == oldTop.charCodeAt(cutFront))\n      { ++cutFront; }\n    var newBot = lst(newText), oldBot = lst(oldText);\n    var maxCutEnd = Math.min(newBot.length - (newText.length == 1 ? cutFront : 0),\n                             oldBot.length - (oldText.length == 1 ? cutFront : 0));\n    while (cutEnd < maxCutEnd &&\n           newBot.charCodeAt(newBot.length - cutEnd - 1) == oldBot.charCodeAt(oldBot.length - cutEnd - 1))\n      { ++cutEnd; }\n    // Try to move start of change to start of selection if ambiguous\n    if (newText.length == 1 && oldText.length == 1 && fromLine == from.line) {\n      while (cutFront && cutFront > from.ch &&\n             newBot.charCodeAt(newBot.length - cutEnd - 1) == oldBot.charCodeAt(oldBot.length - cutEnd - 1)) {\n        cutFront--;\n        cutEnd++;\n      }\n    }\n\n    newText[newText.length - 1] = newBot.slice(0, newBot.length - cutEnd).replace(/^\\u200b+/, \"\");\n    newText[0] = newText[0].slice(cutFront).replace(/\\u200b+$/, \"\");\n\n    var chFrom = Pos(fromLine, cutFront);\n    var chTo = Pos(toLine, oldText.length ? lst(oldText).length - cutEnd : 0);\n    if (newText.length > 1 || newText[0] || cmp(chFrom, chTo)) {\n      replaceRange(cm.doc, newText, chFrom, chTo, \"+input\");\n      return true\n    }\n  };\n\n  ContentEditableInput.prototype.ensurePolled = function () {\n    this.forceCompositionEnd();\n  };\n  ContentEditableInput.prototype.reset = function () {\n    this.forceCompositionEnd();\n  };\n  ContentEditableInput.prototype.forceCompositionEnd = function () {\n    if (!this.composing) { return }\n    clearTimeout(this.readDOMTimeout);\n    this.composing = null;\n    this.updateFromDOM();\n    this.div.blur();\n    this.div.focus();\n  };\n  ContentEditableInput.prototype.readFromDOMSoon = function () {\n      var this$1 = this;\n\n    if (this.readDOMTimeout != null) { return }\n    this.readDOMTimeout = setTimeout(function () {\n      this$1.readDOMTimeout = null;\n      if (this$1.composing) {\n        if (this$1.composing.done) { this$1.composing = null; }\n        else { return }\n      }\n      this$1.updateFromDOM();\n    }, 80);\n  };\n\n  ContentEditableInput.prototype.updateFromDOM = function () {\n      var this$1 = this;\n\n    if (this.cm.isReadOnly() || !this.pollContent())\n      { runInOp(this.cm, function () { return regChange(this$1.cm); }); }\n  };\n\n  ContentEditableInput.prototype.setUneditable = function (node) {\n    node.contentEditable = \"false\";\n  };\n\n  ContentEditableInput.prototype.onKeyPress = function (e) {\n    if (e.charCode == 0 || this.composing) { return }\n    e.preventDefault();\n    if (!this.cm.isReadOnly())\n      { operation(this.cm, applyTextInput)(this.cm, String.fromCharCode(e.charCode == null ? e.keyCode : e.charCode), 0); }\n  };\n\n  ContentEditableInput.prototype.readOnlyChanged = function (val) {\n    this.div.contentEditable = String(val != \"nocursor\");\n  };\n\n  ContentEditableInput.prototype.onContextMenu = function () {};\n  ContentEditableInput.prototype.resetPosition = function () {};\n\n  ContentEditableInput.prototype.needsContentAttribute = true;\n\n  function posToDOM(cm, pos) {\n    var view = findViewForLine(cm, pos.line);\n    if (!view || view.hidden) { return null }\n    var line = getLine(cm.doc, pos.line);\n    var info = mapFromLineView(view, line, pos.line);\n\n    var order = getOrder(line, cm.doc.direction), side = \"left\";\n    if (order) {\n      var partPos = getBidiPartAt(order, pos.ch);\n      side = partPos % 2 ? \"right\" : \"left\";\n    }\n    var result = nodeAndOffsetInLineMap(info.map, pos.ch, side);\n    result.offset = result.collapse == \"right\" ? result.end : result.start;\n    return result\n  }\n\n  function isInGutter(node) {\n    for (var scan = node; scan; scan = scan.parentNode)\n      { if (/CodeMirror-gutter-wrapper/.test(scan.className)) { return true } }\n    return false\n  }\n\n  function badPos(pos, bad) { if (bad) { pos.bad = true; } return pos }\n\n  function domTextBetween(cm, from, to, fromLine, toLine) {\n    var text = \"\", closing = false, lineSep = cm.doc.lineSeparator(), extraLinebreak = false;\n    function recognizeMarker(id) { return function (marker) { return marker.id == id; } }\n    function close() {\n      if (closing) {\n        text += lineSep;\n        if (extraLinebreak) { text += lineSep; }\n        closing = extraLinebreak = false;\n      }\n    }\n    function addText(str) {\n      if (str) {\n        close();\n        text += str;\n      }\n    }\n    function walk(node) {\n      if (node.nodeType == 1) {\n        var cmText = node.getAttribute(\"cm-text\");\n        if (cmText) {\n          addText(cmText);\n          return\n        }\n        var markerID = node.getAttribute(\"cm-marker\"), range$$1;\n        if (markerID) {\n          var found = cm.findMarks(Pos(fromLine, 0), Pos(toLine + 1, 0), recognizeMarker(+markerID));\n          if (found.length && (range$$1 = found[0].find(0)))\n            { addText(getBetween(cm.doc, range$$1.from, range$$1.to).join(lineSep)); }\n          return\n        }\n        if (node.getAttribute(\"contenteditable\") == \"false\") { return }\n        var isBlock = /^(pre|div|p|li|table|br)$/i.test(node.nodeName);\n        if (!/^br$/i.test(node.nodeName) && node.textContent.length == 0) { return }\n\n        if (isBlock) { close(); }\n        for (var i = 0; i < node.childNodes.length; i++)\n          { walk(node.childNodes[i]); }\n\n        if (/^(pre|p)$/i.test(node.nodeName)) { extraLinebreak = true; }\n        if (isBlock) { closing = true; }\n      } else if (node.nodeType == 3) {\n        addText(node.nodeValue.replace(/\\u200b/g, \"\").replace(/\\u00a0/g, \" \"));\n      }\n    }\n    for (;;) {\n      walk(from);\n      if (from == to) { break }\n      from = from.nextSibling;\n      extraLinebreak = false;\n    }\n    return text\n  }\n\n  function domToPos(cm, node, offset) {\n    var lineNode;\n    if (node == cm.display.lineDiv) {\n      lineNode = cm.display.lineDiv.childNodes[offset];\n      if (!lineNode) { return badPos(cm.clipPos(Pos(cm.display.viewTo - 1)), true) }\n      node = null; offset = 0;\n    } else {\n      for (lineNode = node;; lineNode = lineNode.parentNode) {\n        if (!lineNode || lineNode == cm.display.lineDiv) { return null }\n        if (lineNode.parentNode && lineNode.parentNode == cm.display.lineDiv) { break }\n      }\n    }\n    for (var i = 0; i < cm.display.view.length; i++) {\n      var lineView = cm.display.view[i];\n      if (lineView.node == lineNode)\n        { return locateNodeInLineView(lineView, node, offset) }\n    }\n  }\n\n  function locateNodeInLineView(lineView, node, offset) {\n    var wrapper = lineView.text.firstChild, bad = false;\n    if (!node || !contains(wrapper, node)) { return badPos(Pos(lineNo(lineView.line), 0), true) }\n    if (node == wrapper) {\n      bad = true;\n      node = wrapper.childNodes[offset];\n      offset = 0;\n      if (!node) {\n        var line = lineView.rest ? lst(lineView.rest) : lineView.line;\n        return badPos(Pos(lineNo(line), line.text.length), bad)\n      }\n    }\n\n    var textNode = node.nodeType == 3 ? node : null, topNode = node;\n    if (!textNode && node.childNodes.length == 1 && node.firstChild.nodeType == 3) {\n      textNode = node.firstChild;\n      if (offset) { offset = textNode.nodeValue.length; }\n    }\n    while (topNode.parentNode != wrapper) { topNode = topNode.parentNode; }\n    var measure = lineView.measure, maps = measure.maps;\n\n    function find(textNode, topNode, offset) {\n      for (var i = -1; i < (maps ? maps.length : 0); i++) {\n        var map$$1 = i < 0 ? measure.map : maps[i];\n        for (var j = 0; j < map$$1.length; j += 3) {\n          var curNode = map$$1[j + 2];\n          if (curNode == textNode || curNode == topNode) {\n            var line = lineNo(i < 0 ? lineView.line : lineView.rest[i]);\n            var ch = map$$1[j] + offset;\n            if (offset < 0 || curNode != textNode) { ch = map$$1[j + (offset ? 1 : 0)]; }\n            return Pos(line, ch)\n          }\n        }\n      }\n    }\n    var found = find(textNode, topNode, offset);\n    if (found) { return badPos(found, bad) }\n\n    // FIXME this is all really shaky. might handle the few cases it needs to handle, but likely to cause problems\n    for (var after = topNode.nextSibling, dist = textNode ? textNode.nodeValue.length - offset : 0; after; after = after.nextSibling) {\n      found = find(after, after.firstChild, 0);\n      if (found)\n        { return badPos(Pos(found.line, found.ch - dist), bad) }\n      else\n        { dist += after.textContent.length; }\n    }\n    for (var before = topNode.previousSibling, dist$1 = offset; before; before = before.previousSibling) {\n      found = find(before, before.firstChild, -1);\n      if (found)\n        { return badPos(Pos(found.line, found.ch + dist$1), bad) }\n      else\n        { dist$1 += before.textContent.length; }\n    }\n  }\n\n  // TEXTAREA INPUT STYLE\n\n  var TextareaInput = function(cm) {\n    this.cm = cm;\n    // See input.poll and input.reset\n    this.prevInput = \"\";\n\n    // Flag that indicates whether we expect input to appear real soon\n    // now (after some event like 'keypress' or 'input') and are\n    // polling intensively.\n    this.pollingFast = false;\n    // Self-resetting timeout for the poller\n    this.polling = new Delayed();\n    // Used to work around IE issue with selection being forgotten when focus moves away from textarea\n    this.hasSelection = false;\n    this.composing = null;\n  };\n\n  TextareaInput.prototype.init = function (display) {\n      var this$1 = this;\n\n    var input = this, cm = this.cm;\n    this.createField(display);\n    var te = this.textarea;\n\n    display.wrapper.insertBefore(this.wrapper, display.wrapper.firstChild);\n\n    // Needed to hide big blue blinking cursor on Mobile Safari (doesn't seem to work in iOS 8 anymore)\n    if (ios) { te.style.width = \"0px\"; }\n\n    on(te, \"input\", function () {\n      if (ie && ie_version >= 9 && this$1.hasSelection) { this$1.hasSelection = null; }\n      input.poll();\n    });\n\n    on(te, \"paste\", function (e) {\n      if (signalDOMEvent(cm, e) || handlePaste(e, cm)) { return }\n\n      cm.state.pasteIncoming = +new Date;\n      input.fastPoll();\n    });\n\n    function prepareCopyCut(e) {\n      if (signalDOMEvent(cm, e)) { return }\n      if (cm.somethingSelected()) {\n        setLastCopied({lineWise: false, text: cm.getSelections()});\n      } else if (!cm.options.lineWiseCopyCut) {\n        return\n      } else {\n        var ranges = copyableRanges(cm);\n        setLastCopied({lineWise: true, text: ranges.text});\n        if (e.type == \"cut\") {\n          cm.setSelections(ranges.ranges, null, sel_dontScroll);\n        } else {\n          input.prevInput = \"\";\n          te.value = ranges.text.join(\"\\n\");\n          selectInput(te);\n        }\n      }\n      if (e.type == \"cut\") { cm.state.cutIncoming = +new Date; }\n    }\n    on(te, \"cut\", prepareCopyCut);\n    on(te, \"copy\", prepareCopyCut);\n\n    on(display.scroller, \"paste\", function (e) {\n      if (eventInWidget(display, e) || signalDOMEvent(cm, e)) { return }\n      if (!te.dispatchEvent) {\n        cm.state.pasteIncoming = +new Date;\n        input.focus();\n        return\n      }\n\n      // Pass the `paste` event to the textarea so it's handled by its event listener.\n      var event = new Event(\"paste\");\n      event.clipboardData = e.clipboardData;\n      te.dispatchEvent(event);\n    });\n\n    // Prevent normal selection in the editor (we handle our own)\n    on(display.lineSpace, \"selectstart\", function (e) {\n      if (!eventInWidget(display, e)) { e_preventDefault(e); }\n    });\n\n    on(te, \"compositionstart\", function () {\n      var start = cm.getCursor(\"from\");\n      if (input.composing) { input.composing.range.clear(); }\n      input.composing = {\n        start: start,\n        range: cm.markText(start, cm.getCursor(\"to\"), {className: \"CodeMirror-composing\"})\n      };\n    });\n    on(te, \"compositionend\", function () {\n      if (input.composing) {\n        input.poll();\n        input.composing.range.clear();\n        input.composing = null;\n      }\n    });\n  };\n\n  TextareaInput.prototype.createField = function (_display) {\n    // Wraps and hides input textarea\n    this.wrapper = hiddenTextarea();\n    // The semihidden textarea that is focused when the editor is\n    // focused, and receives input.\n    this.textarea = this.wrapper.firstChild;\n  };\n\n  TextareaInput.prototype.prepareSelection = function () {\n    // Redraw the selection and/or cursor\n    var cm = this.cm, display = cm.display, doc = cm.doc;\n    var result = prepareSelection(cm);\n\n    // Move the hidden textarea near the cursor to prevent scrolling artifacts\n    if (cm.options.moveInputWithCursor) {\n      var headPos = cursorCoords(cm, doc.sel.primary().head, \"div\");\n      var wrapOff = display.wrapper.getBoundingClientRect(), lineOff = display.lineDiv.getBoundingClientRect();\n      result.teTop = Math.max(0, Math.min(display.wrapper.clientHeight - 10,\n                                          headPos.top + lineOff.top - wrapOff.top));\n      result.teLeft = Math.max(0, Math.min(display.wrapper.clientWidth - 10,\n                                           headPos.left + lineOff.left - wrapOff.left));\n    }\n\n    return result\n  };\n\n  TextareaInput.prototype.showSelection = function (drawn) {\n    var cm = this.cm, display = cm.display;\n    removeChildrenAndAdd(display.cursorDiv, drawn.cursors);\n    removeChildrenAndAdd(display.selectionDiv, drawn.selection);\n    if (drawn.teTop != null) {\n      this.wrapper.style.top = drawn.teTop + \"px\";\n      this.wrapper.style.left = drawn.teLeft + \"px\";\n    }\n  };\n\n  // Reset the input to correspond to the selection (or to be empty,\n  // when not typing and nothing is selected)\n  TextareaInput.prototype.reset = function (typing) {\n    if (this.contextMenuPending || this.composing) { return }\n    var cm = this.cm;\n    if (cm.somethingSelected()) {\n      this.prevInput = \"\";\n      var content = cm.getSelection();\n      this.textarea.value = content;\n      if (cm.state.focused) { selectInput(this.textarea); }\n      if (ie && ie_version >= 9) { this.hasSelection = content; }\n    } else if (!typing) {\n      this.prevInput = this.textarea.value = \"\";\n      if (ie && ie_version >= 9) { this.hasSelection = null; }\n    }\n  };\n\n  TextareaInput.prototype.getField = function () { return this.textarea };\n\n  TextareaInput.prototype.supportsTouch = function () { return false };\n\n  TextareaInput.prototype.focus = function () {\n    if (this.cm.options.readOnly != \"nocursor\" && (!mobile || activeElt() != this.textarea)) {\n      try { this.textarea.focus(); }\n      catch (e) {} // IE8 will throw if the textarea is display: none or not in DOM\n    }\n  };\n\n  TextareaInput.prototype.blur = function () { this.textarea.blur(); };\n\n  TextareaInput.prototype.resetPosition = function () {\n    this.wrapper.style.top = this.wrapper.style.left = 0;\n  };\n\n  TextareaInput.prototype.receivedFocus = function () { this.slowPoll(); };\n\n  // Poll for input changes, using the normal rate of polling. This\n  // runs as long as the editor is focused.\n  TextareaInput.prototype.slowPoll = function () {\n      var this$1 = this;\n\n    if (this.pollingFast) { return }\n    this.polling.set(this.cm.options.pollInterval, function () {\n      this$1.poll();\n      if (this$1.cm.state.focused) { this$1.slowPoll(); }\n    });\n  };\n\n  // When an event has just come in that is likely to add or change\n  // something in the input textarea, we poll faster, to ensure that\n  // the change appears on the screen quickly.\n  TextareaInput.prototype.fastPoll = function () {\n    var missed = false, input = this;\n    input.pollingFast = true;\n    function p() {\n      var changed = input.poll();\n      if (!changed && !missed) {missed = true; input.polling.set(60, p);}\n      else {input.pollingFast = false; input.slowPoll();}\n    }\n    input.polling.set(20, p);\n  };\n\n  // Read input from the textarea, and update the document to match.\n  // When something is selected, it is present in the textarea, and\n  // selected (unless it is huge, in which case a placeholder is\n  // used). When nothing is selected, the cursor sits after previously\n  // seen text (can be empty), which is stored in prevInput (we must\n  // not reset the textarea when typing, because that breaks IME).\n  TextareaInput.prototype.poll = function () {\n      var this$1 = this;\n\n    var cm = this.cm, input = this.textarea, prevInput = this.prevInput;\n    // Since this is called a *lot*, try to bail out as cheaply as\n    // possible when it is clear that nothing happened. hasSelection\n    // will be the case when there is a lot of text in the textarea,\n    // in which case reading its value would be expensive.\n    if (this.contextMenuPending || !cm.state.focused ||\n        (hasSelection(input) && !prevInput && !this.composing) ||\n        cm.isReadOnly() || cm.options.disableInput || cm.state.keySeq)\n      { return false }\n\n    var text = input.value;\n    // If nothing changed, bail.\n    if (text == prevInput && !cm.somethingSelected()) { return false }\n    // Work around nonsensical selection resetting in IE9/10, and\n    // inexplicable appearance of private area unicode characters on\n    // some key combos in Mac (#2689).\n    if (ie && ie_version >= 9 && this.hasSelection === text ||\n        mac && /[\\uf700-\\uf7ff]/.test(text)) {\n      cm.display.input.reset();\n      return false\n    }\n\n    if (cm.doc.sel == cm.display.selForContextMenu) {\n      var first = text.charCodeAt(0);\n      if (first == 0x200b && !prevInput) { prevInput = \"\\u200b\"; }\n      if (first == 0x21da) { this.reset(); return this.cm.execCommand(\"undo\") }\n    }\n    // Find the part of the input that is actually new\n    var same = 0, l = Math.min(prevInput.length, text.length);\n    while (same < l && prevInput.charCodeAt(same) == text.charCodeAt(same)) { ++same; }\n\n    runInOp(cm, function () {\n      applyTextInput(cm, text.slice(same), prevInput.length - same,\n                     null, this$1.composing ? \"*compose\" : null);\n\n      // Don't leave long text in the textarea, since it makes further polling slow\n      if (text.length > 1000 || text.indexOf(\"\\n\") > -1) { input.value = this$1.prevInput = \"\"; }\n      else { this$1.prevInput = text; }\n\n      if (this$1.composing) {\n        this$1.composing.range.clear();\n        this$1.composing.range = cm.markText(this$1.composing.start, cm.getCursor(\"to\"),\n                                           {className: \"CodeMirror-composing\"});\n      }\n    });\n    return true\n  };\n\n  TextareaInput.prototype.ensurePolled = function () {\n    if (this.pollingFast && this.poll()) { this.pollingFast = false; }\n  };\n\n  TextareaInput.prototype.onKeyPress = function () {\n    if (ie && ie_version >= 9) { this.hasSelection = null; }\n    this.fastPoll();\n  };\n\n  TextareaInput.prototype.onContextMenu = function (e) {\n    var input = this, cm = input.cm, display = cm.display, te = input.textarea;\n    if (input.contextMenuPending) { input.contextMenuPending(); }\n    var pos = posFromMouse(cm, e), scrollPos = display.scroller.scrollTop;\n    if (!pos || presto) { return } // Opera is difficult.\n\n    // Reset the current text selection only if the click is done outside of the selection\n    // and 'resetSelectionOnContextMenu' option is true.\n    var reset = cm.options.resetSelectionOnContextMenu;\n    if (reset && cm.doc.sel.contains(pos) == -1)\n      { operation(cm, setSelection)(cm.doc, simpleSelection(pos), sel_dontScroll); }\n\n    var oldCSS = te.style.cssText, oldWrapperCSS = input.wrapper.style.cssText;\n    var wrapperBox = input.wrapper.offsetParent.getBoundingClientRect();\n    input.wrapper.style.cssText = \"position: static\";\n    te.style.cssText = \"position: absolute; width: 30px; height: 30px;\\n      top: \" + (e.clientY - wrapperBox.top - 5) + \"px; left: \" + (e.clientX - wrapperBox.left - 5) + \"px;\\n      z-index: 1000; background: \" + (ie ? \"rgba(255, 255, 255, .05)\" : \"transparent\") + \";\\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);\";\n    var oldScrollY;\n    if (webkit) { oldScrollY = window.scrollY; } // Work around Chrome issue (#2712)\n    display.input.focus();\n    if (webkit) { window.scrollTo(null, oldScrollY); }\n    display.input.reset();\n    // Adds \"Select all\" to context menu in FF\n    if (!cm.somethingSelected()) { te.value = input.prevInput = \" \"; }\n    input.contextMenuPending = rehide;\n    display.selForContextMenu = cm.doc.sel;\n    clearTimeout(display.detectingSelectAll);\n\n    // Select-all will be greyed out if there's nothing to select, so\n    // this adds a zero-width space so that we can later check whether\n    // it got selected.\n    function prepareSelectAllHack() {\n      if (te.selectionStart != null) {\n        var selected = cm.somethingSelected();\n        var extval = \"\\u200b\" + (selected ? te.value : \"\");\n        te.value = \"\\u21da\"; // Used to catch context-menu undo\n        te.value = extval;\n        input.prevInput = selected ? \"\" : \"\\u200b\";\n        te.selectionStart = 1; te.selectionEnd = extval.length;\n        // Re-set this, in case some other handler touched the\n        // selection in the meantime.\n        display.selForContextMenu = cm.doc.sel;\n      }\n    }\n    function rehide() {\n      if (input.contextMenuPending != rehide) { return }\n      input.contextMenuPending = false;\n      input.wrapper.style.cssText = oldWrapperCSS;\n      te.style.cssText = oldCSS;\n      if (ie && ie_version < 9) { display.scrollbars.setScrollTop(display.scroller.scrollTop = scrollPos); }\n\n      // Try to detect the user choosing select-all\n      if (te.selectionStart != null) {\n        if (!ie || (ie && ie_version < 9)) { prepareSelectAllHack(); }\n        var i = 0, poll = function () {\n          if (display.selForContextMenu == cm.doc.sel && te.selectionStart == 0 &&\n              te.selectionEnd > 0 && input.prevInput == \"\\u200b\") {\n            operation(cm, selectAll)(cm);\n          } else if (i++ < 10) {\n            display.detectingSelectAll = setTimeout(poll, 500);\n          } else {\n            display.selForContextMenu = null;\n            display.input.reset();\n          }\n        };\n        display.detectingSelectAll = setTimeout(poll, 200);\n      }\n    }\n\n    if (ie && ie_version >= 9) { prepareSelectAllHack(); }\n    if (captureRightClick) {\n      e_stop(e);\n      var mouseup = function () {\n        off(window, \"mouseup\", mouseup);\n        setTimeout(rehide, 20);\n      };\n      on(window, \"mouseup\", mouseup);\n    } else {\n      setTimeout(rehide, 50);\n    }\n  };\n\n  TextareaInput.prototype.readOnlyChanged = function (val) {\n    if (!val) { this.reset(); }\n    this.textarea.disabled = val == \"nocursor\";\n  };\n\n  TextareaInput.prototype.setUneditable = function () {};\n\n  TextareaInput.prototype.needsContentAttribute = false;\n\n  function fromTextArea(textarea, options) {\n    options = options ? copyObj(options) : {};\n    options.value = textarea.value;\n    if (!options.tabindex && textarea.tabIndex)\n      { options.tabindex = textarea.tabIndex; }\n    if (!options.placeholder && textarea.placeholder)\n      { options.placeholder = textarea.placeholder; }\n    // Set autofocus to true if this textarea is focused, or if it has\n    // autofocus and no other element is focused.\n    if (options.autofocus == null) {\n      var hasFocus = activeElt();\n      options.autofocus = hasFocus == textarea ||\n        textarea.getAttribute(\"autofocus\") != null && hasFocus == document.body;\n    }\n\n    function save() {textarea.value = cm.getValue();}\n\n    var realSubmit;\n    if (textarea.form) {\n      on(textarea.form, \"submit\", save);\n      // Deplorable hack to make the submit method do the right thing.\n      if (!options.leaveSubmitMethodAlone) {\n        var form = textarea.form;\n        realSubmit = form.submit;\n        try {\n          var wrappedSubmit = form.submit = function () {\n            save();\n            form.submit = realSubmit;\n            form.submit();\n            form.submit = wrappedSubmit;\n          };\n        } catch(e) {}\n      }\n    }\n\n    options.finishInit = function (cm) {\n      cm.save = save;\n      cm.getTextArea = function () { return textarea; };\n      cm.toTextArea = function () {\n        cm.toTextArea = isNaN; // Prevent this from being ran twice\n        save();\n        textarea.parentNode.removeChild(cm.getWrapperElement());\n        textarea.style.display = \"\";\n        if (textarea.form) {\n          off(textarea.form, \"submit\", save);\n          if (typeof textarea.form.submit == \"function\")\n            { textarea.form.submit = realSubmit; }\n        }\n      };\n    };\n\n    textarea.style.display = \"none\";\n    var cm = CodeMirror(function (node) { return textarea.parentNode.insertBefore(node, textarea.nextSibling); },\n      options);\n    return cm\n  }\n\n  function addLegacyProps(CodeMirror) {\n    CodeMirror.off = off;\n    CodeMirror.on = on;\n    CodeMirror.wheelEventPixels = wheelEventPixels;\n    CodeMirror.Doc = Doc;\n    CodeMirror.splitLines = splitLinesAuto;\n    CodeMirror.countColumn = countColumn;\n    CodeMirror.findColumn = findColumn;\n    CodeMirror.isWordChar = isWordCharBasic;\n    CodeMirror.Pass = Pass;\n    CodeMirror.signal = signal;\n    CodeMirror.Line = Line;\n    CodeMirror.changeEnd = changeEnd;\n    CodeMirror.scrollbarModel = scrollbarModel;\n    CodeMirror.Pos = Pos;\n    CodeMirror.cmpPos = cmp;\n    CodeMirror.modes = modes;\n    CodeMirror.mimeModes = mimeModes;\n    CodeMirror.resolveMode = resolveMode;\n    CodeMirror.getMode = getMode;\n    CodeMirror.modeExtensions = modeExtensions;\n    CodeMirror.extendMode = extendMode;\n    CodeMirror.copyState = copyState;\n    CodeMirror.startState = startState;\n    CodeMirror.innerMode = innerMode;\n    CodeMirror.commands = commands;\n    CodeMirror.keyMap = keyMap;\n    CodeMirror.keyName = keyName;\n    CodeMirror.isModifierKey = isModifierKey;\n    CodeMirror.lookupKey = lookupKey;\n    CodeMirror.normalizeKeyMap = normalizeKeyMap;\n    CodeMirror.StringStream = StringStream;\n    CodeMirror.SharedTextMarker = SharedTextMarker;\n    CodeMirror.TextMarker = TextMarker;\n    CodeMirror.LineWidget = LineWidget;\n    CodeMirror.e_preventDefault = e_preventDefault;\n    CodeMirror.e_stopPropagation = e_stopPropagation;\n    CodeMirror.e_stop = e_stop;\n    CodeMirror.addClass = addClass;\n    CodeMirror.contains = contains;\n    CodeMirror.rmClass = rmClass;\n    CodeMirror.keyNames = keyNames;\n  }\n\n  // EDITOR CONSTRUCTOR\n\n  defineOptions(CodeMirror);\n\n  addEditorMethods(CodeMirror);\n\n  // Set up methods on CodeMirror's prototype to redirect to the editor's document.\n  var dontDelegate = \"iter insert remove copy getEditor constructor\".split(\" \");\n  for (var prop in Doc.prototype) { if (Doc.prototype.hasOwnProperty(prop) && indexOf(dontDelegate, prop) < 0)\n    { CodeMirror.prototype[prop] = (function(method) {\n      return function() {return method.apply(this.doc, arguments)}\n    })(Doc.prototype[prop]); } }\n\n  eventMixin(Doc);\n  CodeMirror.inputStyles = {\"textarea\": TextareaInput, \"contenteditable\": ContentEditableInput};\n\n  // Extra arguments are stored as the mode's dependencies, which is\n  // used by (legacy) mechanisms like loadmode.js to automatically\n  // load a mode. (Preferred mechanism is the require/define calls.)\n  CodeMirror.defineMode = function(name/*, mode, */) {\n    if (!CodeMirror.defaults.mode && name != \"null\") { CodeMirror.defaults.mode = name; }\n    defineMode.apply(this, arguments);\n  };\n\n  CodeMirror.defineMIME = defineMIME;\n\n  // Minimal default mode.\n  CodeMirror.defineMode(\"null\", function () { return ({token: function (stream) { return stream.skipToEnd(); }}); });\n  CodeMirror.defineMIME(\"text/plain\", \"null\");\n\n  // EXTENSIONS\n\n  CodeMirror.defineExtension = function (name, func) {\n    CodeMirror.prototype[name] = func;\n  };\n  CodeMirror.defineDocExtension = function (name, func) {\n    Doc.prototype[name] = func;\n  };\n\n  CodeMirror.fromTextArea = fromTextArea;\n\n  addLegacyProps(CodeMirror);\n\n  CodeMirror.version = \"5.46.0\";\n\n  return CodeMirror;\n\n})));\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n\"use strict\";\n\nCodeMirror.defineMode(\"javascript\", function(config, parserConfig) {\n  var indentUnit = config.indentUnit;\n  var statementIndent = parserConfig.statementIndent;\n  var jsonldMode = parserConfig.jsonld;\n  var jsonMode = parserConfig.json || jsonldMode;\n  var isTS = parserConfig.typescript;\n  var wordRE = parserConfig.wordCharacters || /[\\w$\\xa1-\\uffff]/;\n\n  // Tokenizer\n\n  var keywords = function(){\n    function kw(type) {return {type: type, style: \"keyword\"};}\n    var A = kw(\"keyword a\"), B = kw(\"keyword b\"), C = kw(\"keyword c\"), D = kw(\"keyword d\");\n    var operator = kw(\"operator\"), atom = {type: \"atom\", style: \"atom\"};\n\n    return {\n      \"if\": kw(\"if\"), \"while\": A, \"with\": A, \"else\": B, \"do\": B, \"try\": B, \"finally\": B,\n      \"return\": D, \"break\": D, \"continue\": D, \"new\": kw(\"new\"), \"delete\": C, \"void\": C, \"throw\": C,\n      \"debugger\": kw(\"debugger\"), \"var\": kw(\"var\"), \"const\": kw(\"var\"), \"let\": kw(\"var\"),\n      \"function\": kw(\"function\"), \"catch\": kw(\"catch\"),\n      \"for\": kw(\"for\"), \"switch\": kw(\"switch\"), \"case\": kw(\"case\"), \"default\": kw(\"default\"),\n      \"in\": operator, \"typeof\": operator, \"instanceof\": operator,\n      \"true\": atom, \"false\": atom, \"null\": atom, \"undefined\": atom, \"NaN\": atom, \"Infinity\": atom,\n      \"this\": kw(\"this\"), \"class\": kw(\"class\"), \"super\": kw(\"atom\"),\n      \"yield\": C, \"export\": kw(\"export\"), \"import\": kw(\"import\"), \"extends\": C,\n      \"await\": C\n    };\n  }();\n\n  var isOperatorChar = /[+\\-*&%=<>!?|~^@]/;\n  var isJsonldKeyword = /^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)\"/;\n\n  function readRegexp(stream) {\n    var escaped = false, next, inSet = false;\n    while ((next = stream.next()) != null) {\n      if (!escaped) {\n        if (next == \"/\" && !inSet) return;\n        if (next == \"[\") inSet = true;\n        else if (inSet && next == \"]\") inSet = false;\n      }\n      escaped = !escaped && next == \"\\\\\";\n    }\n  }\n\n  // Used as scratch variables to communicate multiple values without\n  // consing up tons of objects.\n  var type, content;\n  function ret(tp, style, cont) {\n    type = tp; content = cont;\n    return style;\n  }\n  function tokenBase(stream, state) {\n    var ch = stream.next();\n    if (ch == '\"' || ch == \"'\") {\n      state.tokenize = tokenString(ch);\n      return state.tokenize(stream, state);\n    } else if (ch == \".\" && stream.match(/^\\d+(?:[eE][+\\-]?\\d+)?/)) {\n      return ret(\"number\", \"number\");\n    } else if (ch == \".\" && stream.match(\"..\")) {\n      return ret(\"spread\", \"meta\");\n    } else if (/[\\[\\]{}\\(\\),;\\:\\.]/.test(ch)) {\n      return ret(ch);\n    } else if (ch == \"=\" && stream.eat(\">\")) {\n      return ret(\"=>\", \"operator\");\n    } else if (ch == \"0\" && stream.match(/^(?:x[\\da-f]+|o[0-7]+|b[01]+)n?/i)) {\n      return ret(\"number\", \"number\");\n    } else if (/\\d/.test(ch)) {\n      stream.match(/^\\d*(?:n|(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?)?/);\n      return ret(\"number\", \"number\");\n    } else if (ch == \"/\") {\n      if (stream.eat(\"*\")) {\n        state.tokenize = tokenComment;\n        return tokenComment(stream, state);\n      } else if (stream.eat(\"/\")) {\n        stream.skipToEnd();\n        return ret(\"comment\", \"comment\");\n      } else if (expressionAllowed(stream, state, 1)) {\n        readRegexp(stream);\n        stream.match(/^\\b(([gimyus])(?![gimyus]*\\2))+\\b/);\n        return ret(\"regexp\", \"string-2\");\n      } else {\n        stream.eat(\"=\");\n        return ret(\"operator\", \"operator\", stream.current());\n      }\n    } else if (ch == \"`\") {\n      state.tokenize = tokenQuasi;\n      return tokenQuasi(stream, state);\n    } else if (ch == \"#\") {\n      stream.skipToEnd();\n      return ret(\"error\", \"error\");\n    } else if (isOperatorChar.test(ch)) {\n      if (ch != \">\" || !state.lexical || state.lexical.type != \">\") {\n        if (stream.eat(\"=\")) {\n          if (ch == \"!\" || ch == \"=\") stream.eat(\"=\")\n        } else if (/[<>*+\\-]/.test(ch)) {\n          stream.eat(ch)\n          if (ch == \">\") stream.eat(ch)\n        }\n      }\n      return ret(\"operator\", \"operator\", stream.current());\n    } else if (wordRE.test(ch)) {\n      stream.eatWhile(wordRE);\n      var word = stream.current()\n      if (state.lastType != \".\") {\n        if (keywords.propertyIsEnumerable(word)) {\n          var kw = keywords[word]\n          return ret(kw.type, kw.style, word)\n        }\n        if (word == \"async\" && stream.match(/^(\\s|\\/\\*.*?\\*\\/)*[\\[\\(\\w]/, false))\n          return ret(\"async\", \"keyword\", word)\n      }\n      return ret(\"variable\", \"variable\", word)\n    }\n  }\n\n  function tokenString(quote) {\n    return function(stream, state) {\n      var escaped = false, next;\n      if (jsonldMode && stream.peek() == \"@\" && stream.match(isJsonldKeyword)){\n        state.tokenize = tokenBase;\n        return ret(\"jsonld-keyword\", \"meta\");\n      }\n      while ((next = stream.next()) != null) {\n        if (next == quote && !escaped) break;\n        escaped = !escaped && next == \"\\\\\";\n      }\n      if (!escaped) state.tokenize = tokenBase;\n      return ret(\"string\", \"string\");\n    };\n  }\n\n  function tokenComment(stream, state) {\n    var maybeEnd = false, ch;\n    while (ch = stream.next()) {\n      if (ch == \"/\" && maybeEnd) {\n        state.tokenize = tokenBase;\n        break;\n      }\n      maybeEnd = (ch == \"*\");\n    }\n    return ret(\"comment\", \"comment\");\n  }\n\n  function tokenQuasi(stream, state) {\n    var escaped = false, next;\n    while ((next = stream.next()) != null) {\n      if (!escaped && (next == \"`\" || next == \"$\" && stream.eat(\"{\"))) {\n        state.tokenize = tokenBase;\n        break;\n      }\n      escaped = !escaped && next == \"\\\\\";\n    }\n    return ret(\"quasi\", \"string-2\", stream.current());\n  }\n\n  var brackets = \"([{}])\";\n  // This is a crude lookahead trick to try and notice that we're\n  // parsing the argument patterns for a fat-arrow function before we\n  // actually hit the arrow token. It only works if the arrow is on\n  // the same line as the arguments and there's no strange noise\n  // (comments) in between. Fallback is to only notice when we hit the\n  // arrow, and not declare the arguments as locals for the arrow\n  // body.\n  function findFatArrow(stream, state) {\n    if (state.fatArrowAt) state.fatArrowAt = null;\n    var arrow = stream.string.indexOf(\"=>\", stream.start);\n    if (arrow < 0) return;\n\n    if (isTS) { // Try to skip TypeScript return type declarations after the arguments\n      var m = /:\\s*(?:\\w+(?:<[^>]*>|\\[\\])?|\\{[^}]*\\})\\s*$/.exec(stream.string.slice(stream.start, arrow))\n      if (m) arrow = m.index\n    }\n\n    var depth = 0, sawSomething = false;\n    for (var pos = arrow - 1; pos >= 0; --pos) {\n      var ch = stream.string.charAt(pos);\n      var bracket = brackets.indexOf(ch);\n      if (bracket >= 0 && bracket < 3) {\n        if (!depth) { ++pos; break; }\n        if (--depth == 0) { if (ch == \"(\") sawSomething = true; break; }\n      } else if (bracket >= 3 && bracket < 6) {\n        ++depth;\n      } else if (wordRE.test(ch)) {\n        sawSomething = true;\n      } else if (/[\"'\\/]/.test(ch)) {\n        return;\n      } else if (sawSomething && !depth) {\n        ++pos;\n        break;\n      }\n    }\n    if (sawSomething && !depth) state.fatArrowAt = pos;\n  }\n\n  // Parser\n\n  var atomicTypes = {\"atom\": true, \"number\": true, \"variable\": true, \"string\": true, \"regexp\": true, \"this\": true, \"jsonld-keyword\": true};\n\n  function JSLexical(indented, column, type, align, prev, info) {\n    this.indented = indented;\n    this.column = column;\n    this.type = type;\n    this.prev = prev;\n    this.info = info;\n    if (align != null) this.align = align;\n  }\n\n  function inScope(state, varname) {\n    for (var v = state.localVars; v; v = v.next)\n      if (v.name == varname) return true;\n    for (var cx = state.context; cx; cx = cx.prev) {\n      for (var v = cx.vars; v; v = v.next)\n        if (v.name == varname) return true;\n    }\n  }\n\n  function parseJS(state, style, type, content, stream) {\n    var cc = state.cc;\n    // Communicate our context to the combinators.\n    // (Less wasteful than consing up a hundred closures on every call.)\n    cx.state = state; cx.stream = stream; cx.marked = null, cx.cc = cc; cx.style = style;\n\n    if (!state.lexical.hasOwnProperty(\"align\"))\n      state.lexical.align = true;\n\n    while(true) {\n      var combinator = cc.length ? cc.pop() : jsonMode ? expression : statement;\n      if (combinator(type, content)) {\n        while(cc.length && cc[cc.length - 1].lex)\n          cc.pop()();\n        if (cx.marked) return cx.marked;\n        if (type == \"variable\" && inScope(state, content)) return \"variable-2\";\n        return style;\n      }\n    }\n  }\n\n  // Combinator utils\n\n  var cx = {state: null, column: null, marked: null, cc: null};\n  function pass() {\n    for (var i = arguments.length - 1; i >= 0; i--) cx.cc.push(arguments[i]);\n  }\n  function cont() {\n    pass.apply(null, arguments);\n    return true;\n  }\n  function inList(name, list) {\n    for (var v = list; v; v = v.next) if (v.name == name) return true\n    return false;\n  }\n  function register(varname) {\n    var state = cx.state;\n    cx.marked = \"def\";\n    if (state.context) {\n      if (state.lexical.info == \"var\" && state.context && state.context.block) {\n        // FIXME function decls are also not block scoped\n        var newContext = registerVarScoped(varname, state.context)\n        if (newContext != null) {\n          state.context = newContext\n          return\n        }\n      } else if (!inList(varname, state.localVars)) {\n        state.localVars = new Var(varname, state.localVars)\n        return\n      }\n    }\n    // Fall through means this is global\n    if (parserConfig.globalVars && !inList(varname, state.globalVars))\n      state.globalVars = new Var(varname, state.globalVars)\n  }\n  function registerVarScoped(varname, context) {\n    if (!context) {\n      return null\n    } else if (context.block) {\n      var inner = registerVarScoped(varname, context.prev)\n      if (!inner) return null\n      if (inner == context.prev) return context\n      return new Context(inner, context.vars, true)\n    } else if (inList(varname, context.vars)) {\n      return context\n    } else {\n      return new Context(context.prev, new Var(varname, context.vars), false)\n    }\n  }\n\n  function isModifier(name) {\n    return name == \"public\" || name == \"private\" || name == \"protected\" || name == \"abstract\" || name == \"readonly\"\n  }\n\n  // Combinators\n\n  function Context(prev, vars, block) { this.prev = prev; this.vars = vars; this.block = block }\n  function Var(name, next) { this.name = name; this.next = next }\n\n  var defaultVars = new Var(\"this\", new Var(\"arguments\", null))\n  function pushcontext() {\n    cx.state.context = new Context(cx.state.context, cx.state.localVars, false)\n    cx.state.localVars = defaultVars\n  }\n  function pushblockcontext() {\n    cx.state.context = new Context(cx.state.context, cx.state.localVars, true)\n    cx.state.localVars = null\n  }\n  function popcontext() {\n    cx.state.localVars = cx.state.context.vars\n    cx.state.context = cx.state.context.prev\n  }\n  popcontext.lex = true\n  function pushlex(type, info) {\n    var result = function() {\n      var state = cx.state, indent = state.indented;\n      if (state.lexical.type == \"stat\") indent = state.lexical.indented;\n      else for (var outer = state.lexical; outer && outer.type == \")\" && outer.align; outer = outer.prev)\n        indent = outer.indented;\n      state.lexical = new JSLexical(indent, cx.stream.column(), type, null, state.lexical, info);\n    };\n    result.lex = true;\n    return result;\n  }\n  function poplex() {\n    var state = cx.state;\n    if (state.lexical.prev) {\n      if (state.lexical.type == \")\")\n        state.indented = state.lexical.indented;\n      state.lexical = state.lexical.prev;\n    }\n  }\n  poplex.lex = true;\n\n  function expect(wanted) {\n    function exp(type) {\n      if (type == wanted) return cont();\n      else if (wanted == \";\" || type == \"}\" || type == \")\" || type == \"]\") return pass();\n      else return cont(exp);\n    };\n    return exp;\n  }\n\n  function statement(type, value) {\n    if (type == \"var\") return cont(pushlex(\"vardef\", value), vardef, expect(\";\"), poplex);\n    if (type == \"keyword a\") return cont(pushlex(\"form\"), parenExpr, statement, poplex);\n    if (type == \"keyword b\") return cont(pushlex(\"form\"), statement, poplex);\n    if (type == \"keyword d\") return cx.stream.match(/^\\s*$/, false) ? cont() : cont(pushlex(\"stat\"), maybeexpression, expect(\";\"), poplex);\n    if (type == \"debugger\") return cont(expect(\";\"));\n    if (type == \"{\") return cont(pushlex(\"}\"), pushblockcontext, block, poplex, popcontext);\n    if (type == \";\") return cont();\n    if (type == \"if\") {\n      if (cx.state.lexical.info == \"else\" && cx.state.cc[cx.state.cc.length - 1] == poplex)\n        cx.state.cc.pop()();\n      return cont(pushlex(\"form\"), parenExpr, statement, poplex, maybeelse);\n    }\n    if (type == \"function\") return cont(functiondef);\n    if (type == \"for\") return cont(pushlex(\"form\"), forspec, statement, poplex);\n    if (type == \"class\" || (isTS && value == \"interface\")) {\n      cx.marked = \"keyword\"\n      return cont(pushlex(\"form\", type == \"class\" ? type : value), className, poplex)\n    }\n    if (type == \"variable\") {\n      if (isTS && value == \"declare\") {\n        cx.marked = \"keyword\"\n        return cont(statement)\n      } else if (isTS && (value == \"module\" || value == \"enum\" || value == \"type\") && cx.stream.match(/^\\s*\\w/, false)) {\n        cx.marked = \"keyword\"\n        if (value == \"enum\") return cont(enumdef);\n        else if (value == \"type\") return cont(typename, expect(\"operator\"), typeexpr, expect(\";\"));\n        else return cont(pushlex(\"form\"), pattern, expect(\"{\"), pushlex(\"}\"), block, poplex, poplex)\n      } else if (isTS && value == \"namespace\") {\n        cx.marked = \"keyword\"\n        return cont(pushlex(\"form\"), expression, statement, poplex)\n      } else if (isTS && value == \"abstract\") {\n        cx.marked = \"keyword\"\n        return cont(statement)\n      } else {\n        return cont(pushlex(\"stat\"), maybelabel);\n      }\n    }\n    if (type == \"switch\") return cont(pushlex(\"form\"), parenExpr, expect(\"{\"), pushlex(\"}\", \"switch\"), pushblockcontext,\n                                      block, poplex, poplex, popcontext);\n    if (type == \"case\") return cont(expression, expect(\":\"));\n    if (type == \"default\") return cont(expect(\":\"));\n    if (type == \"catch\") return cont(pushlex(\"form\"), pushcontext, maybeCatchBinding, statement, poplex, popcontext);\n    if (type == \"export\") return cont(pushlex(\"stat\"), afterExport, poplex);\n    if (type == \"import\") return cont(pushlex(\"stat\"), afterImport, poplex);\n    if (type == \"async\") return cont(statement)\n    if (value == \"@\") return cont(expression, statement)\n    return pass(pushlex(\"stat\"), expression, expect(\";\"), poplex);\n  }\n  function maybeCatchBinding(type) {\n    if (type == \"(\") return cont(funarg, expect(\")\"))\n  }\n  function expression(type, value) {\n    return expressionInner(type, value, false);\n  }\n  function expressionNoComma(type, value) {\n    return expressionInner(type, value, true);\n  }\n  function parenExpr(type) {\n    if (type != \"(\") return pass()\n    return cont(pushlex(\")\"), expression, expect(\")\"), poplex)\n  }\n  function expressionInner(type, value, noComma) {\n    if (cx.state.fatArrowAt == cx.stream.start) {\n      var body = noComma ? arrowBodyNoComma : arrowBody;\n      if (type == \"(\") return cont(pushcontext, pushlex(\")\"), commasep(funarg, \")\"), poplex, expect(\"=>\"), body, popcontext);\n      else if (type == \"variable\") return pass(pushcontext, pattern, expect(\"=>\"), body, popcontext);\n    }\n\n    var maybeop = noComma ? maybeoperatorNoComma : maybeoperatorComma;\n    if (atomicTypes.hasOwnProperty(type)) return cont(maybeop);\n    if (type == \"function\") return cont(functiondef, maybeop);\n    if (type == \"class\" || (isTS && value == \"interface\")) { cx.marked = \"keyword\"; return cont(pushlex(\"form\"), classExpression, poplex); }\n    if (type == \"keyword c\" || type == \"async\") return cont(noComma ? expressionNoComma : expression);\n    if (type == \"(\") return cont(pushlex(\")\"), maybeexpression, expect(\")\"), poplex, maybeop);\n    if (type == \"operator\" || type == \"spread\") return cont(noComma ? expressionNoComma : expression);\n    if (type == \"[\") return cont(pushlex(\"]\"), arrayLiteral, poplex, maybeop);\n    if (type == \"{\") return contCommasep(objprop, \"}\", null, maybeop);\n    if (type == \"quasi\") return pass(quasi, maybeop);\n    if (type == \"new\") return cont(maybeTarget(noComma));\n    if (type == \"import\") return cont(expression);\n    return cont();\n  }\n  function maybeexpression(type) {\n    if (type.match(/[;\\}\\)\\],]/)) return pass();\n    return pass(expression);\n  }\n\n  function maybeoperatorComma(type, value) {\n    if (type == \",\") return cont(expression);\n    return maybeoperatorNoComma(type, value, false);\n  }\n  function maybeoperatorNoComma(type, value, noComma) {\n    var me = noComma == false ? maybeoperatorComma : maybeoperatorNoComma;\n    var expr = noComma == false ? expression : expressionNoComma;\n    if (type == \"=>\") return cont(pushcontext, noComma ? arrowBodyNoComma : arrowBody, popcontext);\n    if (type == \"operator\") {\n      if (/\\+\\+|--/.test(value) || isTS && value == \"!\") return cont(me);\n      if (isTS && value == \"<\" && cx.stream.match(/^([^>]|<.*?>)*>\\s*\\(/, false))\n        return cont(pushlex(\">\"), commasep(typeexpr, \">\"), poplex, me);\n      if (value == \"?\") return cont(expression, expect(\":\"), expr);\n      return cont(expr);\n    }\n    if (type == \"quasi\") { return pass(quasi, me); }\n    if (type == \";\") return;\n    if (type == \"(\") return contCommasep(expressionNoComma, \")\", \"call\", me);\n    if (type == \".\") return cont(property, me);\n    if (type == \"[\") return cont(pushlex(\"]\"), maybeexpression, expect(\"]\"), poplex, me);\n    if (isTS && value == \"as\") { cx.marked = \"keyword\"; return cont(typeexpr, me) }\n    if (type == \"regexp\") {\n      cx.state.lastType = cx.marked = \"operator\"\n      cx.stream.backUp(cx.stream.pos - cx.stream.start - 1)\n      return cont(expr)\n    }\n  }\n  function quasi(type, value) {\n    if (type != \"quasi\") return pass();\n    if (value.slice(value.length - 2) != \"${\") return cont(quasi);\n    return cont(expression, continueQuasi);\n  }\n  function continueQuasi(type) {\n    if (type == \"}\") {\n      cx.marked = \"string-2\";\n      cx.state.tokenize = tokenQuasi;\n      return cont(quasi);\n    }\n  }\n  function arrowBody(type) {\n    findFatArrow(cx.stream, cx.state);\n    return pass(type == \"{\" ? statement : expression);\n  }\n  function arrowBodyNoComma(type) {\n    findFatArrow(cx.stream, cx.state);\n    return pass(type == \"{\" ? statement : expressionNoComma);\n  }\n  function maybeTarget(noComma) {\n    return function(type) {\n      if (type == \".\") return cont(noComma ? targetNoComma : target);\n      else if (type == \"variable\" && isTS) return cont(maybeTypeArgs, noComma ? maybeoperatorNoComma : maybeoperatorComma)\n      else return pass(noComma ? expressionNoComma : expression);\n    };\n  }\n  function target(_, value) {\n    if (value == \"target\") { cx.marked = \"keyword\"; return cont(maybeoperatorComma); }\n  }\n  function targetNoComma(_, value) {\n    if (value == \"target\") { cx.marked = \"keyword\"; return cont(maybeoperatorNoComma); }\n  }\n  function maybelabel(type) {\n    if (type == \":\") return cont(poplex, statement);\n    return pass(maybeoperatorComma, expect(\";\"), poplex);\n  }\n  function property(type) {\n    if (type == \"variable\") {cx.marked = \"property\"; return cont();}\n  }\n  function objprop(type, value) {\n    if (type == \"async\") {\n      cx.marked = \"property\";\n      return cont(objprop);\n    } else if (type == \"variable\" || cx.style == \"keyword\") {\n      cx.marked = \"property\";\n      if (value == \"get\" || value == \"set\") return cont(getterSetter);\n      var m // Work around fat-arrow-detection complication for detecting typescript typed arrow params\n      if (isTS && cx.state.fatArrowAt == cx.stream.start && (m = cx.stream.match(/^\\s*:\\s*/, false)))\n        cx.state.fatArrowAt = cx.stream.pos + m[0].length\n      return cont(afterprop);\n    } else if (type == \"number\" || type == \"string\") {\n      cx.marked = jsonldMode ? \"property\" : (cx.style + \" property\");\n      return cont(afterprop);\n    } else if (type == \"jsonld-keyword\") {\n      return cont(afterprop);\n    } else if (isTS && isModifier(value)) {\n      cx.marked = \"keyword\"\n      return cont(objprop)\n    } else if (type == \"[\") {\n      return cont(expression, maybetype, expect(\"]\"), afterprop);\n    } else if (type == \"spread\") {\n      return cont(expressionNoComma, afterprop);\n    } else if (value == \"*\") {\n      cx.marked = \"keyword\";\n      return cont(objprop);\n    } else if (type == \":\") {\n      return pass(afterprop)\n    }\n  }\n  function getterSetter(type) {\n    if (type != \"variable\") return pass(afterprop);\n    cx.marked = \"property\";\n    return cont(functiondef);\n  }\n  function afterprop(type) {\n    if (type == \":\") return cont(expressionNoComma);\n    if (type == \"(\") return pass(functiondef);\n  }\n  function commasep(what, end, sep) {\n    function proceed(type, value) {\n      if (sep ? sep.indexOf(type) > -1 : type == \",\") {\n        var lex = cx.state.lexical;\n        if (lex.info == \"call\") lex.pos = (lex.pos || 0) + 1;\n        return cont(function(type, value) {\n          if (type == end || value == end) return pass()\n          return pass(what)\n        }, proceed);\n      }\n      if (type == end || value == end) return cont();\n      if (sep && sep.indexOf(\";\") > -1) return pass(what)\n      return cont(expect(end));\n    }\n    return function(type, value) {\n      if (type == end || value == end) return cont();\n      return pass(what, proceed);\n    };\n  }\n  function contCommasep(what, end, info) {\n    for (var i = 3; i < arguments.length; i++)\n      cx.cc.push(arguments[i]);\n    return cont(pushlex(end, info), commasep(what, end), poplex);\n  }\n  function block(type) {\n    if (type == \"}\") return cont();\n    return pass(statement, block);\n  }\n  function maybetype(type, value) {\n    if (isTS) {\n      if (type == \":\" || value == \"in\") return cont(typeexpr);\n      if (value == \"?\") return cont(maybetype);\n    }\n  }\n  function mayberettype(type) {\n    if (isTS && type == \":\") {\n      if (cx.stream.match(/^\\s*\\w+\\s+is\\b/, false)) return cont(expression, isKW, typeexpr)\n      else return cont(typeexpr)\n    }\n  }\n  function isKW(_, value) {\n    if (value == \"is\") {\n      cx.marked = \"keyword\"\n      return cont()\n    }\n  }\n  function typeexpr(type, value) {\n    if (value == \"keyof\" || value == \"typeof\" || value == \"infer\") {\n      cx.marked = \"keyword\"\n      return cont(value == \"typeof\" ? expressionNoComma : typeexpr)\n    }\n    if (type == \"variable\" || value == \"void\") {\n      cx.marked = \"type\"\n      return cont(afterType)\n    }\n    if (value == \"|\" || value == \"&\") return cont(typeexpr)\n    if (type == \"string\" || type == \"number\" || type == \"atom\") return cont(afterType);\n    if (type == \"[\") return cont(pushlex(\"]\"), commasep(typeexpr, \"]\", \",\"), poplex, afterType)\n    if (type == \"{\") return cont(pushlex(\"}\"), commasep(typeprop, \"}\", \",;\"), poplex, afterType)\n    if (type == \"(\") return cont(commasep(typearg, \")\"), maybeReturnType, afterType)\n    if (type == \"<\") return cont(commasep(typeexpr, \">\"), typeexpr)\n  }\n  function maybeReturnType(type) {\n    if (type == \"=>\") return cont(typeexpr)\n  }\n  function typeprop(type, value) {\n    if (type == \"variable\" || cx.style == \"keyword\") {\n      cx.marked = \"property\"\n      return cont(typeprop)\n    } else if (value == \"?\" || type == \"number\" || type == \"string\") {\n      return cont(typeprop)\n    } else if (type == \":\") {\n      return cont(typeexpr)\n    } else if (type == \"[\") {\n      return cont(expect(\"variable\"), maybetype, expect(\"]\"), typeprop)\n    } else if (type == \"(\") {\n      return pass(functiondecl, typeprop)\n    }\n  }\n  function typearg(type, value) {\n    if (type == \"variable\" && cx.stream.match(/^\\s*[?:]/, false) || value == \"?\") return cont(typearg)\n    if (type == \":\") return cont(typeexpr)\n    if (type == \"spread\") return cont(typearg)\n    return pass(typeexpr)\n  }\n  function afterType(type, value) {\n    if (value == \"<\") return cont(pushlex(\">\"), commasep(typeexpr, \">\"), poplex, afterType)\n    if (value == \"|\" || type == \".\" || value == \"&\") return cont(typeexpr)\n    if (type == \"[\") return cont(typeexpr, expect(\"]\"), afterType)\n    if (value == \"extends\" || value == \"implements\") { cx.marked = \"keyword\"; return cont(typeexpr) }\n    if (value == \"?\") return cont(typeexpr, expect(\":\"), typeexpr)\n  }\n  function maybeTypeArgs(_, value) {\n    if (value == \"<\") return cont(pushlex(\">\"), commasep(typeexpr, \">\"), poplex, afterType)\n  }\n  function typeparam() {\n    return pass(typeexpr, maybeTypeDefault)\n  }\n  function maybeTypeDefault(_, value) {\n    if (value == \"=\") return cont(typeexpr)\n  }\n  function vardef(_, value) {\n    if (value == \"enum\") {cx.marked = \"keyword\"; return cont(enumdef)}\n    return pass(pattern, maybetype, maybeAssign, vardefCont);\n  }\n  function pattern(type, value) {\n    if (isTS && isModifier(value)) { cx.marked = \"keyword\"; return cont(pattern) }\n    if (type == \"variable\") { register(value); return cont(); }\n    if (type == \"spread\") return cont(pattern);\n    if (type == \"[\") return contCommasep(eltpattern, \"]\");\n    if (type == \"{\") return contCommasep(proppattern, \"}\");\n  }\n  function proppattern(type, value) {\n    if (type == \"variable\" && !cx.stream.match(/^\\s*:/, false)) {\n      register(value);\n      return cont(maybeAssign);\n    }\n    if (type == \"variable\") cx.marked = \"property\";\n    if (type == \"spread\") return cont(pattern);\n    if (type == \"}\") return pass();\n    if (type == \"[\") return cont(expression, expect(']'), expect(':'), proppattern);\n    return cont(expect(\":\"), pattern, maybeAssign);\n  }\n  function eltpattern() {\n    return pass(pattern, maybeAssign)\n  }\n  function maybeAssign(_type, value) {\n    if (value == \"=\") return cont(expressionNoComma);\n  }\n  function vardefCont(type) {\n    if (type == \",\") return cont(vardef);\n  }\n  function maybeelse(type, value) {\n    if (type == \"keyword b\" && value == \"else\") return cont(pushlex(\"form\", \"else\"), statement, poplex);\n  }\n  function forspec(type, value) {\n    if (value == \"await\") return cont(forspec);\n    if (type == \"(\") return cont(pushlex(\")\"), forspec1, poplex);\n  }\n  function forspec1(type) {\n    if (type == \"var\") return cont(vardef, forspec2);\n    if (type == \"variable\") return cont(forspec2);\n    return pass(forspec2)\n  }\n  function forspec2(type, value) {\n    if (type == \")\") return cont()\n    if (type == \";\") return cont(forspec2)\n    if (value == \"in\" || value == \"of\") { cx.marked = \"keyword\"; return cont(expression, forspec2) }\n    return pass(expression, forspec2)\n  }\n  function functiondef(type, value) {\n    if (value == \"*\") {cx.marked = \"keyword\"; return cont(functiondef);}\n    if (type == \"variable\") {register(value); return cont(functiondef);}\n    if (type == \"(\") return cont(pushcontext, pushlex(\")\"), commasep(funarg, \")\"), poplex, mayberettype, statement, popcontext);\n    if (isTS && value == \"<\") return cont(pushlex(\">\"), commasep(typeparam, \">\"), poplex, functiondef)\n  }\n  function functiondecl(type, value) {\n    if (value == \"*\") {cx.marked = \"keyword\"; return cont(functiondecl);}\n    if (type == \"variable\") {register(value); return cont(functiondecl);}\n    if (type == \"(\") return cont(pushcontext, pushlex(\")\"), commasep(funarg, \")\"), poplex, mayberettype, popcontext);\n    if (isTS && value == \"<\") return cont(pushlex(\">\"), commasep(typeparam, \">\"), poplex, functiondecl)\n  }\n  function typename(type, value) {\n    if (type == \"keyword\" || type == \"variable\") {\n      cx.marked = \"type\"\n      return cont(typename)\n    } else if (value == \"<\") {\n      return cont(pushlex(\">\"), commasep(typeparam, \">\"), poplex)\n    }\n  }\n  function funarg(type, value) {\n    if (value == \"@\") cont(expression, funarg)\n    if (type == \"spread\") return cont(funarg);\n    if (isTS && isModifier(value)) { cx.marked = \"keyword\"; return cont(funarg); }\n    if (isTS && type == \"this\") return cont(maybetype, maybeAssign)\n    return pass(pattern, maybetype, maybeAssign);\n  }\n  function classExpression(type, value) {\n    // Class expressions may have an optional name.\n    if (type == \"variable\") return className(type, value);\n    return classNameAfter(type, value);\n  }\n  function className(type, value) {\n    if (type == \"variable\") {register(value); return cont(classNameAfter);}\n  }\n  function classNameAfter(type, value) {\n    if (value == \"<\") return cont(pushlex(\">\"), commasep(typeparam, \">\"), poplex, classNameAfter)\n    if (value == \"extends\" || value == \"implements\" || (isTS && type == \",\")) {\n      if (value == \"implements\") cx.marked = \"keyword\";\n      return cont(isTS ? typeexpr : expression, classNameAfter);\n    }\n    if (type == \"{\") return cont(pushlex(\"}\"), classBody, poplex);\n  }\n  function classBody(type, value) {\n    if (type == \"async\" ||\n        (type == \"variable\" &&\n         (value == \"static\" || value == \"get\" || value == \"set\" || (isTS && isModifier(value))) &&\n         cx.stream.match(/^\\s+[\\w$\\xa1-\\uffff]/, false))) {\n      cx.marked = \"keyword\";\n      return cont(classBody);\n    }\n    if (type == \"variable\" || cx.style == \"keyword\") {\n      cx.marked = \"property\";\n      return cont(isTS ? classfield : functiondef, classBody);\n    }\n    if (type == \"number\" || type == \"string\") return cont(isTS ? classfield : functiondef, classBody);\n    if (type == \"[\")\n      return cont(expression, maybetype, expect(\"]\"), isTS ? classfield : functiondef, classBody)\n    if (value == \"*\") {\n      cx.marked = \"keyword\";\n      return cont(classBody);\n    }\n    if (isTS && type == \"(\") return pass(functiondecl, classBody)\n    if (type == \";\" || type == \",\") return cont(classBody);\n    if (type == \"}\") return cont();\n    if (value == \"@\") return cont(expression, classBody)\n  }\n  function classfield(type, value) {\n    if (value == \"?\") return cont(classfield)\n    if (type == \":\") return cont(typeexpr, maybeAssign)\n    if (value == \"=\") return cont(expressionNoComma)\n    var context = cx.state.lexical.prev, isInterface = context && context.info == \"interface\"\n    return pass(isInterface ? functiondecl : functiondef)\n  }\n  function afterExport(type, value) {\n    if (value == \"*\") { cx.marked = \"keyword\"; return cont(maybeFrom, expect(\";\")); }\n    if (value == \"default\") { cx.marked = \"keyword\"; return cont(expression, expect(\";\")); }\n    if (type == \"{\") return cont(commasep(exportField, \"}\"), maybeFrom, expect(\";\"));\n    return pass(statement);\n  }\n  function exportField(type, value) {\n    if (value == \"as\") { cx.marked = \"keyword\"; return cont(expect(\"variable\")); }\n    if (type == \"variable\") return pass(expressionNoComma, exportField);\n  }\n  function afterImport(type) {\n    if (type == \"string\") return cont();\n    if (type == \"(\") return pass(expression);\n    return pass(importSpec, maybeMoreImports, maybeFrom);\n  }\n  function importSpec(type, value) {\n    if (type == \"{\") return contCommasep(importSpec, \"}\");\n    if (type == \"variable\") register(value);\n    if (value == \"*\") cx.marked = \"keyword\";\n    return cont(maybeAs);\n  }\n  function maybeMoreImports(type) {\n    if (type == \",\") return cont(importSpec, maybeMoreImports)\n  }\n  function maybeAs(_type, value) {\n    if (value == \"as\") { cx.marked = \"keyword\"; return cont(importSpec); }\n  }\n  function maybeFrom(_type, value) {\n    if (value == \"from\") { cx.marked = \"keyword\"; return cont(expression); }\n  }\n  function arrayLiteral(type) {\n    if (type == \"]\") return cont();\n    return pass(commasep(expressionNoComma, \"]\"));\n  }\n  function enumdef() {\n    return pass(pushlex(\"form\"), pattern, expect(\"{\"), pushlex(\"}\"), commasep(enummember, \"}\"), poplex, poplex)\n  }\n  function enummember() {\n    return pass(pattern, maybeAssign);\n  }\n\n  function isContinuedStatement(state, textAfter) {\n    return state.lastType == \"operator\" || state.lastType == \",\" ||\n      isOperatorChar.test(textAfter.charAt(0)) ||\n      /[,.]/.test(textAfter.charAt(0));\n  }\n\n  function expressionAllowed(stream, state, backUp) {\n    return state.tokenize == tokenBase &&\n      /^(?:operator|sof|keyword [bcd]|case|new|export|default|spread|[\\[{}\\(,;:]|=>)$/.test(state.lastType) ||\n      (state.lastType == \"quasi\" && /\\{\\s*$/.test(stream.string.slice(0, stream.pos - (backUp || 0))))\n  }\n\n  // Interface\n\n  return {\n    startState: function(basecolumn) {\n      var state = {\n        tokenize: tokenBase,\n        lastType: \"sof\",\n        cc: [],\n        lexical: new JSLexical((basecolumn || 0) - indentUnit, 0, \"block\", false),\n        localVars: parserConfig.localVars,\n        context: parserConfig.localVars && new Context(null, null, false),\n        indented: basecolumn || 0\n      };\n      if (parserConfig.globalVars && typeof parserConfig.globalVars == \"object\")\n        state.globalVars = parserConfig.globalVars;\n      return state;\n    },\n\n    token: function(stream, state) {\n      if (stream.sol()) {\n        if (!state.lexical.hasOwnProperty(\"align\"))\n          state.lexical.align = false;\n        state.indented = stream.indentation();\n        findFatArrow(stream, state);\n      }\n      if (state.tokenize != tokenComment && stream.eatSpace()) return null;\n      var style = state.tokenize(stream, state);\n      if (type == \"comment\") return style;\n      state.lastType = type == \"operator\" && (content == \"++\" || content == \"--\") ? \"incdec\" : type;\n      return parseJS(state, style, type, content, stream);\n    },\n\n    indent: function(state, textAfter) {\n      if (state.tokenize == tokenComment) return CodeMirror.Pass;\n      if (state.tokenize != tokenBase) return 0;\n      var firstChar = textAfter && textAfter.charAt(0), lexical = state.lexical, top\n      // Kludge to prevent 'maybelse' from blocking lexical scope pops\n      if (!/^\\s*else\\b/.test(textAfter)) for (var i = state.cc.length - 1; i >= 0; --i) {\n        var c = state.cc[i];\n        if (c == poplex) lexical = lexical.prev;\n        else if (c != maybeelse) break;\n      }\n      while ((lexical.type == \"stat\" || lexical.type == \"form\") &&\n             (firstChar == \"}\" || ((top = state.cc[state.cc.length - 1]) &&\n                                   (top == maybeoperatorComma || top == maybeoperatorNoComma) &&\n                                   !/^[,\\.=+\\-*:?[\\(]/.test(textAfter))))\n        lexical = lexical.prev;\n      if (statementIndent && lexical.type == \")\" && lexical.prev.type == \"stat\")\n        lexical = lexical.prev;\n      var type = lexical.type, closing = firstChar == type;\n\n      if (type == \"vardef\") return lexical.indented + (state.lastType == \"operator\" || state.lastType == \",\" ? lexical.info.length + 1 : 0);\n      else if (type == \"form\" && firstChar == \"{\") return lexical.indented;\n      else if (type == \"form\") return lexical.indented + indentUnit;\n      else if (type == \"stat\")\n        return lexical.indented + (isContinuedStatement(state, textAfter) ? statementIndent || indentUnit : 0);\n      else if (lexical.info == \"switch\" && !closing && parserConfig.doubleIndentSwitch != false)\n        return lexical.indented + (/^(?:case|default)\\b/.test(textAfter) ? indentUnit : 2 * indentUnit);\n      else if (lexical.align) return lexical.column + (closing ? 0 : 1);\n      else return lexical.indented + (closing ? 0 : indentUnit);\n    },\n\n    electricInput: /^\\s*(?:case .*?:|default:|\\{|\\})$/,\n    blockCommentStart: jsonMode ? null : \"/*\",\n    blockCommentEnd: jsonMode ? null : \"*/\",\n    blockCommentContinue: jsonMode ? null : \" * \",\n    lineComment: jsonMode ? null : \"//\",\n    fold: \"brace\",\n    closeBrackets: \"()[]{}''\\\"\\\"``\",\n\n    helperType: jsonMode ? \"json\" : \"javascript\",\n    jsonldMode: jsonldMode,\n    jsonMode: jsonMode,\n\n    expressionAllowed: expressionAllowed,\n\n    skipExpression: function(state) {\n      var top = state.cc[state.cc.length - 1]\n      if (top == expression || top == expressionNoComma) state.cc.pop()\n    }\n  };\n});\n\nCodeMirror.registerHelper(\"wordChars\", \"javascript\", /[\\w$]/);\n\nCodeMirror.defineMIME(\"text/javascript\", \"javascript\");\nCodeMirror.defineMIME(\"text/ecmascript\", \"javascript\");\nCodeMirror.defineMIME(\"application/javascript\", \"javascript\");\nCodeMirror.defineMIME(\"application/x-javascript\", \"javascript\");\nCodeMirror.defineMIME(\"application/ecmascript\", \"javascript\");\nCodeMirror.defineMIME(\"application/json\", {name: \"javascript\", json: true});\nCodeMirror.defineMIME(\"application/x-json\", {name: \"javascript\", json: true});\nCodeMirror.defineMIME(\"application/ld+json\", {name: \"javascript\", jsonld: true});\nCodeMirror.defineMIME(\"text/typescript\", { name: \"javascript\", typescript: true });\nCodeMirror.defineMIME(\"application/typescript\", { name: \"javascript\", typescript: true });\n\n});\n","/**\r\n * Common utilities\r\n * @module glMatrix\r\n */\n// Configuration Constants\nexport var EPSILON = 0.000001;\nexport var ARRAY_TYPE = typeof Float32Array !== 'undefined' ? Float32Array : Array;\nexport var RANDOM = Math.random;\n/**\r\n * Sets the type of array used when creating new vectors and matrices\r\n *\r\n * @param {Type} type Array type, such as Float32Array or Array\r\n */\n\nexport function setMatrixArrayType(type) {\n  ARRAY_TYPE = type;\n}\nvar degree = Math.PI / 180;\n/**\r\n * Convert Degree To Radian\r\n *\r\n * @param {Number} a Angle in Degrees\r\n */\n\nexport function toRadian(a) {\n  return a * degree;\n}\n/**\r\n * Tests whether or not the arguments have approximately the same value, within an absolute\r\n * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less\r\n * than or equal to 1.0, and a relative tolerance is used for larger values)\r\n *\r\n * @param {Number} a The first number to test.\r\n * @param {Number} b The second number to test.\r\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  return Math.abs(a - b) <= EPSILON * Math.max(1.0, Math.abs(a), Math.abs(b));\n}","import * as glMatrix from \"./common.js\";\nimport * as mat2 from \"./mat2.js\";\nimport * as mat2d from \"./mat2d.js\";\nimport * as mat3 from \"./mat3.js\";\nimport * as mat4 from \"./mat4.js\";\nimport * as quat from \"./quat.js\";\nimport * as quat2 from \"./quat2.js\";\nimport * as vec2 from \"./vec2.js\";\nimport * as vec3 from \"./vec3.js\";\nimport * as vec4 from \"./vec4.js\";\nexport { glMatrix, mat2, mat2d, mat3, mat4, quat, quat2, vec2, vec3, vec4 };","import * as glMatrix from \"./common.js\";\n/**\r\n * 2x2 Matrix\r\n * @module mat2\r\n */\n\n/**\r\n * Creates a new identity mat2\r\n *\r\n * @returns {mat2} a new 2x2 matrix\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  out[0] = 1;\n  out[3] = 1;\n  return out;\n}\n/**\r\n * Creates a new mat2 initialized with values from an existing matrix\r\n *\r\n * @param {mat2} a matrix to clone\r\n * @returns {mat2} a new 2x2 matrix\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Copy the values from one mat2 to another\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {mat2} a the source matrix\r\n * @returns {mat2} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Set a mat2 to the identity matrix\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @returns {mat2} out\r\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  return out;\n}\n/**\r\n * Create a new mat2 with the given values\r\n *\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 2)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 3)\r\n * @returns {mat2} out A new 2x2 matrix\r\n */\n\nexport function fromValues(m00, m01, m10, m11) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m10;\n  out[3] = m11;\n  return out;\n}\n/**\r\n * Set the components of a mat2 to the given values\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 2)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 3)\r\n * @returns {mat2} out\r\n */\n\nexport function set(out, m00, m01, m10, m11) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m10;\n  out[3] = m11;\n  return out;\n}\n/**\r\n * Transpose the values of a mat2\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {mat2} a the source matrix\r\n * @returns {mat2} out\r\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache\n  // some values\n  if (out === a) {\n    var a1 = a[1];\n    out[1] = a[2];\n    out[2] = a1;\n  } else {\n    out[0] = a[0];\n    out[1] = a[2];\n    out[2] = a[1];\n    out[3] = a[3];\n  }\n\n  return out;\n}\n/**\r\n * Inverts a mat2\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {mat2} a the source matrix\r\n * @returns {mat2} out\r\n */\n\nexport function invert(out, a) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3]; // Calculate the determinant\n\n  var det = a0 * a3 - a2 * a1;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = a3 * det;\n  out[1] = -a1 * det;\n  out[2] = -a2 * det;\n  out[3] = a0 * det;\n  return out;\n}\n/**\r\n * Calculates the adjugate of a mat2\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {mat2} a the source matrix\r\n * @returns {mat2} out\r\n */\n\nexport function adjoint(out, a) {\n  // Caching this value is nessecary if out == a\n  var a0 = a[0];\n  out[0] = a[3];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = a0;\n  return out;\n}\n/**\r\n * Calculates the determinant of a mat2\r\n *\r\n * @param {mat2} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\n\nexport function determinant(a) {\n  return a[0] * a[3] - a[2] * a[1];\n}\n/**\r\n * Multiplies two mat2's\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {mat2} a the first operand\r\n * @param {mat2} b the second operand\r\n * @returns {mat2} out\r\n */\n\nexport function multiply(out, a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  out[0] = a0 * b0 + a2 * b1;\n  out[1] = a1 * b0 + a3 * b1;\n  out[2] = a0 * b2 + a2 * b3;\n  out[3] = a1 * b2 + a3 * b3;\n  return out;\n}\n/**\r\n * Rotates a mat2 by the given angle\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {mat2} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat2} out\r\n */\n\nexport function rotate(out, a, rad) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  out[0] = a0 * c + a2 * s;\n  out[1] = a1 * c + a3 * s;\n  out[2] = a0 * -s + a2 * c;\n  out[3] = a1 * -s + a3 * c;\n  return out;\n}\n/**\r\n * Scales the mat2 by the dimensions in the given vec2\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {mat2} a the matrix to rotate\r\n * @param {vec2} v the vec2 to scale the matrix by\r\n * @returns {mat2} out\r\n **/\n\nexport function scale(out, a, v) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var v0 = v[0],\n      v1 = v[1];\n  out[0] = a0 * v0;\n  out[1] = a1 * v0;\n  out[2] = a2 * v1;\n  out[3] = a3 * v1;\n  return out;\n}\n/**\r\n * Creates a matrix from a given angle\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat2.identity(dest);\r\n *     mat2.rotate(dest, dest, rad);\r\n *\r\n * @param {mat2} out mat2 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat2} out\r\n */\n\nexport function fromRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  out[0] = c;\n  out[1] = s;\n  out[2] = -s;\n  out[3] = c;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat2.identity(dest);\r\n *     mat2.scale(dest, dest, vec);\r\n *\r\n * @param {mat2} out mat2 receiving operation result\r\n * @param {vec2} v Scaling vector\r\n * @returns {mat2} out\r\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = v[1];\n  return out;\n}\n/**\r\n * Returns a string representation of a mat2\r\n *\r\n * @param {mat2} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\n\nexport function str(a) {\n  return 'mat2(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ')';\n}\n/**\r\n * Returns Frobenius norm of a mat2\r\n *\r\n * @param {mat2} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\n\nexport function frob(a) {\n  return Math.sqrt(Math.pow(a[0], 2) + Math.pow(a[1], 2) + Math.pow(a[2], 2) + Math.pow(a[3], 2));\n}\n/**\r\n * Returns L, D and U matrices (Lower triangular, Diagonal and Upper triangular) by factorizing the input matrix\r\n * @param {mat2} L the lower triangular matrix\r\n * @param {mat2} D the diagonal matrix\r\n * @param {mat2} U the upper triangular matrix\r\n * @param {mat2} a the input matrix to factorize\r\n */\n\nexport function LDU(L, D, U, a) {\n  L[2] = a[2] / a[0];\n  U[0] = a[0];\n  U[1] = a[1];\n  U[3] = a[3] - L[2] * U[1];\n  return [L, D, U];\n}\n/**\r\n * Adds two mat2's\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {mat2} a the first operand\r\n * @param {mat2} b the second operand\r\n * @returns {mat2} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  return out;\n}\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {mat2} a the first operand\r\n * @param {mat2} b the second operand\r\n * @returns {mat2} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  return out;\n}\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {mat2} a The first matrix.\r\n * @param {mat2} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\n}\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {mat2} a The first matrix.\r\n * @param {mat2} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3));\n}\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {mat2} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat2} out\r\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  return out;\n}\n/**\r\n * Adds two mat2's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat2} out the receiving vector\r\n * @param {mat2} a the first operand\r\n * @param {mat2} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat2} out\r\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  return out;\n}\n/**\r\n * Alias for {@link mat2.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link mat2.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n/**\r\n * 2x3 Matrix\r\n * @module mat2d\r\n *\r\n * @description\r\n * A mat2d contains six elements defined as:\r\n * <pre>\r\n * [a, c, tx,\r\n *  b, d, ty]\r\n * </pre>\r\n * This is a short form for the 3x3 matrix:\r\n * <pre>\r\n * [a, c, tx,\r\n *  b, d, ty,\r\n *  0, 0, 1]\r\n * </pre>\r\n * The last row is ignored so the array is shorter and operations are faster.\r\n */\n\n/**\r\n * Creates a new identity mat2d\r\n *\r\n * @returns {mat2d} a new 2x3 matrix\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(6);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[4] = 0;\n    out[5] = 0;\n  }\n\n  out[0] = 1;\n  out[3] = 1;\n  return out;\n}\n/**\r\n * Creates a new mat2d initialized with values from an existing matrix\r\n *\r\n * @param {mat2d} a matrix to clone\r\n * @returns {mat2d} a new 2x3 matrix\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(6);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  return out;\n}\n/**\r\n * Copy the values from one mat2d to another\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {mat2d} a the source matrix\r\n * @returns {mat2d} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  return out;\n}\n/**\r\n * Set a mat2d to the identity matrix\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @returns {mat2d} out\r\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  out[4] = 0;\n  out[5] = 0;\n  return out;\n}\n/**\r\n * Create a new mat2d with the given values\r\n *\r\n * @param {Number} a Component A (index 0)\r\n * @param {Number} b Component B (index 1)\r\n * @param {Number} c Component C (index 2)\r\n * @param {Number} d Component D (index 3)\r\n * @param {Number} tx Component TX (index 4)\r\n * @param {Number} ty Component TY (index 5)\r\n * @returns {mat2d} A new mat2d\r\n */\n\nexport function fromValues(a, b, c, d, tx, ty) {\n  var out = new glMatrix.ARRAY_TYPE(6);\n  out[0] = a;\n  out[1] = b;\n  out[2] = c;\n  out[3] = d;\n  out[4] = tx;\n  out[5] = ty;\n  return out;\n}\n/**\r\n * Set the components of a mat2d to the given values\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {Number} a Component A (index 0)\r\n * @param {Number} b Component B (index 1)\r\n * @param {Number} c Component C (index 2)\r\n * @param {Number} d Component D (index 3)\r\n * @param {Number} tx Component TX (index 4)\r\n * @param {Number} ty Component TY (index 5)\r\n * @returns {mat2d} out\r\n */\n\nexport function set(out, a, b, c, d, tx, ty) {\n  out[0] = a;\n  out[1] = b;\n  out[2] = c;\n  out[3] = d;\n  out[4] = tx;\n  out[5] = ty;\n  return out;\n}\n/**\r\n * Inverts a mat2d\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {mat2d} a the source matrix\r\n * @returns {mat2d} out\r\n */\n\nexport function invert(out, a) {\n  var aa = a[0],\n      ab = a[1],\n      ac = a[2],\n      ad = a[3];\n  var atx = a[4],\n      aty = a[5];\n  var det = aa * ad - ab * ac;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = ad * det;\n  out[1] = -ab * det;\n  out[2] = -ac * det;\n  out[3] = aa * det;\n  out[4] = (ac * aty - ad * atx) * det;\n  out[5] = (ab * atx - aa * aty) * det;\n  return out;\n}\n/**\r\n * Calculates the determinant of a mat2d\r\n *\r\n * @param {mat2d} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\n\nexport function determinant(a) {\n  return a[0] * a[3] - a[1] * a[2];\n}\n/**\r\n * Multiplies two mat2d's\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {mat2d} a the first operand\r\n * @param {mat2d} b the second operand\r\n * @returns {mat2d} out\r\n */\n\nexport function multiply(out, a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3],\n      b4 = b[4],\n      b5 = b[5];\n  out[0] = a0 * b0 + a2 * b1;\n  out[1] = a1 * b0 + a3 * b1;\n  out[2] = a0 * b2 + a2 * b3;\n  out[3] = a1 * b2 + a3 * b3;\n  out[4] = a0 * b4 + a2 * b5 + a4;\n  out[5] = a1 * b4 + a3 * b5 + a5;\n  return out;\n}\n/**\r\n * Rotates a mat2d by the given angle\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {mat2d} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat2d} out\r\n */\n\nexport function rotate(out, a, rad) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5];\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  out[0] = a0 * c + a2 * s;\n  out[1] = a1 * c + a3 * s;\n  out[2] = a0 * -s + a2 * c;\n  out[3] = a1 * -s + a3 * c;\n  out[4] = a4;\n  out[5] = a5;\n  return out;\n}\n/**\r\n * Scales the mat2d by the dimensions in the given vec2\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {mat2d} a the matrix to translate\r\n * @param {vec2} v the vec2 to scale the matrix by\r\n * @returns {mat2d} out\r\n **/\n\nexport function scale(out, a, v) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5];\n  var v0 = v[0],\n      v1 = v[1];\n  out[0] = a0 * v0;\n  out[1] = a1 * v0;\n  out[2] = a2 * v1;\n  out[3] = a3 * v1;\n  out[4] = a4;\n  out[5] = a5;\n  return out;\n}\n/**\r\n * Translates the mat2d by the dimensions in the given vec2\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {mat2d} a the matrix to translate\r\n * @param {vec2} v the vec2 to translate the matrix by\r\n * @returns {mat2d} out\r\n **/\n\nexport function translate(out, a, v) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5];\n  var v0 = v[0],\n      v1 = v[1];\n  out[0] = a0;\n  out[1] = a1;\n  out[2] = a2;\n  out[3] = a3;\n  out[4] = a0 * v0 + a2 * v1 + a4;\n  out[5] = a1 * v0 + a3 * v1 + a5;\n  return out;\n}\n/**\r\n * Creates a matrix from a given angle\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat2d.identity(dest);\r\n *     mat2d.rotate(dest, dest, rad);\r\n *\r\n * @param {mat2d} out mat2d receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat2d} out\r\n */\n\nexport function fromRotation(out, rad) {\n  var s = Math.sin(rad),\n      c = Math.cos(rad);\n  out[0] = c;\n  out[1] = s;\n  out[2] = -s;\n  out[3] = c;\n  out[4] = 0;\n  out[5] = 0;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat2d.identity(dest);\r\n *     mat2d.scale(dest, dest, vec);\r\n *\r\n * @param {mat2d} out mat2d receiving operation result\r\n * @param {vec2} v Scaling vector\r\n * @returns {mat2d} out\r\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = v[1];\n  out[4] = 0;\n  out[5] = 0;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat2d.identity(dest);\r\n *     mat2d.translate(dest, dest, vec);\r\n *\r\n * @param {mat2d} out mat2d receiving operation result\r\n * @param {vec2} v Translation vector\r\n * @returns {mat2d} out\r\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  out[4] = v[0];\n  out[5] = v[1];\n  return out;\n}\n/**\r\n * Returns a string representation of a mat2d\r\n *\r\n * @param {mat2d} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\n\nexport function str(a) {\n  return 'mat2d(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ', ' + a[4] + ', ' + a[5] + ')';\n}\n/**\r\n * Returns Frobenius norm of a mat2d\r\n *\r\n * @param {mat2d} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\n\nexport function frob(a) {\n  return Math.sqrt(Math.pow(a[0], 2) + Math.pow(a[1], 2) + Math.pow(a[2], 2) + Math.pow(a[3], 2) + Math.pow(a[4], 2) + Math.pow(a[5], 2) + 1);\n}\n/**\r\n * Adds two mat2d's\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {mat2d} a the first operand\r\n * @param {mat2d} b the second operand\r\n * @returns {mat2d} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  return out;\n}\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {mat2d} a the first operand\r\n * @param {mat2d} b the second operand\r\n * @returns {mat2d} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  return out;\n}\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {mat2d} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat2d} out\r\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  return out;\n}\n/**\r\n * Adds two mat2d's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat2d} out the receiving vector\r\n * @param {mat2d} a the first operand\r\n * @param {mat2d} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat2d} out\r\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  return out;\n}\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {mat2d} a The first matrix.\r\n * @param {mat2d} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5];\n}\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {mat2d} a The first matrix.\r\n * @param {mat2d} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3],\n      b4 = b[4],\n      b5 = b[5];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5));\n}\n/**\r\n * Alias for {@link mat2d.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link mat2d.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n/**\r\n * 3x3 Matrix\r\n * @module mat3\r\n */\n\n/**\r\n * Creates a new identity mat3\r\n *\r\n * @returns {mat3} a new 3x3 matrix\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(9);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[5] = 0;\n    out[6] = 0;\n    out[7] = 0;\n  }\n\n  out[0] = 1;\n  out[4] = 1;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Copies the upper-left 3x3 values into the given mat3.\r\n *\r\n * @param {mat3} out the receiving 3x3 matrix\r\n * @param {mat4} a   the source 4x4 matrix\r\n * @returns {mat3} out\r\n */\n\nexport function fromMat4(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[4];\n  out[4] = a[5];\n  out[5] = a[6];\n  out[6] = a[8];\n  out[7] = a[9];\n  out[8] = a[10];\n  return out;\n}\n/**\r\n * Creates a new mat3 initialized with values from an existing matrix\r\n *\r\n * @param {mat3} a matrix to clone\r\n * @returns {mat3} a new 3x3 matrix\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(9);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\r\n * Copy the values from one mat3 to another\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\r\n * Create a new mat3 with the given values\r\n *\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\r\n * @returns {mat3} A new mat3\r\n */\n\nexport function fromValues(m00, m01, m02, m10, m11, m12, m20, m21, m22) {\n  var out = new glMatrix.ARRAY_TYPE(9);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m10;\n  out[4] = m11;\n  out[5] = m12;\n  out[6] = m20;\n  out[7] = m21;\n  out[8] = m22;\n  return out;\n}\n/**\r\n * Set the components of a mat3 to the given values\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\r\n * @returns {mat3} out\r\n */\n\nexport function set(out, m00, m01, m02, m10, m11, m12, m20, m21, m22) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m10;\n  out[4] = m11;\n  out[5] = m12;\n  out[6] = m20;\n  out[7] = m21;\n  out[8] = m22;\n  return out;\n}\n/**\r\n * Set a mat3 to the identity matrix\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @returns {mat3} out\r\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 1;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Transpose the values of a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n        a02 = a[2],\n        a12 = a[5];\n    out[1] = a[3];\n    out[2] = a[6];\n    out[3] = a01;\n    out[5] = a[7];\n    out[6] = a02;\n    out[7] = a12;\n  } else {\n    out[0] = a[0];\n    out[1] = a[3];\n    out[2] = a[6];\n    out[3] = a[1];\n    out[4] = a[4];\n    out[5] = a[7];\n    out[6] = a[2];\n    out[7] = a[5];\n    out[8] = a[8];\n  }\n\n  return out;\n}\n/**\r\n * Inverts a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  var b01 = a22 * a11 - a12 * a21;\n  var b11 = -a22 * a10 + a12 * a20;\n  var b21 = a21 * a10 - a11 * a20; // Calculate the determinant\n\n  var det = a00 * b01 + a01 * b11 + a02 * b21;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = b01 * det;\n  out[1] = (-a22 * a01 + a02 * a21) * det;\n  out[2] = (a12 * a01 - a02 * a11) * det;\n  out[3] = b11 * det;\n  out[4] = (a22 * a00 - a02 * a20) * det;\n  out[5] = (-a12 * a00 + a02 * a10) * det;\n  out[6] = b21 * det;\n  out[7] = (-a21 * a00 + a01 * a20) * det;\n  out[8] = (a11 * a00 - a01 * a10) * det;\n  return out;\n}\n/**\r\n * Calculates the adjugate of a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function adjoint(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  out[0] = a11 * a22 - a12 * a21;\n  out[1] = a02 * a21 - a01 * a22;\n  out[2] = a01 * a12 - a02 * a11;\n  out[3] = a12 * a20 - a10 * a22;\n  out[4] = a00 * a22 - a02 * a20;\n  out[5] = a02 * a10 - a00 * a12;\n  out[6] = a10 * a21 - a11 * a20;\n  out[7] = a01 * a20 - a00 * a21;\n  out[8] = a00 * a11 - a01 * a10;\n  return out;\n}\n/**\r\n * Calculates the determinant of a mat3\r\n *\r\n * @param {mat3} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\n\nexport function determinant(a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  return a00 * (a22 * a11 - a12 * a21) + a01 * (-a22 * a10 + a12 * a20) + a02 * (a21 * a10 - a11 * a20);\n}\n/**\r\n * Multiplies two mat3's\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the first operand\r\n * @param {mat3} b the second operand\r\n * @returns {mat3} out\r\n */\n\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  var b00 = b[0],\n      b01 = b[1],\n      b02 = b[2];\n  var b10 = b[3],\n      b11 = b[4],\n      b12 = b[5];\n  var b20 = b[6],\n      b21 = b[7],\n      b22 = b[8];\n  out[0] = b00 * a00 + b01 * a10 + b02 * a20;\n  out[1] = b00 * a01 + b01 * a11 + b02 * a21;\n  out[2] = b00 * a02 + b01 * a12 + b02 * a22;\n  out[3] = b10 * a00 + b11 * a10 + b12 * a20;\n  out[4] = b10 * a01 + b11 * a11 + b12 * a21;\n  out[5] = b10 * a02 + b11 * a12 + b12 * a22;\n  out[6] = b20 * a00 + b21 * a10 + b22 * a20;\n  out[7] = b20 * a01 + b21 * a11 + b22 * a21;\n  out[8] = b20 * a02 + b21 * a12 + b22 * a22;\n  return out;\n}\n/**\r\n * Translate a mat3 by the given vector\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the matrix to translate\r\n * @param {vec2} v vector to translate by\r\n * @returns {mat3} out\r\n */\n\nexport function translate(out, a, v) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a10 = a[3],\n      a11 = a[4],\n      a12 = a[5],\n      a20 = a[6],\n      a21 = a[7],\n      a22 = a[8],\n      x = v[0],\n      y = v[1];\n  out[0] = a00;\n  out[1] = a01;\n  out[2] = a02;\n  out[3] = a10;\n  out[4] = a11;\n  out[5] = a12;\n  out[6] = x * a00 + y * a10 + a20;\n  out[7] = x * a01 + y * a11 + a21;\n  out[8] = x * a02 + y * a12 + a22;\n  return out;\n}\n/**\r\n * Rotates a mat3 by the given angle\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat3} out\r\n */\n\nexport function rotate(out, a, rad) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a10 = a[3],\n      a11 = a[4],\n      a12 = a[5],\n      a20 = a[6],\n      a21 = a[7],\n      a22 = a[8],\n      s = Math.sin(rad),\n      c = Math.cos(rad);\n  out[0] = c * a00 + s * a10;\n  out[1] = c * a01 + s * a11;\n  out[2] = c * a02 + s * a12;\n  out[3] = c * a10 - s * a00;\n  out[4] = c * a11 - s * a01;\n  out[5] = c * a12 - s * a02;\n  out[6] = a20;\n  out[7] = a21;\n  out[8] = a22;\n  return out;\n}\n;\n/**\r\n * Scales the mat3 by the dimensions in the given vec2\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the matrix to rotate\r\n * @param {vec2} v the vec2 to scale the matrix by\r\n * @returns {mat3} out\r\n **/\n\nexport function scale(out, a, v) {\n  var x = v[0],\n      y = v[1];\n  out[0] = x * a[0];\n  out[1] = x * a[1];\n  out[2] = x * a[2];\n  out[3] = y * a[3];\n  out[4] = y * a[4];\n  out[5] = y * a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\r\n * Creates a matrix from a vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.translate(dest, dest, vec);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {vec2} v Translation vector\r\n * @returns {mat3} out\r\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 1;\n  out[5] = 0;\n  out[6] = v[0];\n  out[7] = v[1];\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a given angle\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.rotate(dest, dest, rad);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat3} out\r\n */\n\nexport function fromRotation(out, rad) {\n  var s = Math.sin(rad),\n      c = Math.cos(rad);\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = -s;\n  out[4] = c;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.scale(dest, dest, vec);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {vec2} v Scaling vector\r\n * @returns {mat3} out\r\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = v[1];\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Copies the values from a mat2d into a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat2d} a the matrix to copy\r\n * @returns {mat3} out\r\n **/\n\nexport function fromMat2d(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = 0;\n  out[3] = a[2];\n  out[4] = a[3];\n  out[5] = 0;\n  out[6] = a[4];\n  out[7] = a[5];\n  out[8] = 1;\n  return out;\n}\n/**\r\n* Calculates a 3x3 matrix from the given quaternion\r\n*\r\n* @param {mat3} out mat3 receiving operation result\r\n* @param {quat} q Quaternion to create matrix from\r\n*\r\n* @returns {mat3} out\r\n*/\n\nexport function fromQuat(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[3] = yx - wz;\n  out[6] = zx + wy;\n  out[1] = yx + wz;\n  out[4] = 1 - xx - zz;\n  out[7] = zy - wx;\n  out[2] = zx - wy;\n  out[5] = zy + wx;\n  out[8] = 1 - xx - yy;\n  return out;\n}\n/**\r\n* Calculates a 3x3 normal matrix (transpose inverse) from the 4x4 matrix\r\n*\r\n* @param {mat3} out mat3 receiving operation result\r\n* @param {mat4} a Mat4 to derive the normal matrix from\r\n*\r\n* @returns {mat3} out\r\n*/\n\nexport function normalFromMat4(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[2] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[3] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[4] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[5] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[6] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[7] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[8] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  return out;\n}\n/**\r\n * Generates a 2D projection matrix with the given bounds\r\n *\r\n * @param {mat3} out mat3 frustum matrix will be written into\r\n * @param {number} width Width of your gl context\r\n * @param {number} height Height of gl context\r\n * @returns {mat3} out\r\n */\n\nexport function projection(out, width, height) {\n  out[0] = 2 / width;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -2 / height;\n  out[5] = 0;\n  out[6] = -1;\n  out[7] = 1;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Returns a string representation of a mat3\r\n *\r\n * @param {mat3} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\n\nexport function str(a) {\n  return 'mat3(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ', ' + a[4] + ', ' + a[5] + ', ' + a[6] + ', ' + a[7] + ', ' + a[8] + ')';\n}\n/**\r\n * Returns Frobenius norm of a mat3\r\n *\r\n * @param {mat3} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\n\nexport function frob(a) {\n  return Math.sqrt(Math.pow(a[0], 2) + Math.pow(a[1], 2) + Math.pow(a[2], 2) + Math.pow(a[3], 2) + Math.pow(a[4], 2) + Math.pow(a[5], 2) + Math.pow(a[6], 2) + Math.pow(a[7], 2) + Math.pow(a[8], 2));\n}\n/**\r\n * Adds two mat3's\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the first operand\r\n * @param {mat3} b the second operand\r\n * @returns {mat3} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  return out;\n}\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the first operand\r\n * @param {mat3} b the second operand\r\n * @returns {mat3} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  return out;\n}\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat3} out\r\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  return out;\n}\n/**\r\n * Adds two mat3's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat3} out the receiving vector\r\n * @param {mat3} a the first operand\r\n * @param {mat3} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat3} out\r\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  return out;\n}\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {mat3} a The first matrix.\r\n * @param {mat3} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8];\n}\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {mat3} a The first matrix.\r\n * @param {mat3} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7],\n      a8 = a[8];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3],\n      b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7],\n      b8 = b[8];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8));\n}\n/**\r\n * Alias for {@link mat3.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link mat3.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n/**\r\n * 4x4 Matrix<br>Format: column-major, when typed out it looks like row-major<br>The matrices are being post multiplied.\r\n * @module mat4\r\n */\n\n/**\r\n * Creates a new identity mat4\r\n *\r\n * @returns {mat4} a new 4x4 matrix\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(16);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n  }\n\n  out[0] = 1;\n  out[5] = 1;\n  out[10] = 1;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a new mat4 initialized with values from an existing matrix\r\n *\r\n * @param {mat4} a matrix to clone\r\n * @returns {mat4} a new 4x4 matrix\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\r\n * Copy the values from one mat4 to another\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\r\n * Create a new mat4 with the given values\r\n *\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\r\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\r\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\r\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\r\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\r\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\r\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\r\n * @returns {mat4} A new mat4\r\n */\n\nexport function fromValues(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\r\n * Set the components of a mat4 to the given values\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\r\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\r\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\r\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\r\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\r\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\r\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\r\n * @returns {mat4} out\r\n */\n\nexport function set(out, m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\r\n * Set a mat4 to the identity matrix\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @returns {mat4} out\r\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Transpose the values of a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n        a02 = a[2],\n        a03 = a[3];\n    var a12 = a[6],\n        a13 = a[7];\n    var a23 = a[11];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a01;\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a02;\n    out[9] = a12;\n    out[11] = a[14];\n    out[12] = a03;\n    out[13] = a13;\n    out[14] = a23;\n  } else {\n    out[0] = a[0];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a[1];\n    out[5] = a[5];\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a[2];\n    out[9] = a[6];\n    out[10] = a[10];\n    out[11] = a[14];\n    out[12] = a[3];\n    out[13] = a[7];\n    out[14] = a[11];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\r\n * Inverts a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n  return out;\n}\n/**\r\n * Calculates the adjugate of a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function adjoint(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  out[0] = a11 * (a22 * a33 - a23 * a32) - a21 * (a12 * a33 - a13 * a32) + a31 * (a12 * a23 - a13 * a22);\n  out[1] = -(a01 * (a22 * a33 - a23 * a32) - a21 * (a02 * a33 - a03 * a32) + a31 * (a02 * a23 - a03 * a22));\n  out[2] = a01 * (a12 * a33 - a13 * a32) - a11 * (a02 * a33 - a03 * a32) + a31 * (a02 * a13 - a03 * a12);\n  out[3] = -(a01 * (a12 * a23 - a13 * a22) - a11 * (a02 * a23 - a03 * a22) + a21 * (a02 * a13 - a03 * a12));\n  out[4] = -(a10 * (a22 * a33 - a23 * a32) - a20 * (a12 * a33 - a13 * a32) + a30 * (a12 * a23 - a13 * a22));\n  out[5] = a00 * (a22 * a33 - a23 * a32) - a20 * (a02 * a33 - a03 * a32) + a30 * (a02 * a23 - a03 * a22);\n  out[6] = -(a00 * (a12 * a33 - a13 * a32) - a10 * (a02 * a33 - a03 * a32) + a30 * (a02 * a13 - a03 * a12));\n  out[7] = a00 * (a12 * a23 - a13 * a22) - a10 * (a02 * a23 - a03 * a22) + a20 * (a02 * a13 - a03 * a12);\n  out[8] = a10 * (a21 * a33 - a23 * a31) - a20 * (a11 * a33 - a13 * a31) + a30 * (a11 * a23 - a13 * a21);\n  out[9] = -(a00 * (a21 * a33 - a23 * a31) - a20 * (a01 * a33 - a03 * a31) + a30 * (a01 * a23 - a03 * a21));\n  out[10] = a00 * (a11 * a33 - a13 * a31) - a10 * (a01 * a33 - a03 * a31) + a30 * (a01 * a13 - a03 * a11);\n  out[11] = -(a00 * (a11 * a23 - a13 * a21) - a10 * (a01 * a23 - a03 * a21) + a20 * (a01 * a13 - a03 * a11));\n  out[12] = -(a10 * (a21 * a32 - a22 * a31) - a20 * (a11 * a32 - a12 * a31) + a30 * (a11 * a22 - a12 * a21));\n  out[13] = a00 * (a21 * a32 - a22 * a31) - a20 * (a01 * a32 - a02 * a31) + a30 * (a01 * a22 - a02 * a21);\n  out[14] = -(a00 * (a11 * a32 - a12 * a31) - a10 * (a01 * a32 - a02 * a31) + a30 * (a01 * a12 - a02 * a11));\n  out[15] = a00 * (a11 * a22 - a12 * a21) - a10 * (a01 * a22 - a02 * a21) + a20 * (a01 * a12 - a02 * a11);\n  return out;\n}\n/**\r\n * Calculates the determinant of a mat4\r\n *\r\n * @param {mat4} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\n\nexport function determinant(a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  return b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n}\n/**\r\n * Multiplies two mat4s\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the first operand\r\n * @param {mat4} b the second operand\r\n * @returns {mat4} out\r\n */\n\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15]; // Cache only the current line of the second matrix\n\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[4];\n  b1 = b[5];\n  b2 = b[6];\n  b3 = b[7];\n  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[8];\n  b1 = b[9];\n  b2 = b[10];\n  b3 = b[11];\n  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[12];\n  b1 = b[13];\n  b2 = b[14];\n  b3 = b[15];\n  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  return out;\n}\n/**\r\n * Translate a mat4 by the given vector\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to translate\r\n * @param {vec3} v vector to translate by\r\n * @returns {mat4} out\r\n */\n\nexport function translate(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n\n  if (a === out) {\n    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n  } else {\n    a00 = a[0];\n    a01 = a[1];\n    a02 = a[2];\n    a03 = a[3];\n    a10 = a[4];\n    a11 = a[5];\n    a12 = a[6];\n    a13 = a[7];\n    a20 = a[8];\n    a21 = a[9];\n    a22 = a[10];\n    a23 = a[11];\n    out[0] = a00;\n    out[1] = a01;\n    out[2] = a02;\n    out[3] = a03;\n    out[4] = a10;\n    out[5] = a11;\n    out[6] = a12;\n    out[7] = a13;\n    out[8] = a20;\n    out[9] = a21;\n    out[10] = a22;\n    out[11] = a23;\n    out[12] = a00 * x + a10 * y + a20 * z + a[12];\n    out[13] = a01 * x + a11 * y + a21 * z + a[13];\n    out[14] = a02 * x + a12 * y + a22 * z + a[14];\n    out[15] = a03 * x + a13 * y + a23 * z + a[15];\n  }\n\n  return out;\n}\n/**\r\n * Scales the mat4 by the dimensions in the given vec3 not using vectorization\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to scale\r\n * @param {vec3} v the vec3 to scale the matrix by\r\n * @returns {mat4} out\r\n **/\n\nexport function scale(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  out[0] = a[0] * x;\n  out[1] = a[1] * x;\n  out[2] = a[2] * x;\n  out[3] = a[3] * x;\n  out[4] = a[4] * y;\n  out[5] = a[5] * y;\n  out[6] = a[6] * y;\n  out[7] = a[7] * y;\n  out[8] = a[8] * z;\n  out[9] = a[9] * z;\n  out[10] = a[10] * z;\n  out[11] = a[11] * z;\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\r\n * Rotates a mat4 by the given angle around the given axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @param {vec3} axis the axis to rotate around\r\n * @returns {mat4} out\r\n */\n\nexport function rotate(out, a, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.sqrt(x * x + y * y + z * z);\n  var s, c, t;\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n  var b00, b01, b02;\n  var b10, b11, b12;\n  var b20, b21, b22;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c;\n  a00 = a[0];\n  a01 = a[1];\n  a02 = a[2];\n  a03 = a[3];\n  a10 = a[4];\n  a11 = a[5];\n  a12 = a[6];\n  a13 = a[7];\n  a20 = a[8];\n  a21 = a[9];\n  a22 = a[10];\n  a23 = a[11]; // Construct the elements of the rotation matrix\n\n  b00 = x * x * t + c;\n  b01 = y * x * t + z * s;\n  b02 = z * x * t - y * s;\n  b10 = x * y * t - z * s;\n  b11 = y * y * t + c;\n  b12 = z * y * t + x * s;\n  b20 = x * z * t + y * s;\n  b21 = y * z * t - x * s;\n  b22 = z * z * t + c; // Perform rotation-specific matrix multiplication\n\n  out[0] = a00 * b00 + a10 * b01 + a20 * b02;\n  out[1] = a01 * b00 + a11 * b01 + a21 * b02;\n  out[2] = a02 * b00 + a12 * b01 + a22 * b02;\n  out[3] = a03 * b00 + a13 * b01 + a23 * b02;\n  out[4] = a00 * b10 + a10 * b11 + a20 * b12;\n  out[5] = a01 * b10 + a11 * b11 + a21 * b12;\n  out[6] = a02 * b10 + a12 * b11 + a22 * b12;\n  out[7] = a03 * b10 + a13 * b11 + a23 * b12;\n  out[8] = a00 * b20 + a10 * b21 + a20 * b22;\n  out[9] = a01 * b20 + a11 * b21 + a21 * b22;\n  out[10] = a02 * b20 + a12 * b21 + a22 * b22;\n  out[11] = a03 * b20 + a13 * b21 + a23 * b22;\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\r\n * Rotates a matrix by the given angle around the X axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function rotateX(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[4] = a10 * c + a20 * s;\n  out[5] = a11 * c + a21 * s;\n  out[6] = a12 * c + a22 * s;\n  out[7] = a13 * c + a23 * s;\n  out[8] = a20 * c - a10 * s;\n  out[9] = a21 * c - a11 * s;\n  out[10] = a22 * c - a12 * s;\n  out[11] = a23 * c - a13 * s;\n  return out;\n}\n/**\r\n * Rotates a matrix by the given angle around the Y axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function rotateY(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[4] = a[4];\n    out[5] = a[5];\n    out[6] = a[6];\n    out[7] = a[7];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c - a20 * s;\n  out[1] = a01 * c - a21 * s;\n  out[2] = a02 * c - a22 * s;\n  out[3] = a03 * c - a23 * s;\n  out[8] = a00 * s + a20 * c;\n  out[9] = a01 * s + a21 * c;\n  out[10] = a02 * s + a22 * c;\n  out[11] = a03 * s + a23 * c;\n  return out;\n}\n/**\r\n * Rotates a matrix by the given angle around the Z axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function rotateZ(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c + a10 * s;\n  out[1] = a01 * c + a11 * s;\n  out[2] = a02 * c + a12 * s;\n  out[3] = a03 * c + a13 * s;\n  out[4] = a10 * c - a00 * s;\n  out[5] = a11 * c - a01 * s;\n  out[6] = a12 * c - a02 * s;\n  out[7] = a13 * c - a03 * s;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, dest, vec);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {vec3} v Translation vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.scale(dest, dest, vec);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {vec3} v Scaling vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = v[1];\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = v[2];\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a given angle around a given axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotate(dest, dest, rad, axis);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @param {vec3} axis the axis to rotate around\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotation(out, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.sqrt(x * x + y * y + z * z);\n  var s, c, t;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c; // Perform rotation-specific matrix multiplication\n\n  out[0] = x * x * t + c;\n  out[1] = y * x * t + z * s;\n  out[2] = z * x * t - y * s;\n  out[3] = 0;\n  out[4] = x * y * t - z * s;\n  out[5] = y * y * t + c;\n  out[6] = z * y * t + x * s;\n  out[7] = 0;\n  out[8] = x * z * t + y * s;\n  out[9] = y * z * t - x * s;\n  out[10] = z * z * t + c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from the given angle around the X axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateX(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function fromXRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = c;\n  out[6] = s;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = -s;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from the given angle around the Y axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateY(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function fromYRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = 0;\n  out[2] = -s;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = s;\n  out[9] = 0;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from the given angle around the Z axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateZ(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function fromZRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -s;\n  out[5] = c;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a quaternion rotation and vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {vec3} v Translation vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotationTranslation(out, q, v) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - (yy + zz);\n  out[1] = xy + wz;\n  out[2] = xz - wy;\n  out[3] = 0;\n  out[4] = xy - wz;\n  out[5] = 1 - (xx + zz);\n  out[6] = yz + wx;\n  out[7] = 0;\n  out[8] = xz + wy;\n  out[9] = yz - wx;\n  out[10] = 1 - (xx + yy);\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a new mat4 from a dual quat.\r\n *\r\n * @param {mat4} out Matrix\r\n * @param {quat2} a Dual Quaternion\r\n * @returns {mat4} mat4 receiving operation result\r\n */\n\nexport function fromQuat2(out, a) {\n  var translation = new glMatrix.ARRAY_TYPE(3);\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7];\n  var magnitude = bx * bx + by * by + bz * bz + bw * bw; //Only scale if it makes sense\n\n  if (magnitude > 0) {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2 / magnitude;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2 / magnitude;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2 / magnitude;\n  } else {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n  }\n\n  fromRotationTranslation(out, a, translation);\n  return out;\n}\n/**\r\n * Returns the translation vector component of a transformation\r\n *  matrix. If a matrix is built with fromRotationTranslation,\r\n *  the returned vector will be the same as the translation vector\r\n *  originally supplied.\r\n * @param  {vec3} out Vector to receive translation component\r\n * @param  {mat4} mat Matrix to be decomposed (input)\r\n * @return {vec3} out\r\n */\n\nexport function getTranslation(out, mat) {\n  out[0] = mat[12];\n  out[1] = mat[13];\n  out[2] = mat[14];\n  return out;\n}\n/**\r\n * Returns the scaling factor component of a transformation\r\n *  matrix. If a matrix is built with fromRotationTranslationScale\r\n *  with a normalized Quaternion paramter, the returned vector will be\r\n *  the same as the scaling vector\r\n *  originally supplied.\r\n * @param  {vec3} out Vector to receive scaling factor component\r\n * @param  {mat4} mat Matrix to be decomposed (input)\r\n * @return {vec3} out\r\n */\n\nexport function getScaling(out, mat) {\n  var m11 = mat[0];\n  var m12 = mat[1];\n  var m13 = mat[2];\n  var m21 = mat[4];\n  var m22 = mat[5];\n  var m23 = mat[6];\n  var m31 = mat[8];\n  var m32 = mat[9];\n  var m33 = mat[10];\n  out[0] = Math.sqrt(m11 * m11 + m12 * m12 + m13 * m13);\n  out[1] = Math.sqrt(m21 * m21 + m22 * m22 + m23 * m23);\n  out[2] = Math.sqrt(m31 * m31 + m32 * m32 + m33 * m33);\n  return out;\n}\n/**\r\n * Returns a quaternion representing the rotational component\r\n *  of a transformation matrix. If a matrix is built with\r\n *  fromRotationTranslation, the returned quaternion will be the\r\n *  same as the quaternion originally supplied.\r\n * @param {quat} out Quaternion to receive the rotation component\r\n * @param {mat4} mat Matrix to be decomposed (input)\r\n * @return {quat} out\r\n */\n\nexport function getRotation(out, mat) {\n  // Algorithm taken from http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToQuaternion/index.htm\n  var trace = mat[0] + mat[5] + mat[10];\n  var S = 0;\n\n  if (trace > 0) {\n    S = Math.sqrt(trace + 1.0) * 2;\n    out[3] = 0.25 * S;\n    out[0] = (mat[6] - mat[9]) / S;\n    out[1] = (mat[8] - mat[2]) / S;\n    out[2] = (mat[1] - mat[4]) / S;\n  } else if (mat[0] > mat[5] && mat[0] > mat[10]) {\n    S = Math.sqrt(1.0 + mat[0] - mat[5] - mat[10]) * 2;\n    out[3] = (mat[6] - mat[9]) / S;\n    out[0] = 0.25 * S;\n    out[1] = (mat[1] + mat[4]) / S;\n    out[2] = (mat[8] + mat[2]) / S;\n  } else if (mat[5] > mat[10]) {\n    S = Math.sqrt(1.0 + mat[5] - mat[0] - mat[10]) * 2;\n    out[3] = (mat[8] - mat[2]) / S;\n    out[0] = (mat[1] + mat[4]) / S;\n    out[1] = 0.25 * S;\n    out[2] = (mat[6] + mat[9]) / S;\n  } else {\n    S = Math.sqrt(1.0 + mat[10] - mat[0] - mat[5]) * 2;\n    out[3] = (mat[1] - mat[4]) / S;\n    out[0] = (mat[8] + mat[2]) / S;\n    out[1] = (mat[6] + mat[9]) / S;\n    out[2] = 0.25 * S;\n  }\n\n  return out;\n}\n/**\r\n * Creates a matrix from a quaternion rotation, vector translation and vector scale\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *     mat4.scale(dest, scale)\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {vec3} v Translation vector\r\n * @param {vec3} s Scaling vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotationTranslationScale(out, q, v, s) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  out[0] = (1 - (yy + zz)) * sx;\n  out[1] = (xy + wz) * sx;\n  out[2] = (xz - wy) * sx;\n  out[3] = 0;\n  out[4] = (xy - wz) * sy;\n  out[5] = (1 - (xx + zz)) * sy;\n  out[6] = (yz + wx) * sy;\n  out[7] = 0;\n  out[8] = (xz + wy) * sz;\n  out[9] = (yz - wx) * sz;\n  out[10] = (1 - (xx + yy)) * sz;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     mat4.translate(dest, origin);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *     mat4.scale(dest, scale)\r\n *     mat4.translate(dest, negativeOrigin);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {vec3} v Translation vector\r\n * @param {vec3} s Scaling vector\r\n * @param {vec3} o The origin vector around which to scale and rotate\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotationTranslationScaleOrigin(out, q, v, s, o) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  var ox = o[0];\n  var oy = o[1];\n  var oz = o[2];\n  var out0 = (1 - (yy + zz)) * sx;\n  var out1 = (xy + wz) * sx;\n  var out2 = (xz - wy) * sx;\n  var out4 = (xy - wz) * sy;\n  var out5 = (1 - (xx + zz)) * sy;\n  var out6 = (yz + wx) * sy;\n  var out8 = (xz + wy) * sz;\n  var out9 = (yz - wx) * sz;\n  var out10 = (1 - (xx + yy)) * sz;\n  out[0] = out0;\n  out[1] = out1;\n  out[2] = out2;\n  out[3] = 0;\n  out[4] = out4;\n  out[5] = out5;\n  out[6] = out6;\n  out[7] = 0;\n  out[8] = out8;\n  out[9] = out9;\n  out[10] = out10;\n  out[11] = 0;\n  out[12] = v[0] + ox - (out0 * ox + out4 * oy + out8 * oz);\n  out[13] = v[1] + oy - (out1 * ox + out5 * oy + out9 * oz);\n  out[14] = v[2] + oz - (out2 * ox + out6 * oy + out10 * oz);\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Calculates a 4x4 matrix from the given quaternion\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat} q Quaternion to create matrix from\r\n *\r\n * @returns {mat4} out\r\n */\n\nexport function fromQuat(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[1] = yx + wz;\n  out[2] = zx - wy;\n  out[3] = 0;\n  out[4] = yx - wz;\n  out[5] = 1 - xx - zz;\n  out[6] = zy + wx;\n  out[7] = 0;\n  out[8] = zx + wy;\n  out[9] = zy - wx;\n  out[10] = 1 - xx - yy;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Generates a frustum matrix with the given bounds\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {Number} left Left bound of the frustum\r\n * @param {Number} right Right bound of the frustum\r\n * @param {Number} bottom Bottom bound of the frustum\r\n * @param {Number} top Top bound of the frustum\r\n * @param {Number} near Near bound of the frustum\r\n * @param {Number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\n\nexport function frustum(out, left, right, bottom, top, near, far) {\n  var rl = 1 / (right - left);\n  var tb = 1 / (top - bottom);\n  var nf = 1 / (near - far);\n  out[0] = near * 2 * rl;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = near * 2 * tb;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = (right + left) * rl;\n  out[9] = (top + bottom) * tb;\n  out[10] = (far + near) * nf;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = far * near * 2 * nf;\n  out[15] = 0;\n  return out;\n}\n/**\r\n * Generates a perspective projection matrix with the given bounds.\r\n * Passing null/undefined/no value for far will generate infinite projection matrix.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {number} fovy Vertical field of view in radians\r\n * @param {number} aspect Aspect ratio. typically viewport width/height\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum, can be null or Infinity\r\n * @returns {mat4} out\r\n */\n\nexport function perspective(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf;\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n\n  if (far != null && far !== Infinity) {\n    nf = 1 / (near - far);\n    out[10] = (far + near) * nf;\n    out[14] = 2 * far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -2 * near;\n  }\n\n  return out;\n}\n/**\r\n * Generates a perspective projection matrix with the given field of view.\r\n * This is primarily useful for generating projection matrices to be used\r\n * with the still experiemental WebVR API.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {Object} fov Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\n\nexport function perspectiveFromFieldOfView(out, fov, near, far) {\n  var upTan = Math.tan(fov.upDegrees * Math.PI / 180.0);\n  var downTan = Math.tan(fov.downDegrees * Math.PI / 180.0);\n  var leftTan = Math.tan(fov.leftDegrees * Math.PI / 180.0);\n  var rightTan = Math.tan(fov.rightDegrees * Math.PI / 180.0);\n  var xScale = 2.0 / (leftTan + rightTan);\n  var yScale = 2.0 / (upTan + downTan);\n  out[0] = xScale;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  out[4] = 0.0;\n  out[5] = yScale;\n  out[6] = 0.0;\n  out[7] = 0.0;\n  out[8] = -((leftTan - rightTan) * xScale * 0.5);\n  out[9] = (upTan - downTan) * yScale * 0.5;\n  out[10] = far / (near - far);\n  out[11] = -1.0;\n  out[12] = 0.0;\n  out[13] = 0.0;\n  out[14] = far * near / (near - far);\n  out[15] = 0.0;\n  return out;\n}\n/**\r\n * Generates a orthogonal projection matrix with the given bounds\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {number} left Left bound of the frustum\r\n * @param {number} right Right bound of the frustum\r\n * @param {number} bottom Bottom bound of the frustum\r\n * @param {number} top Top bound of the frustum\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\n\nexport function ortho(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 2 * nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = (far + near) * nf;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Generates a look-at matrix with the given eye position, focal point, and up axis.\r\n * If you want a matrix that actually makes an object look at another object, you should use targetTo instead.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {vec3} eye Position of the viewer\r\n * @param {vec3} center Point the viewer is looking at\r\n * @param {vec3} up vec3 pointing up\r\n * @returns {mat4} out\r\n */\n\nexport function lookAt(out, eye, center, up) {\n  var x0, x1, x2, y0, y1, y2, z0, z1, z2, len;\n  var eyex = eye[0];\n  var eyey = eye[1];\n  var eyez = eye[2];\n  var upx = up[0];\n  var upy = up[1];\n  var upz = up[2];\n  var centerx = center[0];\n  var centery = center[1];\n  var centerz = center[2];\n\n  if (Math.abs(eyex - centerx) < glMatrix.EPSILON && Math.abs(eyey - centery) < glMatrix.EPSILON && Math.abs(eyez - centerz) < glMatrix.EPSILON) {\n    return identity(out);\n  }\n\n  z0 = eyex - centerx;\n  z1 = eyey - centery;\n  z2 = eyez - centerz;\n  len = 1 / Math.sqrt(z0 * z0 + z1 * z1 + z2 * z2);\n  z0 *= len;\n  z1 *= len;\n  z2 *= len;\n  x0 = upy * z2 - upz * z1;\n  x1 = upz * z0 - upx * z2;\n  x2 = upx * z1 - upy * z0;\n  len = Math.sqrt(x0 * x0 + x1 * x1 + x2 * x2);\n\n  if (!len) {\n    x0 = 0;\n    x1 = 0;\n    x2 = 0;\n  } else {\n    len = 1 / len;\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  y0 = z1 * x2 - z2 * x1;\n  y1 = z2 * x0 - z0 * x2;\n  y2 = z0 * x1 - z1 * x0;\n  len = Math.sqrt(y0 * y0 + y1 * y1 + y2 * y2);\n\n  if (!len) {\n    y0 = 0;\n    y1 = 0;\n    y2 = 0;\n  } else {\n    len = 1 / len;\n    y0 *= len;\n    y1 *= len;\n    y2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = y0;\n  out[2] = z0;\n  out[3] = 0;\n  out[4] = x1;\n  out[5] = y1;\n  out[6] = z1;\n  out[7] = 0;\n  out[8] = x2;\n  out[9] = y2;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\n  out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\n  out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Generates a matrix that makes something look at something else.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {vec3} eye Position of the viewer\r\n * @param {vec3} center Point the viewer is looking at\r\n * @param {vec3} up vec3 pointing up\r\n * @returns {mat4} out\r\n */\n\nexport function targetTo(out, eye, target, up) {\n  var eyex = eye[0],\n      eyey = eye[1],\n      eyez = eye[2],\n      upx = up[0],\n      upy = up[1],\n      upz = up[2];\n  var z0 = eyex - target[0],\n      z1 = eyey - target[1],\n      z2 = eyez - target[2];\n  var len = z0 * z0 + z1 * z1 + z2 * z2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    z0 *= len;\n    z1 *= len;\n    z2 *= len;\n  }\n\n  var x0 = upy * z2 - upz * z1,\n      x1 = upz * z0 - upx * z2,\n      x2 = upx * z1 - upy * z0;\n  len = x0 * x0 + x1 * x1 + x2 * x2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = x1;\n  out[2] = x2;\n  out[3] = 0;\n  out[4] = z1 * x2 - z2 * x1;\n  out[5] = z2 * x0 - z0 * x2;\n  out[6] = z0 * x1 - z1 * x0;\n  out[7] = 0;\n  out[8] = z0;\n  out[9] = z1;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = eyex;\n  out[13] = eyey;\n  out[14] = eyez;\n  out[15] = 1;\n  return out;\n}\n;\n/**\r\n * Returns a string representation of a mat4\r\n *\r\n * @param {mat4} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\n\nexport function str(a) {\n  return 'mat4(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ', ' + a[4] + ', ' + a[5] + ', ' + a[6] + ', ' + a[7] + ', ' + a[8] + ', ' + a[9] + ', ' + a[10] + ', ' + a[11] + ', ' + a[12] + ', ' + a[13] + ', ' + a[14] + ', ' + a[15] + ')';\n}\n/**\r\n * Returns Frobenius norm of a mat4\r\n *\r\n * @param {mat4} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\n\nexport function frob(a) {\n  return Math.sqrt(Math.pow(a[0], 2) + Math.pow(a[1], 2) + Math.pow(a[2], 2) + Math.pow(a[3], 2) + Math.pow(a[4], 2) + Math.pow(a[5], 2) + Math.pow(a[6], 2) + Math.pow(a[7], 2) + Math.pow(a[8], 2) + Math.pow(a[9], 2) + Math.pow(a[10], 2) + Math.pow(a[11], 2) + Math.pow(a[12], 2) + Math.pow(a[13], 2) + Math.pow(a[14], 2) + Math.pow(a[15], 2));\n}\n/**\r\n * Adds two mat4's\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the first operand\r\n * @param {mat4} b the second operand\r\n * @returns {mat4} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  out[9] = a[9] + b[9];\n  out[10] = a[10] + b[10];\n  out[11] = a[11] + b[11];\n  out[12] = a[12] + b[12];\n  out[13] = a[13] + b[13];\n  out[14] = a[14] + b[14];\n  out[15] = a[15] + b[15];\n  return out;\n}\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the first operand\r\n * @param {mat4} b the second operand\r\n * @returns {mat4} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  out[9] = a[9] - b[9];\n  out[10] = a[10] - b[10];\n  out[11] = a[11] - b[11];\n  out[12] = a[12] - b[12];\n  out[13] = a[13] - b[13];\n  out[14] = a[14] - b[14];\n  out[15] = a[15] - b[15];\n  return out;\n}\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat4} out\r\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  out[9] = a[9] * b;\n  out[10] = a[10] * b;\n  out[11] = a[11] * b;\n  out[12] = a[12] * b;\n  out[13] = a[13] * b;\n  out[14] = a[14] * b;\n  out[15] = a[15] * b;\n  return out;\n}\n/**\r\n * Adds two mat4's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat4} out the receiving vector\r\n * @param {mat4} a the first operand\r\n * @param {mat4} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat4} out\r\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  out[9] = a[9] + b[9] * scale;\n  out[10] = a[10] + b[10] * scale;\n  out[11] = a[11] + b[11] * scale;\n  out[12] = a[12] + b[12] * scale;\n  out[13] = a[13] + b[13] * scale;\n  out[14] = a[14] + b[14] * scale;\n  out[15] = a[15] + b[15] * scale;\n  return out;\n}\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {mat4} a The first matrix.\r\n * @param {mat4} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8] && a[9] === b[9] && a[10] === b[10] && a[11] === b[11] && a[12] === b[12] && a[13] === b[13] && a[14] === b[14] && a[15] === b[15];\n}\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {mat4} a The first matrix.\r\n * @param {mat4} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7];\n  var a8 = a[8],\n      a9 = a[9],\n      a10 = a[10],\n      a11 = a[11];\n  var a12 = a[12],\n      a13 = a[13],\n      a14 = a[14],\n      a15 = a[15];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  var b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7];\n  var b8 = b[8],\n      b9 = b[9],\n      b10 = b[10],\n      b11 = b[11];\n  var b12 = b[12],\n      b13 = b[13],\n      b14 = b[14],\n      b15 = b[15];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8)) && Math.abs(a9 - b9) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a9), Math.abs(b9)) && Math.abs(a10 - b10) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a10), Math.abs(b10)) && Math.abs(a11 - b11) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a11), Math.abs(b11)) && Math.abs(a12 - b12) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a12), Math.abs(b12)) && Math.abs(a13 - b13) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a13), Math.abs(b13)) && Math.abs(a14 - b14) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a14), Math.abs(b14)) && Math.abs(a15 - b15) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a15), Math.abs(b15));\n}\n/**\r\n * Alias for {@link mat4.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link mat4.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\nimport * as mat3 from \"./mat3.js\";\nimport * as vec3 from \"./vec3.js\";\nimport * as vec4 from \"./vec4.js\";\n/**\r\n * Quaternion\r\n * @module quat\r\n */\n\n/**\r\n * Creates a new identity quat\r\n *\r\n * @returns {quat} a new quaternion\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  out[3] = 1;\n  return out;\n}\n/**\r\n * Set a quat to the identity quaternion\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @returns {quat} out\r\n */\n\nexport function identity(out) {\n  out[0] = 0;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  return out;\n}\n/**\r\n * Sets a quat from the given angle and rotation axis,\r\n * then returns it.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {vec3} axis the axis around which to rotate\r\n * @param {Number} rad the angle in radians\r\n * @returns {quat} out\r\n **/\n\nexport function setAxisAngle(out, axis, rad) {\n  rad = rad * 0.5;\n  var s = Math.sin(rad);\n  out[0] = s * axis[0];\n  out[1] = s * axis[1];\n  out[2] = s * axis[2];\n  out[3] = Math.cos(rad);\n  return out;\n}\n/**\r\n * Gets the rotation axis and angle for a given\r\n *  quaternion. If a quaternion is created with\r\n *  setAxisAngle, this method will return the same\r\n *  values as providied in the original parameter list\r\n *  OR functionally equivalent values.\r\n * Example: The quaternion formed by axis [0, 0, 1] and\r\n *  angle -90 is the same as the quaternion formed by\r\n *  [0, 0, 1] and 270. This method favors the latter.\r\n * @param  {vec3} out_axis  Vector receiving the axis of rotation\r\n * @param  {quat} q     Quaternion to be decomposed\r\n * @return {Number}     Angle, in radians, of the rotation\r\n */\n\nexport function getAxisAngle(out_axis, q) {\n  var rad = Math.acos(q[3]) * 2.0;\n  var s = Math.sin(rad / 2.0);\n\n  if (s > glMatrix.EPSILON) {\n    out_axis[0] = q[0] / s;\n    out_axis[1] = q[1] / s;\n    out_axis[2] = q[2] / s;\n  } else {\n    // If s is zero, return any axis (no rotation - axis does not matter)\n    out_axis[0] = 1;\n    out_axis[1] = 0;\n    out_axis[2] = 0;\n  }\n\n  return rad;\n}\n/**\r\n * Multiplies two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a the first operand\r\n * @param {quat} b the second operand\r\n * @returns {quat} out\r\n */\n\nexport function multiply(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2],\n      bw = b[3];\n  out[0] = ax * bw + aw * bx + ay * bz - az * by;\n  out[1] = ay * bw + aw * by + az * bx - ax * bz;\n  out[2] = az * bw + aw * bz + ax * by - ay * bx;\n  out[3] = aw * bw - ax * bx - ay * by - az * bz;\n  return out;\n}\n/**\r\n * Rotates a quaternion by the given angle about the X axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {quat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\n\nexport function rotateX(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw + aw * bx;\n  out[1] = ay * bw + az * bx;\n  out[2] = az * bw - ay * bx;\n  out[3] = aw * bw - ax * bx;\n  return out;\n}\n/**\r\n * Rotates a quaternion by the given angle about the Y axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {quat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\n\nexport function rotateY(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var by = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw - az * by;\n  out[1] = ay * bw + aw * by;\n  out[2] = az * bw + ax * by;\n  out[3] = aw * bw - ay * by;\n  return out;\n}\n/**\r\n * Rotates a quaternion by the given angle about the Z axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {quat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\n\nexport function rotateZ(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bz = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw + ay * bz;\n  out[1] = ay * bw - ax * bz;\n  out[2] = az * bw + aw * bz;\n  out[3] = aw * bw - az * bz;\n  return out;\n}\n/**\r\n * Calculates the W component of a quat from the X, Y, and Z components.\r\n * Assumes that quaternion is 1 unit in length.\r\n * Any existing W component will be ignored.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a quat to calculate W component of\r\n * @returns {quat} out\r\n */\n\nexport function calculateW(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = Math.sqrt(Math.abs(1.0 - x * x - y * y - z * z));\n  return out;\n}\n/**\r\n * Performs a spherical linear interpolation between two quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a the first operand\r\n * @param {quat} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n */\n\nexport function slerp(out, a, b, t) {\n  // benchmarks:\n  //    http://jsperf.com/quaternion-slerp-implementations\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2],\n      bw = b[3];\n  var omega, cosom, sinom, scale0, scale1; // calc cosine\n\n  cosom = ax * bx + ay * by + az * bz + aw * bw; // adjust signs (if necessary)\n\n  if (cosom < 0.0) {\n    cosom = -cosom;\n    bx = -bx;\n    by = -by;\n    bz = -bz;\n    bw = -bw;\n  } // calculate coefficients\n\n\n  if (1.0 - cosom > glMatrix.EPSILON) {\n    // standard case (slerp)\n    omega = Math.acos(cosom);\n    sinom = Math.sin(omega);\n    scale0 = Math.sin((1.0 - t) * omega) / sinom;\n    scale1 = Math.sin(t * omega) / sinom;\n  } else {\n    // \"from\" and \"to\" quaternions are very close\n    //  ... so we can do a linear interpolation\n    scale0 = 1.0 - t;\n    scale1 = t;\n  } // calculate final values\n\n\n  out[0] = scale0 * ax + scale1 * bx;\n  out[1] = scale0 * ay + scale1 * by;\n  out[2] = scale0 * az + scale1 * bz;\n  out[3] = scale0 * aw + scale1 * bw;\n  return out;\n}\n/**\r\n * Generates a random quaternion\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @returns {quat} out\r\n */\n\nexport function random(out) {\n  // Implementation of http://planning.cs.uiuc.edu/node198.html\n  // TODO: Calling random 3 times is probably not the fastest solution\n  var u1 = glMatrix.RANDOM();\n  var u2 = glMatrix.RANDOM();\n  var u3 = glMatrix.RANDOM();\n  var sqrt1MinusU1 = Math.sqrt(1 - u1);\n  var sqrtU1 = Math.sqrt(u1);\n  out[0] = sqrt1MinusU1 * Math.sin(2.0 * Math.PI * u2);\n  out[1] = sqrt1MinusU1 * Math.cos(2.0 * Math.PI * u2);\n  out[2] = sqrtU1 * Math.sin(2.0 * Math.PI * u3);\n  out[3] = sqrtU1 * Math.cos(2.0 * Math.PI * u3);\n  return out;\n}\n/**\r\n * Calculates the inverse of a quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a quat to calculate inverse of\r\n * @returns {quat} out\r\n */\n\nexport function invert(out, a) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var dot = a0 * a0 + a1 * a1 + a2 * a2 + a3 * a3;\n  var invDot = dot ? 1.0 / dot : 0; // TODO: Would be faster to return [0,0,0,0] immediately if dot == 0\n\n  out[0] = -a0 * invDot;\n  out[1] = -a1 * invDot;\n  out[2] = -a2 * invDot;\n  out[3] = a3 * invDot;\n  return out;\n}\n/**\r\n * Calculates the conjugate of a quat\r\n * If the quaternion is normalized, this function is faster than quat.inverse and produces the same result.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a quat to calculate conjugate of\r\n * @returns {quat} out\r\n */\n\nexport function conjugate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Creates a quaternion from the given 3x3 rotation matrix.\r\n *\r\n * NOTE: The resultant quaternion is not normalized, so you should be sure\r\n * to renormalize the quaternion yourself where necessary.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {mat3} m rotation matrix\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport function fromMat3(out, m) {\n  // Algorithm in Ken Shoemake's article in 1987 SIGGRAPH course notes\n  // article \"Quaternion Calculus and Fast Animation\".\n  var fTrace = m[0] + m[4] + m[8];\n  var fRoot;\n\n  if (fTrace > 0.0) {\n    // |w| > 1/2, may as well choose w > 1/2\n    fRoot = Math.sqrt(fTrace + 1.0); // 2w\n\n    out[3] = 0.5 * fRoot;\n    fRoot = 0.5 / fRoot; // 1/(4w)\n\n    out[0] = (m[5] - m[7]) * fRoot;\n    out[1] = (m[6] - m[2]) * fRoot;\n    out[2] = (m[1] - m[3]) * fRoot;\n  } else {\n    // |w| <= 1/2\n    var i = 0;\n    if (m[4] > m[0]) i = 1;\n    if (m[8] > m[i * 3 + i]) i = 2;\n    var j = (i + 1) % 3;\n    var k = (i + 2) % 3;\n    fRoot = Math.sqrt(m[i * 3 + i] - m[j * 3 + j] - m[k * 3 + k] + 1.0);\n    out[i] = 0.5 * fRoot;\n    fRoot = 0.5 / fRoot;\n    out[3] = (m[j * 3 + k] - m[k * 3 + j]) * fRoot;\n    out[j] = (m[j * 3 + i] + m[i * 3 + j]) * fRoot;\n    out[k] = (m[k * 3 + i] + m[i * 3 + k]) * fRoot;\n  }\n\n  return out;\n}\n/**\r\n * Creates a quaternion from the given euler angle x, y, z.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {x} Angle to rotate around X axis in degrees.\r\n * @param {y} Angle to rotate around Y axis in degrees.\r\n * @param {z} Angle to rotate around Z axis in degrees.\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport function fromEuler(out, x, y, z) {\n  var halfToRad = 0.5 * Math.PI / 180.0;\n  x *= halfToRad;\n  y *= halfToRad;\n  z *= halfToRad;\n  var sx = Math.sin(x);\n  var cx = Math.cos(x);\n  var sy = Math.sin(y);\n  var cy = Math.cos(y);\n  var sz = Math.sin(z);\n  var cz = Math.cos(z);\n  out[0] = sx * cy * cz - cx * sy * sz;\n  out[1] = cx * sy * cz + sx * cy * sz;\n  out[2] = cx * cy * sz - sx * sy * cz;\n  out[3] = cx * cy * cz + sx * sy * sz;\n  return out;\n}\n/**\r\n * Returns a string representation of a quatenion\r\n *\r\n * @param {quat} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return 'quat(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ')';\n}\n/**\r\n * Creates a new quat initialized with values from an existing quaternion\r\n *\r\n * @param {quat} a quaternion to clone\r\n * @returns {quat} a new quaternion\r\n * @function\r\n */\n\nexport var clone = vec4.clone;\n/**\r\n * Creates a new quat initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {quat} a new quaternion\r\n * @function\r\n */\n\nexport var fromValues = vec4.fromValues;\n/**\r\n * Copy the values from one quat to another\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a the source quaternion\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var copy = vec4.copy;\n/**\r\n * Set the components of a quat to the given values\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var set = vec4.set;\n/**\r\n * Adds two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a the first operand\r\n * @param {quat} b the second operand\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var add = vec4.add;\n/**\r\n * Alias for {@link quat.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Scales a quat by a scalar number\r\n *\r\n * @param {quat} out the receiving vector\r\n * @param {quat} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var scale = vec4.scale;\n/**\r\n * Calculates the dot product of two quat's\r\n *\r\n * @param {quat} a the first operand\r\n * @param {quat} b the second operand\r\n * @returns {Number} dot product of a and b\r\n * @function\r\n */\n\nexport var dot = vec4.dot;\n/**\r\n * Performs a linear interpolation between two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a the first operand\r\n * @param {quat} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var lerp = vec4.lerp;\n/**\r\n * Calculates the length of a quat\r\n *\r\n * @param {quat} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport var length = vec4.length;\n/**\r\n * Alias for {@link quat.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Calculates the squared length of a quat\r\n *\r\n * @param {quat} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n * @function\r\n */\n\nexport var squaredLength = vec4.squaredLength;\n/**\r\n * Alias for {@link quat.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Normalize a quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a quaternion to normalize\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var normalize = vec4.normalize;\n/**\r\n * Returns whether or not the quaternions have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {quat} a The first quaternion.\r\n * @param {quat} b The second quaternion.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport var exactEquals = vec4.exactEquals;\n/**\r\n * Returns whether or not the quaternions have approximately the same elements in the same position.\r\n *\r\n * @param {quat} a The first vector.\r\n * @param {quat} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport var equals = vec4.equals;\n/**\r\n * Sets a quaternion to represent the shortest rotation from one\r\n * vector to another.\r\n *\r\n * Both vectors are assumed to be unit length.\r\n *\r\n * @param {quat} out the receiving quaternion.\r\n * @param {vec3} a the initial vector\r\n * @param {vec3} b the destination vector\r\n * @returns {quat} out\r\n */\n\nexport var rotationTo = function () {\n  var tmpvec3 = vec3.create();\n  var xUnitVec3 = vec3.fromValues(1, 0, 0);\n  var yUnitVec3 = vec3.fromValues(0, 1, 0);\n  return function (out, a, b) {\n    var dot = vec3.dot(a, b);\n\n    if (dot < -0.999999) {\n      vec3.cross(tmpvec3, xUnitVec3, a);\n      if (vec3.len(tmpvec3) < 0.000001) vec3.cross(tmpvec3, yUnitVec3, a);\n      vec3.normalize(tmpvec3, tmpvec3);\n      setAxisAngle(out, tmpvec3, Math.PI);\n      return out;\n    } else if (dot > 0.999999) {\n      out[0] = 0;\n      out[1] = 0;\n      out[2] = 0;\n      out[3] = 1;\n      return out;\n    } else {\n      vec3.cross(tmpvec3, a, b);\n      out[0] = tmpvec3[0];\n      out[1] = tmpvec3[1];\n      out[2] = tmpvec3[2];\n      out[3] = 1 + dot;\n      return normalize(out, out);\n    }\n  };\n}();\n/**\r\n * Performs a spherical linear interpolation with two control points\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a the first operand\r\n * @param {quat} b the second operand\r\n * @param {quat} c the third operand\r\n * @param {quat} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n */\n\nexport var sqlerp = function () {\n  var temp1 = create();\n  var temp2 = create();\n  return function (out, a, b, c, d, t) {\n    slerp(temp1, a, d, t);\n    slerp(temp2, b, c, t);\n    slerp(out, temp1, temp2, 2 * t * (1 - t));\n    return out;\n  };\n}();\n/**\r\n * Sets the specified quaternion with values corresponding to the given\r\n * axes. Each axis is a vec3 and is expected to be unit length and\r\n * perpendicular to all other specified axes.\r\n *\r\n * @param {vec3} view  the vector representing the viewing direction\r\n * @param {vec3} right the vector representing the local \"right\" direction\r\n * @param {vec3} up    the vector representing the local \"up\" direction\r\n * @returns {quat} out\r\n */\n\nexport var setAxes = function () {\n  var matr = mat3.create();\n  return function (out, view, right, up) {\n    matr[0] = right[0];\n    matr[3] = right[1];\n    matr[6] = right[2];\n    matr[1] = up[0];\n    matr[4] = up[1];\n    matr[7] = up[2];\n    matr[2] = -view[0];\n    matr[5] = -view[1];\n    matr[8] = -view[2];\n    return normalize(out, fromMat3(out, matr));\n  };\n}();","import * as glMatrix from \"./common.js\";\nimport * as quat from \"./quat.js\";\nimport * as mat4 from \"./mat4.js\";\n/**\r\n * Dual Quaternion<br>\r\n * Format: [real, dual]<br>\r\n * Quaternion format: XYZW<br>\r\n * Make sure to have normalized dual quaternions, otherwise the functions may not work as intended.<br>\r\n * @module quat2\r\n */\n\n/**\r\n * Creates a new identity dual quat\r\n *\r\n * @returns {quat2} a new dual quaternion [real -> rotation, dual -> translation]\r\n */\n\nexport function create() {\n  var dq = new glMatrix.ARRAY_TYPE(8);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    dq[0] = 0;\n    dq[1] = 0;\n    dq[2] = 0;\n    dq[4] = 0;\n    dq[5] = 0;\n    dq[6] = 0;\n    dq[7] = 0;\n  }\n\n  dq[3] = 1;\n  return dq;\n}\n/**\r\n * Creates a new quat initialized with values from an existing quaternion\r\n *\r\n * @param {quat2} a dual quaternion to clone\r\n * @returns {quat2} new dual quaternion\r\n * @function\r\n */\n\nexport function clone(a) {\n  var dq = new glMatrix.ARRAY_TYPE(8);\n  dq[0] = a[0];\n  dq[1] = a[1];\n  dq[2] = a[2];\n  dq[3] = a[3];\n  dq[4] = a[4];\n  dq[5] = a[5];\n  dq[6] = a[6];\n  dq[7] = a[7];\n  return dq;\n}\n/**\r\n * Creates a new dual quat initialized with the given values\r\n *\r\n * @param {Number} x1 X component\r\n * @param {Number} y1 Y component\r\n * @param {Number} z1 Z component\r\n * @param {Number} w1 W component\r\n * @param {Number} x2 X component\r\n * @param {Number} y2 Y component\r\n * @param {Number} z2 Z component\r\n * @param {Number} w2 W component\r\n * @returns {quat2} new dual quaternion\r\n * @function\r\n */\n\nexport function fromValues(x1, y1, z1, w1, x2, y2, z2, w2) {\n  var dq = new glMatrix.ARRAY_TYPE(8);\n  dq[0] = x1;\n  dq[1] = y1;\n  dq[2] = z1;\n  dq[3] = w1;\n  dq[4] = x2;\n  dq[5] = y2;\n  dq[6] = z2;\n  dq[7] = w2;\n  return dq;\n}\n/**\r\n * Creates a new dual quat from the given values (quat and translation)\r\n *\r\n * @param {Number} x1 X component\r\n * @param {Number} y1 Y component\r\n * @param {Number} z1 Z component\r\n * @param {Number} w1 W component\r\n * @param {Number} x2 X component (translation)\r\n * @param {Number} y2 Y component (translation)\r\n * @param {Number} z2 Z component (translation)\r\n * @returns {quat2} new dual quaternion\r\n * @function\r\n */\n\nexport function fromRotationTranslationValues(x1, y1, z1, w1, x2, y2, z2) {\n  var dq = new glMatrix.ARRAY_TYPE(8);\n  dq[0] = x1;\n  dq[1] = y1;\n  dq[2] = z1;\n  dq[3] = w1;\n  var ax = x2 * 0.5,\n      ay = y2 * 0.5,\n      az = z2 * 0.5;\n  dq[4] = ax * w1 + ay * z1 - az * y1;\n  dq[5] = ay * w1 + az * x1 - ax * z1;\n  dq[6] = az * w1 + ax * y1 - ay * x1;\n  dq[7] = -ax * x1 - ay * y1 - az * z1;\n  return dq;\n}\n/**\r\n * Creates a dual quat from a quaternion and a translation\r\n *\r\n * @param {quat2} dual quaternion receiving operation result\r\n * @param {quat} q quaternion\r\n * @param {vec3} t tranlation vector\r\n * @returns {quat2} dual quaternion receiving operation result\r\n * @function\r\n */\n\nexport function fromRotationTranslation(out, q, t) {\n  var ax = t[0] * 0.5,\n      ay = t[1] * 0.5,\n      az = t[2] * 0.5,\n      bx = q[0],\n      by = q[1],\n      bz = q[2],\n      bw = q[3];\n  out[0] = bx;\n  out[1] = by;\n  out[2] = bz;\n  out[3] = bw;\n  out[4] = ax * bw + ay * bz - az * by;\n  out[5] = ay * bw + az * bx - ax * bz;\n  out[6] = az * bw + ax * by - ay * bx;\n  out[7] = -ax * bx - ay * by - az * bz;\n  return out;\n}\n/**\r\n * Creates a dual quat from a translation\r\n *\r\n * @param {quat2} dual quaternion receiving operation result\r\n * @param {vec3} t translation vector\r\n * @returns {quat2} dual quaternion receiving operation result\r\n * @function\r\n */\n\nexport function fromTranslation(out, t) {\n  out[0] = 0;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  out[4] = t[0] * 0.5;\n  out[5] = t[1] * 0.5;\n  out[6] = t[2] * 0.5;\n  out[7] = 0;\n  return out;\n}\n/**\r\n * Creates a dual quat from a quaternion\r\n *\r\n * @param {quat2} dual quaternion receiving operation result\r\n * @param {quat} q the quaternion\r\n * @returns {quat2} dual quaternion receiving operation result\r\n * @function\r\n */\n\nexport function fromRotation(out, q) {\n  out[0] = q[0];\n  out[1] = q[1];\n  out[2] = q[2];\n  out[3] = q[3];\n  out[4] = 0;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  return out;\n}\n/**\r\n * Creates a new dual quat from a matrix (4x4)\r\n *\r\n * @param {quat2} out the dual quaternion\r\n * @param {mat4} a the matrix\r\n * @returns {quat2} dual quat receiving operation result\r\n * @function\r\n */\n\nexport function fromMat4(out, a) {\n  //TODO Optimize this\n  var outer = quat.create();\n  mat4.getRotation(outer, a);\n  var t = new glMatrix.ARRAY_TYPE(3);\n  mat4.getTranslation(t, a);\n  fromRotationTranslation(out, outer, t);\n  return out;\n}\n/**\r\n * Copy the values from one dual quat to another\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {quat2} a the source dual quaternion\r\n * @returns {quat2} out\r\n * @function\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  return out;\n}\n/**\r\n * Set a dual quat to the identity dual quaternion\r\n *\r\n * @param {quat2} out the receiving quaternion\r\n * @returns {quat2} out\r\n */\n\nexport function identity(out) {\n  out[0] = 0;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  out[4] = 0;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  return out;\n}\n/**\r\n * Set the components of a dual quat to the given values\r\n *\r\n * @param {quat2} out the receiving quaternion\r\n * @param {Number} x1 X component\r\n * @param {Number} y1 Y component\r\n * @param {Number} z1 Z component\r\n * @param {Number} w1 W component\r\n * @param {Number} x2 X component\r\n * @param {Number} y2 Y component\r\n * @param {Number} z2 Z component\r\n * @param {Number} w2 W component\r\n * @returns {quat2} out\r\n * @function\r\n */\n\nexport function set(out, x1, y1, z1, w1, x2, y2, z2, w2) {\n  out[0] = x1;\n  out[1] = y1;\n  out[2] = z1;\n  out[3] = w1;\n  out[4] = x2;\n  out[5] = y2;\n  out[6] = z2;\n  out[7] = w2;\n  return out;\n}\n/**\r\n * Gets the real part of a dual quat\r\n * @param  {quat} out real part\r\n * @param  {quat2} a Dual Quaternion\r\n * @return {quat} real part\r\n */\n\nexport var getReal = quat.copy;\n/**\r\n * Gets the dual part of a dual quat\r\n * @param  {quat} out dual part\r\n * @param  {quat2} a Dual Quaternion\r\n * @return {quat} dual part\r\n */\n\nexport function getDual(out, a) {\n  out[0] = a[4];\n  out[1] = a[5];\n  out[2] = a[6];\n  out[3] = a[7];\n  return out;\n}\n/**\r\n * Set the real component of a dual quat to the given quaternion\r\n *\r\n * @param {quat2} out the receiving quaternion\r\n * @param {quat} q a quaternion representing the real part\r\n * @returns {quat2} out\r\n * @function\r\n */\n\nexport var setReal = quat.copy;\n/**\r\n * Set the dual component of a dual quat to the given quaternion\r\n *\r\n * @param {quat2} out the receiving quaternion\r\n * @param {quat} q a quaternion representing the dual part\r\n * @returns {quat2} out\r\n * @function\r\n */\n\nexport function setDual(out, q) {\n  out[4] = q[0];\n  out[5] = q[1];\n  out[6] = q[2];\n  out[7] = q[3];\n  return out;\n}\n/**\r\n * Gets the translation of a normalized dual quat\r\n * @param  {vec3} out translation\r\n * @param  {quat2} a Dual Quaternion to be decomposed\r\n * @return {vec3} translation\r\n */\n\nexport function getTranslation(out, a) {\n  var ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7],\n      bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3];\n  out[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n  out[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n  out[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n  return out;\n}\n/**\r\n * Translates a dual quat by the given vector\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {quat2} a the dual quaternion to translate\r\n * @param {vec3} v vector to translate by\r\n * @returns {quat2} out\r\n */\n\nexport function translate(out, a, v) {\n  var ax1 = a[0],\n      ay1 = a[1],\n      az1 = a[2],\n      aw1 = a[3],\n      bx1 = v[0] * 0.5,\n      by1 = v[1] * 0.5,\n      bz1 = v[2] * 0.5,\n      ax2 = a[4],\n      ay2 = a[5],\n      az2 = a[6],\n      aw2 = a[7];\n  out[0] = ax1;\n  out[1] = ay1;\n  out[2] = az1;\n  out[3] = aw1;\n  out[4] = aw1 * bx1 + ay1 * bz1 - az1 * by1 + ax2;\n  out[5] = aw1 * by1 + az1 * bx1 - ax1 * bz1 + ay2;\n  out[6] = aw1 * bz1 + ax1 * by1 - ay1 * bx1 + az2;\n  out[7] = -ax1 * bx1 - ay1 * by1 - az1 * bz1 + aw2;\n  return out;\n}\n/**\r\n * Rotates a dual quat around the X axis\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {quat2} a the dual quaternion to rotate\r\n * @param {number} rad how far should the rotation be\r\n * @returns {quat2} out\r\n */\n\nexport function rotateX(out, a, rad) {\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7],\n      ax1 = ax * bw + aw * bx + ay * bz - az * by,\n      ay1 = ay * bw + aw * by + az * bx - ax * bz,\n      az1 = az * bw + aw * bz + ax * by - ay * bx,\n      aw1 = aw * bw - ax * bx - ay * by - az * bz;\n  quat.rotateX(out, a, rad);\n  bx = out[0];\n  by = out[1];\n  bz = out[2];\n  bw = out[3];\n  out[4] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\n  out[5] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\n  out[6] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\n  out[7] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\n  return out;\n}\n/**\r\n * Rotates a dual quat around the Y axis\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {quat2} a the dual quaternion to rotate\r\n * @param {number} rad how far should the rotation be\r\n * @returns {quat2} out\r\n */\n\nexport function rotateY(out, a, rad) {\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7],\n      ax1 = ax * bw + aw * bx + ay * bz - az * by,\n      ay1 = ay * bw + aw * by + az * bx - ax * bz,\n      az1 = az * bw + aw * bz + ax * by - ay * bx,\n      aw1 = aw * bw - ax * bx - ay * by - az * bz;\n  quat.rotateY(out, a, rad);\n  bx = out[0];\n  by = out[1];\n  bz = out[2];\n  bw = out[3];\n  out[4] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\n  out[5] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\n  out[6] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\n  out[7] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\n  return out;\n}\n/**\r\n * Rotates a dual quat around the Z axis\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {quat2} a the dual quaternion to rotate\r\n * @param {number} rad how far should the rotation be\r\n * @returns {quat2} out\r\n */\n\nexport function rotateZ(out, a, rad) {\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7],\n      ax1 = ax * bw + aw * bx + ay * bz - az * by,\n      ay1 = ay * bw + aw * by + az * bx - ax * bz,\n      az1 = az * bw + aw * bz + ax * by - ay * bx,\n      aw1 = aw * bw - ax * bx - ay * by - az * bz;\n  quat.rotateZ(out, a, rad);\n  bx = out[0];\n  by = out[1];\n  bz = out[2];\n  bw = out[3];\n  out[4] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\n  out[5] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\n  out[6] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\n  out[7] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\n  return out;\n}\n/**\r\n * Rotates a dual quat by a given quaternion (a * q)\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {quat2} a the dual quaternion to rotate\r\n * @param {quat} q quaternion to rotate by\r\n * @returns {quat2} out\r\n */\n\nexport function rotateByQuatAppend(out, a, q) {\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3],\n      ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  out[0] = ax * qw + aw * qx + ay * qz - az * qy;\n  out[1] = ay * qw + aw * qy + az * qx - ax * qz;\n  out[2] = az * qw + aw * qz + ax * qy - ay * qx;\n  out[3] = aw * qw - ax * qx - ay * qy - az * qz;\n  ax = a[4];\n  ay = a[5];\n  az = a[6];\n  aw = a[7];\n  out[4] = ax * qw + aw * qx + ay * qz - az * qy;\n  out[5] = ay * qw + aw * qy + az * qx - ax * qz;\n  out[6] = az * qw + aw * qz + ax * qy - ay * qx;\n  out[7] = aw * qw - ax * qx - ay * qy - az * qz;\n  return out;\n}\n/**\r\n * Rotates a dual quat by a given quaternion (q * a)\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {quat} q quaternion to rotate by\r\n * @param {quat2} a the dual quaternion to rotate\r\n * @returns {quat2} out\r\n */\n\nexport function rotateByQuatPrepend(out, q, a) {\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3],\n      bx = a[0],\n      by = a[1],\n      bz = a[2],\n      bw = a[3];\n  out[0] = qx * bw + qw * bx + qy * bz - qz * by;\n  out[1] = qy * bw + qw * by + qz * bx - qx * bz;\n  out[2] = qz * bw + qw * bz + qx * by - qy * bx;\n  out[3] = qw * bw - qx * bx - qy * by - qz * bz;\n  bx = a[4];\n  by = a[5];\n  bz = a[6];\n  bw = a[7];\n  out[4] = qx * bw + qw * bx + qy * bz - qz * by;\n  out[5] = qy * bw + qw * by + qz * bx - qx * bz;\n  out[6] = qz * bw + qw * bz + qx * by - qy * bx;\n  out[7] = qw * bw - qx * bx - qy * by - qz * bz;\n  return out;\n}\n/**\r\n * Rotates a dual quat around a given axis. Does the normalisation automatically\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {quat2} a the dual quaternion to rotate\r\n * @param {vec3} axis the axis to rotate around\r\n * @param {Number} rad how far the rotation should be\r\n * @returns {quat2} out\r\n */\n\nexport function rotateAroundAxis(out, a, axis, rad) {\n  //Special case for rad = 0\n  if (Math.abs(rad) < glMatrix.EPSILON) {\n    return copy(out, a);\n  }\n\n  var axisLength = Math.sqrt(axis[0] * axis[0] + axis[1] * axis[1] + axis[2] * axis[2]);\n  rad = rad * 0.5;\n  var s = Math.sin(rad);\n  var bx = s * axis[0] / axisLength;\n  var by = s * axis[1] / axisLength;\n  var bz = s * axis[2] / axisLength;\n  var bw = Math.cos(rad);\n  var ax1 = a[0],\n      ay1 = a[1],\n      az1 = a[2],\n      aw1 = a[3];\n  out[0] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\n  out[1] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\n  out[2] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\n  out[3] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\n  var ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7];\n  out[4] = ax * bw + aw * bx + ay * bz - az * by;\n  out[5] = ay * bw + aw * by + az * bx - ax * bz;\n  out[6] = az * bw + aw * bz + ax * by - ay * bx;\n  out[7] = aw * bw - ax * bx - ay * by - az * bz;\n  return out;\n}\n/**\r\n * Adds two dual quat's\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {quat2} a the first operand\r\n * @param {quat2} b the second operand\r\n * @returns {quat2} out\r\n * @function\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  return out;\n}\n/**\r\n * Multiplies two dual quat's\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {quat2} a the first operand\r\n * @param {quat2} b the second operand\r\n * @returns {quat2} out\r\n */\n\nexport function multiply(out, a, b) {\n  var ax0 = a[0],\n      ay0 = a[1],\n      az0 = a[2],\n      aw0 = a[3],\n      bx1 = b[4],\n      by1 = b[5],\n      bz1 = b[6],\n      bw1 = b[7],\n      ax1 = a[4],\n      ay1 = a[5],\n      az1 = a[6],\n      aw1 = a[7],\n      bx0 = b[0],\n      by0 = b[1],\n      bz0 = b[2],\n      bw0 = b[3];\n  out[0] = ax0 * bw0 + aw0 * bx0 + ay0 * bz0 - az0 * by0;\n  out[1] = ay0 * bw0 + aw0 * by0 + az0 * bx0 - ax0 * bz0;\n  out[2] = az0 * bw0 + aw0 * bz0 + ax0 * by0 - ay0 * bx0;\n  out[3] = aw0 * bw0 - ax0 * bx0 - ay0 * by0 - az0 * bz0;\n  out[4] = ax0 * bw1 + aw0 * bx1 + ay0 * bz1 - az0 * by1 + ax1 * bw0 + aw1 * bx0 + ay1 * bz0 - az1 * by0;\n  out[5] = ay0 * bw1 + aw0 * by1 + az0 * bx1 - ax0 * bz1 + ay1 * bw0 + aw1 * by0 + az1 * bx0 - ax1 * bz0;\n  out[6] = az0 * bw1 + aw0 * bz1 + ax0 * by1 - ay0 * bx1 + az1 * bw0 + aw1 * bz0 + ax1 * by0 - ay1 * bx0;\n  out[7] = aw0 * bw1 - ax0 * bx1 - ay0 * by1 - az0 * bz1 + aw1 * bw0 - ax1 * bx0 - ay1 * by0 - az1 * bz0;\n  return out;\n}\n/**\r\n * Alias for {@link quat2.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Scales a dual quat by a scalar number\r\n *\r\n * @param {quat2} out the receiving dual quat\r\n * @param {quat2} a the dual quat to scale\r\n * @param {Number} b amount to scale the dual quat by\r\n * @returns {quat2} out\r\n * @function\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  return out;\n}\n/**\r\n * Calculates the dot product of two dual quat's (The dot product of the real parts)\r\n *\r\n * @param {quat2} a the first operand\r\n * @param {quat2} b the second operand\r\n * @returns {Number} dot product of a and b\r\n * @function\r\n */\n\nexport var dot = quat.dot;\n/**\r\n * Performs a linear interpolation between two dual quats's\r\n * NOTE: The resulting dual quaternions won't always be normalized (The error is most noticeable when t = 0.5)\r\n *\r\n * @param {quat2} out the receiving dual quat\r\n * @param {quat2} a the first operand\r\n * @param {quat2} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat2} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var mt = 1 - t;\n  if (dot(a, b) < 0) t = -t;\n  out[0] = a[0] * mt + b[0] * t;\n  out[1] = a[1] * mt + b[1] * t;\n  out[2] = a[2] * mt + b[2] * t;\n  out[3] = a[3] * mt + b[3] * t;\n  out[4] = a[4] * mt + b[4] * t;\n  out[5] = a[5] * mt + b[5] * t;\n  out[6] = a[6] * mt + b[6] * t;\n  out[7] = a[7] * mt + b[7] * t;\n  return out;\n}\n/**\r\n * Calculates the inverse of a dual quat. If they are normalized, conjugate is cheaper\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {quat2} a dual quat to calculate inverse of\r\n * @returns {quat2} out\r\n */\n\nexport function invert(out, a) {\n  var sqlen = squaredLength(a);\n  out[0] = -a[0] / sqlen;\n  out[1] = -a[1] / sqlen;\n  out[2] = -a[2] / sqlen;\n  out[3] = a[3] / sqlen;\n  out[4] = -a[4] / sqlen;\n  out[5] = -a[5] / sqlen;\n  out[6] = -a[6] / sqlen;\n  out[7] = a[7] / sqlen;\n  return out;\n}\n/**\r\n * Calculates the conjugate of a dual quat\r\n * If the dual quaternion is normalized, this function is faster than quat2.inverse and produces the same result.\r\n *\r\n * @param {quat2} out the receiving quaternion\r\n * @param {quat2} a quat to calculate conjugate of\r\n * @returns {quat2} out\r\n */\n\nexport function conjugate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = a[3];\n  out[4] = -a[4];\n  out[5] = -a[5];\n  out[6] = -a[6];\n  out[7] = a[7];\n  return out;\n}\n/**\r\n * Calculates the length of a dual quat\r\n *\r\n * @param {quat2} a dual quat to calculate length of\r\n * @returns {Number} length of a\r\n * @function\r\n */\n\nexport var length = quat.length;\n/**\r\n * Alias for {@link quat2.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Calculates the squared length of a dual quat\r\n *\r\n * @param {quat2} a dual quat to calculate squared length of\r\n * @returns {Number} squared length of a\r\n * @function\r\n */\n\nexport var squaredLength = quat.squaredLength;\n/**\r\n * Alias for {@link quat2.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Normalize a dual quat\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {quat2} a dual quaternion to normalize\r\n * @returns {quat2} out\r\n * @function\r\n */\n\nexport function normalize(out, a) {\n  var magnitude = squaredLength(a);\n\n  if (magnitude > 0) {\n    magnitude = Math.sqrt(magnitude);\n    var a0 = a[0] / magnitude;\n    var a1 = a[1] / magnitude;\n    var a2 = a[2] / magnitude;\n    var a3 = a[3] / magnitude;\n    var b0 = a[4];\n    var b1 = a[5];\n    var b2 = a[6];\n    var b3 = a[7];\n    var a_dot_b = a0 * b0 + a1 * b1 + a2 * b2 + a3 * b3;\n    out[0] = a0;\n    out[1] = a1;\n    out[2] = a2;\n    out[3] = a3;\n    out[4] = (b0 - a0 * a_dot_b) / magnitude;\n    out[5] = (b1 - a1 * a_dot_b) / magnitude;\n    out[6] = (b2 - a2 * a_dot_b) / magnitude;\n    out[7] = (b3 - a3 * a_dot_b) / magnitude;\n  }\n\n  return out;\n}\n/**\r\n * Returns a string representation of a dual quatenion\r\n *\r\n * @param {quat2} a dual quaternion to represent as a string\r\n * @returns {String} string representation of the dual quat\r\n */\n\nexport function str(a) {\n  return 'quat2(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ', ' + a[4] + ', ' + a[5] + ', ' + a[6] + ', ' + a[7] + ')';\n}\n/**\r\n * Returns whether or not the dual quaternions have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {quat2} a the first dual quaternion.\r\n * @param {quat2} b the second dual quaternion.\r\n * @returns {Boolean} true if the dual quaternions are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7];\n}\n/**\r\n * Returns whether or not the dual quaternions have approximately the same elements in the same position.\r\n *\r\n * @param {quat2} a the first dual quat.\r\n * @param {quat2} b the second dual quat.\r\n * @returns {Boolean} true if the dual quats are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3],\n      b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7));\n}","import * as glMatrix from \"./common.js\";\n/**\r\n * 2 Dimensional Vector\r\n * @module vec2\r\n */\n\n/**\r\n * Creates a new, empty vec2\r\n *\r\n * @returns {vec2} a new 2D vector\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(2);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n  }\n\n  return out;\n}\n/**\r\n * Creates a new vec2 initialized with values from an existing vector\r\n *\r\n * @param {vec2} a vector to clone\r\n * @returns {vec2} a new 2D vector\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n/**\r\n * Creates a new vec2 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @returns {vec2} a new 2D vector\r\n */\n\nexport function fromValues(x, y) {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n/**\r\n * Copy the values from one vec2 to another\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the source vector\r\n * @returns {vec2} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n/**\r\n * Set the components of a vec2 to the given values\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @returns {vec2} out\r\n */\n\nexport function set(out, x, y) {\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n/**\r\n * Adds two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  return out;\n}\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  return out;\n}\n/**\r\n * Multiplies two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  return out;\n}\n/**\r\n * Divides two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  return out;\n}\n/**\r\n * Math.ceil the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a vector to ceil\r\n * @returns {vec2} out\r\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  return out;\n}\n/**\r\n * Math.floor the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a vector to floor\r\n * @returns {vec2} out\r\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  return out;\n}\n/**\r\n * Returns the minimum of two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  return out;\n}\n/**\r\n * Returns the maximum of two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  return out;\n}\n/**\r\n * Math.round the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a vector to round\r\n * @returns {vec2} out\r\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  return out;\n}\n/**\r\n * Scales a vec2 by a scalar number\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec2} out\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  return out;\n}\n/**\r\n * Adds two vec2's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec2} out\r\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  return out;\n}\n/**\r\n * Calculates the euclidian distance between two vec2's\r\n *\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0],\n      y = b[1] - a[1];\n  return Math.sqrt(x * x + y * y);\n}\n/**\r\n * Calculates the squared euclidian distance between two vec2's\r\n *\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0],\n      y = b[1] - a[1];\n  return x * x + y * y;\n}\n/**\r\n * Calculates the length of a vec2\r\n *\r\n * @param {vec2} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport function length(a) {\n  var x = a[0],\n      y = a[1];\n  return Math.sqrt(x * x + y * y);\n}\n/**\r\n * Calculates the squared length of a vec2\r\n *\r\n * @param {vec2} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\n\nexport function squaredLength(a) {\n  var x = a[0],\n      y = a[1];\n  return x * x + y * y;\n}\n/**\r\n * Negates the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a vector to negate\r\n * @returns {vec2} out\r\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  return out;\n}\n/**\r\n * Returns the inverse of the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a vector to invert\r\n * @returns {vec2} out\r\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  return out;\n}\n/**\r\n * Normalize a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a vector to normalize\r\n * @returns {vec2} out\r\n */\n\nexport function normalize(out, a) {\n  var x = a[0],\n      y = a[1];\n  var len = x * x + y * y;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  return out;\n}\n/**\r\n * Calculates the dot product of two vec2's\r\n *\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1];\n}\n/**\r\n * Computes the cross product of two vec2's\r\n * Note that the cross product must by definition produce a 3D vector\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function cross(out, a, b) {\n  var z = a[0] * b[1] - a[1] * b[0];\n  out[0] = out[1] = 0;\n  out[2] = z;\n  return out;\n}\n/**\r\n * Performs a linear interpolation between two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec2} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0],\n      ay = a[1];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  return out;\n}\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec2} out\r\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  out[0] = Math.cos(r) * scale;\n  out[1] = Math.sin(r) * scale;\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the vector to transform\r\n * @param {mat2} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat2(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[2] * y;\n  out[1] = m[1] * x + m[3] * y;\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat2d\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the vector to transform\r\n * @param {mat2d} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat2d(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[2] * y + m[4];\n  out[1] = m[1] * x + m[3] * y + m[5];\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat3\r\n * 3rd vector component is implicitly '1'\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the vector to transform\r\n * @param {mat3} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[3] * y + m[6];\n  out[1] = m[1] * x + m[4] * y + m[7];\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat4\r\n * 3rd vector component is implicitly '0'\r\n * 4th vector component is implicitly '1'\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the vector to transform\r\n * @param {mat4} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0];\n  var y = a[1];\n  out[0] = m[0] * x + m[4] * y + m[12];\n  out[1] = m[1] * x + m[5] * y + m[13];\n  return out;\n}\n/**\r\n * Rotate a 2D vector\r\n * @param {vec2} out The receiving vec2\r\n * @param {vec2} a The vec2 point to rotate\r\n * @param {vec2} b The origin of the rotation\r\n * @param {Number} c The angle of rotation\r\n * @returns {vec2} out\r\n */\n\nexport function rotate(out, a, b, c) {\n  //Translate point to the origin\n  var p0 = a[0] - b[0],\n      p1 = a[1] - b[1],\n      sinC = Math.sin(c),\n      cosC = Math.cos(c); //perform rotation and translate to correct position\n\n  out[0] = p0 * cosC - p1 * sinC + b[0];\n  out[1] = p0 * sinC + p1 * cosC + b[1];\n  return out;\n}\n/**\r\n * Get the angle between two 2D vectors\r\n * @param {vec2} a The first operand\r\n * @param {vec2} b The second operand\r\n * @returns {Number} The angle in radians\r\n */\n\nexport function angle(a, b) {\n  var x1 = a[0],\n      y1 = a[1],\n      x2 = b[0],\n      y2 = b[1];\n  var len1 = x1 * x1 + y1 * y1;\n\n  if (len1 > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len1 = 1 / Math.sqrt(len1);\n  }\n\n  var len2 = x2 * x2 + y2 * y2;\n\n  if (len2 > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len2 = 1 / Math.sqrt(len2);\n  }\n\n  var cosine = (x1 * x2 + y1 * y2) * len1 * len2;\n\n  if (cosine > 1.0) {\n    return 0;\n  } else if (cosine < -1.0) {\n    return Math.PI;\n  } else {\n    return Math.acos(cosine);\n  }\n}\n/**\r\n * Set the components of a vec2 to zero\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @returns {vec2} out\r\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  return out;\n}\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {vec2} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return 'vec2(' + a[0] + ', ' + a[1] + ')';\n}\n/**\r\n * Returns whether or not the vectors exactly have the same elements in the same position (when compared with ===)\r\n *\r\n * @param {vec2} a The first vector.\r\n * @param {vec2} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1];\n}\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {vec2} a The first vector.\r\n * @param {vec2} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1];\n  var b0 = b[0],\n      b1 = b[1];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1));\n}\n/**\r\n * Alias for {@link vec2.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Alias for {@link vec2.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;\n/**\r\n * Alias for {@link vec2.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link vec2.divide}\r\n * @function\r\n */\n\nexport var div = divide;\n/**\r\n * Alias for {@link vec2.distance}\r\n * @function\r\n */\n\nexport var dist = distance;\n/**\r\n * Alias for {@link vec2.squaredDistance}\r\n * @function\r\n */\n\nexport var sqrDist = squaredDistance;\n/**\r\n * Alias for {@link vec2.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Perform some operation over an array of vec2s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec2. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec2s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 2;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n    }\n\n    return a;\n  };\n}();","import * as glMatrix from \"./common.js\";\n/**\r\n * 3 Dimensional Vector\r\n * @module vec3\r\n */\n\n/**\r\n * Creates a new, empty vec3\r\n *\r\n * @returns {vec3} a new 3D vector\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(3);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  return out;\n}\n/**\r\n * Creates a new vec3 initialized with values from an existing vector\r\n *\r\n * @param {vec3} a vector to clone\r\n * @returns {vec3} a new 3D vector\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\r\n * Calculates the length of a vec3\r\n *\r\n * @param {vec3} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return Math.sqrt(x * x + y * y + z * z);\n}\n/**\r\n * Creates a new vec3 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @returns {vec3} a new 3D vector\r\n */\n\nexport function fromValues(x, y, z) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\r\n * Copy the values from one vec3 to another\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the source vector\r\n * @returns {vec3} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\r\n * Set the components of a vec3 to the given values\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @returns {vec3} out\r\n */\n\nexport function set(out, x, y, z) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\r\n * Adds two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  return out;\n}\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  return out;\n}\n/**\r\n * Multiplies two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  return out;\n}\n/**\r\n * Divides two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  return out;\n}\n/**\r\n * Math.ceil the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a vector to ceil\r\n * @returns {vec3} out\r\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  return out;\n}\n/**\r\n * Math.floor the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a vector to floor\r\n * @returns {vec3} out\r\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  return out;\n}\n/**\r\n * Returns the minimum of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  return out;\n}\n/**\r\n * Returns the maximum of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  return out;\n}\n/**\r\n * Math.round the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a vector to round\r\n * @returns {vec3} out\r\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  return out;\n}\n/**\r\n * Scales a vec3 by a scalar number\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec3} out\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  return out;\n}\n/**\r\n * Adds two vec3's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec3} out\r\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  return out;\n}\n/**\r\n * Calculates the euclidian distance between two vec3's\r\n *\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return Math.sqrt(x * x + y * y + z * z);\n}\n/**\r\n * Calculates the squared euclidian distance between two vec3's\r\n *\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return x * x + y * y + z * z;\n}\n/**\r\n * Calculates the squared length of a vec3\r\n *\r\n * @param {vec3} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return x * x + y * y + z * z;\n}\n/**\r\n * Negates the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a vector to negate\r\n * @returns {vec3} out\r\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  return out;\n}\n/**\r\n * Returns the inverse of the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a vector to invert\r\n * @returns {vec3} out\r\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  return out;\n}\n/**\r\n * Normalize a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a vector to normalize\r\n * @returns {vec3} out\r\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var len = x * x + y * y + z * z;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  out[2] = a[2] * len;\n  return out;\n}\n/**\r\n * Calculates the dot product of two vec3's\r\n *\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n/**\r\n * Computes the cross product of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function cross(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2];\n  out[0] = ay * bz - az * by;\n  out[1] = az * bx - ax * bz;\n  out[2] = ax * by - ay * bx;\n  return out;\n}\n/**\r\n * Performs a linear interpolation between two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  return out;\n}\n/**\r\n * Performs a hermite interpolation with two control points\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @param {vec3} c the third operand\r\n * @param {vec3} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\n\nexport function hermite(out, a, b, c, d, t) {\n  var factorTimes2 = t * t;\n  var factor1 = factorTimes2 * (2 * t - 3) + 1;\n  var factor2 = factorTimes2 * (t - 2) + t;\n  var factor3 = factorTimes2 * (t - 1);\n  var factor4 = factorTimes2 * (3 - 2 * t);\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\r\n * Performs a bezier interpolation with two control points\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @param {vec3} c the third operand\r\n * @param {vec3} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\n\nexport function bezier(out, a, b, c, d, t) {\n  var inverseFactor = 1 - t;\n  var inverseFactorTimesTwo = inverseFactor * inverseFactor;\n  var factorTimes2 = t * t;\n  var factor1 = inverseFactorTimesTwo * inverseFactor;\n  var factor2 = 3 * t * inverseFactorTimesTwo;\n  var factor3 = 3 * factorTimes2 * inverseFactor;\n  var factor4 = factorTimes2 * t;\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec3} out\r\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  var z = glMatrix.RANDOM() * 2.0 - 1.0;\n  var zScale = Math.sqrt(1.0 - z * z) * scale;\n  out[0] = Math.cos(r) * zScale;\n  out[1] = Math.sin(r) * zScale;\n  out[2] = z * scale;\n  return out;\n}\n/**\r\n * Transforms the vec3 with a mat4.\r\n * 4th vector component is implicitly '1'\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the vector to transform\r\n * @param {mat4} m matrix to transform with\r\n * @returns {vec3} out\r\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var w = m[3] * x + m[7] * y + m[11] * z + m[15];\n  w = w || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n  return out;\n}\n/**\r\n * Transforms the vec3 with a mat3.\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the vector to transform\r\n * @param {mat3} m the 3x3 matrix to transform with\r\n * @returns {vec3} out\r\n */\n\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  out[0] = x * m[0] + y * m[3] + z * m[6];\n  out[1] = x * m[1] + y * m[4] + z * m[7];\n  out[2] = x * m[2] + y * m[5] + z * m[8];\n  return out;\n}\n/**\r\n * Transforms the vec3 with a quat\r\n * Can also be used for dual quaternions. (Multiply it with the real part)\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the vector to transform\r\n * @param {quat} q quaternion to transform with\r\n * @returns {vec3} out\r\n */\n\nexport function transformQuat(out, a, q) {\n  // benchmarks: https://jsperf.com/quaternion-transform-vec3-implementations-fixed\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3];\n  var x = a[0],\n      y = a[1],\n      z = a[2]; // var qvec = [qx, qy, qz];\n  // var uv = vec3.cross([], qvec, a);\n\n  var uvx = qy * z - qz * y,\n      uvy = qz * x - qx * z,\n      uvz = qx * y - qy * x; // var uuv = vec3.cross([], qvec, uv);\n\n  var uuvx = qy * uvz - qz * uvy,\n      uuvy = qz * uvx - qx * uvz,\n      uuvz = qx * uvy - qy * uvx; // vec3.scale(uv, uv, 2 * w);\n\n  var w2 = qw * 2;\n  uvx *= w2;\n  uvy *= w2;\n  uvz *= w2; // vec3.scale(uuv, uuv, 2);\n\n  uuvx *= 2;\n  uuvy *= 2;\n  uuvz *= 2; // return vec3.add(out, a, vec3.add(out, uv, uuv));\n\n  out[0] = x + uvx + uuvx;\n  out[1] = y + uvy + uuvy;\n  out[2] = z + uvz + uuvz;\n  return out;\n}\n/**\r\n * Rotate a 3D vector around the x-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {vec3} a The vec3 point to rotate\r\n * @param {vec3} b The origin of the rotation\r\n * @param {Number} c The angle of rotation\r\n * @returns {vec3} out\r\n */\n\nexport function rotateX(out, a, b, c) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0];\n  r[1] = p[1] * Math.cos(c) - p[2] * Math.sin(c);\n  r[2] = p[1] * Math.sin(c) + p[2] * Math.cos(c); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\r\n * Rotate a 3D vector around the y-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {vec3} a The vec3 point to rotate\r\n * @param {vec3} b The origin of the rotation\r\n * @param {Number} c The angle of rotation\r\n * @returns {vec3} out\r\n */\n\nexport function rotateY(out, a, b, c) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[2] * Math.sin(c) + p[0] * Math.cos(c);\n  r[1] = p[1];\n  r[2] = p[2] * Math.cos(c) - p[0] * Math.sin(c); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\r\n * Rotate a 3D vector around the z-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {vec3} a The vec3 point to rotate\r\n * @param {vec3} b The origin of the rotation\r\n * @param {Number} c The angle of rotation\r\n * @returns {vec3} out\r\n */\n\nexport function rotateZ(out, a, b, c) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0] * Math.cos(c) - p[1] * Math.sin(c);\n  r[1] = p[0] * Math.sin(c) + p[1] * Math.cos(c);\n  r[2] = p[2]; //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\r\n * Get the angle between two 3D vectors\r\n * @param {vec3} a The first operand\r\n * @param {vec3} b The second operand\r\n * @returns {Number} The angle in radians\r\n */\n\nexport function angle(a, b) {\n  var tempA = fromValues(a[0], a[1], a[2]);\n  var tempB = fromValues(b[0], b[1], b[2]);\n  normalize(tempA, tempA);\n  normalize(tempB, tempB);\n  var cosine = dot(tempA, tempB);\n\n  if (cosine > 1.0) {\n    return 0;\n  } else if (cosine < -1.0) {\n    return Math.PI;\n  } else {\n    return Math.acos(cosine);\n  }\n}\n/**\r\n * Set the components of a vec3 to zero\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @returns {vec3} out\r\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  return out;\n}\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {vec3} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return 'vec3(' + a[0] + ', ' + a[1] + ', ' + a[2] + ')';\n}\n/**\r\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {vec3} a The first vector.\r\n * @param {vec3} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\n}\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {vec3} a The first vector.\r\n * @param {vec3} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2));\n}\n/**\r\n * Alias for {@link vec3.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;\n/**\r\n * Alias for {@link vec3.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link vec3.divide}\r\n * @function\r\n */\n\nexport var div = divide;\n/**\r\n * Alias for {@link vec3.distance}\r\n * @function\r\n */\n\nexport var dist = distance;\n/**\r\n * Alias for {@link vec3.squaredDistance}\r\n * @function\r\n */\n\nexport var sqrDist = squaredDistance;\n/**\r\n * Alias for {@link vec3.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Alias for {@link vec3.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Perform some operation over an array of vec3s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 3;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n    }\n\n    return a;\n  };\n}();","import * as glMatrix from \"./common.js\";\n/**\r\n * 4 Dimensional Vector\r\n * @module vec4\r\n */\n\n/**\r\n * Creates a new, empty vec4\r\n *\r\n * @returns {vec4} a new 4D vector\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n  }\n\n  return out;\n}\n/**\r\n * Creates a new vec4 initialized with values from an existing vector\r\n *\r\n * @param {vec4} a vector to clone\r\n * @returns {vec4} a new 4D vector\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Creates a new vec4 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {vec4} a new 4D vector\r\n */\n\nexport function fromValues(x, y, z, w) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\n/**\r\n * Copy the values from one vec4 to another\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the source vector\r\n * @returns {vec4} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Set the components of a vec4 to the given values\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {vec4} out\r\n */\n\nexport function set(out, x, y, z, w) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\n/**\r\n * Adds two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  return out;\n}\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  return out;\n}\n/**\r\n * Multiplies two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  out[3] = a[3] * b[3];\n  return out;\n}\n/**\r\n * Divides two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  out[3] = a[3] / b[3];\n  return out;\n}\n/**\r\n * Math.ceil the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a vector to ceil\r\n * @returns {vec4} out\r\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  out[3] = Math.ceil(a[3]);\n  return out;\n}\n/**\r\n * Math.floor the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a vector to floor\r\n * @returns {vec4} out\r\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  out[3] = Math.floor(a[3]);\n  return out;\n}\n/**\r\n * Returns the minimum of two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  out[3] = Math.min(a[3], b[3]);\n  return out;\n}\n/**\r\n * Returns the maximum of two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  out[3] = Math.max(a[3], b[3]);\n  return out;\n}\n/**\r\n * Math.round the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a vector to round\r\n * @returns {vec4} out\r\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  out[3] = Math.round(a[3]);\n  return out;\n}\n/**\r\n * Scales a vec4 by a scalar number\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec4} out\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  return out;\n}\n/**\r\n * Adds two vec4's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec4} out\r\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  return out;\n}\n/**\r\n * Calculates the euclidian distance between two vec4's\r\n *\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  var w = b[3] - a[3];\n  return Math.sqrt(x * x + y * y + z * z + w * w);\n}\n/**\r\n * Calculates the squared euclidian distance between two vec4's\r\n *\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  var w = b[3] - a[3];\n  return x * x + y * y + z * z + w * w;\n}\n/**\r\n * Calculates the length of a vec4\r\n *\r\n * @param {vec4} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  return Math.sqrt(x * x + y * y + z * z + w * w);\n}\n/**\r\n * Calculates the squared length of a vec4\r\n *\r\n * @param {vec4} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  return x * x + y * y + z * z + w * w;\n}\n/**\r\n * Negates the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a vector to negate\r\n * @returns {vec4} out\r\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = -a[3];\n  return out;\n}\n/**\r\n * Returns the inverse of the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a vector to invert\r\n * @returns {vec4} out\r\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  out[3] = 1.0 / a[3];\n  return out;\n}\n/**\r\n * Normalize a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a vector to normalize\r\n * @returns {vec4} out\r\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  var len = x * x + y * y + z * z + w * w;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = x * len;\n  out[1] = y * len;\n  out[2] = z * len;\n  out[3] = w * len;\n  return out;\n}\n/**\r\n * Calculates the dot product of two vec4's\r\n *\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3];\n}\n/**\r\n * Returns the cross-product of three vectors in a 4-dimensional space\r\n *\r\n * @param {vec4} result the receiving vector\r\n * @param {vec4} U the first vector\r\n * @param {vec4} V the second vector\r\n * @param {vec4} W the third vector\r\n * @returns {vec4} result\r\n */\n\nexport function cross(out, u, v, w) {\n  var A = v[0] * w[1] - v[1] * w[0],\n      B = v[0] * w[2] - v[2] * w[0],\n      C = v[0] * w[3] - v[3] * w[0],\n      D = v[1] * w[2] - v[2] * w[1],\n      E = v[1] * w[3] - v[3] * w[1],\n      F = v[2] * w[3] - v[3] * w[2];\n  var G = u[0];\n  var H = u[1];\n  var I = u[2];\n  var J = u[3];\n  out[0] = H * F - I * E + J * D;\n  out[1] = -(G * F) + I * C - J * B;\n  out[2] = G * E - H * C + J * A;\n  out[3] = -(G * D) + H * B - I * A;\n  return out;\n}\n;\n/**\r\n * Performs a linear interpolation between two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec4} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  var aw = a[3];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  out[3] = aw + t * (b[3] - aw);\n  return out;\n}\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec4} out\r\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0; // Marsaglia, George. Choosing a Point from the Surface of a\n  // Sphere. Ann. Math. Statist. 43 (1972), no. 2, 645--646.\n  // http://projecteuclid.org/euclid.aoms/1177692644;\n\n  var v1, v2, v3, v4;\n  var s1, s2;\n\n  do {\n    v1 = glMatrix.RANDOM() * 2 - 1;\n    v2 = glMatrix.RANDOM() * 2 - 1;\n    s1 = v1 * v1 + v2 * v2;\n  } while (s1 >= 1);\n\n  do {\n    v3 = glMatrix.RANDOM() * 2 - 1;\n    v4 = glMatrix.RANDOM() * 2 - 1;\n    s2 = v3 * v3 + v4 * v4;\n  } while (s2 >= 1);\n\n  var d = Math.sqrt((1 - s1) / s2);\n  out[0] = scale * v1;\n  out[1] = scale * v2;\n  out[2] = scale * v3 * d;\n  out[3] = scale * v4 * d;\n  return out;\n}\n/**\r\n * Transforms the vec4 with a mat4.\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the vector to transform\r\n * @param {mat4} m matrix to transform with\r\n * @returns {vec4} out\r\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  out[0] = m[0] * x + m[4] * y + m[8] * z + m[12] * w;\n  out[1] = m[1] * x + m[5] * y + m[9] * z + m[13] * w;\n  out[2] = m[2] * x + m[6] * y + m[10] * z + m[14] * w;\n  out[3] = m[3] * x + m[7] * y + m[11] * z + m[15] * w;\n  return out;\n}\n/**\r\n * Transforms the vec4 with a quat\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the vector to transform\r\n * @param {quat} q quaternion to transform with\r\n * @returns {vec4} out\r\n */\n\nexport function transformQuat(out, a, q) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3]; // calculate quat * vec\n\n  var ix = qw * x + qy * z - qz * y;\n  var iy = qw * y + qz * x - qx * z;\n  var iz = qw * z + qx * y - qy * x;\n  var iw = -qx * x - qy * y - qz * z; // calculate result * inverse quat\n\n  out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy;\n  out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz;\n  out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx;\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Set the components of a vec4 to zero\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @returns {vec4} out\r\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  return out;\n}\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {vec4} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return 'vec4(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ')';\n}\n/**\r\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {vec4} a The first vector.\r\n * @param {vec4} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\n}\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {vec4} a The first vector.\r\n * @param {vec4} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3));\n}\n/**\r\n * Alias for {@link vec4.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;\n/**\r\n * Alias for {@link vec4.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link vec4.divide}\r\n * @function\r\n */\n\nexport var div = divide;\n/**\r\n * Alias for {@link vec4.distance}\r\n * @function\r\n */\n\nexport var dist = distance;\n/**\r\n * Alias for {@link vec4.squaredDistance}\r\n * @function\r\n */\n\nexport var sqrDist = squaredDistance;\n/**\r\n * Alias for {@link vec4.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Alias for {@link vec4.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Perform some operation over an array of vec4s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec4. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec4s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 4;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      vec[3] = a[i + 3];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n      a[i + 3] = vec[3];\n    }\n\n    return a;\n  };\n}();","module.exports = function(CodeMirror) {\n  CodeMirror.defineMode(\"glsl\", function(config, parserConfig) {\n    var indentUnit = config.indentUnit,\n        keywords = parserConfig.keywords || words(glslKeywords),\n        builtins = parserConfig.builtins || words(glslBuiltins),\n        blockKeywords = parserConfig.blockKeywords || words(\"case do else for if switch while struct\"),\n        atoms = parserConfig.atoms || words(\"null\"),\n        hooks = parserConfig.hooks || {},\n        multiLineStrings = parserConfig.multiLineStrings;\n    var isOperatorChar = /[+\\-*&%=<>!?|\\/]/;\n\n    var curPunc;\n\n    function tokenBase(stream, state) {\n      var ch = stream.next();\n      if (hooks[ch]) {\n        var result = hooks[ch](stream, state);\n        if (result !== false) return result;\n      }\n      if (ch == '\"' || ch == \"'\") {\n        state.tokenize = tokenString(ch);\n        return state.tokenize(stream, state);\n      }\n      if (/[\\[\\]{}\\(\\),;\\:\\.]/.test(ch)) {\n        curPunc = ch;\n        return \"bracket\";\n      }\n      if (/\\d/.test(ch)) {\n        stream.eatWhile(/[\\w\\.]/);\n        return \"number\";\n      }\n      if (ch == \"/\") {\n        if (stream.eat(\"*\")) {\n          state.tokenize = tokenComment;\n          return tokenComment(stream, state);\n        }\n        if (stream.eat(\"/\")) {\n          stream.skipToEnd();\n          return \"comment\";\n        }\n      }\n      if (ch == \"#\") {\n        stream.eatWhile(/[\\S]+/);\n        stream.eatWhile(/[\\s]+/);\n        stream.eatWhile(/[\\S]+/);\n        stream.eatWhile(/[\\s]+/);\n        return \"comment\";\n      }\n      if (isOperatorChar.test(ch)) {\n        stream.eatWhile(isOperatorChar);\n        return \"operator\";\n      }\n      stream.eatWhile(/[\\w\\$_]/);\n      var cur = stream.current();\n      if (keywords.propertyIsEnumerable(cur)) {\n        if (blockKeywords.propertyIsEnumerable(cur)) curPunc = \"newstatement\";\n        return \"keyword\";\n      }\n      if (builtins.propertyIsEnumerable(cur)) {\n        return \"builtin\";\n      }\n      if (atoms.propertyIsEnumerable(cur)) return \"atom\";\n      return \"word\";\n    }\n\n    function tokenString(quote) {\n      return function(stream, state) {\n        var escaped = false, next, end = false;\n        while ((next = stream.next()) != null) {\n          if (next == quote && !escaped) {end = true; break;}\n          escaped = !escaped && next == \"\\\\\";\n        }\n        if (end || !(escaped || multiLineStrings))\n          state.tokenize = tokenBase;\n        return \"string\";\n      };\n    }\n\n    function tokenComment(stream, state) {\n      var maybeEnd = false, ch;\n      while (ch = stream.next()) {\n        if (ch == \"/\" && maybeEnd) {\n          state.tokenize = tokenBase;\n          break;\n        }\n        maybeEnd = (ch == \"*\");\n      }\n      return \"comment\";\n    }\n\n    function Context(indented, column, type, align, prev) {\n      this.indented = indented;\n      this.column = column;\n      this.type = type;\n      this.align = align;\n      this.prev = prev;\n    }\n    function pushContext(state, col, type) {\n      return state.context = new Context(state.indented, col, type, null, state.context);\n    }\n    function popContext(state) {\n      var t = state.context.type;\n      if (t == \")\" || t == \"]\" || t == \"}\")\n        state.indented = state.context.indented;\n      return state.context = state.context.prev;\n    }\n\n    // Interface\n\n    return {\n      startState: function(basecolumn) {\n        return {\n          tokenize: null,\n          context: new Context((basecolumn || 0) - indentUnit, 0, \"top\", false),\n          indented: 0,\n          startOfLine: true\n        };\n      },\n\n      token: function(stream, state) {\n        var ctx = state.context;\n        if (stream.sol()) {\n          if (ctx.align == null) ctx.align = false;\n          state.indented = stream.indentation();\n          state.startOfLine = true;\n        }\n        if (stream.eatSpace()) return null;\n        curPunc = null;\n        var style = (state.tokenize || tokenBase)(stream, state);\n        if (style == \"comment\" || style == \"meta\") return style;\n        if (ctx.align == null) ctx.align = true;\n\n        if ((curPunc == \";\" || curPunc == \":\") && ctx.type == \"statement\") popContext(state);\n        else if (curPunc == \"{\") pushContext(state, stream.column(), \"}\");\n        else if (curPunc == \"[\") pushContext(state, stream.column(), \"]\");\n        else if (curPunc == \"(\") pushContext(state, stream.column(), \")\");\n        else if (curPunc == \"}\") {\n          while (ctx.type == \"statement\") ctx = popContext(state);\n          if (ctx.type == \"}\") ctx = popContext(state);\n          while (ctx.type == \"statement\") ctx = popContext(state);\n        }\n        else if (curPunc == ctx.type) popContext(state);\n        else if (ctx.type == \"}\" || ctx.type == \"top\" || (ctx.type == \"statement\" && curPunc == \"newstatement\"))\n          pushContext(state, stream.column(), \"statement\");\n        state.startOfLine = false;\n        return style;\n      },\n\n      indent: function(state, textAfter) {\n        if (state.tokenize != tokenBase && state.tokenize != null) return 0;\n        var firstChar = textAfter && textAfter.charAt(0), ctx = state.context, closing = firstChar == ctx.type;\n        if (ctx.type == \"statement\") return ctx.indented + (firstChar == \"{\" ? 0 : indentUnit);\n        else if (ctx.align) return ctx.column + (closing ? 0 : 1);\n        else return ctx.indented + (closing ? 0 : indentUnit);\n      },\n\n      electricChars: \"{}\"\n    };\n  });\n\n  function words(str) {\n    var obj = {}, words = str.split(\" \");\n    for (var i = 0; i < words.length; ++i) obj[words[i]] = true;\n    return obj;\n  }\n  var glslKeywords = \"attribute const uniform varying break continue \" +\n    \"do for while if else in out inout float int void bool true false \" +\n    \"lowp mediump highp precision invariant discard return mat2 mat3 \" +\n    \"mat4 vec2 vec3 vec4 ivec2 ivec3 ivec4 bvec2 bvec3 bvec4 sampler2D \" +\n    \"samplerCube struct gl_FragCoord gl_FragColor\";\n  var glslBuiltins = \"radians degrees sin cos tan asin acos atan pow \" +\n    \"exp log exp2 log2 sqrt inversesqrt abs sign floor ceil fract mod \" +\n    \"min max clamp mix step smoothstep length distance dot cross \" +\n    \"normalize faceforward reflect refract matrixCompMult lessThan \" +\n    \"lessThanEqual greaterThan greaterThanEqual equal notEqual any all \" +\n    \"not dFdx dFdy fwidth texture2D texture2DProj texture2DLod \" +\n    \"texture2DProjLod textureCube textureCubeLod require export\";\n\n  function cppHook(stream, state) {\n    if (!state.startOfLine) return false;\n    stream.skipToEnd();\n    return \"meta\";\n  }\n\n  ;(function() {\n    // C#-style strings where \"\" escapes a quote.\n    function tokenAtString(stream, state) {\n      var next;\n      while ((next = stream.next()) != null) {\n        if (next == '\"' && !stream.eat('\"')) {\n          state.tokenize = null;\n          break;\n        }\n      }\n      return \"string\";\n    }\n\n    CodeMirror.defineMIME(\"text/x-glsl\", {\n      name: \"glsl\",\n      keywords: words(glslKeywords),\n      builtins: words(glslBuiltins),\n      blockKeywords: words(\"case do else for if switch while struct\"),\n      atoms: words(\"null\"),\n      hooks: {\"#\": cppHook}\n    });\n  }());\n}\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nmodule.exports = Symbol;\n","var Symbol = require('./_Symbol'),\n    getRawTag = require('./_getRawTag'),\n    objectToString = require('./_objectToString');\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nmodule.exports = baseGetTag;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nmodule.exports = freeGlobal;\n","var Symbol = require('./_Symbol');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nmodule.exports = getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nmodule.exports = objectToString;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nmodule.exports = root;\n","var isObject = require('./isObject'),\n    now = require('./now'),\n    toNumber = require('./toNumber');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        timeWaiting = wait - timeSinceLastCall;\n\n    return maxing\n      ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n      : timeWaiting;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\nmodule.exports = debounce;\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nmodule.exports = isObject;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nmodule.exports = isObjectLike;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\nmodule.exports = isSymbol;\n","var root = require('./_root');\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\nmodule.exports = now;\n","var debounce = require('./debounce'),\n    isObject = require('./isObject');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a throttled function that only invokes `func` at most once per\n * every `wait` milliseconds. The throttled function comes with a `cancel`\n * method to cancel delayed `func` invocations and a `flush` method to\n * immediately invoke them. Provide `options` to indicate whether `func`\n * should be invoked on the leading and/or trailing edge of the `wait`\n * timeout. The `func` is invoked with the last arguments provided to the\n * throttled function. Subsequent calls to the throttled function return the\n * result of the last `func` invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the throttled function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.throttle` and `_.debounce`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to throttle.\n * @param {number} [wait=0] The number of milliseconds to throttle invocations to.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=true]\n *  Specify invoking on the leading edge of the timeout.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new throttled function.\n * @example\n *\n * // Avoid excessively updating the position while scrolling.\n * jQuery(window).on('scroll', _.throttle(updatePosition, 100));\n *\n * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.\n * var throttled = _.throttle(renewToken, 300000, { 'trailing': false });\n * jQuery(element).on('click', throttled);\n *\n * // Cancel the trailing throttled invocation.\n * jQuery(window).on('popstate', throttled.cancel);\n */\nfunction throttle(func, wait, options) {\n  var leading = true,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  if (isObject(options)) {\n    leading = 'leading' in options ? !!options.leading : leading;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n  return debounce(func, wait, {\n    'leading': leading,\n    'maxWait': wait,\n    'trailing': trailing\n  });\n}\n\nmodule.exports = throttle;\n","var isObject = require('./isObject'),\n    isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = toNumber;\n","/**\r\n * A collection of shims that provide minimal functionality of the ES6 collections.\r\n *\r\n * These implementations are not meant to be used outside of the ResizeObserver\r\n * modules as they cover only a limited range of use cases.\r\n */\r\n/* eslint-disable require-jsdoc, valid-jsdoc */\r\nvar MapShim = (function () {\r\n    if (typeof Map !== 'undefined') {\r\n        return Map;\r\n    }\r\n    /**\r\n     * Returns index in provided array that matches the specified key.\r\n     *\r\n     * @param {Array<Array>} arr\r\n     * @param {*} key\r\n     * @returns {number}\r\n     */\r\n    function getIndex(arr, key) {\r\n        var result = -1;\r\n        arr.some(function (entry, index) {\r\n            if (entry[0] === key) {\r\n                result = index;\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n        return result;\r\n    }\r\n    return /** @class */ (function () {\r\n        function class_1() {\r\n            this.__entries__ = [];\r\n        }\r\n        Object.defineProperty(class_1.prototype, \"size\", {\r\n            /**\r\n             * @returns {boolean}\r\n             */\r\n            get: function () {\r\n                return this.__entries__.length;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        /**\r\n         * @param {*} key\r\n         * @returns {*}\r\n         */\r\n        class_1.prototype.get = function (key) {\r\n            var index = getIndex(this.__entries__, key);\r\n            var entry = this.__entries__[index];\r\n            return entry && entry[1];\r\n        };\r\n        /**\r\n         * @param {*} key\r\n         * @param {*} value\r\n         * @returns {void}\r\n         */\r\n        class_1.prototype.set = function (key, value) {\r\n            var index = getIndex(this.__entries__, key);\r\n            if (~index) {\r\n                this.__entries__[index][1] = value;\r\n            }\r\n            else {\r\n                this.__entries__.push([key, value]);\r\n            }\r\n        };\r\n        /**\r\n         * @param {*} key\r\n         * @returns {void}\r\n         */\r\n        class_1.prototype.delete = function (key) {\r\n            var entries = this.__entries__;\r\n            var index = getIndex(entries, key);\r\n            if (~index) {\r\n                entries.splice(index, 1);\r\n            }\r\n        };\r\n        /**\r\n         * @param {*} key\r\n         * @returns {void}\r\n         */\r\n        class_1.prototype.has = function (key) {\r\n            return !!~getIndex(this.__entries__, key);\r\n        };\r\n        /**\r\n         * @returns {void}\r\n         */\r\n        class_1.prototype.clear = function () {\r\n            this.__entries__.splice(0);\r\n        };\r\n        /**\r\n         * @param {Function} callback\r\n         * @param {*} [ctx=null]\r\n         * @returns {void}\r\n         */\r\n        class_1.prototype.forEach = function (callback, ctx) {\r\n            if (ctx === void 0) { ctx = null; }\r\n            for (var _i = 0, _a = this.__entries__; _i < _a.length; _i++) {\r\n                var entry = _a[_i];\r\n                callback.call(ctx, entry[1], entry[0]);\r\n            }\r\n        };\r\n        return class_1;\r\n    }());\r\n})();\n\n/**\r\n * Detects whether window and document objects are available in current environment.\r\n */\r\nvar isBrowser = typeof window !== 'undefined' && typeof document !== 'undefined' && window.document === document;\n\n// Returns global object of a current environment.\r\nvar global$1 = (function () {\r\n    if (typeof global !== 'undefined' && global.Math === Math) {\r\n        return global;\r\n    }\r\n    if (typeof self !== 'undefined' && self.Math === Math) {\r\n        return self;\r\n    }\r\n    if (typeof window !== 'undefined' && window.Math === Math) {\r\n        return window;\r\n    }\r\n    // eslint-disable-next-line no-new-func\r\n    return Function('return this')();\r\n})();\n\n/**\r\n * A shim for the requestAnimationFrame which falls back to the setTimeout if\r\n * first one is not supported.\r\n *\r\n * @returns {number} Requests' identifier.\r\n */\r\nvar requestAnimationFrame$1 = (function () {\r\n    if (typeof requestAnimationFrame === 'function') {\r\n        // It's required to use a bounded function because IE sometimes throws\r\n        // an \"Invalid calling object\" error if rAF is invoked without the global\r\n        // object on the left hand side.\r\n        return requestAnimationFrame.bind(global$1);\r\n    }\r\n    return function (callback) { return setTimeout(function () { return callback(Date.now()); }, 1000 / 60); };\r\n})();\n\n// Defines minimum timeout before adding a trailing call.\r\nvar trailingTimeout = 2;\r\n/**\r\n * Creates a wrapper function which ensures that provided callback will be\r\n * invoked only once during the specified delay period.\r\n *\r\n * @param {Function} callback - Function to be invoked after the delay period.\r\n * @param {number} delay - Delay after which to invoke callback.\r\n * @returns {Function}\r\n */\r\nfunction throttle (callback, delay) {\r\n    var leadingCall = false, trailingCall = false, lastCallTime = 0;\r\n    /**\r\n     * Invokes the original callback function and schedules new invocation if\r\n     * the \"proxy\" was called during current request.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    function resolvePending() {\r\n        if (leadingCall) {\r\n            leadingCall = false;\r\n            callback();\r\n        }\r\n        if (trailingCall) {\r\n            proxy();\r\n        }\r\n    }\r\n    /**\r\n     * Callback invoked after the specified delay. It will further postpone\r\n     * invocation of the original function delegating it to the\r\n     * requestAnimationFrame.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    function timeoutCallback() {\r\n        requestAnimationFrame$1(resolvePending);\r\n    }\r\n    /**\r\n     * Schedules invocation of the original function.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    function proxy() {\r\n        var timeStamp = Date.now();\r\n        if (leadingCall) {\r\n            // Reject immediately following calls.\r\n            if (timeStamp - lastCallTime < trailingTimeout) {\r\n                return;\r\n            }\r\n            // Schedule new call to be in invoked when the pending one is resolved.\r\n            // This is important for \"transitions\" which never actually start\r\n            // immediately so there is a chance that we might miss one if change\r\n            // happens amids the pending invocation.\r\n            trailingCall = true;\r\n        }\r\n        else {\r\n            leadingCall = true;\r\n            trailingCall = false;\r\n            setTimeout(timeoutCallback, delay);\r\n        }\r\n        lastCallTime = timeStamp;\r\n    }\r\n    return proxy;\r\n}\n\n// Minimum delay before invoking the update of observers.\r\nvar REFRESH_DELAY = 20;\r\n// A list of substrings of CSS properties used to find transition events that\r\n// might affect dimensions of observed elements.\r\nvar transitionKeys = ['top', 'right', 'bottom', 'left', 'width', 'height', 'size', 'weight'];\r\n// Check if MutationObserver is available.\r\nvar mutationObserverSupported = typeof MutationObserver !== 'undefined';\r\n/**\r\n * Singleton controller class which handles updates of ResizeObserver instances.\r\n */\r\nvar ResizeObserverController = /** @class */ (function () {\r\n    /**\r\n     * Creates a new instance of ResizeObserverController.\r\n     *\r\n     * @private\r\n     */\r\n    function ResizeObserverController() {\r\n        /**\r\n         * Indicates whether DOM listeners have been added.\r\n         *\r\n         * @private {boolean}\r\n         */\r\n        this.connected_ = false;\r\n        /**\r\n         * Tells that controller has subscribed for Mutation Events.\r\n         *\r\n         * @private {boolean}\r\n         */\r\n        this.mutationEventsAdded_ = false;\r\n        /**\r\n         * Keeps reference to the instance of MutationObserver.\r\n         *\r\n         * @private {MutationObserver}\r\n         */\r\n        this.mutationsObserver_ = null;\r\n        /**\r\n         * A list of connected observers.\r\n         *\r\n         * @private {Array<ResizeObserverSPI>}\r\n         */\r\n        this.observers_ = [];\r\n        this.onTransitionEnd_ = this.onTransitionEnd_.bind(this);\r\n        this.refresh = throttle(this.refresh.bind(this), REFRESH_DELAY);\r\n    }\r\n    /**\r\n     * Adds observer to observers list.\r\n     *\r\n     * @param {ResizeObserverSPI} observer - Observer to be added.\r\n     * @returns {void}\r\n     */\r\n    ResizeObserverController.prototype.addObserver = function (observer) {\r\n        if (!~this.observers_.indexOf(observer)) {\r\n            this.observers_.push(observer);\r\n        }\r\n        // Add listeners if they haven't been added yet.\r\n        if (!this.connected_) {\r\n            this.connect_();\r\n        }\r\n    };\r\n    /**\r\n     * Removes observer from observers list.\r\n     *\r\n     * @param {ResizeObserverSPI} observer - Observer to be removed.\r\n     * @returns {void}\r\n     */\r\n    ResizeObserverController.prototype.removeObserver = function (observer) {\r\n        var observers = this.observers_;\r\n        var index = observers.indexOf(observer);\r\n        // Remove observer if it's present in registry.\r\n        if (~index) {\r\n            observers.splice(index, 1);\r\n        }\r\n        // Remove listeners if controller has no connected observers.\r\n        if (!observers.length && this.connected_) {\r\n            this.disconnect_();\r\n        }\r\n    };\r\n    /**\r\n     * Invokes the update of observers. It will continue running updates insofar\r\n     * it detects changes.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    ResizeObserverController.prototype.refresh = function () {\r\n        var changesDetected = this.updateObservers_();\r\n        // Continue running updates if changes have been detected as there might\r\n        // be future ones caused by CSS transitions.\r\n        if (changesDetected) {\r\n            this.refresh();\r\n        }\r\n    };\r\n    /**\r\n     * Updates every observer from observers list and notifies them of queued\r\n     * entries.\r\n     *\r\n     * @private\r\n     * @returns {boolean} Returns \"true\" if any observer has detected changes in\r\n     *      dimensions of it's elements.\r\n     */\r\n    ResizeObserverController.prototype.updateObservers_ = function () {\r\n        // Collect observers that have active observations.\r\n        var activeObservers = this.observers_.filter(function (observer) {\r\n            return observer.gatherActive(), observer.hasActive();\r\n        });\r\n        // Deliver notifications in a separate cycle in order to avoid any\r\n        // collisions between observers, e.g. when multiple instances of\r\n        // ResizeObserver are tracking the same element and the callback of one\r\n        // of them changes content dimensions of the observed target. Sometimes\r\n        // this may result in notifications being blocked for the rest of observers.\r\n        activeObservers.forEach(function (observer) { return observer.broadcastActive(); });\r\n        return activeObservers.length > 0;\r\n    };\r\n    /**\r\n     * Initializes DOM listeners.\r\n     *\r\n     * @private\r\n     * @returns {void}\r\n     */\r\n    ResizeObserverController.prototype.connect_ = function () {\r\n        // Do nothing if running in a non-browser environment or if listeners\r\n        // have been already added.\r\n        if (!isBrowser || this.connected_) {\r\n            return;\r\n        }\r\n        // Subscription to the \"Transitionend\" event is used as a workaround for\r\n        // delayed transitions. This way it's possible to capture at least the\r\n        // final state of an element.\r\n        document.addEventListener('transitionend', this.onTransitionEnd_);\r\n        window.addEventListener('resize', this.refresh);\r\n        if (mutationObserverSupported) {\r\n            this.mutationsObserver_ = new MutationObserver(this.refresh);\r\n            this.mutationsObserver_.observe(document, {\r\n                attributes: true,\r\n                childList: true,\r\n                characterData: true,\r\n                subtree: true\r\n            });\r\n        }\r\n        else {\r\n            document.addEventListener('DOMSubtreeModified', this.refresh);\r\n            this.mutationEventsAdded_ = true;\r\n        }\r\n        this.connected_ = true;\r\n    };\r\n    /**\r\n     * Removes DOM listeners.\r\n     *\r\n     * @private\r\n     * @returns {void}\r\n     */\r\n    ResizeObserverController.prototype.disconnect_ = function () {\r\n        // Do nothing if running in a non-browser environment or if listeners\r\n        // have been already removed.\r\n        if (!isBrowser || !this.connected_) {\r\n            return;\r\n        }\r\n        document.removeEventListener('transitionend', this.onTransitionEnd_);\r\n        window.removeEventListener('resize', this.refresh);\r\n        if (this.mutationsObserver_) {\r\n            this.mutationsObserver_.disconnect();\r\n        }\r\n        if (this.mutationEventsAdded_) {\r\n            document.removeEventListener('DOMSubtreeModified', this.refresh);\r\n        }\r\n        this.mutationsObserver_ = null;\r\n        this.mutationEventsAdded_ = false;\r\n        this.connected_ = false;\r\n    };\r\n    /**\r\n     * \"Transitionend\" event handler.\r\n     *\r\n     * @private\r\n     * @param {TransitionEvent} event\r\n     * @returns {void}\r\n     */\r\n    ResizeObserverController.prototype.onTransitionEnd_ = function (_a) {\r\n        var _b = _a.propertyName, propertyName = _b === void 0 ? '' : _b;\r\n        // Detect whether transition may affect dimensions of an element.\r\n        var isReflowProperty = transitionKeys.some(function (key) {\r\n            return !!~propertyName.indexOf(key);\r\n        });\r\n        if (isReflowProperty) {\r\n            this.refresh();\r\n        }\r\n    };\r\n    /**\r\n     * Returns instance of the ResizeObserverController.\r\n     *\r\n     * @returns {ResizeObserverController}\r\n     */\r\n    ResizeObserverController.getInstance = function () {\r\n        if (!this.instance_) {\r\n            this.instance_ = new ResizeObserverController();\r\n        }\r\n        return this.instance_;\r\n    };\r\n    /**\r\n     * Holds reference to the controller's instance.\r\n     *\r\n     * @private {ResizeObserverController}\r\n     */\r\n    ResizeObserverController.instance_ = null;\r\n    return ResizeObserverController;\r\n}());\n\n/**\r\n * Defines non-writable/enumerable properties of the provided target object.\r\n *\r\n * @param {Object} target - Object for which to define properties.\r\n * @param {Object} props - Properties to be defined.\r\n * @returns {Object} Target object.\r\n */\r\nvar defineConfigurable = (function (target, props) {\r\n    for (var _i = 0, _a = Object.keys(props); _i < _a.length; _i++) {\r\n        var key = _a[_i];\r\n        Object.defineProperty(target, key, {\r\n            value: props[key],\r\n            enumerable: false,\r\n            writable: false,\r\n            configurable: true\r\n        });\r\n    }\r\n    return target;\r\n});\n\n/**\r\n * Returns the global object associated with provided element.\r\n *\r\n * @param {Object} target\r\n * @returns {Object}\r\n */\r\nvar getWindowOf = (function (target) {\r\n    // Assume that the element is an instance of Node, which means that it\r\n    // has the \"ownerDocument\" property from which we can retrieve a\r\n    // corresponding global object.\r\n    var ownerGlobal = target && target.ownerDocument && target.ownerDocument.defaultView;\r\n    // Return the local global object if it's not possible extract one from\r\n    // provided element.\r\n    return ownerGlobal || global$1;\r\n});\n\n// Placeholder of an empty content rectangle.\r\nvar emptyRect = createRectInit(0, 0, 0, 0);\r\n/**\r\n * Converts provided string to a number.\r\n *\r\n * @param {number|string} value\r\n * @returns {number}\r\n */\r\nfunction toFloat(value) {\r\n    return parseFloat(value) || 0;\r\n}\r\n/**\r\n * Extracts borders size from provided styles.\r\n *\r\n * @param {CSSStyleDeclaration} styles\r\n * @param {...string} positions - Borders positions (top, right, ...)\r\n * @returns {number}\r\n */\r\nfunction getBordersSize(styles) {\r\n    var positions = [];\r\n    for (var _i = 1; _i < arguments.length; _i++) {\r\n        positions[_i - 1] = arguments[_i];\r\n    }\r\n    return positions.reduce(function (size, position) {\r\n        var value = styles['border-' + position + '-width'];\r\n        return size + toFloat(value);\r\n    }, 0);\r\n}\r\n/**\r\n * Extracts paddings sizes from provided styles.\r\n *\r\n * @param {CSSStyleDeclaration} styles\r\n * @returns {Object} Paddings box.\r\n */\r\nfunction getPaddings(styles) {\r\n    var positions = ['top', 'right', 'bottom', 'left'];\r\n    var paddings = {};\r\n    for (var _i = 0, positions_1 = positions; _i < positions_1.length; _i++) {\r\n        var position = positions_1[_i];\r\n        var value = styles['padding-' + position];\r\n        paddings[position] = toFloat(value);\r\n    }\r\n    return paddings;\r\n}\r\n/**\r\n * Calculates content rectangle of provided SVG element.\r\n *\r\n * @param {SVGGraphicsElement} target - Element content rectangle of which needs\r\n *      to be calculated.\r\n * @returns {DOMRectInit}\r\n */\r\nfunction getSVGContentRect(target) {\r\n    var bbox = target.getBBox();\r\n    return createRectInit(0, 0, bbox.width, bbox.height);\r\n}\r\n/**\r\n * Calculates content rectangle of provided HTMLElement.\r\n *\r\n * @param {HTMLElement} target - Element for which to calculate the content rectangle.\r\n * @returns {DOMRectInit}\r\n */\r\nfunction getHTMLElementContentRect(target) {\r\n    // Client width & height properties can't be\r\n    // used exclusively as they provide rounded values.\r\n    var clientWidth = target.clientWidth, clientHeight = target.clientHeight;\r\n    // By this condition we can catch all non-replaced inline, hidden and\r\n    // detached elements. Though elements with width & height properties less\r\n    // than 0.5 will be discarded as well.\r\n    //\r\n    // Without it we would need to implement separate methods for each of\r\n    // those cases and it's not possible to perform a precise and performance\r\n    // effective test for hidden elements. E.g. even jQuery's ':visible' filter\r\n    // gives wrong results for elements with width & height less than 0.5.\r\n    if (!clientWidth && !clientHeight) {\r\n        return emptyRect;\r\n    }\r\n    var styles = getWindowOf(target).getComputedStyle(target);\r\n    var paddings = getPaddings(styles);\r\n    var horizPad = paddings.left + paddings.right;\r\n    var vertPad = paddings.top + paddings.bottom;\r\n    // Computed styles of width & height are being used because they are the\r\n    // only dimensions available to JS that contain non-rounded values. It could\r\n    // be possible to utilize the getBoundingClientRect if only it's data wasn't\r\n    // affected by CSS transformations let alone paddings, borders and scroll bars.\r\n    var width = toFloat(styles.width), height = toFloat(styles.height);\r\n    // Width & height include paddings and borders when the 'border-box' box\r\n    // model is applied (except for IE).\r\n    if (styles.boxSizing === 'border-box') {\r\n        // Following conditions are required to handle Internet Explorer which\r\n        // doesn't include paddings and borders to computed CSS dimensions.\r\n        //\r\n        // We can say that if CSS dimensions + paddings are equal to the \"client\"\r\n        // properties then it's either IE, and thus we don't need to subtract\r\n        // anything, or an element merely doesn't have paddings/borders styles.\r\n        if (Math.round(width + horizPad) !== clientWidth) {\r\n            width -= getBordersSize(styles, 'left', 'right') + horizPad;\r\n        }\r\n        if (Math.round(height + vertPad) !== clientHeight) {\r\n            height -= getBordersSize(styles, 'top', 'bottom') + vertPad;\r\n        }\r\n    }\r\n    // Following steps can't be applied to the document's root element as its\r\n    // client[Width/Height] properties represent viewport area of the window.\r\n    // Besides, it's as well not necessary as the <html> itself neither has\r\n    // rendered scroll bars nor it can be clipped.\r\n    if (!isDocumentElement(target)) {\r\n        // In some browsers (only in Firefox, actually) CSS width & height\r\n        // include scroll bars size which can be removed at this step as scroll\r\n        // bars are the only difference between rounded dimensions + paddings\r\n        // and \"client\" properties, though that is not always true in Chrome.\r\n        var vertScrollbar = Math.round(width + horizPad) - clientWidth;\r\n        var horizScrollbar = Math.round(height + vertPad) - clientHeight;\r\n        // Chrome has a rather weird rounding of \"client\" properties.\r\n        // E.g. for an element with content width of 314.2px it sometimes gives\r\n        // the client width of 315px and for the width of 314.7px it may give\r\n        // 314px. And it doesn't happen all the time. So just ignore this delta\r\n        // as a non-relevant.\r\n        if (Math.abs(vertScrollbar) !== 1) {\r\n            width -= vertScrollbar;\r\n        }\r\n        if (Math.abs(horizScrollbar) !== 1) {\r\n            height -= horizScrollbar;\r\n        }\r\n    }\r\n    return createRectInit(paddings.left, paddings.top, width, height);\r\n}\r\n/**\r\n * Checks whether provided element is an instance of the SVGGraphicsElement.\r\n *\r\n * @param {Element} target - Element to be checked.\r\n * @returns {boolean}\r\n */\r\nvar isSVGGraphicsElement = (function () {\r\n    // Some browsers, namely IE and Edge, don't have the SVGGraphicsElement\r\n    // interface.\r\n    if (typeof SVGGraphicsElement !== 'undefined') {\r\n        return function (target) { return target instanceof getWindowOf(target).SVGGraphicsElement; };\r\n    }\r\n    // If it's so, then check that element is at least an instance of the\r\n    // SVGElement and that it has the \"getBBox\" method.\r\n    // eslint-disable-next-line no-extra-parens\r\n    return function (target) { return (target instanceof getWindowOf(target).SVGElement &&\r\n        typeof target.getBBox === 'function'); };\r\n})();\r\n/**\r\n * Checks whether provided element is a document element (<html>).\r\n *\r\n * @param {Element} target - Element to be checked.\r\n * @returns {boolean}\r\n */\r\nfunction isDocumentElement(target) {\r\n    return target === getWindowOf(target).document.documentElement;\r\n}\r\n/**\r\n * Calculates an appropriate content rectangle for provided html or svg element.\r\n *\r\n * @param {Element} target - Element content rectangle of which needs to be calculated.\r\n * @returns {DOMRectInit}\r\n */\r\nfunction getContentRect(target) {\r\n    if (!isBrowser) {\r\n        return emptyRect;\r\n    }\r\n    if (isSVGGraphicsElement(target)) {\r\n        return getSVGContentRect(target);\r\n    }\r\n    return getHTMLElementContentRect(target);\r\n}\r\n/**\r\n * Creates rectangle with an interface of the DOMRectReadOnly.\r\n * Spec: https://drafts.fxtf.org/geometry/#domrectreadonly\r\n *\r\n * @param {DOMRectInit} rectInit - Object with rectangle's x/y coordinates and dimensions.\r\n * @returns {DOMRectReadOnly}\r\n */\r\nfunction createReadOnlyRect(_a) {\r\n    var x = _a.x, y = _a.y, width = _a.width, height = _a.height;\r\n    // If DOMRectReadOnly is available use it as a prototype for the rectangle.\r\n    var Constr = typeof DOMRectReadOnly !== 'undefined' ? DOMRectReadOnly : Object;\r\n    var rect = Object.create(Constr.prototype);\r\n    // Rectangle's properties are not writable and non-enumerable.\r\n    defineConfigurable(rect, {\r\n        x: x, y: y, width: width, height: height,\r\n        top: y,\r\n        right: x + width,\r\n        bottom: height + y,\r\n        left: x\r\n    });\r\n    return rect;\r\n}\r\n/**\r\n * Creates DOMRectInit object based on the provided dimensions and the x/y coordinates.\r\n * Spec: https://drafts.fxtf.org/geometry/#dictdef-domrectinit\r\n *\r\n * @param {number} x - X coordinate.\r\n * @param {number} y - Y coordinate.\r\n * @param {number} width - Rectangle's width.\r\n * @param {number} height - Rectangle's height.\r\n * @returns {DOMRectInit}\r\n */\r\nfunction createRectInit(x, y, width, height) {\r\n    return { x: x, y: y, width: width, height: height };\r\n}\n\n/**\r\n * Class that is responsible for computations of the content rectangle of\r\n * provided DOM element and for keeping track of it's changes.\r\n */\r\nvar ResizeObservation = /** @class */ (function () {\r\n    /**\r\n     * Creates an instance of ResizeObservation.\r\n     *\r\n     * @param {Element} target - Element to be observed.\r\n     */\r\n    function ResizeObservation(target) {\r\n        /**\r\n         * Broadcasted width of content rectangle.\r\n         *\r\n         * @type {number}\r\n         */\r\n        this.broadcastWidth = 0;\r\n        /**\r\n         * Broadcasted height of content rectangle.\r\n         *\r\n         * @type {number}\r\n         */\r\n        this.broadcastHeight = 0;\r\n        /**\r\n         * Reference to the last observed content rectangle.\r\n         *\r\n         * @private {DOMRectInit}\r\n         */\r\n        this.contentRect_ = createRectInit(0, 0, 0, 0);\r\n        this.target = target;\r\n    }\r\n    /**\r\n     * Updates content rectangle and tells whether it's width or height properties\r\n     * have changed since the last broadcast.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    ResizeObservation.prototype.isActive = function () {\r\n        var rect = getContentRect(this.target);\r\n        this.contentRect_ = rect;\r\n        return (rect.width !== this.broadcastWidth ||\r\n            rect.height !== this.broadcastHeight);\r\n    };\r\n    /**\r\n     * Updates 'broadcastWidth' and 'broadcastHeight' properties with a data\r\n     * from the corresponding properties of the last observed content rectangle.\r\n     *\r\n     * @returns {DOMRectInit} Last observed content rectangle.\r\n     */\r\n    ResizeObservation.prototype.broadcastRect = function () {\r\n        var rect = this.contentRect_;\r\n        this.broadcastWidth = rect.width;\r\n        this.broadcastHeight = rect.height;\r\n        return rect;\r\n    };\r\n    return ResizeObservation;\r\n}());\n\nvar ResizeObserverEntry = /** @class */ (function () {\r\n    /**\r\n     * Creates an instance of ResizeObserverEntry.\r\n     *\r\n     * @param {Element} target - Element that is being observed.\r\n     * @param {DOMRectInit} rectInit - Data of the element's content rectangle.\r\n     */\r\n    function ResizeObserverEntry(target, rectInit) {\r\n        var contentRect = createReadOnlyRect(rectInit);\r\n        // According to the specification following properties are not writable\r\n        // and are also not enumerable in the native implementation.\r\n        //\r\n        // Property accessors are not being used as they'd require to define a\r\n        // private WeakMap storage which may cause memory leaks in browsers that\r\n        // don't support this type of collections.\r\n        defineConfigurable(this, { target: target, contentRect: contentRect });\r\n    }\r\n    return ResizeObserverEntry;\r\n}());\n\nvar ResizeObserverSPI = /** @class */ (function () {\r\n    /**\r\n     * Creates a new instance of ResizeObserver.\r\n     *\r\n     * @param {ResizeObserverCallback} callback - Callback function that is invoked\r\n     *      when one of the observed elements changes it's content dimensions.\r\n     * @param {ResizeObserverController} controller - Controller instance which\r\n     *      is responsible for the updates of observer.\r\n     * @param {ResizeObserver} callbackCtx - Reference to the public\r\n     *      ResizeObserver instance which will be passed to callback function.\r\n     */\r\n    function ResizeObserverSPI(callback, controller, callbackCtx) {\r\n        /**\r\n         * Collection of resize observations that have detected changes in dimensions\r\n         * of elements.\r\n         *\r\n         * @private {Array<ResizeObservation>}\r\n         */\r\n        this.activeObservations_ = [];\r\n        /**\r\n         * Registry of the ResizeObservation instances.\r\n         *\r\n         * @private {Map<Element, ResizeObservation>}\r\n         */\r\n        this.observations_ = new MapShim();\r\n        if (typeof callback !== 'function') {\r\n            throw new TypeError('The callback provided as parameter 1 is not a function.');\r\n        }\r\n        this.callback_ = callback;\r\n        this.controller_ = controller;\r\n        this.callbackCtx_ = callbackCtx;\r\n    }\r\n    /**\r\n     * Starts observing provided element.\r\n     *\r\n     * @param {Element} target - Element to be observed.\r\n     * @returns {void}\r\n     */\r\n    ResizeObserverSPI.prototype.observe = function (target) {\r\n        if (!arguments.length) {\r\n            throw new TypeError('1 argument required, but only 0 present.');\r\n        }\r\n        // Do nothing if current environment doesn't have the Element interface.\r\n        if (typeof Element === 'undefined' || !(Element instanceof Object)) {\r\n            return;\r\n        }\r\n        if (!(target instanceof getWindowOf(target).Element)) {\r\n            throw new TypeError('parameter 1 is not of type \"Element\".');\r\n        }\r\n        var observations = this.observations_;\r\n        // Do nothing if element is already being observed.\r\n        if (observations.has(target)) {\r\n            return;\r\n        }\r\n        observations.set(target, new ResizeObservation(target));\r\n        this.controller_.addObserver(this);\r\n        // Force the update of observations.\r\n        this.controller_.refresh();\r\n    };\r\n    /**\r\n     * Stops observing provided element.\r\n     *\r\n     * @param {Element} target - Element to stop observing.\r\n     * @returns {void}\r\n     */\r\n    ResizeObserverSPI.prototype.unobserve = function (target) {\r\n        if (!arguments.length) {\r\n            throw new TypeError('1 argument required, but only 0 present.');\r\n        }\r\n        // Do nothing if current environment doesn't have the Element interface.\r\n        if (typeof Element === 'undefined' || !(Element instanceof Object)) {\r\n            return;\r\n        }\r\n        if (!(target instanceof getWindowOf(target).Element)) {\r\n            throw new TypeError('parameter 1 is not of type \"Element\".');\r\n        }\r\n        var observations = this.observations_;\r\n        // Do nothing if element is not being observed.\r\n        if (!observations.has(target)) {\r\n            return;\r\n        }\r\n        observations.delete(target);\r\n        if (!observations.size) {\r\n            this.controller_.removeObserver(this);\r\n        }\r\n    };\r\n    /**\r\n     * Stops observing all elements.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    ResizeObserverSPI.prototype.disconnect = function () {\r\n        this.clearActive();\r\n        this.observations_.clear();\r\n        this.controller_.removeObserver(this);\r\n    };\r\n    /**\r\n     * Collects observation instances the associated element of which has changed\r\n     * it's content rectangle.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    ResizeObserverSPI.prototype.gatherActive = function () {\r\n        var _this = this;\r\n        this.clearActive();\r\n        this.observations_.forEach(function (observation) {\r\n            if (observation.isActive()) {\r\n                _this.activeObservations_.push(observation);\r\n            }\r\n        });\r\n    };\r\n    /**\r\n     * Invokes initial callback function with a list of ResizeObserverEntry\r\n     * instances collected from active resize observations.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    ResizeObserverSPI.prototype.broadcastActive = function () {\r\n        // Do nothing if observer doesn't have active observations.\r\n        if (!this.hasActive()) {\r\n            return;\r\n        }\r\n        var ctx = this.callbackCtx_;\r\n        // Create ResizeObserverEntry instance for every active observation.\r\n        var entries = this.activeObservations_.map(function (observation) {\r\n            return new ResizeObserverEntry(observation.target, observation.broadcastRect());\r\n        });\r\n        this.callback_.call(ctx, entries, ctx);\r\n        this.clearActive();\r\n    };\r\n    /**\r\n     * Clears the collection of active observations.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    ResizeObserverSPI.prototype.clearActive = function () {\r\n        this.activeObservations_.splice(0);\r\n    };\r\n    /**\r\n     * Tells whether observer has active observations.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    ResizeObserverSPI.prototype.hasActive = function () {\r\n        return this.activeObservations_.length > 0;\r\n    };\r\n    return ResizeObserverSPI;\r\n}());\n\n// Registry of internal observers. If WeakMap is not available use current shim\r\n// for the Map collection as it has all required methods and because WeakMap\r\n// can't be fully polyfilled anyway.\r\nvar observers = typeof WeakMap !== 'undefined' ? new WeakMap() : new MapShim();\r\n/**\r\n * ResizeObserver API. Encapsulates the ResizeObserver SPI implementation\r\n * exposing only those methods and properties that are defined in the spec.\r\n */\r\nvar ResizeObserver = /** @class */ (function () {\r\n    /**\r\n     * Creates a new instance of ResizeObserver.\r\n     *\r\n     * @param {ResizeObserverCallback} callback - Callback that is invoked when\r\n     *      dimensions of the observed elements change.\r\n     */\r\n    function ResizeObserver(callback) {\r\n        if (!(this instanceof ResizeObserver)) {\r\n            throw new TypeError('Cannot call a class as a function.');\r\n        }\r\n        if (!arguments.length) {\r\n            throw new TypeError('1 argument required, but only 0 present.');\r\n        }\r\n        var controller = ResizeObserverController.getInstance();\r\n        var observer = new ResizeObserverSPI(callback, controller, this);\r\n        observers.set(this, observer);\r\n    }\r\n    return ResizeObserver;\r\n}());\r\n// Expose public methods of ResizeObserver.\r\n[\r\n    'observe',\r\n    'unobserve',\r\n    'disconnect'\r\n].forEach(function (method) {\r\n    ResizeObserver.prototype[method] = function () {\r\n        var _a;\r\n        return (_a = observers.get(this))[method].apply(_a, arguments);\r\n    };\r\n});\n\nvar index = (function () {\r\n    // Export existing implementation if available.\r\n    if (typeof global$1.ResizeObserver !== 'undefined') {\r\n        return global$1.ResizeObserver;\r\n    }\r\n    return ResizeObserver;\r\n})();\n\nexport default index;\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Main entry point for default neuroglancer viewer.\n */\nimport {setupDefaultViewer} from 'neuroglancer/ui/default_viewer_setup';\n\nwindow.addEventListener('DOMContentLoaded', () => {\n  setupDefaultViewer();\n});\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {AnnotationSource} from 'neuroglancer/annotation';\nimport {MultiscaleAnnotationSource} from 'neuroglancer/annotation/frontend_source';\nimport {CoordinateTransform} from 'neuroglancer/coordinate_transform';\nimport {RenderLayerRole} from 'neuroglancer/layer';\nimport {SegmentationDisplayState} from 'neuroglancer/segmentation_display_state/frontend';\nimport {TrackableAlphaValue} from 'neuroglancer/trackable_alpha';\nimport {TrackableBoolean} from 'neuroglancer/trackable_boolean';\nimport {WatchableValue} from 'neuroglancer/trackable_value';\nimport {TrackableRGB} from 'neuroglancer/util/color';\nimport {Owned, RefCounted} from 'neuroglancer/util/disposable';\nimport {mat4} from 'neuroglancer/util/geom';\n\nexport class AnnotationHoverState extends\n    WatchableValue<{id: string, partIndex: number}|undefined> {}\n\nexport class AnnotationLayerState extends RefCounted {\n  transform: CoordinateTransform;\n  source: Owned<AnnotationSource|MultiscaleAnnotationSource>;\n  hoverState: AnnotationHoverState;\n  role: RenderLayerRole;\n  color: TrackableRGB;\n  fillOpacity: TrackableAlphaValue;\n\n  /**\n   * undefined means may have a segmentation state.  null means no segmentation state is supported.\n   */\n  segmentationState: WatchableValue<SegmentationDisplayState|undefined|null>;\n  filterBySegmentation: TrackableBoolean;\n\n  private transformCacheGeneration = -1;\n  private cachedObjectToGlobal = mat4.create();\n  private cachedGlobalToObject = mat4.create();\n\n  private updateTransforms() {\n    const {transform, transformCacheGeneration} = this;\n    const generation = transform.changed.count;\n    if (generation === transformCacheGeneration) {\n      return;\n    }\n    const {cachedObjectToGlobal} = this;\n    mat4.multiply(cachedObjectToGlobal, this.transform.transform, this.source.objectToLocal);\n    mat4.invert(this.cachedGlobalToObject, cachedObjectToGlobal);\n  }\n\n  get objectToGlobal() {\n    this.updateTransforms();\n    return this.cachedObjectToGlobal;\n  }\n\n  get globalToObject() {\n    this.updateTransforms();\n    return this.cachedGlobalToObject;\n  }\n\n  constructor(options: {\n    transform?: CoordinateTransform, source: Owned<AnnotationSource|MultiscaleAnnotationSource>,\n    hoverState?: AnnotationHoverState,\n    role?: RenderLayerRole, color: TrackableRGB, fillOpacity: TrackableAlphaValue,\n    segmentationState?: WatchableValue<SegmentationDisplayState|undefined|null>,\n    filterBySegmentation?: TrackableBoolean,\n  }) {\n    super();\n    const {\n      transform = new CoordinateTransform(),\n      source,\n      hoverState = new AnnotationHoverState(undefined),\n      role = RenderLayerRole.ANNOTATION,\n      color,\n      fillOpacity,\n      segmentationState = new WatchableValue(null),\n      filterBySegmentation = new TrackableBoolean(false),\n    } = options;\n    this.transform = transform;\n    this.source = this.registerDisposer(source);\n    this.hoverState = hoverState;\n    this.role = role;\n    this.color = color;\n    this.fillOpacity = fillOpacity;\n    this.segmentationState = segmentationState;\n    this.filterBySegmentation = filterBySegmentation;\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {SliceViewChunkSpecification} from 'neuroglancer/sliceview/base';\n\nexport const ANNOTATION_METADATA_CHUNK_SOURCE_RPC_ID = 'annotation.MetadataChunkSource';\nexport const ANNOTATION_GEOMETRY_CHUNK_SOURCE_RPC_ID = 'annotation.GeometryChunkSource';\nexport const ANNOTATION_SUBSET_GEOMETRY_CHUNK_SOURCE_RPC_ID = 'annotation.SubsetGeometryChunkSource';\nexport const ANNOTATION_REFERENCE_ADD_RPC_ID = 'annotation.reference.add';\nexport const ANNOTATION_REFERENCE_DELETE_RPC_ID = 'annotation.reference.delete';\nexport const ANNOTATION_COMMIT_UPDATE_RPC_ID = 'annotation.commit';\nexport const ANNOTATION_COMMIT_UPDATE_RESULT_RPC_ID = 'annotation.commit';\n\nexport class AnnotationGeometryChunkSpecification extends SliceViewChunkSpecification {}\n\nexport const ANNOTATION_PERSPECTIVE_RENDER_LAYER_RPC_ID = 'annotation/PerspectiveRenderLayer';\nexport const ANNOTATION_RENDER_LAYER_RPC_ID = 'annotation/RenderLayer';\nexport const ANNOTATION_RENDER_LAYER_UPDATE_SEGMENTATION_RPC_ID =\n    'annotation/RenderLayer.updateSegmentation';\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Support for rendering bounding box annotations.\n */\n\nimport {AnnotationType, AxisAlignedBoundingBox} from 'neuroglancer/annotation';\nimport {AnnotationRenderContext, AnnotationRenderHelper, registerAnnotationTypeRenderHandler} from 'neuroglancer/annotation/type_handler';\nimport {BoundingBoxCrossSectionRenderHelper, vertexBasePositions} from 'neuroglancer/sliceview/bounding_box_shader_helper';\nimport {SliceViewPanelRenderContext} from 'neuroglancer/sliceview/panel';\nimport {tile2dArray} from 'neuroglancer/util/array';\nimport {mat4, projectPointToLineSegment, vec3} from 'neuroglancer/util/geom';\nimport {Buffer, getMemoizedBuffer} from 'neuroglancer/webgl/buffer';\nimport {CircleShader, VERTICES_PER_CIRCLE} from 'neuroglancer/webgl/circles';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {LineShader, VERTICES_PER_LINE} from 'neuroglancer/webgl/lines';\nimport {emitterDependentShaderGetter, ShaderBuilder, ShaderProgram} from 'neuroglancer/webgl/shader';\n\nconst EDGES_PER_BOX = 12;\nconst CORNERS_PER_BOX = 8;\n\nconst FULL_OBJECT_PICK_OFFSET = 0;\nconst CORNERS_PICK_OFFSET = FULL_OBJECT_PICK_OFFSET + 1;\nconst EDGES_PICK_OFFSET = CORNERS_PICK_OFFSET + CORNERS_PER_BOX;\nconst FACES_PICK_OFFSET = EDGES_PICK_OFFSET + EDGES_PER_BOX;\nconst PICK_IDS_PER_INSTANCE = FACES_PICK_OFFSET + 6;\n\nconst edgeBoxCornerOffsetData = Float32Array.from([\n  // a1\n  0, 0, 0,\n  // b1\n  0, 0, 1,\n  // c1\n  EDGES_PICK_OFFSET + 0,\n\n  // a2\n  1, 0, 0,\n  // b2\n  1, 0, 1,\n  // c2\n  EDGES_PICK_OFFSET + 1,\n\n  // a3\n  0, 1, 0,\n  // b3\n  0, 1, 1,\n  // c3\n  EDGES_PICK_OFFSET + 2,\n\n  // a4\n  1, 1, 0,\n  // b4\n  1, 1, 1,\n  // c4\n  EDGES_PICK_OFFSET + 3,\n\n  // a5\n  0, 0, 0,\n  // b5\n  0, 1, 0,\n  // c5\n  EDGES_PICK_OFFSET + 4,\n\n  // a6\n  0, 0, 1,\n  // b6\n  0, 1, 1,\n  // c6\n  EDGES_PICK_OFFSET + 5,\n\n  // a7\n  1, 0, 0,\n  // b7\n  1, 1, 0,\n  // c7\n  EDGES_PICK_OFFSET + 6,\n\n  // a8\n  1, 0, 1,\n  // b8\n  1, 1, 1,\n  // c8\n  EDGES_PICK_OFFSET + 7,\n\n  // a9\n  0, 0, 0,\n  // b9\n  1, 0, 0,\n  // c9\n  EDGES_PICK_OFFSET + 8,\n\n  // a10\n  0, 0, 1,\n  // b10\n  1, 0, 1,\n  // c10\n  EDGES_PICK_OFFSET + 9,\n\n  // a11\n  0, 1, 0,\n  // b11\n  1, 1, 0,\n  // c11\n  EDGES_PICK_OFFSET + 10,\n\n  // a12\n  0, 1, 1,\n  // b12\n  1, 1, 1,\n  // c12\n  EDGES_PICK_OFFSET + 11\n]);\n\nabstract class RenderHelper extends AnnotationRenderHelper {\n  defineShader(builder: ShaderBuilder) {\n    super.defineShader(builder);\n    // Position of point in camera coordinates.\n    builder.addAttribute('highp vec3', 'aLower');\n    builder.addAttribute('highp vec3', 'aUpper');\n  }\n\n  enable(shader: ShaderProgram, context: AnnotationRenderContext, callback: () => void) {\n    super.enable(shader, context, () => {\n      const {gl} = shader;\n      const aLower = shader.attribute('aLower');\n      const aUpper = shader.attribute('aUpper');\n      context.buffer.bindToVertexAttrib(\n          aLower, /*components=*/ 3, /*attributeType=*/ WebGL2RenderingContext.FLOAT,\n          /*normalized=*/ false,\n          /*stride=*/ 4 * 6, /*offset=*/ context.bufferOffset);\n      context.buffer.bindToVertexAttrib(\n          aUpper, /*components=*/ 3, /*attributeType=*/ WebGL2RenderingContext.FLOAT,\n          /*normalized=*/ false,\n          /*stride=*/ 4 * 6, /*offset=*/ context.bufferOffset + 4 * 3);\n\n      gl.vertexAttribDivisor(aLower, 1);\n      gl.vertexAttribDivisor(aUpper, 1);\n      callback();\n      gl.vertexAttribDivisor(aLower, 0);\n      gl.vertexAttribDivisor(aUpper, 0);\n      gl.disableVertexAttribArray(aLower);\n      gl.disableVertexAttribArray(aUpper);\n    });\n  }\n}\n\nclass PerspectiveViewRenderHelper extends RenderHelper {\n  private lineShader = this.registerDisposer(new LineShader(this.gl, EDGES_PER_BOX));\n\n  private edgeBoxCornerOffsetsBuffer = this.registerDisposer(Buffer.fromData(\n      this.gl,\n      tile2dArray(\n          edgeBoxCornerOffsetData, /*majorDimension=*/ 7, /*minorTiles=*/ 1,\n          /*majorTiles=*/ VERTICES_PER_LINE)));\n\n  private edgeShaderGetter =\n      emitterDependentShaderGetter(this, this.gl, (builder: ShaderBuilder) => {\n        this.defineShader(builder);\n        this.lineShader.defineShader(builder);\n\n        // XYZ corners of box ranging from [0, 0, 0] to [1, 1, 1].\n        builder.addAttribute('highp vec3', 'aBoxCornerOffset1');\n\n        // Last component of aBoxCornerOffset2 is the edge index.\n        builder.addAttribute('highp vec4', 'aBoxCornerOffset2');\n        builder.setVertexMain(`\nvec3 vertexPosition1 = mix(aLower, aUpper, aBoxCornerOffset1);\nvec3 vertexPosition2 = mix(aLower, aUpper, aBoxCornerOffset2.xyz);\nemitLine(uProjection, vertexPosition1, vertexPosition2);\n${this.setPartIndex(builder, 'uint(aBoxCornerOffset2.w)')};\n`);\n        builder.setFragmentMain(`\nemitAnnotation(vec4(vColor.rgb, getLineAlpha()));\n`);\n      });\n\n  private circleShader = this.registerDisposer(new CircleShader(this.gl, CORNERS_PER_BOX));\n\n  private boxCornerOffsetsBuffer = this.registerDisposer(Buffer.fromData(\n      this.gl,\n      tile2dArray(\n          vertexBasePositions, /*majorDimension=*/ 3, /*minorTiles=*/ 1,\n          /*majorTiles=*/ VERTICES_PER_CIRCLE)));\n\n  private cornerShaderGetter =\n      emitterDependentShaderGetter(this, this.gl, (builder: ShaderBuilder) => {\n        this.defineShader(builder);\n        this.circleShader.defineShader(builder, this.targetIsSliceView);\n\n        // XYZ corners of box ranging from [0, 0, 0] to [1, 1, 1].\n        builder.addAttribute('highp vec3', 'aBoxCornerOffset');\n\n        builder.setVertexMain(`\nvec3 vertexPosition = mix(aLower, aUpper, aBoxCornerOffset);\nemitCircle(uProjection * vec4(vertexPosition, 1.0));\nuint cornerIndex = uint(aBoxCornerOffset.x + aBoxCornerOffset.y * 2.0 + aBoxCornerOffset.z * 4.0);\nuint cornerPickOffset = ${CORNERS_PICK_OFFSET}u + cornerIndex;\n${this.setPartIndex(builder, 'cornerPickOffset')};\n`);\n        builder.setFragmentMain(`\nvec4 borderColor = vec4(0.0, 0.0, 0.0, 1.0);\nemitAnnotation(getCircleColor(vColor, borderColor));\n`);\n      });\n\n  drawEdges(context: AnnotationRenderContext) {\n    const shader = this.edgeShaderGetter(context.renderContext.emitter);\n    const {gl} = this;\n    this.enable(shader, context, () => {\n      const aBoxCornerOffset1 = shader.attribute('aBoxCornerOffset1');\n      const aBoxCornerOffset2 = shader.attribute('aBoxCornerOffset2');\n\n      this.edgeBoxCornerOffsetsBuffer.bindToVertexAttrib(\n          aBoxCornerOffset1, /*components=*/ 3, /*attributeType=*/ WebGL2RenderingContext.FLOAT,\n          /*normalized=*/ false,\n          /*stride=*/ 4 * 7, /*offset=*/ 0);\n\n      this.edgeBoxCornerOffsetsBuffer.bindToVertexAttrib(\n          aBoxCornerOffset2, /*components=*/ 4, /*attributeType=*/ WebGL2RenderingContext.FLOAT,\n          /*normalized=*/ false,\n          /*stride=*/ 4 * 7, /*offset=*/ 4 * 3);\n\n      this.lineShader.draw(shader, context.renderContext, /*lineWidth=*/ 1, 1, context.count);\n      gl.disableVertexAttribArray(aBoxCornerOffset1);\n      gl.disableVertexAttribArray(aBoxCornerOffset2);\n    });\n  }\n\n  drawCorners(context: AnnotationRenderContext) {\n    const shader = this.cornerShaderGetter(context.renderContext.emitter);\n    const {gl} = this;\n    this.enable(shader, context, () => {\n      const aBoxCornerOffset = shader.attribute('aBoxCornerOffset');\n      this.boxCornerOffsetsBuffer.bindToVertexAttrib(\n          aBoxCornerOffset, /*components=*/ 3, /*attributeType=*/ WebGL2RenderingContext.FLOAT,\n          /*normalized=*/ false);\n      this.circleShader.draw(\n          shader, context.renderContext,\n          {interiorRadiusInPixels: 1, borderWidthInPixels: 0, featherWidthInPixels: 1},\n          context.count);\n      gl.disableVertexAttribArray(aBoxCornerOffset);\n    });\n  }\n\n  draw(context: AnnotationRenderContext) {\n    this.drawEdges(context);\n    this.drawCorners(context);\n  }\n}\n\nfunction getBaseIntersectionVertexIndexArray() {\n  return new Float32Array([0, 1, 2, 3, 4, 5]);\n}\n\nfunction getIntersectionVertexIndexArray() {\n  return tile2dArray(\n      getBaseIntersectionVertexIndexArray(),\n      /*majorDimension=*/ 1,\n      /*minorTiles=*/ 1,\n      /*majorTiles=*/ VERTICES_PER_LINE);\n}\n\n\nclass SliceViewRenderHelper extends RenderHelper {\n  private lineShader = new LineShader(this.gl, 6);\n  private intersectionVertexIndexBuffer =\n      getMemoizedBuffer(\n          this.gl, WebGL2RenderingContext.ARRAY_BUFFER, getIntersectionVertexIndexArray)\n          .value;\n  private filledIntersectionVertexIndexBuffer =\n      getMemoizedBuffer(\n          this.gl, WebGL2RenderingContext.ARRAY_BUFFER, getBaseIntersectionVertexIndexArray)\n          .value;\n  private boundingBoxCrossSectionHelper =\n      this.registerDisposer(new BoundingBoxCrossSectionRenderHelper(this.gl));\n\n  constructor(public gl: GL) {\n    super(gl);\n  }\n\n  private faceShaderGetter =\n      emitterDependentShaderGetter(this, this.gl, (builder: ShaderBuilder) => {\n        super.defineShader(builder);\n        this.boundingBoxCrossSectionHelper.defineShader(builder);\n        this.lineShader.defineShader(builder);\n\n        builder.addAttribute('highp float', 'aVertexIndexFloat');\n        builder.setVertexMain(`\nint vertexIndex1 = int(aVertexIndexFloat);\nint vertexIndex2 = vertexIndex1 == 5 ? 0 : vertexIndex1 + 1;\nvec3 vertexPosition1 = getBoundingBoxPlaneIntersectionVertexPosition(aUpper - aLower, aLower, aLower, aUpper, vertexIndex1);\nvec3 vertexPosition2 = getBoundingBoxPlaneIntersectionVertexPosition(aUpper - aLower, aLower, aLower, aUpper, vertexIndex2);\nemitLine(uProjection, vertexPosition1, vertexPosition2);\n${this.setPartIndex(builder)};\n`);\n        builder.setFragmentMain(`\nemitAnnotation(vec4(vColor.rgb, vColor.a * getLineAlpha()));\n`);\n      });\n\n  private fillShaderGetter =\n      emitterDependentShaderGetter(this, this.gl, (builder: ShaderBuilder) => {\n        super.defineShader(builder);\n        this.boundingBoxCrossSectionHelper.defineShader(builder);\n        builder.addAttribute('highp float', 'aVertexIndexFloat');\n        builder.addUniform('highp float', 'uFillOpacity');\n        builder.setVertexMain(`\nint vertexIndex = int(aVertexIndexFloat);\nvec3 vertexPosition = getBoundingBoxPlaneIntersectionVertexPosition(aUpper - aLower, aLower, aLower, aUpper, vertexIndex);\ngl_Position = uProjection * vec4(vertexPosition, 1);\n${this.setPartIndex(builder)};\n`);\n        builder.setFragmentMain(`\nemitAnnotation(vec4(vColor.rgb, uFillOpacity));\n`);\n      });\n\n  draw(context: AnnotationRenderContext&{renderContext: SliceViewPanelRenderContext}) {\n    const fillOpacity = context.annotationLayer.state.fillOpacity.value;\n    const shader = (fillOpacity ? this.fillShaderGetter : this.faceShaderGetter)(\n        context.renderContext.emitter);\n    let {gl} = this;\n    this.enable(shader, context, () => {\n      this.boundingBoxCrossSectionHelper.setViewportPlane(\n          shader, context.renderContext.sliceView.viewportAxes[2],\n          context.renderContext.sliceView.centerDataPosition,\n          context.annotationLayer.state.globalToObject);\n      const aVertexIndexFloat = shader.attribute('aVertexIndexFloat');\n\n      (fillOpacity ? this.filledIntersectionVertexIndexBuffer : this.intersectionVertexIndexBuffer)\n          .bindToVertexAttrib(\n              aVertexIndexFloat, /*components=*/ 1, /*attributeType=*/ WebGL2RenderingContext.FLOAT,\n              /*normalized=*/ false);\n\n      if (fillOpacity) {\n        gl.uniform1f(shader.uniform('uFillOpacity'), fillOpacity);\n        gl.drawArraysInstanced(WebGL2RenderingContext.TRIANGLE_FAN, 0, 6, context.count);\n      } else {\n        const lineWidth = context.renderContext.emitColor ? 1 : 5;\n        this.lineShader.draw(shader, context.renderContext, lineWidth, 1.0, context.count);\n      }\n      gl.disableVertexAttribArray(aVertexIndexFloat);\n    });\n  }\n}\nfunction getEdgeCorners(corners: Float32Array, edgeIndex: number) {\n  const i = edgeIndex * 7;\n  const cA = vec3.create(), cB = vec3.create();\n  for (let j = 0; j < 3; ++j) {\n    const ma = edgeBoxCornerOffsetData[i + j];\n    const mb = edgeBoxCornerOffsetData[i + j + 3];\n    const a = Math.min(corners[j], corners[j + 3]), b = Math.max(corners[j], corners[j + 3]);\n    cA[j] = (1 - ma) * a + ma * b;\n    cB[j] = (1 - mb) * a + mb * b;\n  }\n\n  return {cornerA: cA, cornerB: cB};\n}\nfunction snapPositionToEdge(\n    position: vec3, objectToData: mat4, corners: Float32Array, edgeIndex: number) {\n  let edgeCorners = getEdgeCorners(corners, edgeIndex);\n  vec3.transformMat4(edgeCorners.cornerA, edgeCorners.cornerA, objectToData);\n  vec3.transformMat4(edgeCorners.cornerB, edgeCorners.cornerB, objectToData);\n\n  projectPointToLineSegment(position, edgeCorners.cornerA, edgeCorners.cornerB, position);\n}\n\nfunction snapPositionToCorner(\n    position: vec3, objectToData: mat4, corners: Float32Array, cornerIndex: number) {\n  const i = cornerIndex * 3;\n  for (let j = 0; j < 3; ++j) {\n    const m = vertexBasePositions[i + j];\n    const a = Math.min(corners[j], corners[j + 3]), b = Math.max(corners[j], corners[j + 3]);\n    position[j] = (1 - m) * a + m * b;\n  }\n  vec3.transformMat4(position, position, objectToData);\n}\n\nregisterAnnotationTypeRenderHandler(AnnotationType.AXIS_ALIGNED_BOUNDING_BOX, {\n  bytes: 6 * 4,\n  serializer: (buffer: ArrayBuffer, offset: number, numAnnotations: number) => {\n    const coordinates = new Float32Array(buffer, offset, numAnnotations * 6);\n    return (annotation: AxisAlignedBoundingBox, index: number) => {\n      const {pointA, pointB} = annotation;\n      const coordinateOffset = index * 6;\n      coordinates[coordinateOffset] = Math.min(pointA[0], pointB[0]);\n      coordinates[coordinateOffset + 1] = Math.min(pointA[1], pointB[1]);\n      coordinates[coordinateOffset + 2] = Math.min(pointA[2], pointB[2]);\n      coordinates[coordinateOffset + 3] = Math.max(pointA[0], pointB[0]);\n      coordinates[coordinateOffset + 4] = Math.max(pointA[1], pointB[1]);\n      coordinates[coordinateOffset + 5] = Math.max(pointA[2], pointB[2]);\n    };\n  },\n  sliceViewRenderHelper: SliceViewRenderHelper,\n  perspectiveViewRenderHelper: PerspectiveViewRenderHelper,\n  pickIdsPerInstance: PICK_IDS_PER_INSTANCE,\n  snapPosition: (position, objectToData, data, offset, partIndex) => {\n    const corners = new Float32Array(data, offset, 6);\n    if (partIndex >= CORNERS_PICK_OFFSET && partIndex < EDGES_PICK_OFFSET) {\n      snapPositionToCorner(position, objectToData, corners, partIndex - CORNERS_PICK_OFFSET);\n    } else if (partIndex >= EDGES_PICK_OFFSET && partIndex < FACES_PICK_OFFSET) {\n      snapPositionToEdge(position, objectToData, corners, partIndex - EDGES_PICK_OFFSET);\n    } else {\n      // vec3.transformMat4(position, annotation.point, objectToData);\n    }\n  },\n  getRepresentativePoint: (objectToData, ann, partIndex) => {\n    let repPoint = vec3.create();\n    // if the full object is selected pick the first corner as representative\n    if (partIndex === FULL_OBJECT_PICK_OFFSET) {\n      vec3.transformMat4(repPoint, ann.pointA, objectToData);\n    } else if (partIndex >= CORNERS_PICK_OFFSET && partIndex < EDGES_PICK_OFFSET) {\n      // picked a corner\n      // FIXME: figure out how to return corner point\n      vec3.transformMat4(repPoint, ann.pointA, objectToData);\n    } else if (partIndex >= EDGES_PICK_OFFSET && partIndex < FACES_PICK_OFFSET) {\n      // FIXME: can't figure out how to resize based upon edge grabbed\n      vec3.transformMat4(repPoint, ann.pointA, objectToData);\n      // snapPositionToCorner(repPoint, objectToData, corners, 5);\n    } else {  // for now faces will move the whole object so pick the first corner\n      vec3.transformMat4(repPoint, ann.pointA, objectToData);\n    }\n    return repPoint;\n  },\n\n  updateViaRepresentativePoint:\n      (oldAnnotation: AxisAlignedBoundingBox, position: vec3, dataToObject: mat4,\n       partIndex: number) => {\n        let newPt = vec3.transformMat4(vec3.create(), position, dataToObject);\n        let baseBox = {...oldAnnotation};\n        // if the full object is selected pick the first corner as representative\n        let delta = vec3.sub(vec3.create(), oldAnnotation.pointB, oldAnnotation.pointA);\n        if (partIndex === FULL_OBJECT_PICK_OFFSET) {\n          baseBox.pointA = newPt;\n          baseBox.pointB = vec3.add(vec3.create(), newPt, delta);\n        } else if (partIndex >= CORNERS_PICK_OFFSET && partIndex < EDGES_PICK_OFFSET) {\n          // picked a corner\n          baseBox.pointA = newPt;\n          baseBox.pointB = vec3.add(vec3.create(), newPt, delta);\n        } else if (partIndex >= EDGES_PICK_OFFSET && partIndex < FACES_PICK_OFFSET) {\n          baseBox.pointA = newPt;\n          baseBox.pointB = vec3.add(vec3.create(), newPt, delta);\n        } else {  // for now faces will move the whole object so pick the first corner\n          baseBox.pointA = newPt;\n          baseBox.pointB = vec3.add(vec3.create(), newPt, delta);\n        }\n        return baseBox;\n      }\n});\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Support for rendering ellipsoid annotations.\n */\n\nimport {AnnotationType, Ellipsoid} from 'neuroglancer/annotation';\nimport {AnnotationRenderContext, AnnotationRenderHelper, registerAnnotationTypeRenderHandler} from 'neuroglancer/annotation/type_handler';\nimport {PerspectiveViewRenderContext} from 'neuroglancer/perspective_view/render_layer';\nimport {SliceViewPanelRenderContext} from 'neuroglancer/sliceview/panel';\nimport {mat3, mat4, vec3} from 'neuroglancer/util/geom';\nimport {computeCenterOrientEllipseDebug, computeCrossSectionEllipseDebug, glsl_computeCenterOrientEllipse, glsl_computeCrossSectionEllipse} from 'neuroglancer/webgl/ellipse';\nimport {QuadRenderHelper} from 'neuroglancer/webgl/quad';\nimport {emitterDependentShaderGetter, ShaderBuilder, ShaderProgram} from 'neuroglancer/webgl/shader';\nimport {SphereRenderHelper} from 'neuroglancer/webgl/spheres';\nimport {getSquareCornersBuffer} from 'neuroglancer/webgl/square_corners_buffer';\n\nconst tempMat4 = mat4.create();\n\nconst DEBUG = false;\n\nabstract class RenderHelper extends AnnotationRenderHelper {\n  defineShader(builder: ShaderBuilder) {\n    super.defineShader(builder);\n    builder.addAttribute('highp vec3', 'aCenter');\n    builder.addAttribute('highp vec3', 'aRadii');\n  }\n\n  enable(shader: ShaderProgram, context: AnnotationRenderContext, callback: () => void) {\n    super.enable(shader, context, () => {\n      const aCenter = shader.attribute('aCenter');\n      const aRadii = shader.attribute('aRadii');\n      const {gl} = shader;\n      context.buffer.bindToVertexAttrib(\n          aCenter, /*components=*/ 3, /*attributeType=*/ WebGL2RenderingContext.FLOAT,\n          /*normalized=*/ false,\n          /*stride=*/ 4 * 6, /*offset=*/ context.bufferOffset);\n      context.buffer.bindToVertexAttrib(\n          aRadii, /*components=*/ 3, /*attributeType=*/ WebGL2RenderingContext.FLOAT,\n          /*normalized=*/ false,\n          /*stride=*/ 4 * 6, /*offset=*/ context.bufferOffset + 4 * 3);\n      gl.vertexAttribDivisor(aCenter, 1);\n      gl.vertexAttribDivisor(aRadii, 1);\n      callback();\n      gl.vertexAttribDivisor(aCenter, 0);\n      gl.vertexAttribDivisor(aRadii, 0);\n      gl.disableVertexAttribArray(aCenter);\n      gl.disableVertexAttribArray(aRadii);\n    });\n  }\n}\n\n/**\n * Render an ellipsoid as a transformed triangulated sphere.\n */\nclass PerspectiveRenderHelper extends RenderHelper {\n  private sphereRenderHelper = this.registerDisposer(new SphereRenderHelper(this.gl, 10, 10));\n\n  private shaderGetter = emitterDependentShaderGetter(this, this.gl, (builder: ShaderBuilder) => {\n    this.defineShader(builder);\n    this.sphereRenderHelper.defineShader(builder);\n    builder.addUniform('highp vec4', 'uLightDirection');\n    builder.addUniform('highp mat4', 'uNormalTransform');\n    builder.setVertexMain(`\nemitSphere(uProjection, uNormalTransform, aCenter, aRadii, uLightDirection);\n${this.setPartIndex(builder)};\n`);\n    builder.setFragmentMain(`\nemitAnnotation(vec4(vColor.rgb * vLightingFactor, vColor.a));\n`);\n  });\n\n  private tempLightVec = new Float32Array(4);\n\n  draw(context: AnnotationRenderContext&{renderContext: PerspectiveViewRenderContext}) {\n    const shader = this.shaderGetter(context.renderContext.emitter);\n    this.enable(shader, context, () => {\n      const {gl} = shader;\n      let lightVec = <vec3>this.tempLightVec;\n      let {lightDirection, ambientLighting, directionalLighting} = context.renderContext;\n      vec3.scale(lightVec, lightDirection, directionalLighting);\n      lightVec[3] = ambientLighting;\n      gl.uniform4fv(shader.uniform('uLightDirection'), lightVec);\n      gl.uniformMatrix4fv(\n          shader.uniform('uNormalTransform'), /*transpose=*/ false,\n          mat4.transpose(mat4.create(), context.annotationLayer.state.globalToObject));\n      this.sphereRenderHelper.draw(shader, context.count);\n    });\n  }\n}\n\n/**\n * Render a cross section of an ellipsoid.\n *\n * This is done using the following steps:\n *\n * Vertex shader:\n *\n * 1. We transform the ellipsoid parameters to the cross section coordinate frame (with the z\n *    axis corresponding to the plane normal).\n *\n * 2. We then compute the quadratic form parameters of the ellipse corresponding to the intersection\n *    of the ellipsoid with the `z=0` plane.\n *\n * 3. We convert the quadratic form parameterization into the center-orient parameterization.\n *\n * 4. The vertex shader emits the 4 vertices of the bounding box of the ellipse, equal to:\n *\n *      `k +/- a*u1 +/- b*u2`,\n *\n *    where `k` is the center of the ellipse, `u1` and `u2` are the major and minor axis directions\n *    respectively, and `a` and `b` are the semi-major and semi-minor axis lengths, respectively.\n *    These four vertices are used to draw a quad (two triangles).\n *\n * Fragment shader:\n *\n * 5. The fragment shader discards fragments outside the bounds of the ellipse.\n */\nclass SliceViewRenderHelper extends RenderHelper {\n  private quadRenderHelper = this.registerDisposer(new QuadRenderHelper(this.gl, 1));\n  private squareCornersBuffer =\n      getSquareCornersBuffer(this.gl, -1, -1, 1, 1, /*minorTiles=*/ 1, /*majorTiles=*/ 1);\n\n  private shaderGetter = emitterDependentShaderGetter(this, this.gl, (builder: ShaderBuilder) => {\n    this.defineShader(builder);\n    builder.addUniform('highp mat4', 'uViewportToObject');\n    builder.addUniform('highp mat4', 'uObjectToViewport');\n    builder.addUniform('highp mat4', 'uViewportToDevice');\n    builder.addAttribute('highp vec2', 'aCornerOffset');\n    builder.addVarying('highp vec2', 'vCircleCoord');\n    builder.addVertexCode(glsl_computeCrossSectionEllipse);\n    builder.addVertexCode(glsl_computeCenterOrientEllipse);\n    builder.setVertexMain(`\nmat3 Aobject = mat3(0.0);\nfor (int i = 0; i < 3; ++i) {\n  Aobject[i][i] = 1.0 / (aRadii[i] * aRadii[i]);\n}\nmat3 RviewportToObject = mat3(uViewportToObject);\nmat3 Aviewport = transpose(RviewportToObject) * Aobject * RviewportToObject;\nvec3 cViewport = (uObjectToViewport * vec4(aCenter, 1.0)).xyz;\nEllipseQuadraticForm quadraticForm = computeCrossSectionEllipse(Aviewport, cViewport);\nvec2 u1, u2;\nfloat a, b;\nCenterOrientEllipse centerOrient = computeCenterOrientEllipse(quadraticForm);\nvec2 viewportCorner = centerOrient.k +\n  centerOrient.u1 * aCornerOffset.x * centerOrient.a +\n  centerOrient.u2 * aCornerOffset.y * centerOrient.b;\nif (centerOrient.valid) {\n  gl_Position = uViewportToDevice * vec4(viewportCorner, 0.0, 1.0);\n} else {\n  gl_Position = vec4(1.0, 1.0, 0.0, -100.0);\n}\nvCircleCoord = aCornerOffset;\n${this.setPartIndex(builder)};\n`);\n    builder.setFragmentMain(`\nif (dot(vCircleCoord, vCircleCoord) > 1.0) {\n  discard;\n}\nemitAnnotation(vec4(vColor.rgb, 0.5));\n`);\n  });\n\n  draw(context: AnnotationRenderContext&{renderContext: SliceViewPanelRenderContext}) {\n    const shader = this.shaderGetter(context.renderContext.emitter);\n    this.enable(shader, context, () => {\n      const {gl} = shader;\n      const aCornerOffset = shader.attribute('aCornerOffset');\n      this.squareCornersBuffer.bindToVertexAttrib(aCornerOffset, /*components=*/ 2);\n      const viewportToObject = mat4.multiply(\n          tempMat4, context.annotationLayer.state.globalToObject,\n          context.renderContext.sliceView.viewportToData);\n      gl.uniformMatrix4fv(\n          shader.uniform('uViewportToObject'), /*transpose=*/ false, viewportToObject);\n      gl.uniformMatrix4fv(\n          shader.uniform('uViewportToDevice'), /*transpose=*/ false,\n          context.renderContext.sliceView.viewportToDevice);\n      const objectToViewport = tempMat4;\n      mat4.invert(objectToViewport, viewportToObject);\n      gl.uniformMatrix4fv(\n          shader.uniform('uObjectToViewport'), /*transpose=*/ false, objectToViewport);\n      this.quadRenderHelper.draw(gl, context.count);\n      shader.gl.disableVertexAttribArray(aCornerOffset);\n\n\n      if (DEBUG) {\n        const center = vec3.fromValues(2184, 1700, 3981);\n        const radii = vec3.fromValues(133, 133, 133);\n\n        const Aobject = mat3.create();\n        Aobject[0] = 1 / (radii[0] * radii[0]);\n        Aobject[4] = 1 / (radii[1] * radii[1]);\n        Aobject[8] = 1 / (radii[2] * radii[2]);\n\n        const RviewportToObject = mat3.fromMat4(mat3.create(), viewportToObject);\n        const Aviewport =\n            mat3.multiply(mat3.create(), mat3.transpose(mat3.create(), RviewportToObject), Aobject);\n        mat3.multiply(Aviewport, Aviewport, RviewportToObject);\n        const cViewport = vec3.transformMat4(vec3.create(), center, objectToViewport);\n\n        console.log('Aviewport', Aviewport);\n        console.log('cViewport', cViewport);\n\n        const p = computeCrossSectionEllipseDebug(Aviewport, cViewport);\n        const centerOrient = computeCenterOrientEllipseDebug(p);\n        console.log(p);\n        console.log(centerOrient);\n      }\n    });\n  }\n}\n\nregisterAnnotationTypeRenderHandler(AnnotationType.ELLIPSOID, {\n  bytes: 6 * 4,\n  serializer: (buffer: ArrayBuffer, offset: number, numAnnotations: number) => {\n    const coordinates = new Float32Array(buffer, offset, numAnnotations * 6);\n    return (annotation: Ellipsoid, index: number) => {\n      const {center, radii} = annotation;\n      const coordinateOffset = index * 6;\n      coordinates.set(center, coordinateOffset);\n      coordinates.set(radii, coordinateOffset + 3);\n    };\n  },\n  sliceViewRenderHelper: SliceViewRenderHelper,\n  perspectiveViewRenderHelper: PerspectiveRenderHelper,\n  pickIdsPerInstance: 1,\n  snapPosition: (/*position, objectToData, annotation, partIndex*/) => {\n    // FIXME: snap to nearest point on ellipsoid surface\n  },\n  getRepresentativePoint: (objectToData, ann) => {\n    let repPoint = vec3.create();\n    vec3.transformMat4(repPoint, ann.center, objectToData);\n    return repPoint;\n  },\n  updateViaRepresentativePoint: (oldAnnotation: Ellipsoid, position: vec3, dataToObject: mat4) => {\n    let annotation = {...oldAnnotation};\n    annotation.center = vec3.transformMat4(vec3.create(), position, dataToObject);\n    return annotation;\n  }\n});\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport {AnnotationHoverState, AnnotationLayerState} from 'neuroglancer/annotation/annotation_layer_state';\nexport {MultiscaleAnnotationSource} from 'neuroglancer/annotation/frontend_source';\nexport {AnnotationLayer, PerspectiveViewAnnotationLayer, SliceViewAnnotationLayer} from 'neuroglancer/annotation/renderlayer';\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Annotation, AnnotationId, AnnotationReference, AnnotationType, annotationTypes, deserializeAnnotation, getAnnotationTypeHandler, makeAnnotationId, AnnotationSourceSignals} from 'neuroglancer/annotation';\nimport {ANNOTATION_COMMIT_UPDATE_RESULT_RPC_ID, ANNOTATION_COMMIT_UPDATE_RPC_ID, ANNOTATION_GEOMETRY_CHUNK_SOURCE_RPC_ID, ANNOTATION_METADATA_CHUNK_SOURCE_RPC_ID, ANNOTATION_REFERENCE_ADD_RPC_ID, ANNOTATION_REFERENCE_DELETE_RPC_ID, ANNOTATION_SUBSET_GEOMETRY_CHUNK_SOURCE_RPC_ID, AnnotationGeometryChunkSpecification} from 'neuroglancer/annotation/base';\nimport {getAnnotationTypeRenderHandler} from 'neuroglancer/annotation/type_handler';\nimport {Chunk, ChunkManager, ChunkSource} from 'neuroglancer/chunk_manager/frontend';\nimport {getObjectKey} from 'neuroglancer/segmentation_display_state/base';\nimport {SliceViewSourceOptions} from 'neuroglancer/sliceview/base';\nimport {MultiscaleSliceViewChunkSource, SliceViewChunk, SliceViewChunkSource, SliceViewChunkSourceOptions} from 'neuroglancer/sliceview/frontend';\nimport {RenderLayer} from 'neuroglancer/sliceview/renderlayer';\nimport {StatusMessage} from 'neuroglancer/status';\nimport {binarySearch} from 'neuroglancer/util/array';\nimport {Borrowed, Owned} from 'neuroglancer/util/disposable';\nimport {mat4} from 'neuroglancer/util/geom';\nimport {Signal, NullarySignal} from 'neuroglancer/util/signal';\nimport {Buffer} from 'neuroglancer/webgl/buffer';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {registerRPC, registerSharedObjectOwner, RPC, SharedObject} from 'neuroglancer/worker_rpc';\n\ninterface AnnotationGeometryChunkSourceOptions extends SliceViewChunkSourceOptions {\n  spec: AnnotationGeometryChunkSpecification;\n  parameters: any;\n  parent: Borrowed<MultiscaleAnnotationSource>;\n}\n\nexport class AnnotationGeometryData {\n  buffer: Buffer|undefined;\n  bufferValid = false;\n  data: Uint8Array|undefined;\n  typeToOffset: number[]|undefined;\n  numPickIds: number;\n  typeToIds: string[][]|undefined;\n\n  constructor(x: any) {\n    this.data = x.data;\n    const typeToIds = this.typeToIds = x.typeToIds;\n    let numPickIds = 0;\n    for (const annotationType of annotationTypes) {\n      numPickIds += getAnnotationTypeRenderHandler(annotationType).pickIdsPerInstance *\n          typeToIds[annotationType].length;\n    }\n    this.numPickIds = numPickIds;\n    this.typeToOffset = x.typeToOffset;\n  }\n  freeGPUMemory(gl: GL) {\n    gl;\n    const {buffer} = this;\n    if (buffer !== undefined) {\n      buffer.dispose();\n      this.bufferValid = false;\n      this.buffer = undefined;\n    }\n  }\n}\n\nexport class AnnotationSubsetGeometryChunk extends Chunk {\n  source: AnnotationSubsetGeometryChunkSource;\n  data: AnnotationGeometryData;\n  constructor(source: AnnotationSubsetGeometryChunkSource, x: any) {\n    super(source);\n    this.data = new AnnotationGeometryData(x);\n  }\n\n  freeGPUMemory(gl: GL) {\n    super.freeGPUMemory(gl);\n    this.data.freeGPUMemory(gl);\n  }\n\n  dispose() {\n    this.data = <any>undefined;\n  }\n}\n\nexport class AnnotationGeometryChunk extends SliceViewChunk {\n  source: AnnotationGeometryChunkSource;\n  data: AnnotationGeometryData;\n\n  constructor(source: AnnotationGeometryChunkSource, x: any) {\n    super(source, x);\n    this.data = new AnnotationGeometryData(x);\n  }\n\n  freeGPUMemory(gl: GL) {\n    super.freeGPUMemory(gl);\n    this.data.freeGPUMemory(gl);\n  }\n\n  dispose() {\n    this.data = <any>undefined;\n  }\n}\n\n@registerSharedObjectOwner(ANNOTATION_GEOMETRY_CHUNK_SOURCE_RPC_ID)\nexport class AnnotationGeometryChunkSource extends SliceViewChunkSource {\n  parent: Borrowed<MultiscaleAnnotationSource>;\n  chunks: Map<string, AnnotationGeometryChunk>;\n  spec: AnnotationGeometryChunkSpecification;\n  parameters: any;\n  immediateChunkUpdates = true;\n\n  constructor(chunkManager: Borrowed<ChunkManager>, options: AnnotationGeometryChunkSourceOptions) {\n    super(chunkManager, options);\n    this.parent = options.parent;\n    this.parameters = options.parameters;\n    this.spec = options.spec;\n  }\n\n  initializeCounterpart(rpc: RPC, options: any) {\n    options['parameters'] = this.parameters;\n    options['parent'] = this.parent.rpcId;\n    super.initializeCounterpart(rpc, options);\n  }\n\n  addChunk(key: string, chunk: AnnotationGeometryChunk) {\n    super.addChunk(key, chunk);\n    // TODO: process local deletions\n  }\n\n  getChunk(x: any) {\n    return new AnnotationGeometryChunk(this, x);\n  }\n}\n\n@registerSharedObjectOwner(ANNOTATION_SUBSET_GEOMETRY_CHUNK_SOURCE_RPC_ID)\nexport class AnnotationSubsetGeometryChunkSource extends ChunkSource {\n  immediateChunkUpdates = true;\n  chunks: Map<string, AnnotationSubsetGeometryChunk>;\n\n  constructor(\n      chunkManager: Borrowed<ChunkManager>, public parent: Borrowed<MultiscaleAnnotationSource>) {\n    super(chunkManager, {});\n  }\n\n  initializeCounterpart(rpc: RPC, options: any) {\n    options['parent'] = this.parent.rpcId;\n    super.initializeCounterpart(rpc, options);\n  }\n\n  addChunk(key: string, chunk: AnnotationSubsetGeometryChunk) {\n    super.addChunk(key, chunk);\n    // TODO: process local deletions\n  }\n\n  getChunk(x: any): AnnotationSubsetGeometryChunk {\n    return new AnnotationSubsetGeometryChunk(this, x);\n  }\n}\n\nexport class AnnotationMetadataChunk extends Chunk {\n  annotation: Annotation|null;\n  constructor(source: Borrowed<AnnotationMetadataChunkSource>, x: any) {\n    super(source);\n    this.annotation = deserializeAnnotation(x.annotation);\n  }\n}\n\n@registerSharedObjectOwner(ANNOTATION_METADATA_CHUNK_SOURCE_RPC_ID)\nexport class AnnotationMetadataChunkSource extends ChunkSource {\n  chunks: Map<string, AnnotationMetadataChunk>;\n  constructor(\n      chunkManager: Borrowed<ChunkManager>, public parent: Borrowed<MultiscaleAnnotationSource>) {\n    super(chunkManager);\n  }\n  getChunk(x: any): AnnotationMetadataChunk {\n    return new AnnotationMetadataChunk(this, x);\n  }\n  addChunk(key: string, chunk: AnnotationMetadataChunk) {\n    super.addChunk(key, chunk);\n    const {references} = this.parent;\n    const reference = references.get(key);\n    if (reference !== undefined) {\n      reference.value = chunk.annotation;\n      reference.changed.dispatch();\n    }\n  }\n  deleteChunk(key: string) {\n    const {references} = this.parent;\n    const reference = references.get(key);\n    if (reference !== undefined) {\n      reference.value = undefined;\n      reference.changed.dispatch();\n    }\n  }\n  initializeCounterpart(rpc: RPC, options: any) {\n    options['parent'] = this.parent.rpcId;\n    super.initializeCounterpart(rpc, options);\n  }\n}\n\nfunction updateAnnotation(chunk: AnnotationGeometryData, annotation: Annotation) {\n  // Find insertion point.\n  const type = annotation.type;\n  let ids = chunk.typeToIds![type];\n  const handler = getAnnotationTypeHandler(type);\n  const numBytes = handler.serializedBytes;\n  const renderHandler = getAnnotationTypeRenderHandler(type);\n  let insertionPoint = binarySearch(ids, annotation.id, (a, b) => a < b ? -1 : a === b ? 0 : 1);\n  let offset = 0;\n  let updateOffsets = () => {};\n  if (insertionPoint < 0) {\n    // Doesn't already exist.\n    insertionPoint = ~insertionPoint;\n    ids.splice(insertionPoint, 0, annotation.id);\n    const newData = new Uint8Array(chunk.data!.length + numBytes);\n    chunk.numPickIds += renderHandler.pickIdsPerInstance;\n    offset = chunk.typeToOffset![type] + numBytes * insertionPoint;\n    newData.set(chunk.data!.subarray(0, offset), 0);\n    newData.set(chunk.data!.subarray(offset), offset + numBytes);\n    chunk.data = newData;\n    updateOffsets = () => {\n      for (const otherType of annotationTypes) {\n        if (otherType > type) {\n          chunk.typeToOffset![otherType] += numBytes;\n        }\n      }\n    };\n  } else {\n    offset = chunk.typeToOffset![type] + handler.serializedBytes * insertionPoint;\n  }\n  const serializer = handler.serializer(chunk.data!.buffer, chunk.typeToOffset![type], ids.length);\n  serializer(annotation, insertionPoint);\n  updateOffsets();\n  chunk.bufferValid = false;\n}\n\nfunction deleteAnnotation(chunk: AnnotationGeometryData, type: AnnotationType, id: AnnotationId) {\n  let ids = chunk.typeToIds![type];\n  const handler = getAnnotationTypeRenderHandler(type);\n  const numBytes = handler.bytes;\n  let insertionPoint = binarySearch(ids, id, (a, b) => a < b ? -1 : a === b ? 0 : 1);\n  if (insertionPoint < 0) {\n    return false;\n  }\n  chunk.numPickIds -= handler.pickIdsPerInstance;\n  ids.splice(insertionPoint, 1);\n  const offset = chunk.typeToOffset![type] + handler.bytes * insertionPoint;\n  const newData = new Uint8Array(chunk.data!.length - numBytes);\n  newData.set(chunk.data!.subarray(0, offset), 0);\n  newData.set(chunk.data!.subarray(offset + numBytes), offset);\n  chunk.data = newData;\n  for (const otherType of annotationTypes) {\n    if (otherType > type) {\n      chunk.typeToOffset![otherType] -= numBytes;\n    }\n  }\n  chunk.bufferValid = false;\n  return true;\n}\n\ninterface LocalUpdateUndoState {\n  /**\n   * If commitInProgress === undefined, this must be undefined.  Otherwise, it specifies a commit\n   * that has been requested and which will be initiated as soon as the in-progress request\n   * completes.\n   */\n  pendingCommit: Annotation|null|undefined;\n\n  reference: Owned<AnnotationReference>;\n\n  /**\n   * The state of the annotation prior to any local modifications.\n   */\n  existingAnnotation: Annotation|undefined;\n\n  /**\n   * If not undefined, a commit has been sent to the backend, and we are waiting for the result.\n   */\n  commitInProgress: Annotation|null|undefined;\n  type: AnnotationType;\n}\n\nfunction makeTemporaryChunk() {\n  const typeToIds: string[][] = [];\n  const typeToOffset: number[] = [];\n  for (const annotationType of annotationTypes) {\n    typeToIds[annotationType] = [];\n    typeToOffset[annotationType] = 0;\n  }\n  return new AnnotationGeometryChunk(\n      <AnnotationGeometryChunkSource><any>undefined,\n      {data: new Uint8Array(0), numPickIds: 0, typeToOffset, typeToIds});\n}\n\nexport class MultiscaleAnnotationSource extends SharedObject implements\n    MultiscaleSliceViewChunkSource, AnnotationSourceSignals {\n  metadataChunkSource =\n      this.registerDisposer(new AnnotationMetadataChunkSource(this.chunkManager, this));\n  sources: Owned<AnnotationGeometryChunkSource>[][];\n  segmentFilteredSource: Owned<AnnotationSubsetGeometryChunkSource>;\n  objectToLocal = mat4.create();\n  constructor(public chunkManager: Borrowed<ChunkManager>, options: {\n    sourceSpecifications: {parameters: any, spec: AnnotationGeometryChunkSpecification}[][]\n  }) {\n    super();\n    this.sources = options.sourceSpecifications.map(\n        alternatives => alternatives.map(\n            ({parameters, spec}) => this.registerDisposer(new AnnotationGeometryChunkSource(\n                chunkManager, {spec, parameters, parent: this}))));\n    this.segmentFilteredSource =\n        this.registerDisposer(new AnnotationSubsetGeometryChunkSource(chunkManager, this));\n  }\n\n  getSources(_options: SliceViewSourceOptions): AnnotationGeometryChunkSource[][] {\n    const {sources} = this;\n    sources.forEach(alternatives => alternatives.forEach(source => source.addRef()));\n    return sources;\n  }\n\n  temporary = makeTemporaryChunk();\n\n  references = new Map<AnnotationId, Borrowed<AnnotationReference>>();\n\n  localUpdates = new Map<AnnotationId, LocalUpdateUndoState>();\n\n  initializeCounterpart(rpc: RPC, options: any) {\n    this.metadataChunkSource.initializeCounterpart(rpc, {});\n    for (const alternatives of this.sources) {\n      for (const source of alternatives) {\n        source.initializeCounterpart(rpc, {});\n      }\n    }\n    this.segmentFilteredSource.initializeCounterpart(rpc, {});\n    options.segmentFilteredSource = this.segmentFilteredSource.addCounterpartRef();\n    options.metadataChunkSource = this.metadataChunkSource.addCounterpartRef();\n    options.sources =\n        this.sources.map(alternatives => alternatives.map(source => source.addCounterpartRef()));\n    options.chunkManager = this.chunkManager.rpcId;\n    super.initializeCounterpart(rpc, options);\n  }\n\n  add(annotation: Annotation, commit: boolean = true): AnnotationReference {\n    annotation.id = makeAnnotationId();\n    const reference = new AnnotationReference(annotation.id);\n    reference.value = annotation;\n    this.references.set(reference.id, reference);\n    reference.registerDisposer(() => {\n      this.references.delete(reference.id);\n    });\n    this.applyLocalUpdate(\n        reference, /*existing=*/ false, /*commit=*/ commit, /*newAnnotation=*/ annotation);\n    return reference;\n  }\n\n  private applyLocalUpdate(\n      reference: Borrowed<AnnotationReference>, existing: boolean, commit: boolean,\n      newAnnotation: Annotation|null): void {\n    const {localUpdates} = this;\n    const {id} = reference;\n    let localUpdate = this.localUpdates.get(id);\n    const annotation = reference.value;\n    if (annotation == null) {\n      throw new Error(`Cannot create local update from null annotation`);\n    }\n    if (localUpdate === undefined) {\n      localUpdate = {\n        type: annotation.type,\n        reference: reference.addRef(),\n        existingAnnotation: existing ? annotation : undefined,\n        pendingCommit: undefined,\n        commitInProgress: undefined,\n      };\n      localUpdates.set(id, localUpdate);\n      this.forEachPossibleChunk(annotation, chunk => {\n        deleteAnnotation(chunk.data, annotation.type, id);\n      });\n      if (newAnnotation !== null) {\n        // Add to temporary chunk.\n        updateAnnotation(this.temporary.data, newAnnotation);\n      }\n    } else {\n      if (newAnnotation === null) {\n        // Annotation has a local update already, so we need to delete it from the temporary chunk.\n        deleteAnnotation(this.temporary.data, annotation.type, annotation.id);\n      } else {\n        // Modify existing entry in temporary chunk.\n        updateAnnotation(this.temporary.data, newAnnotation);\n      }\n      reference.value = newAnnotation;\n    }\n    if (commit) {\n      if (localUpdate.commitInProgress !== undefined) {\n        localUpdate.pendingCommit = newAnnotation;\n      } else {\n        if (newAnnotation === null && localUpdate.existingAnnotation === undefined) {\n          // Local update, which we would now like to delete, has never been committed.\n          // Therefore we can just delete it locally.\n          localUpdates.delete(id);\n          localUpdate.reference.dispose();\n          return;\n        }\n        this.sendCommitRequest(localUpdate, newAnnotation);\n      }\n    }\n    this.notifyChanged(reference.id, newAnnotation || undefined);\n  }\n\n  private sendCommitRequest(localUpdate: LocalUpdateUndoState, newAnnotation: Annotation|null) {\n    this.updateCommitsInProgress(1);\n    localUpdate.commitInProgress = newAnnotation;\n    this.rpc!.invoke(ANNOTATION_COMMIT_UPDATE_RPC_ID, {\n      id: this.rpcId,\n      annotationId: localUpdate.existingAnnotation && localUpdate.reference.id,\n      newAnnotation,\n    });\n  }\n\n  delete(reference: Borrowed<AnnotationReference>) {\n    this.applyLocalUpdate(reference, /*existing=*/ true, /*commit=*/ true, /*newAnnotation=*/ null);\n  }\n\n  update(reference: AnnotationReference, newAnnotation: Annotation) {\n    this.applyLocalUpdate(\n        reference, /*existing=*/ true, /*commit=*/ false, /*newAnnotation=*/ newAnnotation);\n  }\n\n  private notifyChanged(id: AnnotationId, annotation: Annotation|undefined) {\n    const reference = this.references.get(id);\n    const chunk = this.metadataChunkSource.chunks.get(id);\n    if (chunk !== undefined) {\n      chunk.annotation = annotation || null;\n    }\n    if (reference !== undefined) {\n      reference.value = annotation || null;\n      reference.changed.dispatch();\n    }\n    this.chunkManager.chunkQueueManager.visibleChunksChanged.dispatch();\n  }\n\n  /**\n   * Must be called after `add` or `update` to commit the result.\n   */\n  commit(reference: Borrowed<AnnotationReference>) {\n    this.applyLocalUpdate(reference, /*existing=*/ true, /*commit=*/ true, reference.value!);\n  }\n\n  getReference(id: AnnotationId): Owned<AnnotationReference> {\n    let existing = this.references.get(id);\n    if (existing !== undefined) {\n      return existing.addRef();\n    }\n    existing = new AnnotationReference(id);\n    this.references.set(id, existing);\n    this.rpc!.invoke(ANNOTATION_REFERENCE_ADD_RPC_ID, {id: this.rpcId, annotation: id});\n    existing.registerDisposer(() => {\n      this.references.delete(id);\n      this.rpc!.invoke(ANNOTATION_REFERENCE_DELETE_RPC_ID, {id: this.rpcId, annotation: id});\n    });\n    const chunk = this.metadataChunkSource.chunks.get(id);\n    if (chunk !== undefined) {\n      existing.value = chunk.annotation;\n    }\n    return existing;\n  }\n\n  private forEachPossibleChunk(\n      annotation: Annotation,\n      callback: (chunk: AnnotationGeometryChunk|AnnotationSubsetGeometryChunk) => void) {\n    const {sources} = this;\n    if (sources.length !== 1 || sources[0].length !== 1) {\n      throw new Error('Not implemented');\n    }\n    const source = sources[0][0];\n    if (source.chunks.size > 1) {\n      throw new Error('Not implemented');\n    }\n    annotation;\n    for (const chunk of source.chunks.values()) {\n      callback(chunk);\n    }\n\n    const {segments} = annotation;\n    if (segments === undefined || segments.length === 0) {\n      return;\n    }\n    const {segmentFilteredSource} = this;\n    for (const segment of segments) {\n      const chunk = segmentFilteredSource.chunks.get(getObjectKey(segment));\n      if (chunk === undefined) {\n        continue;\n      }\n      callback(chunk);\n    }\n  }\n\n  static encodeOptions(_options: {}): {[key: string]: any} {\n    return {};\n  }\n\n  handleSuccessfulUpdate(id: AnnotationId, newAnnotation: Annotation|null) {\n    const localUpdate = this.localUpdates.get(id);\n    if (localUpdate === undefined || localUpdate.commitInProgress === undefined) {\n      throw new Error(`Received invalid successful update notification`);\n    }\n    this.updateCommitsInProgress(-1);\n    if (newAnnotation !== null && localUpdate.reference.id !== newAnnotation.id) {\n      if (localUpdate.commitInProgress === null) {\n        throw new Error(`Received invalid successful update notification`);\n      }\n      localUpdate.reference.id = newAnnotation.id;\n      this.references.delete(id);\n      this.references.set(newAnnotation.id, localUpdate.reference);\n      this.localUpdates.delete(id);\n      this.localUpdates.set(newAnnotation.id, localUpdate);\n      if (localUpdate.reference.value !== null) {\n        localUpdate.reference.value!.id = newAnnotation.id;\n        deleteAnnotation(this.temporary.data, localUpdate.type, id);\n        updateAnnotation(this.temporary.data, localUpdate.reference.value!);\n      }\n      localUpdate.reference.changed.dispatch();\n    }\n    localUpdate.existingAnnotation = newAnnotation || undefined;\n    localUpdate.commitInProgress = undefined;\n    let {pendingCommit} = localUpdate;\n    localUpdate.pendingCommit = undefined;\n    if (newAnnotation === null) {\n      pendingCommit = undefined;\n    }\n    if (pendingCommit !== undefined) {\n      if (pendingCommit !== null) {\n        pendingCommit.id = newAnnotation!.id;\n      }\n      this.sendCommitRequest(localUpdate, pendingCommit);\n    } else {\n      this.revertLocalUpdate(localUpdate);\n    }\n  }\n\n  private numCommitsInProgress = 0;\n\n  private commitStatus: StatusMessage|undefined;\n\n  disposed() {\n    const {commitStatus} = this;\n    if (commitStatus !== undefined) {\n      commitStatus.dispose();\n    }\n  }\n\n  private updateCommitsInProgress(amount: number) {\n    this.numCommitsInProgress += amount;\n    if (this.numCommitsInProgress === 0) {\n      if (this.commitStatus !== undefined) {\n        this.commitStatus.dispose();\n        this.commitStatus = undefined;\n      }\n    } else if (this.commitStatus === undefined) {\n      const status = this.commitStatus = new StatusMessage(/*delay=*/ true);\n      status.setText('Commiting annotations');\n    }\n  }\n\n  handleFailedUpdate(id: AnnotationId, message: string) {\n    const localUpdate = this.localUpdates.get(id);\n    if (localUpdate === undefined || localUpdate.commitInProgress === undefined) {\n      throw new Error(`Received invalid update notification`);\n    }\n    const status = new StatusMessage();\n    status.setErrorMessage(`Error commiting annotation update: ${message}`);\n    this.revertLocalUpdate(localUpdate);\n    this.updateCommitsInProgress(-1);\n  }\n\n  private revertLocalUpdate(localUpdate: LocalUpdateUndoState) {\n    deleteAnnotation(this.temporary.data, localUpdate.type, localUpdate.reference.id);\n    const {existingAnnotation} = localUpdate;\n    if (existingAnnotation !== undefined) {\n      this.forEachPossibleChunk(existingAnnotation, chunk => {\n        updateAnnotation(chunk.data, existingAnnotation);\n      });\n    }\n    const {reference} = localUpdate;\n    const {id} = reference;\n\n    reference.value = existingAnnotation || null;\n    reference.changed.dispatch();\n\n    reference.dispose();\n\n    this.localUpdates.delete(id);\n  }\n\n  // FIXME\n  changed = new NullarySignal();\n  * [Symbol.iterator](): Iterator<Annotation> {}\n  readonly = false;\n  childAdded: Signal<(annotation: Annotation) => void>;\n  childUpdated: Signal<(annotation: Annotation) => void>;\n  childDeleted: Signal<(annotationId: string) => void>;\n}\n\nregisterRPC(ANNOTATION_COMMIT_UPDATE_RESULT_RPC_ID, function(x) {\n  const source = <MultiscaleAnnotationSource>this.get(x.id);\n  const annotationId: AnnotationId = x.annotationId;\n  const error: string|undefined = x.error;\n  if (error !== undefined) {\n    source.handleFailedUpdate(annotationId, error);\n  } else {\n    const newAnnotation: Annotation|null = deserializeAnnotation(x.newAnnotation);\n    source.handleSuccessfulUpdate(annotationId, newAnnotation);\n  }\n});\n\nexport class DataFetchSliceViewRenderLayer extends RenderLayer {\n  sources: AnnotationGeometryChunkSource[][];\n\n  constructor(multiscaleSource: MultiscaleAnnotationSource) {\n    super(multiscaleSource.chunkManager, multiscaleSource.getSources({}), {});\n  }\n\n  // Does nothing.\n  draw() {}\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Basic annotation data structures.\n */\n\nimport {Borrowed, RefCounted} from 'neuroglancer/util/disposable';\nimport {mat4, vec3} from 'neuroglancer/util/geom';\nimport {parseArray, verify3dScale, verify3dVec, verifyEnumString, verifyObject, verifyObjectProperty, verifyOptionalString, verifyString} from 'neuroglancer/util/json';\nimport {getRandomHexString} from 'neuroglancer/util/random';\nimport {Signal, NullarySignal} from 'neuroglancer/util/signal';\nimport {Uint64} from 'neuroglancer/util/uint64';\nexport type AnnotationId = string;\n\nexport class AnnotationReference extends RefCounted {\n  changed = new NullarySignal();\n\n  /**\n   * If `undefined`, we are still waiting to look up the result.  If `null`, annotation has been\n   * deleted.\n   */\n  value: Annotation|null|undefined;\n\n  constructor(public id: AnnotationId) {\n    super();\n  }\n}\n\nexport enum AnnotationType {\n  POINT,\n  LINE,\n  AXIS_ALIGNED_BOUNDING_BOX,\n  ELLIPSOID,\n}\n\nexport const annotationTypes = [\n  AnnotationType.POINT,\n  AnnotationType.LINE,\n  AnnotationType.AXIS_ALIGNED_BOUNDING_BOX,\n  AnnotationType.ELLIPSOID,\n];\n\nexport interface AnnotationBase {\n  /**\n   * If equal to `undefined`, then the description is unknown (possibly still being loaded).  If\n   * equal to `null`, then there is no description.\n   */\n  description?: string|undefined|null;\n\n  id: AnnotationId;\n  type: AnnotationType;\n\n  segments?: Uint64[];\n}\n\nexport interface Line extends AnnotationBase {\n  pointA: vec3;\n  pointB: vec3;\n  type: AnnotationType.LINE;\n}\n\nexport interface Point extends AnnotationBase {\n  point: vec3;\n  type: AnnotationType.POINT;\n}\n\nexport interface AxisAlignedBoundingBox extends AnnotationBase {\n  pointA: vec3;\n  pointB: vec3;\n  type: AnnotationType.AXIS_ALIGNED_BOUNDING_BOX;\n}\n\nexport interface Ellipsoid extends AnnotationBase {\n  center: vec3;\n  radii: vec3;\n  type: AnnotationType.ELLIPSOID;\n}\n\nexport type Annotation = Line|Point|AxisAlignedBoundingBox|Ellipsoid;\n\nexport interface AnnotationTypeHandler<T extends Annotation> {\n  icon: string;\n  description: string;\n  toJSON: (annotation: T) => any;\n  restoreState: (annotation: T, obj: any) => void;\n  serializedBytes: number;\n  serializer:\n      (buffer: ArrayBuffer, offset: number,\n       numAnnotations: number) => ((annotation: T, index: number) => void);\n}\n\nconst typeHandlers = new Map<AnnotationType, AnnotationTypeHandler<Annotation>>();\nexport function getAnnotationTypeHandler(type: AnnotationType) {\n  return typeHandlers.get(type)!;\n}\n\ntypeHandlers.set(AnnotationType.LINE, {\n  icon: '',\n  description: 'Line',\n  toJSON: (annotation: Line) => {\n    return {\n      pointA: Array.from(annotation.pointA),\n      pointB: Array.from(annotation.pointB),\n    };\n  },\n  restoreState: (annotation: Line, obj: any) => {\n    annotation.pointA = verifyObjectProperty(obj, 'pointA', verify3dVec);\n    annotation.pointB = verifyObjectProperty(obj, 'pointB', verify3dVec);\n  },\n  serializedBytes: 6 * 4,\n  serializer: (buffer: ArrayBuffer, offset: number, numAnnotations: number) => {\n    const coordinates = new Float32Array(buffer, offset, numAnnotations * 6);\n    return (annotation: Line, index: number) => {\n      const {pointA, pointB} = annotation;\n      const coordinateOffset = index * 6;\n      coordinates[coordinateOffset] = pointA[0];\n      coordinates[coordinateOffset + 1] = pointA[1];\n      coordinates[coordinateOffset + 2] = pointA[2];\n      coordinates[coordinateOffset + 3] = pointB[0];\n      coordinates[coordinateOffset + 4] = pointB[1];\n      coordinates[coordinateOffset + 5] = pointB[2];\n    };\n  },\n});\n\ntypeHandlers.set(AnnotationType.POINT, {\n  icon: '',\n  description: 'Point',\n  toJSON: (annotation: Point) => {\n    return {\n      point: Array.from(annotation.point),\n    };\n  },\n  restoreState: (annotation: Point, obj: any) => {\n    annotation.point = verifyObjectProperty(obj, 'point', verify3dVec);\n  },\n  serializedBytes: 3 * 4,\n  serializer: (buffer: ArrayBuffer, offset: number, numAnnotations: number) => {\n    const coordinates = new Float32Array(buffer, offset, numAnnotations * 3);\n    return (annotation: Point, index: number) => {\n      const {point} = annotation;\n      const coordinateOffset = index * 3;\n      coordinates[coordinateOffset] = point[0];\n      coordinates[coordinateOffset + 1] = point[1];\n      coordinates[coordinateOffset + 2] = point[2];\n    };\n  },\n});\n\ntypeHandlers.set(AnnotationType.AXIS_ALIGNED_BOUNDING_BOX, {\n  icon: '',\n  description: 'Bounding Box',\n  toJSON: (annotation: AxisAlignedBoundingBox) => {\n    return {\n      pointA: Array.from(annotation.pointA),\n      pointB: Array.from(annotation.pointB),\n    };\n  },\n  restoreState: (annotation: AxisAlignedBoundingBox, obj: any) => {\n    annotation.pointA = verifyObjectProperty(obj, 'pointA', verify3dVec);\n    annotation.pointB = verifyObjectProperty(obj, 'pointB', verify3dVec);\n  },\n  serializedBytes: 6 * 4,\n  serializer: (buffer: ArrayBuffer, offset: number, numAnnotations: number) => {\n    const coordinates = new Float32Array(buffer, offset, numAnnotations * 6);\n    return (annotation: AxisAlignedBoundingBox, index: number) => {\n      const {pointA, pointB} = annotation;\n      const coordinateOffset = index * 6;\n      coordinates[coordinateOffset] = Math.min(pointA[0], pointB[0]);\n      coordinates[coordinateOffset + 1] = Math.min(pointA[1], pointB[1]);\n      coordinates[coordinateOffset + 2] = Math.min(pointA[2], pointB[2]);\n      coordinates[coordinateOffset + 3] = Math.max(pointA[0], pointB[0]);\n      coordinates[coordinateOffset + 4] = Math.max(pointA[1], pointB[1]);\n      coordinates[coordinateOffset + 5] = Math.max(pointA[2], pointB[2]);\n    };\n  },\n});\n\ntypeHandlers.set(AnnotationType.ELLIPSOID, {\n  icon: '',\n  description: 'Ellipsoid',\n  toJSON: (annotation: Ellipsoid) => {\n    return {\n      center: Array.from(annotation.center),\n      radii: Array.from(annotation.radii),\n    };\n  },\n  restoreState: (annotation: Ellipsoid, obj: any) => {\n    annotation.center = verifyObjectProperty(obj, 'center', verify3dVec);\n    annotation.radii = verifyObjectProperty(obj, 'radii', verify3dScale);\n  },\n  serializedBytes: 6 * 4,\n  serializer: (buffer: ArrayBuffer, offset: number, numAnnotations: number) => {\n    const coordinates = new Float32Array(buffer, offset, numAnnotations * 6);\n    return (annotation: Ellipsoid, index: number) => {\n      const {center, radii} = annotation;\n      const coordinateOffset = index * 6;\n      coordinates.set(center, coordinateOffset);\n      coordinates.set(radii, coordinateOffset + 3);\n    };\n  },\n});\n\nexport function annotationToJson(annotation: Annotation) {\n  const result = getAnnotationTypeHandler(annotation.type).toJSON(annotation);\n  result.type = AnnotationType[annotation.type].toLowerCase();\n  result.id = annotation.id;\n  result.description = annotation.description || undefined;\n  const {segments} = annotation;\n  if (segments !== undefined && segments.length > 0) {\n    result.segments = segments.map(x => x.toString());\n  }\n  return result;\n}\n\nexport function restoreAnnotation(obj: any, allowMissingId = false): Annotation {\n  verifyObject(obj);\n  const type = verifyObjectProperty(obj, 'type', x => verifyEnumString(x, AnnotationType));\n  const id =\n      verifyObjectProperty(obj, 'id', allowMissingId ? verifyOptionalString : verifyString) ||\n      makeAnnotationId();\n  const result: Annotation = <any>{\n    id,\n    description: verifyObjectProperty(obj, 'description', verifyOptionalString),\n    segments: verifyObjectProperty(\n        obj, 'segments',\n        x => x === undefined ? undefined : parseArray(x, y => Uint64.parseString(y))),\n    type,\n  };\n  getAnnotationTypeHandler(type).restoreState(result, obj);\n  return result;\n}\n\nexport interface AnnotationSourceSignals {\n  changed:NullarySignal;\n  childAdded:Signal<(annotation: Annotation) => void>;\n  childUpdated:Signal<(annotation: Annotation) => void>;\n  childDeleted:Signal<(annotationId: string) => void>;\n}\n\nexport class AnnotationSource extends RefCounted implements AnnotationSourceSignals {\n  private annotationMap = new Map<AnnotationId, Annotation>();\n  changed = new NullarySignal();\n  readonly = false;\n  childAdded = new Signal<(annotation: Annotation) => void>();\n  childUpdated = new Signal<(annotation: Annotation) => void>();\n  childDeleted = new Signal<(annotationId: string) => void>();\n\n  private pending = new Set<AnnotationId>();\n\n  constructor(public objectToLocal = mat4.create()) {\n    super();\n  }\n\n  add(annotation: Annotation, commit: boolean = true): AnnotationReference {\n    if (!annotation.id) {\n      annotation.id = makeAnnotationId();\n    } else if (this.annotationMap.has(annotation.id)) {\n      throw new Error(`Annotation id already exists: ${JSON.stringify(annotation.id)}.`);\n    }\n    this.annotationMap.set(annotation.id, annotation);\n    this.changed.dispatch();\n    this.childAdded.dispatch(annotation);\n    if (!commit) {\n      this.pending.add(annotation.id);\n    }\n    return this.getReference(annotation.id);\n  }\n\n  commit(reference: AnnotationReference): void {\n    const id = reference.id;\n    this.pending.delete(id);\n  }\n\n  update(reference: AnnotationReference, annotation: Annotation) {\n    if (reference.value === null) {\n      throw new Error(`Annotation already deleted.`);\n    }\n    reference.value = annotation;\n    this.annotationMap.set(annotation.id, annotation);\n    reference.changed.dispatch();\n    this.changed.dispatch();\n    this.childUpdated.dispatch(annotation);\n  }\n\n  [Symbol.iterator]() {\n    return this.annotationMap.values();\n  }\n\n  get(id: AnnotationId) {\n    return this.annotationMap.get(id);\n  }\n\n  delete(reference: AnnotationReference) {\n    if (reference.value === null) {\n      return;\n    }\n    reference.value = null;\n    this.annotationMap.delete(reference.id);\n    this.pending.delete(reference.id);\n    reference.changed.dispatch();\n    this.changed.dispatch();\n    this.childDeleted.dispatch(reference.id);\n  }\n\n  getReference(id: AnnotationId): AnnotationReference {\n    let existing = this.references.get(id);\n    if (existing !== undefined) {\n      return existing.addRef();\n    }\n    existing = new AnnotationReference(id);\n    existing.value = this.annotationMap.get(id) || null;\n    this.references.set(id, existing);\n    existing.registerDisposer(() => {\n      this.references.delete(id);\n    });\n    return existing;\n  }\n\n  references = new Map<AnnotationId, Borrowed<AnnotationReference>>();\n\n  toJSON() {\n    const result: any[] = [];\n    const {pending} = this;\n    for (const annotation of this) {\n      if (pending.has(annotation.id)) {\n        // Don't serialize uncommitted annotations.\n        continue;\n      }\n      result.push(annotationToJson(annotation));\n    }\n    return result;\n  }\n\n  clear() {\n    this.annotationMap.clear();\n    this.pending.clear();\n    this.changed.dispatch();\n  }\n\n  restoreState(obj: any) {\n    const {annotationMap} = this;\n    annotationMap.clear();\n    this.pending.clear();\n    if (obj !== undefined) {\n      parseArray(obj, x => {\n        const annotation = restoreAnnotation(x);\n        annotationMap.set(annotation.id, annotation);\n      });\n    }\n    for (const reference of this.references.values()) {\n      const {id} = reference;\n      const value = annotationMap.get(id);\n      reference.value = value || null;\n      reference.changed.dispatch();\n    }\n    this.changed.dispatch();\n  }\n\n  reset() {\n    this.clear();\n  }\n}\n\nexport class LocalAnnotationSource extends AnnotationSource {}\n\nexport const DATA_BOUNDS_DESCRIPTION = 'Data Bounds';\n\nexport function makeAnnotationId() {\n  return getRandomHexString(160);\n}\n\nexport function makeDataBoundsBoundingBox(\n    lowerVoxelBound: vec3, upperVoxelBound: vec3): AxisAlignedBoundingBox {\n  return {\n    type: AnnotationType.AXIS_ALIGNED_BOUNDING_BOX,\n    id: 'data-bounds',\n    description: DATA_BOUNDS_DESCRIPTION,\n    pointA: lowerVoxelBound,\n    pointB: upperVoxelBound\n  };\n}\n\nfunction compare3WayById(a: Annotation, b: Annotation) {\n  return a.id < b.id ? -1 : a.id === b.id ? 0 : 1;\n}\n\nexport interface SerializedAnnotations {\n  data: Uint8Array;\n  typeToIds: string[][];\n  typeToOffset: number[];\n  segmentListIndex: Uint32Array;\n  segmentList: Uint32Array;\n}\n\nexport function serializeAnnotations(allAnnotations: Annotation[][]): SerializedAnnotations {\n  let totalBytes = 0;\n  const typeToOffset: number[] = [];\n  const typeToSegmentListIndexOffset: number[] = [];\n  let totalNumSegments = 0;\n  let totalNumAnnotations = 0;\n  for (const annotationType of annotationTypes) {\n    typeToOffset[annotationType] = totalBytes;\n    typeToSegmentListIndexOffset[annotationType] = totalNumAnnotations;\n    const annotations: Annotation[] = allAnnotations[annotationType];\n    let numSegments = 0;\n    for (const annotation of annotations) {\n      const {segments} = annotation;\n      if (segments !== undefined) {\n        numSegments += segments.length;\n      }\n    }\n    totalNumAnnotations += annotations.length;\n    totalNumSegments += numSegments;\n    annotations.sort(compare3WayById);\n    const count = annotations.length;\n    const handler = getAnnotationTypeHandler(annotationType);\n    totalBytes += handler.serializedBytes * count;\n  }\n  const segmentListIndex = new Uint32Array(totalNumAnnotations + 1);\n  const segmentList = new Uint32Array(totalNumSegments * 2);\n  const typeToIds: string[][] = [];\n  const data = new ArrayBuffer(totalBytes);\n  let segmentListOffset = 0;\n  let segmentListIndexOffset = 0;\n  for (const annotationType of annotationTypes) {\n    const annotations: Annotation[] = allAnnotations[annotationType];\n    typeToIds[annotationType] = annotations.map(x => x.id);\n    const count = annotations.length;\n    const handler = getAnnotationTypeHandler(annotationType);\n    const serializer = handler.serializer(data, typeToOffset[annotationType], count);\n    annotations.forEach((annotation, index) => {\n      serializer(annotation, index);\n      segmentListIndex[segmentListIndexOffset++] = segmentListOffset;\n      const {segments} = annotation;\n      if (segments !== undefined) {\n        for (const segment of segments) {\n          segmentList[segmentListOffset * 2] = segment.low;\n          segmentList[segmentListOffset * 2 + 1] = segment.high;\n          ++segmentListOffset;\n        }\n      }\n    });\n  }\n  return {data: new Uint8Array(data), typeToIds, typeToOffset, segmentListIndex, segmentList};\n}\n\nexport class AnnotationSerializer {\n  annotations: [Point[], Line[], AxisAlignedBoundingBox[], Ellipsoid[]] = [[], [], [], []];\n  add(annotation: Annotation) {\n    (<Annotation[]>this.annotations[annotation.type]).push(annotation);\n  }\n  serialize() {\n    return serializeAnnotations(this.annotations);\n  }\n}\n\nexport function deserializeAnnotation(obj: any) {\n  if (obj == null) {\n    return obj;\n  }\n  const segments = obj.segments;\n  if (segments !== undefined) {\n    obj.segments = segments.map((x: {low: number, high: number}) => new Uint64(x.low, x.high));\n  }\n  return obj;\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Support for rendering line annotations.\n */\n\nimport {AnnotationType, Line} from 'neuroglancer/annotation';\nimport {AnnotationRenderContext, AnnotationRenderHelper, registerAnnotationTypeRenderHandler} from 'neuroglancer/annotation/type_handler';\nimport {tile2dArray} from 'neuroglancer/util/array';\nimport {mat4, projectPointToLineSegment, vec3} from 'neuroglancer/util/geom';\nimport {getMemoizedBuffer} from 'neuroglancer/webgl/buffer';\nimport {CircleShader, VERTICES_PER_CIRCLE} from 'neuroglancer/webgl/circles';\nimport {LineShader} from 'neuroglancer/webgl/lines';\nimport {emitterDependentShaderGetter, ShaderBuilder, ShaderProgram} from 'neuroglancer/webgl/shader';\n\nconst FULL_OBJECT_PICK_OFFSET = 0;\nconst ENDPOINTS_PICK_OFFSET = FULL_OBJECT_PICK_OFFSET + 1;\nconst PICK_IDS_PER_INSTANCE = ENDPOINTS_PICK_OFFSET + 2;\n\nfunction getEndpointIndexArray() {\n  return tile2dArray(\n      new Uint8Array([0, 1]), /*majorDimension=*/ 1, /*minorTiles=*/ 1,\n      /*majorTiles=*/ VERTICES_PER_CIRCLE);\n}\n\nclass RenderHelper extends AnnotationRenderHelper {\n  private lineShader = this.registerDisposer(new LineShader(this.gl, 1));\n  private circleShader = this.registerDisposer(new CircleShader(this.gl, 2));\n\n  defineShader(builder: ShaderBuilder) {\n    super.defineShader(builder);\n    // Position of endpoints in camera coordinates.\n    builder.addAttribute('highp vec3', 'aEndpointA');\n    builder.addAttribute('highp vec3', 'aEndpointB');\n  }\n\n  private edgeShaderGetter =\n      emitterDependentShaderGetter(this, this.gl, (builder: ShaderBuilder) => {\n        this.defineShader(builder);\n        this.lineShader.defineShader(builder);\n        builder.setVertexMain(`\nemitLine(uProjection, aEndpointA, aEndpointB);\n${this.setPartIndex(builder)};\n`);\n        builder.setFragmentMain(`\nemitAnnotation(vec4(vColor.rgb, vColor.a * getLineAlpha() * ${this.getCrossSectionFadeFactor()}));\n`);\n      });\n\n  private endpointIndexBuffer =\n      this\n          .registerDisposer(getMemoizedBuffer(\n              this.gl, WebGL2RenderingContext.ARRAY_BUFFER, getEndpointIndexArray))\n          .value;\n\n  private endpointShaderGetter =\n      emitterDependentShaderGetter(this, this.gl, (builder: ShaderBuilder) => {\n        this.defineShader(builder);\n        this.circleShader.defineShader(builder, this.targetIsSliceView);\n        builder.addAttribute('highp uint', 'aEndpointIndex');\n        builder.setVertexMain(`\nvec3 vertexPosition = mix(aEndpointA, aEndpointB, float(aEndpointIndex));\nemitCircle(uProjection * vec4(vertexPosition, 1.0));\n${this.setPartIndex(builder, 'aEndpointIndex + 1u')};\n`);\n        builder.setFragmentMain(`\nvec4 borderColor = vec4(0.0, 0.0, 0.0, 1.0);\nemitAnnotation(getCircleColor(vColor, borderColor));\n`);\n      });\n\n  enable(shader: ShaderProgram, context: AnnotationRenderContext, callback: () => void) {\n    super.enable(shader, context, () => {\n      const {gl} = shader;\n      const aLower = shader.attribute('aEndpointA');\n      const aUpper = shader.attribute('aEndpointB');\n\n      context.buffer.bindToVertexAttrib(\n          aLower, /*components=*/ 3, /*attributeType=*/ WebGL2RenderingContext.FLOAT,\n          /*normalized=*/ false,\n          /*stride=*/ 4 * 6, /*offset=*/ context.bufferOffset);\n      context.buffer.bindToVertexAttrib(\n          aUpper, /*components=*/ 3, /*attributeType=*/ WebGL2RenderingContext.FLOAT,\n          /*normalized=*/ false,\n          /*stride=*/ 4 * 6, /*offset=*/ context.bufferOffset + 4 * 3);\n\n      gl.vertexAttribDivisor(aLower, 1);\n      gl.vertexAttribDivisor(aUpper, 1);\n      callback();\n      gl.vertexAttribDivisor(aLower, 0);\n      gl.vertexAttribDivisor(aUpper, 0);\n      gl.disableVertexAttribArray(aLower);\n      gl.disableVertexAttribArray(aUpper);\n    });\n  }\n\n  drawEdges(context: AnnotationRenderContext) {\n    const shader = this.edgeShaderGetter(context.renderContext.emitter);\n    this.enable(shader, context, () => {\n      this.lineShader.draw(shader, context.renderContext, /*lineWidth=*/ 1, 1.0, context.count);\n    });\n  }\n\n  drawEndpoints(context: AnnotationRenderContext) {\n    const shader = this.endpointShaderGetter(context.renderContext.emitter);\n    this.enable(shader, context, () => {\n      const aEndpointIndex = shader.attribute('aEndpointIndex');\n      this.endpointIndexBuffer.bindToVertexAttribI(\n          aEndpointIndex, /*components=*/ 1,\n          /*attributeType=*/ WebGL2RenderingContext.UNSIGNED_BYTE);\n      this.circleShader.draw(\n          shader, context.renderContext,\n          {interiorRadiusInPixels: 6, borderWidthInPixels: 2, featherWidthInPixels: 1},\n          context.count);\n      shader.gl.disableVertexAttribArray(aEndpointIndex);\n    });\n  }\n\n  draw(context: AnnotationRenderContext) {\n    this.drawEdges(context);\n    this.drawEndpoints(context);\n  }\n}\n\nfunction snapPositionToLine(position: vec3, objectToData: mat4, endpoints: Float32Array) {\n  const cornerA = vec3.transformMat4(vec3.create(), <vec3>endpoints.subarray(0, 3), objectToData);\n  const cornerB = vec3.transformMat4(vec3.create(), <vec3>endpoints.subarray(3, 6), objectToData);\n  projectPointToLineSegment(position, cornerA, cornerB, position);\n}\n\nfunction snapPositionToEndpoint(\n    position: vec3, objectToData: mat4, endpoints: Float32Array, endpointIndex: number) {\n  const startOffset = 3 * endpointIndex;\n  const point = <vec3>endpoints.subarray(startOffset, startOffset + 3);\n  vec3.transformMat4(position, point, objectToData);\n}\n\nregisterAnnotationTypeRenderHandler(AnnotationType.LINE, {\n  bytes: 6 * 4,\n  serializer: (buffer: ArrayBuffer, offset: number, numAnnotations: number) => {\n    const coordinates = new Float32Array(buffer, offset, numAnnotations * 6);\n    return (annotation: Line, index: number) => {\n      const {pointA, pointB} = annotation;\n      const coordinateOffset = index * 6;\n      coordinates[coordinateOffset] = pointA[0];\n      coordinates[coordinateOffset + 1] = pointA[1];\n      coordinates[coordinateOffset + 2] = pointA[2];\n      coordinates[coordinateOffset + 3] = pointB[0];\n      coordinates[coordinateOffset + 4] = pointB[1];\n      coordinates[coordinateOffset + 5] = pointB[2];\n    };\n  },\n  sliceViewRenderHelper: RenderHelper,\n  perspectiveViewRenderHelper: RenderHelper,\n  pickIdsPerInstance: PICK_IDS_PER_INSTANCE,\n  snapPosition: (position, objectToData, data, offset, partIndex) => {\n    const endpoints = new Float32Array(data, offset, 6);\n    if (partIndex === FULL_OBJECT_PICK_OFFSET) {\n      snapPositionToLine(position, objectToData, endpoints);\n    } else {\n      snapPositionToEndpoint(position, objectToData, endpoints, partIndex - ENDPOINTS_PICK_OFFSET);\n    }\n  },\n  getRepresentativePoint: (objectToData, ann, partIndex) => {\n    let repPoint = vec3.create();\n    // if the full object is selected just pick the first point as representative\n    if (partIndex === FULL_OBJECT_PICK_OFFSET) {\n      vec3.transformMat4(repPoint, ann.pointA, objectToData);\n    } else {\n      if ((partIndex - ENDPOINTS_PICK_OFFSET) === 0) {\n        vec3.transformMat4(repPoint, ann.pointA, objectToData);\n      } else {\n        vec3.transformMat4(repPoint, ann.pointB, objectToData);\n      }\n    }\n    return repPoint;\n  },\n  updateViaRepresentativePoint: (oldAnnotation, position, dataToObject, partIndex) => {\n    let newPt = vec3.transformMat4(vec3.create(), position, dataToObject);\n    let baseLine = {...oldAnnotation};\n    switch (partIndex) {\n      case FULL_OBJECT_PICK_OFFSET:\n        let delta = vec3.sub(vec3.create(), oldAnnotation.pointB, oldAnnotation.pointA);\n        baseLine.pointA = newPt;\n        baseLine.pointB = vec3.add(vec3.create(), newPt, delta);\n        break;\n      case FULL_OBJECT_PICK_OFFSET + 1:\n        baseLine.pointA = newPt;\n        baseLine.pointB = oldAnnotation.pointB;\n        break;\n      case FULL_OBJECT_PICK_OFFSET + 2:\n        baseLine.pointA = oldAnnotation.pointA;\n        baseLine.pointB = newPt;\n    }\n    return baseLine;\n  }\n});\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Support for rendering point annotations.\n */\n\nimport {AnnotationType, Point} from 'neuroglancer/annotation';\nimport {AnnotationRenderContext, AnnotationRenderHelper, registerAnnotationTypeRenderHandler} from 'neuroglancer/annotation/type_handler';\nimport {mat4, vec3} from 'neuroglancer/util/geom';\nimport {CircleShader} from 'neuroglancer/webgl/circles';\nimport {emitterDependentShaderGetter, ShaderBuilder} from 'neuroglancer/webgl/shader';\n\nclass RenderHelper extends AnnotationRenderHelper {\n  private circleShader = this.registerDisposer(new CircleShader(this.gl));\n  private shaderGetter =\n      emitterDependentShaderGetter(this, this.gl, (builder: ShaderBuilder) => this.defineShader(builder));\n\n  defineShader(builder: ShaderBuilder) {\n    super.defineShader(builder);\n    this.circleShader.defineShader(builder, /*crossSectionFade=*/this.targetIsSliceView);\n    // Position of point in camera coordinates.\n    builder.addAttribute('highp vec3', 'aVertexPosition');\n    builder.setVertexMain(`\nemitCircle(uProjection * vec4(aVertexPosition, 1.0));\n${this.setPartIndex(builder)};\n`);\n    builder.setFragmentMain(`\nvec4 borderColor = vec4(0.0, 0.0, 0.0, 1.0);\nemitAnnotation(getCircleColor(vColor, borderColor));\n`);\n  }\n\n  draw(context: AnnotationRenderContext) {\n    const shader = this.shaderGetter(context.renderContext.emitter);\n    this.enable(shader, context, () => {\n      const {gl} = this;\n      const aVertexPosition = shader.attribute('aVertexPosition');\n      context.buffer.bindToVertexAttrib(\n          aVertexPosition, /*components=*/3, /*attributeType=*/WebGL2RenderingContext.FLOAT,\n          /*normalized=*/false,\n          /*stride=*/0, /*offset=*/context.bufferOffset);\n      gl.vertexAttribDivisor(aVertexPosition, 1);\n      this.circleShader.draw(\n          shader, context.renderContext,\n          {interiorRadiusInPixels: 6, borderWidthInPixels: 2, featherWidthInPixels: 1},\n          context.count);\n      gl.vertexAttribDivisor(aVertexPosition, 0);\n      gl.disableVertexAttribArray(aVertexPosition);\n    });\n  }\n}\n\nregisterAnnotationTypeRenderHandler(AnnotationType.POINT, {\n  bytes: 3 * 4,\n  serializer: (buffer: ArrayBuffer, offset: number, numAnnotations: number) => {\n    const coordinates = new Float32Array(buffer, offset, numAnnotations * 3);\n    return (annotation: Point, index: number) => {\n      const {point} = annotation;\n      const coordinateOffset = index * 3;\n      coordinates[coordinateOffset] = point[0];\n      coordinates[coordinateOffset + 1] = point[1];\n      coordinates[coordinateOffset + 2] = point[2];\n    };\n  },\n  sliceViewRenderHelper: RenderHelper,\n  perspectiveViewRenderHelper: RenderHelper,\n  pickIdsPerInstance: 1,\n  snapPosition: (position: vec3, objectToData, data, offset) => {\n    vec3.transformMat4(position, <vec3>new Float32Array(data, offset, 3), objectToData);\n  },\n  getRepresentativePoint: (objectToData, ann) => {\n    let repPoint = vec3.create();\n    vec3.transformMat4(repPoint, ann.point, objectToData);\n    return repPoint;\n  },\n  updateViaRepresentativePoint: (oldAnnotation: Point, position: vec3, dataToObject: mat4) => {\n    let annotation = {...oldAnnotation};\n    annotation.point = vec3.transformMat4(vec3.create(), position, dataToObject);\n    // annotation.id = '';\n    return annotation;\n  }\n});\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport 'neuroglancer/annotation/bounding_box';\nimport 'neuroglancer/annotation/line';\nimport 'neuroglancer/annotation/point';\nimport 'neuroglancer/annotation/ellipsoid';\n\nimport {AnnotationBase, AnnotationSource, annotationTypes} from 'neuroglancer/annotation';\nimport {AnnotationLayerState} from 'neuroglancer/annotation/annotation_layer_state';\nimport {ANNOTATION_PERSPECTIVE_RENDER_LAYER_RPC_ID, ANNOTATION_RENDER_LAYER_RPC_ID, ANNOTATION_RENDER_LAYER_UPDATE_SEGMENTATION_RPC_ID} from 'neuroglancer/annotation/base';\nimport {AnnotationGeometryData, MultiscaleAnnotationSource} from 'neuroglancer/annotation/frontend_source';\nimport {AnnotationRenderContext, AnnotationRenderHelper, getAnnotationTypeRenderHandler} from 'neuroglancer/annotation/type_handler';\nimport {ChunkState} from 'neuroglancer/chunk_manager/base';\nimport {ChunkManager} from 'neuroglancer/chunk_manager/frontend';\nimport {MouseSelectionState, VisibilityTrackedRenderLayer} from 'neuroglancer/layer';\nimport {PerspectiveViewRenderContext, PerspectiveViewRenderLayer} from 'neuroglancer/perspective_view/render_layer';\nimport {forEachVisibleSegment, getObjectKey} from 'neuroglancer/segmentation_display_state/base';\nimport {SegmentationDisplayState} from 'neuroglancer/segmentation_display_state/frontend';\nimport {SharedWatchableValue} from 'neuroglancer/shared_watchable_value';\nimport {SliceViewPanelRenderLayer} from 'neuroglancer/sliceview/panel';\nimport {WatchableValueInterface} from 'neuroglancer/trackable_value';\nimport {binarySearch} from 'neuroglancer/util/array';\nimport {Borrowed, Owned, RefCounted} from 'neuroglancer/util/disposable';\nimport {mat4} from 'neuroglancer/util/geom';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {Uint64} from 'neuroglancer/util/uint64';\nimport {withSharedVisibility} from 'neuroglancer/visibility_priority/frontend';\nimport {Buffer} from 'neuroglancer/webgl/buffer';\nimport {registerSharedObjectOwner, SharedObject} from 'neuroglancer/worker_rpc';\n\nconst tempMat = mat4.create();\n\nfunction segmentationFilter(segmentationState: SegmentationDisplayState|undefined|null) {\n  if (segmentationState == null) {\n    return () => false;\n  }\n  const {visibleSegments, segmentEquivalences} = segmentationState;\n  return (annotation: AnnotationBase) => {\n    const {segments} = annotation;\n    if (segments === undefined) {\n      return false;\n    }\n    for (const segment of segments) {\n      if (visibleSegments.has(segmentEquivalences.get(segment))) {\n        return true;\n      }\n    }\n    return false;\n  };\n}\n\nfunction serializeAnnotationSet(\n    annotationSet: AnnotationSource, filter?: (annotation: AnnotationBase) => boolean) {\n  const typeToIds: string[][] = [];\n  for (const annotationType of annotationTypes) {\n    typeToIds[annotationType] = [];\n  }\n  for (const annotation of annotationSet) {\n    if (filter === undefined || filter(annotation)) {\n      typeToIds[annotation.type].push(annotation.id);\n    }\n  }\n  let totalBytes = 0;\n  let numPickIds = 0;\n  const typeToOffset: number[] = [];\n  for (const annotationType of annotationTypes) {\n    typeToOffset[annotationType] = totalBytes;\n    const count = typeToIds[annotationType].length;\n    const handler = getAnnotationTypeRenderHandler(annotationType);\n    totalBytes += count * handler.bytes;\n    numPickIds += handler.pickIdsPerInstance * count;\n  }\n  const data = new ArrayBuffer(totalBytes);\n  for (const annotationType of annotationTypes) {\n    const ids = typeToIds[annotationType];\n    const handler = getAnnotationTypeRenderHandler(annotationType);\n    const serializer = handler.serializer(data, typeToOffset[annotationType], ids.length);\n    ids.forEach((id, index) => serializer(annotationSet.get(id)!, index));\n  }\n  return {typeToIds, typeToOffset, data, numPickIds};\n}\n\n@registerSharedObjectOwner(ANNOTATION_RENDER_LAYER_RPC_ID)\nclass AnnotationLayerSharedObject extends withSharedVisibility(SharedObject) {\n  constructor(\n      public chunkManager: Borrowed<ChunkManager>,\n      public source: Borrowed<MultiscaleAnnotationSource>,\n      public state: WatchableValueInterface<SegmentationDisplayState|undefined|null>,\n      public filterBySegmentation: WatchableValueInterface<boolean>) {\n    super();\n\n    this.initializeCounterpart(this.chunkManager.rpc!, {\n      chunkManager: this.chunkManager.rpcId,\n      source: source.rpcId,\n      segmentationState: this.serializeDisplayState(),\n    });\n\n    const update = () => {\n      const msg: any = {id: this.rpcId, segmentationState: this.serializeDisplayState()};\n      this.rpc!.invoke(ANNOTATION_RENDER_LAYER_UPDATE_SEGMENTATION_RPC_ID, msg);\n    };\n\n    this.registerDisposer(state.changed.add(update));\n    this.registerDisposer(filterBySegmentation.changed.add(update));\n  }\n\n  private serializeDisplayState() {\n    const state = this.state.value;\n    if (state == null) {\n      return state;\n    }\n    if (!this.filterBySegmentation.value) {\n      return null;\n    }\n    return {\n      segmentEquivalences: state.segmentEquivalences.rpcId,\n      visibleSegments: state.visibleSegments.rpcId\n    };\n  }\n}\n\nexport class AnnotationLayer extends RefCounted {\n  /**\n   * Stores a serialized representation of the information needed to render the annotations.\n   */\n  buffer: Buffer;\n\n  /**\n   * The value of this.state.annotationSet.changed.count when `buffer` was last updated.\n   */\n  private generation = -1;\n\n  redrawNeeded = new NullarySignal();\n  typeToIds: string[][];\n  typeToOffset: number[];\n  numPickIds: number;\n  data: Uint8Array|undefined;\n\n  get source() {\n    return this.state.source;\n  }\n  get transform() {\n    return this.state.transform;\n  }\n  get hoverState() {\n    return this.state.hoverState;\n  }\n\n  private segmentationState: SegmentationDisplayState|undefined|null;\n\n  private handleChangeAffectingBuffer = (() => {\n    this.generation = -1;\n    this.redrawNeeded.dispatch();\n  });\n\n  private unregisterSegmentationState() {\n    const {segmentationState} = this;\n    if (segmentationState != null) {\n      segmentationState.visibleSegments.changed.remove(this.handleSegmentationChanged);\n      segmentationState.segmentEquivalences.changed.remove(this.handleSegmentationChanged);\n      this.segmentationState = undefined;\n    }\n  }\n\n  private handleSegmentationChanged = (() => {\n    if (this.state.filterBySegmentation.value) {\n      this.handleChangeAffectingBuffer();\n    }\n  });\n\n  sharedObject: AnnotationLayerSharedObject|undefined;\n\n  get visibility() {\n    const {sharedObject} = this;\n    if (sharedObject === undefined) {\n      return undefined;\n    }\n    return sharedObject.visibility;\n  }\n\n  constructor(public chunkManager: ChunkManager, public state: Owned<AnnotationLayerState>) {\n    super();\n    this.registerDisposer(state);\n    this.buffer = this.registerDisposer(new Buffer(chunkManager.gl));\n    this.registerDisposer(this.source.changed.add(this.handleChangeAffectingBuffer));\n    this.registerDisposer(state.filterBySegmentation.changed.add(this.handleChangeAffectingBuffer));\n    this.registerDisposer(() => this.unregisterSegmentationState());\n    this.registerDisposer(state.segmentationState.changed.add(() => {\n      const segmentationState = state.segmentationState.value;\n      if (segmentationState !== this.segmentationState) {\n        this.unregisterSegmentationState();\n        if (segmentationState != null) {\n          segmentationState.visibleSegments.changed.add(this.handleSegmentationChanged);\n          segmentationState.segmentEquivalences.changed.add(this.handleSegmentationChanged);\n        }\n        this.segmentationState = segmentationState;\n        this.handleSegmentationChanged();\n      }\n    }));\n    if (!(this.source instanceof AnnotationSource)) {\n      this.sharedObject = this.registerDisposer(new AnnotationLayerSharedObject(\n          chunkManager, this.source, state.segmentationState, state.filterBySegmentation));\n    }\n    this.registerDisposer(this.state.color.changed.add(this.redrawNeeded.dispatch));\n    this.registerDisposer(this.state.fillOpacity.changed.add(this.redrawNeeded.dispatch));\n    this.registerDisposer(this.hoverState.changed.add(this.redrawNeeded.dispatch));\n    this.registerDisposer(this.transform.changed.add(this.redrawNeeded.dispatch));\n  }\n\n  get gl() {\n    return this.chunkManager.gl;\n  }\n\n  updateBuffer() {\n    const {source} = this;\n    if (source instanceof AnnotationSource) {\n      const generation = source.changed.count;\n      if (this.generation !== generation) {\n        this.generation = generation;\n        const {data, typeToIds, typeToOffset, numPickIds} = serializeAnnotationSet(\n            source,\n            this.state.filterBySegmentation.value ? segmentationFilter(this.segmentationState) :\n                                                    undefined);\n        this.data = new Uint8Array(data);\n        this.buffer.setData(this.data);\n        this.typeToIds = typeToIds;\n        this.typeToOffset = typeToOffset;\n        this.numPickIds = numPickIds;\n      }\n    }\n  }\n}\n\nclass AnnotationPerspectiveRenderLayerBase extends PerspectiveViewRenderLayer {\n  constructor(public base: Owned<AnnotationLayer>) {\n    super();\n  }\n}\n\nclass AnnotationSliceViewRenderLayerBase extends SliceViewPanelRenderLayer {\n  constructor(public base: Owned<AnnotationLayer>) {\n    super();\n  }\n}\n\ninterface AnnotationGeometryDataInterface {\n  data: Uint8Array|undefined;\n  buffer: Buffer|undefined;\n  numPickIds: number|undefined;\n  typeToIds: string[][]|undefined;\n  typeToOffset: number[]|undefined;\n}\n\nfunction AnnotationRenderLayer<TBase extends {\n  new (...args: any[]): VisibilityTrackedRenderLayer &\n  {\n    base: AnnotationLayer\n  }\n}>(Base: TBase, renderHelperType: 'sliceViewRenderHelper'|'perspectiveViewRenderHelper') {\n  class C extends Base {\n    base: AnnotationLayer;\n    private renderHelpers: AnnotationRenderHelper[] = [];\n    constructor(...args: any[]) {\n      super(...args);\n      const base = this.registerDisposer(this.base);\n      const baseVisibility = base.visibility;\n      if (baseVisibility !== undefined) {\n        this.registerDisposer(baseVisibility.add(this.visibility));\n      }\n      this.role = base.state.role;\n      const {renderHelpers, gl} = this;\n      for (const annotationType of annotationTypes) {\n        const handler = getAnnotationTypeRenderHandler(annotationType);\n        const renderHelperConstructor = handler[renderHelperType];\n        const helper = renderHelpers[annotationType] =\n            this.registerDisposer(new renderHelperConstructor(gl));\n        helper.pickIdsPerInstance = handler.pickIdsPerInstance;\n        helper.targetIsSliceView = renderHelperType === 'sliceViewRenderHelper';\n      }\n      this.registerDisposer(base.redrawNeeded.add(() => {\n        this.redrawNeeded.dispatch();\n      }));\n      this.setReady(true);\n    }\n\n    get gl() {\n      return this.base.chunkManager.gl;\n    }\n\n    drawGeometryChunkData(\n        chunk: AnnotationGeometryData, renderContext: PerspectiveViewRenderContext) {\n      if (!chunk.bufferValid) {\n        let {buffer} = chunk;\n        if (buffer === undefined) {\n          buffer = chunk.buffer = new Buffer(this.gl);\n        }\n        buffer.setData(chunk.data!);\n        chunk.bufferValid = true;\n      }\n      this.drawGeometry(chunk, renderContext);\n    }\n\n    drawGeometry(\n        chunk: AnnotationGeometryDataInterface, renderContext: PerspectiveViewRenderContext) {\n      const {base} = this;\n      const typeToIds = chunk.typeToIds!;\n      const typeToOffset = chunk.typeToOffset!;\n      let pickId = 0;\n      if (renderContext.emitPickID) {\n        pickId = renderContext.pickIDs.register(this, chunk.numPickIds, 0, 0, chunk);\n      }\n      const hoverValue = base.hoverState.value;\n      const projectionMatrix =\n          mat4.multiply(tempMat, renderContext.dataToDevice, base.state.objectToGlobal);\n      for (const annotationType of annotationTypes) {\n        const ids = typeToIds[annotationType];\n        if (ids.length > 0) {\n          const count = ids.length;\n          const handler = getAnnotationTypeRenderHandler(annotationType);\n          let selectedIndex = 0xFFFFFFFF;\n          if (hoverValue !== undefined) {\n            const index = binarySearch(ids, hoverValue.id, (a, b) => a < b ? -1 : a === b ? 0 : 1);\n            if (index >= 0) {\n              selectedIndex = index * handler.pickIdsPerInstance;\n              // If we wanted to include the partIndex, we would add:\n              // selectedIndex += hoverValue.partIndex;\n            }\n          }\n          const context: AnnotationRenderContext = {\n            annotationLayer: base,\n            renderContext,\n            selectedIndex,\n            basePickId: pickId,\n            buffer: chunk.buffer!,\n            bufferOffset: typeToOffset[annotationType],\n            count,\n            projectionMatrix,\n          };\n          this.renderHelpers[annotationType].draw(context);\n          pickId += count * handler.pickIdsPerInstance;\n        }\n      }\n    }\n\n    draw(renderContext: PerspectiveViewRenderContext) {\n      const {source} = this.base;\n      if (source instanceof AnnotationSource) {\n        const {base} = this;\n        base.updateBuffer();\n        this.drawGeometry(base, renderContext);\n      } else {\n        this.drawGeometryChunkData(source.temporary.data!, renderContext);\n        if (this.base.state.filterBySegmentation.value) {\n          const segmentationState = this.base.state.segmentationState.value;\n          if (segmentationState == null) {\n            return;\n          }\n          const chunks = source.segmentFilteredSource.chunks;\n          forEachVisibleSegment(segmentationState, objectId => {\n            const key = getObjectKey(objectId);\n            const chunk = chunks.get(key);\n            if (chunk !== undefined) {\n              this.drawGeometryChunkData(chunk.data!, renderContext);\n            }\n          });\n        } else {\n          for (const alternatives of source.sources) {\n            for (const geometrySource of alternatives) {\n              for (const chunk of geometrySource.chunks.values()) {\n                if (chunk.state !== ChunkState.GPU_MEMORY) {\n                  continue;\n                }\n                this.drawGeometryChunkData(chunk.data!, renderContext);\n              }\n            }\n          }\n        }\n      }\n    }\n\n    updateMouseState(\n        mouseState: MouseSelectionState, _pickedValue: Uint64, pickedOffset: number, data: any) {\n      const chunk = <AnnotationGeometryDataInterface>data;\n      const typeToIds = chunk.typeToIds!;\n      const typeToOffset = chunk.typeToOffset!;\n      for (const annotationType of annotationTypes) {\n        const ids = typeToIds[annotationType];\n        const handler = getAnnotationTypeRenderHandler(annotationType);\n        const {pickIdsPerInstance} = handler;\n        if (pickedOffset < ids.length * pickIdsPerInstance) {\n          const instanceIndex = Math.floor(pickedOffset / pickIdsPerInstance);\n          const id = ids[instanceIndex];\n          const partIndex = pickedOffset % pickIdsPerInstance;\n          mouseState.pickedAnnotationId = id;\n          mouseState.pickedAnnotationLayer = this.base.state;\n          mouseState.pickedOffset = partIndex;\n          mouseState.pickedAnnotationBuffer = chunk.data!.buffer;\n          mouseState.pickedAnnotationBufferOffset = chunk.data!.byteOffset + typeToOffset[annotationType] + instanceIndex * handler.bytes;\n          handler.snapPosition(\n              mouseState.position, this.base.state.objectToGlobal, mouseState.pickedAnnotationBuffer,\n              mouseState.pickedAnnotationBufferOffset,\n              partIndex);\n          return;\n        }\n        pickedOffset -= ids.length * pickIdsPerInstance;\n      }\n    }\n\n    transformPickedValue(_pickedValue: Uint64, _pickedOffset: number) {\n      return undefined;\n    }\n\n    isReady() {\n      const {base} = this;\n      const {source} = base;\n      if (!(source instanceof MultiscaleAnnotationSource)) {\n        return true;\n      }\n      if (!base.state.filterBySegmentation.value) {\n        return true;\n      }\n\n      const segmentationState = this.base.state.segmentationState.value;\n      if (segmentationState === undefined) {\n        // We are still waiting to attach segmentation.\n        return false;\n      }\n      if (segmentationState === null) {\n        return true;\n      }\n      const chunks = source.segmentFilteredSource.chunks;\n      let missing = false;\n      forEachVisibleSegment(segmentationState, objectId => {\n        const key = getObjectKey(objectId);\n        if (!chunks.has(key)) {\n          missing = true;\n        }\n      });\n      return !missing;\n    }\n\n    isAnnotation = true;\n  }\n  return C;\n}\n\nconst PerspectiveViewAnnotationLayerBase =\n    AnnotationRenderLayer(AnnotationPerspectiveRenderLayerBase, 'perspectiveViewRenderHelper');\nexport class PerspectiveViewAnnotationLayer extends PerspectiveViewAnnotationLayerBase {\n  backend = (() => {\n    const {source} = this.base;\n    if (source instanceof MultiscaleAnnotationSource) {\n      const sharedObject = this.registerDisposer(new SharedObject());\n      const rpc = source.chunkManager.rpc!;\n      sharedObject.RPC_TYPE_ID = ANNOTATION_PERSPECTIVE_RENDER_LAYER_RPC_ID;\n      sharedObject.initializeCounterpart(rpc, {\n        source: source.rpcId,\n        filterBySegmentation: this.registerDisposer(SharedWatchableValue.makeFromExisting(\n                                                        rpc, this.base.state.filterBySegmentation))\n                                  .rpcId\n      });\n      return sharedObject;\n    }\n    return undefined;\n  })();\n  isReady() {\n    if (!super.isReady()) {\n      return false;\n    }\n    const {base} = this;\n    const {source} = base;\n    if (source instanceof MultiscaleAnnotationSource) {\n      if (!base.state.filterBySegmentation.value) {\n        const geometrySource = source.sources[0][0];\n        const chunk = geometrySource.chunks.get('0,0,0');\n        if (chunk === undefined || chunk.state !== ChunkState.GPU_MEMORY) {\n          return false;\n        }\n      }\n    }\n    return true;\n  }\n}\n\nexport const SliceViewAnnotationLayer =\n    AnnotationRenderLayer(AnnotationSliceViewRenderLayerBase, 'sliceViewRenderHelper');\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {AnnotationLayerState} from 'neuroglancer/annotation/frontend';\nimport {LayerManager, MouseSelectionState} from 'neuroglancer/layer';\n\nexport function getSelectedAnnotation(mouseState: MouseSelectionState, layerManager: LayerManager) {\n  if (!mouseState.active) {\n    return undefined;\n  }\n  if (mouseState.pickedAnnotationId === undefined) {\n    return undefined;\n  }\n  const renderLayer = mouseState.pickedRenderLayer;\n  if (renderLayer === null) {\n    return undefined;\n  }\n  const annotationLayer = mouseState.pickedAnnotationLayer;\n  if (annotationLayer === undefined) {\n    return undefined;\n  }\n  const managedLayer = layerManager.renderLayerToManagedLayerMap.get(renderLayer);\n  if (managedLayer === undefined) {\n    return undefined;\n  }\n\n  return {\n    layer: managedLayer,\n    annotationLayer,\n    id: mouseState.pickedAnnotationId,\n    partIndex: mouseState.pickedOffset,\n  };\n}\n\nexport function setAnnotationHoverStateFromMouseState(\n    annotationLayer: AnnotationLayerState, mouseState: MouseSelectionState) {\n  annotationLayer.registerDisposer(mouseState.changed.add(() => {\n    if (mouseState.active && mouseState.pickedAnnotationLayer === annotationLayer) {\n      const existingValue = annotationLayer.hoverState.value;\n      if (existingValue === undefined || existingValue.id !== mouseState.pickedAnnotationId! ||\n          existingValue.partIndex !== mouseState.pickedOffset) {\n        annotationLayer.hoverState.value = {\n          id: mouseState.pickedAnnotationId!,\n          partIndex: mouseState.pickedOffset\n        };\n      }\n    } else {\n      annotationLayer.hoverState.value = undefined;\n    }\n  }));\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Annotation, AnnotationType} from 'neuroglancer/annotation';\nimport {AnnotationLayer} from 'neuroglancer/annotation/frontend';\nimport {PerspectiveViewRenderContext} from 'neuroglancer/perspective_view/render_layer';\nimport {SliceViewPanelRenderContext} from 'neuroglancer/sliceview/panel';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {mat4, vec3} from 'neuroglancer/util/geom';\nimport {Buffer} from 'neuroglancer/webgl/buffer';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {ShaderBuilder, ShaderProgram} from 'neuroglancer/webgl/shader';\n\nexport interface AnnotationRenderContext {\n  buffer: Buffer;\n  annotationLayer: AnnotationLayer;\n  renderContext: SliceViewPanelRenderContext|PerspectiveViewRenderContext;\n  bufferOffset: number;\n  count: number;\n  basePickId: number;\n  selectedIndex: number;\n  projectionMatrix: mat4;\n}\n\nconst tempPickID = new Float32Array(4);\n\nexport abstract class AnnotationRenderHelper extends RefCounted {\n  pickIdsPerInstance: number;\n  targetIsSliceView: boolean;\n\n  constructor(public gl: GL) {\n    super();\n  }\n\n  setPartIndex(builder: ShaderBuilder, ...partIndexExpressions: string[]) {\n    let s = `\nvoid setPartIndex(${partIndexExpressions.map((_, i) => `highp uint partIndex${i}`).join()}) {\n  highp uint pickID = uPickID;\n  highp uint pickBaseOffset = getPickBaseOffset();\n${\n        partIndexExpressions\n            .map((_, i) => `highp uint pickOffset${i} = pickBaseOffset + partIndex${i};`)\n            .join('\\n')}\n`;\n    if (partIndexExpressions.length === 0) {\n      s += `\n  highp uint pickOffset0 = pickBaseOffset;\n`;\n    }\n    s += `\n  vPickID = pickID + pickOffset0;\n  highp uint selectedIndex = uSelectedIndex;\nif (selectedIndex == pickBaseOffset${\n        partIndexExpressions.map((_, i) => ` || selectedIndex == pickOffset${i}`).join('')}) {\n    vColor = uColorSelected;\n  } else {\n    vColor = uColor;\n  }\n}\n`;\n    builder.addVertexCode(s);\n    return `setPartIndex(${partIndexExpressions.join()})`;\n  }\n\n  getCrossSectionFadeFactor() {\n    if (this.targetIsSliceView) {\n      return `(clamp(1.0 - 2.0 * abs(0.5 - gl_FragCoord.z), 0.0, 1.0))`;\n    } else {\n      return `(1.0)`;\n    }\n  }\n\n  defineShader(builder: ShaderBuilder) {\n    builder.addUniform('highp vec4', 'uColor');\n    builder.addUniform('highp vec4', 'uColorSelected');\n    builder.addUniform('highp uint', 'uSelectedIndex');\n    builder.addVarying('highp vec4', 'vColor');\n    // Transform from camera to clip coordinates.\n    builder.addUniform('highp mat4', 'uProjection');\n    builder.addUniform('highp uint', 'uPickID');\n    builder.addVarying('highp uint', 'vPickID', 'flat');\n\n    builder.addVertexCode(`\nhighp uint getPickBaseOffset() { return uint(gl_InstanceID) * ${this.pickIdsPerInstance}u; }\n`);\n\n    builder.addFragmentCode(`\nvoid emitAnnotation(vec4 color) {\n  emit(color, vPickID);\n}\n`);\n  }\n\n  enable(shader: ShaderProgram, context: AnnotationRenderContext, callback: () => void) {\n    shader.bind();\n    const {gl} = this;\n    const {renderContext} = context;\n    const {annotationLayer} = context;\n    gl.uniformMatrix4fv(shader.uniform('uProjection'), false, context.projectionMatrix);\n    if (renderContext.emitPickID) {\n      gl.uniform1ui(shader.uniform('uPickID'), context.basePickId);\n    }\n    if (renderContext.emitColor) {\n      const colorVec4 = tempPickID;\n      const color = annotationLayer.state.color.value;\n      colorVec4[0] = color[0];\n      colorVec4[1] = color[1];\n      colorVec4[2] = color[2];\n      colorVec4[3] = 1;\n      gl.uniform4fv(shader.uniform('uColor'), colorVec4);\n      const saturationAmount = 0.75;\n      for (let i = 0; i < 3; ++i) {\n        colorVec4[i] = saturationAmount + (1 - saturationAmount) * colorVec4[i];\n      }\n      gl.uniform4fv(shader.uniform('uColorSelected'), colorVec4);\n      gl.uniform1ui(shader.uniform('uSelectedIndex'), context.selectedIndex);\n    }\n\n    callback();\n  }\n\n  abstract draw(context: AnnotationRenderContext): void;\n}\n\ninterface AnnotationTypeRenderHandler<T extends Annotation> {\n  bytes: number;\n  serializer:\n      (buffer: ArrayBuffer, offset: number,\n       numAnnotations: number) => ((annotation: T, index: number) => void);\n  perspectiveViewRenderHelper: {\n    new(\n        gl: GL,\n        ): AnnotationRenderHelper;\n  };\n  sliceViewRenderHelper: {new(gl: GL): AnnotationRenderHelper;};\n  pickIdsPerInstance: number;\n  getRepresentativePoint: (objectToData: mat4, annotation: T, partIndex: number) => vec3;\n  updateViaRepresentativePoint:\n      (oldAnnotation: T, position: vec3, dataToObject: mat4, partIndex: number) => T;\n  snapPosition:\n      (position: vec3, objectToData: mat4, data: ArrayBuffer, offset: number,\n       partIndex: number) => void;\n}\n\nconst annotationTypeRenderHandlers =\n    new Map<AnnotationType, AnnotationTypeRenderHandler<Annotation>>();\n\nexport function registerAnnotationTypeRenderHandler<T extends Annotation>(\n    type: AnnotationType, handler: AnnotationTypeRenderHandler<T>) {\n  annotationTypeRenderHandlers.set(type, handler);\n}\n\nexport function getAnnotationTypeRenderHandler(type: AnnotationType):\n    AnnotationTypeRenderHandler<Annotation> {\n  return annotationTypeRenderHandlers.get(type)!;\n}\n","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {AnnotationType, LocalAnnotationSource} from 'neuroglancer/annotation';\nimport {AnnotationLayerState} from 'neuroglancer/annotation/frontend';\nimport {CoordinateTransform, makeDerivedCoordinateTransform} from 'neuroglancer/coordinate_transform';\nimport {LayerReference, ManagedUserLayer, UserLayer} from 'neuroglancer/layer';\nimport {LayerListSpecification, registerLayerType} from 'neuroglancer/layer_specification';\nimport {VoxelSize} from 'neuroglancer/navigation_state';\nimport {SegmentationDisplayState} from 'neuroglancer/segmentation_display_state/frontend';\nimport {SegmentationUserLayer} from 'neuroglancer/segmentation_user_layer';\nimport {StatusMessage} from 'neuroglancer/status';\nimport {ElementVisibilityFromTrackableBoolean, TrackableBoolean, TrackableBooleanCheckbox} from 'neuroglancer/trackable_boolean';\nimport {makeDerivedWatchableValue, WatchableValue} from 'neuroglancer/trackable_value';\nimport {AnnotationLayerView, getAnnotationRenderOptions, UserLayerWithAnnotationsMixin} from 'neuroglancer/ui/annotations';\nimport {UserLayerWithCoordinateTransformMixin} from 'neuroglancer/user_layer_with_coordinate_transform';\nimport {mat4, vec3} from 'neuroglancer/util/geom';\nimport {parseArray, verify3dVec} from 'neuroglancer/util/json';\nimport {LayerReferenceWidget} from 'neuroglancer/widget/layer_reference';\n\nimport './user_layer.css';\n\nconst POINTS_JSON_KEY = 'points';\nconst ANNOTATIONS_JSON_KEY = 'annotations';\n\nfunction addPointAnnotations(annotations: LocalAnnotationSource, obj: any) {\n  if (obj === undefined) {\n    return;\n  }\n  parseArray(obj, (x, i) => {\n    annotations.add({\n      type: AnnotationType.POINT,\n      id: '' + i,\n      point: verify3dVec(x),\n    });\n  });\n}\n\nfunction isValidLinkedSegmentationLayer(layer: ManagedUserLayer) {\n  const userLayer = layer.layer;\n  if (userLayer === null) {\n    return true;\n  }\n  if (userLayer instanceof SegmentationUserLayer) {\n    return true;\n  }\n  return false;\n}\n\nfunction getSegmentationDisplayState(layer: ManagedUserLayer|undefined): SegmentationDisplayState|\n    undefined {\n  if (layer === undefined) {\n    return undefined;\n  }\n  const userLayer = layer.layer;\n  if (userLayer === null) {\n    return undefined;\n  }\n  if (!(userLayer instanceof SegmentationUserLayer)) {\n    return undefined;\n  }\n  return userLayer.displayState;\n}\n\nconst VOXEL_SIZE_JSON_KEY = 'voxelSize';\nconst SOURCE_JSON_KEY = 'source';\nconst LINKED_SEGMENTATION_LAYER_JSON_KEY = 'linkedSegmentationLayer';\nconst FILTER_BY_SEGMENTATION_JSON_KEY = 'filterBySegmentation';\nconst Base = UserLayerWithAnnotationsMixin(UserLayerWithCoordinateTransformMixin(UserLayer));\nexport class AnnotationUserLayer extends Base {\n  localAnnotations = this.registerDisposer(new LocalAnnotationSource());\n  voxelSize = new VoxelSize();\n  sourceUrl: string|undefined;\n  linkedSegmentationLayer = this.registerDisposer(\n      new LayerReference(this.manager.rootLayers.addRef(), isValidLinkedSegmentationLayer));\n  filterBySegmentation = new TrackableBoolean(false);\n\n  getAnnotationRenderOptions() {\n    const segmentationState =\n        new WatchableValue<SegmentationDisplayState|undefined|null>(undefined);\n    const setSegmentationState = () => {\n      const {linkedSegmentationLayer} = this;\n      if (linkedSegmentationLayer.layerName === undefined) {\n        segmentationState.value = null;\n      } else {\n        const {layer} = linkedSegmentationLayer;\n        segmentationState.value = getSegmentationDisplayState(layer);\n      }\n    };\n    this.registerDisposer(this.linkedSegmentationLayer.changed.add(setSegmentationState));\n    setSegmentationState();\n    return {\n      segmentationState,\n      filterBySegmentation: this.filterBySegmentation,\n      ...getAnnotationRenderOptions(this)\n    };\n  }\n\n  constructor(manager: LayerListSpecification, specification: any) {\n    super(manager, specification);\n    const sourceUrl = this.sourceUrl = specification[SOURCE_JSON_KEY];\n    this.linkedSegmentationLayer.restoreState(specification[LINKED_SEGMENTATION_LAYER_JSON_KEY]);\n    this.filterBySegmentation.restoreState(specification[FILTER_BY_SEGMENTATION_JSON_KEY]);\n    if (sourceUrl === undefined) {\n      this.isReady = true;\n      this.voxelSize.restoreState(specification[VOXEL_SIZE_JSON_KEY]);\n      this.localAnnotations.restoreState(specification[ANNOTATIONS_JSON_KEY]);\n      // Handle legacy \"points\" property.\n      addPointAnnotations(this.localAnnotations, specification[POINTS_JSON_KEY]);\n      let voxelSizeValid = false;\n      const handleVoxelSizeChanged = () => {\n        if (!this.voxelSize.valid && manager.voxelSize.valid) {\n          vec3.copy(this.voxelSize.size, manager.voxelSize.size);\n          this.voxelSize.setValid();\n        }\n        if (this.voxelSize.valid && voxelSizeValid === false) {\n          const derivedTransform = new CoordinateTransform();\n          this.registerDisposer(\n              makeDerivedCoordinateTransform(derivedTransform, this.transform, (output, input) => {\n                const voxelScalingMatrix = mat4.fromScaling(mat4.create(), this.voxelSize.size);\n                mat4.multiply(output, input, voxelScalingMatrix);\n              }));\n          this.annotationLayerState.value = new AnnotationLayerState({\n            transform: derivedTransform,\n            source: this.localAnnotations.addRef(),\n            ...this.getAnnotationRenderOptions()\n          });\n          voxelSizeValid = true;\n        }\n      };\n      this.registerDisposer(this.localAnnotations.changed.add(this.specificationChanged.dispatch));\n      this.registerDisposer(this.voxelSize.changed.add(this.specificationChanged.dispatch));\n      this.registerDisposer(\n          this.filterBySegmentation.changed.add(this.specificationChanged.dispatch));\n      this.registerDisposer(this.voxelSize.changed.add(handleVoxelSizeChanged));\n      this.registerDisposer(this.manager.voxelSize.changed.add(handleVoxelSizeChanged));\n      handleVoxelSizeChanged();\n    } else {\n      StatusMessage\n          .forPromise(\n              this.manager.dataSourceProvider.getAnnotationSource(\n                  this.manager.chunkManager, sourceUrl),\n              {\n                initialMessage: `Retrieving metadata for volume ${sourceUrl}.`,\n                delay: true,\n                errorPrefix: `Error retrieving metadata for volume ${sourceUrl}: `,\n              })\n          .then(source => {\n            if (this.wasDisposed) {\n              return;\n            }\n            this.annotationLayerState.value = new AnnotationLayerState(\n                {transform: this.transform, source, ...this.getAnnotationRenderOptions()});\n            this.isReady = true;\n          });\n    }\n    this.tabs.default = 'annotations';\n  }\n\n  initializeAnnotationLayerViewTab(tab: AnnotationLayerView) {\n    const widget = tab.registerDisposer(new LayerReferenceWidget(this.linkedSegmentationLayer));\n    widget.element.insertBefore(\n        document.createTextNode('Linked segmentation: '), widget.element.firstChild);\n    tab.element.appendChild(widget.element);\n\n    {\n      const checkboxWidget = this.registerDisposer(\n          new TrackableBooleanCheckbox(tab.annotationLayer.filterBySegmentation));\n      const label = document.createElement('label');\n      label.textContent = 'Filter by segmentation: ';\n      label.appendChild(checkboxWidget.element);\n      tab.element.appendChild(label);\n      tab.registerDisposer(new ElementVisibilityFromTrackableBoolean(\n          this.registerDisposer(makeDerivedWatchableValue(\n              v => v !== undefined, tab.annotationLayer.segmentationState)),\n          label));\n    }\n  }\n\n  toJSON() {\n    const x = super.toJSON();\n    x['type'] = 'annotation';\n    x[SOURCE_JSON_KEY] = this.sourceUrl;\n    if (this.sourceUrl === undefined) {\n      x[ANNOTATIONS_JSON_KEY] = this.localAnnotations.toJSON();\n      x[VOXEL_SIZE_JSON_KEY] = this.voxelSize.toJSON();\n    }\n    x[LINKED_SEGMENTATION_LAYER_JSON_KEY] = this.linkedSegmentationLayer.toJSON();\n    x[FILTER_BY_SEGMENTATION_JSON_KEY] = this.filterBySegmentation.toJSON();\n    return x;\n  }\n}\n\nregisterLayerType('annotation', AnnotationUserLayer);\nregisterLayerType('pointAnnotation', AnnotationUserLayer);\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {mat4} from 'neuroglancer/util/geom';\nimport {Buffer} from 'neuroglancer/webgl/buffer';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {ShaderProgram} from 'neuroglancer/webgl/shader';\nimport {trivialColorShader} from 'neuroglancer/webgl/trivial_shaders';\n\nexport class AxesLineHelper extends RefCounted {\n  vertexBuffer: Buffer;\n  colorBuffer: Buffer;\n  trivialColorShader: ShaderProgram;\n\n  constructor(public gl: GL) {\n    super();\n    this.vertexBuffer = this.registerDisposer(Buffer.fromData(\n        gl, new Float32Array([\n          0, 0, 0, 1,  //\n          1, 0, 0, 1,  //\n          0, 0, 0, 1,  //\n          0, 1, 0, 1,  //\n          0, 0, 0, 1,  //\n          0, 0, 1, 1,  //\n        ]),\n        gl.ARRAY_BUFFER, gl.STATIC_DRAW));\n\n    let alpha = 0.5;\n    this.colorBuffer = this.registerDisposer(Buffer.fromData(\n        gl, new Float32Array([\n          1, 0, 0, alpha,  //\n          1, 0, 0, alpha,  //\n          0, 1, 0, alpha,  //\n          0, 1, 0, alpha,  //\n          0, 0, 1, alpha,  //\n          0, 0, 1, alpha,  //\n        ]),\n        gl.ARRAY_BUFFER, gl.STATIC_DRAW));\n    this.trivialColorShader = this.registerDisposer(trivialColorShader(gl));\n  }\n\n  static get(gl: GL) {\n    return gl.memoize.get('SliceViewPanel:AxesLineHelper', () => new AxesLineHelper(gl));\n  }\n\n  draw(mat: mat4, blend = true) {\n    let shader = this.trivialColorShader;\n    let gl = this.gl;\n    shader.bind();\n    gl.uniformMatrix4fv(shader.uniform('uProjectionMatrix'), false, mat);\n    let aVertexPosition = shader.attribute('aVertexPosition');\n    this.vertexBuffer.bindToVertexAttrib(aVertexPosition, 4);\n\n    let aColor = shader.attribute('aColor');\n    this.colorBuffer.bindToVertexAttrib(aColor, 4);\n\n    if (blend) {\n      gl.colorMask(false, false, false, true);\n      gl.clearColor(0, 0, 0, 0);\n      gl.clear(gl.COLOR_BUFFER_BIT);\n      gl.colorMask(true, true, true, true);\n      gl.enable(gl.BLEND);\n      gl.blendFunc(gl.ONE_MINUS_DST_ALPHA, gl.DST_ALPHA);\n    }\n\n\n    gl.lineWidth(1);\n    gl.drawArrays(gl.LINES, 0, 6);\n\n    if (blend) {\n      gl.disable(gl.BLEND);\n    }\n\n    gl.disableVertexAttribArray(aVertexPosition);\n    gl.disableVertexAttribArray(aColor);\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport enum ChunkState {\n  // Chunk is stored in GPU memory in addition to system memory.\n  GPU_MEMORY = 0,\n  // Chunk is stored only in system memory but not in GPU memory.\n  SYSTEM_MEMORY = 1,\n\n  // Chunk is stored in system memory on worker.\n  SYSTEM_MEMORY_WORKER = 2,\n\n  // Chunk is downloading.\n  DOWNLOADING = 3,\n  // Chunk is not yet downloading.\n  QUEUED = 4,\n\n  // Chunk has just been added.\n  NEW = 5,\n\n  // Download failed.\n  FAILED = 6,\n\n  EXPIRED = 7,\n\n  // If new states are added, keep numChangeStates in sync.\n}\n\nexport const numChunkStates = 8;\n\nexport enum ChunkPriorityTier {\n  FIRST_TIER = 0,\n  FIRST_ORDERED_TIER = 0,\n  VISIBLE = 0,\n  PREFETCH = 1,\n  LAST_ORDERED_TIER = 1,\n  RECENT = 2,\n  LAST_TIER = 2\n}\n\nexport const numChunkPriorityTiers = 3;\n\nexport enum ChunkDownloadStatistics {\n  totalTime = 0,\n  totalChunks = 1,\n}\n\nexport enum ChunkMemoryStatistics {\n  numChunks = 0,\n  systemMemoryBytes = 1,\n  gpuMemoryBytes = 2,\n}\n\nexport const numChunkMemoryStatistics = 3;\n\nexport const numChunkDownloadStatistics = 2;\n\nexport const numChunkStatistics =\n    numChunkStates * numChunkPriorityTiers * numChunkMemoryStatistics + numChunkDownloadStatistics;\n\nexport function getChunkStateStatisticIndex(state: ChunkState, priorityTier: ChunkPriorityTier) {\n  return state * numChunkPriorityTiers + priorityTier;\n}\n\nexport function getChunkDownloadStatisticIndex(statistic: ChunkDownloadStatistics) {\n  return numChunkStates * numChunkPriorityTiers * numChunkMemoryStatistics + statistic;\n}\n\nexport const PREFETCH_PRIORITY_MULTIPLIER = 1e13;\n\nexport const CHUNK_QUEUE_MANAGER_RPC_ID = 'ChunkQueueManager';\nexport const CHUNK_MANAGER_RPC_ID = 'ChunkManager';\nexport const CHUNK_SOURCE_INVALIDATE_RPC_ID = 'ChunkSource.invalidate';\n\nexport const REQUEST_CHUNK_STATISTICS_RPC_ID = 'ChunkQueueManager.requestChunkStatistics';\n\nexport interface ChunkSourceParametersConstructor<T> {\n  new(): T;\n  RPC_ID: string;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {CHUNK_MANAGER_RPC_ID, CHUNK_QUEUE_MANAGER_RPC_ID, CHUNK_SOURCE_INVALIDATE_RPC_ID, ChunkSourceParametersConstructor, ChunkState} from 'neuroglancer/chunk_manager/base';\nimport {SharedWatchableValue} from 'neuroglancer/shared_watchable_value';\nimport {TrackableValue} from 'neuroglancer/trackable_value';\nimport {CANCELED, CancellationToken} from 'neuroglancer/util/cancellation';\nimport {Borrowed} from 'neuroglancer/util/disposable';\nimport {stableStringify} from 'neuroglancer/util/json';\nimport {StringMemoize} from 'neuroglancer/util/memoize';\nimport {getObjectId} from 'neuroglancer/util/object_id';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {registerPromiseRPC, registerRPC, registerSharedObjectOwner, RPC, RPCPromise, SharedObject} from 'neuroglancer/worker_rpc';\n\nconst DEBUG_CHUNK_UPDATES = false;\n\nexport class Chunk {\n  state = ChunkState.SYSTEM_MEMORY;\n  constructor(public source: ChunkSource) {}\n\n  get gl() {\n    return this.source.gl;\n  }\n\n  copyToGPU(_gl: GL) {\n    this.state = ChunkState.GPU_MEMORY;\n  }\n\n  freeGPUMemory(_gl: GL) {\n    this.state = ChunkState.SYSTEM_MEMORY;\n  }\n}\n\nfunction validateLimitValue(x: any) {\n  if (typeof x !== 'number' || x < 0) {\n    throw new Error(`Expected non-negative number as limit, but received: ${JSON.stringify(x)}`);\n  }\n  return x;\n}\n\nexport class CapacitySpecification {\n  sizeLimit: TrackableValue<number>;\n  itemLimit: TrackableValue<number>;\n  constructor({\n    defaultItemLimit = Number.POSITIVE_INFINITY,\n    defaultSizeLimit = Number.POSITIVE_INFINITY\n  } = {}) {\n    this.sizeLimit = new TrackableValue<number>(defaultSizeLimit, validateLimitValue);\n    this.itemLimit = new TrackableValue<number>(defaultItemLimit, validateLimitValue);\n  }\n}\n\nexport interface FrameNumberCounter {\n  frameNumber: number;\n  changed: NullarySignal;\n}\n\n@registerSharedObjectOwner(CHUNK_QUEUE_MANAGER_RPC_ID)\nexport class ChunkQueueManager extends SharedObject {\n  visibleChunksChanged = new NullarySignal();\n  pendingChunkUpdates: any = null;\n  pendingChunkUpdatesTail: any = null;\n\n  /**\n   * If non-null, deadline in milliseconds since epoch after which chunk copies to the GPU may not\n   * start (until the next frame).\n   */\n  chunkUpdateDeadline: number|null = null;\n\n  chunkUpdateDelay: number = 30;\n\n  constructor(\n      rpc: RPC, public gl: GL, public frameNumberCounter: FrameNumberCounter, public capacities: {\n        gpuMemory: CapacitySpecification,\n        systemMemory: CapacitySpecification,\n        download: CapacitySpecification,\n        compute: CapacitySpecification\n      }) {\n    super();\n\n    const makeCapacityCounterparts = (capacity: CapacitySpecification) => {\n      return {\n        itemLimit:\n            this.registerDisposer(SharedWatchableValue.makeFromExisting(rpc, capacity.itemLimit))\n                .rpcId,\n        sizeLimit:\n            this.registerDisposer(SharedWatchableValue.makeFromExisting(rpc, capacity.sizeLimit))\n                .rpcId,\n      };\n    };\n\n    this.initializeCounterpart(rpc, {\n      'gpuMemoryCapacity': makeCapacityCounterparts(capacities.gpuMemory),\n      'systemMemoryCapacity': makeCapacityCounterparts(capacities.systemMemory),\n      'downloadCapacity': makeCapacityCounterparts(capacities.download),\n      'computeCapacity': makeCapacityCounterparts(capacities.compute)\n    });\n  }\n\n  scheduleChunkUpdate() {\n    let deadline = this.chunkUpdateDeadline;\n    let delay: number;\n    if (deadline === null || Date.now() < deadline) {\n      delay = 0;\n    } else {\n      delay = this.chunkUpdateDelay;\n    }\n    setTimeout(this.processPendingChunkUpdates.bind(this), delay);\n  }\n  processPendingChunkUpdates() {\n    let deadline = this.chunkUpdateDeadline;\n    if (deadline === null) {\n      deadline = Date.now() + 30;\n    }\n    let visibleChunksChanged = false;\n    while (true) {\n      if (Date.now() > deadline) {\n        // No time to perform chunk update now, we will wait some more.\n        this.chunkUpdateDeadline = null;\n        setTimeout(() => this.processPendingChunkUpdates(), this.chunkUpdateDelay);\n        break;\n      }\n      let update = this.pendingChunkUpdates;\n      if (this.applyChunkUpdate(update)) {\n        visibleChunksChanged = true;\n      }\n      // FIXME: do chunk update\n      let nextUpdate = this.pendingChunkUpdates = update.nextUpdate;\n      if (nextUpdate == null) {\n        this.pendingChunkUpdatesTail = null;\n        break;\n      }\n    }\n    if (visibleChunksChanged) {\n      this.visibleChunksChanged.dispatch();\n    }\n  }\n\n  private handleFetch_(source: ChunkSource, update: any) {\n    const {resolve, reject, cancellationToken} = update['promise'];\n    if ((<CancellationToken>cancellationToken).isCanceled) {\n      reject(CANCELED);\n      return;\n    }\n\n    const key = update['key'];\n    const chunk = source.chunks.get(key);\n    if (!chunk) {\n      reject(new Error(`No chunk found at ${key} for source ${source.constructor.name}`));\n      return;\n    }\n\n    const data = (<any>chunk)['data'];\n    if (!data) {\n      reject(new Error(`At ${key} for source ${source.constructor.name}: chunk has no data`));\n      return;\n    }\n\n    resolve({value: data});\n  }\n\n  applyChunkUpdate(update: any) {\n    let visibleChunksChanged = false;\n    let {rpc} = this;\n    const source = <ChunkSource>rpc!.get(update['source']);\n    if (DEBUG_CHUNK_UPDATES) {\n      console.log(\n          `${Date.now()} Chunk.update processed: ${source.rpcId} ` +\n          `${update['id']} ${update['state']}`);\n    }\n    if (update['promise'] !== undefined) {\n      this.handleFetch_(source, update);\n    } else if (update['id'] === undefined) {\n      // Invalidate source.\n      for (const chunkKey of source.chunks.keys()) {\n        source.deleteChunk(chunkKey);\n      }\n      visibleChunksChanged = true;\n    } else {\n      let newState: number = update['state'];\n      if (newState === ChunkState.EXPIRED) {\n        // FIXME: maybe use freeList for chunks here\n        source.deleteChunk(update['id']);\n      } else {\n        let chunk: Chunk;\n        let key = update['id'];\n        if (update['new']) {\n          chunk = source.getChunk(update);\n          source.addChunk(key, chunk);\n        } else {\n          chunk = source.chunks.get(key)!;\n        }\n        let oldState = chunk.state;\n        if (newState !== oldState) {\n          switch (newState) {\n            case ChunkState.GPU_MEMORY:\n              // console.log(\"Copying to GPU\", chunk);\n              chunk.copyToGPU(this.gl);\n              visibleChunksChanged = true;\n              break;\n            case ChunkState.SYSTEM_MEMORY:\n              chunk.freeGPUMemory(this.gl);\n              break;\n            default:\n              throw new Error(`INTERNAL ERROR: Invalid chunk state: ${ChunkState[newState]}`);\n          }\n        }\n      }\n    }\n    return visibleChunksChanged;\n  }\n}\n\nfunction updateChunk(rpc: RPC, x: any) {\n  let source: ChunkSource = rpc.get(x['source']);\n  if (DEBUG_CHUNK_UPDATES) {\n    console.log(\n        `${Date.now()} Chunk.update received: ` +\n        `${source.rpcId} ${x['id']} ${x['state']} with chunkDataSize ${x['chunkDataSize']}`);\n  }\n  let queueManager = source.chunkManager.chunkQueueManager;\n  if (source.immediateChunkUpdates) {\n    if (queueManager.applyChunkUpdate(x)) {\n      queueManager.visibleChunksChanged.dispatch();\n    }\n    return;\n  }\n\n  let pendingTail = queueManager.pendingChunkUpdatesTail;\n  if (pendingTail == null) {\n    queueManager.pendingChunkUpdates = x;\n    queueManager.pendingChunkUpdatesTail = x;\n    queueManager.scheduleChunkUpdate();\n  } else {\n    pendingTail.nextUpdate = x;\n    queueManager.pendingChunkUpdatesTail = x;\n  }\n}\n\nregisterRPC('Chunk.update', function(x) {\n  updateChunk(this, x);\n});\n\nregisterPromiseRPC('Chunk.retrieve', function(x, cancellationToken): RPCPromise<any> {\n  return new Promise<{value: any}>((resolve, reject) => {\n    x['promise'] = {resolve, reject, cancellationToken};\n    updateChunk(this, x);\n  });\n});\n\nexport interface ChunkSourceConstructor<Options, T extends SharedObject = ChunkSource> {\n  new(...args: any[]): T;\n  encodeOptions(options: Options): {[key: string]: any};\n}\n\n@registerSharedObjectOwner(CHUNK_MANAGER_RPC_ID)\nexport class ChunkManager extends SharedObject {\n  memoize = new StringMemoize();\n\n  get gl() {\n    return this.chunkQueueManager.gl;\n  }\n\n  constructor(public chunkQueueManager: ChunkQueueManager) {\n    super();\n    this.registerDisposer(chunkQueueManager.addRef());\n    this.initializeCounterpart(\n        chunkQueueManager.rpc!, {'chunkQueueManager': chunkQueueManager.rpcId});\n  }\n\n  getChunkSource<T extends SharedObject&{key: any}, Options>(\n      constructorFunction: ChunkSourceConstructor<Options, T>, options: any): T {\n    const keyObject = constructorFunction.encodeOptions(options);\n    keyObject['constructorId'] = getObjectId(constructorFunction);\n    const key = stableStringify(keyObject);\n    return this.memoize.get(key, () => {\n      const newSource = new constructorFunction(this, options);\n      newSource.initializeCounterpart(this.rpc!, {});\n      newSource.key = keyObject;\n      return newSource;\n    }) as T;\n  }\n}\n\nexport class ChunkSource extends SharedObject {\n  chunks = new Map<string, Chunk>();\n  key: any;\n\n  /**\n   * If set to true, chunk updates will be applied to this source immediately, rather than queueing\n   * them.  Sources that dynamically update chunks and need to ensure a consistent order of\n   * processing relative to other messages between the frontend and worker should set this to true.\n   */\n  immediateChunkUpdates = false;\n\n  constructor(public chunkManager: Borrowed<ChunkManager>, _options: {} = {}) {\n    super();\n  }\n\n  initializeCounterpart(rpc: RPC, options: any) {\n    options['chunkManager'] = this.chunkManager.rpcId;\n    super.initializeCounterpart(rpc, options);\n  }\n\n  get gl() {\n    return this.chunkManager.chunkQueueManager.gl;\n  }\n\n  deleteChunk(key: string) {\n    const chunk = this.chunks.get(key)!;\n    if (chunk.state === ChunkState.GPU_MEMORY) {\n      chunk.freeGPUMemory(this.gl);\n    }\n    this.chunks.delete(key);\n  }\n\n  addChunk(key: string, chunk: Chunk) {\n    this.chunks.set(key, chunk);\n  }\n\n  /**\n   * Default implementation for use with backendOnly chunk sources.\n   */\n  getChunk(_x: any): Chunk {\n    throw new Error('Not implemented.');\n  }\n\n  /**\n   * Invalidates the chunk cache.  Operates asynchronously.\n   */\n  invalidateCache(): void {\n    this.rpc!.invoke(CHUNK_SOURCE_INVALIDATE_RPC_ID, {'id': this.rpcId});\n  }\n\n  static encodeOptions(_options: {}): {[key: string]: any} {\n    return {};\n  }\n}\n\nexport function WithParameters<Parameters, BaseOptions,\n                               TBase extends ChunkSourceConstructor<BaseOptions, SharedObject>>(\n    Base: TBase, parametersConstructor: ChunkSourceParametersConstructor<Parameters>) {\n  type Options = BaseOptions&{parameters: Parameters};\n  @registerSharedObjectOwner(parametersConstructor.RPC_ID)\n  class C extends Base {\n    parameters: Parameters;\n    constructor(...args: any[]) {\n      super(...args);\n      const options: Options = args[1];\n      this.parameters = options.parameters;\n    }\n    initializeCounterpart(rpc: RPC, options: any) {\n      options['parameters'] = this.parameters;\n      super.initializeCounterpart(rpc, options);\n    }\n    static encodeOptions(options: Options) {\n      return Object.assign({parameters: options.parameters}, super.encodeOptions(options));\n    }\n  }\n  return C;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {WatchableValueInterface} from 'neuroglancer/trackable_value';\nimport {identityMat4, kOneVec, kZeroVec, mat4, quat, vec3} from 'neuroglancer/util/geom';\nimport {parseFiniteVec} from 'neuroglancer/util/json';\nimport {NullarySignal} from 'neuroglancer/util/signal';\n\nexport interface RotationTranslationScale {\n  rotation: quat;\n  translation: vec3;\n  scale: vec3;\n}\n\n/**\n * Class for representing a coordinate transform specified by a user.\n *\n * Typically it represents a transform from a local coordinate space to a global coordinate space.\n */\nexport class CoordinateTransform implements WatchableValueInterface<mat4> {\n  changed = new NullarySignal();\n\n  get value() {\n    return this.transform;\n  }\n\n  constructor(public transform = mat4.create()) {}\n\n  /**\n   * Resets to the identity transform.\n   */\n  reset() {\n    mat4.copy(this.transform, identityMat4);\n    this.changed.dispatch();\n  }\n\n  toJSON() {\n    if (mat4.equals(identityMat4, this.transform)) {\n      return undefined;\n    }\n    const m = this.transform;\n    return [\n      [m[0], m[4], m[8], m[12]],   //\n      [m[1], m[5], m[9], m[13]],   //\n      [m[2], m[6], m[10], m[14]],  //\n      [m[3], m[7], m[11], m[15]],  //\n    ];\n  }\n\n  restoreState(obj: any) {\n    if (obj == null) {\n      this.reset();\n      return;\n    }\n    if (Array.isArray(obj)) {\n      if (obj.length === 4) {\n        try {\n          for (let i = 0; i < 4; ++i) {\n            parseFiniteVec(this.transform.subarray(i * 4, (i + 1) * 4), obj[i]);\n          }\n          mat4.transpose(this.transform, this.transform);\n        } catch (ignoredError) {\n          this.reset();\n        }\n        return;\n      }\n      if (obj.length === 16) {\n        try {\n          parseFiniteVec(this.transform, obj);\n          mat4.transpose(this.transform, this.transform);\n        } catch (ignoredError) {\n          this.reset();\n        }\n        return;\n      }\n      // Invalid size.\n      this.reset();\n      return;\n    }\n\n    if (typeof obj === 'object') {\n      const rotation = quat.create();\n      const translation = vec3.create();\n      const scale = vec3.fromValues(1, 1, 1);\n      try {\n        parseFiniteVec(rotation, obj['rotation']);\n        quat.normalize(rotation, rotation);\n      } catch (ignoredError) {\n        quat.identity(rotation);\n      }\n\n      try {\n        parseFiniteVec(translation, obj['translation']);\n      } catch (ignoredError) {\n        vec3.copy(translation, kZeroVec);\n      }\n\n      try {\n        parseFiniteVec(scale, obj['scale']);\n      } catch (ignoredError) {\n        vec3.copy(scale, kOneVec);\n      }\n      mat4.fromRotationTranslationScale(this.transform, rotation, translation, scale);\n      this.changed.dispatch();\n    } else {\n      this.reset();\n    }\n  }\n\n  clone() {\n    return new CoordinateTransform(mat4.clone(this.transform));\n  }\n}\n\nexport function makeDerivedCoordinateTransform(\n    derivedTransform: CoordinateTransform, baseTransform: CoordinateTransform,\n    update: (output: mat4, input: mat4) => void): () => void {\n  update(derivedTransform.transform, baseTransform.transform);\n  return baseTransform.changed.add(() => {\n    update(derivedTransform.transform, baseTransform.transform);\n    derivedTransform.changed.dispatch();\n  });\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Facilities to simplify defining subclasses of ChunkSource that use a CredentialsProvider.\n */\n\nimport {ChunkManager, ChunkSourceConstructor} from 'neuroglancer/chunk_manager/frontend';\nimport {CredentialsProvider} from 'neuroglancer/credentials_provider';\nimport {SharedCredentialsProvider} from 'neuroglancer/credentials_provider/shared';\nimport {Borrowed, Owned} from 'neuroglancer/util/disposable';\nimport {getObjectId} from 'neuroglancer/util/object_id';\nimport {RPC, SharedObject} from 'neuroglancer/worker_rpc';\n\n/**\n * Returns a counterpart ref to be sent to the backend to retrieve a\n * SharedCredentialsProviderCounterpart that forwards to `credentialsProvider`.\n */\nexport function getCredentialsProviderCounterpart<Credentials>(\n    chunkManager: ChunkManager, credentialsProvider: Borrowed<CredentialsProvider<Credentials>>) {\n  const sharedCredentialsProvider = chunkManager.memoize.get(\n      {type: 'getSharedCredentialsProvider', credentialsProvider: getObjectId(credentialsProvider)},\n      () => new SharedCredentialsProvider(credentialsProvider.addRef(), chunkManager.rpc!));\n  const counterpartRef = sharedCredentialsProvider.addCounterpartRef();\n  sharedCredentialsProvider.dispose();\n  return counterpartRef;\n}\n\n/**\n * Mixin for adding a credentialsProvider member to a ChunkSource.\n */\nexport function WithCredentialsProvider<Credentials>() {\n  return function<BaseOptions, TBase extends ChunkSourceConstructor<\n                      BaseOptions, SharedObject&{chunkManager: ChunkManager}>>(Base: TBase) {\n    type Options = BaseOptions&{credentialsProvider: Borrowed<CredentialsProvider<Credentials>>};\n    return class extends Base {\n      credentialsProvider: Owned<CredentialsProvider<Credentials>>;\n      constructor(...args: any[]) {\n        super(...args);\n        const options: Options = args[1];\n        this.credentialsProvider = options.credentialsProvider.addRef();\n      }\n      initializeCounterpart(rpc: RPC, options: any) {\n        options['credentialsProvider'] =\n            getCredentialsProviderCounterpart(this.chunkManager, this.credentialsProvider);\n        super.initializeCounterpart(rpc, options);\n      }\n      static encodeOptions(options: Options) {\n        const encoding = super.encodeOptions(options);\n        encoding.credentialsProvider = getObjectId(options.credentialsProvider);\n        return encoding;\n      }\n    };\n  };\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file CredentialsManager for globally registering a CredentialsProvider\n */\n\nimport {CachingMapBasedCredentialsManager} from 'neuroglancer/credentials_provider';\n\nexport const defaultCredentialsManager = new CachingMapBasedCredentialsManager();\n","/**\n * @license\n * Copyright 2019 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {CredentialsProvider, CredentialsWithGeneration} from 'neuroglancer/credentials_provider';\nimport {CancellationToken, uncancelableToken} from 'neuroglancer/util/cancellation';\nimport {cancellableFetchOk, HttpError, ResponseTransform} from 'neuroglancer/util/http_request';\n\nexport async function fetchWithCredentials<Credentials, T>(\n    credentialsProvider: CredentialsProvider<Credentials>, input: RequestInfo, init: RequestInit,\n    transformResponse: ResponseTransform<T>,\n    applyCredentials: (credentials: Credentials, requestInit: RequestInit) => RequestInit,\n    errorHandler: (httpError: HttpError) => 'refresh' | 'retry',\n    cancellationToken: CancellationToken = uncancelableToken): Promise<T> {\n  let credentials: CredentialsWithGeneration<Credentials>|undefined;\n  credentialsLoop: while (true) {\n    credentials = await credentialsProvider.get(credentials, cancellationToken);\n    requestLoop: while (true) {\n      try {\n        return await cancellableFetchOk(\n            input, applyCredentials(credentials.credentials, init), transformResponse,\n            cancellationToken);\n      } catch (error) {\n        if (error instanceof HttpError) {\n          if (errorHandler(error) === 'refresh') continue credentialsLoop;\n          continue requestLoop;\n        }\n        throw error;\n      }\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Generic facility for providing authentication/authorization credentials.\n */\n\nimport {CancellationToken, MultipleConsumerCancellationTokenSource} from 'neuroglancer/util/cancellation';\nimport {Owned, RefCounted} from 'neuroglancer/util/disposable';\nimport {StringMemoize} from 'neuroglancer/util/memoize';\n\n/**\n * Wraps an arbitrary JSON credentials object with a generation number.\n *\n * The generation number is used for tracking whether the credentials have been updated/renewed.\n */\nexport interface CredentialsWithGeneration<T> {\n  generation: number;\n  credentials: T;\n}\n\nexport abstract class CredentialsProvider<Credentials> extends RefCounted {\n  /**\n   * Request valid credentials.  If `invalidCredentials` is specified, it indicates that the\n   * specified credentials are invalid.\n   *\n   * This method can be conveniently defined using the `makeCredentialsGetter` function.\n   */\n  abstract get:\n      (invalidCredentials?: CredentialsWithGeneration<Credentials>,\n       cancellationToken?: CancellationToken) => Promise<CredentialsWithGeneration<Credentials>>;\n}\n\nexport function makeCachedCredentialsGetter<Credentials>(\n    getUncached: (\n        invalidCredentials: CredentialsWithGeneration<Credentials>|undefined,\n        cancellationToken: CancellationToken) => Promise<CredentialsWithGeneration<Credentials>>) {\n  let cachedCredentials: CredentialsWithGeneration<Credentials>|undefined;\n  let pendingCredentials: Promise<CredentialsWithGeneration<Credentials>>|undefined;\n  let pendingCancellationToken: MultipleConsumerCancellationTokenSource|undefined;\n  return (invalidCredentials?: CredentialsWithGeneration<Credentials>,\n          cancellationToken?: CancellationToken) => {\n    if (pendingCredentials !== undefined &&\n        (cachedCredentials === undefined || invalidCredentials === undefined ||\n         cachedCredentials.generation !== invalidCredentials.generation)) {\n      if (cachedCredentials === undefined) {\n        pendingCancellationToken!.addConsumer(cancellationToken);\n      }\n      return pendingCredentials;\n    }\n    cachedCredentials = undefined;\n    pendingCancellationToken = new MultipleConsumerCancellationTokenSource();\n    pendingCredentials = getUncached(invalidCredentials, pendingCancellationToken)\n                             .then(\n                                 credentials => {\n                                   cachedCredentials = credentials;\n                                   pendingCancellationToken = undefined;\n                                   return credentials;\n                                 },\n                                 reason => {\n                                   if (pendingCancellationToken!.isCanceled) {\n                                     pendingCancellationToken = undefined;\n                                     pendingCredentials = undefined;\n                                   }\n                                   throw reason;\n                                 });\n    return pendingCredentials;\n  };\n}\n\nexport function makeCredentialsGetter<Credentials>(\n    getWithoutGeneration: (cancellationToken: CancellationToken) => Promise<Credentials>) {\n  let generation = 0;\n  return makeCachedCredentialsGetter<Credentials>(\n      (_invalidCredentials, cancellationToken) =>\n          getWithoutGeneration(cancellationToken)\n              .then(credentials => ({generation: ++generation, credentials})));\n}\n\n/**\n * Interface for obtaining a CredentialsProvider based on a string key.\n */\nexport interface CredentialsManager {\n  getCredentialsProvider<Credentials>(key: string, parameters?: any):\n      Owned<CredentialsProvider<Credentials>>;\n}\n\n/**\n * CredentialsManager that supports registration.\n */\nexport class MapBasedCredentialsManager implements CredentialsManager {\n  providers = new Map<string, (parameters: any) => Owned<CredentialsProvider<any>>>();\n  register<Credentials>(\n      key: string, providerGetter: (parameters: any) => Owned<CredentialsProvider<Credentials>>) {\n    this.providers.set(key, providerGetter);\n  }\n\n  getCredentialsProvider<Credentials>(key: string, parameters?: any):\n      Owned<CredentialsProvider<Credentials>> {\n    const getter = this.providers.get(key);\n    if (getter === undefined) {\n      throw new Error(`No registered credentials provider: ${JSON.stringify(key)}`);\n    }\n    return getter(parameters);\n  }\n}\n\n/**\n * CredentialsManager that wraps another and caches the CredentialsProvider objects.\n */\nexport class CachingCredentialsManager<Base extends CredentialsManager> extends RefCounted\n    implements CredentialsManager {\n  memoize = new StringMemoize();\n\n  constructor(public base: Base) {\n    super();\n  }\n\n  getCredentialsProvider<Credentials>(key: string, parameters?: any):\n      Owned<CredentialsProvider<Credentials>> {\n    return this.memoize.get(\n        {key, parameters},\n        () => this.registerDisposer(\n            this.base.getCredentialsProvider<Credentials>(key, parameters).addRef()));\n  }\n}\n\nexport class CachingMapBasedCredentialsManager extends\n    CachingCredentialsManager<MapBasedCredentialsManager> {\n  constructor() {\n    super(new MapBasedCredentialsManager());\n  }\n\n  register<Credentials>(\n      key: string, providerGetter: (parameters: any) => Owned<CredentialsProvider<Credentials>>) {\n    this.base.register(key, providerGetter);\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Permits a CredentialsProvider to be shared with another thread.\n */\n\nimport {CREDENTIALS_PROVIDER_RPC_ID, CREDENTIALS_PROVIDER_GET_RPC_ID} from 'neuroglancer/credentials_provider/shared_common';\nimport {CredentialsProvider, CredentialsWithGeneration} from 'neuroglancer/credentials_provider';\nimport {CancellationToken} from 'neuroglancer/util/cancellation';\nimport {Owned} from 'neuroglancer/util/disposable';\nimport {registerPromiseRPC, registerSharedObjectOwner, RPC, RPCPromise, SharedObject} from 'neuroglancer/worker_rpc';\n\n@registerSharedObjectOwner(CREDENTIALS_PROVIDER_RPC_ID)\nexport class SharedCredentialsProvider<Credentials> extends SharedObject implements\n    CredentialsProvider<Credentials> {\n  constructor(public provider: Owned<CredentialsProvider<Credentials>>, rpc: RPC) {\n    super();\n    this.registerDisposer(provider);\n    this.initializeCounterpart(rpc);\n  }\n\n  get(invalidCredentials?: CredentialsWithGeneration<Credentials>,\n      cancellationToken?: CancellationToken): Promise<CredentialsWithGeneration<Credentials>> {\n    return this.provider.get(invalidCredentials, cancellationToken);\n  }\n}\n\nregisterPromiseRPC(\n    CREDENTIALS_PROVIDER_GET_RPC_ID,\n    function(\n        this: RPC, x: {providerId: number, invalidCredentials: any}, cancellationToken: CancellationToken):\n        RPCPromise<CredentialsWithGeneration<any>> {\n          const obj = <SharedCredentialsProvider<any>>this.get(x.providerId);\n          return obj.get(x.invalidCredentials, cancellationToken).then(credentials => ({\n                                                                         value: credentials\n                                                                       }));\n        });\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\nexport const CREDENTIALS_PROVIDER_RPC_ID = 'CredentialsProvider';\nexport const CREDENTIALS_PROVIDER_GET_RPC_ID = 'CredentialsProvider.get';\n\n","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport 'neuroglancer/ui/button.css';\nimport 'neuroglancer/data_panel_layout.css';\n\nimport debounce from 'lodash/debounce';\nimport {ChunkManager} from 'neuroglancer/chunk_manager/frontend';\nimport {DisplayContext} from 'neuroglancer/display_context';\nimport {LayerManager, MouseSelectionState, RenderLayerRole, SelectedLayerState} from 'neuroglancer/layer';\nimport * as L from 'neuroglancer/layout';\nimport {LinkedOrientationState, LinkedSpatialPosition, LinkedZoomState, NavigationState, OrientationState, Pose} from 'neuroglancer/navigation_state';\nimport {PerspectivePanel} from 'neuroglancer/perspective_view/panel';\nimport {RenderedDataPanel} from 'neuroglancer/rendered_data_panel';\nimport {SliceView} from 'neuroglancer/sliceview/frontend';\nimport {SliceViewerState, SliceViewPanel} from 'neuroglancer/sliceview/panel';\nimport {TrackableBoolean} from 'neuroglancer/trackable_boolean';\nimport {TrackableValue, WatchableSet} from 'neuroglancer/trackable_value';\nimport {TrackableRGB} from 'neuroglancer/util/color';\nimport {Borrowed, Owned, RefCounted} from 'neuroglancer/util/disposable';\nimport {removeChildren, removeFromParent} from 'neuroglancer/util/dom';\nimport {EventActionMap, registerActionListener} from 'neuroglancer/util/event_action_map';\nimport {quat} from 'neuroglancer/util/geom';\nimport {verifyObject, verifyObjectProperty, verifyPositiveInt} from 'neuroglancer/util/json';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {Trackable} from 'neuroglancer/util/trackable';\nimport {WatchableMap} from 'neuroglancer/util/watchable_map';\nimport {VisibilityPrioritySpecification} from 'neuroglancer/viewer_state';\nimport {ScaleBarOptions} from 'neuroglancer/widget/scale_bar';\n\nexport interface SliceViewViewerState {\n  chunkManager: ChunkManager;\n  navigationState: NavigationState;\n  layerManager: LayerManager;\n}\n\nexport class InputEventBindings {\n  perspectiveView = new EventActionMap();\n  sliceView = new EventActionMap();\n}\n\nexport interface ViewerUIState extends SliceViewViewerState, VisibilityPrioritySpecification {\n  display: DisplayContext;\n  mouseState: MouseSelectionState;\n  perspectiveNavigationState: NavigationState;\n  showPerspectiveSliceViews: TrackableBoolean;\n  showAxisLines: TrackableBoolean;\n  showScaleBar: TrackableBoolean;\n  scaleBarOptions: TrackableValue<ScaleBarOptions>;\n  visibleLayerRoles: WatchableSet<RenderLayerRole>;\n  selectedLayer: SelectedLayerState;\n  inputEventBindings: InputEventBindings;\n  crossSectionBackgroundColor: TrackableRGB;\n  perspectiveViewBackgroundColor: TrackableRGB;\n}\n\nexport interface DataDisplayLayout extends RefCounted {\n  rootElement: HTMLElement;\n  container: DataPanelLayoutContainer;\n}\n\ntype NamedAxes = 'xy'|'xz'|'yz';\n\nconst AXES_RELATIVE_ORIENTATION = new Map<NamedAxes, quat|undefined>([\n  ['xy', undefined],\n  ['xz', quat.rotateX(quat.create(), quat.create(), Math.PI / 2)],\n  ['yz', quat.rotateY(quat.create(), quat.create(), Math.PI / 2)],\n]);\n\nconst oneSquareSymbol = '';\n\nconst LAYOUT_SYMBOLS = new Map<string, string>([\n  ['4panel', ''],\n  ['3d', oneSquareSymbol],\n]);\n\nexport function makeSliceView(viewerState: SliceViewViewerState, baseToSelf?: quat) {\n  let navigationState: NavigationState;\n  if (baseToSelf === undefined) {\n    navigationState = viewerState.navigationState;\n  } else {\n    navigationState = new NavigationState(\n        new Pose(\n            viewerState.navigationState.pose.position,\n            OrientationState.makeRelative(\n                viewerState.navigationState.pose.orientation, baseToSelf)),\n        viewerState.navigationState.zoomFactor);\n  }\n  return new SliceView(viewerState.chunkManager, viewerState.layerManager, navigationState);\n}\n\nexport function makeNamedSliceView(viewerState: SliceViewViewerState, axes: NamedAxes) {\n  return makeSliceView(viewerState, AXES_RELATIVE_ORIENTATION.get(axes)!);\n}\n\nexport function makeOrthogonalSliceViews(viewerState: SliceViewViewerState) {\n  return new Map<NamedAxes, SliceView>([\n    ['xy', makeNamedSliceView(viewerState, 'xy')],\n    ['xz', makeNamedSliceView(viewerState, 'xz')],\n    ['yz', makeNamedSliceView(viewerState, 'yz')],\n  ]);\n}\n\nexport function getCommonViewerState(viewer: ViewerUIState) {\n  return {\n    crossSectionBackgroundColor: viewer.crossSectionBackgroundColor,\n    perspectiveViewBackgroundColor: viewer.perspectiveViewBackgroundColor,\n    mouseState: viewer.mouseState,\n    layerManager: viewer.layerManager,\n    showAxisLines: viewer.showAxisLines,\n    visibleLayerRoles: viewer.visibleLayerRoles,\n    selectedLayer: viewer.selectedLayer,\n    visibility: viewer.visibility,\n    scaleBarOptions: viewer.scaleBarOptions,\n  };\n}\n\nfunction getCommonPerspectiveViewerState(container: DataPanelLayoutContainer) {\n  const {viewer} = container;\n  return {\n    ...getCommonViewerState(viewer),\n    navigationState: viewer.perspectiveNavigationState,\n    inputEventMap: viewer.inputEventBindings.perspectiveView,\n    orthographicProjection: container.specification.orthographicProjection,\n    showScaleBar: viewer.showScaleBar,\n    rpc: viewer.chunkManager.rpc!,\n  };\n}\n\nfunction getCommonSliceViewerState(viewer: ViewerUIState) {\n  return {\n    ...getCommonViewerState(viewer),\n    navigationState: viewer.navigationState,\n    inputEventMap: viewer.inputEventBindings.sliceView,\n  };\n}\n\nfunction registerRelatedLayouts(\n  layout: DataDisplayLayout, panel: RenderedDataPanel, relatedLayouts: string[]) {\n  const controls = document.createElement('div');\n  controls.className = 'neuroglancer-data-panel-layout-controls';\n  layout.registerDisposer(() => removeFromParent(controls));\n  for (let i = 0; i < 2; ++i) {\n    const relatedLayout = relatedLayouts[Math.min(relatedLayouts.length - 1, i)];\n    layout.registerDisposer(registerActionListener(\n        panel.element, i === 0 ? 'toggle-layout' : 'toggle-layout-alternative', (event: Event) => {\n          layout.container.name = relatedLayout;\n          event.stopPropagation();\n        }));\n  }\n  for (const relatedLayout of relatedLayouts) {\n    const button = document.createElement('button');\n    const innerDiv = document.createElement('div');\n    button.appendChild(innerDiv);\n    innerDiv.textContent = LAYOUT_SYMBOLS.get(relatedLayout)!;\n    button.title = `Switch to ${relatedLayout} layout.`;\n    button.addEventListener('click', () => {\n      layout.container.name = relatedLayout;\n    });\n    controls.appendChild(button);\n  }\n  panel.element.appendChild(controls);\n}\n\nfunction makeSliceViewFromSpecification(\n    viewer: SliceViewViewerState, specification: Borrowed<CrossSectionSpecification>) {\n  const sliceView = new SliceView(\n      viewer.chunkManager, viewer.layerManager, specification.navigationState.addRef());\n  const updateViewportSize = () => {\n    sliceView.setViewportSizeDebounced(specification.width.value, specification.height.value);\n  };\n  sliceView.registerDisposer(specification.width.changed.add(updateViewportSize));\n  sliceView.registerDisposer(specification.height.changed.add(updateViewportSize));\n  updateViewportSize();\n  return sliceView;\n}\n\nfunction addUnconditionalSliceViews(\n    viewer: SliceViewViewerState, panel: PerspectivePanel,\n    crossSections: Borrowed<CrossSectionSpecificationMap>) {\n  const previouslyAdded = new Map<Borrowed<CrossSectionSpecification>, Borrowed<SliceView>>();\n  const update = () => {\n    const currentCrossSections = new Set<Borrowed<CrossSectionSpecification>>();\n    // Add missing cross sections.\n    for (const crossSection of crossSections.values()) {\n      currentCrossSections.add(crossSection);\n      if (previouslyAdded.has(crossSection)) {\n        continue;\n      }\n      const sliceView = makeSliceViewFromSpecification(viewer, crossSection);\n      panel.sliceViews.set(sliceView, true);\n      previouslyAdded.set(crossSection, sliceView);\n    }\n    // Remove extra cross sections.\n    for (const [crossSection, sliceView] of previouslyAdded) {\n      if (currentCrossSections.has(crossSection)) {\n        continue;\n      }\n      panel.sliceViews.delete(sliceView);\n    }\n  };\n  update();\n}\n\nexport class FourPanelLayout extends RefCounted {\n  constructor(\n      public container: DataPanelLayoutContainer, public rootElement: HTMLElement,\n      public viewer: ViewerUIState, crossSections: Borrowed<CrossSectionSpecificationMap>) {\n    super();\n\n    let sliceViews = makeOrthogonalSliceViews(viewer);\n    let {display} = viewer;\n\n    const perspectiveViewerState = {\n      ...getCommonPerspectiveViewerState(container),\n      showSliceViews: viewer.showPerspectiveSliceViews,\n      showSliceViewsCheckbox: true,\n    };\n\n    const sliceViewerState = {\n      ...getCommonSliceViewerState(viewer),\n      showScaleBar: viewer.showScaleBar,\n    };\n\n    const sliceViewerStateWithoutScaleBar = {\n      ...getCommonSliceViewerState(viewer),\n      showScaleBar: new TrackableBoolean(false, false),\n    };\n\n    const makeSliceViewPanel = (axes: NamedAxes, element: HTMLElement, state: SliceViewerState) => {\n      const panel =\n          this.registerDisposer(new SliceViewPanel(display, element, sliceViews.get(axes)!, state));\n      registerRelatedLayouts(this, panel, [axes, `${axes}-3d`]);\n      return panel;\n    };\n    let mainDisplayContents = [\n      L.withFlex(1, L.box('column', [\n        L.withFlex(1, L.box('row', [\n          L.withFlex(1, element => {\n            makeSliceViewPanel('xy', element, sliceViewerState);\n          }),\n          L.withFlex(1, element => {\n            makeSliceViewPanel('xz', element, sliceViewerStateWithoutScaleBar);\n          })\n        ])),\n        L.withFlex(1, L.box('row', [\n          L.withFlex(1, element => {\n            let panel = this.registerDisposer(\n                new PerspectivePanel(display, element, perspectiveViewerState));\n            for (let sliceView of sliceViews.values()) {\n              panel.sliceViews.set(sliceView.addRef(), false);\n            }\n            addUnconditionalSliceViews(viewer, panel, crossSections);\n            registerRelatedLayouts(this, panel, ['3d']);\n          }),\n          L.withFlex(1, element => {\n            makeSliceViewPanel('yz', element, sliceViewerStateWithoutScaleBar);\n          })\n        ])),\n      ]))\n    ];\n    L.box('row', mainDisplayContents)(rootElement);\n  }\n\n  disposed() {\n    removeChildren(this.rootElement);\n    super.disposed();\n  }\n}\n\nexport class SliceViewPerspectiveTwoPanelLayout extends RefCounted {\n  constructor(\n      public container: DataPanelLayoutContainer, public rootElement: HTMLElement,\n      public viewer: ViewerUIState, public direction: 'row'|'column', axes: NamedAxes,\n      crossSections: Borrowed<CrossSectionSpecificationMap>) {\n    super();\n\n    let sliceView = makeNamedSliceView(viewer, axes);\n    let {display} = viewer;\n\n    const perspectiveViewerState = {\n      ...getCommonPerspectiveViewerState(container),\n      showSliceViews: viewer.showPerspectiveSliceViews,\n      showSliceViewsCheckbox: true,\n    };\n\n    const sliceViewerState = {\n      ...getCommonSliceViewerState(viewer),\n      showScaleBar: viewer.showScaleBar,\n    };\n\n    L.withFlex(1, L.box(direction, [\n      L.withFlex(\n          1,\n          element => {\n            const panel = this.registerDisposer(\n                new SliceViewPanel(display, element, sliceView, sliceViewerState));\n            registerRelatedLayouts(this, panel, [axes, '4panel']);\n          }),\n      L.withFlex(\n          1,\n          element => {\n            let panel = this.registerDisposer(\n                new PerspectivePanel(display, element, perspectiveViewerState));\n            panel.sliceViews.set(sliceView.addRef(), false);\n            addUnconditionalSliceViews(viewer, panel, crossSections);\n            registerRelatedLayouts(this, panel, ['3d', '4panel']);\n          }),\n    ]))(rootElement);\n  }\n\n  disposed() {\n    removeChildren(this.rootElement);\n    super.disposed();\n  }\n}\n\nexport class SinglePanelLayout extends RefCounted {\n  constructor(\n      public container: DataPanelLayoutContainer, public rootElement: HTMLElement,\n      public viewer: ViewerUIState, axes: NamedAxes) {\n    super();\n    let sliceView = makeNamedSliceView(viewer, axes);\n    const sliceViewerState = {\n      ...getCommonSliceViewerState(viewer),\n      showScaleBar: viewer.showScaleBar,\n    };\n\n    L.box('row', [L.withFlex(1, element => {\n            const panel = this.registerDisposer(\n                new SliceViewPanel(viewer.display, element, sliceView, sliceViewerState));\n            registerRelatedLayouts(this, panel, ['4panel', `${axes}-3d`]);\n          })])(rootElement);\n  }\n\n  disposed() {\n    removeChildren(this.rootElement);\n    super.disposed();\n  }\n}\n\nexport class SinglePerspectiveLayout extends RefCounted {\n  constructor(\n      public container: DataPanelLayoutContainer, public rootElement: HTMLElement,\n      public viewer: ViewerUIState, crossSections: Borrowed<CrossSectionSpecificationMap>) {\n    super();\n    let perspectiveViewerState = {\n      ...getCommonPerspectiveViewerState(container),\n      showSliceViews: new TrackableBoolean(false, false),\n    };\n\n\n    L.box('row', [L.withFlex(1, element => {\n            const panel = this.registerDisposer(\n                new PerspectivePanel(viewer.display, element, perspectiveViewerState));\n            addUnconditionalSliceViews(viewer, panel, crossSections);\n            registerRelatedLayouts(this, panel, ['4panel']);\n          })])(rootElement);\n  }\n\n  disposed() {\n    removeChildren(this.rootElement);\n    super.disposed();\n  }\n}\n\nexport const LAYOUTS = new Map<string, {\n  factory:\n      (container: DataPanelLayoutContainer, element: HTMLElement, viewer: ViewerUIState,\n       crossSections: Borrowed<CrossSectionSpecificationMap>) => DataDisplayLayout\n}>(\n    [\n      [\n        '4panel', {\n          factory: (container, element, viewer, crossSections) =>\n              new FourPanelLayout(container, element, viewer, crossSections)\n        }\n      ],\n      [\n        '3d', {\n          factory: (container, element, viewer, crossSections) =>\n              new SinglePerspectiveLayout(container, element, viewer, crossSections)\n        }\n      ],\n    ],\n);\n\nfor (const axes of AXES_RELATIVE_ORIENTATION.keys()) {\n  LAYOUTS.set(axes, {\n    factory: (container, element, viewer) =>\n        new SinglePanelLayout(container, element, viewer, <NamedAxes>axes)\n  });\n  const splitLayout = `${axes}-3d`;\n  LAYOUT_SYMBOLS.set(axes, oneSquareSymbol);\n  LAYOUT_SYMBOLS.set(splitLayout, '');\n  LAYOUTS.set(splitLayout, {\n    factory: (container, element, viewer, crossSections) => new SliceViewPerspectiveTwoPanelLayout(\n        container, element, viewer, 'row', <NamedAxes>axes, crossSections)\n  });\n}\n\nexport function getLayoutByName(obj: any) {\n  let layout = LAYOUTS.get(obj);\n  if (layout === undefined) {\n    throw new Error(`Invalid layout name: ${JSON.stringify(obj)}.`);\n  }\n  return layout;\n}\n\nexport function validateLayoutName(obj: any) {\n  getLayoutByName(obj);\n  return <string>obj;\n}\n\nexport class CrossSectionSpecification extends RefCounted implements Trackable {\n  width = new TrackableValue<number>(1000, verifyPositiveInt);\n  height = new TrackableValue<number>(1000, verifyPositiveInt);\n  position: LinkedSpatialPosition;\n  orientation: LinkedOrientationState;\n  zoom: LinkedZoomState;\n  navigationState: NavigationState;\n  changed = new NullarySignal();\n  constructor(parent: Borrowed<NavigationState>) {\n    super();\n    this.position = new LinkedSpatialPosition(parent.position.addRef());\n    this.position.changed.add(this.changed.dispatch);\n    this.orientation = new LinkedOrientationState(parent.pose.orientation.addRef());\n    this.orientation.changed.add(this.changed.dispatch);\n    this.width.changed.add(this.changed.dispatch);\n    this.height.changed.add(this.changed.dispatch);\n    this.zoom = new LinkedZoomState(parent.zoomFactor.addRef());\n    this.zoom.changed.add(this.changed.dispatch);\n    this.navigationState = this.registerDisposer(new NavigationState(\n        new Pose(this.position.value, this.orientation.value), this.zoom.value));\n  }\n\n  restoreState(obj: any) {\n    verifyObject(obj);\n    verifyObjectProperty(obj, 'width', x => x !== undefined && this.width.restoreState(x));\n    verifyObjectProperty(obj, 'height', x => x !== undefined && this.height.restoreState(x));\n    verifyObjectProperty(obj, 'position', x => x !== undefined && this.position.restoreState(x));\n    verifyObjectProperty(\n        obj, 'orientation', x => x !== undefined && this.orientation.restoreState(x));\n    verifyObjectProperty(obj, 'zoom', x => x !== undefined && this.zoom.restoreState(x));\n  }\n\n  reset() {\n    this.width.reset();\n    this.height.reset();\n    this.position.reset();\n    this.orientation.reset();\n    this.zoom.reset();\n  }\n\n  toJSON() {\n    return {\n      width: this.width.toJSON(),\n      height: this.height.toJSON(),\n      position: this.position.toJSON(),\n      orientation: this.orientation.toJSON(),\n      zoom: this.zoom.toJSON(),\n    };\n  }\n}\n\nexport class CrossSectionSpecificationMap extends WatchableMap<string, CrossSectionSpecification> {\n  constructor(private parentNavigationState: Owned<NavigationState>) {\n    super(\n        v => this.registerDisposer(this.registerDisposer(v).changed.add(this.changed.dispatch)),\n        v => {\n          v.changed.remove(this.changed.dispatch);\n          v.dispose();\n        });\n    this.registerDisposer(parentNavigationState);\n  }\n\n  restoreState(obj: any) {\n    verifyObject(obj);\n    for (const key of Object.keys(obj)) {\n      const state = new CrossSectionSpecification(this.parentNavigationState);\n      try {\n        this.set(key, state.addRef());\n        state.restoreState(obj[key]);\n      } finally {\n        state.dispose();\n      }\n    }\n  }\n\n  reset() {\n    this.clear();\n  }\n\n  toJSON() {\n    if (this.size === 0) return undefined;\n    const obj: {[key: string]: any} = {};\n    for (const [k, v] of this) {\n      obj[k] = v.toJSON();\n    }\n    return obj;\n  }\n}\n\nexport class DataPanelLayoutSpecification extends RefCounted implements Trackable {\n  changed = new NullarySignal();\n  type: TrackableValue<string>;\n  crossSections: CrossSectionSpecificationMap;\n  orthographicProjection = new TrackableBoolean(false);\n\n  constructor(parentNavigationState: Owned<NavigationState>, defaultLayout: string) {\n    super();\n    this.type = new TrackableValue<string>(defaultLayout, validateLayoutName);\n    this.type.changed.add(this.changed.dispatch);\n    this.crossSections =\n        this.registerDisposer(new CrossSectionSpecificationMap(parentNavigationState));\n    this.crossSections.changed.add(this.changed.dispatch);\n    this.orthographicProjection.changed.add(this.changed.dispatch);\n    this.registerDisposer(parentNavigationState);\n  }\n\n  reset() {\n    this.crossSections.clear();\n    this.orthographicProjection.reset();\n    this.type.reset();\n  }\n\n  restoreState(obj: any) {\n    this.crossSections.clear();\n    this.orthographicProjection.reset();\n    if (typeof obj === 'string') {\n      this.type.restoreState(obj);\n    } else {\n      verifyObject(obj);\n      verifyObjectProperty(obj, 'type', x => this.type.restoreState(x));\n      verifyObjectProperty(\n          obj, 'orthographicProjection', x => this.orthographicProjection.restoreState(x));\n      verifyObjectProperty(\n          obj, 'crossSections', x => x !== undefined && this.crossSections.restoreState(x));\n    }\n  }\n\n  toJSON() {\n    const {type, crossSections, orthographicProjection} = this;\n    const orthographicProjectionJson = orthographicProjection.toJSON();\n    if (crossSections.size === 0 && orthographicProjectionJson === undefined) {\n      return type.value;\n    }\n    return {\n      type: type.value,\n      crossSections: crossSections.toJSON(),\n      orthographicProjection: orthographicProjectionJson,\n    };\n  }\n}\n\nexport class DataPanelLayoutContainer extends RefCounted {\n  element = document.createElement('div');\n  specification: Owned<DataPanelLayoutSpecification>;\n\n  private layout: DataDisplayLayout|undefined;\n\n  get name() {\n    return this.specification.type.value;\n  }\n  set name(value: string) {\n    this.specification.type.value = value;\n  }\n\n  constructor(public viewer: ViewerUIState, defaultLayout: string) {\n    super();\n    this.specification = this.registerDisposer(\n        new DataPanelLayoutSpecification(this.viewer.navigationState.addRef(), defaultLayout));\n    this.element.style.flex = '1';\n    const scheduleUpdateLayout = this.registerCancellable(debounce(() => this.updateLayout(), 0));\n    this.specification.type.changed.add(scheduleUpdateLayout);\n\n    registerActionListener(\n        this.element, 'toggle-orthographic-projection',\n        () => this.specification.orthographicProjection.toggle());\n\n    // Ensure the layout is updated before drawing begins to avoid flicker.\n    this.registerDisposer(\n        this.viewer.display.updateStarted.add(() => scheduleUpdateLayout.flush()));\n    scheduleUpdateLayout();\n  }\n  get changed() {\n    return this.specification.changed;\n  }\n  toJSON() {\n    return this.specification.toJSON();\n  }\n  restoreState(obj: any) {\n    this.specification.restoreState(obj);\n  }\n  reset() {\n    this.specification.reset();\n  }\n  private disposeLayout() {\n    let {layout} = this;\n    if (layout !== undefined) {\n      layout.dispose();\n      this.layout = undefined;\n    }\n  }\n  private updateLayout() {\n    this.disposeLayout();\n    this.layout = getLayoutByName(this.name).factory(\n        this, this.element, this.viewer, this.specification.crossSections);\n  }\n  disposed() {\n    this.disposeLayout();\n    super.disposed();\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {CredentialsProvider} from 'neuroglancer/credentials_provider';\nimport {fetchWithCredentials} from 'neuroglancer/credentials_provider/http_request';\nimport {CancellationToken, uncancelableToken} from 'neuroglancer/util/cancellation';\nimport {ResponseTransform} from 'neuroglancer/util/http_request';\n\nexport type BossToken = string;\n\n/**\n * Key used for retrieving the CredentialsProvider from a CredentialsManager.\n */\nexport const credentialsKey = 'boss';\n\nexport function fetchWithBossCredentials<T>(\n    credentialsProvider: CredentialsProvider<BossToken>, input: RequestInfo, init: RequestInit,\n    transformResponse: ResponseTransform<T>,\n    cancellationToken: CancellationToken = uncancelableToken): Promise<T> {\n  return fetchWithCredentials(\n      credentialsProvider, input, init, transformResponse,\n      credentials => {\n        const headers = new Headers(init.headers);\n        headers.set('Authorization', `Bearer ${credentials}`);\n        return {...init, headers};\n      },\n      error => {\n        const {status} = error;\n        if (status === 403 || status === 401) {\n          // Authorization needed.  Retry with refreshed token.\n          return 'refresh';\n        }\n        if (status === 504) {\n          // Gateway timeout can occur if the server takes too long to reply.  Retry.\n          return 'retry';\n        }\n        throw error;\n      },\n      cancellationToken);\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {vec2} from 'neuroglancer/util/geom';\n\nexport class BossSourceParameters {\n  baseUrl: string;\n  authServer: string;\n  collection: string;\n  experiment: string;\n  channel: string;\n  resolution: string;\n}\n\nexport class VolumeChunkSourceParameters extends BossSourceParameters {\n  encoding: string;\n  window: vec2|undefined;\n\n  static RPC_ID = 'boss/VolumeChunkSource';\n\n  static stringify(parameters: VolumeChunkSourceParameters) {\n    return `boss:volume:${parameters.baseUrl}/${parameters.collection}/${\n        parameters.experiment}/${parameters.channel}/${parameters.resolution}/${\n        parameters.encoding}`;\n  }\n}\n\nexport class MeshSourceParameters {\n  baseUrl: string;\n\n  static RPC_ID = 'boss/MeshChunkSource';\n\n  static stringify(parameters: MeshSourceParameters) {\n    return `boss:mesh:${parameters.baseUrl}`;\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file\n * This implements a CredentialsProvider based on Keycloak.\n * The current implementation uses the implicit flow for ease of implementation.\n * TODO: Implement the authorization or hybrid flows.\n * TODO: Use an iframe to test for immediate login (active session).\n */\n\nimport {CredentialsProvider, makeCredentialsGetter} from 'neuroglancer/credentials_provider';\nimport {StatusMessage} from 'neuroglancer/status';\nimport {CANCELED, CancellationTokenSource, uncancelableToken} from 'neuroglancer/util/cancellation';\nimport {verifyObject, verifyString} from 'neuroglancer/util/json';\nimport {getRandomHexString} from 'neuroglancer/util/random';\nimport {Signal} from 'neuroglancer/util/signal';\n\nexport type BossToken = string;\n\nclass PendingRequest {\n  finished = new Signal<(token?: BossToken, error?: any) => void>();\n}\n\nclass AuthHandler {\n  oidcCallbackService = `bossAuthCallback`;\n  relayReadyPromise: Promise<void>;\n  pendingRequests = new Map<string, PendingRequest>();\n\n  constructor() {\n    this.registerListener();\n  }\n\n  registerListener() {\n    addEventListener('message', (event: MessageEvent) => {\n      if (event.origin !== location.origin) {\n        // Ignore messages from different origins.\n        return;\n      }\n      try {\n        let data = verifyObject(JSON.parse(event.data));\n        let service = verifyString(data['service']);\n        if (service === this.oidcCallbackService) {\n          let accessToken = verifyString(data['access_token']);\n          let state = verifyString(data['state']);\n          let request = this.pendingRequests.get(state);\n          if (request === undefined) {\n            // Request may have been cancelled.\n            return;\n          }\n          request.finished.dispatch(accessToken);\n        }\n      } catch (parseError) {\n        // Ignore invalid message.\n      }\n    });\n  }\n\n  addPendingRequest(state: string) {\n    let request = new PendingRequest();\n    this.pendingRequests.set(state, request);\n    request.finished.add(() => {\n      this.pendingRequests.delete(state);\n    });\n    return request;\n  }\n\n  makeAuthRequestUrl(options: {\n    authServer: string,\n    clientId: string,\n    redirect_uri: string,\n    state?: string,\n    nonce?: string\n  }) {\n    let url = `${options.authServer}/realms/BOSS/protocol/openid-connect/auth?`;\n    url += `client_id=${encodeURIComponent(options.clientId)}`;\n    url += `&redirect_uri=${encodeURIComponent(options.redirect_uri)}`;\n    url += `&response_mode=fragment`;\n    url += `&response_type=code%20id_token%20token`;\n    if (options.state) {\n      url += `&state=${options.state}`;\n    }\n    if (options.nonce) {\n      url += `&nonce=${options.nonce}`;\n    }\n    return url;\n  }\n}\n\nlet authHandlerInstance: AuthHandler;\n\nfunction authHandler() {\n  if (authHandlerInstance === undefined) {\n    authHandlerInstance = new AuthHandler();\n  }\n  return authHandlerInstance;\n}\n\n\n/**\n * Obtain a Keycloak OIDC authentication token.\n * @return A Promise that resolves to an authentication token.\n */\nexport function authenticateKeycloakOIDC(\n    options: {realm: string, clientId: string, authServer: string},\n    cancellationToken = uncancelableToken) {\n  const state = getRandomHexString();\n  const nonce = getRandomHexString();\n  const handler = authHandler();\n  const url = handler.makeAuthRequestUrl({\n    state: state,\n    clientId: options.clientId,\n    redirect_uri: new URL('bossauth.html', window.location.href).href,\n    authServer: options.authServer,\n    nonce: nonce\n  });\n  const request = handler.addPendingRequest(state);\n  const promise = new Promise<BossToken>((resolve, reject) => {\n    request.finished.add((token: string, error: string) => {\n      if (token !== undefined) {\n        resolve(token);\n      } else {\n        reject(error);\n      }\n    });\n  });\n  request.finished.add(cancellationToken.add(() => {\n    request.finished.dispatch(undefined, CANCELED);\n  }));\n  if (!cancellationToken.isCanceled) {\n    const newWindow = open(url);\n    if (newWindow !== null) {\n      request.finished.add(() => {\n        newWindow.close();\n      });\n    }\n  }\n  return promise;\n}\n\n\n\nexport class BossCredentialsProvider extends CredentialsProvider<BossToken> {\n  constructor(public authServer: string) {\n    super();\n  }\n\n  get = makeCredentialsGetter(cancellationToken => {\n    const status = new StatusMessage(/*delay=*/true);\n    let cancellationSource: CancellationTokenSource|undefined;\n    return new Promise<BossToken>((resolve, reject) => {\n      const dispose = () => {\n        cancellationSource = undefined;\n        status.dispose();\n      };\n      cancellationToken.add(() => {\n        if (cancellationSource !== undefined) {\n          cancellationSource.cancel();\n          cancellationSource = undefined;\n          status.dispose();\n          reject(CANCELED);\n        }\n      });\n      function writeLoginStatus(\n          msg = 'Boss authorization required.', linkMessage = 'Request authorization.') {\n        status.setText(msg + ' ');\n        let button = document.createElement('button');\n        button.textContent = linkMessage;\n        status.element.appendChild(button);\n        button.addEventListener('click', () => {\n          login();\n        });\n        status.setVisible(true);\n      }\n      let authServer = this.authServer;\n      function login() {\n        if (cancellationSource !== undefined) {\n          cancellationSource.cancel();\n        }\n        cancellationSource = new CancellationTokenSource();\n        writeLoginStatus('Waiting for Boss authorization...', 'Retry');\n        authenticateKeycloakOIDC(\n            {realm: 'boss', clientId: 'endpoint', authServer: authServer}, cancellationSource)\n            .then(\n                token => {\n                  if (cancellationSource !== undefined) {\n                    dispose();\n                    resolve(token);\n                  }\n                },\n                reason => {\n                  if (cancellationSource !== undefined) {\n                    cancellationSource = undefined;\n                    writeLoginStatus(`Boss authorization failed: ${reason}.`, 'Retry');\n                  }\n                });\n      }\n      writeLoginStatus();\n    });\n  });\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file\n * Support for The Boss (https://github.com/jhuapl-boss) web services.\n */\n\nimport {ChunkManager, WithParameters} from 'neuroglancer/chunk_manager/frontend';\nimport {CredentialsManager, CredentialsProvider} from 'neuroglancer/credentials_provider';\nimport {WithCredentialsProvider} from 'neuroglancer/credentials_provider/chunk_source_frontend';\nimport {CompletionResult, DataSource} from 'neuroglancer/datasource';\nimport {BossToken, credentialsKey, fetchWithBossCredentials} from 'neuroglancer/datasource/boss/api';\nimport {MeshSourceParameters, VolumeChunkSourceParameters} from 'neuroglancer/datasource/boss/base';\nimport {MeshSource} from 'neuroglancer/mesh/frontend';\nimport {DataType, VolumeChunkSpecification, VolumeSourceOptions, VolumeType} from 'neuroglancer/sliceview/volume/base';\nimport {MultiscaleVolumeChunkSource as GenericMultiscaleVolumeChunkSource, VolumeChunkSource} from 'neuroglancer/sliceview/volume/frontend';\nimport {applyCompletionOffset, getPrefixMatchesWithDescriptions} from 'neuroglancer/util/completion';\nimport {mat4, vec2, vec3} from 'neuroglancer/util/geom';\nimport {responseJson} from 'neuroglancer/util/http_request';\nimport {parseArray, parseQueryStringParameters, verify3dDimensions, verify3dScale, verifyEnumString, verifyFiniteFloat, verifyInt, verifyObject, verifyObjectAsMap, verifyObjectProperty, verifyOptionalString, verifyString} from 'neuroglancer/util/json';\n\nclass BossVolumeChunkSource extends\n(WithParameters(WithCredentialsProvider<BossToken>()(VolumeChunkSource), VolumeChunkSourceParameters)) {}\n\nclass BossMeshSource extends\n(WithParameters(WithCredentialsProvider<BossToken>()(MeshSource), MeshSourceParameters)) {}\n\nlet serverVolumeTypes = new Map<string, VolumeType>();\nserverVolumeTypes.set('image', VolumeType.IMAGE);\nserverVolumeTypes.set('annotation', VolumeType.SEGMENTATION);\n\nconst VALID_ENCODINGS = new Set<string>(['npz', 'jpeg']);\n\nconst DEFAULT_CUBOID_SIZE = vec3.fromValues(512, 512, 16);\n\ninterface ChannelInfo {\n  channelType: string;\n  volumeType: VolumeType;\n  dataType: DataType;\n  downsampled: boolean;\n  scales: ScaleInfo[];\n  description: string;\n  key: string;\n}\n\ninterface CoordinateFrameInfo {\n  voxelSizeBaseNanometers: vec3;\n  voxelOffsetBase: vec3;\n  imageSizeBase: vec3;\n  voxelUnit: VoxelUnitType;\n}\n\nenum VoxelUnitType {\n  NANOMETERS = 0,\n  MICROMETERS = 1,\n  MILLIMETERS = 2,\n  CENTIMETERS = 3\n}\n\ninterface ScaleInfo {\n  voxelSizeNanometers: vec3;\n  imageSize: vec3;\n  key: string;\n}\n\ninterface ExperimentInfo {\n  channels: Map<string, ChannelInfo>;\n  scalingLevels: number;\n  coordFrameKey: string;\n  coordFrame?: CoordinateFrameInfo;\n  key: string;\n  collection: string;\n}\n\nfunction getVoxelUnitInNanometers(voxelUnit: VoxelUnitType): number {\n  switch (voxelUnit) {\n    case VoxelUnitType.MICROMETERS:\n      return 1.e3;\n    case VoxelUnitType.MILLIMETERS:\n      return 1.e6;\n    case VoxelUnitType.CENTIMETERS:\n      return 1.e7;\n    default:\n      return 1.0;\n  }\n}\n\n/**\n * This function adds scaling info by processing coordinate frame object and adding it to the\n * experiment.\n */\nfunction parseCoordinateFrame(coordFrame: any, experimentInfo: ExperimentInfo): ExperimentInfo {\n  verifyObject(coordFrame);\n\n  let voxelSizeBase = vec3.create(), voxelOffsetBase = vec3.create(), imageSizeBase = vec3.create();\n  voxelSizeBase[0] = verifyObjectProperty(coordFrame, 'x_voxel_size', verifyInt);\n  voxelSizeBase[1] = verifyObjectProperty(coordFrame, 'y_voxel_size', verifyInt);\n  voxelSizeBase[2] = verifyObjectProperty(coordFrame, 'z_voxel_size', verifyInt);\n\n  voxelOffsetBase[0] = verifyObjectProperty(coordFrame, 'x_start', verifyInt);\n  voxelOffsetBase[1] = verifyObjectProperty(coordFrame, 'y_start', verifyInt);\n  voxelOffsetBase[2] = verifyObjectProperty(coordFrame, 'z_start', verifyInt);\n\n  imageSizeBase[0] = verifyObjectProperty(coordFrame, 'x_stop', verifyInt);\n  imageSizeBase[1] = verifyObjectProperty(coordFrame, 'y_stop', verifyInt);\n  imageSizeBase[2] = verifyObjectProperty(coordFrame, 'z_stop', verifyInt);\n\n  let voxelUnit =\n      verifyObjectProperty(coordFrame, 'voxel_unit', x => verifyEnumString(x, VoxelUnitType));\n\n  let voxelSizeBaseNanometers: vec3 =\n      vec3.scale(vec3.create(), voxelSizeBase, getVoxelUnitInNanometers(voxelUnit));\n\n  experimentInfo.coordFrame = {voxelSizeBaseNanometers, voxelOffsetBase, imageSizeBase, voxelUnit};\n  return experimentInfo;\n}\n\nfunction getVolumeTypeFromChannelType(channelType: string) {\n  let volumeType = serverVolumeTypes.get(channelType);\n  if (volumeType === undefined) {\n    volumeType = VolumeType.UNKNOWN;\n  }\n  return volumeType;\n}\n\nfunction parseChannelInfo(obj: any): ChannelInfo {\n  verifyObject(obj);\n  let channelType = verifyObjectProperty(obj, 'type', verifyString);\n  let downsampleStatus: boolean = false;\n  let downsampleStr = verifyObjectProperty(obj, 'downsample_status', verifyString);\n  if (downsampleStr === 'DOWNSAMPLED') {\n    downsampleStatus = true;\n  }\n\n  return {\n    channelType,\n    description: verifyObjectProperty(obj, 'description', verifyString),\n    volumeType: getVolumeTypeFromChannelType(channelType),\n    dataType: verifyObjectProperty(obj, 'datatype', x => verifyEnumString(x, DataType)),\n    downsampled: downsampleStatus,\n    scales: [],\n    key: verifyObjectProperty(obj, 'name', verifyString),\n  };\n}\n\nfunction parseExperimentInfo(\n    obj: any, chunkManager: ChunkManager, hostname: string,\n    credentialsProvider: CredentialsProvider<BossToken>, collection: string,\n    experiment: string): Promise<ExperimentInfo> {\n  verifyObject(obj);\n\n  let channelPromiseArray = verifyObjectProperty(\n      obj, 'channels',\n      x => parseArray(\n          x,\n          ch => getChannelInfo(\n              chunkManager, hostname, credentialsProvider, experiment, collection, ch)));\n  return Promise.all(channelPromiseArray).then(channelArray => {\n    // Parse out channel information\n    let channels: Map<string, ChannelInfo> = new Map<string, ChannelInfo>();\n    channelArray.forEach(channel => {\n      channels.set(channel.key, channel);\n    });\n\n    let experimentInfo = {\n      channels: channels,\n      scalingLevels: verifyObjectProperty(obj, 'num_hierarchy_levels', verifyInt),\n      coordFrameKey: verifyObjectProperty(obj, 'coord_frame', verifyString),\n      coordFrame: undefined,\n      key: verifyObjectProperty(obj, 'name', verifyString),\n      collection: verifyObjectProperty(obj, 'collection', verifyString),\n    };\n\n    // Get and parse the coordinate frame\n    return getCoordinateFrame(chunkManager, hostname, credentialsProvider, experimentInfo);\n  });\n}\n\nexport class MultiscaleVolumeChunkSource implements GenericMultiscaleVolumeChunkSource {\n  get dataType() {\n    if (this.channelInfo.dataType === DataType.UINT16) {\n      // 16-bit channels automatically rescaled to uint8 by The Boss\n      return DataType.UINT8;\n    }\n    return this.channelInfo.dataType;\n  }\n  get numChannels() {\n    return 1;\n  }\n  get volumeType() {\n    return this.channelInfo.volumeType;\n  }\n\n  /**\n   * The Boss experiment name\n   */\n  experiment: string;\n\n  /**\n   * The Boss channel/layer name.\n   */\n  channel: string;\n\n  /**\n   * Parameters for getting 3D meshes alongside segmentations\n   */\n  meshPath?: string = undefined;\n  meshUrl?: string = undefined;\n\n  channelInfo: ChannelInfo;\n  scales: ScaleInfo[];\n  coordinateFrame: CoordinateFrameInfo;\n\n  encoding: string;\n  window: vec2|undefined;\n\n  constructor(\n      public chunkManager: ChunkManager, public baseUrl: string,\n      public credentialsProvider: CredentialsProvider<BossToken>,\n      public experimentInfo: ExperimentInfo, channel: string|undefined,\n      public parameters: {[index: string]: any}) {\n    if (channel === undefined) {\n      const channelNames = Array.from(experimentInfo.channels.keys());\n      if (channelNames.length !== 1) {\n        throw new Error(`Experiment contains multiple channels: ${JSON.stringify(channelNames)}`);\n      }\n      channel = channelNames[0];\n    }\n    const channelInfo = experimentInfo.channels.get(channel);\n    if (channelInfo === undefined) {\n      throw new Error(\n          `Specified channel ${JSON.stringify(channel)} is not one of the supported channels ${\n              JSON.stringify(Array.from(experimentInfo.channels.keys()))}`);\n    }\n    this.channel = channel;\n    this.channelInfo = channelInfo;\n    this.scales = channelInfo.scales;\n\n    if (experimentInfo.coordFrame === undefined) {\n      throw new Error(`Specified experiment ${\n          JSON.stringify(experimentInfo.key)} does not have a valid coordinate frame`);\n    }\n    this.coordinateFrame = experimentInfo.coordFrame;\n\n    if (this.channelInfo.downsampled === false) {\n      this.scales = [channelInfo.scales[0]];\n    }\n    this.experiment = experimentInfo.key;\n\n    let window = verifyOptionalString(parameters['window']);\n    if (window !== undefined) {\n      let windowobj = vec2.create();\n      let parts = window.split(/,/);\n      if (parts.length === 2) {\n        windowobj[0] = verifyFiniteFloat(parts[0]);\n        windowobj[1] = verifyFiniteFloat(parts[1]);\n      } else if (parts.length === 1) {\n        windowobj[0] = 0.;\n        windowobj[1] = verifyFiniteFloat(parts[1]);\n      } else {\n        throw new Error(`Invalid window. Must be either one value or two comma separated values: ${\n            JSON.stringify(window)}`);\n      }\n      this.window = windowobj;\n      if (this.window[0] === this.window[1]) {\n        throw new Error(`Invalid window. First element must be different from second: ${\n            JSON.stringify(window)}.`);\n      }\n    }\n\n    let meshUrl = verifyOptionalString(parameters['meshurl']);\n    if (meshUrl !== undefined) {\n      this.meshUrl = meshUrl;\n    }\n\n    let encoding = verifyOptionalString(parameters['encoding']);\n    if (encoding === undefined) {\n      encoding = this.volumeType === VolumeType.IMAGE ? 'jpeg' : 'npz';\n    } else {\n      if (!VALID_ENCODINGS.has(encoding)) {\n        throw new Error(`Invalid encoding: ${JSON.stringify(encoding)}.`);\n      }\n    }\n    this.encoding = encoding;\n  }\n\n  getSources(volumeSourceOptions: VolumeSourceOptions) {\n    return this.scales.map(scaleInfo => {\n      let {voxelSizeNanometers, imageSize} = scaleInfo;\n      let voxelOffset = this.coordinateFrame.voxelOffsetBase;\n      let baseVoxelOffset = vec3.create();\n      for (let i = 0; i < 3; ++i) {\n        baseVoxelOffset[i] = Math.ceil(voxelOffset[i]);\n      }\n      return VolumeChunkSpecification\n          .getDefaults({\n            numChannels: this.numChannels,\n            volumeType: this.volumeType,\n            dataType: this.dataType,\n            voxelSize: voxelSizeNanometers,\n            chunkDataSizes: [DEFAULT_CUBOID_SIZE],\n            transform: mat4.fromTranslation(\n                mat4.create(), vec3.multiply(vec3.create(), voxelOffset, voxelSizeNanometers)),\n            baseVoxelOffset,\n            upperVoxelBound: imageSize,\n            volumeSourceOptions,\n          })\n          .map(spec => this.chunkManager.getChunkSource(BossVolumeChunkSource, {\n            credentialsProvider: this.credentialsProvider,\n            spec,\n            parameters: {\n              baseUrl: this.baseUrl,\n              collection: this.experimentInfo.collection,\n              experiment: this.experimentInfo.key,\n              channel: this.channel,\n              resolution: scaleInfo.key,\n              encoding: this.encoding,\n              window: this.window,\n            }\n          }));\n    });\n  }\n\n  getMeshSource() {\n    if (this.meshUrl !== undefined) {\n      return this.chunkManager.getChunkSource(\n          BossMeshSource,\n          {credentialsProvider: this.credentialsProvider, parameters: {baseUrl: this.meshUrl}});\n    }\n    return null;\n  }\n}\n\nconst pathPattern = /^([^\\/?]+)\\/([^\\/?]+)(?:\\/([^\\/?]+))?(?:\\?(.*))?$/;\n\nexport function getExperimentInfo(\n    chunkManager: ChunkManager, hostname: string,\n    credentialsProvider: CredentialsProvider<BossToken>, experiment: string,\n    collection: string): Promise<ExperimentInfo> {\n  return chunkManager.memoize.getUncounted(\n      {\n        hostname: hostname,\n        collection: collection,\n        experiment: experiment,\n        type: 'boss:getExperimentInfo'\n      },\n      () =>\n          fetchWithBossCredentials(\n              credentialsProvider,\n              `${hostname}/latest/collection/${collection}/experiment/${experiment}/`, {},\n              responseJson)\n              .then(\n                  value => parseExperimentInfo(\n                      value, chunkManager, hostname, credentialsProvider, collection, experiment)));\n}\n\nexport function getChannelInfo(\n    chunkManager: ChunkManager, hostname: string,\n    credentialsProvider: CredentialsProvider<BossToken>, experiment: string, collection: string,\n    channel: string): Promise<ChannelInfo> {\n  return chunkManager.memoize.getUncounted(\n      {\n        hostname: hostname,\n        collection: collection,\n        experiment: experiment,\n        channel: channel,\n        type: 'boss:getChannelInfo'\n      },\n      () => fetchWithBossCredentials(\n                credentialsProvider,\n                `${hostname}/latest/collection/${collection}/experiment/${experiment}/channel/${\n                    channel}/`,\n                {}, responseJson)\n                .then(parseChannelInfo));\n}\n\nexport function getDownsampleInfoForChannel(\n    chunkManager: ChunkManager, hostname: string,\n    credentialsProvider: CredentialsProvider<BossToken>, collection: string,\n    experimentInfo: ExperimentInfo, channel: string): Promise<ExperimentInfo> {\n  return chunkManager.memoize\n      .getUncounted(\n          {\n            hostname: hostname,\n            collection: collection,\n            experiment: experimentInfo.key,\n            channel: channel,\n            downsample: true,\n            type: 'boss:getDownsampleInfoForChannel'\n          },\n          () => fetchWithBossCredentials(\n              credentialsProvider,\n              `${hostname}/latest/downsample/${collection}/${experimentInfo.key}/${channel}/`, {},\n              responseJson))\n      .then(downsampleObj => {\n        return parseDownsampleInfoForChannel(downsampleObj, experimentInfo, channel);\n      });\n}\n\nexport function parseDownsampleScales(downsampleObj: any, voxelUnit: VoxelUnitType): ScaleInfo[] {\n  verifyObject(downsampleObj);\n\n  let voxelSizes =\n      verifyObjectProperty(downsampleObj, 'voxel_size', x => verifyObjectAsMap(x, verify3dScale));\n\n  let imageSizes =\n      verifyObjectProperty(downsampleObj, 'extent', x => verifyObjectAsMap(x, verify3dDimensions));\n\n  let num_hierarchy_levels = verifyObjectProperty(downsampleObj, 'num_hierarchy_levels', verifyInt);\n\n  let scaleInfo = new Array<ScaleInfo>();\n  for (let i = 0; i < num_hierarchy_levels; i++) {\n    let key: string = String(i);\n    const voxelSize = voxelSizes.get(key);\n    const imageSize = imageSizes.get(key);\n    if (voxelSize === undefined || imageSize === undefined) {\n      throw new Error(`Missing voxel_size/extent for resolution ${key}.`);\n    }\n    let voxelSizeNanometers =\n        vec3.scale(vec3.create(), voxelSize, getVoxelUnitInNanometers(voxelUnit));\n    scaleInfo[i] = {voxelSizeNanometers, imageSize, key};\n  }\n  return scaleInfo;\n}\n\nexport function parseDownsampleInfoForChannel(\n    downsampleObj: any, experimentInfo: ExperimentInfo, channel: string): ExperimentInfo {\n  let coordFrame = experimentInfo.coordFrame;\n  if (coordFrame === undefined) {\n    throw new Error(`Missing coordinate frame information for experiment ${\n        experimentInfo\n            .key}. A valid coordinate frame is required to retrieve downsampling information.`);\n  }\n  let channelInfo = experimentInfo.channels.get(channel);\n  if (channelInfo === undefined) {\n    throw new Error(\n        `Specified channel ${JSON.stringify(channel)} is not one of the supported channels ${\n            JSON.stringify(Array.from(experimentInfo.channels.keys()))}`);\n  }\n  channelInfo.scales = parseDownsampleScales(downsampleObj, coordFrame.voxelUnit);\n  experimentInfo.channels.set(channel, channelInfo);\n  return experimentInfo;\n}\n\nexport function getVolume(\n    chunkManager: ChunkManager, hostname: string,\n    credentialsProvider: CredentialsProvider<BossToken>, path: string) {\n  const match = path.match(pathPattern);\n  if (match === null) {\n    throw new Error(`Invalid volume path ${JSON.stringify(path)}`);\n  }\n  const collection = match[1];\n  const experiment = match[2];\n  const channel = match[3];\n  const parameters = parseQueryStringParameters(match[4] || '');\n  // Warning: If additional arguments are added, the cache key should be updated as well.\n  return chunkManager.memoize.getUncounted(\n      {hostname: hostname, path: path, type: 'boss:getVolume'},\n      () => getExperimentInfo(chunkManager, hostname, credentialsProvider, experiment, collection)\n                .then(experimentInfo => {\n                  return getDownsampleInfoForChannel(\n                             chunkManager, hostname, credentialsProvider, collection,\n                             experimentInfo, channel)\n                      .then(\n                          experimentInfoWithDownsample => new MultiscaleVolumeChunkSource(\n                              chunkManager, hostname, credentialsProvider,\n                              experimentInfoWithDownsample, channel, parameters));\n                }));\n}\n\nconst urlPattern = /^((?:http|https):\\/\\/[^\\/?]+)\\/(.*)$/;\n\nexport function getCollections(\n    chunkManager: ChunkManager, hostname: string,\n    credentialsProvider: CredentialsProvider<BossToken>) {\n  return chunkManager.memoize.getUncounted(\n      {hostname: hostname, type: 'boss:getCollections'},\n      () => fetchWithBossCredentials(\n                credentialsProvider, `${hostname}/latest/collection/`, {}, responseJson)\n                .then(\n                    value => verifyObjectProperty(\n                        value, 'collections', x => parseArray(x, verifyString))));\n}\n\nexport function getExperiments(\n    chunkManager: ChunkManager, hostname: string,\n    credentialsProvider: CredentialsProvider<BossToken>, collection: string) {\n  return chunkManager.memoize.getUncounted(\n      {hostname: hostname, collection: collection, type: 'boss:getExperiments'},\n      () => fetchWithBossCredentials(\n                credentialsProvider, `${hostname}/latest/collection/${collection}/experiment/`, {},\n                responseJson)\n                .then(\n                    value => verifyObjectProperty(\n                        value, 'experiments', x => parseArray(x, verifyString))));\n}\n\nexport function getCoordinateFrame(\n    chunkManager: ChunkManager, hostname: string,\n    credentialsProvider: CredentialsProvider<BossToken>,\n    experimentInfo: ExperimentInfo): Promise<ExperimentInfo> {\n  let key = experimentInfo.coordFrameKey;\n  return chunkManager.memoize.getUncounted(\n      {\n        hostname: hostname,\n        coordinateframe: key,\n        experimentInfo: experimentInfo,\n        type: 'boss:getCoordinateFrame'\n      },\n      () =>\n          fetchWithBossCredentials(\n              credentialsProvider, `${hostname}/latest/coord/${key}/`, {}, responseJson)\n              .then(\n                  coordinateFrameObj => parseCoordinateFrame(coordinateFrameObj, experimentInfo)));\n}\n\nexport function collectionExperimentChannelCompleter(\n    chunkManager: ChunkManager, hostname: string,\n    credentialsProvider: CredentialsProvider<BossToken>, path: string): Promise<CompletionResult> {\n  let channelMatch = path.match(/^(?:([^\\/]+)(?:\\/?([^\\/]*)(?:\\/?([^\\/]*)(?:\\/?([^\\/]*)?))?)?)?$/);\n  if (channelMatch === null) {\n    // URL has incorrect format, don't return any results.\n    return Promise.reject<CompletionResult>(null);\n  }\n  if (channelMatch[1] === undefined) {\n    // No collection. Reject.\n    return Promise.reject<CompletionResult>(null);\n  }\n  if (channelMatch[2] === undefined) {\n    let collectionPrefix = channelMatch[1] || '';\n    // Try to complete the collection.\n    return getCollections(chunkManager, hostname, credentialsProvider).then(collections => {\n      return {\n        offset: 0,\n        completions: getPrefixMatchesWithDescriptions(\n            collectionPrefix, collections, x => x + '/', () => undefined)\n      };\n    });\n  }\n  if (channelMatch[3] === undefined) {\n    let experimentPrefix = channelMatch[2] || '';\n    return getExperiments(chunkManager, hostname, credentialsProvider, channelMatch[1])\n        .then(experiments => {\n          return {\n            offset: channelMatch![1].length + 1,\n            completions: getPrefixMatchesWithDescriptions(\n                experimentPrefix, experiments, y => y + '/', () => undefined)\n          };\n        });\n  }\n  return getExperimentInfo(\n             chunkManager, hostname, credentialsProvider, channelMatch[2], channelMatch[1])\n      .then(experimentInfo => {\n        let completions = getPrefixMatchesWithDescriptions(\n            channelMatch![3], experimentInfo.channels, x => x[0], x => {\n              return `${x[1].channelType} (${DataType[x[1].dataType]})`;\n            });\n        return {offset: channelMatch![1].length + channelMatch![2].length + 2, completions};\n      });\n}\n\nfunction getAuthServer(endpoint: string): string {\n  let baseHostName = endpoint.match(/^(?:https:\\/\\/[^.]+([^\\/]+))/);\n  if (baseHostName === null) {\n    throw new Error(`Unable to construct auth server hostname from base hostname ${endpoint}.`);\n  }\n  let authServer = `https://auth${baseHostName[1]}/auth`;\n  return authServer;\n}\n\nexport class BossDataSource extends DataSource {\n  constructor(public credentialsManager: CredentialsManager) {\n    super();\n  }\n\n  get description() {\n    return 'The Boss';\n  }\n\n  getCredentialsProvider(path: string) {\n    let authServer = getAuthServer(path);\n    return this.credentialsManager.getCredentialsProvider<BossToken>(credentialsKey, authServer);\n  }\n\n  getVolume(chunkManager: ChunkManager, path: string) {\n    let match = path.match(urlPattern);\n    if (match === null) {\n      throw new Error(`Invalid boss volume path: ${JSON.stringify(path)}`);\n    }\n    let credentialsProvider = this.getCredentialsProvider(path);\n\n    return getVolume(chunkManager, match[1], credentialsProvider, match[2]);\n  }\n\n  volumeCompleter(url: string, chunkManager: ChunkManager) {\n    let match = url.match(urlPattern);\n    if (match === null) {\n      // We don't yet have a full hostname.\n      return Promise.reject<CompletionResult>(null);\n    }\n    let hostname = match[1];\n    let credentialsProvider = this.getCredentialsProvider(match[1]);\n    let path = match[2];\n    return collectionExperimentChannelCompleter(chunkManager, hostname, credentialsProvider, path)\n        .then(completions => applyCompletionOffset(match![1].length + 1, completions));\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {defaultCredentialsManager} from 'neuroglancer/credentials_provider/default_manager';\nimport {credentialsKey} from 'neuroglancer/datasource/boss/api';\nimport {BossCredentialsProvider} from 'neuroglancer/datasource/boss/credentials_provider';\n\ndefaultCredentialsManager.register(\n    credentialsKey, (authServer) => new BossCredentialsProvider(authServer));\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {BossDataSource} from 'neuroglancer/datasource/boss/frontend';\nimport {registerProvider} from 'neuroglancer/datasource/default_provider';\n\nregisterProvider('boss', options => new BossDataSource(options.credentialsManager));\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {CredentialsProvider} from 'neuroglancer/credentials_provider';\nimport {fetchWithCredentials} from 'neuroglancer/credentials_provider/http_request';\nimport {CancellationToken, uncancelableToken} from 'neuroglancer/util/cancellation';\nimport {responseArrayBuffer, responseJson} from 'neuroglancer/util/http_request';\n\nexport type BrainmapsCredentialsProvider = CredentialsProvider<Credentials>;\n\n/**\n * OAuth2 token\n */\nexport interface Credentials {\n  tokenType: string;\n  accessToken: string;\n}\n\n/**\n * Key used for retrieving the CredentialsProvider from a CredentialsManager.\n */\nexport const credentialsKey = 'google-brainmaps';\n\nexport interface BrainmapsInstance {\n  description: string;\n  /**\n   * One or more server URLs to use to connect to the instance.\n   */\n  serverUrl: string;\n}\n\n/**\n * API-related interfaces.\n */\n\nexport interface ChangeSpecPayload {\n  change_stack_id?: string;\n  time_stamp?: number;\n  skip_equivalences?: boolean;\n}\n\nexport interface ChangeStackAwarePayload {\n  change_spec?: ChangeSpecPayload;\n}\n\nexport interface GeometryPayload {\n  corner: string;\n  size: string;\n  scale: number;\n}\n\nexport interface GeometryAwarePayload {\n  geometry: GeometryPayload;\n}\n\nexport interface ImageFormatOptionsPayload {\n  image_format?: 'AUTO'|'JPEG'|'PNG'|'JSON';\n  jpeg_quality?: number;\n  compressed_segmentation_block_size?: string;\n}\n\nexport interface SubvolumePayload extends ChangeStackAwarePayload, GeometryAwarePayload {\n  image_format_options?: ImageFormatOptionsPayload;\n  subvolume_format?: 'RAW'|'SINGLE_IMAGE';\n}\n\nexport interface SkeletonPayload extends ChangeStackAwarePayload {\n  object_id: string;\n}\n\nexport interface MeshFragmentPayload extends ChangeStackAwarePayload {\n  fragment_key: string;\n  object_id: string;\n}\n\nexport interface BatchMeshFragment {\n  object_id: string;\n  fragment_keys: string[];\n}\n\nexport interface BatchMeshFragmentPayload {\n  volume_id: string;\n  mesh_name: string;\n  batches: BatchMeshFragment[];\n}\n\nexport interface HttpCall {\n  method: 'GET'|'POST';\n  path: string;\n  payload?: string;\n}\n\nexport function makeRequest(\n    instance: BrainmapsInstance, credentialsProvider: BrainmapsCredentialsProvider,\n    httpCall: HttpCall&{responseType: 'arraybuffer'},\n    cancellationToken?: CancellationToken): Promise<ArrayBuffer>;\nexport function makeRequest(\n    instance: BrainmapsInstance, credentialsProvider: BrainmapsCredentialsProvider,\n    httpCall: HttpCall&{responseType: 'json'}, cancellationToken?: CancellationToken): Promise<any>;\n\nexport function makeRequest(\n    instance: BrainmapsInstance, credentialsProvider: BrainmapsCredentialsProvider,\n    httpCall: HttpCall&{responseType: XMLHttpRequestResponseType},\n    cancellationToken: CancellationToken = uncancelableToken): any {\n  return fetchWithCredentials(\n      credentialsProvider, `${instance.serverUrl}${httpCall.path}`,\n      {method: httpCall.method, body: httpCall.payload},\n      httpCall.responseType === 'json' ? responseJson : responseArrayBuffer,\n      (credentials, init) => {\n        const headers = new Headers(init.headers);\n        headers.set('Authorization', `${credentials.tokenType} ${credentials.accessToken}`);\n        return {...init, headers};\n      },\n      error => {\n        const {status} = error;\n        if (status === 401) {\n          // 401: Authorization needed.  OAuth2 token may have expired.\n          return 'refresh';\n        } else if (status === 504 || status === 503) {\n          // 503: Service unavailable.  Retry.\n          // 504: Gateway timeout.  Can occur if the server takes too long to reply.  Retry.\n          return 'retry';\n        }\n        throw error;\n      },\n      cancellationToken);\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {BrainmapsInstance} from 'neuroglancer/datasource/brainmaps/api';\nimport {vec3} from 'neuroglancer/util/geom';\n\nexport enum VolumeChunkEncoding {\n  RAW,\n  JPEG,\n  COMPRESSED_SEGMENTATION\n}\n\nexport class ChangeSpec {\n  changeStackId: string;\n  /**\n   * Apply changes prior to this timestamp (in milliseconds since epoch).  If 0, no changes should\n   * be applied.  If negative, all changes should be applied.\n   */\n  timeStamp?: number;\n  skipEquivalences?: boolean;\n}\n\nexport class VolumeSourceParameters {\n  instance: BrainmapsInstance;\n  volumeId: string;\n  scaleIndex: number;\n  encoding: VolumeChunkEncoding;\n  changeSpec: ChangeSpec|undefined;\n\n  static RPC_ID = 'brainmaps/VolumeChunkSource';\n}\n\nexport interface SingleMeshInfo {\n  name: string;\n  type: string;\n}\n\nexport interface MultiscaleMeshLOD {\n  info: SingleMeshInfo;\n  scale: number;\n\n  /**\n   * Shape of the chunk for this level of detail, as a multiple of the base chunk shape.\n   */\n  relativeBlockShape: vec3;\n\n  /**\n   * Size of chunk grid, in chunks.\n   */\n  gridShape: Uint32Array;\n}\n\nexport interface MultiscaleMeshInfo {\n  /**\n   * Prefix\n   */\n  key: string;\n\n  /**\n   * Chunk shape in spatial units (nm) for lod 0.\n   */\n  chunkShape: vec3;\n\n  lods: MultiscaleMeshLOD[];\n}\n\nexport class MultiscaleMeshSourceParameters {\n  instance: BrainmapsInstance;\n  volumeId: string;\n  info: MultiscaleMeshInfo;\n  changeSpec: ChangeSpec|undefined;\n\n  static RPC_ID = 'brainmaps/MultiscaleMeshSource';\n}\n\nexport class MeshSourceParameters  {\n  instance: BrainmapsInstance;\n  volumeId: string;\n  meshName: string;\n  changeSpec: ChangeSpec|undefined;\n  \n  static RPC_ID = 'brainmaps/MeshSource';\n}\n\nexport class SkeletonSourceParameters  {\n  instance: BrainmapsInstance;\n  volumeId: string;\n  meshName: string;\n  changeSpec: ChangeSpec|undefined;\n  \n  static RPC_ID = 'brainmaps/SkeletonSource';\n}\n\nexport class AnnotationSourceParameters {\n  instance: BrainmapsInstance;\n  volumeId: string;\n  changestack: string;\n\n  static RPC_ID = 'brainmaps/Annotation';\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file This implements a Brain Maps CredentialsProvider based on neuroglancer/util/google_auth2.\n */\n\nimport {GoogleOAuth2CredentialsProvider} from 'neuroglancer/util/google_oauth2';\n\nconst BRAINMAPS_SCOPE = 'https://www.googleapis.com/auth/brainmaps';\n\nexport class BrainmapsCredentialsProvider extends GoogleOAuth2CredentialsProvider {\n  constructor(clientId: string) {\n    super({clientId: clientId, scopes: [BRAINMAPS_SCOPE], description: 'Brain Maps'});\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {AnnotationSource, AnnotationType, makeDataBoundsBoundingBox} from 'neuroglancer/annotation';\nimport {AnnotationGeometryChunkSpecification} from 'neuroglancer/annotation/base';\nimport {MultiscaleAnnotationSource} from 'neuroglancer/annotation/frontend';\nimport {ChunkManager, WithParameters} from 'neuroglancer/chunk_manager/frontend';\nimport {CredentialsProvider} from 'neuroglancer/credentials_provider';\nimport {WithCredentialsProvider} from 'neuroglancer/credentials_provider/chunk_source_frontend';\nimport {DataSource, GetVolumeOptions} from 'neuroglancer/datasource';\nimport {BrainmapsCredentialsProvider, BrainmapsInstance, Credentials, makeRequest} from 'neuroglancer/datasource/brainmaps/api';\nimport {AnnotationSourceParameters, ChangeSpec, MeshSourceParameters, MultiscaleMeshInfo, MultiscaleMeshSourceParameters, SingleMeshInfo, SkeletonSourceParameters, VolumeChunkEncoding, VolumeSourceParameters} from 'neuroglancer/datasource/brainmaps/base';\nimport {VertexPositionFormat} from 'neuroglancer/mesh/base';\nimport {MeshSource, MultiscaleMeshSource} from 'neuroglancer/mesh/frontend';\nimport {SkeletonSource} from 'neuroglancer/skeleton/frontend';\nimport {ChunkLayoutPreference} from 'neuroglancer/sliceview/base';\nimport {DataType, VolumeChunkSpecification, VolumeSourceOptions, VolumeType} from 'neuroglancer/sliceview/volume/base';\nimport {MultiscaleVolumeChunkSource as GenericMultiscaleVolumeChunkSource, VolumeChunkSource} from 'neuroglancer/sliceview/volume/frontend';\nimport {StatusMessage} from 'neuroglancer/status';\nimport {getPrefixMatches, getPrefixMatchesWithDescriptions} from 'neuroglancer/util/completion';\nimport {Borrowed, Owned} from 'neuroglancer/util/disposable';\nimport {mat4, vec3} from 'neuroglancer/util/geom';\nimport {parseArray, parseQueryStringParameters, parseXYZ, verifyEnumString, verifyFiniteFloat, verifyFinitePositiveFloat, verifyMapKey, verifyObject, verifyObjectProperty, verifyOptionalString, verifyPositiveInt, verifyString} from 'neuroglancer/util/json';\nimport {getObjectId} from 'neuroglancer/util/object_id';\n\nclass BrainmapsVolumeChunkSource extends\n(WithParameters(\n    WithCredentialsProvider<Credentials>()(VolumeChunkSource), VolumeSourceParameters)) {}\n\nclass BrainmapsMultiscaleMeshSource extends\n(WithParameters(WithCredentialsProvider<Credentials>()(MultiscaleMeshSource), MultiscaleMeshSourceParameters)) {}\n\nclass BrainmapsMeshSource extends\n(WithParameters(WithCredentialsProvider<Credentials>()(MeshSource), MeshSourceParameters)) {}\n\nexport class BrainmapsSkeletonSource extends\n(WithParameters(WithCredentialsProvider<Credentials>()(SkeletonSource), SkeletonSourceParameters)) {\n  get skeletonVertexCoordinatesInVoxels() {\n    return false;\n  }\n}\n\nconst SERVER_DATA_TYPES = new Map<string, DataType>();\nSERVER_DATA_TYPES.set('UINT8', DataType.UINT8);\nSERVER_DATA_TYPES.set('FLOAT', DataType.FLOAT32);\nSERVER_DATA_TYPES.set('UINT64', DataType.UINT64);\n\nfunction parseBoundingBox(obj: any) {\n  verifyObject(obj);\n  try {\n    return {\n      corner:\n          verifyObjectProperty(obj, 'corner', x => parseXYZ(vec3.create(), x, verifyFiniteFloat)),\n      size: verifyObjectProperty(\n          obj, 'size', x => parseXYZ(vec3.create(), x, verifyFinitePositiveFloat)),\n      metadata: verifyObjectProperty(obj, 'metadata', verifyOptionalString),\n    };\n  } catch (parseError) {\n    throw new Error(`Failed to parse bounding box: ${parseError.message}`);\n  }\n}\n\nexport class VolumeInfo {\n  numChannels: number;\n  dataType: DataType;\n  voxelSize: vec3;\n  upperVoxelBound: vec3;\n  boundingBoxes: {corner: vec3, size: vec3, metadata?: string}[];\n  constructor(obj: any) {\n    try {\n      verifyObject(obj);\n      this.numChannels = verifyObjectProperty(obj, 'channelCount', verifyPositiveInt);\n      this.dataType =\n          verifyObjectProperty(obj, 'channelType', x => verifyMapKey(x, SERVER_DATA_TYPES));\n      this.voxelSize = verifyObjectProperty(\n          obj, 'pixelSize', x => parseXYZ(vec3.create(), x, verifyFinitePositiveFloat));\n      this.upperVoxelBound = verifyObjectProperty(\n          obj, 'volumeSize', x => parseXYZ(vec3.create(), x, verifyPositiveInt));\n      this.boundingBoxes = verifyObjectProperty(\n          obj, 'boundingBox', a => a === undefined ? [] : parseArray(a, parseBoundingBox));\n    } catch (parseError) {\n      throw new Error(`Failed to parse BrainMaps volume geometry: ${parseError.message}`);\n    }\n  }\n}\n\nfunction parseMeshInfo(obj: any): SingleMeshInfo {\n  verifyObject(obj);\n  return {\n    name: verifyObjectProperty(obj, 'name', verifyString),\n    type: verifyObjectProperty(obj, 'type', verifyString)\n  };\n}\n\nfunction parseMeshesResponse(meshesResponse: any): SingleMeshInfo[] {\n  try {\n    verifyObject(meshesResponse);\n    return verifyObjectProperty(meshesResponse, 'meshes', y => {\n      if (y === undefined) {\n        return [];\n      }\n      return parseArray(y, parseMeshInfo);\n    });\n  } catch (parseError) {\n    throw new Error(`Failed to parse BrainMaps meshes specification: ${parseError.message}`);\n  }\n}\n\nconst floatPattern = '([0-9]*\\\\.?[0-9]+(?:[eE][-+]?[0-9]+)?)';\nconst intPattern = '([0-9]+)';\nconst lodPattern =\n    new RegExp(`^(.*)_${intPattern}x${intPattern}x${intPattern}_lod([0-9]+)_${floatPattern}$`);\n\nfunction getMultiscaleMeshes(\n  volumeInfo: MultiscaleVolumeInfo, meshes: SingleMeshInfo[]): MultiscaleMeshInfo[] {\n  const multiscaleMeshes = new Map<string, MultiscaleMeshInfo>();\n  const baseVolume = volumeInfo.scales[0];\n\n  const invalidLodMeshes = new Set<string>();\n\n  for (const mesh of meshes) {\n    // Only triangular meshes supported currently.\n    if (mesh.type !== 'TRIANGLES') continue;\n    const m = mesh.name.match(lodPattern);\n    if (m === null) continue;\n    const key = m[1];\n    let info = multiscaleMeshes.get(key);\n    if (info === undefined) {\n      info = {\n        key,\n        chunkShape: vec3.create(),\n        lods: []\n      };\n      multiscaleMeshes.set(key, info);\n    }\n    const lod = parseInt(m[5]);\n    if (info.lods[lod] !== undefined) {\n      invalidLodMeshes.add(key);\n      continue;\n    }\n    const chunkShapeInVoxels =\n      vec3.fromValues(parseInt(m[2], 10), parseInt(m[3], 10), parseInt(m[4], 10));\n    const gridShape = new Uint32Array(3);\n    for (let i = 0; i < 3; ++i) {\n      gridShape[i] = Math.ceil(baseVolume.upperVoxelBound[i] / chunkShapeInVoxels[i]);\n    }\n\n    info.lods[lod] = {\n      info: mesh,\n      scale: parseFloat(m[6]),\n      // Temporarily use the relativeBlockShape field to store the absolute shape in voxels.\n      relativeBlockShape: chunkShapeInVoxels,\n      gridShape,\n    };\n  }\n\n  const output: MultiscaleMeshInfo[] = [];\n  meshLoop: for (const mesh of multiscaleMeshes.values()) {\n    if (invalidLodMeshes.has(mesh.key)) continue meshLoop;\n    const baseLod = mesh.lods[0];\n    if (baseLod === undefined) continue meshLoop;\n    const baseBlockShapeInVoxels = baseLod.relativeBlockShape;\n    vec3.multiply(mesh.chunkShape, baseBlockShapeInVoxels, baseVolume.voxelSize);\n    for (let lodIndex = 1; lodIndex < mesh.lods.length; ++lodIndex) {\n      const lod = mesh.lods[lodIndex];\n      if (lod === undefined) continue meshLoop;\n      const {relativeBlockShape} = lod;\n      for (let i = 0; i < 3; ++i) {\n        const curSize = relativeBlockShape[i];\n        const baseSize = baseBlockShapeInVoxels[i];\n        if (curSize < baseSize || (curSize % baseSize) !== 0) continue meshLoop;\n        relativeBlockShape[i] = curSize / baseSize;\n      }\n    }\n    baseBlockShapeInVoxels.fill(1);\n    output.push(mesh);\n  }\n\n  return output;\n}\n\nexport class MultiscaleVolumeInfo {\n  scales: VolumeInfo[];\n  numChannels: number;\n  dataType: DataType;\n  constructor(volumeInfoResponse: any) {\n    try {\n      verifyObject(volumeInfoResponse);\n      let scales = this.scales = verifyObjectProperty(\n          volumeInfoResponse, 'geometry', y => parseArray(y, x => new VolumeInfo(x)));\n      if (scales.length === 0) {\n        throw new Error('Expected at least one scale.');\n      }\n      let baseScale = scales[0];\n      let numChannels = this.numChannels = baseScale.numChannels;\n      let dataType = this.dataType = baseScale.dataType;\n      for (let scaleIndex = 1, numScales = scales.length; scaleIndex < numScales; ++scaleIndex) {\n        let scale = scales[scaleIndex];\n        if (scale.dataType !== dataType) {\n          throw new Error(\n              `Scale ${scaleIndex} has data type ${DataType[scale.dataType]} ` +\n              `but scale 0 has data type ${DataType[dataType]}.`);\n        }\n        if (scale.numChannels !== numChannels) {\n          throw new Error(\n              `Scale ${scaleIndex} has ${scale.numChannels} channel(s) ` +\n              `but scale 0 has ${numChannels} channels.`);\n        }\n      }\n    } catch (parseError) {\n      throw new Error(\n          `Failed to parse BrainMaps multiscale volume specification: ${parseError.message}`);\n    }\n  }\n}\n\nexport interface GetBrainmapsVolumeOptions extends GetVolumeOptions {\n  encoding?: VolumeChunkEncoding;\n  chunkLayoutPreference?: ChunkLayoutPreference;\n}\n\nexport class MultiscaleVolumeChunkSource implements GenericMultiscaleVolumeChunkSource {\n  volumeType: VolumeType;\n  get scales() {\n    return this.multiscaleVolumeInfo.scales;\n  }\n  get dataType() {\n    return this.multiscaleVolumeInfo.dataType;\n  }\n  get numChannels() {\n    return this.multiscaleVolumeInfo.numChannels;\n  }\n  meshes: SingleMeshInfo[];\n  encoding: VolumeChunkEncoding|undefined;\n  chunkLayoutPreference: ChunkLayoutPreference|undefined;\n  constructor(\n      public chunkManager: ChunkManager, public instance: BrainmapsInstance,\n      public credentialsProvider: Borrowed<BrainmapsCredentialsProvider>, public volumeId: string,\n      public changeSpec: ChangeSpec|undefined, public multiscaleVolumeInfo: MultiscaleVolumeInfo,\n      meshesResponse: any, options: GetBrainmapsVolumeOptions) {\n    this.encoding = options.encoding;\n    this.chunkLayoutPreference = options.chunkLayoutPreference;\n\n    // Infer the VolumeType from the data type and number of channels.\n    let volumeType: VolumeType|undefined;\n    if (this.numChannels === 1) {\n      switch (this.dataType) {\n        case DataType.UINT64:\n          volumeType = VolumeType.SEGMENTATION;\n          break;\n      }\n    }\n    if (volumeType === undefined) {\n      if (options.volumeType !== undefined) {\n        volumeType = options.volumeType;\n      } else {\n        volumeType = VolumeType.IMAGE;\n      }\n    }\n    this.volumeType = volumeType;\n    this.meshes = parseMeshesResponse(meshesResponse);\n  }\n\n  getSources(volumeSourceOptions: VolumeSourceOptions) {\n    let encoding = VolumeChunkEncoding.RAW;\n    if (this.dataType === DataType.UINT64 && this.volumeType === VolumeType.SEGMENTATION) {\n      encoding = VolumeChunkEncoding.COMPRESSED_SEGMENTATION;\n    } else if (\n        this.volumeType === VolumeType.IMAGE && this.dataType === DataType.UINT8 &&\n        this.numChannels === 1 && this.encoding !== VolumeChunkEncoding.RAW) {\n      encoding = VolumeChunkEncoding.JPEG;\n    }\n\n    const baseScale = this.scales[0];\n    const upperClipBound =\n        vec3.multiply(vec3.create(), baseScale.upperVoxelBound, baseScale.voxelSize);\n\n    return this.scales.map(\n        (volumeInfo, scaleIndex) =>\n            VolumeChunkSpecification\n                .getDefaults({\n                  voxelSize: volumeInfo.voxelSize,\n                  dataType: volumeInfo.dataType,\n                  numChannels: volumeInfo.numChannels,\n                  upperVoxelBound: volumeInfo.upperVoxelBound,\n                  upperClipBound,\n                  volumeType: this.volumeType,\n                  volumeSourceOptions,\n                  chunkLayoutPreference: this.chunkLayoutPreference,\n                  maxCompressedSegmentationBlockSize: vec3.fromValues(64, 64, 64),\n                })\n                .map(spec => {\n                  return this.chunkManager.getChunkSource(BrainmapsVolumeChunkSource, {\n                    credentialsProvider: this.credentialsProvider,\n                    spec,\n                    parameters: {\n                      'volumeId': this.volumeId,\n                      'changeSpec': this.changeSpec,\n                      'scaleIndex': scaleIndex,\n                      'encoding': encoding,\n                      'instance': this.instance,\n                    }\n                  });\n                }));\n  }\n\n  getMeshSource() {\n    const multiscaleMeshes = getMultiscaleMeshes(this.multiscaleVolumeInfo, this.meshes);\n    for (const mesh of multiscaleMeshes) {\n      return this.chunkManager.getChunkSource(BrainmapsMultiscaleMeshSource, {\n        credentialsProvider: this.credentialsProvider,\n        format: {\n          fragmentRelativeVertices: false,\n          transform: mat4.create(),\n          vertexPositionFormat: VertexPositionFormat.float32,\n        },\n        parameters: {\n          'instance': this.instance,\n          'volumeId': this.volumeId,\n          'info': mesh,\n          'changeSpec': this.changeSpec,\n        }\n      });\n    }\n    for (const mesh of this.meshes) {\n      if (mesh.type === 'TRIANGLES') {\n        return this.chunkManager.getChunkSource(BrainmapsMeshSource, {\n          credentialsProvider: this.credentialsProvider,\n          parameters: {\n            'instance': this.instance,\n            'volumeId': this.volumeId,\n            'meshName': mesh.name,\n            'changeSpec': this.changeSpec,\n          }\n        });\n      } else if (mesh.type === 'LINE_SEGMENTS') {\n        return this.chunkManager.getChunkSource(BrainmapsSkeletonSource, {\n          credentialsProvider: this.credentialsProvider,\n          parameters: {\n            'instance': this.instance,\n            'volumeId': this.volumeId,\n            'meshName': mesh.name,\n            'changeSpec': this.changeSpec,\n          }\n        });\n      }\n    }\n    return null;\n  }\n\n  getStaticAnnotations() {\n    const baseScale = this.scales[0];\n    const annotationSet =\n        new AnnotationSource(mat4.fromScaling(mat4.create(), baseScale.voxelSize));\n    annotationSet.readonly = true;\n    annotationSet.add(makeDataBoundsBoundingBox(vec3.create(), baseScale.upperVoxelBound));\n\n    baseScale.boundingBoxes.forEach((boundingBox, i) => {\n      annotationSet.add({\n        type: AnnotationType.AXIS_ALIGNED_BOUNDING_BOX,\n        description: boundingBox.metadata,\n        pointA: boundingBox.corner,\n        pointB: vec3.add(vec3.create(), boundingBox.corner, boundingBox.size),\n        id: `boundingBox${i}`,\n      });\n    });\n    return annotationSet;\n  }\n}\n\n\nexport function parseVolumeKey(key: string):\n    {volumeId: string, changeSpec: ChangeSpec|undefined, parameters: any} {\n  const match = key.match(/^([^:?]+:[^:?]+:[^:?]+)(?::([^:?]+))?(?:\\?(.*))?$/);\n  if (match === null) {\n    throw new Error(`Invalid Brain Maps volume key: ${JSON.stringify(key)}.`);\n  }\n  let changeSpec: ChangeSpec|undefined;\n  if (match[2] !== undefined) {\n    changeSpec = {changeStackId: match[2]};\n  }\n  const parameters = parseQueryStringParameters(match[3] || '');\n  return {volumeId: match[1], changeSpec, parameters};\n}\n\nconst meshSourcePattern = /^([^\\/]+)\\/(.*)$/;\n\n\ninterface ProjectMetadata {\n  id: string;\n  label: string;\n  description?: string;\n}\n\nfunction parseProject(obj: any): ProjectMetadata {\n  try {\n    verifyObject(obj);\n    return {\n      id: verifyObjectProperty(obj, 'id', verifyString),\n      label: verifyObjectProperty(obj, 'label', verifyString),\n      description: verifyObjectProperty(obj, 'description', verifyOptionalString),\n    };\n  } catch (parseError) {\n    throw new Error(`Failed to parse project: ${parseError.message}`);\n  }\n}\n\nfunction parseProjectList(obj: any) {\n  try {\n    verifyObject(obj);\n    return verifyObjectProperty(\n        obj, 'project', x => x === undefined ? [] : parseArray(x, parseProject));\n  } catch (parseError) {\n    throw new Error(`Error parsing project list: ${parseError.message}`);\n  }\n}\n\nfunction parseAPIResponseList(obj: any, propertyName: string) {\n  try {\n    verifyObject(obj);\n    return verifyObjectProperty(\n        obj, propertyName, x => x === undefined ? [] : parseArray(x, verifyString));\n  } catch (parseError) {\n    throw new Error(`Error parsing dataset list: ${parseError.message}`);\n  }\n}\n\nexport class VolumeList {\n  volumeIds: string[];\n  projects = new Map<string, ProjectMetadata>();\n  hierarchicalVolumeIds = new Map<string, string[]>();\n  constructor(projectsResponse: any, volumesResponse: any) {\n    const {projects} = this;\n    for (let project of parseProjectList(projectsResponse)) {\n      projects.set(project.id, project);\n    }\n    try {\n      verifyObject(volumesResponse);\n      let volumeIds = this.volumeIds = verifyObjectProperty(\n          volumesResponse, 'volumeId', x => x === undefined ? [] : parseArray(x, verifyString));\n      volumeIds.sort();\n      let hierarchicalSets = new Map<string, Set<string>>();\n      for (let volumeId of volumeIds) {\n        let componentStart = 0;\n        while (true) {\n          let nextColon: number|undefined = volumeId.indexOf(':', componentStart);\n          if (nextColon === -1) {\n            nextColon = undefined;\n          } else {\n            ++nextColon;\n          }\n          let groupString = volumeId.substring(0, componentStart);\n          let group = hierarchicalSets.get(groupString);\n          if (group === undefined) {\n            group = new Set<string>();\n            hierarchicalSets.set(groupString, group);\n          }\n          group.add(volumeId.substring(componentStart, nextColon));\n          if (nextColon === undefined) {\n            break;\n          }\n          componentStart = nextColon;\n        }\n      }\n      let {hierarchicalVolumeIds} = this;\n      for (let [group, valueSet] of hierarchicalSets) {\n        hierarchicalVolumeIds.set(group, Array.from(valueSet));\n      }\n    } catch (parseError) {\n      throw new Error(`Failed to parse Brain Maps volume list reply: ${parseError.message}`);\n    }\n  }\n}\n\n\nexport function parseChangeStackList(x: any) {\n  return verifyObjectProperty(\n      x, 'changeStackId', y => y === undefined ? undefined : parseArray(y, verifyString));\n}\n\nfunction makeAnnotationGeometrySourceSpecifications(multiscaleInfo: MultiscaleVolumeInfo) {\n  const baseScale = multiscaleInfo.scales[0];\n  const spec = new AnnotationGeometryChunkSpecification({\n    voxelSize: baseScale.voxelSize,\n    chunkSize: vec3.multiply(vec3.create(), baseScale.upperVoxelBound, baseScale.voxelSize),\n    upperChunkBound: vec3.fromValues(1, 1, 1),\n  });\n  return [[{parameters: undefined, spec}]];\n}\n\nconst MultiscaleAnnotationSourceBase = (WithParameters(\n    WithCredentialsProvider<Credentials>()(MultiscaleAnnotationSource),\n    AnnotationSourceParameters));\n\nexport class BrainmapsAnnotationSource extends MultiscaleAnnotationSourceBase {\n  key: any;\n  constructor(chunkManager: ChunkManager, options: {\n    credentialsProvider: CredentialsProvider<Credentials>,\n    parameters: AnnotationSourceParameters,\n    multiscaleVolumeInfo: MultiscaleVolumeInfo\n  }) {\n    super(chunkManager, <any>{\n      sourceSpecifications:\n          makeAnnotationGeometrySourceSpecifications(options.multiscaleVolumeInfo),\n      ...options\n    });\n    mat4.fromScaling(this.objectToLocal, options.multiscaleVolumeInfo.scales[0].voxelSize);\n  }\n}\n\nexport class BrainmapsDataSource extends DataSource {\n  constructor(\n      public instance: BrainmapsInstance,\n      public credentialsProvider: Owned<BrainmapsCredentialsProvider>) {\n    super();\n  }\n\n  get description() {\n    return this.instance.description;\n  }\n\n  getMeshSource(chunkManager: ChunkManager, url: string) {\n    return chunkManager.getChunkSource(BrainmapsMeshSource, {\n      credentialsProvider: this.credentialsProvider,\n      parameters: this.getMeshSourceParameters(url)\n    });\n  }\n\n\n  getMeshSourceParameters(url: string) {\n    let match = url.match(meshSourcePattern);\n    if (match === null) {\n      throw new Error(`Invalid Brainmaps mesh URL: ${url}`);\n    }\n    let {volumeId, changeSpec} = parseVolumeKey(match[1]);\n    return {instance: this.instance, volumeId, changeSpec, meshName: match[2]};\n  }\n\n  getSkeletonSource(chunkManager: ChunkManager, url: string) {\n    return chunkManager.getChunkSource(BrainmapsSkeletonSource, {\n      credentialsProvider: this.credentialsProvider,\n      parameters: this.getMeshSourceParameters(url)\n    });\n  }\n\n  getMultiscaleInfo(chunkManager: ChunkManager, volumeId: string) {\n    return chunkManager.memoize.getUncounted(\n        {\n          type: 'brainmaps:getMultiscaleInfo',\n          volumeId,\n          instance: this.instance,\n          credentialsProvider: getObjectId(this.credentialsProvider)\n        },\n        () => makeRequest(this.instance, this.credentialsProvider, {\n                method: 'GET',\n                path: `/v1beta2/volumes/${volumeId}`,\n                responseType: 'json'\n              }).then(response => new MultiscaleVolumeInfo(response)));\n  }\n\n  getVolume(chunkManager: ChunkManager, key: string, options: GetVolumeOptions) {\n    const {volumeId, changeSpec, parameters} = parseVolumeKey(key);\n    verifyObject(parameters);\n    const encoding = verifyObjectProperty(\n        parameters, 'encoding',\n        x => x === undefined ? undefined : verifyEnumString(x, VolumeChunkEncoding));\n    const chunkLayoutPreference = verifyObjectProperty(\n        parameters, 'chunkLayout',\n        x => x === undefined ? undefined : verifyEnumString(x, ChunkLayoutPreference));\n    const brainmapsOptions:\n        GetBrainmapsVolumeOptions = {...options, encoding, chunkLayoutPreference};\n    return chunkManager.memoize.getUncounted(\n        {\n          type: 'brainmaps:getVolume',\n          instance: this.instance,\n          volumeId,\n          changeSpec,\n          brainmapsOptions\n        },\n        () => Promise\n                  .all([\n                    this.getMultiscaleInfo(chunkManager, volumeId),\n                    makeRequest(this.instance, this.credentialsProvider, {\n                      method: 'GET',\n                      path: `/v1beta2/objects/${volumeId}/meshes`,\n                      responseType: 'json'\n                    }),\n                  ])\n                  .then(\n                      ([multiscaleVolumeInfo, meshesResponse]) => new MultiscaleVolumeChunkSource(\n                          chunkManager, this.instance, this.credentialsProvider, volumeId,\n                          changeSpec, multiscaleVolumeInfo, meshesResponse, brainmapsOptions)));\n  }\n\n  getAnnotationSource(chunkManager: ChunkManager, key: string) {\n    const {volumeId, changeSpec} = parseVolumeKey(key);\n    if (changeSpec === undefined) {\n      throw new Error(`A changestack must be specified.`);\n    }\n    const parameters = {\n      volumeId,\n      changestack: changeSpec.changeStackId,\n      instance: this.instance,\n    };\n    return chunkManager.memoize.getUncounted(\n        {\n          type: 'brainmaps:getAnnotationSource',\n          instance: this.instance,\n          credentialsProvider: getObjectId(this.credentialsProvider),\n          parameters\n        },\n        () =>\n            this.getMultiscaleInfo(chunkManager, volumeId)\n                .then(\n                    multiscaleVolumeInfo => chunkManager.getChunkSource(BrainmapsAnnotationSource, {\n                      parameters,\n                      credentialsProvider: this.credentialsProvider,\n                      multiscaleVolumeInfo\n                    })));\n  }\n\n  getProjectList(chunkManager: ChunkManager) {\n    return chunkManager.memoize.getUncounted(\n        {instance: this.instance, type: 'brainmaps:getProjectList'}, () => {\n          let promise = makeRequest(this.instance, this.credentialsProvider, {\n                          method: 'GET',\n                          path: '/v1beta2/projects',\n                          responseType: 'json'\n                        }).then((projectsResponse) => {\n            return parseProjectList(projectsResponse);\n          });\n          const description = `${this.instance.description} project list`;\n          StatusMessage.forPromise(promise, {\n            delay: true,\n            initialMessage: `Retrieving ${description}.`,\n            errorPrefix: `Error retrieving ${description}: `,\n          });\n          return promise;\n        });\n  }\n\n  getDatasetList(chunkManager: ChunkManager, project: string) {\n    return chunkManager.memoize.getUncounted(\n        {instance: this.instance, type: `brainmaps:${project}:getDatasetList`}, () => {\n          let promise = makeRequest(this.instance, this.credentialsProvider, {\n                          method: 'GET',\n                          path: `/v1beta2/datasets?project_id=${project}`,\n                          responseType: 'json'\n                        }).then((datasetsResponse) => {\n            return parseAPIResponseList(datasetsResponse, 'datasetIds');\n          });\n          const description = `${this.instance.description} dataset list`;\n          StatusMessage.forPromise(promise, {\n            delay: true,\n            initialMessage: `Retrieving ${description}`,\n            errorPrefix: `Error retrieving ${description}`\n          });\n          return promise;\n        });\n  }\n\n  getVolumeList(chunkManager: ChunkManager, project: string, dataset: string) {\n    return chunkManager.memoize.getUncounted(\n        {instance: this.instance, type: `brainmaps:${project}:${dataset}:getVolumeList`}, () => {\n          let promise = makeRequest(this.instance, this.credentialsProvider, {\n                          method: 'GET',\n                          path: `/v1beta2/volumes?project_id=${project}&dataset_id=${dataset}`,\n                          responseType: 'json'\n                        }).then((volumesResponse) => {\n            const fullyQualifyiedVolumeList = parseAPIResponseList(volumesResponse, 'volumeId');\n            const splitPoint = project.length + dataset.length + 2;\n            const volumeList = [];\n            for (const volume of fullyQualifyiedVolumeList) {\n              volumeList.push(volume.substring(splitPoint));\n            }\n            return volumeList;\n          });\n          const description = `${this.instance.description} volume list`;\n          StatusMessage.forPromise(promise, {\n            delay: true,\n            initialMessage: `Retrieving ${description}`,\n            errorPrefix: `Error retrieving ${description}`\n          });\n          return promise;\n        });\n  }\n\n  getChangeStackList(chunkManager: ChunkManager, volumeId: string) {\n    return chunkManager.memoize.getUncounted(\n        {instance: this.instance, type: 'brainmaps:getChangeStackList', volumeId}, () => {\n          let promise: Promise<string[]|undefined> =\n              makeRequest(this.instance, this.credentialsProvider, {\n                method: 'GET',\n                path: `/v1beta2/changes/${volumeId}/change_stacks`,\n                responseType: 'json'\n              }).then(response => parseChangeStackList(response));\n          const description = `change stacks for ${volumeId}`;\n          StatusMessage.forPromise(promise, {\n            delay: true,\n            initialMessage: `Retrieving ${description}.`,\n            errorPrefix: `Error retrieving ${description}: `,\n          });\n          return promise;\n        });\n  }\n\n  volumeCompleter(url: string, chunkManager: ChunkManager) {\n    let colonCount = 0;\n    const colonIndices = [];\n    for (let lastColon = url.indexOf(':'); lastColon >= 0;\n         lastColon = url.indexOf(':', lastColon + 1)) {\n      colonIndices.push(lastColon);\n      ++colonCount;\n    }\n    switch (colonCount) {\n      case 0: {  // Fetch project names\n        return this.getProjectList(chunkManager).then((projectMetadata) => {\n          let projectList: string[] = [];\n          let descriptionMap = new Map<String, string>();\n\n          for (const projectDatum of projectMetadata) {\n            const projectColon = projectDatum.id + ':';\n            projectList.push(projectColon);\n            descriptionMap.set(projectColon, projectDatum.label);\n          }\n\n          return {\n            offset: 0,\n            completions: getPrefixMatchesWithDescriptions(\n                url, projectList, x => x, x => descriptionMap.get(x))\n          };\n        });\n      }\n\n      case 1: {  // Fetch dataset names, under the current project\n        const colonLocation = colonIndices[0];\n        const projectId = url.substring(0, colonLocation);\n        return this.getDatasetList(chunkManager, projectId).then((datasetList) => {\n          const splitPoint = colonLocation + 1;\n          const matchString = url.substring(splitPoint);\n          const possibleMatches = [];\n          for (const datasetName of datasetList) {\n            possibleMatches.push(datasetName + ':');\n          }\n          possibleMatches.sort();\n\n          return {offset: splitPoint, completions: getPrefixMatches(matchString, possibleMatches)};\n        });\n      }\n\n      case 2: {  // Fetch volume names, under the current project and dataset\n        const projectId = url.substring(0, colonIndices[0]);\n        const datasetId = url.substring(colonIndices[0] + 1, colonIndices[1]);\n        const splitPoint = colonIndices[1] + 1;\n        return this.getVolumeList(chunkManager, projectId, datasetId).then((volumeList) => {\n          const matchString = url.substring(splitPoint);\n\n          return {offset: splitPoint, completions: getPrefixMatches(matchString, volumeList)};\n        });\n      }\n\n      default: {  // Fetch changestack names, under the current volume\n        const volumeId = url.substring(0, colonIndices[2]);\n        const splitPoint = colonIndices[2] + 1;\n        const matchString = url.substring(splitPoint);\n        return this.getChangeStackList(chunkManager, volumeId).then(changeStacks => {\n          if (changeStacks === undefined) {\n            throw null;\n          }\n          return {offset: splitPoint, completions: getPrefixMatches(matchString, changeStacks)};\n        });\n      }\n    }\n  }\n}\n\nexport const productionInstance: BrainmapsInstance = {\n  description: 'Google Brain Maps',\n  serverUrl: 'https://brainmaps.googleapis.com',\n};\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {defaultCredentialsManager} from 'neuroglancer/credentials_provider/default_manager';\nimport {credentialsKey} from 'neuroglancer/datasource/brainmaps/api';\nimport {BrainmapsCredentialsProvider} from 'neuroglancer/datasource/brainmaps/credentials_provider';\n\ndeclare var BRAINMAPS_CLIENT_ID: string;\n\ndefaultCredentialsManager.register(credentialsKey, () => new BrainmapsCredentialsProvider(BRAINMAPS_CLIENT_ID));\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {BrainmapsDataSource, productionInstance} from 'neuroglancer/datasource/brainmaps/frontend';\nimport {credentialsKey} from 'neuroglancer/datasource/brainmaps/api';\nimport {registerProvider} from 'neuroglancer/datasource/default_provider';\n\nregisterProvider(\n    'brainmaps',\n    options => new BrainmapsDataSource(\n        productionInstance, options.credentialsManager.getCredentialsProvider(credentialsKey)));\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {VolumeType} from 'neuroglancer/sliceview/volume/base';\nimport {DataType} from 'neuroglancer/util/data_type';\nimport {vec3} from 'neuroglancer/util/geom';\n\nexport class ComputedVolumeChunkSourceParameters {\n  computationRef: any;\n  sourceRef: any;\n  inputSize: vec3;\n  scaleFactor: vec3;\n\n  static RPC_ID = 'computed/ComputedVolumeChunkSourceParameters';\n}\n\n\nexport interface ComputationBufferSpecification {\n  size: vec3;\n  dataType: DataType;\n  volumeType: VolumeType;\n  numChannels: number;\n}\n\n// Parameters that specify data type, volume type, and size for the input and\n// output buffers relative to a computation. This information will ultimately\n// pass to the VolumeComputationBackend that executes the computation. Extend\n// this interface to add parameters - any additional parameters should be\n// optional to allow direct assignment to work between types.\nexport class ComputationParameters {\n  // Specification for the buffer that is provided to a computation as an\n  // input. The DataType, VolumeType and channel count will match that of the\n  // origin volume chunk provider. Size is specified per-computation,\n  // independently of the origin volume.\n  inputSpec: ComputationBufferSpecification;\n\n  // Same, for the output. Size matches the native size for the\n  // ComputedVolumeChunkSource.\n  outputSpec: ComputationBufferSpecification;\n}\n\nexport function getArrayView(buffer: ArrayBuffer, type: DataType) {\n  switch (type) {\n    case DataType.UINT8:\n      return new Uint8Array(buffer);\n    case DataType.UINT16:\n      return new Uint16Array(buffer);\n    case DataType.UINT32:\n    case DataType.UINT64:\n      return new Uint32Array(buffer);\n    case DataType.FLOAT32:\n      return new Float32Array(buffer);\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {ComputationParameters} from 'neuroglancer/datasource/computed/base';\n\nexport const EXAMPLE_COMPUTATION_RPC_ID = 'Computation.ExampleComputation';\n\nexport class ExampleComputationParameters extends ComputationParameters {}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {EXAMPLE_COMPUTATION_RPC_ID, ExampleComputationParameters} from 'neuroglancer/datasource/computed/example/base';\nimport {ComputedVolumeDataSourceParameters, VolumeComputationFrontend, VolumeComputationFrontendProvider} from 'neuroglancer/datasource/computed/frontend';\nimport {verify3dVec} from 'neuroglancer/util/json';\nimport {registerSharedObjectOwner} from 'neuroglancer/worker_rpc';\n\n@registerSharedObjectOwner(EXAMPLE_COMPUTATION_RPC_ID)\nexport class ExampleComputation extends VolumeComputationFrontend {\n  params: ExampleComputationParameters;\n}\n\nexport class ExampleComputationProvider implements VolumeComputationFrontendProvider {\n  getComputation(config: any, {}, params: ComputedVolumeDataSourceParameters) {\n    const computeParams: ExampleComputationParameters = params.computationParameters;\n\n    if (config['inputSize'] !== undefined) {\n      const inputSize = verify3dVec(config['inputSize']);\n      computeParams.inputSpec.size.set(inputSize);\n    }\n\n    if (config['outputSize'] !== undefined) {\n      const outputSize = verify3dVec(config['outputSize']);\n      computeParams.outputSpec.size.set(outputSize);\n    }\n\n    return Promise.resolve(new ExampleComputation(computeParams));\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {ExampleComputationProvider} from 'neuroglancer/datasource/computed/example/frontend';\nimport {ComputedDataSource} from 'neuroglancer/datasource/computed/frontend';\n\nComputedDataSource.registerComputation('example', new ExampleComputationProvider());\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {ChunkManager, WithParameters} from 'neuroglancer/chunk_manager/frontend';\nimport {DataSource, DataSourceProvider, GetVolumeOptions} from 'neuroglancer/datasource';\nimport {ComputationParameters, ComputedVolumeChunkSourceParameters} from 'neuroglancer/datasource/computed/base';\nimport {DataType, VolumeChunkSpecification, VolumeSourceOptions, VolumeType} from 'neuroglancer/sliceview/volume/base';\nimport {MultiscaleVolumeChunkSource as GenericMultiscaleVolumeChunkSource, VolumeChunkSource} from 'neuroglancer/sliceview/volume/frontend';\nimport {CancellationToken} from 'neuroglancer/util/cancellation';\nimport {mat4, vec3} from 'neuroglancer/util/geom';\nimport {verifyObject, verifyString} from 'neuroglancer/util/json';\nimport {SharedObject} from 'neuroglancer/worker_rpc';\n\n\nclass ComputedVolumeChunkSource extends\n(WithParameters(VolumeChunkSource, ComputedVolumeChunkSourceParameters)) {}\n\nexport abstract class VolumeComputationFrontend extends SharedObject {\n  constructor(public params: ComputationParameters) {\n    super();\n  }\n}\n\nexport interface VolumeComputationFrontendProvider {\n  /**\n   * Modifes the ComputedVolumeDataSourceParameters as needed and returns\n   * a VolumeComputationFrontend in a Promise.\n   * @param config a JSON object parsed from the URL\n   * @param volumes A volumes array as returned by\n   *   GenericMultiscaleVolumeChunkSource.getSources()\n   * @param params volume data source parameters, populated with defaults\n   *   from the native resolution origin source. These are to be modified.\n   * @returns a Promise containing containg the frontend computation.\n   */\n  getComputation(\n      config: any, volumes: VolumeChunkSource[][],\n      params: ComputedVolumeDataSourceParameters): Promise<VolumeComputationFrontend>;\n}\n\nexport interface ComputedVolumeDataSourceParameters {\n  // URL of the origin volume chunk source, used as computational input.\n  originUrl: string;\n  // Index of the input scale on the origin source.\n  inputScaleIndex: number;\n  // Index of the input volume at the given scale on the origin source.\n  inputSourceIndex: number;\n  // Output voxel size.\n  outputVoxelSize: vec3;\n  // Output voxel offset.\n  outputVoxelOffset: vec3;\n  // Output volume size.\n  outputVolumeSize: vec3;\n  // Determines input buffer size as well as output data chunks size, etc.\n  computationParameters: ComputationParameters;\n\n  dataSourceProvider: DataSourceProvider;\n}\n\ninterface ComputedVolumeSpecs {\n  sources: VolumeChunkSource[][];\n  volumeType: VolumeType;\n  dataType: DataType;\n  numChannels: number;\n}\n\nexport class ComputedMultiscaleVolumeChunkSource implements GenericMultiscaleVolumeChunkSource {\n  numChannels: number;\n  dataType: DataType;\n  volumeType: VolumeType;\n\n  constructor(\n      public params: ComputedVolumeDataSourceParameters, public sources: VolumeChunkSource[][],\n      public computation: VolumeComputationFrontend, public chunkManager: ChunkManager) {\n    this.numChannels = params.computationParameters.outputSpec.numChannels;\n    this.dataType = params.computationParameters.outputSpec.dataType;\n    this.volumeType = params.computationParameters.outputSpec.volumeType;\n  }\n\n  getSources(volumeSourceOptions: VolumeSourceOptions) {\n    const spec = VolumeChunkSpecification.getDefaults({\n      voxelSize: this.params.outputVoxelSize,\n      dataType: this.dataType,\n      numChannels: this.numChannels,\n      chunkDataSizes: [this.params.computationParameters.outputSpec.size],\n      transform: mat4.fromTranslation(\n          mat4.create(),\n          vec3.multiply(vec3.create(), this.params.outputVoxelSize, this.params.outputVoxelOffset)),\n      upperVoxelBound: this.params.outputVolumeSize,\n      volumeType: this.volumeType,\n      baseVoxelOffset: this.params.outputVoxelOffset,\n      volumeSourceOptions,\n    })[0];\n\n    const originSource = this.sources[this.params.inputScaleIndex][this.params.inputSourceIndex];\n    const inputResolution = originSource.spec.voxelSize;\n\n    const parameters: ComputedVolumeChunkSourceParameters = {\n      computationRef: this.computation.addCounterpartRef(),\n      sourceRef: originSource.addCounterpartRef(),\n      inputSize: this.params.computationParameters.inputSpec.size,\n      scaleFactor: vec3.divide(vec3.create(), this.params.outputVoxelSize, inputResolution)\n    };\n\n    const computedSource =\n        this.chunkManager.getChunkSource(ComputedVolumeChunkSource, {spec, parameters});\n\n    return [[computedSource]];\n  }\n\n  getMeshSource() {\n    return null;\n  }\n}\n\n\nexport class ComputedDataSource extends DataSource {\n  getOriginVolumes(\n      dataSourceProvider: DataSourceProvider, originUrl: string, chunkManager: ChunkManager,\n      cancellationToken: CancellationToken): Promise<ComputedVolumeSpecs> {\n    return dataSourceProvider.getVolume(chunkManager, originUrl, {}, cancellationToken)\n        .then((multiScaleVolumeChunkSource: GenericMultiscaleVolumeChunkSource) => {\n          const sources = multiScaleVolumeChunkSource.getSources({});\n          const specs = sources.map((volumeChunkSources) => {\n            return volumeChunkSources.map((volumeChunkSource) => {\n              return volumeChunkSource.spec;\n            });\n          });\n\n          return {\n            specs,\n            sources,\n            volumeType: multiScaleVolumeChunkSource.volumeType,\n            dataType: multiScaleVolumeChunkSource.dataType,\n            numChannels: multiScaleVolumeChunkSource.numChannels,\n          };\n        });\n  }\n\n  /**\n   * Creates a ComputedVolumeDataSourceParameters object with default values\n   * populated from the first volume spec at native resolution.\n   * @param volumeSpecs ComputedVolumeSpecs\n   * @param originUrl url for the origin data source\n   * @param dataSourceProvider\n   * @returns ComputedVolumeDataSourceParameters\n   */\n  defaultParams(\n      volumeSpecs: ComputedVolumeSpecs, originUrl: string,\n      dataSourceProvider: DataSourceProvider): ComputedVolumeDataSourceParameters {\n    const spec = volumeSpecs.sources[0][0].spec;\n    // Default DataType, VolumeType, channel count\n    const {dataType, volumeType, numChannels} = volumeSpecs;\n    // Default chunk size, used for input and output computation buffer sizes.\n    const size = spec.chunkDataSize;\n    return {\n      originUrl,\n      computationParameters: {\n        inputSpec: {size: vec3.copy(vec3.create(), size), dataType, volumeType, numChannels},\n        outputSpec: {size: vec3.copy(vec3.create(), size), dataType, volumeType, numChannels}\n      },\n      inputScaleIndex: 0,\n      inputSourceIndex: 0,\n      outputVoxelSize: vec3.copy(vec3.create(), spec.voxelSize),\n      outputVolumeSize: vec3.copy(vec3.create(), spec.upperVoxelBound),\n      outputVoxelOffset: vec3.copy(vec3.create(), spec.baseVoxelOffset),\n      dataSourceProvider\n    };\n  }\n\n  get description() {\n    return 'Computed data source.';\n  }\n\n  getVolume(\n      chunkManager: ChunkManager, config: string, options: GetVolumeOptions,\n      cancellationToken: CancellationToken) {\n    // Config is expected to be a json string, for example:\n    //   {\"origin\":\"brainmaps://p:d:v\",\"computation\":\"example\",\"inputSize\":\n    //     [36,36,32],\"outputSize\":[32,32,32]}\n    console.log('Computed datasource config:', config);\n    if (!options.dataSourceProvider) {\n      return Promise.reject(new Error('Need a DataSourceProvider'));\n    }\n\n    const dataSourceProvider = options.dataSourceProvider!;\n    let configObj: any;\n    try {\n      configObj = verifyObject(JSON.parse(config));\n    } catch (error) {\n      return Promise.reject(new Error(\n          `Could not parse JSON configuration while initializing computational datasource: ${\n              error}`));\n    }\n\n    if (!configObj) {\n      return Promise.reject(new Error('Could not verify configuration JSON'));\n    }\n    if (configObj['origin'] === undefined) {\n      return Promise.reject(new Error('Config is missing origin'));\n    }\n    if (configObj['computation'] === undefined) {\n      return Promise.reject(new Error('Config is missing computation'));\n    }\n\n    const computationName = verifyString(configObj['computation']);\n    const computationProvider = ComputedDataSource.computationMap.get(computationName);\n\n    const originUrl = verifyString(configObj['origin']);\n\n    if (!computationProvider) {\n      return Promise.reject(new Error(`Unable to find computation ${computationName}`));\n    }\n\n    return this.getOriginVolumes(dataSourceProvider, originUrl, chunkManager, cancellationToken)\n        .then((volumes) => {\n          const dataSourceParams = this.defaultParams(volumes, originUrl, dataSourceProvider);\n          return chunkManager.memoize.getUncounted(\n              {type: 'computed:getVolume', config: configObj},\n              () => computationProvider.getComputation(configObj, volumes.sources, dataSourceParams)\n                        .then((computation: VolumeComputationFrontend) => {\n                          computation.initializeCounterpart(chunkManager.rpc!, computation.params);\n                          return new ComputedMultiscaleVolumeChunkSource(\n                              dataSourceParams, volumes.sources, computation, chunkManager);\n                        }));\n        });\n  }\n\n  static computationMap = new Map<string, VolumeComputationFrontendProvider>();\n\n  static registerComputation(key: string, computationProvider: VolumeComputationFrontendProvider) {\n    this.computationMap.set(key, computationProvider);\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {ComputedDataSource} from 'neuroglancer/datasource/computed/frontend';\nimport {registerProvider} from 'neuroglancer/datasource/default_provider';\n\nif (true) {\n  registerProvider('computed', () => new ComputedDataSource());\n}\n","/**\n * @license\n * Copyright 2019 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {ComputationParameters} from 'neuroglancer/datasource/computed/base';\n\nexport const TENSORFLOW_COMPUTATION_RPC_ID = 'Computation.Tensorflow';\nexport const TENSORFLOW_INFERENCE_RPC_ID = 'Computation.Tensorflow.Inference';\n\nexport class TensorflowComputationParameters extends ComputationParameters {\n  inputDType?: string;\n  mean?: number;\n  stdDev?: number;\n  inputTensorShape?: number[];\n  inputTensorNumElements?: number;\n}\n\nexport type TensorflowArray = Int32Array|Float32Array;\n\nexport interface InferenceRequest {\n  inputBuffer: TensorflowArray;\n  computationRef: any;\n  priority: number;\n}\n\nexport interface InferenceResult {\n  outputBuffer: TensorflowArray;\n}\n","/**\n * @license\n * Copyright 2019 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as tfjsModule from '@tensorflow/tfjs';\nimport {InferenceModel, Tensor} from '@tensorflow/tfjs';\nimport {ComputedVolumeDataSourceParameters, VolumeComputationFrontend, VolumeComputationFrontendProvider} from 'neuroglancer/datasource/computed/frontend';\nimport {InferenceRequest, InferenceResult, TENSORFLOW_COMPUTATION_RPC_ID, TENSORFLOW_INFERENCE_RPC_ID, TensorflowArray, TensorflowComputationParameters} from 'neuroglancer/datasource/computed/tensorflow/base';\nimport {DataType, VolumeType} from 'neuroglancer/sliceview/volume/base';\nimport {CANCELED, CancellationToken} from 'neuroglancer/util/cancellation';\nimport {verifyFloat, verifyString} from 'neuroglancer/util/json';\nimport {registerPromiseRPC, registerSharedObjectOwner, RPCPromise} from 'neuroglancer/worker_rpc';\n\nlet tfjs: null|typeof tfjsModule = null;\n\nexport function loadTFjs() {\n  if (tfjs) {\n    return Promise.resolve();\n  }\n  return import(/* webpackChunkName: \"tfjs-library\" */ '@tensorflow/tfjs').then((module) => {\n    tfjs = module;\n  });\n}\n\n/**\n * Dict-style object that represents a pending inference request.\n */\ninterface PendingInference {\n  // TF.js-compatible typed array, to be used as input.\n  array: TensorflowArray;\n  // If cancelled, reject(CANCELED) is called instead of performing inference.\n  cancellationToken: CancellationToken;\n  // The priority of the output chunk. Requests are handled in priority order.\n  priority: number;\n  // Resolve/Reject lambdas for the Promise awaiting inference.\n  reject: (message: any) => void;\n  resolve: (inferenceResult: InferenceResult) => void;\n}\n\n@registerSharedObjectOwner(TENSORFLOW_COMPUTATION_RPC_ID)\nexport class TensorflowComputation extends VolumeComputationFrontend {\n  params: TensorflowComputationParameters;\n\n  // The queue of pending inference requests. Maintained in order of increasing\n  // priority, so that pop() always returns the next appropriate request.\n  private inferenceQueue_: PendingInference[] = [];\n  // True iff the inference loop is in operation.\n  private running_ = false;\n\n  constructor(params: TensorflowComputationParameters, private model_: InferenceModel) {\n    super(params);\n  }\n\n  /**\n   * Adds a TF.js-compatible typed array to the inference queue and starts the\n   * inference loop, if it isn't already running. Returns a promise that\n   * resolves with the prediction output.\n   *\n   * Creates a PendingInference object and inserts it into the correct position\n   * in the inference queue, which is guaranteed to be less than the length of\n   * the backend computation queue in length. As such, it is most likely\n   * faster to simply iterate the queue to insert the request rather than using\n   * a more sophisticated method like binary insertion or a tree-based queue.\n   * @param array the input data to run inference over\n   * @param priority\n   * @param cancellationToken\n   */\n  predict(array: TensorflowArray, priority: number, cancellationToken: CancellationToken):\n      RPCPromise<InferenceResult> {\n    return new Promise((resolve, reject) => {\n             let i;\n             const queue = this.inferenceQueue_;\n             for (i = 0; i < queue.length && queue[i].priority < priority; ++i) {\n             }\n             queue.splice(i, 0, {array, cancellationToken, priority, resolve, reject});\n             this.startInference();\n           })\n        .then((result: InferenceResult) => {\n          return {value: result, transfers: [result.outputBuffer.buffer]};\n        });\n  }\n\n  /**\n   * Start the inference loop, if it isn't already running.\n   */\n  startInference() {\n    if (this.running_) {\n      return;\n    }\n    this.running_ = true;\n    setTimeout(() => this.runInference_(), 0);\n  }\n\n  /**\n   * Run the inference loop recursively.\n   */\n  private runInference_() {\n    if (this.inferenceQueue_.length === 0) {\n      this.running_ = false;\n      return;\n    }\n\n    const pendingInference = this.inferenceQueue_.pop()!;\n\n    if (pendingInference.cancellationToken.isCanceled) {\n      pendingInference.reject(CANCELED);\n      this.runInference_();\n      return;\n    }\n\n    this.modelInference_(pendingInference).then(() => this.runInference_());\n  }\n\n  /**\n   * Executes tf.js prediction, resolving or rejecting the pending request's\n   * promise, as appropriate.\n   * @param inferenceRequest  the request to infer.\n   */\n  private modelInference_(inferenceRequest: PendingInference): Promise<void> {\n    const inputLength = inferenceRequest.array.length;\n    const expectedLength = this.params.inputTensorNumElements!;\n    if (inputLength !== expectedLength) {\n      inferenceRequest.reject(\n          new Error(`Input array has ${inputLength} elements. Expected ${expectedLength}`));\n      return Promise.resolve();\n    }\n\n    const prediction = tfjs!.tidy(() => {\n      const modelInput =\n          tfjs!.tensor(inferenceRequest.array).reshape(this.params.inputTensorShape!);\n      const model = this.model_!;\n      return <Tensor>model.predict(modelInput, {});\n    });\n\n    return prediction.data()\n        .then((outputBuffer: TensorflowArray) => {\n          prediction.dispose();\n          const result: InferenceResult = {outputBuffer};\n          inferenceRequest.resolve(result);\n        })\n        .then(() => {\n          return new Promise<void>((resolve) => {\n            setTimeout(() => resolve(), 10);\n          });\n        });\n  }\n}\n\nexport class TensorflowComputationProvider implements VolumeComputationFrontendProvider {\n  getComputation(config: any, {}, params: ComputedVolumeDataSourceParameters) {\n    let modelPath = verifyString(config['modelPath']);\n    if (!modelPath.endsWith('/')) {\n      modelPath += '/';\n    }\n\n    let model: InferenceModel;\n    let stdDev = 1.0;\n    let mean = 0.0;\n    let outputType = VolumeType.SEGMENTATION;\n\n    if (config['stdDev'] !== undefined) {\n      stdDev = verifyFloat(config['stdDev']);\n    }\n    if (config['mean'] !== undefined) {\n      mean = verifyFloat(config['mean']);\n    }\n    if (config['atype'] !== undefined) {\n      const atype = verifyString(config['atype']);\n      switch (atype) {\n        case 'classifier':\n          break;\n        case 'regressor':\n          outputType = VolumeType.IMAGE;\n          break;\n        default:\n          throw new Error(`Unknown algorithm type ${atype}. Must be \"classifier\" or \"regressor\"`);\n      }\n    }\n\n    // Load the model, then do a dummy inference run. This allows us to\n    // explicitly discover the output dimensions, and to compile the\n    // model on the gpu.\n    return loadTFjs()\n        .then(() => {\n          return tfjs!.loadFrozenModel(\n              modelPath + 'tensorflowjs_model.pb', modelPath + 'weights_manifest.json');\n        })\n        .then((tfModel: InferenceModel) => {\n          model = tfModel;\n          if (model.inputs.length !== 1) {\n            throw new Error('Only models with exactly one input are supported');\n          }\n          if (model.outputs.length !== 1) {\n            // Todo: support for multiple-output models.\n            throw new Error('Only models with exactly one output are supported');\n          }\n\n          // Create a blank tensor, run prediction, check output size\n          const dummyOutput = tfjs!.tidy(() => {\n            const dummyInput: Tensor = tfjs!.ones(<number[]>model.inputs[0].shape);\n            return <Tensor>model.predict(dummyInput, {});\n          });\n\n          return dummyOutput.data().then(() => {\n            return dummyOutput;\n          });\n        })\n        .then((outputTensor: Tensor) => {\n          const inputShape = [1, 1, 1];\n          const outputShape = [1, 1, 1];\n          const inputTensor = model.inputs[0];\n          const inputDType = inputTensor.dtype;\n\n          let idx = 0;\n          for (let dim of inputTensor.shape!) {\n            if (dim > 1) {\n              inputShape[idx] = dim;\n              ++idx;\n            }\n\n            if (idx >= 3) {\n              throw new Error(\n                  `Cannot support tensorflow model with input ndim > 3: ${inputTensor.shape!}`);\n            }\n          }\n\n          idx = 0;\n          for (let dim of outputTensor.shape!) {\n            if (dim > 1) {\n              outputShape[idx] = dim;\n              ++idx;\n            }\n\n            if (idx >= 3) {\n              throw new Error(\n                  `Cannot support tensorflow model with output ndim > 3: ${outputTensor.shape!}`);\n            }\n          }\n          outputTensor.dispose();\n\n          let numElements = 1.0;\n          for (const dim of inputTensor.shape!) {\n            numElements *= dim;\n          }\n\n          const tfParams: TensorflowComputationParameters = params.computationParameters;\n          tfParams.inputSpec.size.set(inputShape);\n          tfParams.outputSpec.size.set(outputShape);\n          tfParams.outputSpec.dataType = DataType.UINT32;\n          tfParams.outputSpec.volumeType = outputType;\n          tfParams.inputDType = inputDType;\n          tfParams.mean = mean;\n          tfParams.stdDev = stdDev;\n          tfParams.inputTensorShape = inputTensor.shape;\n          tfParams.inputTensorNumElements = numElements;\n\n          return new TensorflowComputation(tfParams, model);\n        });\n  }\n}\n\nregisterPromiseRPC(\n    TENSORFLOW_INFERENCE_RPC_ID, function(x, cancellationToken): RPCPromise<InferenceResult> {\n      const request = <InferenceRequest>x.inferenceRequest;\n      const computation = <TensorflowComputation>this.get(request.computationRef);\n      return computation.predict(request.inputBuffer, request.priority, cancellationToken);\n    });\n","/**\n * @license\n * Copyright 2019 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {ComputedDataSource} from 'neuroglancer/datasource/computed/frontend';\nimport {TensorflowComputationProvider} from 'neuroglancer/datasource/computed/tensorflow/frontend';\n\nComputedDataSource.registerComputation('tensorflow', new TensorflowComputationProvider());\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Facility for registering default data sources.\n */\n\nimport {CredentialsManager} from 'neuroglancer/credentials_provider';\nimport {DataSource, DataSourceProvider} from 'neuroglancer/datasource';\nimport {Owned} from 'neuroglancer/util/disposable';\n\nexport interface ProviderOptions {\n  credentialsManager: CredentialsManager;\n}\n\nexport type ProviderFactory = (options: ProviderOptions) => Owned<DataSource>;\nconst providerFactories = new Map<string, ProviderFactory>();\n\nexport function registerProvider(name: string, factory: ProviderFactory) {\n  providerFactories.set(name, factory);\n}\n\nexport function getDefaultDataSourceProvider(options: ProviderOptions) {\n  const provider = new DataSourceProvider();\n  for (const [name, factory] of providerFactories) {\n    provider.register(name, factory(options));\n  }\n  return provider;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport enum VolumeChunkEncoding {\n  JPEG,\n  RAW,\n  COMPRESSED_SEGMENTATION,\n  COMPRESSED_SEGMENTATIONARRAY\n}\n\nexport class DVIDSourceParameters {\n  baseUrl: string;\n  nodeKey: string;\n  dataInstanceKey: string;\n}\n\nexport class VolumeChunkSourceParameters extends DVIDSourceParameters {\n  dataScale: string;\n  encoding: VolumeChunkEncoding;\n  static RPC_ID = 'dvid/VolumeChunkSource';\n}\n\nexport class SkeletonSourceParameters extends DVIDSourceParameters {\n  static RPC_ID = 'dvid/SkeletonSource';\n}\n\nexport class MeshSourceParameters extends DVIDSourceParameters {\n  static RPC_ID = 'dvid/MeshSource';\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file\n * Support for DVID (https://github.com/janelia-flyem/dvid) servers.\n */\n\nimport {ChunkManager, WithParameters} from 'neuroglancer/chunk_manager/frontend';\nimport {CompletionResult, DataSource} from 'neuroglancer/datasource';\nimport {DVIDSourceParameters, MeshSourceParameters, SkeletonSourceParameters, VolumeChunkEncoding, VolumeChunkSourceParameters} from 'neuroglancer/datasource/dvid/base';\nimport {MeshSource} from 'neuroglancer/mesh/frontend';\nimport {SkeletonSource} from 'neuroglancer/skeleton/frontend';\nimport {DataType, VolumeChunkSpecification, VolumeSourceOptions, VolumeType} from 'neuroglancer/sliceview/volume/base';\nimport {MultiscaleVolumeChunkSource as GenericMultiscaleVolumeChunkSource, VolumeChunkSource} from 'neuroglancer/sliceview/volume/frontend';\nimport {StatusMessage} from 'neuroglancer/status';\nimport {applyCompletionOffset, getPrefixMatchesWithDescriptions} from 'neuroglancer/util/completion';\nimport {mat4, vec3} from 'neuroglancer/util/geom';\nimport {fetchOk} from 'neuroglancer/util/http_request';\nimport {parseArray, parseFixedLengthArray, parseIntVec, verifyFinitePositiveFloat, verifyMapKey, verifyObject, verifyObjectAsMap, verifyObjectProperty, verifyPositiveInt, verifyString} from 'neuroglancer/util/json';\n\nlet serverDataTypes = new Map<string, DataType>();\nserverDataTypes.set('uint8', DataType.UINT8);\nserverDataTypes.set('uint32', DataType.UINT32);\nserverDataTypes.set('uint64', DataType.UINT64);\n\nexport class DataInstanceBaseInfo {\n  get typeName(): string {\n    return this.obj['TypeName'];\n  }\n\n  get compressionName(): string {\n    return this.obj['Compression'];\n  }\n\n  constructor(public obj: any) {\n    verifyObject(obj);\n    verifyObjectProperty(obj, 'TypeName', verifyString);\n  }\n}\n\nexport class DataInstanceInfo {\n  constructor(public obj: any, public name: string, public base: DataInstanceBaseInfo) {}\n}\n\nclass DVIDVolumeChunkSource extends\n(WithParameters(VolumeChunkSource, VolumeChunkSourceParameters)) {}\n\nclass DVIDSkeletonSource extends\n(WithParameters(SkeletonSource, SkeletonSourceParameters)) {}\n\nclass DVIDMeshSource extends\n(WithParameters(MeshSource, MeshSourceParameters)) {}\n\nexport class VolumeDataInstanceInfo extends DataInstanceInfo {\n  dataType: DataType;\n  lowerVoxelBound: vec3;\n  upperVoxelBound: vec3;\n  voxelSize: vec3;\n  numChannels: number;\n  numLevels: number;\n  meshSrc: string;\n  skeletonSrc: string;\n\n  constructor(\n      obj: any, name: string, base: DataInstanceBaseInfo, public encoding: VolumeChunkEncoding,\n      instanceNames: Array<string>) {\n    super(obj, name, base);\n    let extended = verifyObjectProperty(obj, 'Extended', verifyObject);\n    let extendedValues = verifyObjectProperty(extended, 'Values', x => parseArray(x, verifyObject));\n    if (extendedValues.length < 1) {\n      throw new Error(\n          'Expected Extended.Values property to have length >= 1, but received: ${JSON.stringify(extendedValues)}.');\n    }\n    this.numLevels = 1;\n\n    let instSet = new Set<string>(instanceNames);\n    if (encoding === VolumeChunkEncoding.COMPRESSED_SEGMENTATIONARRAY) {\n      // retrieve maximum downres level\n      let maxdownreslevel = verifyObjectProperty(extended, 'MaxDownresLevel', verifyPositiveInt);\n      this.numLevels = maxdownreslevel + 1;\n    } else {\n      // labelblk does not have explicit datatype support for multiscale but\n      // by convention different levels are specified with unique\n      // instances where levels are distinguished by the suffix '_LEVELNUM'\n      while (instSet.has(name + '_' + this.numLevels.toString())) {\n        this.numLevels += 1;\n      }\n    }\n\n    // only allow mesh or skeletons as sources but not both\n    this.meshSrc = '';\n    if (instSet.has(name + '_meshes')) {\n      this.meshSrc = name + '_meshes';\n    }\n\n    this.skeletonSrc = '';\n    if (this.meshSrc !== '') {\n      if (instSet.has(name + '_skeletons')) {\n        this.skeletonSrc = name + '_skeletons';\n      }\n    }\n\n\n    this.dataType =\n        verifyObjectProperty(extendedValues[0], 'DataType', x => verifyMapKey(x, serverDataTypes));\n    this.voxelSize = verifyObjectProperty(\n        extended, 'VoxelSize',\n        x => parseFixedLengthArray(vec3.create(), x, verifyFinitePositiveFloat));\n    this.numChannels = 1;\n  }\n\n  get volumeType() {\n    return (\n        (this.encoding === VolumeChunkEncoding.COMPRESSED_SEGMENTATION ||\n         this.encoding === VolumeChunkEncoding.COMPRESSED_SEGMENTATIONARRAY) ?\n            VolumeType.SEGMENTATION :\n            VolumeType.IMAGE);\n  }\n\n  getSources(\n      chunkManager: ChunkManager, parameters: DVIDSourceParameters,\n      volumeSourceOptions: VolumeSourceOptions) {\n    let {encoding} = this;\n    let sources: VolumeChunkSource[][] = [];\n\n    // must be 64 block size to work with neuroglancer properly\n    let blocksize = 64;\n    for (let level = 0; level < this.numLevels; ++level) {\n      let voxelSize = vec3.scale(vec3.create(), this.voxelSize, Math.pow(2, level));\n      let lowerVoxelBound = vec3.create();\n      let upperVoxelBound = vec3.create();\n      for (let i = 0; i < 3; ++i) {\n        let lowerVoxelNotAligned =\n            Math.floor(this.lowerVoxelBound[i] * (this.voxelSize[i] / voxelSize[i]));\n        // adjust min to be a multiple of blocksize\n        lowerVoxelBound[i] = lowerVoxelNotAligned - (lowerVoxelNotAligned % blocksize);\n        let upperVoxelNotAligned =\n            Math.ceil((this.upperVoxelBound[i] + 1) * (this.voxelSize[i] / voxelSize[i]));\n        upperVoxelBound[i] = upperVoxelNotAligned;\n        // adjust max to be a multiple of blocksize\n        if ((upperVoxelNotAligned % blocksize) !== 0) {\n          upperVoxelBound[i] += (blocksize - (upperVoxelNotAligned % blocksize));\n        }\n      }\n      let dataInstanceKey = parameters.dataInstanceKey;\n\n      if (encoding !== VolumeChunkEncoding.COMPRESSED_SEGMENTATIONARRAY) {\n        if (level > 0) {\n          dataInstanceKey += '_' + level.toString();\n        }\n      }\n\n      let volParameters: VolumeChunkSourceParameters = {\n        'baseUrl': parameters.baseUrl,\n        'nodeKey': parameters.nodeKey,\n        'dataInstanceKey': dataInstanceKey,\n        'dataScale': level.toString(),\n        'encoding': encoding,\n      };\n      let alternatives =\n          VolumeChunkSpecification\n              .getDefaults({\n                voxelSize: voxelSize,\n                dataType: this.dataType,\n                numChannels: this.numChannels,\n                transform: mat4.fromTranslation(\n                    mat4.create(), vec3.multiply(vec3.create(), lowerVoxelBound, voxelSize)),\n                baseVoxelOffset: lowerVoxelBound,\n                upperVoxelBound: vec3.subtract(vec3.create(), upperVoxelBound, lowerVoxelBound),\n                volumeType: this.volumeType,\n                volumeSourceOptions,\n                compressedSegmentationBlockSize:\n                    ((encoding === VolumeChunkEncoding.COMPRESSED_SEGMENTATION ||\n                      encoding === VolumeChunkEncoding.COMPRESSED_SEGMENTATIONARRAY) ?\n                         vec3.fromValues(8, 8, 8) :\n                         undefined)\n              })\n              .map(spec => {\n                return chunkManager.getChunkSource(\n                    DVIDVolumeChunkSource, {spec, parameters: volParameters});\n              });\n      sources.push(alternatives);\n    }\n    return sources;\n  }\n\n  getMeshSource(chunkManager: ChunkManager, parameters: DVIDSourceParameters) {\n    if (this.meshSrc !== '') {\n      return chunkManager.getChunkSource(DVIDMeshSource, {\n        parameters: {\n          'baseUrl': parameters.baseUrl,\n          'nodeKey': parameters.nodeKey,\n          'dataInstanceKey': this.meshSrc,\n        }\n      });\n    } else {\n      return null;\n    }\n  }\n\n  getSkeletonSource(chunkManager: ChunkManager, parameters: DVIDSourceParameters) {\n    if (this.skeletonSrc !== '') {\n      return chunkManager.getChunkSource(DVIDSkeletonSource, {\n        parameters: {\n          'baseUrl': parameters.baseUrl,\n          'nodeKey': parameters.nodeKey,\n          'dataInstanceKey': this.skeletonSrc,\n        }\n      });\n    } else {\n      return null;\n    }\n  }\n}\n\nexport function parseDataInstance(\n    obj: any, name: string, instanceNames: Array<string>): DataInstanceInfo {\n  verifyObject(obj);\n  let baseInfo = verifyObjectProperty(obj, 'Base', x => new DataInstanceBaseInfo(x));\n  switch (baseInfo.typeName) {\n    case 'uint8blk':\n    case 'grayscale8':\n      let isjpegcompress = baseInfo.compressionName.indexOf('jpeg') !== -1;\n      return new VolumeDataInstanceInfo(\n          obj, name, baseInfo,\n          (isjpegcompress ? VolumeChunkEncoding.JPEG : VolumeChunkEncoding.RAW), instanceNames);\n    case 'labels64':\n    case 'labelblk':\n      return new VolumeDataInstanceInfo(\n          obj, name, baseInfo, VolumeChunkEncoding.COMPRESSED_SEGMENTATION, instanceNames);\n    case 'labelarray':\n    case 'labelmap':\n      return new VolumeDataInstanceInfo(\n          obj, name, baseInfo, VolumeChunkEncoding.COMPRESSED_SEGMENTATIONARRAY, instanceNames);\n    default:\n      throw new Error(`DVID data type ${JSON.stringify(baseInfo.typeName)} is not supported.`);\n  }\n}\n\nexport class RepositoryInfo {\n  alias: string;\n  description: string;\n  errors: string[] = [];\n  dataInstances = new Map<string, DataInstanceInfo>();\n  uuid: string;\n  vnodes = new Set<string>();\n  constructor(obj: any) {\n    if (obj instanceof RepositoryInfo) {\n      this.alias = obj.alias;\n      this.description = obj.description;\n      // just copy references\n      this.errors = obj.errors;\n      this.dataInstances = obj.dataInstances;\n      return;\n    }\n    verifyObject(obj);\n    this.alias = verifyObjectProperty(obj, 'Alias', verifyString);\n    this.description = verifyObjectProperty(obj, 'Description', verifyString);\n    let dataInstanceObjs = verifyObjectProperty(obj, 'DataInstances', verifyObject);\n    let instanceKeys = Object.keys(dataInstanceObjs);\n    for (let key of instanceKeys) {\n      try {\n        this.dataInstances.set(key, parseDataInstance(dataInstanceObjs[key], key, instanceKeys));\n      } catch (parseError) {\n        let message = `Failed to parse data instance ${JSON.stringify(key)}: ${parseError.message}`;\n        console.log(message);\n        this.errors.push(message);\n      }\n    }\n\n    let dagObj = verifyObjectProperty(obj, 'DAG', verifyObject);\n    let nodeObjs = verifyObjectProperty(dagObj, 'Nodes', verifyObject);\n    for (let key of Object.keys(nodeObjs)) {\n      this.vnodes.add(key);\n    }\n  }\n}\n\nexport function parseRepositoriesInfo(obj: any) {\n  try {\n    let result = verifyObjectAsMap(obj, x => new RepositoryInfo(x));\n\n    // make all versions available for viewing\n    let allVersions = new Map<string, RepositoryInfo>();\n    for (let [key, info] of result) {\n      allVersions.set(key, info);\n      for (let key2 of info.vnodes) {\n        if (key2 !== key) {\n          // create new repo\n          let rep = new RepositoryInfo(info);\n          allVersions.set(key2, rep);\n        }\n      }\n    }\n\n    for (let [key, info] of allVersions) {\n      info.uuid = key;\n    }\n    return allVersions;\n  } catch (parseError) {\n    throw new Error(`Failed to parse DVID repositories info: ${parseError.message}`);\n  }\n}\n\nexport class ServerInfo {\n  repositories: Map<string, RepositoryInfo>;\n  constructor(obj: any) {\n    this.repositories = parseRepositoriesInfo(obj);\n  }\n\n  getNode(nodeKey: string): RepositoryInfo {\n    // FIXME: Support non-root nodes.\n    let matches: string[] = [];\n    for (let key of this.repositories.keys()) {\n      if (key.startsWith(nodeKey)) {\n        matches.push(key);\n      }\n    }\n    if (matches.length !== 1) {\n      throw new Error(\n          `Node key ${JSON.stringify(nodeKey)} matches ${JSON.stringify(matches)} nodes.`);\n    }\n    return this.repositories.get(matches[0])!;\n  }\n}\n\nexport function getServerInfo(chunkManager: ChunkManager, baseUrl: string) {\n  return chunkManager.memoize.getUncounted({type: 'dvid:getServerInfo', baseUrl}, () => {\n    const result = fetchOk(`${baseUrl}/api/repos/info`)\n                       .then(response => response.json())\n                       .then(response => new ServerInfo(response));\n    const description = `repository info for DVID server ${baseUrl}`;\n    StatusMessage.forPromise(result, {\n      initialMessage: `Retrieving ${description}.`,\n      delay: true,\n      errorPrefix: `Error retrieving ${description}: `,\n    });\n    return result;\n  });\n}\n\n/**\n * Get extra dataInstance info that isn't available on the server level.\n * this requires an extra api call\n */\nexport function getDataInstanceDetails(\n    chunkManager: ChunkManager, baseUrl: string, nodeKey: string, info: VolumeDataInstanceInfo) {\n  return chunkManager.memoize.getUncounted(\n      {type: 'dvid:getInstanceDetails', baseUrl, nodeKey, name: info.name}, () => {\n        let result = fetchOk(`${baseUrl}/api/node/${nodeKey}/${info.name}/info`)\n                         .then(response => response.json());\n        const description = `datainstance info for node ${nodeKey} and instance ${info.name} ` +\n            `on DVID server ${baseUrl}`;\n\n        StatusMessage.forPromise(result, {\n          initialMessage: `Retrieving ${description}.`,\n          delay: true,\n          errorPrefix: `Error retrieving ${description}: `,\n        });\n\n        return result.then(instanceDetails => {\n          let extended = verifyObjectProperty(instanceDetails, 'Extended', verifyObject);\n          info.lowerVoxelBound =\n              verifyObjectProperty(extended, 'MinPoint', x => parseIntVec(vec3.create(), x));\n          info.upperVoxelBound =\n              verifyObjectProperty(extended, 'MaxPoint', x => parseIntVec(vec3.create(), x));\n          return info;\n        });\n      });\n}\n\n\nexport class MultiscaleVolumeChunkSource implements GenericMultiscaleVolumeChunkSource {\n  get dataType() {\n    return this.info.dataType;\n  }\n  get numChannels() {\n    return this.info.numChannels;\n  }\n  get volumeType() {\n    return this.info.volumeType;\n  }\n\n  constructor(\n      public chunkManager: ChunkManager, public baseUrl: string, public nodeKey: string,\n      public dataInstanceKey: string, public info: VolumeDataInstanceInfo) {}\n\n  getSources(volumeSourceOptions: VolumeSourceOptions) {\n    return this.info.getSources(\n        this.chunkManager, {\n          'baseUrl': this.baseUrl,\n          'nodeKey': this.nodeKey,\n          'dataInstanceKey': this.dataInstanceKey,\n        },\n        volumeSourceOptions);\n  }\n\n  getMeshSource() {\n    let meshSource = this.info.getMeshSource(this.chunkManager, {\n      'baseUrl': this.baseUrl,\n      'nodeKey': this.nodeKey,\n      'dataInstanceKey': this.dataInstanceKey,\n    });\n    if (meshSource === null) {\n      return this.info.getSkeletonSource(this.chunkManager, {\n        'baseUrl': this.baseUrl,\n        'nodeKey': this.nodeKey,\n        'dataInstanceKey': this.dataInstanceKey,\n      });\n    }\n    return meshSource;\n  }\n}\n\nconst urlPattern = /^((?:http|https):\\/\\/[^\\/]+)\\/([^\\/]+)\\/([^\\/]+)$/;\n\nexport function getVolume(chunkManager: ChunkManager, url: string) {\n  let match = url.match(urlPattern);\n  if (match === null) {\n    throw new Error(`Invalid DVID URL: ${JSON.stringify(url)}.`);\n  }\n  const baseUrl = match[1];\n  const nodeKey = match[2];\n  const dataInstanceKey = match[3];\n  return getServerInfo(chunkManager, baseUrl)\n      .then(serverInfo => {\n        let repositoryInfo = serverInfo.getNode(nodeKey);\n        if (repositoryInfo === undefined) {\n          throw new Error(`Invalid node: ${JSON.stringify(nodeKey)}.`);\n        }\n        const dataInstanceInfo = repositoryInfo.dataInstances.get(dataInstanceKey);\n        if (!(dataInstanceInfo instanceof VolumeDataInstanceInfo)) {\n          throw new Error(`Invalid data instance ${dataInstanceKey}.`);\n        }\n        return getDataInstanceDetails(chunkManager, baseUrl, nodeKey, dataInstanceInfo);\n      })\n      .then((info: VolumeDataInstanceInfo) => {\n        return chunkManager.memoize.getUncounted(\n            {\n              type: 'dvid:MultiscaleVolumeChunkSource',\n              baseUrl,\n              nodeKey: nodeKey,\n              dataInstanceKey,\n            },\n            () => new MultiscaleVolumeChunkSource(\n                chunkManager, baseUrl, nodeKey, dataInstanceKey, info));\n      });\n}\n\nexport function completeInstanceName(\n    repositoryInfo: RepositoryInfo, prefix: string): CompletionResult {\n  return {\n    offset: 0,\n    completions: getPrefixMatchesWithDescriptions<DataInstanceInfo>(\n        prefix, repositoryInfo.dataInstances.values(), instance => instance.name,\n        instance => {\n          return `${instance.base.typeName}`;\n        })\n  };\n}\n\nexport function completeNodeAndInstance(serverInfo: ServerInfo, prefix: string): CompletionResult {\n  let match = prefix.match(/^(?:([^\\/]+)(?:\\/([^\\/]*))?)?$/);\n  if (match === null) {\n    throw new Error(`Invalid DVID URL syntax.`);\n  }\n  if (match[2] === undefined) {\n    // Try to complete the node name.\n    return {\n      offset: 0,\n      completions: getPrefixMatchesWithDescriptions<RepositoryInfo>(\n          prefix, serverInfo.repositories.values(), repository => repository.uuid + '/',\n          repository => `${repository.alias}: ${repository.description}`)\n    };\n  }\n  let nodeKey = match[1];\n  let repositoryInfo = serverInfo.getNode(nodeKey);\n  return applyCompletionOffset(nodeKey.length + 1, completeInstanceName(repositoryInfo, match[2]));\n}\n\nexport function volumeCompleter(\n    url: string, chunkManager: ChunkManager): Promise<CompletionResult> {\n  const curUrlPattern = /^((?:http|https):\\/\\/[^\\/]+)\\/(.*)$/;\n  let match = url.match(curUrlPattern);\n  if (match === null) {\n    // We don't yet have a full hostname.\n    return Promise.reject<CompletionResult>(null);\n  }\n  let baseUrl = match[1];\n  let path = match[2];\n  return getServerInfo(chunkManager, baseUrl)\n      .then(\n          serverInfo =>\n              applyCompletionOffset(baseUrl.length + 1, completeNodeAndInstance(serverInfo, path)));\n}\n\nexport class DVIDDataSource extends DataSource {\n  get description() {\n    return 'DVID';\n  }\n\n  getVolume(chunkManager: ChunkManager, url: string) {\n    return getVolume(chunkManager, url);\n  }\n\n  volumeCompleter(url: string, chunkManager: ChunkManager) {\n    return volumeCompleter(url, chunkManager);\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {DVIDDataSource} from 'neuroglancer/datasource/dvid/frontend';\nimport {registerProvider} from 'neuroglancer/datasource/default_provider';\n\nregisterProvider('dvid', () => new DVIDDataSource());\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {MultiscaleAnnotationSource} from 'neuroglancer/annotation/frontend_source';\nimport {ChunkManager} from 'neuroglancer/chunk_manager/frontend';\nimport {MeshSource, MultiscaleMeshSource} from 'neuroglancer/mesh/frontend';\nimport {SkeletonSource} from 'neuroglancer/skeleton/frontend';\nimport {VectorGraphicsType} from 'neuroglancer/sliceview/vector_graphics/base';\nimport {MultiscaleVectorGraphicsChunkSource} from 'neuroglancer/sliceview/vector_graphics/frontend';\nimport {VolumeType} from 'neuroglancer/sliceview/volume/base';\nimport {MultiscaleVolumeChunkSource} from 'neuroglancer/sliceview/volume/frontend';\nimport {CancellationToken, uncancelableToken} from 'neuroglancer/util/cancellation';\nimport {applyCompletionOffset, CompletionWithDescription} from 'neuroglancer/util/completion';\nimport {Owned, RefCounted} from 'neuroglancer/util/disposable';\n\nexport type Completion = CompletionWithDescription;\n\nexport class RedirectError extends Error {\n  constructor(public redirect_target: string) {\n    super(`Redirected to: ${redirect_target}`);\n  }\n}\n\nexport interface CompletionResult {\n  offset: number;\n  completions: Completion[];\n}\n\n/**\n * Returns the length of the prefix of path that corresponds to the \"group\", according to the\n * specified separator.\n *\n * If the separator is not specified, gueses whether it is '/' or ':'.\n */\nexport function findSourceGroupBasedOnSeparator(path: string, separator?: string) {\n  if (separator === undefined) {\n    // Try to guess whether '/' or ':' is the separator.\n    if (path.indexOf('/') === -1) {\n      separator = ':';\n    } else {\n      separator = '/';\n    }\n  }\n  let index = path.lastIndexOf(separator);\n  if (index === -1) {\n    return 0;\n  }\n  return index + 1;\n}\n\n\n/**\n * Returns the last \"component\" of path, according to the specified separator.\n * If the separator is not specified, gueses whether it is '/' or ':'.\n */\nexport function suggestLayerNameBasedOnSeparator(path: string, separator?: string) {\n  let groupIndex = findSourceGroupBasedOnSeparator(path, separator);\n  return path.substring(groupIndex);\n}\n\nexport interface GetVolumeOptions {\n  /**\n   * Hint regarding the usage of the volume.\n   */\n  volumeType?: VolumeType;\n\n  dataSourceProvider?: DataSourceProvider;\n}\n\nexport interface GetVectorGraphicsOptions {\n  vectorGraphicsType?: VectorGraphicsType;\n}\n\nexport interface DataSource {\n  getVolume?\n      (chunkManager: ChunkManager, path: string, options: GetVolumeOptions,\n       cancellationToken: CancellationToken):\n          Promise<MultiscaleVolumeChunkSource>|MultiscaleVolumeChunkSource;\n  getVectorGraphicsSource?\n      (chunkManager: ChunkManager, path: string, options: GetVectorGraphicsOptions,\n       cancellationToken: CancellationToken):\n          Promise<MultiscaleVectorGraphicsChunkSource>|MultiscaleVectorGraphicsChunkSource;\n  getMeshSource?(chunkManager: ChunkManager, path: string, cancellationToken: CancellationToken):\n      Promise<MeshSource|MultiscaleMeshSource>|MeshSource|MultiscaleMeshSource;\n  getSkeletonSource?\n      (chunkManager: ChunkManager, path: string, cancellationToken: CancellationToken):\n          Promise<SkeletonSource>|SkeletonSource;\n  volumeCompleter?(value: string, chunkManager: ChunkManager, cancellationToken: CancellationToken):\n      Promise<CompletionResult>;\n\n  getAnnotationSource?\n      (chunkManager: ChunkManager, path: string, cancellationToken: CancellationToken):\n          Promise<MultiscaleAnnotationSource>|MultiscaleAnnotationSource;\n\n  /**\n   * Returns a suggested layer name for the given volume source.\n   */\n  suggestLayerName?(path: string): string;\n\n  /**\n   * Returns the length of the prefix of path that is its 'group'.  This is used for suggesting a\n   * default URL for adding a new layer.\n   */\n  findSourceGroup?(path: string): number;\n}\n\nexport class DataSource extends RefCounted {\n  description?: string;\n}\n\nconst protocolPattern = /^(?:([a-zA-Z][a-zA-Z0-9-+_]*):\\/\\/)?(.*)$/;\n\nexport class DataSourceProvider extends RefCounted {\n  dataSources = new Map<string, Owned<DataSource>>();\n\n  register(name: string, dataSource: Owned<DataSource>) {\n    this.dataSources.set(name, this.registerDisposer(dataSource));\n  }\n\n  getDataSource(url: string): [DataSource, string, string] {\n    let m = url.match(protocolPattern);\n    if (m === null || m[1] === undefined) {\n      throw new Error(`Data source URL must have the form \"<protocol>://<path>\".`);\n    }\n    let dataSource = m[1];\n    let factory = this.dataSources.get(dataSource);\n    if (factory === undefined) {\n      throw new Error(`Unsupported data source: ${JSON.stringify(dataSource)}.`);\n    }\n    return [factory, m[2], dataSource];\n  }\n\n  getVolume(\n      chunkManager: ChunkManager, url: string, options: GetVolumeOptions = {},\n      cancellationToken = uncancelableToken,\n      redirect_log = new Set<string>()): Promise<MultiscaleVolumeChunkSource> {\n    let [dataSource, path] = this.getDataSource(url);\n    if (options === undefined) {\n      options = {};\n    }\n    options.dataSourceProvider = this;\n    redirect_log.add(url);\n    return new Promise<MultiscaleVolumeChunkSource>(resolve => {\n             resolve(dataSource.getVolume!(chunkManager, path, options, cancellationToken));\n           })\n        .catch((err: Error) => {\n          if (err instanceof RedirectError) {\n            const redirect = err.redirect_target;\n            if (redirect_log.has(redirect)) {\n              throw Error('Layer source redirection contains loop.');\n            }\n            if (redirect_log.size >= 10) {\n              throw Error('Too many layer source redirections.');\n            }\n            return this.getVolume!\n                (chunkManager, redirect, options, cancellationToken, redirect_log);\n          } else {\n            throw err;\n          }\n        });\n  }\n\n  getAnnotationSource(\n      chunkManager: ChunkManager, url: string, cancellationToken = uncancelableToken) {\n    let [dataSource, path] = this.getDataSource(url);\n    return new Promise<MultiscaleAnnotationSource>(resolve => {\n      resolve(dataSource.getAnnotationSource!(chunkManager, path, cancellationToken));\n    });\n  }\n\n  getVectorGraphicsSource(\n      chunkManager: ChunkManager, url: string, options: GetVectorGraphicsOptions = {},\n      cancellationToken = uncancelableToken) {\n    let [dataSource, path] = this.getDataSource(url);\n    return new Promise<MultiscaleVectorGraphicsChunkSource>(resolve => {\n      resolve(dataSource.getVectorGraphicsSource!(chunkManager, path, options, cancellationToken));\n    });\n  }\n\n  getMeshSource(chunkManager: ChunkManager, url: string, cancellationToken = uncancelableToken) {\n    let [dataSource, path] = this.getDataSource(url);\n    return new Promise<MeshSource|MultiscaleMeshSource>(resolve => {\n      resolve(dataSource.getMeshSource!(chunkManager, path, cancellationToken));\n    });\n  }\n\n  getSkeletonSource(\n      chunkManager: ChunkManager, url: string, cancellationToken = uncancelableToken) {\n    let [dataSource, path] = this.getDataSource(url);\n    return new Promise<SkeletonSource>(resolve => {\n      resolve(dataSource.getSkeletonSource!(chunkManager, path, cancellationToken));\n    });\n  }\n\n  volumeCompleter(url: string, chunkManager: ChunkManager, cancellationToken = uncancelableToken):\n      Promise<CompletionResult> {\n    // Check if url matches a protocol.  Note that protocolPattern always matches.\n    let protocolMatch = url.match(protocolPattern)!;\n    let protocol = protocolMatch[1];\n    if (protocol === undefined) {\n      // Return protocol completions.\n      let completions: Completion[] = [];\n      for (let [name, factory] of this.dataSources) {\n        name = name + '://';\n        if (name.startsWith(url)) {\n          completions.push({value: name, description: factory.description});\n        }\n      }\n      return Promise.resolve({offset: 0, completions});\n    } else {\n      const factory = this.dataSources.get(protocol);\n      if (factory !== undefined) {\n        if (factory.volumeCompleter !== undefined) {\n          return factory.volumeCompleter!(protocolMatch[2], chunkManager, cancellationToken)\n              .then(completions => applyCompletionOffset(protocol.length + 3, completions));\n        }\n      }\n      return Promise.reject<CompletionResult>(null);\n    }\n  }\n\n  suggestLayerName(url: string) {\n    let [dataSource, path] = this.getDataSource(url);\n    let suggestor = dataSource.suggestLayerName;\n    if (suggestor !== undefined) {\n      return suggestor(path);\n    }\n    return suggestLayerNameBasedOnSeparator(path);\n  }\n\n  findSourceGroup(url: string) {\n    let [dataSource, path, dataSourceName] = this.getDataSource(url);\n    let helper = dataSource.findSourceGroup || findSourceGroupBasedOnSeparator;\n    return helper(path) + dataSourceName.length + 3;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport enum VolumeChunkEncoding {\n  RAW,\n  GZIP,\n}\n\nexport class VolumeChunkSourceParameters {\n  url: string;\n  encoding: VolumeChunkEncoding;\n\n  static RPC_ID = 'n5/VolumeChunkSource';\n}\n","/**\n * @license\n * Copyright 2019 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {AnnotationSource, makeDataBoundsBoundingBox} from 'neuroglancer/annotation';\nimport {ChunkManager, WithParameters} from 'neuroglancer/chunk_manager/frontend';\nimport {DataSource} from 'neuroglancer/datasource';\nimport {VolumeChunkEncoding, VolumeChunkSourceParameters} from 'neuroglancer/datasource/n5/base';\nimport {DataType, VolumeChunkSpecification, VolumeSourceOptions, VolumeType} from 'neuroglancer/sliceview/volume/base';\nimport {MultiscaleVolumeChunkSource as GenericMultiscaleVolumeChunkSource, VolumeChunkSource} from 'neuroglancer/sliceview/volume/frontend';\nimport {mat4, vec3} from 'neuroglancer/util/geom';\nimport {fetchOk, HttpError, parseSpecialUrl} from 'neuroglancer/util/http_request';\nimport {parseArray, parseFixedLengthArray, verifyEnumString, verifyFinitePositiveFloat, verifyObject, verifyObjectProperty, verifyPositiveInt} from 'neuroglancer/util/json';\n\nclass N5VolumeChunkSource extends\n(WithParameters(VolumeChunkSource, VolumeChunkSourceParameters)) {}\n\nexport class MultiscaleVolumeChunkSource implements GenericMultiscaleVolumeChunkSource {\n  dataType: DataType;\n  volumeType: VolumeType;\n\n  get numChannels() {\n    return 1;\n  }\n\n  getMeshSource() {\n    return null;\n  }\n\n  baseScaleIndex: number;\n\n  constructor(\n      public chunkManager: ChunkManager, public url: string,\n      public topLevelMetadata: TopLevelMetadata, public scales: (ScaleMetadata|undefined)[]) {\n    let dataType: DataType|undefined;\n    let baseScaleIndex: number|undefined;\n    scales.forEach((scale, i) => {\n      if (scale === undefined) return;\n      if (baseScaleIndex === undefined) {\n        baseScaleIndex = i;\n      }\n      if (dataType !== undefined && scale.dataType !== dataType) {\n        throw new Error(`Scale s${i} has data type ${DataType[scale.dataType]} but expected ${\n            DataType[dataType]}.`);\n      }\n      dataType = scale.dataType;\n    });\n    if (dataType === undefined) {\n      throw new Error(`At least one scale must be specified.`);\n    }\n    this.dataType = dataType;\n    this.volumeType = VolumeType.IMAGE;\n    this.baseScaleIndex = baseScaleIndex!;\n  }\n\n  getSources(volumeSourceOptions: VolumeSourceOptions) {\n    const {topLevelMetadata} = this;\n    const sources: VolumeChunkSource[][] = [];\n    this.scales.forEach((scale, i) => {\n      if (scale === undefined) return;\n      sources.push(\n          VolumeChunkSpecification\n              .getDefaults({\n                voxelSize: vec3.multiply(\n                    vec3.create(), topLevelMetadata.pixelResolution, topLevelMetadata.scales[i]),\n                dataType: scale.dataType,\n                numChannels: 1,\n                upperVoxelBound: scale.size,\n                volumeType: this.volumeType,\n                chunkDataSizes: [scale.chunkSize],\n                volumeSourceOptions,\n              })\n              .map(spec => this.chunkManager.getChunkSource(N5VolumeChunkSource, {\n                spec,\n                parameters: {'url': `${this.url}/s${i}`, 'encoding': scale.encoding}\n              })));\n    });\n    return sources;\n  }\n\n  getStaticAnnotations() {\n    const {topLevelMetadata, baseScaleIndex} = this;\n    const annotationSet = new AnnotationSource(mat4.fromScaling(\n        mat4.create(),\n        vec3.multiply(\n            vec3.create(), topLevelMetadata.pixelResolution,\n            topLevelMetadata.scales[baseScaleIndex])));\n    annotationSet.readonly = true;\n    annotationSet.add(makeDataBoundsBoundingBox(vec3.create(), this.scales[baseScaleIndex]!.size));\n    return annotationSet;\n  }\n}\n\nconst pixelResolutionUnits = new Map<string, number>([\n  ['mm', 1e6],\n  ['m', 1e9],\n  ['um', 1000],\n  ['nm', 1],\n]);\n\nclass TopLevelMetadata {\n  pixelResolution: vec3;\n  scales: vec3[];\n  constructor(obj: any) {\n    verifyObject(obj);\n    verifyObjectProperty(obj, 'pixelResolution', resObj => {\n      verifyObject(resObj);\n      const unitScale = verifyObjectProperty(resObj, 'unit', x => {\n        const s = pixelResolutionUnits.get(x);\n        if (s === undefined) {\n          throw new Error(`Unsupported unit: ${JSON.stringify(x)}.`);\n        }\n        return s;\n      });\n      const dimensions = verifyObjectProperty(\n          resObj, 'dimensions',\n          x => parseFixedLengthArray(vec3.create(), x, verifyFinitePositiveFloat));\n      this.pixelResolution = vec3.scale(dimensions, dimensions, unitScale);\n    });\n    this.scales = verifyObjectProperty(\n        obj, 'scales',\n        scalesObj => parseArray(\n            scalesObj,\n            scaleObj => parseFixedLengthArray(vec3.create(), scaleObj, verifyFinitePositiveFloat)));\n  }\n}\n\nclass ScaleMetadata {\n  dataType: DataType;\n  encoding: VolumeChunkEncoding;\n  size: vec3;\n  chunkSize: vec3;\n\n  constructor(obj: any) {\n    verifyObject(obj);\n    this.dataType = verifyObjectProperty(obj, 'dataType', x => verifyEnumString(x, DataType));\n    this.size = verifyObjectProperty(\n        obj, 'dimensions', x => parseFixedLengthArray(vec3.create(), x, verifyPositiveInt));\n    this.chunkSize = verifyObjectProperty(\n      obj, 'blockSize', x => parseFixedLengthArray(vec3.create(), x, verifyPositiveInt));\n\n    let encoding: VolumeChunkEncoding|undefined;\n    verifyObjectProperty(obj, 'compression', compression => {\n      encoding =\n          verifyObjectProperty(compression, 'type', x => verifyEnumString(x, VolumeChunkEncoding));\n    });\n    if (encoding === undefined) {\n      encoding = verifyObjectProperty(\n          obj, 'compressionType', x => verifyEnumString(x, VolumeChunkEncoding));\n    }\n    this.encoding = encoding;\n  }\n}\n\nfunction getTopLevelMetadata(chunkManager: ChunkManager, url: string): Promise<TopLevelMetadata> {\n  return chunkManager.memoize.getUncounted(\n      {'type': 'n5:topLevelMetadata', url},\n      () => fetchOk(url)\n                .then(response => response.json())\n                .then(response => new TopLevelMetadata(response)));\n}\n\nfunction getScaleMetadata(chunkManager: ChunkManager, url: string): Promise<ScaleMetadata> {\n  return chunkManager.memoize.getUncounted(\n      {'type': 'n5:scaleMetadata', url},\n      () => fetchOk(url)\n                .then(response => response.json())\n                .then(response => new ScaleMetadata(response)));\n}\n\nfunction getAllScales(chunkManager: ChunkManager, url: string, topLevelMetadata: TopLevelMetadata):\n    Promise<(ScaleMetadata | undefined)[]> {\n  return Promise.all(topLevelMetadata.scales.map((_scale, i) => {\n    return getScaleMetadata(chunkManager, `${url}/s${i}/attributes.json`).catch(e => {\n      if (e instanceof HttpError && e.status === 404) {\n        return undefined;\n      }\n      throw e;\n    });\n  }));\n}\n\nexport class N5DataSource extends DataSource {\n  get description() {\n    return 'N5 data source';\n  }\n  getVolume(chunkManager: ChunkManager, url: string) {\n    url = parseSpecialUrl(url);\n    const m = url.match(/^(.*)\\/(c[0-9]+)$/);\n    let topLevelMetadataUrl: string;\n    if (m !== null) {\n      topLevelMetadataUrl = `${m[1]}/attributes.json`;\n    } else {\n      topLevelMetadataUrl = `${url}/attributes.json`;\n    }\n    return chunkManager.memoize.getUncounted(\n        {'type': 'n5:MultiscaleVolumeChunkSource', url},\n        () =>\n            getTopLevelMetadata(chunkManager, topLevelMetadataUrl)\n                .then(\n                    topLevelMetadata => getAllScales(chunkManager, url, topLevelMetadata)\n                                            .then(\n                                                scales => new MultiscaleVolumeChunkSource(\n                                                    chunkManager, url, topLevelMetadata, scales))));\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {registerProvider} from 'neuroglancer/datasource/default_provider';\nimport {N5DataSource} from 'neuroglancer/datasource/n5/frontend';\n\nregisterProvider('n5', () => new N5DataSource());\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {DataType, VolumeType} from 'neuroglancer/sliceview/volume/base';\nimport {mat4, quat, vec3} from 'neuroglancer/util/geom';\n\nexport const GET_NIFTI_VOLUME_INFO_RPC_ID = 'nifti/getNiftiVolumeInfo';\n\nexport interface NiftiVolumeInfo {\n  numChannels: number;\n  dataType: DataType;\n  volumeType: VolumeType;\n  voxelSize: vec3;\n  affine: mat4;\n  description: string;\n  volumeSize: vec3;\n  qoffset: vec3;\n  quatern: quat;\n  qfac: number;\n  qform_code: number;\n  sform_code: number;\n}\n\nexport enum NiftiDataType {\n  NONE = 0,\n  BINARY = 1,\n  UINT8 = 2,\n  INT16 = 4,\n  INT32 = 8,\n  FLOAT32 = 16,\n  COMPLEX64 = 32,\n  FLOAT64 = 64,\n  RGB24 = 128,\n  INT8 = 256,\n  UINT16 = 512,\n  UINT32 = 768,\n  INT64 = 1024,\n  UINT64 = 1280,\n  FLOAT128 = 1536,\n  COMPLEX128 = 1792,\n  COMPLEX256 = 2048,\n}\n\nexport class VolumeSourceParameters {\n  url: string;\n\n  static RPC_ID = 'nifti/VolumeChunkSource';\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Support for displaying single NIfTI (https://www.nitrc.org/projects/nifti) files as\n * volumes.\n */\n\nimport {ChunkManager, WithParameters} from 'neuroglancer/chunk_manager/frontend';\nimport {DataSource} from 'neuroglancer/datasource';\nimport {GET_NIFTI_VOLUME_INFO_RPC_ID, NiftiVolumeInfo, VolumeSourceParameters} from 'neuroglancer/datasource/nifti/base';\nimport {VolumeChunkSpecification, VolumeSourceOptions} from 'neuroglancer/sliceview/volume/base';\nimport {VolumeChunkSource, MultiscaleVolumeChunkSource as GenericMultiscaleVolumeChunkSource} from 'neuroglancer/sliceview/volume/frontend';\nimport {CancellationToken, uncancelableToken} from 'neuroglancer/util/cancellation';\nimport {kOneVec, mat4, translationRotationScaleZReflectionToMat4} from 'neuroglancer/util/geom';\n\nclass NiftiVolumeChunkSource extends\n(WithParameters(VolumeChunkSource, VolumeSourceParameters)) {}\n\nexport class MultiscaleVolumeChunkSource implements GenericMultiscaleVolumeChunkSource {\n  constructor(public chunkManager: ChunkManager, public url: string, public info: NiftiVolumeInfo) {\n  }\n  get numChannels() {\n    return this.info.numChannels;\n  }\n  get dataType() {\n    return this.info.dataType;\n  }\n  get volumeType() {\n    return this.info.volumeType;\n  }\n  getSources(volumeSourceOptions: VolumeSourceOptions) {\n    let {info} = this;\n    const spec = VolumeChunkSpecification.withDefaultCompression({\n      volumeType: info.volumeType,\n      chunkDataSize: info.volumeSize,\n      dataType: info.dataType,\n      voxelSize: info.voxelSize,\n      numChannels: info.numChannels,\n      upperVoxelBound: info.volumeSize,\n      transform: translationRotationScaleZReflectionToMat4(\n          mat4.create(), info.qoffset, info.quatern, kOneVec, info.qfac),\n      volumeSourceOptions,\n    });\n    return [[this.chunkManager.getChunkSource(NiftiVolumeChunkSource, {spec, parameters: {url: this.url}})]];\n  }\n\n  getMeshSource(): null {\n    return null;\n  }\n}\n\nfunction getNiftiVolumeInfo(\n    chunkManager: ChunkManager, url: string, cancellationToken: CancellationToken) {\n  return chunkManager.rpc!.promiseInvoke<NiftiVolumeInfo>(\n      GET_NIFTI_VOLUME_INFO_RPC_ID, {'chunkManager': chunkManager.addCounterpartRef(), 'url': url},\n      cancellationToken);\n}\n\nexport function getVolume(chunkManager: ChunkManager, url: string) {\n  return chunkManager.memoize.getUncounted(\n      {type: 'nifti/getVolume', url},\n      () => getNiftiVolumeInfo(chunkManager, url, uncancelableToken)\n                .then(info => new MultiscaleVolumeChunkSource(chunkManager, url, info)));\n}\n\nexport class NiftiDataSource extends DataSource {\n  get description() { return 'Single NIfTI file'; }\n  getVolume(chunkManager: ChunkManager, url: string) {\n    return getVolume(chunkManager, url);\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {NiftiDataSource} from 'neuroglancer/datasource/nifti/frontend';\nimport {registerProvider} from 'neuroglancer/datasource/default_provider';\n\nregisterProvider('nifti', () => new NiftiDataSource());\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {VertexAttributeInfo} from 'neuroglancer/skeleton/base';\nimport {mat4} from 'neuroglancer/util/geom';\n\nexport enum VolumeChunkEncoding {\n  RAW,\n  JPEG,\n  COMPRESSED_SEGMENTATION\n}\n\nexport class VolumeChunkSourceParameters {\n  url: string;\n  encoding: VolumeChunkEncoding;\n  sharding: ShardingParameters|undefined;\n\n  static RPC_ID = 'precomputed/VolumeChunkSource';\n}\n\n\nexport class MeshSourceParameters {\n  url: string;\n  lod: number;\n\n  static RPC_ID = 'precomputed/MeshSource';\n}\n\nexport enum DataEncoding {\n  RAW = 0,\n  GZIP = 1,\n}\n\nexport enum ShardingHashFunction {\n  IDENTITY = 0,\n  MURMURHASH3_X86_128 = 1,\n}\n\nexport interface ShardingParameters {\n  hash: ShardingHashFunction;\n  preshiftBits: number;\n  minishardBits: number;\n  shardBits: number;\n  minishardIndexEncoding: DataEncoding;\n  dataEncoding: DataEncoding;\n}\n\nexport class MultiscaleMeshMetadata {\n  transform: mat4;\n  lodScaleMultiplier: number;\n  vertexQuantizationBits: number;\n  sharding: ShardingParameters|undefined;\n}\n\nexport class MultiscaleMeshSourceParameters {\n  url: string;\n  metadata: MultiscaleMeshMetadata;\n\n  static RPC_ID = 'precomputed/MultiscaleMeshSource';\n}\n\nexport interface SkeletonMetadata {\n  transform: mat4;\n  vertexAttributes: Map<string, VertexAttributeInfo>;\n  sharding: ShardingParameters|undefined;\n}\n\nexport class SkeletonSourceParameters {\n  url: string;\n  metadata: SkeletonMetadata;\n\n  static RPC_ID = 'precomputed/SkeletonSource';\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {AnnotationSource, makeDataBoundsBoundingBox} from 'neuroglancer/annotation';\nimport {ChunkManager, WithParameters} from 'neuroglancer/chunk_manager/frontend';\nimport {DataSource, RedirectError} from 'neuroglancer/datasource';\nimport {DataEncoding, MeshSourceParameters, MultiscaleMeshMetadata, MultiscaleMeshSourceParameters, ShardingHashFunction, ShardingParameters, SkeletonMetadata, SkeletonSourceParameters, VolumeChunkEncoding, VolumeChunkSourceParameters} from 'neuroglancer/datasource/precomputed/base';\nimport {VertexPositionFormat} from 'neuroglancer/mesh/base';\nimport {MeshSource, MultiscaleMeshSource} from 'neuroglancer/mesh/frontend';\nimport {VertexAttributeInfo} from 'neuroglancer/skeleton/base';\nimport {SkeletonSource} from 'neuroglancer/skeleton/frontend';\nimport {DataType, VolumeChunkSpecification, VolumeSourceOptions, VolumeType} from 'neuroglancer/sliceview/volume/base';\nimport {MultiscaleVolumeChunkSource as GenericMultiscaleVolumeChunkSource, VolumeChunkSource} from 'neuroglancer/sliceview/volume/frontend';\nimport {mat4, vec3} from 'neuroglancer/util/geom';\nimport {fetchOk, parseSpecialUrl} from 'neuroglancer/util/http_request';\nimport {parseArray, parseFixedLengthArray, parseIntVec, verifyEnumString, verifyFiniteFloat, verifyFinitePositiveFloat, verifyInt, verifyObject, verifyObjectProperty, verifyOptionalString, verifyPositiveInt, verifyString} from 'neuroglancer/util/json';\n\nclass PrecomputedVolumeChunkSource extends\n(WithParameters(VolumeChunkSource, VolumeChunkSourceParameters)) {}\n\nclass PrecomputedMeshSource extends\n(WithParameters(MeshSource, MeshSourceParameters)) {}\n\nclass PrecomputedMultiscaleMeshSource extends\n(WithParameters(MultiscaleMeshSource, MultiscaleMeshSourceParameters)) {}\n\nexport class PrecomputedSkeletonSource extends\n(WithParameters(SkeletonSource, SkeletonSourceParameters)) {\n  get skeletonVertexCoordinatesInVoxels() {\n    return false;\n  }\n  get vertexAttributes() {\n    return this.parameters.metadata.vertexAttributes;\n  }\n}\n\nfunction resolvePath(a: string, b: string) {\n  const outputParts = a.split('/');\n  for (const part of b.split('/')) {\n    if (part === '..') {\n      if (outputParts.length !== 0) {\n        outputParts.length = outputParts.length - 1;\n        continue;\n      }\n    }\n    outputParts.push(part);\n  }\n  return outputParts.join('/');\n}\n\nclass ScaleInfo {\n  key: string;\n  encoding: VolumeChunkEncoding;\n  resolution: vec3;\n  voxelOffset: vec3;\n  size: vec3;\n  chunkSizes: vec3[];\n  compressedSegmentationBlockSize: vec3|undefined;\n  sharding: ShardingParameters|undefined;\n  constructor(obj: any) {\n    verifyObject(obj);\n    this.resolution = verifyObjectProperty(\n        obj, 'resolution', x => parseFixedLengthArray(vec3.create(), x, verifyFinitePositiveFloat));\n    this.voxelOffset = verifyObjectProperty(\n        obj, 'voxel_offset', x => x === undefined ? vec3.create() : parseIntVec(vec3.create(), x));\n    this.size = verifyObjectProperty(\n        obj, 'size', x => parseFixedLengthArray(vec3.create(), x, verifyPositiveInt));\n    this.chunkSizes = verifyObjectProperty(\n        obj, 'chunk_sizes',\n        x => parseArray(x, y => parseFixedLengthArray(vec3.create(), y, verifyPositiveInt)));\n    if (this.chunkSizes.length === 0) {\n      throw new Error('No chunk sizes specified.');\n    }\n    this.sharding = verifyObjectProperty(obj, 'sharding', parseShardingParameters);\n    if (this.sharding !== undefined && this.chunkSizes.length !== 1) {\n      throw new Error('Sharding requires a single chunk size per scale');\n    }\n    let encoding = this.encoding =\n        verifyObjectProperty(obj, 'encoding', x => verifyEnumString(x, VolumeChunkEncoding));\n    if (encoding === VolumeChunkEncoding.COMPRESSED_SEGMENTATION) {\n      this.compressedSegmentationBlockSize = verifyObjectProperty(\n          obj, 'compressed_segmentation_block_size',\n          x => parseFixedLengthArray(vec3.create(), x, verifyPositiveInt));\n    }\n    this.key = verifyObjectProperty(obj, 'key', verifyString);\n  }\n}\n\nexport class MultiscaleVolumeChunkSource implements GenericMultiscaleVolumeChunkSource {\n  dataType: DataType;\n  numChannels: number;\n  volumeType: VolumeType;\n  mesh: string|undefined;\n  skeletons: string|undefined;\n  scales: ScaleInfo[];\n\n  getMeshSource() {\n    const {mesh} = this;\n    if (mesh !== undefined) {\n      return getMeshSource(this.chunkManager, resolvePath(this.url, mesh));\n    }\n    const {skeletons} = this;\n    if (skeletons !== undefined) {\n      return getSkeletonSource(this.chunkManager, resolvePath(this.url, skeletons));\n    }\n    return null;\n  }\n\n  constructor(public chunkManager: ChunkManager, public url: string, obj: any) {\n    verifyObject(obj);\n    const redirect = verifyObjectProperty(obj, 'redirect', verifyOptionalString);\n    if (redirect !== undefined) {\n      throw new RedirectError(redirect);\n    }\n    const t = verifyObjectProperty(obj, '@type', verifyOptionalString);\n    if (t !== undefined && t !== 'neuroglancer_multiscale_volume') {\n      throw new Error(`Invalid type: ${JSON.stringify(t)}`);\n    }\n    this.dataType = verifyObjectProperty(obj, 'data_type', x => verifyEnumString(x, DataType));\n    this.numChannels = verifyObjectProperty(obj, 'num_channels', verifyPositiveInt);\n    this.volumeType = verifyObjectProperty(obj, 'type', x => verifyEnumString(x, VolumeType));\n    this.mesh = verifyObjectProperty(obj, 'mesh', verifyOptionalString);\n    this.skeletons = verifyObjectProperty(obj, 'skeletons', verifyOptionalString);\n    this.scales = verifyObjectProperty(obj, 'scales', x => parseArray(x, y => new ScaleInfo(y)));\n  }\n\n  getSources(volumeSourceOptions: VolumeSourceOptions) {\n    return this.scales.map(scaleInfo => {\n      return VolumeChunkSpecification\n          .getDefaults({\n            voxelSize: scaleInfo.resolution,\n            dataType: this.dataType,\n            numChannels: this.numChannels,\n            transform: mat4.fromTranslation(\n                mat4.create(),\n                vec3.multiply(vec3.create(), scaleInfo.resolution, scaleInfo.voxelOffset)),\n            upperVoxelBound: scaleInfo.size,\n            volumeType: this.volumeType,\n            chunkDataSizes: scaleInfo.chunkSizes,\n            baseVoxelOffset: scaleInfo.voxelOffset,\n            compressedSegmentationBlockSize: scaleInfo.compressedSegmentationBlockSize,\n            volumeSourceOptions,\n          })\n          .map(spec => this.chunkManager.getChunkSource(PrecomputedVolumeChunkSource, {\n            spec,\n            parameters: {\n              url: resolvePath(this.url, scaleInfo.key),\n              encoding: scaleInfo.encoding,\n              sharding: scaleInfo.sharding,\n            }\n          }));\n    });\n  }\n\n  getStaticAnnotations() {\n    const baseScale = this.scales[0];\n    const annotationSet =\n        new AnnotationSource(mat4.fromScaling(mat4.create(), baseScale.resolution));\n    annotationSet.readonly = true;\n    annotationSet.add(makeDataBoundsBoundingBox(\n        baseScale.voxelOffset, vec3.add(vec3.create(), baseScale.voxelOffset, baseScale.size)));\n    return annotationSet;\n  }\n}\n\nexport function getShardedMeshSource(chunkManager: ChunkManager, parameters: MeshSourceParameters) {\n  return chunkManager.getChunkSource(PrecomputedMeshSource, {parameters});\n}\n\nfunction parseTransform(data: any): mat4 {\n  return verifyObjectProperty(data, 'transform', value => {\n    const transform = mat4.create();\n    if (value !== undefined) {\n      parseFixedLengthArray(transform.subarray(0, 12), value, verifyFiniteFloat);\n    }\n    mat4.transpose(transform, transform);\n    return transform;\n  });\n}\n\nfunction parseMeshMetadata(data: any): MultiscaleMeshMetadata|undefined {\n  verifyObject(data);\n  const t = verifyObjectProperty(data, '@type', verifyString);\n  if (t === 'neuroglancer_legacy_mesh') {\n      return undefined;\n  } else if (t !== 'neuroglancer_multilod_draco') {\n      throw new Error(`Unsupported mesh type: ${JSON.stringify(t)}`);\n  }\n  const lodScaleMultiplier =\n      verifyObjectProperty(data, 'lod_scale_multiplier', verifyFinitePositiveFloat);\n  const vertexQuantizationBits =\n      verifyObjectProperty(data, 'vertex_quantization_bits', verifyPositiveInt);\n  const transform = parseTransform(data);\n  const sharding = verifyObjectProperty(data, 'sharding', parseShardingParameters);\n  return {lodScaleMultiplier, transform, sharding, vertexQuantizationBits};\n}\n\nfunction getMeshMetadata(\n    chunkManager: ChunkManager, url: string): Promise<MultiscaleMeshMetadata|undefined> {\n  return chunkManager.memoize.getUncounted(\n      {'type': 'precomputed:MeshSource', url},\n      () => fetchOk(`${url}/info`)\n                .then(\n                    response => {\n                      return response.json().then(value => parseMeshMetadata(value));\n                    },\n                    // If we fail to fetch the info file, assume it is the legacy\n                    // single-resolution mesh format.\n                    () => undefined));\n}\n\nfunction parseShardingEncoding(y: any): DataEncoding {\n  if (y === undefined) return DataEncoding.RAW;\n  return verifyEnumString(y, DataEncoding);\n}\n\nfunction parseShardingParameters(shardingData: any): ShardingParameters|undefined {\n  if (shardingData === undefined) return undefined;\n  verifyObject(shardingData);\n  const t = verifyObjectProperty(shardingData, '@type', verifyString);\n  if (t !== 'neuroglancer_uint64_sharded_v1') {\n    throw new Error(`Unsupported sharding format: ${JSON.stringify(t)}`);\n  }\n  const hash =\n      verifyObjectProperty(shardingData, 'hash', y => verifyEnumString(y, ShardingHashFunction));\n  const preshiftBits = verifyObjectProperty(shardingData, 'preshift_bits', verifyInt);\n  const shardBits = verifyObjectProperty(shardingData, 'shard_bits', verifyInt);\n  const minishardBits = verifyObjectProperty(shardingData, 'minishard_bits', verifyInt);\n  const minishardIndexEncoding =\n      verifyObjectProperty(shardingData, 'minishard_index_encoding', parseShardingEncoding);\n  const dataEncoding = verifyObjectProperty(shardingData, 'data_encoding', parseShardingEncoding);\n  return {hash, preshiftBits, shardBits, minishardBits, minishardIndexEncoding, dataEncoding};\n}\n\nfunction parseSkeletonMetadata(data: any): SkeletonMetadata {\n  verifyObject(data);\n  const t = verifyObjectProperty(data, '@type', verifyString);\n  if (t !== 'neuroglancer_skeletons') {\n    throw new Error(`Unsupported skeleton type: ${JSON.stringify(t)}`);\n  }\n  const transform = parseTransform(data);\n  const vertexAttributes = new Map<string, VertexAttributeInfo>();\n  verifyObjectProperty(data, 'vertex_attributes', attributes => {\n    if (attributes === undefined) return;\n    parseArray(attributes, attributeData => {\n      verifyObject(attributeData);\n      const id = verifyObjectProperty(attributeData, 'id', verifyString);\n      if (id === '') throw new Error('vertex attribute id must not be empty');\n      if (vertexAttributes.has(id)) {\n        throw new Error(`duplicate vertex attribute id ${JSON.stringify(id)}`);\n      }\n      const dataType =\n          verifyObjectProperty(attributeData, 'data_type', y => verifyEnumString(y, DataType));\n      const numComponents =\n          verifyObjectProperty(attributeData, 'num_components', verifyPositiveInt);\n      vertexAttributes.set(id, {dataType, numComponents});\n    });\n  });\n  const sharding = verifyObjectProperty(data, 'sharding', parseShardingParameters);\n  return {transform, vertexAttributes, sharding};\n}\n\nfunction getSkeletonMetadata(\n    chunkManager: ChunkManager, url: string): Promise<SkeletonMetadata> {\n  return chunkManager.memoize.getUncounted(\n      {'type': 'precomputed:SkeletonSource', url}, async () => {\n        const response = await fetchOk(`${url}/info`);\n        const value = await response.json();\n        return parseSkeletonMetadata(value);\n      });\n}\n\nasync function getMeshSource(chunkManager: ChunkManager, url: string) {\n  const metadata = await getMeshMetadata(chunkManager, url);\n  if (metadata === undefined) {\n    return getShardedMeshSource(chunkManager, {url, lod: 0});\n  }\n  let vertexPositionFormat: VertexPositionFormat;\n  const {vertexQuantizationBits} = metadata;\n  if (vertexQuantizationBits === 10) {\n    vertexPositionFormat = VertexPositionFormat.uint10;\n  } else if (vertexQuantizationBits === 16) {\n    vertexPositionFormat = VertexPositionFormat.uint16;\n  } else {\n    throw new Error(`Invalid vertex quantization bits: ${vertexQuantizationBits}`);\n  }\n  return chunkManager.getChunkSource(PrecomputedMultiscaleMeshSource, {\n    parameters: {url, metadata},\n    format: {\n      fragmentRelativeVertices: true,\n      vertexPositionFormat,\n      transform: metadata.transform,\n    }\n  });\n}\n\nexport async function getSkeletonSource(chunkManager: ChunkManager, url: string) {\n  const metadata = await getSkeletonMetadata(chunkManager, url);\n  return chunkManager.getChunkSource(PrecomputedSkeletonSource, {\n    parameters: {\n      url,\n      metadata,\n    },\n    transform: metadata.transform,\n  });\n}\n\nexport function getVolume(chunkManager: ChunkManager, url: string) {\n  url = parseSpecialUrl(url);\n  return chunkManager.memoize.getUncounted(\n      {'type': 'precomputed:MultiscaleVolumeChunkSource', url},\n      () => fetchOk(`${url}/info`)\n                .then(response => response.json())\n                .then(response => new MultiscaleVolumeChunkSource(chunkManager, url, response)));\n}\n\nexport class PrecomputedDataSource extends DataSource {\n  get description() {\n    return 'Precomputed file-backed data source';\n  }\n  getVolume(chunkManager: ChunkManager, url: string) {\n    return getVolume(chunkManager, url);\n  }\n  getMeshSource(chunkManager: ChunkManager, url: string) {\n    return getMeshSource(chunkManager, parseSpecialUrl(url));\n  }\n  getSkeletonSource(chunkManager: ChunkManager, url: string) {\n    return getSkeletonSource(chunkManager, parseSpecialUrl(url));\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {PrecomputedDataSource} from 'neuroglancer/datasource/precomputed/frontend';\nimport {registerProvider} from 'neuroglancer/datasource/default_provider';\n\nregisterProvider('precomputed', () => new PrecomputedDataSource());\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport class RenderBaseSourceParameters {\n  baseUrl: string;\n  owner: string;\n  project: string;\n  stack: string;\n  channel: string|undefined;\n}\n\nexport class RenderSourceParameters extends RenderBaseSourceParameters {\n  minIntensity: number|undefined;\n  maxIntensity: number|undefined;\n  maxTileSpecsToRender: number|undefined;\n  filter: boolean|undefined;\n}\n\nexport class TileChunkSourceParameters extends RenderSourceParameters {\n  dims: string;\n  level: number;\n  encoding: string;\n\n  static RPC_ID = 'render/TileChunkSource';\n}\n\nexport class PointMatchChunkSourceParameters extends RenderSourceParameters {\n  matchCollection: string;\n  zoffset: number;\n\n  static RPC_ID = 'render/PointMatchSource';\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file\n * Support for Render (https://github.com/saalfeldlab/render) servers.\n */\n\nimport {ChunkManager, WithParameters} from 'neuroglancer/chunk_manager/frontend';\nimport {CompletionResult, DataSource} from 'neuroglancer/datasource';\nimport {PointMatchChunkSourceParameters, TileChunkSourceParameters} from 'neuroglancer/datasource/render/base';\nimport {VectorGraphicsChunkSpecification, VectorGraphicsSourceOptions} from 'neuroglancer/sliceview/vector_graphics/base';\nimport {MultiscaleVectorGraphicsChunkSource as GenericMultiscaleVectorGraphicsChunkSource, VectorGraphicsChunkSource} from 'neuroglancer/sliceview/vector_graphics/frontend';\nimport {DataType, VolumeChunkSpecification, VolumeSourceOptions, VolumeType} from 'neuroglancer/sliceview/volume/base';\nimport {MultiscaleVolumeChunkSource as GenericMultiscaleVolumeChunkSource, VolumeChunkSource} from 'neuroglancer/sliceview/volume/frontend';\nimport {applyCompletionOffset, getPrefixMatchesWithDescriptions} from 'neuroglancer/util/completion';\nimport {vec3} from 'neuroglancer/util/geom';\nimport {fetchOk} from 'neuroglancer/util/http_request';\nimport {parseArray, parseQueryStringParameters, verifyFloat, verifyObject, verifyObjectProperty, verifyOptionalBoolean, verifyOptionalInt, verifyOptionalString, verifyString} from 'neuroglancer/util/json';\n\nconst VALID_ENCODINGS = new Set<string>(['jpg', 'raw16']);\n\nconst TileChunkSourceBase = WithParameters(VolumeChunkSource, TileChunkSourceParameters);\nclass TileChunkSource extends TileChunkSourceBase {}\nconst PointMatchSourceBase =\n    WithParameters(VectorGraphicsChunkSource, PointMatchChunkSourceParameters);\nclass PointMatchSource extends PointMatchSourceBase {}\n\nconst VALID_STACK_STATES = new Set<string>(['COMPLETE', 'READ_ONLY']);\nconst PARTIAL_STACK_STATES = new Set<string>(['LOADING']);\n\ninterface OwnerInfo {\n  owner: string;\n  projects: Map<string, ProjectInfo>;\n}\n\ninterface ProjectInfo {\n  stacks: Map<string, StackInfo>;\n}\n\ninterface StackInfo {\n  lowerVoxelBound: vec3;\n  upperVoxelBound: vec3;\n  voxelResolution: vec3; /* in nm */\n  project: string;\n  channels: string[];\n}\n\nfunction parseOwnerInfo(obj: any): OwnerInfo {\n  let stackObjs = parseArray(obj, verifyObject);\n\n  if (stackObjs.length < 1) {\n    throw new Error(`No stacks found for owner object.`);\n  }\n\n  let projects = new Map<string, ProjectInfo>();\n  // Get the owner from the first stack\n  let owner = verifyObjectProperty(stackObjs[0], 'stackId', parseStackOwner);\n\n  for (let stackObj of stackObjs) {\n    let stackName = verifyObjectProperty(stackObj, 'stackId', parseStackName);\n    let stackInfo = parseStackInfo(stackObj);\n\n    if (stackInfo !== undefined) {\n      let projectName = stackInfo.project;\n      let projectInfo = projects.get(projectName);\n\n      if (projectInfo === undefined) {\n        let stacks = new Map<string, StackInfo>();\n        projects.set(projectName, {stacks});\n        projectInfo = projects.get(projectName);\n      }\n\n      projectInfo!.stacks.set(stackName, stackInfo);\n    }\n  }\n\n  return {owner, projects};\n}\n\nfunction parseStackName(stackIdObj: any): string {\n  verifyObject(stackIdObj);\n  return verifyObjectProperty(stackIdObj, 'stack', verifyString);\n}\n\nfunction parseStackOwner(stackIdObj: any): string {\n  verifyObject(stackIdObj);\n  return verifyObjectProperty(stackIdObj, 'owner', verifyString);\n}\n\nfunction parseStackInfo(obj: any): StackInfo|undefined {\n  verifyObject(obj);\n\n  let state = verifyObjectProperty(obj, 'state', verifyString);\n\n  let channels: string[] = [];\n  let lowerVoxelBound: vec3 = vec3.create();\n  let upperVoxelBound: vec3 = vec3.create();\n\n  if (VALID_STACK_STATES.has(state)) {\n    let stackStatsObj = verifyObjectProperty(obj, 'stats', verifyObject);\n\n    lowerVoxelBound = parseLowerVoxelBounds(stackStatsObj);\n    upperVoxelBound = parseUpperVoxelBounds(stackStatsObj);\n\n    if (stackStatsObj.hasOwnProperty('channelNames')) {\n      channels = parseChannelNames(stackStatsObj);\n    }\n  } else if (PARTIAL_STACK_STATES.has(state)) {\n    // Stacks in LOADING state will not have a 'stats' object.\n    // Values will be populated from command arguments in MultiscaleVolumeChunkSource()\n  } else {\n    return undefined;\n  }\n\n  let voxelResolution: vec3 = verifyObjectProperty(obj, 'currentVersion', parseStackVersionInfo);\n\n  let project: string = verifyObjectProperty(obj, 'stackId', parseStackProject);\n\n  return {lowerVoxelBound, upperVoxelBound, voxelResolution, project, channels};\n}\n\nfunction parseUpperVoxelBounds(stackStatsObj: any): vec3 {\n  verifyObject(stackStatsObj);\n  let stackBounds = verifyObjectProperty(stackStatsObj, 'stackBounds', verifyObject);\n\n  let upperVoxelBound: vec3 = vec3.create();\n\n  upperVoxelBound[0] = verifyObjectProperty(stackBounds, 'maxX', verifyFloat)+1;\n  upperVoxelBound[1] = verifyObjectProperty(stackBounds, 'maxY', verifyFloat)+1;\n  upperVoxelBound[2] = verifyObjectProperty(stackBounds, 'maxZ', verifyFloat)+1;\n\n  return upperVoxelBound;\n}\n\nfunction parseLowerVoxelBounds(stackStatsObj: any): vec3 {\n  verifyObject(stackStatsObj);\n  let stackBounds = verifyObjectProperty(stackStatsObj, 'stackBounds', verifyObject);\n\n  let lowerVoxelBound: vec3 = vec3.create();\n\n  lowerVoxelBound[0] = verifyObjectProperty(stackBounds, 'minX', verifyFloat);\n  lowerVoxelBound[1] = verifyObjectProperty(stackBounds, 'minY', verifyFloat);\n  lowerVoxelBound[2] = verifyObjectProperty(stackBounds, 'minZ', verifyFloat);\n\n  return lowerVoxelBound;\n}\n\nfunction parseChannelNames(stackStatsObj: any): string[] {\n  verifyObject(stackStatsObj);\n\n  return verifyObjectProperty(stackStatsObj, 'channelNames', channelNamesObj => {\n    return parseArray(channelNamesObj, verifyString);\n  });\n}\n\nfunction parseStackVersionInfo(stackVersionObj: any): vec3 {\n  verifyObject(stackVersionObj);\n  let voxelResolution: vec3 = vec3.create();\n  try {\n    voxelResolution[0] = verifyObjectProperty(stackVersionObj, 'stackResolutionX', verifyFloat);\n    voxelResolution[1] = verifyObjectProperty(stackVersionObj, 'stackResolutionY', verifyFloat);\n    voxelResolution[2] = verifyObjectProperty(stackVersionObj, 'stackResolutionZ', verifyFloat);\n  } catch (ignoredError) {\n    // default is 1, 1, 1\n    voxelResolution[0] = 1;\n    voxelResolution[1] = 1;\n    voxelResolution[2] = 1;\n  }\n\n  return voxelResolution;\n}\n\nfunction parseStackProject(stackIdObj: any): string {\n  verifyObject(stackIdObj);\n  return verifyObjectProperty(stackIdObj, 'project', verifyString);\n}\n\nexport class MultiscaleVolumeChunkSource implements GenericMultiscaleVolumeChunkSource {\n  get dataType() {\n    if (this.parameters.encoding === 'raw16') {\n      return DataType.UINT16;\n    } else {\n      // JPEG\n      return DataType.UINT8;\n    }\n  }\n  get numChannels() {\n    if (this.parameters.encoding === 'raw16') {\n      return 1;\n    } else {\n      // JPEG\n      return 3;\n    }\n  }\n  get volumeType() {\n    return VolumeType.IMAGE;\n  }\n\n  channel: string|undefined;\n  stack: string;\n  stackInfo: StackInfo;\n\n  dims: vec3;\n\n  encoding: string;\n  numLevels: number|undefined;\n\n  // Render Parameters\n  minIntensity: number|undefined;\n  maxIntensity: number|undefined;\n\n  // Bounding box override parameters\n  minX: number|undefined;\n  minY: number|undefined;\n  minZ: number|undefined;\n  maxX: number|undefined;\n  maxY: number|undefined;\n  maxZ: number|undefined;\n\n  // Force limited number of tile specs to render for downsampled views of large projects\n  maxTileSpecsToRender: number|undefined;\n\n  filter: boolean|undefined;\n\n  constructor(\n      public chunkManager: ChunkManager, public baseUrl: string, public ownerInfo: OwnerInfo,\n      stack: string|undefined, public project: string, channel: string|undefined,\n      public parameters: {[index: string]: any}) {\n    let projectInfo = ownerInfo.projects.get(project);\n    if (projectInfo === undefined) {\n      throw new Error(\n          `Specified project ${JSON.stringify(project)} does not exist for ` +\n          `specified owner ${JSON.stringify(ownerInfo.owner)}`);\n    }\n\n    if (stack === undefined) {\n      const stackNames = Array.from(projectInfo.stacks.keys());\n      if (stackNames.length !== 1) {\n        throw new Error(`Dataset contains multiple stacks: ${JSON.stringify(stackNames)}`);\n      }\n      stack = stackNames[0];\n    }\n    const stackInfo = projectInfo.stacks.get(stack);\n    if (stackInfo === undefined) {\n      throw new Error(\n          `Specified stack ${JSON.stringify(stack)} is not one of the supported stacks: ` +\n          JSON.stringify(Array.from(projectInfo.stacks.keys())));\n    }\n    this.stack = stack;\n    this.stackInfo = stackInfo;\n\n    if (channel !== undefined && channel.length > 0) {\n      this.channel = channel;\n    }\n\n    this.minIntensity = verifyOptionalInt(parameters['minIntensity']);\n    this.maxIntensity = verifyOptionalInt(parameters['maxIntensity']);\n    this.maxTileSpecsToRender = verifyOptionalInt(parameters['maxTileSpecsToRender']);\n    this.filter = verifyOptionalBoolean(parameters['filter']);\n\n    this.minX = verifyOptionalInt(parameters['minX']);\n    this.minY = verifyOptionalInt(parameters['minY']);\n    this.minZ = verifyOptionalInt(parameters['minZ']);\n    this.maxX = verifyOptionalInt(parameters['maxX']);\n    this.maxY = verifyOptionalInt(parameters['maxY']);\n    this.maxZ = verifyOptionalInt(parameters['maxZ']);\n\n    if (this.minX !== undefined) { stackInfo.lowerVoxelBound[0] = this.minX; }\n    if (this.minY !== undefined) { stackInfo.lowerVoxelBound[1] = this.minY; }\n    if (this.minZ !== undefined) { stackInfo.lowerVoxelBound[2] = this.minZ; }\n    if (this.maxX !== undefined) { stackInfo.upperVoxelBound[0] = this.maxX; }\n    if (this.maxY !== undefined) { stackInfo.upperVoxelBound[1] = this.maxY; }\n    if (this.maxZ !== undefined) { stackInfo.upperVoxelBound[2] = this.maxZ; }\n\n    let encoding = verifyOptionalString(parameters['encoding']);\n    if (encoding === undefined) {\n      encoding = 'jpg';\n    } else {\n      if (!VALID_ENCODINGS.has(encoding)) {\n        throw new Error(`Invalid encoding: ${JSON.stringify(encoding)}.`);\n      }\n    }\n    this.encoding = encoding;\n\n    this.numLevels = verifyOptionalInt(parameters['numlevels']);\n\n    this.dims = vec3.create();\n\n    let tileSize = verifyOptionalInt(parameters['tilesize']);\n    if (tileSize === undefined) {\n      tileSize = 1024;  // Default tile size is 1024 x 1024\n    }\n    this.dims[0] = tileSize;\n    this.dims[1] = tileSize;\n    this.dims[2] = 1;\n  }\n\n  getSources(volumeSourceOptions: VolumeSourceOptions) {\n    let sources: VolumeChunkSource[][] = [];\n\n    let numLevels = this.numLevels;\n    if (numLevels === undefined) {\n      numLevels = computeStackHierarchy(this.stackInfo, this.dims[0]);\n    }\n\n    let lowerClipBound = vec3.create(), upperClipBound = vec3.create();\n    // Generate and set the clip bounds based on the highest resolution (lowest scale) data in\n    // render. Otherwise, rounding errors can cause inconsistencies in clip bounds between scaling\n    // levels.\n    for (let i = 0; i < 3; i++) {\n      lowerClipBound[i] = this.stackInfo.lowerVoxelBound[i] * this.stackInfo.voxelResolution[i];\n      upperClipBound[i] = this.stackInfo.upperVoxelBound[i] * this.stackInfo.voxelResolution[i];\n    }\n\n    for (let level = 0; level < numLevels; level++) {\n      let voxelSize = vec3.clone(this.stackInfo.voxelResolution);\n      let chunkDataSize = vec3.fromValues(1, 1, 1);\n      // tiles are NxMx1\n      for (let i = 0; i < 2; ++i) {\n        voxelSize[i] = voxelSize[i] * Math.pow(2, level);\n        chunkDataSize[i] = this.dims[i];\n      }\n\n      let lowerVoxelBound = vec3.create(), upperVoxelBound = vec3.create();\n\n      for (let i = 0; i < 3; i++) {\n        lowerVoxelBound[i] = Math.floor(\n            this.stackInfo.lowerVoxelBound[i] * (this.stackInfo.voxelResolution[i] / voxelSize[i]));\n        upperVoxelBound[i] = Math.ceil(\n            this.stackInfo.upperVoxelBound[i] * (this.stackInfo.voxelResolution[i] / voxelSize[i]));\n      }\n\n      let spec = VolumeChunkSpecification.make({\n        voxelSize,\n        chunkDataSize,\n        numChannels: this.numChannels,\n        dataType: this.dataType,\n        lowerClipBound,\n        upperClipBound,\n        lowerVoxelBound,\n        upperVoxelBound,\n        volumeSourceOptions,\n      });\n\n      let source = this.chunkManager.getChunkSource(TileChunkSource, {\n        spec,\n        parameters: {\n          'baseUrl': this.baseUrl,\n          'owner': this.ownerInfo.owner,\n          'project': this.stackInfo.project,\n          'stack': this.stack,\n          'channel': this.channel,\n          'minIntensity': this.minIntensity,\n          'maxIntensity': this.maxIntensity,\n          'maxTileSpecsToRender': this.maxTileSpecsToRender,\n          'filter': this.filter,\n          'dims': `${this.dims[0]}_${this.dims[1]}`,\n          'level': level,\n          'encoding': this.encoding,\n        }\n      });\n\n      sources.push([source]);\n    }\n    return sources;\n  }\n\n  /**\n   * Meshes are not supported.\n   */\n  getMeshSource(): null {\n    return null;\n  }\n}\n\nexport function computeStackHierarchy(stackInfo: StackInfo, tileSize: number) {\n  let maxBound = 0;\n  for (let i = 0; i < 2; i++) {\n    maxBound < stackInfo.upperVoxelBound[i] ? maxBound = stackInfo.upperVoxelBound[i] :\n                                              maxBound = maxBound;\n  }\n\n  if (tileSize >= maxBound) {\n    return 1;\n  }\n\n  let counter = 0;\n  while (maxBound > tileSize) {\n    maxBound = maxBound / 2;\n    counter++;\n  }\n\n  return counter;\n}\n\nexport function getOwnerInfo(\n    chunkManager: ChunkManager, hostname: string, owner: string): Promise<OwnerInfo> {\n  return chunkManager.memoize.getUncounted(\n      {'type': 'render:getOwnerInfo', hostname, owner},\n      () => fetchOk(`${hostname}/render-ws/v1/owner/${owner}/stacks`)\n                .then(response => response.json())\n                .then(parseOwnerInfo));\n}\n\nconst pathPattern = /^([^\\/?]+)(?:\\/([^\\/?]+))?(?:\\/([^\\/?]+))(?:\\/([^\\/?]*))?(?:\\?(.*))?$/;\nconst urlPattern = /^((?:(?:(?:http|https):\\/\\/[^,\\/]+)[^\\/?]))\\/(.*)$/;\n\nexport function getVolume(chunkManager: ChunkManager, datasourcePath: string) {\n  let hostname: string, path: string;\n  {\n    let match = datasourcePath.match(urlPattern);\n    if (match === null) {\n      throw new Error(`Invalid render volume path: ${JSON.stringify(datasourcePath)}`);\n    }\n    hostname = match[1];\n    path = match[2];\n  }\n  const match = path.match(pathPattern);\n  if (match === null) {\n    throw new Error(`Invalid volume path ${JSON.stringify(path)}`);\n  }\n  const owner = match[1];\n  const project = match[2];\n  const stack = match[3];\n  const channel = match[4];\n\n  const parameters = parseQueryStringParameters(match[5] || '');\n\n  return chunkManager.memoize.getUncounted(\n      {type: 'render:MultiscaleVolumeChunkSource', hostname, path},\n      () => getOwnerInfo(chunkManager, hostname, owner)\n                .then(\n                    ownerInfo => new MultiscaleVolumeChunkSource(\n                        chunkManager, hostname, ownerInfo, stack, project, channel, parameters)));\n}\n\nexport function stackAndProjectCompleter(\n    chunkManager: ChunkManager, hostname: string, path: string): Promise<CompletionResult> {\n  const stackMatch = path.match(/^(?:([^\\/]+)(?:\\/([^\\/]*))?(?:\\/([^\\/]*))?(\\/.*?)?)?$/);\n  if (stackMatch === null) {\n    // URL has incorrect format, don't return any results.\n    return Promise.reject<CompletionResult>(null);\n  }\n  if (stackMatch[2] === undefined) {\n    // Don't autocomplete the owner\n    return Promise.reject<CompletionResult>(null);\n  }\n  if (stackMatch[3] === undefined) {\n    let projectPrefix = stackMatch[2] || '';\n    return getOwnerInfo(chunkManager, hostname, stackMatch[1]).then(ownerInfo => {\n      let completions = getPrefixMatchesWithDescriptions(\n          projectPrefix, ownerInfo.projects, x => x[0] + '/', () => undefined);\n      return {offset: stackMatch[1].length + 1, completions};\n    });\n  }\n  if (stackMatch[4] === undefined) {\n    let stackPrefix = stackMatch[3] || '';\n    return getOwnerInfo(chunkManager, hostname, stackMatch[1]).then(ownerInfo => {\n      let projectInfo = ownerInfo.projects.get(stackMatch[2]);\n      if (projectInfo === undefined) {\n        return Promise.reject<CompletionResult>(null);\n      }\n      let completions =\n          getPrefixMatchesWithDescriptions(stackPrefix, projectInfo.stacks, x => x[0] + '/', x => {\n            return `(${x[1].project})`;\n          });\n      return {offset: stackMatch[1].length + stackMatch[2].length + 2, completions};\n    });\n  }\n  let channelPrefix = stackMatch[4].substr(1) || '';\n  return getOwnerInfo(chunkManager, hostname, stackMatch[1]).then(ownerInfo => {\n    let projectInfo = ownerInfo.projects.get(stackMatch[2]);\n    if (projectInfo === undefined) {\n      return Promise.reject<CompletionResult>(null);\n    }\n    let stackInfo = projectInfo.stacks.get(stackMatch[3]);\n    if (stackInfo === undefined) {\n      return Promise.reject<CompletionResult>(null);\n    }\n    let channels = stackInfo.channels;\n    if (channels.length === 0) {\n      return Promise.reject<CompletionResult>(null);\n    } else {\n      // Try and complete the channel\n      let completions =\n          getPrefixMatchesWithDescriptions(channelPrefix, channels, x => x, () => undefined);\n      return {\n        offset: stackMatch[1].length + stackMatch[2].length + stackMatch[3].length + 3,\n        completions\n      };\n    }\n  });\n}\n\nexport function volumeCompleter(\n    url: string, chunkManager: ChunkManager): Promise<CompletionResult> {\n  let match = url.match(urlPattern);\n  if (match === null) {\n    // We don't yet have a full hostname.\n    return Promise.reject<CompletionResult>(null);\n  }\n  let hostname = match[1];\n  let path = match[2];\n\n  return stackAndProjectCompleter(chunkManager, hostname, path)\n      .then(completions => applyCompletionOffset(match![1].length + 1, completions));\n}\n\nexport class MultiscaleVectorGraphicsChunkSource implements\n    GenericMultiscaleVectorGraphicsChunkSource {\n  stack: string;\n  stackInfo: StackInfo;\n\n  matchCollection: string;\n  zoffset: number;\n\n  dims: vec3;\n\n  constructor(\n      public chunkManager: ChunkManager, public baseUrl: string, public ownerInfo: OwnerInfo,\n      stack: string|undefined, public project: string, public parameters: {[index: string]: any}) {\n    let projectInfo = ownerInfo.projects.get(project);\n    if (projectInfo === undefined) {\n      throw new Error(\n          `Specified project ${JSON.stringify(project)} does not exist for ` +\n          `specified owner ${JSON.stringify(ownerInfo.owner)}`);\n    }\n\n    if (stack === undefined) {\n      const stackNames = Array.from(projectInfo.stacks.keys());\n      if (stackNames.length !== 1) {\n        throw new Error(`Dataset contains multiple stacks: ${JSON.stringify(stackNames)}`);\n      }\n      stack = stackNames[0];\n    }\n    const stackInfo = projectInfo.stacks.get(stack);\n    if (stackInfo === undefined) {\n      throw new Error(\n          `Specified stack ${JSON.stringify(stack)} is not one of the supported stacks: ` +\n          JSON.stringify(Array.from(projectInfo.stacks.keys())));\n    }\n    this.stack = stack;\n    this.stackInfo = stackInfo;\n\n    let matchCollection = verifyOptionalString(parameters['matchCollection']);\n    if (matchCollection === undefined) {\n      matchCollection = stack;\n    }\n    this.matchCollection = matchCollection;\n\n    let zoffset = verifyOptionalInt(parameters['zoffset']);\n    if (zoffset === undefined) {\n      zoffset = 1;\n    }\n    this.zoffset = zoffset;\n\n    this.dims = vec3.create();\n\n    let tileSize = verifyOptionalInt(parameters['tilesize']);\n    if (tileSize === undefined) {\n      tileSize = 1024;  // Default tile size is 1024 x 1024\n    }\n    this.dims[0] = tileSize;\n    this.dims[1] = tileSize;\n    this.dims[2] = 1;\n  }\n  getSources(vectorGraphicsSourceOptions: VectorGraphicsSourceOptions) {\n    const voxelSize = this.stackInfo.voxelResolution;\n    const chunkSize = vec3.subtract(\n        vec3.create(), this.stackInfo.upperVoxelBound, this.stackInfo.lowerVoxelBound);\n    vec3.multiply(chunkSize, chunkSize, voxelSize);\n    chunkSize[2] = voxelSize[2];\n\n    const spec = VectorGraphicsChunkSpecification.make({\n      voxelSize,\n      chunkSize,\n      lowerChunkBound: vec3.fromValues(0, 0, this.stackInfo.lowerVoxelBound[2]),\n      upperChunkBound: vec3.fromValues(1, 1, this.stackInfo.upperVoxelBound[2]),\n      vectorGraphicsSourceOptions\n    });\n    const source = this.chunkManager.getChunkSource(PointMatchSource, {\n      spec,\n      parameters: {\n        'baseUrl': this.baseUrl,\n        'owner': this.ownerInfo.owner,\n        'project': this.stackInfo.project,\n        'stack': this.stack,\n        'encoding': 'points',\n        'matchCollection': this.matchCollection,\n        'zoffset': this.zoffset\n      }\n    });\n\n    return [[source]];\n  }\n}\n\nexport function getPointMatches(chunkManager: ChunkManager, datasourcePath: string) {\n  let hostname: string, path: string;\n  {\n    let match = datasourcePath.match(urlPattern);\n    if (match === null) {\n      throw new Error(`Invalid render point path: ${JSON.stringify(datasourcePath)}`);\n    }\n    hostname = match[1];\n    path = match[2];\n  }\n  const match = path.match(pathPattern);\n  if (match === null) {\n    throw new Error(`Invalid point path ${JSON.stringify(path)}`);\n  }\n  \n  const owner = match[1];\n  const project = match[2];\n  const stack = match[3];\n\n  const parameters = parseQueryStringParameters(match[4] || '');\n\n  return chunkManager.memoize.getUncounted(\n      {type: 'render:MultiscaleVectorGraphicsChunkSource', hostname, path},\n      () => getOwnerInfo(chunkManager, hostname, owner)\n                .then(\n                    ownerInfo => new MultiscaleVectorGraphicsChunkSource(\n                        chunkManager, hostname, ownerInfo, stack, project, parameters)));\n}\n\nexport class RenderDataSource extends DataSource {\n  get description() {\n    return 'Render';\n  }\n  getVolume(chunkManager: ChunkManager, url: string) {\n    return getVolume(chunkManager, url);\n  }\n  volumeCompleter(url: string, chunkManager: ChunkManager) {\n    return volumeCompleter(url, chunkManager);\n  }\n  getVectorGraphicsSource(chunkManager: ChunkManager, url: string) {\n    return getPointMatches(chunkManager, url);\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {registerProvider} from 'neuroglancer/datasource/default_provider';\nimport {RenderDataSource} from 'neuroglancer/datasource/render/frontend';\n\nregisterProvider('render', () => new RenderDataSource());\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {FrameNumberCounter} from 'neuroglancer/chunk_manager/frontend';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {vec3} from 'neuroglancer/util/geom';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {WatchableVisibilityPriority} from 'neuroglancer/visibility_priority/frontend';\nimport {GL, initializeWebGL} from 'neuroglancer/webgl/context';\nimport ResizeObserver from 'resize-observer-polyfill';\n\nexport abstract class RenderedPanel extends RefCounted {\n  gl: GL;\n  constructor(\n      public context: DisplayContext, public element: HTMLElement,\n      public visibility: WatchableVisibilityPriority) {\n    super();\n    this.gl = context.gl;\n    context.addPanel(this);\n  }\n\n  scheduleRedraw() {\n    if (this.visible) {\n      this.context.scheduleRedraw();\n    }\n  }\n\n  abstract isReady(): boolean;\n\n  setGLViewport() {\n    let element = this.element;\n    const clientRect = element.getBoundingClientRect();\n    const canvasRect = this.context.canvasRect!;\n    const scaleX = canvasRect.width / this.context.canvas.width;\n    const scaleY = canvasRect.height / this.context.canvas.height;\n    let left = (element.clientLeft + clientRect.left - canvasRect.left) * scaleX;\n    let width = element.clientWidth;\n    let top = (clientRect.top - canvasRect.top + element.clientTop) * scaleY;\n    let height = element.clientHeight;\n    let bottom = top + height;\n    let gl = this.gl;\n    gl.enable(gl.SCISSOR_TEST);\n    let glBottom = this.context.canvas.height - bottom;\n    gl.viewport(left, glBottom, width, height);\n    gl.scissor(left, glBottom, width, height);\n  }\n\n  abstract draw(): void;\n\n  abstract translateDataPointByViewportPixels(\n      out: vec3, orig: vec3, deltaX: number, deltaY: number): vec3;\n\n  disposed() {\n    this.context.removePanel(this);\n    super.disposed();\n  }\n\n  get visible() {\n    return this.visibility.visible;\n  }\n}\n\nexport class DisplayContext extends RefCounted implements FrameNumberCounter {\n  canvas = document.createElement('canvas');\n  gl: GL;\n  updateStarted = new NullarySignal();\n  updateFinished = new NullarySignal();\n  changed = this.updateFinished;\n  panels = new Set<RenderedPanel>();\n  private updatePending: number|null = null;\n  canvasRect: ClientRect|undefined;\n\n  /**\n   * Unique number of the next frame.  Incremented once each time a frame is drawn.\n   */\n  frameNumber = 0;\n\n  private resizeObserver = new ResizeObserver(() => this.scheduleRedraw());\n\n  constructor(public container: HTMLElement) {\n    super();\n    const {canvas, resizeObserver} = this;\n    container.style.position = 'relative';\n    canvas.style.position = 'absolute';\n    canvas.style.top = '0px';\n    canvas.style.left = '0px';\n    canvas.style.width = '100%';\n    canvas.style.height = '100%';\n    canvas.style.zIndex = '0';\n    resizeObserver.observe(canvas);\n    container.appendChild(canvas);\n    this.gl = initializeWebGL(canvas);\n  }\n\n  isReady() {\n    for (const panel of this.panels) {\n      if (!panel.visible) {\n        continue;\n      }\n      if (!panel.isReady()) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  /**\n   * Returns a child element that overlays the canvas.\n   */\n  makeCanvasOverlayElement() {\n    const element = document.createElement('div');\n    element.style.position = 'absolute';\n    element.style.top = '0px';\n    element.style.left = '0px';\n    element.style.width = '100%';\n    element.style.height = '100%';\n    element.style.zIndex = '2';\n    this.container.appendChild(element);\n    return element;\n  }\n\n  disposed() {\n    this.resizeObserver.disconnect();\n    if (this.updatePending != null) {\n      cancelAnimationFrame(this.updatePending);\n      this.updatePending = null;\n    }\n  }\n\n  addPanel(panel: RenderedPanel) {\n    this.panels.add(panel);\n    this.resizeObserver.observe(panel.element);\n    this.scheduleRedraw();\n  }\n\n  removePanel(panel: RenderedPanel) {\n    this.resizeObserver.unobserve(panel.element);\n    this.panels.delete(panel);\n    panel.dispose();\n    this.scheduleRedraw();\n  }\n\n  scheduleRedraw() {\n    if (this.updatePending === null) {\n      this.updatePending = requestAnimationFrame(this.update.bind(this));\n    }\n  }\n\n  draw() {\n    ++this.frameNumber;\n    this.updateStarted.dispatch();\n    let gl = this.gl;\n    let canvas = this.canvas;\n    canvas.width = canvas.offsetWidth;\n    canvas.height = canvas.offsetHeight;\n    this.canvasRect = canvas.getBoundingClientRect();\n    this.gl.clearColor(0.0, 0.0, 0.0, 0.0);\n    gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n    for (let panel of this.panels) {\n      let {element} = panel;\n      if (!panel.visible || element.clientWidth === 0 || element.clientHeight === 0 ||\n          element.offsetWidth === 0 || element.offsetHeight === 0) {\n        // Skip drawing if the panel has zero client area.\n        continue;\n      }\n      panel.setGLViewport();\n      panel.draw();\n    }\n\n    // Ensure the alpha buffer is set to 1.\n    gl.disable(gl.SCISSOR_TEST);\n    this.gl.clearColor(1.0, 1.0, 1.0, 1.0);\n    this.gl.colorMask(false, false, false, true);\n    gl.clear(gl.COLOR_BUFFER_BIT);\n    this.gl.colorMask(true, true, true, true);\n    this.updateFinished.dispatch();\n  }\n\n  private update() {\n    this.updatePending = null;\n    this.draw();\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst k1 = 0xcc9e2d51;\nconst k2 = 0x1b873593;\n\n// MurmurHash excluding the final mixing steps.\nexport function hashCombine(state: number, value: number) {\n  value >>>= 0;\n  state >>>= 0;\n\n  value = Math.imul(value, k1) >>> 0;\n  value = ((value << 15) | (value >>> 17)) >>> 0;\n  value = Math.imul(value, k2) >>> 0;\n  state = (state ^ value) >>> 0;\n  state = ((state << 13) | (state >>> 19)) >>> 0;\n  state = ((state * 5) + 0xe6546b64) >>> 0;\n  return state;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {hashCombine} from 'neuroglancer/gpu_hash/hash_function';\nimport {getRandomValues} from 'neuroglancer/util/random';\nimport {Uint64} from 'neuroglancer/util/uint64';\n\nexport const NUM_ALTERNATIVES = 3;\n\nconst DEFAULT_LOAD_FACTOR = 0.9;\n\nconst DEBUG = false;\n\n// Key that needs to be inserted.  Temporary variables used during insert.  These can safely be\n// global because control never leaves functions defined in this module while these are in use.\nlet pendingLow = 0, pendingHigh = 0, backupPendingLow = 0, backupPendingHigh = 0;\n\nexport abstract class HashTableBase {\n  loadFactor = DEFAULT_LOAD_FACTOR;\n  size = 0;\n  table: Uint32Array;\n  tableSize: number;\n  emptyLow = 4294967295;\n  emptyHigh = 4294967295;\n  maxRehashAttempts = 5;\n  maxAttempts = 5;\n  capacity: number;\n\n  /**\n   * Number of uint32 elements per entry in hash table.\n   */\n  entryStride: number;\n\n  generation = 0;\n\n  mungedEmptyKey = -1;\n\n  constructor(public hashSeeds = HashTableBase.generateHashSeeds(NUM_ALTERNATIVES)) {\n    // Minimum size must be greater than 2 * hashSeeds.length.  Otherwise, tableWithMungedEmptyKey\n    // may loop infinitely.\n    let initialSize = 8;\n    while (initialSize < 2 * hashSeeds.length) {\n      initialSize *= 2;\n    }\n    this.allocate(initialSize);\n  }\n\n  private updateHashFunctions(numHashes: number) {\n    this.hashSeeds = HashTableBase.generateHashSeeds(numHashes);\n    this.mungedEmptyKey = -1;\n  }\n\n  /**\n   * Invokes callback with a modified version of the hash table data array.\n   *\n   * Replaces all slots that appear to be valid entries for (emptyLow, emptyHigh), i.e. slots that\n   * contain (emptyLow, emptyHigh) and to which (emptyLow, emptyHigh) hashes, with (mungedEmptyKey,\n   * mungedEmptyKey).\n   *\n   * mungedEmptyKey is chosen to be a 32-bit value with the property that the 64-bit value\n   * (mungedEmptyKey, mungedEmptyKey) does not hash to any of the same slots as (emptyLow,\n   * emptyHigh).\n   *\n   * This allows the modified data array to be used for lookups without special casing the empty\n   * key.\n   */\n  tableWithMungedEmptyKey(callback: (table: Uint32Array) => void) {\n    const numHashes = this.hashSeeds.length;\n    const emptySlots = new Array<number>(numHashes);\n    for (let i = 0; i < numHashes; ++i) {\n      emptySlots[i] = this.getHash(i, this.emptyLow, this.emptyHigh);\n    }\n    let {mungedEmptyKey} = this;\n    if (mungedEmptyKey === -1) {\n      chooseMungedEmptyKey: while (true) {\n        mungedEmptyKey = (Math.random() * 0x1000000) >>> 0;\n        for (let i = 0; i < numHashes; ++i) {\n          let h = this.getHash(i, mungedEmptyKey, mungedEmptyKey);\n          for (let j = 0; j < numHashes; ++j) {\n            if (emptySlots[j] === h) {\n              continue chooseMungedEmptyKey;\n            }\n          }\n        }\n        this.mungedEmptyKey = mungedEmptyKey;\n        break;\n      }\n    }\n    let {table, emptyLow, emptyHigh} = this;\n    for (let i = 0; i < numHashes; ++i) {\n      let h = emptySlots[i];\n      if (table[h] === emptyLow && table[h + 1] === emptyHigh) {\n        table[h] = mungedEmptyKey;\n        table[h + 1] = mungedEmptyKey;\n      }\n    }\n    try {\n      callback(table);\n    } finally {\n      for (let i = 0; i < numHashes; ++i) {\n        let h = emptySlots[i];\n        if (table[h] === mungedEmptyKey && table[h + 1] === mungedEmptyKey) {\n          table[h] = emptyLow;\n          table[h + 1] = emptyHigh;\n        }\n      }\n    }\n  }\n\n  static generateHashSeeds(numAlternatives = NUM_ALTERNATIVES) {\n    return getRandomValues(new Uint32Array(numAlternatives));\n  }\n\n  getHash(hashIndex: number, low: number, high: number) {\n    let hash = this.hashSeeds[hashIndex];\n    hash = hashCombine(hash, low);\n    hash = hashCombine(hash, high);\n    return this.entryStride * (hash & (this.tableSize - 1));\n  }\n\n  /**\n   * Iterates over the Uint64 keys contained in the hash set.\n   *\n   * The same temp value will be modified and yielded at every iteration.\n   */\n  * keys(temp = new Uint64()) {\n    let {emptyLow, emptyHigh, entryStride} = this;\n    let {table} = this;\n    for (let i = 0, length = table.length; i < length; i += entryStride) {\n      let low = table[i], high = table[i + 1];\n      if (low !== emptyLow || high !== emptyHigh) {\n        temp.low = low;\n        temp.high = high;\n        yield temp;\n      }\n    }\n  }\n\n  indexOfPair(low: number, high: number) {\n    let {table, emptyLow, emptyHigh} = this;\n    if (low === emptyLow && high === emptyHigh) {\n      return -1;\n    }\n    for (let i = 0, numHashes = this.hashSeeds.length; i < numHashes; ++i) {\n      let h = this.getHash(i, low, high);\n      if (table[h] === low && table[h + 1] === high) {\n        return h;\n      }\n    }\n    return -1;\n  }\n\n  /**\n   * Returns the offset into the hash table of the specified element, or -1 if the element is not\n   * present.\n   */\n  indexOf(x: Uint64) {\n    return this.indexOfPair(x.low, x.high);\n  }\n\n  /**\n   * Changes the empty key to a value that is not equal to the current empty key and is not present\n   * in the table.\n   *\n   * This is called when an attempt is made to insert the empty key.\n   */\n  private chooseAnotherEmptyKey() {\n    let {emptyLow, emptyHigh, table, entryStride} = this;\n    let newLow: number, newHigh: number;\n    while (true) {\n      newLow = (Math.random() * 0x100000000) >>> 0;\n      newHigh = (Math.random() * 0x100000000) >>> 0;\n      if (newLow === emptyLow && newHigh === emptyHigh) {\n        continue;\n      }\n      if (this.hasPair(newLow, newHigh)) {\n        continue;\n      }\n      break;\n    }\n\n    this.emptyLow = newLow;\n    this.emptyHigh = newHigh;\n\n    // Replace empty keys in the table.\n    for (let h = 0, length = table.length; h < length; h += entryStride) {\n      if (table[h] === emptyLow && table[h + 1] === emptyHigh) {\n        table[h] = newLow;\n        table[h + 1] = newHigh;\n      }\n    }\n  }\n\n  /**\n   * Returns true iff the specified element is present.\n   */\n  has(x: Uint64) {\n    return this.indexOf(x) !== -1;\n  }\n\n  /**\n   * Returns true iff the specified element is present.\n   */\n  hasPair(low: number, high: number) {\n    return this.indexOfPair(low, high) !== -1;\n  }\n\n  delete(x: Uint64) {\n    let index = this.indexOf(x);\n    if (index !== -1) {\n      let {table} = this;\n      table[index] = this.emptyLow;\n      table[index + 1] = this.emptyHigh;\n      ++this.generation;\n      this.size--;\n      return true;\n    }\n    return false;\n  }\n\n  private clearTable() {\n    let {table, entryStride, emptyLow, emptyHigh} = this;\n    let length = table.length;\n\n    for (let h = 0; h < length; h += entryStride) {\n      table[h] = emptyLow;\n      table[h + 1] = emptyHigh;\n    }\n  }\n\n  clear() {\n    if (this.size === 0) {\n      return false;\n    }\n    this.size = 0;\n    ++this.generation;\n    this.clearTable();\n    return true;\n  }\n\n  protected swapPending(table: Uint32Array, offset: number) {\n    let tempLow = pendingLow, tempHigh = pendingHigh;\n    this.storePending(table, offset);\n    table[offset] = tempLow;\n    table[offset + 1] = tempHigh;\n  }\n\n  protected storePending(table: Uint32Array, offset: number) {\n    pendingLow = table[offset];\n    pendingHigh = table[offset + 1];\n  }\n\n  protected backupPending() {\n    backupPendingLow = pendingLow;\n    backupPendingHigh = pendingHigh;\n  }\n\n  protected restorePending() {\n    pendingLow = backupPendingLow;\n    pendingHigh = backupPendingHigh;\n  }\n\n  private tryToInsert() {\n    if (DEBUG) {\n      console.log(`tryToInsert: ${pendingLow}, ${pendingHigh}`);\n    }\n    let attempt = 0;\n    let {emptyLow, emptyHigh, maxAttempts, table} = this;\n    let numHashes = this.hashSeeds.length;\n\n    let tableIndex = Math.floor(Math.random() * numHashes);\n    while (true) {\n      let h = this.getHash(tableIndex, pendingLow, pendingHigh);\n      this.swapPending(table, h);\n      if (pendingLow === emptyLow && pendingHigh === emptyHigh) {\n        return true;\n      }\n      if (++attempt === maxAttempts) {\n        break;\n      }\n      tableIndex = (tableIndex + Math.floor(Math.random() * (numHashes - 1)) + 1) % numHashes;\n    }\n    return false;\n  }\n\n  private allocate(tableSize: number) {\n    this.tableSize = tableSize;\n    let {entryStride} = this;\n    this.table = new Uint32Array(tableSize * entryStride);\n    this.maxAttempts = tableSize;\n    this.clearTable();\n    this.capacity = tableSize * this.loadFactor;\n    this.mungedEmptyKey = -1;\n  }\n\n  private rehash(oldTable: Uint32Array, tableSize: number) {\n    if (DEBUG) {\n      console.log('rehash begin');\n    }\n    this.allocate(tableSize);\n    this.updateHashFunctions(this.hashSeeds.length);\n    let {emptyLow, emptyHigh, entryStride} = this;\n    for (let h = 0, length = oldTable.length; h < length; h += entryStride) {\n      let low = oldTable[h], high = oldTable[h + 1];\n      if (low !== emptyLow || high !== emptyHigh) {\n        this.storePending(oldTable, h);\n        if (!this.tryToInsert()) {\n          if (DEBUG) {\n            console.log('rehash failed');\n          }\n          return false;\n        }\n      }\n    }\n    if (DEBUG) {\n      console.log('rehash end');\n    }\n    return true;\n  }\n\n  private grow(desiredTableSize: number) {\n    if (DEBUG) {\n      console.log(`grow: ${desiredTableSize}`);\n    }\n    let oldTable = this.table;\n    let {tableSize} = this;\n    while (tableSize < desiredTableSize) {\n      tableSize *= 2;\n    }\n    while (true) {\n      for (let rehashAttempt = 0; rehashAttempt < this.maxRehashAttempts; ++rehashAttempt) {\n        if (this.rehash(oldTable, tableSize)) {\n          if (DEBUG) {\n            console.log(`grow end`);\n          }\n          return;\n        }\n      }\n      tableSize *= 2;\n    }\n  }\n\n  protected insertInternal() {\n    ++this.generation;\n\n    if (pendingLow === this.emptyLow && pendingHigh === this.emptyHigh) {\n      this.chooseAnotherEmptyKey();\n    }\n\n    if (++this.size > this.capacity) {\n      this.backupPending();\n      this.grow(this.tableSize * 2);\n      this.restorePending();\n    }\n\n    while (!this.tryToInsert()) {\n      this.backupPending();\n      this.grow(this.tableSize);\n      this.restorePending();\n    }\n  }\n}\n\nexport class HashSetUint64 extends HashTableBase {\n  add(x: Uint64) {\n    let {low, high} = x;\n    if (this.hasPair(low, high)) {\n      return false;\n    }\n    if (DEBUG) {\n      console.log(`add: ${low},${high}`);\n    }\n    pendingLow = low;\n    pendingHigh = high;\n    this.insertInternal();\n    return true;\n  }\n\n  /**\n   * Iterates over the keys.  The same temporary value will be modified and yielded at every\n   * iteration.\n   */\n  [Symbol.iterator]() {\n    return this.keys();\n  }\n}\nHashSetUint64.prototype.entryStride = 2;\n\n// Value that needs to be inserted.  Temporary variables used during insert.  These can safely be\n// global because control never leaves functions defined in this module while these are in use.\nlet pendingValueLow = 0, pendingValueHigh = 0, backupPendingValueLow = 0,\n    backupPendingValueHigh = 0;\n\nexport class HashMapUint64 extends HashTableBase {\n  set(key: Uint64, value: Uint64) {\n    let {low, high} = key;\n    if (this.hasPair(low, high)) {\n      return false;\n    }\n    if (DEBUG) {\n      console.log(`add: ${low},${high} -> ${value.low},${value.high}`);\n    }\n    pendingLow = low;\n    pendingHigh = high;\n    pendingValueLow = value.low;\n    pendingValueHigh = value.high;\n    this.insertInternal();\n    return true;\n  }\n\n  get(key: Uint64, value: Uint64): boolean {\n    let h = this.indexOf(key);\n    if (h === -1) {\n      return false;\n    }\n    let {table} = this;\n    value.low = table[h + 2];\n    value.high = table[h + 3];\n    return true;\n  }\n\n  protected swapPending(table: Uint32Array, offset: number) {\n    let tempLow = pendingValueLow, tempHigh = pendingValueHigh;\n    super.swapPending(table, offset);\n    table[offset + 2] = tempLow;\n    table[offset + 3] = tempHigh;\n  }\n\n  protected storePending(table: Uint32Array, offset: number) {\n    super.storePending(table, offset);\n    pendingValueLow = table[offset + 2];\n    pendingValueHigh = table[offset + 3];\n  }\n\n  protected backupPending() {\n    super.backupPending();\n    backupPendingValueLow = pendingValueLow;\n    backupPendingValueHigh = pendingValueHigh;\n  }\n\n  protected restorePending() {\n    super.restorePending();\n    pendingValueLow = backupPendingValueLow;\n    pendingValueHigh = backupPendingValueHigh;\n  }\n\n  /**\n   * Iterates over entries.  The same temporary value will be modified and yielded at every\n   * iteration.\n   */\n  [Symbol.iterator]() {\n    return this.entries();\n  }\n\n  /**\n   * Iterates over entries.  The same temporary value will be modified and yielded at every\n   * iteration.\n   */\n  * entries(temp: [Uint64, Uint64] = [new Uint64(), new Uint64()]) {\n    let {emptyLow, emptyHigh, entryStride} = this;\n    let {table} = this;\n    let [key, value] = temp;\n    for (let i = 0, length = table.length; i < length; i += entryStride) {\n      let low = table[i], high = table[i + 1];\n      if (low !== emptyLow || high !== emptyHigh) {\n        key.low = low;\n        key.high = high;\n        value.low = table[i + 2];\n        value.high = table[i + 3];\n        yield temp;\n      }\n    }\n  }\n}\nHashMapUint64.prototype.entryStride = 4;\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {HashTableBase, NUM_ALTERNATIVES} from 'neuroglancer/gpu_hash/hash_table';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {ShaderBuilder, ShaderProgram} from 'neuroglancer/webgl/shader';\nimport {glsl_equalUint64, glsl_uint64} from 'neuroglancer/webgl/shader_lib';\nimport {compute1dTextureLayout, computeTextureFormat, OneDimensionalTextureAccessHelper, OneDimensionalTextureLayout, setOneDimensionalTextureData, TextureFormat} from 'neuroglancer/webgl/texture_access';\n\nimport {DataType} from '../util/data_type';\n\n// MumurHash, excluding the final mixing steps.\nexport const glsl_hashCombine = [\n  glsl_uint64, `\nhighp uint hashCombine(highp uint state, highp uint value) {\n  value *= 0xcc9e2d51u;\n  value = (value << 15u) | (value >> 17u);\n  value *= 0x1b873593u;\n  state ^= value;\n  state = (state << 13u) | (state >> 19u);\n  state = (state * 5u) + 0xe6546b64u;\n  return state;\n}\nhighp uint hashCombine(highp uint state, uint64_t x) {\n  state = hashCombine(state, x.value[0]);\n  return hashCombine(state, x.value[1]);\n}\n`\n];\n\nconst textureFormat = computeTextureFormat(new TextureFormat(), DataType.UINT64, 1);\n\nexport class GPUHashTable<HashTable extends HashTableBase> extends RefCounted implements\n    OneDimensionalTextureLayout {\n  generation = -1;\n  textureXBits: number;\n  textureWidth: number;\n  textureHeight: number;\n  texture: WebGLTexture|null = null;\n\n  constructor(public gl: GL, public hashTable: HashTable) {\n    super();\n    // createTexture should never actually return null.\n    this.texture = gl.createTexture();\n  }\n\n  copyToGPU() {\n    let {hashTable} = this;\n    let {generation} = hashTable;\n    if (this.generation === generation) {\n      return;\n    }\n    const {gl, texture} = this;\n    compute1dTextureLayout(\n        this, gl, textureFormat.texelsPerElement, hashTable.tableSize * hashTable.entryStride / 2);\n    this.generation = generation;\n    gl.activeTexture(WebGL2RenderingContext.TEXTURE0 + gl.tempTextureUnit);\n    gl.bindTexture(WebGL2RenderingContext.TEXTURE_2D, texture);\n    hashTable.tableWithMungedEmptyKey(table => {\n      setOneDimensionalTextureData(this.gl, this, textureFormat, table);\n    });\n    gl.bindTexture(WebGL2RenderingContext.TEXTURE_2D, null);\n  }\n\n  disposed() {\n    let {gl} = this;\n    gl.deleteTexture(this.texture);\n    this.texture = null;\n    this.gl = <any>undefined;\n    this.hashTable = <any>undefined;\n    super.disposed();\n  }\n\n  static get<HashTable extends HashTableBase>(gl: GL, hashTable: HashTable) {\n    return gl.memoize.get(hashTable, () => new this(gl, hashTable));\n  }\n}\n\nexport class HashSetShaderManager {\n  textureUnitSymbol = Symbol.for(`gpuhashtable:${this.prefix}`);\n  private accessHelper = new OneDimensionalTextureAccessHelper(`gpuhashtable_${this.prefix}`);\n  samplerName = this.prefix + '_sampler';\n  hashSeedsName = this.prefix + '_seeds';\n  hashKeyMask = this.prefix + '_keyMask';\n  readTable = this.prefix + '_readTable';\n\n  constructor(public prefix: string, public numAlternatives = NUM_ALTERNATIVES) {}\n\n  defineShader(builder: ShaderBuilder) {\n    let {hashSeedsName, samplerName, numAlternatives, hashKeyMask} = this;\n    builder.addUniform('highp uint', hashSeedsName, numAlternatives);\n    builder.addUniform('highp uint', hashKeyMask);\n    builder.addTextureSampler('usampler2D', samplerName, this.textureUnitSymbol);\n    builder.addFragmentCode(glsl_hashCombine);\n    builder.addFragmentCode(glsl_uint64);\n    builder.addFragmentCode(glsl_equalUint64);\n    this.accessHelper.defineShader(builder);\n    builder.addFragmentCode(\n        this.accessHelper.getAccessor(this.readTable, this.samplerName, DataType.UINT64, 1));\n    let s = '';\n    s += `\nbool ${this.hasFunctionName}(uint64_t x) {\n`;\n    for (let alt = 0; alt < numAlternatives; ++alt) {\n      s += `\n  {\n    uint h = hashCombine(${hashSeedsName}[${alt}], x) & ${hashKeyMask};\n    uint64_t key = ${this.readTable}(h);\n    if (equals(key, x)) {\n      return true;\n    }\n  }\n`;\n    }\n    s += `\n  return false;\n}\n`;\n    builder.addFragmentCode(s);\n  }\n\n  get hasFunctionName() {\n    return `${this.prefix}_has`;\n  }\n\n  enable<HashTable extends HashTableBase>(\n      gl: GL, shader: ShaderProgram, hashTable: GPUHashTable<HashTable>) {\n    hashTable.copyToGPU();\n    const textureUnit = shader.textureUnit(this.textureUnitSymbol);\n    gl.activeTexture(WebGL2RenderingContext.TEXTURE0 + textureUnit);\n    gl.bindTexture(WebGL2RenderingContext.TEXTURE_2D, hashTable.texture);\n    this.accessHelper.setupTextureLayout(gl, shader, hashTable);\n    gl.uniform1ui(shader.uniform(this.hashKeyMask), hashTable.hashTable.tableSize - 1);\n    gl.uniform1uiv(shader.uniform(this.hashSeedsName), hashTable.hashTable.hashSeeds);\n  }\n\n  disable(gl: GL, shader: ShaderProgram) {\n    const textureUnit = shader.textureUnit(this.textureUnitSymbol);\n    gl.activeTexture(WebGL2RenderingContext.TEXTURE0 + textureUnit);\n    gl.bindTexture(WebGL2RenderingContext.TEXTURE_2D, null);\n  }\n}\n\nexport class HashMapShaderManager extends HashSetShaderManager {\n  defineShader(builder: ShaderBuilder) {\n    super.defineShader(builder);\n    let {numAlternatives, hashSeedsName, hashKeyMask} = this;\n    let s = `\nbool ${this.getFunctionName}(uint64_t x, out uint64_t value) {\n`;\n    for (let alt = 0; alt < numAlternatives; ++alt) {\n      s += `\n  {\n    uint h = hashCombine(${hashSeedsName}[${alt}], x) & ${hashKeyMask};\n    uint64_t key = ${this.readTable}(h * 2u);\n    if (equals(key, x)) {\n      value = ${this.readTable}(h * 2u + 1u);\n      return true;\n    }\n  }\n`;\n    }\n    s += `\n  return false;\n}\n`;\n    builder.addFragmentCode(s);\n  }\n\n  get getFunctionName() {\n    return `${this.prefix}_get`;\n  }\n}\n","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Overlay} from 'neuroglancer/overlay';\nimport {EventActionMap} from 'neuroglancer/util/event_action_map';\n\nimport './input_event_bindings.css';\n\nexport function formatKeyName(name: string) {\n  if (name.startsWith('key')) {\n    return name.substring(3);\n  }\n  if (name.startsWith('digit')) {\n    return name.substring(5);\n  }\n  if (name.startsWith('arrow')) {\n    return name.substring(5);\n  }\n  return name;\n}\n\nexport function formatKeyStroke(stroke: string) {\n  let parts = stroke.split('+');\n  return parts.map(formatKeyName).join('+');\n}\n\nexport class InputEventBindingHelpDialog extends Overlay {\n  /**\n   * @param keyMap Key map to list.\n   */\n  constructor(bindings: Iterable<[string, EventActionMap]>) {\n    super();\n\n    let {content} = this;\n    content.classList.add('describe-key-bindings');\n\n    let scroll = document.createElement('div');\n    scroll.classList.add('describe-key-bindings-container');\n\n    interface BindingList {\n      label: string;\n      entries: Map<string, string>;\n    }\n\n    const uniqueMaps = new Map<EventActionMap, BindingList>();\n    function addEntries(eventMap: EventActionMap, entries: Map<string, string>) {\n      for (const parent of eventMap.parents) {\n        if (parent.label !== undefined) {\n          addMap(parent.label, parent);\n        } else {\n          addEntries(parent, entries);\n        }\n      }\n      for (const [event, eventAction] of eventMap.bindings.entries()) {\n        const firstColon = event.indexOf(':');\n        const suffix = event.substring(firstColon + 1);\n        entries.set(suffix, eventAction.action);\n      }\n    }\n\n    function addMap(label: string, map: EventActionMap) {\n      if (uniqueMaps.has(map)) {\n        return;\n      }\n      const list: BindingList = {\n        label,\n        entries: new Map(),\n      };\n      addEntries(map, list.entries);\n      uniqueMaps.set(map, list);\n    }\n\n    for (const [label, eventMap] of bindings) {\n      addMap(label, eventMap);\n    }\n\n    for (const list of uniqueMaps.values()) {\n      let header = document.createElement('h2');\n      header.textContent = list.label;\n      scroll.appendChild(header);\n      for (const [event, action] of list.entries) {\n        let dt = document.createElement('div');\n        dt.className = 'dt';\n        dt.textContent = formatKeyStroke(event);\n        let dd = document.createElement('div');\n        dd.className = 'dd';\n        dd.textContent = action;\n        scroll.appendChild(dt);\n        scroll.appendChild(dd);\n      }\n    }\n    content.appendChild(scroll);\n  }\n}\n\n","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {UserLayer} from 'neuroglancer/layer';\nimport {LayerListSpecification, registerLayerType, registerVolumeLayerType} from 'neuroglancer/layer_specification';\nimport {Overlay} from 'neuroglancer/overlay';\nimport {VolumeType} from 'neuroglancer/sliceview/volume/base';\nimport {FRAGMENT_MAIN_START, getTrackableFragmentMain, ImageRenderLayer} from 'neuroglancer/sliceview/volume/image_renderlayer';\nimport {trackableAlphaValue} from 'neuroglancer/trackable_alpha';\nimport {trackableBlendModeValue} from 'neuroglancer/trackable_blend';\nimport {UserLayerWithVolumeSourceMixin} from 'neuroglancer/user_layer_with_volume_source';\nimport {makeWatchableShaderError} from 'neuroglancer/webgl/dynamic_shader';\nimport {ShaderControlState} from 'neuroglancer/webgl/shader_ui_controls';\nimport {EnumSelectWidget} from 'neuroglancer/widget/enum_widget';\nimport {RangeWidget} from 'neuroglancer/widget/range';\nimport {RenderScaleWidget} from 'neuroglancer/widget/render_scale_widget';\nimport {ShaderCodeWidget} from 'neuroglancer/widget/shader_code_widget';\nimport {ShaderControls} from 'neuroglancer/widget/shader_controls';\nimport {Tab} from 'neuroglancer/widget/tab_view';\n\nimport './image_user_layer.css';\nimport 'neuroglancer/maximize_button.css';\n\nconst OPACITY_JSON_KEY = 'opacity';\nconst BLEND_JSON_KEY = 'blend';\nconst SHADER_JSON_KEY = 'shader';\nconst SHADER_CONTROLS_JSON_KEY = 'shaderControls';\n\nconst Base = UserLayerWithVolumeSourceMixin(UserLayer);\nexport class ImageUserLayer extends Base {\n  opacity = trackableAlphaValue(0.5);\n  blendMode = trackableBlendModeValue();\n  fragmentMain = getTrackableFragmentMain();\n  shaderError = makeWatchableShaderError();\n  renderLayer: ImageRenderLayer;\n  shaderControlState = new ShaderControlState(this.fragmentMain);\n  constructor(manager: LayerListSpecification, x: any) {\n    super(manager, x);\n    this.registerDisposer(this.blendMode.changed.add(this.specificationChanged.dispatch));\n    this.registerDisposer(this.fragmentMain.changed.add(this.specificationChanged.dispatch));\n    this.registerDisposer(this.shaderControlState.changed.add(this.specificationChanged.dispatch));\n    this.tabs.add(\n        'rendering',\n        {label: 'Rendering', order: -100, getter: () => new RenderingOptionsTab(this)});\n    this.tabs.default = 'rendering';\n  }\n\n  restoreState(specification: any) {\n    super.restoreState(specification);\n    this.opacity.restoreState(specification[OPACITY_JSON_KEY]);\n    const blendValue = specification[BLEND_JSON_KEY];\n    if (blendValue !== undefined) {\n      this.blendMode.restoreState(blendValue);\n    }\n    this.fragmentMain.restoreState(specification[SHADER_JSON_KEY]);\n    this.shaderControlState.restoreState(specification[SHADER_CONTROLS_JSON_KEY]);\n    const {multiscaleSource} = this;\n    if (multiscaleSource === undefined) {\n      throw new Error(`source property must be specified`);\n    }\n    multiscaleSource.then(volume => {\n      if (!this.wasDisposed) {\n        let renderLayer = this.renderLayer = new ImageRenderLayer(volume, {\n          opacity: this.opacity,\n          blendMode: this.blendMode,\n          shaderControlState: this.shaderControlState,\n          shaderError: this.shaderError,\n          transform: this.transform,\n          renderScaleTarget: this.sliceViewRenderScaleTarget,\n          renderScaleHistogram: this.sliceViewRenderScaleHistogram,\n        });\n        this.addRenderLayer(renderLayer);\n        this.shaderError.changed.dispatch();\n        this.isReady = true;\n      }\n    });\n  }\n  toJSON() {\n    const x = super.toJSON();\n    x['type'] = 'image';\n    x[OPACITY_JSON_KEY] = this.opacity.toJSON();\n    x[BLEND_JSON_KEY] = this.blendMode.toJSON();\n    x[SHADER_JSON_KEY] = this.fragmentMain.toJSON();\n    x[SHADER_CONTROLS_JSON_KEY] = this.shaderControlState.toJSON();\n    return x;\n  }\n}\n\nfunction makeShaderCodeWidget(layer: ImageUserLayer) {\n  return new ShaderCodeWidget({\n    shaderError: layer.shaderError,\n    fragmentMain: layer.fragmentMain,\n    fragmentMainStartLine: FRAGMENT_MAIN_START,\n    shaderControlState: layer.shaderControlState,\n  });\n}\n\nclass RenderingOptionsTab extends Tab {\n  opacityWidget = this.registerDisposer(new RangeWidget(this.layer.opacity));\n  codeWidget = this.registerDisposer(makeShaderCodeWidget(this.layer));\n  constructor(public layer: ImageUserLayer) {\n    super();\n    const {element} = this;\n    element.classList.add('image-dropdown');\n    let {opacityWidget} = this;\n    let topRow = document.createElement('div');\n    topRow.className = 'image-dropdown-top-row';\n    opacityWidget.promptElement.textContent = 'Opacity';\n\n    {\n      const renderScaleWidget = this.registerDisposer(new RenderScaleWidget(\n          this.layer.sliceViewRenderScaleHistogram, this.layer.sliceViewRenderScaleTarget));\n      renderScaleWidget.label.textContent = 'Resolution (slice)';\n      element.appendChild(renderScaleWidget.element);\n    }\n\n    {\n      const label = document.createElement('label');\n      label.textContent = 'Blending';\n      label.appendChild(this.registerDisposer(new EnumSelectWidget(layer.blendMode)).element);\n      element.appendChild(label);\n    }\n\n    let spacer = document.createElement('div');\n    spacer.style.flex = '1';\n    let helpLink = document.createElement('a');\n    let helpButton = document.createElement('button');\n    helpButton.type = 'button';\n    helpButton.textContent = '?';\n    helpButton.className = 'help-link';\n    helpLink.appendChild(helpButton);\n    helpLink.title = 'Documentation on image layer rendering';\n    helpLink.target = '_blank';\n    helpLink.href =\n        'https://github.com/google/neuroglancer/blob/master/src/neuroglancer/sliceview/image_layer_rendering.md';\n\n    let maximizeButton = document.createElement('button');\n    maximizeButton.innerHTML = '&square;';\n    maximizeButton.className = 'maximize-button';\n    maximizeButton.title = 'Show larger editor view';\n    this.registerEventListener(maximizeButton, 'click', () => {\n      new ShaderCodeOverlay(this.layer);\n    });\n\n    topRow.appendChild(this.opacityWidget.element);\n    topRow.appendChild(spacer);\n    topRow.appendChild(maximizeButton);\n    topRow.appendChild(helpLink);\n\n    element.appendChild(topRow);\n    element.appendChild(this.codeWidget.element);\n    element.appendChild(\n        this.registerDisposer(new ShaderControls(layer.shaderControlState)).element);\n\n    this.codeWidget.textEditor.refresh();\n    this.visibility.changed.add(() => {\n      if (this.visible) {\n        this.codeWidget.textEditor.refresh();\n      }\n    });\n  }\n}\n\nclass ShaderCodeOverlay extends Overlay {\n  codeWidget = this.registerDisposer(makeShaderCodeWidget(this.layer));\n  constructor(public layer: ImageUserLayer) {\n    super();\n    this.content.classList.add('image-layer-shader-overlay');\n    this.content.appendChild(this.codeWidget.element);\n    this.codeWidget.textEditor.refresh();\n  }\n}\n\nregisterLayerType('image', ImageUserLayer);\nregisterVolumeLayerType(VolumeType.IMAGE, ImageUserLayer);\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport debounce from 'lodash/debounce';\nimport {AnnotationLayerState} from 'neuroglancer/annotation/frontend';\nimport {RenderedPanel} from 'neuroglancer/display_context';\nimport {LayerListSpecification} from 'neuroglancer/layer_specification';\nimport {SpatialPosition} from 'neuroglancer/navigation_state';\nimport {TrackableRefCounted, TrackableValue, WatchableSet} from 'neuroglancer/trackable_value';\nimport {restoreTool, Tool} from 'neuroglancer/ui/tool';\nimport {Borrowed, Owned, RefCounted} from 'neuroglancer/util/disposable';\nimport {BoundingBox, vec3} from 'neuroglancer/util/geom';\nimport {verifyObject, verifyObjectProperty, verifyOptionalBoolean, verifyOptionalString, verifyPositiveInt} from 'neuroglancer/util/json';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {addSignalBinding, removeSignalBinding, SignalBindingUpdater} from 'neuroglancer/util/signal_binding_updater';\nimport {Trackable} from 'neuroglancer/util/trackable';\nimport {Uint64} from 'neuroglancer/util/uint64';\nimport {VisibilityPriorityAggregator, WatchableVisibilityPriority} from 'neuroglancer/visibility_priority/frontend';\nimport {TabSpecification} from 'neuroglancer/widget/tab_view';\n\nexport enum RenderLayerRole {\n  DATA,\n  ANNOTATION,\n  DEFAULT_ANNOTATION,\n}\n\nexport function allRenderLayerRoles() {\n  return new WatchableSet(\n      [RenderLayerRole.DATA, RenderLayerRole.ANNOTATION, RenderLayerRole.DEFAULT_ANNOTATION]);\n}\n\nexport class RenderLayer extends RefCounted {\n  ready = false;\n  role: RenderLayerRole = RenderLayerRole.DATA;\n  layerChanged = new NullarySignal();\n  redrawNeeded = new NullarySignal();\n  readyStateChanged = new NullarySignal();\n  setReady(value: boolean) {\n    this.ready = value;\n    this.readyStateChanged.dispatch();\n    this.layerChanged.dispatch();\n  }\n\n  handleAction(_action: string) {\n    // Do nothing by default.\n  }\n\n  getValueAt(_x: Float32Array): any {\n    return undefined;\n  }\n\n  /**\n   * Base voxel size for this layer, in nanometers per voxel.\n   */\n  voxelSize: vec3|null = null;\n\n  /**\n   * Bounding box for this layer, in nanometers.\n   */\n  boundingBox: BoundingBox|null = null;\n\n  /**\n   * Transform the stored pickedValue and offset associated with the retrieved pick ID into the\n   * actual value.\n   */\n  transformPickedValue(pickedValue: Uint64, _pickedOffset: number): any {\n    return pickedValue;\n  }\n\n  /**\n   * Optionally updates the mouse state based on the retrived pick information.  This might snap the\n   * 3-d position to the center of the picked point.\n   */\n  updateMouseState(\n      _mouseState: MouseSelectionState, _pickedValue: Uint64, _pickedOffset: number, _data: any) {}\n}\n\n/**\n * Extends RenderLayer with functionality for tracking the number of panels in which the layer is\n * visible.\n */\nexport class VisibilityTrackedRenderLayer extends RenderLayer {\n  visibility = new VisibilityPriorityAggregator();\n}\n\nconst TAB_JSON_KEY = 'tab';\nconst TOOL_JSON_KEY = 'tool';\n\nexport class UserLayer extends RefCounted {\n  layersChanged = new NullarySignal();\n  readyStateChanged = new NullarySignal();\n  specificationChanged = new NullarySignal();\n  renderLayers = new Array<RenderLayer>();\n  isReady = false;\n  tabs = this.registerDisposer(new TabSpecification());\n  tool = this.registerDisposer(\n      new TrackableRefCounted<Tool>(value => restoreTool(this, value), value => value.toJSON()));\n  constructor(public manager: Borrowed<LayerListSpecification>, specification: any) {\n    super();\n    specification;\n    this.tabs.changed.add(this.specificationChanged.dispatch);\n    this.tool.changed.add(this.specificationChanged.dispatch);\n  }\n\n  restoreState(specification: any) {\n    this.tool.restoreState(specification[TOOL_JSON_KEY]);\n    this.tabs.restoreState(specification[TAB_JSON_KEY]);\n  }\n\n  addRenderLayer(layer: RenderLayer) {\n    this.renderLayers.push(layer);\n    const {layersChanged, readyStateChanged} = this;\n    layer.layerChanged.add(layersChanged.dispatch);\n    layer.readyStateChanged.add(readyStateChanged.dispatch);\n    readyStateChanged.dispatch();\n    layersChanged.dispatch();\n  }\n\n  removeRenderLayer(layer: RenderLayer) {\n    const {renderLayers, layersChanged, readyStateChanged} = this;\n    const index = renderLayers.indexOf(layer);\n    if (index === -1) {\n      throw new Error('Attempted to remove invalid RenderLayer');\n    }\n    renderLayers.splice(index, 1);\n    layer.layerChanged.remove(layersChanged.dispatch);\n    layer.readyStateChanged.remove(readyStateChanged.dispatch);\n    layer.dispose();\n    readyStateChanged.dispatch();\n    layersChanged.dispatch();\n  }\n\n  disposed() {\n    const {layersChanged, readyStateChanged} = this;\n    for (const layer of this.renderLayers) {\n      layer.layerChanged.remove(layersChanged.dispatch);\n      layer.readyStateChanged.remove(readyStateChanged.dispatch);\n      layer.dispose();\n    }\n    super.disposed();\n  }\n\n  getValueAt(position: Float32Array, pickState: PickState) {\n    let result: any;\n    let {renderLayers} = this;\n    let {pickedRenderLayer} = pickState;\n    if (pickedRenderLayer !== null && renderLayers.indexOf(pickedRenderLayer) !== -1) {\n      result =\n          pickedRenderLayer.transformPickedValue(pickState.pickedValue, pickState.pickedOffset);\n      return this.transformPickedValue(result);\n    }\n    for (let layer of renderLayers) {\n      if (!layer.ready) {\n        continue;\n      }\n      result = layer.getValueAt(position);\n      if (result !== undefined) {\n        break;\n      }\n    }\n    return this.transformPickedValue(result);\n  }\n\n  transformPickedValue(value: any) {\n    return value;\n  }\n\n  toJSON(): any {\n    return {\n      [TAB_JSON_KEY]: this.tabs.toJSON(),\n      [TOOL_JSON_KEY]: this.tool.toJSON(),\n    };\n  }\n\n  handleAction(_action: string): void {}\n}\n\nexport class ManagedUserLayer extends RefCounted {\n  readyStateChanged = new NullarySignal();\n  layerChanged = new NullarySignal();\n  specificationChanged = new NullarySignal();\n  wasDisposed = false;\n  private layer_: UserLayer|null = null;\n  get layer() {\n    return this.layer_;\n  }\n  private unregisterUserLayer: (() => void)|undefined;\n\n  /**\n   * If layer is not null, tranfers ownership of a reference.\n   */\n  set layer(layer: UserLayer|null) {\n    let oldLayer = this.layer_;\n    if (oldLayer != null) {\n      this.unregisterUserLayer!();\n      oldLayer.dispose();\n    }\n    this.layer_ = layer;\n    if (layer != null) {\n      const removers = [\n        layer.layersChanged.add(() => this.handleLayerChanged()),\n        layer.readyStateChanged.add(this.readyStateChanged.dispatch),\n        layer.specificationChanged.add(this.specificationChanged.dispatch)\n      ];\n      this.unregisterUserLayer = () => {\n        removers.forEach(x => x());\n      };\n      this.readyStateChanged.dispatch();\n      this.handleLayerChanged();\n    }\n  }\n\n  isReady() {\n    const {layer} = this;\n    return layer !== null && layer.isReady;\n  }\n\n  private name_: string;\n\n  get name() {\n    return this.name_;\n  }\n\n  set name(value: string) {\n    if (value !== this.name_) {\n      this.name_ = value;\n      this.layerChanged.dispatch();\n    }\n  }\n\n  /**\n   * If layer is not null, tranfers ownership of a reference.\n   */\n  constructor(name: string, layer: UserLayer|null = null, public visible: boolean = true) {\n    super();\n    this.name_ = name;\n    this.layer = layer;\n  }\n\n  private handleLayerChanged() {\n    if (this.visible) {\n      this.layerChanged.dispatch();\n    }\n  }\n  setVisible(value: boolean) {\n    if (value !== this.visible) {\n      this.visible = value;\n      this.layerChanged.dispatch();\n    }\n  }\n\n  disposed() {\n    this.wasDisposed = true;\n    this.layer = null;\n    super.disposed();\n  }\n}\n\nexport class LayerManager extends RefCounted {\n  managedLayers = new Array<Owned<ManagedUserLayer>>();\n  layerSet = new Set<Borrowed<ManagedUserLayer>>();\n  layersChanged = new NullarySignal();\n  readyStateChanged = new NullarySignal();\n  specificationChanged = new NullarySignal();\n  boundPositions = new WeakSet<SpatialPosition>();\n  numDirectUsers = 0;\n  private renderLayerToManagedLayerMapGeneration = -1;\n  private renderLayerToManagedLayerMap_ = new Map<RenderLayer, ManagedUserLayer>();\n\n  constructor() {\n    super();\n    this.layersChanged.add(this.scheduleRemoveLayersWithSingleRef);\n  }\n\n  private scheduleRemoveLayersWithSingleRef =\n      this.registerCancellable(debounce(() => this.removeLayersWithSingleRef(), 0));\n\n  get renderLayerToManagedLayerMap() {\n    const generation = this.layersChanged.count;\n    const map = this.renderLayerToManagedLayerMap_;\n    if (this.renderLayerToManagedLayerMapGeneration !== generation) {\n      this.renderLayerToManagedLayerMapGeneration = generation;\n      map.clear();\n      for (const managedLayer of this.managedLayers) {\n        const userLayer = managedLayer.layer;\n        if (userLayer !== null) {\n          for (const renderLayer of userLayer.renderLayers) {\n            map.set(renderLayer, managedLayer);\n          }\n        }\n      }\n    }\n    return map;\n  }\n\n  filter(predicate: (layer: ManagedUserLayer) => boolean) {\n    let changed = false;\n    this.managedLayers = this.managedLayers.filter(layer => {\n      if (!predicate(layer)) {\n        this.unbindManagedLayer(layer);\n        this.layerSet.delete(layer);\n        changed = true;\n        return false;\n      }\n      return true;\n    });\n    if (changed) {\n      this.layersChanged.dispatch();\n    }\n  }\n\n  private removeLayersWithSingleRef() {\n    if (this.numDirectUsers > 0) {\n      return;\n    }\n    this.filter(layer => layer.refCount !== 1);\n  }\n\n  private updateSignalBindings(\n      layer: ManagedUserLayer, callback: SignalBindingUpdater<() => void>) {\n    callback(layer.layerChanged, this.layersChanged.dispatch);\n    callback(layer.readyStateChanged, this.readyStateChanged.dispatch);\n    callback(layer.specificationChanged, this.specificationChanged.dispatch);\n  }\n\n  useDirectly() {\n    if (++this.numDirectUsers === 1) {\n      this.layersChanged.remove(this.scheduleRemoveLayersWithSingleRef);\n    }\n    return () => {\n      if (--this.numDirectUsers === 0) {\n        this.layersChanged.add(this.scheduleRemoveLayersWithSingleRef);\n        this.scheduleRemoveLayersWithSingleRef();\n      }\n    };\n  }\n\n  /**\n   * Assumes ownership of an existing reference to managedLayer.\n   */\n  addManagedLayer(managedLayer: ManagedUserLayer, index?: number|undefined) {\n    this.updateSignalBindings(managedLayer, addSignalBinding);\n    this.layerSet.add(managedLayer);\n    if (index === undefined) {\n      index = this.managedLayers.length;\n    }\n    this.managedLayers.splice(index, 0, managedLayer);\n    this.layersChanged.dispatch();\n    this.readyStateChanged.dispatch();\n    return managedLayer;\n  }\n\n  /**\n   * Assumes ownership of an existing reference to userLayer.\n   */\n  addUserLayer(name: string, userLayer: UserLayer, visible: boolean) {\n    let managedLayer = new ManagedUserLayer(name, userLayer, visible);\n    return this.addManagedLayer(managedLayer);\n  }\n\n  * readyRenderLayers() {\n    for (let managedUserLayer of this.managedLayers) {\n      if (!managedUserLayer.visible || !managedUserLayer.layer) {\n        continue;\n      }\n      for (let renderLayer of managedUserLayer.layer.renderLayers) {\n        if (!renderLayer.ready) {\n          continue;\n        }\n        yield renderLayer;\n      }\n    }\n  }\n\n  unbindManagedLayer(managedLayer: ManagedUserLayer) {\n    this.updateSignalBindings(managedLayer, removeSignalBinding);\n    managedLayer.dispose();\n  }\n\n  clear() {\n    for (let managedLayer of this.managedLayers) {\n      this.unbindManagedLayer(managedLayer);\n    }\n    this.managedLayers.length = 0;\n    this.layerSet.clear();\n    this.layersChanged.dispatch();\n  }\n\n  remove(index: number) {\n    const layer = this.managedLayers[index];\n    this.unbindManagedLayer(layer);\n    this.managedLayers.splice(index, 1);\n    this.layerSet.delete(layer);\n    this.layersChanged.dispatch();\n  }\n\n  removeManagedLayer(managedLayer: ManagedUserLayer) {\n    let index = this.managedLayers.indexOf(managedLayer);\n    if (index === -1) {\n      throw new Error(`Internal error: invalid managed layer.`);\n    }\n    this.remove(index);\n  }\n\n  reorderManagedLayer(oldIndex: number, newIndex: number) {\n    const numLayers = this.managedLayers.length;\n    if (oldIndex === newIndex || oldIndex < 0 || oldIndex >= numLayers || newIndex < 0 ||\n        newIndex >= numLayers) {\n      // Don't do anything.\n      return;\n    }\n    let [oldLayer] = this.managedLayers.splice(oldIndex, 1);\n    this.managedLayers.splice(newIndex, 0, oldLayer);\n    this.layersChanged.dispatch();\n  }\n\n  disposed() {\n    this.clear();\n    super.disposed();\n  }\n\n  getLayerByName(name: string) {\n    return this.managedLayers.find(x => x.name === name);\n  }\n\n  getUniqueLayerName(name: string) {\n    let suggestedName = name;\n    let suffix = 0;\n    while (this.getLayerByName(suggestedName) !== undefined) {\n      suggestedName = name + (++suffix);\n    }\n    return suggestedName;\n  }\n\n  has(layer: Borrowed<ManagedUserLayer>) {\n    return this.layerSet.has(layer);\n  }\n\n  /**\n   * Asynchronously initialize the voxelSize and position based on the managed layers.\n   *\n   * The first ready layer with an associated bounding box will set the position to the center of\n   * the bounding box.\n   *\n   * If the position later becomes invalid, it will be initialized again.\n   */\n  initializePosition(position: SpatialPosition) {\n    let {boundPositions} = this;\n    if (boundPositions.has(position)) {\n      return;\n    }\n    boundPositions.add(position);\n\n    // Deboucne to ensure that if the position is reset and the layers are reset immediately after,\n    // the position will not be reinitialized based on the soon to be reset layers.\n    const handler = debounce(() => {\n      this.updatePositionFromLayers(position);\n    });\n    this.readyStateChanged.add(handler);\n    position.changed.add(handler);\n    this.updatePositionFromLayers(position);\n  }\n\n  updatePositionFromLayers(position: SpatialPosition) {\n    if (position.valid) {\n      return;\n    }\n    for (let managedLayer of this.managedLayers) {\n      let userLayer = managedLayer.layer;\n      if (userLayer == null) {\n        continue;\n      }\n      for (let renderLayer of userLayer.renderLayers) {\n        if (!renderLayer.ready) {\n          continue;\n        }\n        if (!position.voxelSize.valid && renderLayer.voxelSize != null) {\n          vec3.copy(position.voxelSize.size, renderLayer.voxelSize);\n          position.voxelSize.setValid();\n        }\n\n        if (!position.spatialCoordinatesValid && !position.voxelCoordinatesValid &&\n            renderLayer.boundingBox != null) {\n          let boundingBox = renderLayer.boundingBox;\n          let centerPosition = position.spatialCoordinates;\n          vec3.add(centerPosition, boundingBox.lower, boundingBox.upper);\n          vec3.scale(centerPosition, centerPosition, 0.5);\n          position.spatialCoordinatesValid = true;\n          position.changed.dispatch();\n        }\n      }\n    }\n  }\n\n  get renderLayers() {\n    let layerManager = this;\n    return {\n      * [Symbol.iterator]() {\n          for (let managedLayer of layerManager.managedLayers) {\n            if (managedLayer.layer === null) {\n              continue;\n            }\n            for (let renderLayer of managedLayer.layer.renderLayers) {\n              yield renderLayer;\n            }\n          }\n        }\n    };\n  }\n\n  get visibleRenderLayers() {\n    let layerManager = this;\n    return {\n      * [Symbol.iterator]() {\n          for (let managedLayer of layerManager.managedLayers) {\n            if (managedLayer.layer === null || !managedLayer.visible) {\n              continue;\n            }\n            for (let renderLayer of managedLayer.layer.renderLayers) {\n              yield renderLayer;\n            }\n          }\n        }\n    };\n  }\n\n  invokeAction(action: string) {\n    for (let managedLayer of this.managedLayers) {\n      if (managedLayer.layer === null || !managedLayer.visible) {\n        continue;\n      }\n      let userLayer = managedLayer.layer;\n      userLayer.handleAction(action);\n      for (let renderLayer of userLayer.renderLayers) {\n        if (!renderLayer.ready) {\n          continue;\n        }\n        renderLayer.handleAction(action);\n      }\n    }\n  }\n}\n\nexport interface PickState {\n  pickedRenderLayer: RenderLayer|null;\n  pickedValue: Uint64;\n  pickedOffset: number;\n}\n\nexport class MouseSelectionState implements PickState {\n  changed = new NullarySignal();\n  position = vec3.create();\n  active = false;\n  pickedRenderLayer: RenderLayer|null = null;\n  pickedValue = new Uint64(0, 0);\n  pickedOffset = 0;\n  pickedAnnotationLayer: AnnotationLayerState|undefined = undefined;\n  pickedAnnotationId: string|undefined = undefined;\n  pickedAnnotationBuffer: ArrayBuffer|undefined = undefined;\n  pickedAnnotationBufferOffset: number|undefined = undefined;\n  pageX: number;\n  pageY: number;\n\n  private forcerFunction: (() => void)|undefined = undefined;\n\n  removeForcer(forcer: (() => void)) {\n    if (forcer === this.forcerFunction) {\n      this.forcerFunction = undefined;\n      this.setActive(false);\n    }\n  }\n\n  setForcer(forcer: (() => void)|undefined) {\n    this.forcerFunction = forcer;\n    if (forcer === undefined) {\n      this.setActive(false);\n    }\n  }\n\n  updateUnconditionally(): boolean {\n    const {forcerFunction} = this;\n    if (forcerFunction === undefined) {\n      return false;\n    }\n    forcerFunction();\n    return this.active;\n  }\n\n  setActive(value: boolean) {\n    if (this.active !== value || value === true) {\n      this.active = value;\n      this.changed.dispatch();\n    }\n  }\n}\n\nexport class LayerSelectedValues extends RefCounted {\n  values = new Map<UserLayer, any>();\n  changed = new NullarySignal();\n  needsUpdate = true;\n  constructor(public layerManager: LayerManager, public mouseState: MouseSelectionState) {\n    super();\n    this.registerDisposer(mouseState.changed.add(() => {\n      this.handleChange();\n    }));\n    this.registerDisposer(layerManager.layersChanged.add(() => {\n      this.handleLayerChange();\n    }));\n  }\n\n  /**\n   * This should be called when the layer data may have changed, due to the set of managed layers\n   * changing or new data having been received.\n   */\n  handleLayerChange() {\n    if (this.mouseState.active) {\n      this.handleChange();\n    }\n  }\n\n  handleChange() {\n    this.needsUpdate = true;\n    this.changed.dispatch();\n  }\n\n  update() {\n    if (!this.needsUpdate) {\n      return;\n    }\n    this.needsUpdate = false;\n    let values = this.values;\n    let mouseState = this.mouseState;\n    values.clear();\n    if (mouseState.active) {\n      let position = mouseState.position;\n      for (let layer of this.layerManager.managedLayers) {\n        let userLayer = layer.layer;\n        if (layer.visible && userLayer) {\n          values.set(userLayer, userLayer.getValueAt(position, mouseState));\n        }\n      }\n    }\n  }\n\n  get(userLayer: UserLayer) {\n    this.update();\n    return this.values.get(userLayer);\n  }\n\n  toJSON() {\n    this.update();\n    const result: {[key: string]: any} = {};\n    const {values} = this;\n    for (const layer of this.layerManager.managedLayers) {\n      const userLayer = layer.layer;\n      if (userLayer) {\n        let v = values.get(userLayer);\n        if (v !== undefined) {\n          if (v instanceof Uint64) {\n            v = {'t': 'u64', 'v': v};\n          }\n          result[layer.name] = v;\n        }\n      }\n    }\n    return result;\n  }\n}\n\nexport class VisibleRenderLayerTracker<RenderLayerType extends VisibilityTrackedRenderLayer> extends\n    RefCounted {\n  /**\n   * Maps a layer to the disposer to call when it is no longer visible.\n   */\n  private visibleLayers = new Map<RenderLayerType, () => void>();\n  private newVisibleLayers = new Set<RenderLayerType>();\n\n  private debouncedUpdateVisibleLayers =\n      this.registerCancellable(debounce(() => this.updateVisibleLayers(), 0));\n\n  constructor(\n      public layerManager: LayerManager,\n      public renderLayerType: {new(...args: any[]): RenderLayerType},\n      public roles: WatchableSet<RenderLayerRole>,\n      private layerAdded: (layer: RenderLayerType) => (() => void),\n      public visibility: WatchableVisibilityPriority) {\n    super();\n    this.registerDisposer(layerManager.layersChanged.add(this.debouncedUpdateVisibleLayers));\n    this.registerDisposer(roles.changed.add(this.debouncedUpdateVisibleLayers));\n    this.updateVisibleLayers();\n  }\n\n  disposed() {\n    this.visibleLayers.forEach(disposer => disposer());\n    this.visibleLayers.clear();\n    super.disposed();\n  }\n\n  private updateVisibleLayers() {\n    let {visibleLayers, newVisibleLayers, renderLayerType, layerAdded, roles} = this;\n    for (let renderLayer of this.layerManager.readyRenderLayers()) {\n      if (renderLayer instanceof renderLayerType && roles.has(renderLayer.role)) {\n        let typedLayer = <RenderLayerType>renderLayer;\n        newVisibleLayers.add(typedLayer);\n        if (!visibleLayers.has(typedLayer)) {\n          const visibilityDisposer = typedLayer.visibility.add(this.visibility);\n          const disposer = layerAdded(typedLayer);\n          visibleLayers.set(typedLayer.addRef(), () => {\n            disposer();\n            visibilityDisposer();\n            typedLayer.dispose();\n          });\n        }\n      }\n    }\n    for (let [renderLayer, disposer] of visibleLayers) {\n      if (!newVisibleLayers.has(renderLayer)) {\n        visibleLayers.delete(renderLayer);\n        disposer();\n      }\n    }\n    newVisibleLayers.clear();\n  }\n\n  getVisibleLayers() {\n    (<any>this.debouncedUpdateVisibleLayers).flush();\n    return [...this.visibleLayers.keys()];\n  }\n}\n\nexport function\nmakeRenderedPanelVisibleLayerTracker<RenderLayerType extends VisibilityTrackedRenderLayer>(\n    layerManager: LayerManager, renderLayerType: {new (...args: any[]): RenderLayerType},\n    roles: WatchableSet<RenderLayerRole>, panel: RenderedPanel,\n    layerAdded?: (layer: RenderLayerType) => ((() => void) | void)) {\n  return panel.registerDisposer(\n      new VisibleRenderLayerTracker(layerManager, renderLayerType, roles, layer => {\n        const disposer = layer.redrawNeeded.add(() => panel.scheduleRedraw());\n        const disposer2 = layerAdded && layerAdded(layer);\n        panel.scheduleRedraw();\n        return () => {\n          if (disposer2 !== undefined) {\n            disposer2();\n          }\n          disposer();\n          panel.scheduleRedraw();\n        };\n      }, panel.visibility));\n}\n\nexport class SelectedLayerState extends RefCounted implements Trackable {\n  changed = new NullarySignal();\n  visible_ = false;\n  layer_: ManagedUserLayer|undefined;\n  size = new TrackableValue<number>(300, verifyPositiveInt)\n\n  get layer() {\n    return this.layer_;\n  }\n\n  get visible() {\n    return this.visible_;\n  }\n\n  set visible(value: boolean) {\n    if (this.layer_ === undefined) {\n      value = false;\n    }\n    if (this.visible_ !== value) {\n      this.visible_ = value;\n      this.changed.dispatch();\n    }\n  }\n\n  private existingLayerDisposer?: () => void;\n\n  constructor(public layerManager: Owned<LayerManager>) {\n    super();\n    this.registerDisposer(layerManager);\n    this.size.changed.add(this.changed.dispatch);\n  }\n\n  set layer(layer: ManagedUserLayer|undefined) {\n    if (layer === this.layer_) {\n      return;\n    }\n    if (this.layer_ !== undefined) {\n      this.existingLayerDisposer!();\n      this.existingLayerDisposer = undefined;\n    }\n    this.layer_ = layer;\n    if (layer !== undefined) {\n      const layerDisposed = () => {\n        this.layer_ = undefined;\n        this.visible = false;\n        this.existingLayerDisposer = undefined;\n        this.changed.dispatch();\n      };\n      layer.registerDisposer(layerDisposed);\n      const layerChangedDisposer = layer.specificationChanged.add(() => {\n        this.changed.dispatch();\n      });\n      this.existingLayerDisposer = () => {\n        const userLayer = layer.layer;\n        if (userLayer !== null) {\n          const tool = userLayer.tool.value;\n          if (tool !== undefined) {\n            tool.deactivate();\n          }\n        }\n        layer.unregisterDisposer(layerDisposed);\n        layerChangedDisposer();\n      };\n    } else {\n      this.visible_ = false;\n    }\n    this.changed.dispatch();\n  }\n\n  toJSON() {\n    if (this.layer === undefined) {\n      return undefined;\n    }\n    return {\n      'layer': this.layer.name,\n      'visible': this.visible === true ? true : undefined,\n      'size': this.size.toJSON(),\n    };\n  }\n\n  restoreState(obj: any) {\n    if (obj === undefined) {\n      this.reset();\n      return;\n    }\n    verifyObject(obj);\n    const layerName = verifyObjectProperty(obj, 'layer', verifyOptionalString);\n    const layer = layerName !== undefined ? this.layerManager.getLayerByName(layerName) : undefined;\n    this.layer = layer;\n    this.visible = verifyObjectProperty(obj, 'visible', verifyOptionalBoolean) ? true : false;\n    verifyObjectProperty(obj, 'size', x => this.size.restoreState(x));\n  }\n\n  reset() {\n    this.layer = undefined;\n  }\n}\n\nexport class LayerReference extends RefCounted implements Trackable {\n  private layerName_: string|undefined;\n  private layer_: ManagedUserLayer|undefined;\n  changed = new NullarySignal();\n  constructor(\n      public layerManager: Owned<LayerManager>,\n      public filter: (layer: ManagedUserLayer) => boolean) {\n    super();\n    this.registerDisposer(layerManager);\n    this.registerDisposer(layerManager.specificationChanged.add(() => {\n      const {layer_} = this;\n      if (layer_ !== undefined) {\n        if (!this.layerManager.layerSet.has(layer_) || !this.filter(layer_)) {\n          this.layer_ = undefined;\n          this.layerName_ = undefined;\n          this.changed.dispatch();\n        } else {\n          const {name} = layer_;\n          if (name !== this.layerName_) {\n            this.layerName_ = name;\n            this.changed.dispatch();\n          }\n        }\n      }\n    }));\n  }\n\n  get layer() {\n    return this.layer_;\n  }\n\n  get layerName() {\n    return this.layerName_;\n  }\n\n  set layer(value: ManagedUserLayer|undefined) {\n    if (this.layer_ === value) {\n      return;\n    }\n    if (value !== undefined && this.layerManager.layerSet.has(value) && this.filter(value)) {\n      this.layer_ = value;\n      this.layerName_ = value.name;\n    } else {\n      this.layer_ = undefined;\n      this.layerName_ = undefined;\n    }\n    this.changed.dispatch();\n  }\n\n  set layerName(value: string|undefined) {\n    if (value === this.layerName_) {\n      return;\n    }\n    this.layer_ = undefined;\n    this.layerName_ = value;\n    this.changed.dispatch();\n    this.validate();\n  }\n\n  private validate = debounce(() => {\n    const {layerName_} = this;\n    if (layerName_ !== undefined) {\n      const layer = this.layerManager.getLayerByName(layerName_);\n      if (layer !== undefined && this.filter(layer)) {\n        this.layer_ = layer;\n        this.changed.dispatch();\n      } else {\n        this.layer_ = undefined;\n        this.layerName_ = undefined;\n        this.changed.dispatch();\n      }\n    }\n  }, 0);\n\n  restoreState(obj: any) {\n    const layerName = verifyOptionalString(obj);\n    this.layerName = layerName;\n  }\n\n  toJSON() {\n    const {layer_} = this;\n    if (layer_ !== undefined) {\n      return layer_.name;\n    }\n    return this.layerName_;\n  }\n\n  reset() {\n    this.layerName_ = undefined;\n    this.layer_ = undefined;\n    this.changed.dispatch();\n  }\n}\n","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {LayerListSpecification, ManagedUserLayerWithSpecification} from 'neuroglancer/layer_specification';\nimport {Overlay} from 'neuroglancer/overlay';\nimport {DataType, VolumeType} from 'neuroglancer/sliceview/volume/base';\nimport {CancellationToken, CancellationTokenSource} from 'neuroglancer/util/cancellation';\nimport {associateLabelWithElement} from 'neuroglancer/widget/associate_label';\nimport {AutocompleteTextInput, makeCompletionElementWithDescription} from 'neuroglancer/widget/autocomplete';\nimport {makeHiddenSubmitButton} from 'neuroglancer/widget/hidden_submit_button';\n\nimport './layer_dialog.css';\n\nexport class LayerDialog extends Overlay {\n  /**\n   * Used for displaying status information.\n   */\n  statusElement = document.createElement('div');\n\n  sourceInput: AutocompleteTextInput;\n  submitElement = document.createElement('button');\n  namePromptElement = document.createElement('label');\n  nameInputElement = document.createElement('input');\n  volumeCancellationSource: CancellationTokenSource|undefined = undefined;\n  sourceValid: boolean = false;\n  nameValid: boolean = true;\n\n  constructor(\n      public manager: LayerListSpecification,\n      public existingLayer?: ManagedUserLayerWithSpecification) {\n    super();\n    let dialogElement = this.content;\n    dialogElement.classList.add('add-layer-overlay');\n\n    let sourceCompleter = (value: string, cancellationToken: CancellationToken) =>\n        this.manager.dataSourceProvider\n            .volumeCompleter(value, this.manager.chunkManager, cancellationToken)\n            .then(originalResult => ({\n                    completions: originalResult.completions,\n                    makeElement: makeCompletionElementWithDescription,\n                    offset: originalResult.offset,\n                    showSingleResult: true,\n                  }));\n    let sourceForm = document.createElement('form');\n    sourceForm.className = 'source-form';\n    this.registerEventListener(sourceForm, 'submit', (event: Event) => {\n      event.preventDefault();\n      this.validateSource(/*focusName=*/true);\n    });\n\n    let sourcePrompt = document.createElement('label');\n    sourcePrompt.textContent = 'Source:';\n    let sourceInput = this.sourceInput =\n        this.registerDisposer(new AutocompleteTextInput({completer: sourceCompleter, delay: 0}));\n    sourceInput.element.classList.add('add-layer-source');\n    sourceInput.inputElement.addEventListener('blur', () => {\n      this.validateSource(/*focusName=*/false);\n    });\n    this.submitElement.disabled = true;\n    sourceInput.inputChanged.add(() => {\n      const {volumeCancellationSource} = this;\n      if (volumeCancellationSource !== undefined) {\n        volumeCancellationSource.cancel();\n        this.volumeCancellationSource = undefined;\n      }\n      this.sourceValid = false;\n      this.submitElement.disabled = true;\n      this.statusElement.textContent = '';\n    });\n    sourceForm.appendChild(sourcePrompt);\n    sourceForm.appendChild(sourceInput.element);\n    associateLabelWithElement(sourcePrompt, sourceInput.inputElement);\n    let hiddenSourceSubmit = makeHiddenSubmitButton();\n    sourceForm.appendChild(hiddenSourceSubmit);\n\n    dialogElement.appendChild(sourceForm);\n\n    let {statusElement, namePromptElement, nameInputElement, submitElement} = this;\n    statusElement.className = 'dialog-status';\n\n    let nameForm = document.createElement('form');\n    nameForm.className = 'name-form';\n    namePromptElement.textContent = 'Name:';\n    nameInputElement.className = 'add-layer-name';\n    nameInputElement.autocomplete = 'off';\n    nameInputElement.spellcheck = false;\n\n    nameInputElement.type = 'text';\n\n    this.registerEventListener(nameInputElement, 'input', () => {\n      this.validateName();\n    });\n\n    submitElement.type = 'submit';\n\n    associateLabelWithElement(namePromptElement, nameInputElement);\n\n    nameForm.appendChild(namePromptElement);\n    nameForm.appendChild(nameInputElement);\n    nameForm.appendChild(submitElement);\n    dialogElement.appendChild(nameForm);\n\n    dialogElement.appendChild(statusElement);\n\n    if (existingLayer !== undefined) {\n      if (existingLayer.sourceUrl !== undefined) {\n        sourceInput.value = existingLayer.sourceUrl;\n        this.validateSource();\n      } else {\n        this.sourceValid = true;\n      }\n      sourceInput.disabled = true;\n      nameInputElement.value = existingLayer.name;\n      this.validateName();\n      submitElement.textContent = 'Save';\n      nameInputElement.focus();\n    } else {\n      let {managedLayers} = this.manager.layerManager;\n      for (let hintLayerIndex = managedLayers.length - 1; hintLayerIndex >= 0; --hintLayerIndex) {\n        const hintLayer = managedLayers[hintLayerIndex];\n        if (!(hintLayer instanceof ManagedUserLayerWithSpecification)) continue;\n        const {sourceUrl} = hintLayer;\n        if (sourceUrl === undefined) continue;\n        try {\n          let groupIndex = this.manager.dataSourceProvider.findSourceGroup(sourceUrl);\n          sourceInput.value = sourceUrl.substring(0, groupIndex);\n          sourceInput.inputElement.setSelectionRange(0, groupIndex);\n          break;\n        } catch {\n        }\n      }\n      sourceInput.inputElement.focus();\n      submitElement.textContent = 'Add Layer';\n    }\n\n    this.registerEventListener(nameForm, 'submit', (event: Event) => {\n      event.preventDefault();\n      this.submit();\n    });\n  }\n\n  isNameValid() {\n    let name = this.nameInputElement.value;\n    if (name === '') {\n      return false;\n    }\n    let otherLayer = this.manager.layerManager.getLayerByName(name);\n    return otherLayer === undefined || otherLayer === this.existingLayer;\n  }\n\n  submit() {\n    if (this.sourceValid && this.isNameValid()) {\n      if (this.existingLayer) {\n        this.existingLayer.name = this.nameInputElement.value;\n        this.manager.layerManager.layersChanged.dispatch();\n      } else {\n        this.manager.add(\n            this.manager.getLayer(this.nameInputElement.value, this.sourceInput.value));\n      }\n      this.dispose();\n    }\n  }\n\n  validateName() {\n    let {nameInputElement} = this;\n    let nameValid = this.nameValid = this.isNameValid();\n    if (nameValid) {\n      nameInputElement.classList.add('valid-input');\n      nameInputElement.classList.remove('invalid-input');\n    } else {\n      nameInputElement.classList.remove('valid-input');\n      nameInputElement.classList.add('invalid-input');\n    }\n    this.validityChanged();\n  }\n\n  validityChanged() {\n    this.submitElement.disabled = !(this.nameValid && this.sourceValid);\n  }\n\n  validateSource(focusName: boolean = false) {\n    let url = this.sourceInput.value;\n    if (url === '') {\n      return;\n    }\n    try {\n      let baseSuggestedName = this.manager.dataSourceProvider.suggestLayerName(url);\n      let {nameInputElement} = this;\n      if (this.nameInputElement.value === '') {\n        let suggestedName = this.manager.layerManager.getUniqueLayerName(baseSuggestedName);\n        nameInputElement.value = suggestedName;\n        nameInputElement.setSelectionRange(0, suggestedName.length);\n        this.validateName();\n      }\n      if (focusName) {\n        nameInputElement.focus();\n      }\n    } catch (error) {\n      this.setError(error.message);\n      return;\n    }\n\n    this.setInfo('Validating volume source...');\n    const token = this.volumeCancellationSource = new CancellationTokenSource();\n    this.manager.dataSourceProvider\n        .getVolume(\n            this.manager.chunkManager, url, /*options=*/undefined, token)\n        .then(source => {\n          if (token.isCanceled) {\n            return;\n          }\n          this.volumeCancellationSource = undefined;\n          this.sourceValid = true;\n          this.setInfo(\n              `${VolumeType[source.volumeType].toLowerCase()}: ` +\n              `${source.numChannels}-channel ${DataType[source.dataType].toLowerCase()}`);\n          this.validityChanged();\n        })\n        .catch((reason: Error) => {\n          if (token.isCanceled) {\n            return;\n          }\n          this.volumeCancellationSource = undefined;\n          this.setError(reason.message);\n        });\n  }\n\n  setInfo(message: string) {\n    this.statusElement.className = 'dialog-status dialog-status-info';\n    this.statusElement.textContent = message;\n  }\n\n  setError(message: string) {\n    this.statusElement.className = 'dialog-status dialog-status-error';\n    this.statusElement.textContent = message;\n  }\n}\n","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Viewer for a group of layers.\n */\n\nimport debounce from 'lodash/debounce';\nimport {DataPanelLayoutContainer, InputEventBindings as DataPanelInputEventBindings} from 'neuroglancer/data_panel_layout';\nimport {DisplayContext} from 'neuroglancer/display_context';\nimport {MouseSelectionState, RenderLayerRole, SelectedLayerState} from 'neuroglancer/layer';\nimport {LayerPanel} from 'neuroglancer/layer_panel';\nimport {LayerListSpecification, LayerSubsetSpecification, ManagedUserLayerWithSpecification} from 'neuroglancer/layer_specification';\nimport {LinkedOrientationState, LinkedSpatialPosition, LinkedZoomState, NavigationState, Pose, TrackableNavigationLink} from 'neuroglancer/navigation_state';\nimport {TrackableBoolean} from 'neuroglancer/trackable_boolean';\nimport {WatchableSet, WatchableValueInterface} from 'neuroglancer/trackable_value';\nimport {ContextMenu} from 'neuroglancer/ui/context_menu';\nimport {endLayerDrag, startLayerDrag} from 'neuroglancer/ui/layer_drag_and_drop';\nimport {setupPositionDropHandlers} from 'neuroglancer/ui/position_drag_and_drop';\nimport {AutomaticallyFocusedElement} from 'neuroglancer/util/automatic_focus';\nimport {TrackableRGB} from 'neuroglancer/util/color';\nimport {Borrowed, Owned, RefCounted} from 'neuroglancer/util/disposable';\nimport {removeChildren} from 'neuroglancer/util/dom';\nimport {registerActionListener} from 'neuroglancer/util/event_action_map';\nimport {CompoundTrackable} from 'neuroglancer/util/trackable';\nimport {WatchableVisibilityPriority} from 'neuroglancer/visibility_priority/frontend';\nimport {EnumSelectWidget} from 'neuroglancer/widget/enum_widget';\nimport {TrackableScaleBarOptions} from 'neuroglancer/widget/scale_bar';\n\nimport './layer_group_viewer.css';\n\nexport interface LayerGroupViewerState {\n  display: Borrowed<DisplayContext>;\n  navigationState: Owned<NavigationState>;\n  perspectiveNavigationState: Owned<NavigationState>;\n  mouseState: MouseSelectionState;\n  showAxisLines: TrackableBoolean;\n  showScaleBar: TrackableBoolean;\n  scaleBarOptions: TrackableScaleBarOptions;\n  showPerspectiveSliceViews: TrackableBoolean;\n  layerSpecification: Owned<LayerListSpecification>;\n  inputEventBindings: DataPanelInputEventBindings;\n  visibility: WatchableVisibilityPriority;\n  selectedLayer: SelectedLayerState;\n  visibleLayerRoles: WatchableSet<RenderLayerRole>;\n  crossSectionBackgroundColor: TrackableRGB;\n  perspectiveViewBackgroundColor: TrackableRGB;\n}\n\nexport interface LayerGroupViewerOptions {\n  showLayerPanel: WatchableValueInterface<boolean>;\n  showViewerMenu: boolean;\n}\n\nexport const viewerDragType = 'neuroglancer-layer-group-viewer';\n\nexport function hasViewerDrag(event: DragEvent) {\n  return event.dataTransfer!.types.indexOf(viewerDragType) !== -1;\n}\n\nlet dragSource: {viewer: LayerGroupViewer, disposer: () => void}|undefined;\n\nexport function getCompatibleViewerDragSource(manager: Borrowed<LayerListSpecification>):\n    LayerGroupViewer|undefined {\n  if (dragSource && dragSource.viewer.layerSpecification.rootLayers === manager.rootLayers) {\n    return dragSource.viewer;\n  } else {\n    return undefined;\n  }\n}\n\nfunction getDefaultViewerDropEffect(manager: Borrowed<LayerListSpecification>): 'move'|'copy' {\n  if (getCompatibleViewerDragSource(manager) !== undefined) {\n    return 'move';\n  } else {\n    return 'copy';\n  }\n}\n\nexport function getViewerDropEffect(\n    event: DragEvent, manager: Borrowed<LayerListSpecification>): 'move'|'copy' {\n  if (event.shiftKey) {\n    return 'copy';\n  } else if (event.ctrlKey) {\n    return 'move';\n  } else {\n    return getDefaultViewerDropEffect(manager);\n  }\n}\n\nexport class LinkedViewerNavigationState extends RefCounted {\n  position: LinkedSpatialPosition;\n  crossSectionOrientation: LinkedOrientationState;\n  crossSectionZoom: LinkedZoomState;\n  perspectiveOrientation: LinkedOrientationState;\n  perspectiveZoom: LinkedZoomState;\n\n  navigationState: NavigationState;\n  perspectiveNavigationState: NavigationState;\n\n  constructor(parent: {\n    navigationState: Borrowed<NavigationState>,\n    perspectiveNavigationState: Borrowed<NavigationState>\n  }) {\n    super();\n    this.position = new LinkedSpatialPosition(parent.navigationState.position.addRef());\n    this.crossSectionOrientation =\n        new LinkedOrientationState(parent.navigationState.pose.orientation.addRef());\n    this.crossSectionZoom = new LinkedZoomState(parent.navigationState.zoomFactor.addRef());\n    this.navigationState = this.registerDisposer(new NavigationState(\n        new Pose(this.position.value, this.crossSectionOrientation.value),\n        this.crossSectionZoom.value));\n    this.perspectiveOrientation =\n        new LinkedOrientationState(parent.perspectiveNavigationState.pose.orientation.addRef());\n    this.perspectiveZoom =\n        new LinkedZoomState(parent.perspectiveNavigationState.zoomFactor.addRef());\n    this.perspectiveNavigationState = this.registerDisposer(new NavigationState(\n        new Pose(this.position.value.addRef(), this.perspectiveOrientation.value),\n        this.perspectiveZoom.value));\n  }\n\n  copyToParent() {\n    for (const x\n             of [this.position, this.crossSectionOrientation, this.crossSectionZoom,\n                 this.perspectiveOrientation, this.perspectiveZoom]) {\n      x.copyToPeer();\n    }\n  }\n\n  register(state: CompoundTrackable) {\n    state.add('position', this.position);\n    state.add('crossSectionOrientation', this.crossSectionOrientation);\n    state.add('crossSectionZoom', this.crossSectionZoom);\n    state.add('perspectiveOrientation', this.perspectiveOrientation);\n    state.add('perspectiveZoom', this.perspectiveZoom);\n  }\n}\n\n\nfunction makeViewerMenu(parent: HTMLElement, viewer: LayerGroupViewer) {\n  const contextMenu = new ContextMenu(parent);\n  const menu = contextMenu.element;\n  menu.classList.add('neuroglancer-layer-group-viewer-context-menu');\n  const closeButton = document.createElement('button');\n  closeButton.textContent = 'Remove layer group';\n  menu.appendChild(closeButton);\n  contextMenu.registerEventListener(closeButton, 'click', () => {\n    viewer.layerSpecification.layerManager.clear();\n  });\n  const {viewerNavigationState} = viewer;\n  for (const [name, model] of <[string, TrackableNavigationLink][]>[\n         ['Position', viewerNavigationState.position.link],\n         ['Cross-section orientation', viewerNavigationState.crossSectionOrientation.link],\n         ['Cross-section zoom', viewerNavigationState.crossSectionZoom.link],\n         ['Perspective orientation', viewerNavigationState.perspectiveOrientation.link],\n         ['Perspective zoom', viewerNavigationState.perspectiveZoom.link],\n       ]) {\n    const widget = contextMenu.registerDisposer(new EnumSelectWidget(model));\n    const label = document.createElement('label');\n    label.style.display = 'flex';\n    label.style.flexDirection = 'row';\n    label.style.whiteSpace = 'nowrap';\n    label.textContent = name;\n    label.appendChild(widget.element);\n    menu.appendChild(label);\n  }\n  return contextMenu;\n}\n\nexport class LayerGroupViewer extends RefCounted {\n  layerSpecification: LayerListSpecification;\n  viewerNavigationState: LinkedViewerNavigationState;\n  get perspectiveNavigationState() {\n    return this.viewerNavigationState.perspectiveNavigationState;\n  }\n  get navigationState() {\n    return this.viewerNavigationState.navigationState;\n  }\n\n  // FIXME: don't make viewerState a property, just make these things properties directly\n  get display() {\n    return this.viewerState.display;\n  }\n  get selectedLayer() {\n    return this.viewerState.selectedLayer;\n  }\n  get layerManager() {\n    return this.layerSpecification.layerManager;\n  }\n\n  get chunkManager() {\n    return this.layerSpecification.chunkManager;\n  }\n  get mouseState() {\n    return this.viewerState.mouseState;\n  }\n  get showAxisLines() {\n    return this.viewerState.showAxisLines;\n  }\n  get showScaleBar() {\n    return this.viewerState.showScaleBar;\n  }\n  get showPerspectiveSliceViews() {\n    return this.viewerState.showPerspectiveSliceViews;\n  }\n  get inputEventBindings() {\n    return this.viewerState.inputEventBindings;\n  }\n  get visibility() {\n    return this.viewerState.visibility;\n  }\n  get visibleLayerRoles() {\n    return this.viewerState.visibleLayerRoles;\n  }\n  get crossSectionBackgroundColor() {\n    return this.viewerState.crossSectionBackgroundColor;\n  }\n  get perspectiveViewBackgroundColor() {\n    return this.viewerState.perspectiveViewBackgroundColor;\n  }\n  get scaleBarOptions() {\n    return this.viewerState.scaleBarOptions;\n  }\n  layerPanel: LayerPanel|undefined;\n  layout: DataPanelLayoutContainer;\n\n  options: LayerGroupViewerOptions;\n\n  state = new CompoundTrackable();\n\n  get changed() {\n    return this.state.changed;\n  }\n\n  constructor(\n      public element: HTMLElement, public viewerState: LayerGroupViewerState,\n      options: Partial<LayerGroupViewerOptions> = {}) {\n    super();\n    this.options = {showLayerPanel: new TrackableBoolean(true), showViewerMenu: false, ...options};\n    this.layerSpecification = this.registerDisposer(viewerState.layerSpecification);\n    this.viewerNavigationState =\n        this.registerDisposer(new LinkedViewerNavigationState(viewerState));\n    this.viewerNavigationState.register(this.state);\n    if (!(this.layerSpecification instanceof LayerSubsetSpecification)) {\n      this.state.add('layers', {\n        changed: this.layerSpecification.changed,\n        toJSON: () => this.layerSpecification.layerManager.managedLayers.map(x => x.name),\n        reset: () => {\n          throw new Error('not implemented');\n        },\n        restoreState: () => {\n          throw new Error('not implemented');\n        }\n      });\n    } else {\n      this.state.add('layers', this.layerSpecification);\n    }\n    element.classList.add('neuroglancer-layer-group-viewer');\n    this.registerDisposer(new AutomaticallyFocusedElement(element));\n\n    this.layout = this.registerDisposer(new DataPanelLayoutContainer(this, 'xy'));\n    this.state.add('layout', this.layout);\n    this.registerActionBindings();\n    this.registerDisposer(this.layerManager.useDirectly());\n    this.registerDisposer(setupPositionDropHandlers(element, this.navigationState.position));\n    this.registerDisposer(this.options.showLayerPanel.changed.add(\n        this.registerCancellable(debounce(() => this.updateUI(), 0))));\n    this.makeUI();\n  }\n\n  bindAction(action: string, handler: () => void) {\n    this.registerDisposer(registerActionListener(this.element, action, handler));\n  }\n\n  private registerActionBindings() {\n    this.bindAction('add-layer', () => {\n      if (this.layerPanel) {\n        this.layerPanel.addLayerMenu();\n      }\n    });\n  }\n\n  toJSON(): any {\n    return {'type': 'viewer', ...this.state.toJSON()};\n  }\n\n  reset() {\n    this.state.reset();\n  }\n\n  restoreState(obj: any) {\n    this.state.restoreState(obj);\n  }\n\n  private makeUI() {\n    this.element.style.flex = '1';\n    this.element.style.display = 'flex';\n    this.element.style.flexDirection = 'column';\n    this.element.appendChild(this.layout.element);\n    this.updateUI();\n  }\n\n  private updateUI() {\n    const {options} = this;\n    const showLayerPanel = options.showLayerPanel.value;\n    if (this.layerPanel !== undefined && !showLayerPanel) {\n      this.layerPanel.dispose();\n      this.layerPanel = undefined;\n      return;\n    }\n    if (showLayerPanel && this.layerPanel === undefined) {\n      const layerPanel = this.layerPanel = new LayerPanel(\n          this.display, this.layerSpecification, this.viewerNavigationState,\n          this.viewerState.selectedLayer, () => this.layout.toJSON());\n      if (options.showViewerMenu) {\n        layerPanel.registerDisposer(makeViewerMenu(layerPanel.element, this));\n        layerPanel.element.title = 'Right click for options, drag to move/copy layer group.';\n      } else {\n        layerPanel.element.title = 'Drag to move/copy layer group.';\n      }\n      layerPanel.element.draggable = true;\n      this.registerEventListener(layerPanel.element, 'dragstart', (event: DragEvent) => {\n        startLayerDrag(event, {\n          manager: this.layerSpecification,\n          layers: <ManagedUserLayerWithSpecification[]>this.layerManager.managedLayers,\n          layoutSpec: this.layout.toJSON(),\n        });\n        const disposer = () => {\n          if (dragSource && dragSource.viewer === this) {\n            dragSource = undefined;\n          }\n          this.unregisterDisposer(disposer);\n        };\n        dragSource = {viewer: this, disposer};\n        this.registerDisposer(disposer);\n        const dragData = this.toJSON();\n        delete dragData['layers'];\n        event.dataTransfer!.setData(viewerDragType, JSON.stringify(dragData));\n      });\n      this.registerEventListener(layerPanel.element, 'dragend', (event: DragEvent) => {\n        endLayerDrag(event);\n        if (dragSource !== undefined && dragSource.viewer === this) {\n          dragSource.disposer();\n        }\n      });\n      this.element.insertBefore(layerPanel.element, this.element.firstChild);\n    }\n  }\n\n  disposed() {\n    removeChildren(this.element);\n    const {layerPanel} = this;\n    if (layerPanel !== undefined) {\n      layerPanel.dispose();\n      this.layerPanel = undefined;\n    }\n    super.disposed();\n  }\n}\n","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Facilities for laying out multiple LayerGroupViewer instances.\n */\n\nimport debounce from 'lodash/debounce';\nimport {getViewerDropEffect, hasViewerDrag, LayerGroupViewer, viewerDragType} from 'neuroglancer/layer_group_viewer';\nimport {LayerListSpecification, LayerSubsetSpecification} from 'neuroglancer/layer_specification';\nimport {endLayerDrag, getDropLayers, getLayerDragInfo, updateLayerDropEffect} from 'neuroglancer/ui/layer_drag_and_drop';\nimport {Borrowed, RefCounted, registerEventListener} from 'neuroglancer/util/disposable';\nimport {removeFromParent} from 'neuroglancer/util/dom';\nimport {getDropEffect, setDropEffect} from 'neuroglancer/util/drag_and_drop';\nimport {parseArray, verifyObject, verifyObjectProperty, verifyString} from 'neuroglancer/util/json';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {Trackable} from 'neuroglancer/util/trackable';\nimport {Viewer} from 'neuroglancer/viewer';\n\nimport './layer_groups_layout.css';\n\ninterface LayoutComponent extends RefCounted {\n  element: HTMLElement;\n  changed: NullarySignal;\n  toJSON(): any;\n}\n\nconst layoutComponentContainerSymbol = Symbol('layoutComponentContainer');\n\n/**\n * Container for a LayoutComponent.  The contained LayoutComponent may change.\n */\nexport class LayoutComponentContainer extends RefCounted {\n  changed = new NullarySignal();\n  private componentValue: LayoutComponent;\n\n  private unsetComponent() {\n    const oldComponent = this.componentValue;\n    if (oldComponent !== undefined) {\n      oldComponent.changed.remove(this.changed.dispatch);\n      this.element.removeChild(oldComponent.element);\n      oldComponent.dispose();\n    }\n  }\n\n  get component() {\n    return this.componentValue;\n  }\n\n  private setComponent(component: LayoutComponent) {\n    this.unsetComponent();\n    this.componentValue = component;\n    component.changed.add(this.changed.dispatch);\n    this.element.appendChild(component.element);\n\n    if (component instanceof LayerGroupViewer) {\n      const {layerManager} = component;\n      const scheduleMaybeDelete = component.registerCancellable(debounce(() => {\n        if (layerManager.managedLayers.length === 0) {\n          this.dispose();\n        }\n      }, 0));\n      component.registerDisposer(layerManager.layersChanged.add(() => {\n        if (layerManager.managedLayers.length === 0) {\n          scheduleMaybeDelete();\n        }\n      }));\n      scheduleMaybeDelete();\n    } else if (component instanceof StackLayoutComponent) {\n      const scheduleMaybeDelete = component.registerCancellable(debounce(() => {\n        const {length} = component;\n        if (length === 0 && this.parent !== undefined) {\n          this.dispose();\n        } else if (length === 1) {\n          const childComponent = component.get(0).component;\n          let spec: any;\n          if (this.parent === undefined && childComponent instanceof LayerGroupViewer) {\n            spec = childComponent.layout.specification.toJSON();\n            childComponent.viewerNavigationState.copyToParent();\n            const layersToKeep = new Set(childComponent.layerManager.managedLayers);\n            const {layerSpecification} = childComponent;\n            layerSpecification.rootLayers.filter(layer => layersToKeep.has(layer));\n            layerSpecification.rootLayers.managedLayers =\n              Array.from(childComponent.layerManager.managedLayers);\n            layerSpecification.rootLayers.layersChanged.dispatch();\n          } else {\n            spec = childComponent.toJSON();\n          }\n          this.setSpecification(spec);\n        }\n      }, 0));\n      component.registerDisposer(component.changed.add(() => {\n        if (component.length < 2) {\n          scheduleMaybeDelete();\n        }\n      }));\n      scheduleMaybeDelete();\n    }\n    this.changed.dispatch();\n  }\n  element = document.createElement('div');\n\n  constructor(public viewer: Viewer, spec: any, public parent: StackLayoutComponent|undefined) {\n    super();\n    const {element} = this;\n    element.style.display = 'flex';\n    element.style.flex = '1';\n    element.style.position = 'relative';\n    element.style.alignItems = 'stretch';\n    (<any>element).foo = 'hello';\n    (<any>element)[layoutComponentContainerSymbol] = this;\n\n    this.setSpecification(spec);\n\n    interface DropZone {\n      element: HTMLElement;\n      direction: 'row' | 'column';\n      orientation: 'left' | 'right' | 'top' | 'bottom';\n    }\n\n    const dropZones: DropZone[] = [];\n    const makeDropZone = (name: 'left'|'right'|'top'|'bottom') => {\n      const dropZone = document.createElement('div');\n      dropZone.className = 'neuroglancer-layout-split-drop-zone';\n      let direction: 'row' | 'column';\n      dropZone.style[name] = '0';\n      switch (name) {\n        case 'left':\n        case 'right':\n          direction = 'row';\n          dropZone.style.width = '10px';\n          dropZone.style.height = '100%';\n          break;\n        case 'top':\n        case 'bottom':\n          direction = 'column';\n          dropZone.style.height = '10px';\n          dropZone.style.width = '100%';\n          break;\n      }\n      dropZone.style.display = 'none';\n      dropZones.push({element: dropZone, direction: direction!, orientation: name});\n      element.appendChild(dropZone);\n      this.registerDisposer(setupDropZone(\n          dropZone, this.viewer.layerSpecification,\n          () => <LayerGroupViewer>(this.split(name).newContainer.component)));\n    };\n    makeDropZone('left');\n    makeDropZone('right');\n    makeDropZone('top');\n    makeDropZone('bottom');\n\n    let dropZonesVisible = false;\n    this.registerEventListener(element, 'dragenter', (event: DragEvent) => {\n      if (dropZonesVisible) {\n        return;\n      }\n      if (getLayerDragInfo(event) === undefined) {\n        return;\n      }\n      dropZonesVisible = true;\n      for (const {element: dropZone, direction, orientation} of dropZones) {\n        if (parent !== undefined && direction === parent.direction) {\n          if (((orientation === 'left' || orientation === 'top') && parent.get(0) !== this) ||\n              ((orientation === 'bottom' || orientation === 'right') &&\n               parent.get(parent.length - 1) !== this)) {\n            continue;\n          }\n        }\n        const {component} = this;\n        if (component instanceof StackLayoutComponent && component.direction === direction) {\n          continue;\n        }\n        dropZone.style.display = 'block';\n      }\n    }, true);\n\n    this.registerEventListener(element, 'drop', (_event: DragEvent) => {\n      if (!dropZonesVisible) {\n        return;\n      }\n      dropZonesVisible = false;\n      for (const {element: dropZone} of dropZones) {\n        dropZone.style.display = 'none';\n      }\n    }, /*capture=*/ true);\n    this.registerEventListener(element, 'dragleave', (event: DragEvent) => {\n      const {relatedTarget} = event;\n      if (!dropZonesVisible) {\n        return;\n      }\n      if (relatedTarget instanceof HTMLElement && this.element.contains(relatedTarget)) {\n        return;\n      }\n      dropZonesVisible = false;\n      for (const {element: dropZone} of dropZones) {\n        dropZone.style.display = 'none';\n      }\n    }, true);\n  }\n\n  toJSON() {\n    return this.component.toJSON();\n  }\n\n  setSpecification(spec: any) {\n    this.setComponent(makeComponent(this, spec));\n  }\n\n  static getFromElement(element: Element): LayoutComponentContainer {\n    return (<any>element)[layoutComponentContainerSymbol];\n  }\n\n  disposed () {\n    this.unsetComponent();\n    (<any>this).componentValue = undefined;\n    super.disposed();\n  }\n\n  split(side: 'left'|'top'|'bottom'|'right'):\n  {newContainer: LayoutComponentContainer, existingContainer: LayoutComponentContainer} {\n    const newComponentSpec: any = {\n      type: 'viewer',\n    };\n\n    const {parent} = this;\n    if (parent !== undefined) {\n      if ((side === 'left' && parent.direction === 'row') ||\n          (side === 'top' && parent.direction === 'column')) {\n        return {newContainer: parent.insertChild(newComponentSpec, this), existingContainer: this};\n      } else if (\n          (side === 'right' && parent.direction === 'row') ||\n          (side === 'bottom' && parent.direction === 'column')) {\n        return {newContainer: parent.insertChild(newComponentSpec), existingContainer: this};\n      }\n    }\n\n    let existingComponentSpec: any;\n    const existingComponent = this.component;\n    if (existingComponent instanceof SingletonLayerGroupViewer) {\n      existingComponentSpec = existingComponent.layerGroupViewer.toJSON();\n    } else {\n      existingComponentSpec = existingComponent.toJSON();\n    }\n    let spec: any;\n    let newIndex: number;\n    const direction = side === 'left' || side === 'right' ? 'row' : 'column';\n    switch (side) {\n      case 'left':\n      case 'top':\n        spec = {type: direction, children: [newComponentSpec, existingComponentSpec]};\n        newIndex = 0;\n        break;\n      case 'right':\n      case 'bottom':\n        spec = {type: direction, children: [existingComponentSpec, newComponentSpec]};\n        newIndex = 1;\n        break;\n    }\n    this.setSpecification(spec!);\n    const stackComponent = <StackLayoutComponent>this.component;\n    return {\n      newContainer: stackComponent.get(newIndex!),\n      existingContainer: stackComponent.get(1 - newIndex!)\n    };\n  }\n}\n\nfunction getCommonViewerState(viewer: Viewer) {\n  return {\n    mouseState: viewer.mouseState,\n    showAxisLines: viewer.showAxisLines,\n    showScaleBar: viewer.showScaleBar,\n    scaleBarOptions: viewer.scaleBarOptions,\n    showPerspectiveSliceViews: viewer.showPerspectiveSliceViews,\n    inputEventBindings: viewer.inputEventBindings,\n    visibility: viewer.visibility,\n    selectedLayer: viewer.selectedLayer,\n    visibleLayerRoles: viewer.visibleLayerRoles,\n    navigationState: viewer.navigationState.addRef(),\n    perspectiveNavigationState: viewer.perspectiveNavigationState.addRef(),\n    crossSectionBackgroundColor: viewer.crossSectionBackgroundColor,\n    perspectiveViewBackgroundColor: viewer.perspectiveViewBackgroundColor,\n  };\n}\n\nexport class SingletonLayerGroupViewer extends RefCounted implements LayoutComponent {\n  layerGroupViewer: LayerGroupViewer;\n\n  constructor(public element: HTMLElement, layout: any, viewer: Viewer) {\n    super();\n    this.layerGroupViewer = this.registerDisposer(new LayerGroupViewer(\n        element, {\n          display: viewer.display,\n          layerSpecification: viewer.layerSpecification.addRef(),\n          ...getCommonViewerState(viewer),\n        },\n        {showLayerPanel: viewer.uiControlVisibility.showLayerPanel, showViewerMenu: false}));\n    this.layerGroupViewer.layout.restoreState(layout);\n  }\n\n  toJSON() {\n    return this.layerGroupViewer.layout.specification.toJSON();\n  }\n\n  get changed() {\n    return this.layerGroupViewer.layout.changed;\n  }\n}\n\nfunction setupDropZone(\n  dropZone: HTMLElement, manager: Borrowed<LayerListSpecification>, makeLayerGroupViewer: () => Borrowed<LayerGroupViewer>) {\n  const enterDisposer = registerEventListener(dropZone, 'dragenter', (event: DragEvent) => {\n    if (getLayerDragInfo(event) === undefined) {\n      return;\n    }\n    dropZone.classList.add('neuroglancer-drag-over');\n  });\n  const leaveDisposer = registerEventListener(dropZone, 'dragleave', () => {\n    dropZone.classList.remove('neuroglancer-drag-over');\n  });\n  const overDisposer = registerEventListener(dropZone, 'dragover', (event: DragEvent) => {\n    if (hasViewerDrag(event)) {\n      setDropEffect(event, getViewerDropEffect(event, manager));\n      event.stopPropagation();\n      event.preventDefault();\n      return;\n    }\n    if (getLayerDragInfo(event) !== undefined) {\n      updateLayerDropEffect(event, manager, /*newTarget=*/true);\n      event.stopPropagation();\n      event.preventDefault();\n      return;\n    }\n  });\n  const dropDisposer = registerEventListener(dropZone, 'drop', (event: DragEvent) => {\n    dropZone.classList.remove('neuroglancer-drag-over');\n    if (hasViewerDrag(event)) {\n      event.stopPropagation();\n      let dropState: any;\n      try {\n        dropState = JSON.parse(event.dataTransfer!.getData(viewerDragType));\n      } catch (e) {\n        return;\n      }\n      const dropLayers = getDropLayers(\n          event, manager, /*forceCopy=*/false, /*allowMove=*/false,\n          /*newTarget=*/true);\n      if (dropLayers !== undefined && dropLayers.finalize(event)) {\n        event.preventDefault();\n        event.dataTransfer!.dropEffect = getDropEffect();\n        endLayerDrag(event);\n        const layerGroupViewer = makeLayerGroupViewer();\n        for (const newLayer of dropLayers.layers.keys()) {\n          layerGroupViewer.layerSpecification.add(newLayer);\n        }\n        try {\n          layerGroupViewer.restoreState(dropState);\n        } catch {\n        }\n      }\n    } else {\n      const dropLayers = getDropLayers(\n          event, manager, /*forceCopy=*/getDropEffect() === 'copy',\n          /*allowMove=*/false,\n          /*newTarget=*/true);\n      if (dropLayers !== undefined && dropLayers.finalize(event)) {\n        event.preventDefault();\n        event.dataTransfer!.dropEffect = getDropEffect();\n        endLayerDrag(event);\n        const layerGroupViewer = makeLayerGroupViewer();\n        for (const newLayer of dropLayers.layers.keys()) {\n          layerGroupViewer.layerSpecification.add(newLayer);\n        }\n        try {\n          layerGroupViewer.layout.restoreState(dropLayers.layoutSpec);\n        } catch {\n          layerGroupViewer.layout.reset();\n          // Ignore error restoring layout.\n        }\n        return;\n      }\n    }\n  });\n  return () => {\n    dropDisposer();\n    overDisposer();\n    leaveDisposer();\n    enterDisposer();\n  };\n}\n\nexport class StackLayoutComponent extends RefCounted implements LayoutComponent {\n  changed = new NullarySignal();\n\n  get length () {\n    return (this.element.childElementCount - 1) / 2;\n  }\n\n  private makeDropPlaceholder (refCounted: RefCounted) {\n    const dropZone = document.createElement('div');\n    dropZone.className = 'neuroglancer-stack-layout-drop-placeholder';\n    refCounted.registerDisposer(setupDropZone(dropZone, this.viewer.layerSpecification, () => {\n      const nextElement = dropZone.nextElementSibling;\n      let nextChild: LayoutComponentContainer|undefined;\n      if (nextElement !== null) {\n        nextChild = LayoutComponentContainer.getFromElement(nextElement);\n      }\n      const newChild = this.insertChild({type: 'viewer', layers: []}, nextChild);\n      return <LayerGroupViewer>newChild.component;\n    }));\n    refCounted.registerDisposer(() => {\n      removeFromParent(dropZone);\n    });\n    return dropZone;\n  }\n\n  get viewer() {\n    return this.container.viewer;\n  }\n\n  constructor(\n      public element: HTMLElement, public direction: 'row'|'column', children: any[],\n      public container: LayoutComponentContainer) {\n    super();\n    element.classList.add('neuroglancer-stack-layout');\n    element.classList.add(`neuroglancer-stack-layout-${direction}`);\n    element.style.display = 'flex';\n    element.style.flexDirection = direction;\n    element.appendChild(this.makeDropPlaceholder(this));\n    for (const childSpec of children) {\n      this.insertChild(childSpec);\n    }\n  }\n\n  get(index: number) {\n    return LayoutComponentContainer.getFromElement(this.element.children[index * 2 + 1]);\n  }\n\n  insertChild(spec: any, before?: LayoutComponentContainer) {\n    const child = new LayoutComponentContainer(this.viewer, spec, this);\n    const dropZone = this.makeDropPlaceholder(child);\n    child.element.classList.add('neuroglancer-stack-layout-child');\n    child.registerDisposer(child.changed.add(this.changed.dispatch));\n    child.registerDisposer(() => {\n      this.element.removeChild(child.element);\n      this.changed.dispatch();\n    });\n    const beforeElement = before !== undefined ? before.element : null;\n    this.element.insertBefore(child.element, beforeElement);\n    this.element.insertBefore(dropZone, beforeElement);\n    this.changed.dispatch();\n    return child;\n  }\n\n  disposed() {\n    this.clear();\n    super.disposed();\n  }\n\n  clear() {\n    while (this.length !== 0) {\n      this.get(0).dispose();\n    }\n  }\n\n  * [Symbol.iterator] () {\n    const {length} = this;\n    for (let i = 0; i < length; ++i) {\n      yield this.get(i);\n    }\n  }\n\n  toJSON() {\n    return {\n      type: this.direction,\n      children: Array.from(this).map(x => x.toJSON()),\n    };\n  }\n}\n\nfunction makeComponent(container: LayoutComponentContainer, spec: any) {\n  const element = document.createElement('div');\n  element.style.flex = '1';\n  element.style.width = '0px';\n  if (typeof spec === 'string') {\n    if (container.parent !== undefined) {\n      throw new Error(`Invalid layout component specification: ${JSON.stringify(spec)}`);\n    }\n    return new SingletonLayerGroupViewer(element, spec, container.viewer);\n  }\n  verifyObject(spec);\n  const componentType = verifyObjectProperty(spec, 'type', verifyString);\n  switch (componentType) {\n    case 'row':\n    case 'column': {\n      return new StackLayoutComponent(\n          element, componentType, verifyObjectProperty(spec, 'children', x => {\n            const children = parseArray(x, y => y);\n            if (container.parent === undefined && children.length === 0) {\n              throw new Error('Stack layout requires at least one child.');\n            }\n            return children;\n          }), container);\n    }\n    case 'viewer': {\n      const viewer = container.viewer;\n      const layerSpecification = new LayerSubsetSpecification(viewer.layerSpecification.addRef());\n      const layerGroupViewer = new LayerGroupViewer(\n          element, {\n            display: viewer.display,\n            layerSpecification,\n            ...getCommonViewerState(viewer),\n          },\n          {showLayerPanel: viewer.uiControlVisibility.showLayerPanel, showViewerMenu: true});\n      try {\n        layerGroupViewer.restoreState(spec);\n      } catch (e) {\n        layerGroupViewer.dispose();\n        throw e;\n      }\n      return layerGroupViewer;\n    }\n    default: {\n      // Treat it as a singleton layer group.\n      return new SingletonLayerGroupViewer(element, spec, container.viewer);\n    }\n  }\n}\n\nexport class RootLayoutContainer extends RefCounted implements Trackable {\n  container = this.registerDisposer(\n      new LayoutComponentContainer(this.viewer, this.defaultSpecification, undefined));\n\n  get changed () { return this.container.changed; }\n\n  get element() {\n    return this.container.element;\n  }\n\n  constructor(public viewer: Viewer, public defaultSpecification: any) {\n    super();\n  }\n\n  reset() {\n    this.container.setSpecification(this.defaultSpecification);\n  }\n\n  restoreState(obj: any) {\n    this.container.setSpecification(obj);\n  }\n\n  disposed() {\n    super.disposed();\n  }\n\n  toJSON() {\n    return this.container.toJSON();\n  }\n}\n","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {DisplayContext} from 'neuroglancer/display_context';\nimport {ManagedUserLayer, SelectedLayerState,} from 'neuroglancer/layer';\nimport {LayerDialog} from 'neuroglancer/layer_dialog';\nimport {LinkedViewerNavigationState} from 'neuroglancer/layer_group_viewer';\nimport {LayerListSpecification, ManagedUserLayerWithSpecification} from 'neuroglancer/layer_specification';\nimport {NavigationLinkType} from 'neuroglancer/navigation_state';\nimport {DropLayers, endLayerDrag, getDropLayers, getLayerDropEffect, startLayerDrag} from 'neuroglancer/ui/layer_drag_and_drop';\nimport {animationFrameDebounce} from 'neuroglancer/util/animation_frame_debounce';\nimport {RefCounted, registerEventListener} from 'neuroglancer/util/disposable';\nimport {removeFromParent} from 'neuroglancer/util/dom';\nimport {getDropEffect, preventDrag, setDropEffect} from 'neuroglancer/util/drag_and_drop';\nimport {float32ToString} from 'neuroglancer/util/float32_to_string';\nimport {makeCloseButton} from 'neuroglancer/widget/close_button';\nimport {PositionWidget} from 'neuroglancer/widget/position_widget';\n\nimport 'neuroglancer/noselect.css';\nimport './layer_panel.css';\nimport 'neuroglancer/ui/button.css';\n\nfunction destroyDropLayers(\n    dropLayers: DropLayers, targetLayer?: ManagedUserLayerWithSpecification) {\n  if (dropLayers.method === 'move') {\n    // Nothing to do.\n    return false;\n  }\n  dropLayers.manager.layerManager.filter(\n      layer => !dropLayers.layers.has(<ManagedUserLayerWithSpecification>layer));\n  return targetLayer !== undefined && dropLayers.layers.has(targetLayer);\n}\n\nfunction registerDropHandlers(\n    panel: LayerPanel, target: EventTarget,\n    targetLayer: ManagedUserLayerWithSpecification|undefined) {\n  function update(event: DragEvent, updateDropEffect: boolean): DropLayers|undefined {\n    let dropLayers = panel.dropLayers;\n    const dropEffect =\n        updateDropEffect ? getLayerDropEffect(event, panel.manager) : getDropEffect();\n    let existingDropLayers = true;\n    if (dropLayers !== undefined) {\n      if (updateDropEffect) {\n        setDropEffect(event, dropEffect);\n      }\n      if (!dropLayers.compatibleWithMethod(dropEffect)) {\n        panel.dropLayers = undefined;\n        if (destroyDropLayers(dropLayers, targetLayer)) {\n          // We destroyed the layer for which we received the dragenter event.  Wait until we get\n          // another dragenter or drop event to do something.\n          return undefined;\n        }\n      }\n    }\n    if (dropLayers === undefined) {\n      dropLayers = panel.dropLayers = getDropLayers(\n          event, panel.manager, /*forceCopy=*/dropEffect === 'copy', /*allowMove=*/true,\n          /*newTarget=*/false);\n      if (dropLayers === undefined) {\n        return undefined;\n      }\n      existingDropLayers = dropLayers.method === 'move';\n    }\n\n    // Dragged onto itself, nothing to do.\n    if (targetLayer !== undefined && dropLayers.layers.has(targetLayer)) {\n      return dropLayers;\n    }\n    if (!existingDropLayers) {\n      let newIndex: number|undefined;\n      if (targetLayer !== undefined) {\n        newIndex = panel.manager.layerManager.managedLayers.indexOf(targetLayer);\n      }\n      for (const newLayer of dropLayers.layers.keys()) {\n        panel.manager.add(newLayer, newIndex);\n      }\n    } else {\n      // Rearrange layers.\n      const {layerManager} = panel.manager;\n      const existingLayers = new Set<ManagedUserLayerWithSpecification>();\n      let firstRemovalIndex = Number.POSITIVE_INFINITY;\n      const managedLayers = layerManager.managedLayers =\n          layerManager.managedLayers.filter((x: ManagedUserLayerWithSpecification, index) => {\n            if (dropLayers!.layers.has(x)) {\n              if (firstRemovalIndex === Number.POSITIVE_INFINITY) {\n                firstRemovalIndex = index;\n              }\n              existingLayers.add(x);\n              return false;\n            } else {\n              return true;\n            }\n          });\n      let newIndex: number;\n      if (targetLayer !== undefined) {\n        newIndex = managedLayers.indexOf(targetLayer);\n        if (firstRemovalIndex <= newIndex) {\n          ++newIndex;\n        }\n      } else {\n        newIndex = managedLayers.length;\n      }\n      // Filter out layers that have been concurrently removed.\n      for (const layer of dropLayers.layers.keys()) {\n        if (!existingLayers.has(layer)) {\n          dropLayers.layers.delete(layer);\n        }\n      }\n      managedLayers.splice(newIndex, 0, ...dropLayers.layers.keys());\n      layerManager.layersChanged.dispatch();\n    }\n    return dropLayers;\n  }\n  const enterDisposer = registerEventListener(target, 'dragenter', (event: DragEvent) => {\n    if (update(event, /*updateDropEffect=*/true) !== undefined) {\n      event.preventDefault();\n    }\n  });\n  const dropDisposer = registerEventListener(target, 'drop', (event: DragEvent) => {\n    event.preventDefault();\n    const dropLayers = update(event, /*updateDropEffect=*/false);\n    if (dropLayers !== undefined) {\n      if (!dropLayers.finalize(event)) {\n        destroyDropLayers(dropLayers);\n      } else {\n        event.dataTransfer!.dropEffect = getDropEffect();\n        endLayerDrag(dropLayers.method === 'move' ? undefined : event);\n      }\n    }\n    panel.dropLayers = undefined;\n  });\n  const overDisposer = registerEventListener(target, 'dragover', (event: DragEvent) => {\n    const dropLayers = update(event, /*updateDropEffect=*/true);\n    if (dropLayers === undefined) {\n      return;\n    }\n    event.preventDefault();\n    event.stopPropagation();\n  });\n\n  return () => {\n    overDisposer();\n    dropDisposer();\n    enterDisposer();\n  };\n}\n\n\nclass LayerWidget extends RefCounted {\n  element: HTMLElement;\n  layerNumberElement: HTMLSpanElement;\n  labelElement: HTMLSpanElement;\n  valueElement: HTMLSpanElement;\n\n  constructor(public layer: ManagedUserLayerWithSpecification, public panel: LayerPanel) {\n    super();\n    let element = this.element = document.createElement('div');\n    element.title = 'Control+click for layer options, drag to move/copy.';\n    element.className = 'neuroglancer-layer-item neuroglancer-noselect';\n    let labelElement = this.labelElement = document.createElement('span');\n    labelElement.className = 'neuroglancer-layer-item-label';\n    let layerNumberElement = this.layerNumberElement = document.createElement('span');\n    layerNumberElement.className = 'neuroglancer-layer-item-number';\n    let valueElement = this.valueElement = document.createElement('span');\n    valueElement.className = 'neuroglancer-layer-item-value';\n    const closeElement = makeCloseButton();\n    closeElement.title = 'Delete layer';\n    this.registerEventListener(closeElement, 'click', (event: MouseEvent) => {\n      this.panel.layerManager.removeManagedLayer(this.layer);\n      event.stopPropagation();\n    });\n    element.appendChild(layerNumberElement);\n    element.appendChild(labelElement);\n    element.appendChild(valueElement);\n    element.appendChild(closeElement);\n    this.registerEventListener(element, 'click', (event: MouseEvent) => {\n      if (event.ctrlKey) {\n        panel.selectedLayer.layer = layer;\n        panel.selectedLayer.visible = true;\n      } else {\n        layer.setVisible(!layer.visible);\n      }\n    });\n\n    this.registerEventListener(element, 'contextmenu', (event: MouseEvent) => {\n      panel.selectedLayer.layer = layer;\n      panel.selectedLayer.visible = true;\n      event.stopPropagation();\n      event.preventDefault();\n    });\n\n    element.draggable = true;\n    this.registerEventListener(element, 'dragstart', (event: DragEvent) => {\n      startLayerDrag(\n          event,\n          {manager: panel.manager, layers: [this.layer], layoutSpec: panel.getLayoutSpecForDrag()});\n      event.stopPropagation();\n    });\n\n    this.registerEventListener(element, 'dragend', (event: DragEvent) => {\n      endLayerDrag(event);\n    });\n\n    this.registerDisposer(registerDropHandlers(this.panel, element, this.layer));\n\n    this.registerEventListener(element, 'dblclick', (_event: MouseEvent) => {\n      if (layer instanceof ManagedUserLayerWithSpecification) {\n        new LayerDialog(this.panel.manager, layer);\n      }\n    });\n  }\n\n  update() {\n    let {layer} = this;\n    this.labelElement.textContent = layer.name;\n    this.element.setAttribute('layer-visible', layer.visible.toString());\n    this.element.setAttribute(\n        'layer-selected', (layer === this.panel.selectedLayer.layer).toString());\n  }\n\n  disposed() {\n    this.element.parentElement!.removeChild(this.element);\n    super.disposed();\n  }\n}\n\nexport class LayerPanel extends RefCounted {\n  layerWidgets = new Map<ManagedUserLayer, LayerWidget>();\n  element = document.createElement('div');\n  private layerUpdateNeeded = true;\n  private valueUpdateNeeded = false;\n  dropZone: HTMLDivElement;\n  private layerWidgetInsertionPoint = document.createElement('div');\n  private positionWidget =\n      this.registerDisposer(new PositionWidget(this.viewerNavigationState.position.value));\n\n  /**\n   * For use within this module only.\n   */\n  dropLayers: DropLayers|undefined;\n\n  get layerManager() {\n    return this.manager.layerManager;\n  }\n\n  constructor(\n      public display: DisplayContext, public manager: LayerListSpecification,\n      public viewerNavigationState: LinkedViewerNavigationState,\n      public selectedLayer: SelectedLayerState, public getLayoutSpecForDrag: () => any) {\n    super();\n    this.registerDisposer(selectedLayer);\n    const {element} = this;\n    element.className = 'neuroglancer-layer-panel';\n    this.registerDisposer(manager.layerSelectedValues.changed.add(() => {\n      this.handleLayerValuesChanged();\n    }));\n    this.registerDisposer(manager.layerManager.layersChanged.add(() => {\n      this.handleLayersChanged();\n    }));\n    this.registerDisposer(selectedLayer.changed.add(() => {\n      this.handleLayersChanged();\n    }));\n    this.layerWidgetInsertionPoint.style.display = 'none';\n    this.element.appendChild(this.layerWidgetInsertionPoint);\n\n    let addButton = document.createElement('div');\n    addButton.className = 'neuroglancer-layer-add-button neuroglancer-button';\n    addButton.title =\n        'Click to add layer, control+click/right click/+click to add local annotation layer.';\n    addButton.textContent = '+';\n\n    let dropZone = this.dropZone = document.createElement('div');\n    dropZone.className = 'neuroglancer-layer-panel-drop-zone';\n\n    const addLayer = (event: MouseEvent) => {\n      if (event.ctrlKey || event.metaKey || event.type === 'contextmenu') {\n        const layer = new ManagedUserLayerWithSpecification('annotation', {}, this.manager);\n        this.manager.initializeLayerFromSpec(layer, {type: 'annotation'});\n        this.manager.add(layer);\n      } else {\n        this.addLayerMenu();\n      }\n    };\n    this.registerEventListener(addButton, 'click', addLayer);\n    this.registerEventListener(addButton, 'contextmenu', addLayer);\n    element.appendChild(addButton);\n    element.appendChild(dropZone);\n    this.registerDisposer(preventDrag(addButton));\n\n    element.appendChild(this.positionWidget.element);\n    const updatePositionWidgetVisibility = () => {\n      const linkValue = this.viewerNavigationState.position.link.value;\n      this.positionWidget.element.style.display =\n          linkValue === NavigationLinkType.LINKED ? 'none' : null;\n    };\n    this.registerDisposer(\n        this.viewerNavigationState.position.link.changed.add(updatePositionWidgetVisibility));\n    updatePositionWidgetVisibility();\n\n    this.update();\n\n    this.registerEventListener(element, 'dragleave', (event: DragEvent) => {\n      if (event.relatedTarget && element.contains(<Node>event.relatedTarget)) {\n        return;\n      }\n      const {dropLayers} = this;\n      if (dropLayers !== undefined) {\n        destroyDropLayers(dropLayers);\n        this.dropLayers = undefined;\n      }\n    });\n    this.registerDisposer(registerDropHandlers(this, addButton, undefined));\n    this.registerDisposer(registerDropHandlers(this, dropZone, undefined));\n\n    // Ensure layer widgets are updated before WebGL drawing starts; we don't want the layout to\n    // change after WebGL drawing or we will get flicker.\n    this.registerDisposer(display.updateStarted.add(() => this.updateLayers()));\n  }\n\n  disposed() {\n    this.layerWidgets.forEach(x => x.dispose());\n    this.layerWidgets = <any>undefined;\n    removeFromParent(this.element);\n    super.disposed();\n  }\n\n  handleLayersChanged() {\n    this.layerUpdateNeeded = true;\n    this.handleLayerValuesChanged();\n  }\n\n  handleLayerValuesChanged() {\n    if (!this.valueUpdateNeeded) {\n      this.valueUpdateNeeded = true;\n      this.scheduleUpdate();\n    }\n  }\n\n  private scheduleUpdate = this.registerCancellable(animationFrameDebounce(() => this.update()));\n\n  private update() {\n    this.valueUpdateNeeded = false;\n    this.updateLayers();\n    let values = this.manager.layerSelectedValues;\n    for (let [layer, widget] of this.layerWidgets) {\n      let userLayer = layer.layer;\n      let text = '';\n      if (userLayer !== null) {\n        let value = values.get(userLayer);\n        if (value !== undefined) {\n          value = Array().concat(value);\n          value = value.map((x: any) => {\n            if (x === null) {\n              return 'null';\n            } else if (Math.fround(x) === x) {\n              // FIXME: Verify actual layer data type\n              return float32ToString(x);\n            } else {\n              return x;\n            }\n          });\n          text += value.join(', ');\n        }\n      }\n      widget.valueElement.textContent = text;\n    }\n  }\n\n  updateLayers() {\n    if (!this.layerUpdateNeeded) {\n      return;\n    }\n    this.layerUpdateNeeded = false;\n    let container = this.element;\n    let layers = new Set();\n    let nextChild = this.layerWidgetInsertionPoint.nextElementSibling;\n    this.manager.layerManager.managedLayers.forEach((layer: ManagedUserLayerWithSpecification) => {\n      layers.add(layer);\n      let widget = this.layerWidgets.get(layer);\n      const layerIndex = this.manager.rootLayers.managedLayers.indexOf(layer);\n      if (widget === undefined) {\n        widget = new LayerWidget(layer, this);\n        this.layerWidgets.set(layer, widget);\n      }\n      widget.layerNumberElement.textContent = '' + (1 + layerIndex);\n      widget.update();\n      let {element} = widget;\n      if (element !== nextChild) {\n        container.insertBefore(widget.element, nextChild);\n      }\n      nextChild = element.nextElementSibling;\n    });\n    for (let [layer, widget] of this.layerWidgets) {\n      if (!layers.has(layer)) {\n        this.layerWidgets.delete(layer);\n        widget.dispose();\n      }\n    }\n  }\n\n  addLayerMenu() {\n    // Automatically destroys itself when it exits.\n    new LayerDialog(this.manager);\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {ChunkManager} from 'neuroglancer/chunk_manager/frontend';\nimport {DataSourceProvider, GetVolumeOptions} from 'neuroglancer/datasource';\nimport {LayerManager, LayerSelectedValues, ManagedUserLayer, UserLayer} from 'neuroglancer/layer';\nimport {VoxelSize} from 'neuroglancer/navigation_state';\nimport {VolumeType} from 'neuroglancer/sliceview/volume/base';\nimport {MultiscaleVolumeChunkSource} from 'neuroglancer/sliceview/volume/frontend';\nimport {StatusMessage} from 'neuroglancer/status';\nimport {Owned, RefCounted, Borrowed} from 'neuroglancer/util/disposable';\nimport {vec3} from 'neuroglancer/util/geom';\nimport {parseArray, verifyObject, verifyObjectProperty, verifyOptionalString, verifyString} from 'neuroglancer/util/json';\nimport {NullarySignal, Signal} from 'neuroglancer/util/signal';\nimport {Trackable} from 'neuroglancer/util/trackable';\nimport {RPC} from 'neuroglancer/worker_rpc';\n\nexport function getVolumeWithStatusMessage(\n    dataSourceProvider: DataSourceProvider, chunkManager: ChunkManager, x: string,\n    options: GetVolumeOptions = {}): Promise<MultiscaleVolumeChunkSource> {\n  return StatusMessage.forPromise(\n      new Promise(function(resolve) {\n        resolve(dataSourceProvider.getVolume(chunkManager, x, options));\n      }),\n      {\n        initialMessage: `Retrieving metadata for volume ${x}.`,\n        delay: true,\n        errorPrefix: `Error retrieving metadata for volume ${x}: `,\n      });\n}\n\nexport class ManagedUserLayerWithSpecification extends ManagedUserLayer {\n  sourceUrl: string|undefined;\n\n  constructor(\n      name: string, public initialSpecification: any, public manager: LayerListSpecification) {\n    super(name);\n  }\n\n  toJSON() {\n    let userLayer = this.layer;\n    if (!userLayer) {\n      return this.initialSpecification;\n    }\n    let layerSpec = userLayer.toJSON();\n    layerSpec.name = this.name;\n    if (!this.visible) {\n      layerSpec['visible'] = false;\n    }\n    return layerSpec;\n  }\n}\n\nexport interface LayerListSpecification extends RefCounted, Trackable {\n  changed: NullarySignal;\n  voxelCoordinatesSet: Signal<(coordinates: vec3) => void>;\n  spatialCoordinatesSet: Signal<(coordinates: vec3) => void>;\n\n  /**\n   * @deprecated\n   */\n  worker: RPC;\n\n  rpc: RPC;\n\n  dataSourceProvider: Borrowed<DataSourceProvider>;\n  layerManager: Borrowed<LayerManager>;\n  chunkManager: Borrowed<ChunkManager>;\n  layerSelectedValues: Borrowed<LayerSelectedValues>;\n  voxelSize: Borrowed<VoxelSize>;\n\n\n  initializeLayerFromSpec(managedLayer: ManagedUserLayerWithSpecification, spec: any): void;\n\n  getLayer(name: string, spec: any): ManagedUserLayerWithSpecification;\n\n  add(layer: Owned<ManagedUserLayer>, index?: number|undefined): void;\n\n  /**\n   * Called by user layers to indicate that a voxel position has been selected interactively.\n   */\n  setVoxelCoordinates(voxelCoordinates: vec3): void;\n  setSpatialCoordinates(spatialCoordinates: vec3): void;\n\n  rootLayers: Borrowed<LayerManager>;\n}\n\nexport class TopLevelLayerListSpecification extends RefCounted implements LayerListSpecification {\n  changed = new NullarySignal();\n  voxelCoordinatesSet = new Signal<(coordinates: vec3) => void>();\n  spatialCoordinatesSet = new Signal<(coordinates: vec3) => void>();\n\n  /**\n   * @deprecated\n   */\n  get worker() {\n    return this.chunkManager.rpc!;\n  }\n\n  get rpc() {\n    return this.chunkManager.rpc!;\n  }\n\n  constructor(\n      public dataSourceProvider: DataSourceProvider, public layerManager: LayerManager,\n      public chunkManager: ChunkManager, public layerSelectedValues: LayerSelectedValues,\n      public voxelSize: VoxelSize) {\n    super();\n    this.registerDisposer(layerManager.layersChanged.add(this.changed.dispatch));\n    this.registerDisposer(layerManager.specificationChanged.add(this.changed.dispatch));\n  }\n\n  reset() {\n    this.layerManager.clear();\n  }\n\n  restoreState(x: any) {\n    this.layerManager.clear();\n    if (Array.isArray(x)) {\n      // If array, layers have an order\n      for (const layerObj of x) {\n        verifyObject(layerObj);\n        const name = this.layerManager.getUniqueLayerName(verifyObjectProperty(layerObj, 'name', verifyString));\n        this.layerManager.addManagedLayer(this.getLayer(name, layerObj));\n      }\n    } else {\n      // Keep for backwards compatibility\n      verifyObject(x);\n      for (let key of Object.keys(x)) {\n        this.layerManager.addManagedLayer(this.getLayer(key, x[key]));\n      }\n    }\n  }\n\n  initializeLayerFromSpec(managedLayer: ManagedUserLayerWithSpecification, spec: any) {\n    managedLayer.initialSpecification = spec;\n    if (typeof spec === 'string') {\n      spec = {'source': spec};\n    }\n    verifyObject(spec);\n    let layerType = verifyObjectProperty(spec, 'type', verifyOptionalString);\n    managedLayer.visible = verifyObjectProperty(spec, 'visible', x => {\n      if (x === undefined || x === true) {\n        return true;\n      }\n      if (x === false) {\n        return false;\n      }\n      throw new Error(`Expected boolean, but received: ${JSON.stringify(x)}.`);\n    });\n\n    const makeUserLayer = (layerConstructor: UserLayerConstructor, spec: any) => {\n      const userLayer = new layerConstructor(this, spec);\n      userLayer.restoreState(spec);\n      managedLayer.layer = userLayer;\n    };\n    let sourceUrl = managedLayer.sourceUrl =\n        verifyObjectProperty(spec, 'source', verifyOptionalString);\n    if (layerType === undefined) {\n      if (sourceUrl === undefined) {\n        throw new Error(`Either layer 'type' or 'source' URL must be specified.`);\n      }\n      let volumeSourcePromise =\n          getVolumeWithStatusMessage(this.dataSourceProvider, this.chunkManager, sourceUrl);\n      volumeSourcePromise.then(source => {\n        if (this.layerManager.managedLayers.indexOf(managedLayer) === -1) {\n          // Layer was removed before promise became ready.\n          return;\n        }\n        let layerConstructor = volumeLayerTypes.get(source.volumeType);\n        if (layerConstructor !== undefined) {\n          makeUserLayer(layerConstructor, spec);\n        } else {\n          throw new Error(`Unsupported volume type: ${VolumeType[source.volumeType]}.`);\n        }\n      });\n    } else {\n      let layerConstructor = layerTypes.get(layerType);\n      if (layerConstructor !== undefined) {\n        makeUserLayer(layerConstructor, spec);\n      } else {\n        throw new Error(`Unsupported layer type: ${JSON.stringify(layerType)}.`);\n      }\n    }\n  }\n\n  getLayer(name: string, spec: any): ManagedUserLayerWithSpecification {\n    let managedLayer = new ManagedUserLayerWithSpecification(name, spec, this);\n    this.initializeLayerFromSpec(managedLayer, spec);\n    return managedLayer;\n  }\n\n  add(layer: ManagedUserLayer, index?: number|undefined) {\n    if (this.layerManager.managedLayers.indexOf(layer) === -1) {\n      layer.name = this.layerManager.getUniqueLayerName(layer.name);\n    }\n    this.layerManager.addManagedLayer(layer, index);\n  }\n\n  toJSON() {\n    const result = [];\n    let numResults = 0;\n    for (let managedLayer of this.layerManager.managedLayers) {\n      const layerJson = (<ManagedUserLayerWithSpecification>managedLayer).toJSON();\n      // A `null` layer specification is used to indicate a transient drag target, and should not be\n      // serialized.\n      if (layerJson != null) {\n        result.push(layerJson);\n        ++numResults;\n      }\n    }\n    if (numResults === 0) {\n      return undefined;\n    }\n    return result;\n  }\n\n  /**\n   * Called by user layers to indicate that a voxel position has been selected interactively.\n   */\n  setVoxelCoordinates(voxelCoordinates: vec3) {\n    this.voxelCoordinatesSet.dispatch(voxelCoordinates);\n  }\n\n  setSpatialCoordinates(spatialCoordinates: vec3) {\n    this.spatialCoordinatesSet.dispatch(spatialCoordinates);\n  }\n\n  get rootLayers() {\n    return this.layerManager;\n  }\n}\n\n/**\n * Class for specifying a subset of a TopLevelLayerListsSpecification.\n */\nexport class LayerSubsetSpecification extends RefCounted implements LayerListSpecification {\n  changed = new NullarySignal();\n\n  get voxelCoordinatesSet() { return this.master.voxelCoordinatesSet; }\n  get spatialCoordinatesSet() { return this.master.spatialCoordinatesSet; }\n\n  get worker() { return this.master.rpc; }\n  get rpc() { return this.master.rpc; }\n\n  get dataSourceProvider () { return this.master.dataSourceProvider; }\n  get chunkManager () { return this.master.chunkManager; }\n  get voxelSize () { return this.master.voxelSize; }\n  get layerSelectedValues () { return this.master.layerSelectedValues; }\n\n  layerManager = new LayerManager();\n\n  constructor (public master: Owned<LayerListSpecification>) {\n    super();\n    this.registerDisposer(master);\n    const {layerManager} = this;\n    this.registerDisposer(layerManager.layersChanged.add(this.changed.dispatch));\n    this.registerDisposer(layerManager.specificationChanged.add(this.changed.dispatch));\n  }\n\n  reset() {\n    this.layerManager.clear();\n  }\n\n  restoreState(x: any) {\n    const masterLayerManager = this.master.layerManager;\n    const layers: ManagedUserLayer[] = [];\n    for (const name of new Set(parseArray(x, verifyString))) {\n      const layer = masterLayerManager.getLayerByName(name);\n      if (layer === undefined) {\n        throw new Error(`Undefined layer referenced in subset specification: ${JSON.stringify(name)}`);\n      }\n      layers.push(layer);\n    }\n    this.layerManager.clear();\n    for (const layer of layers) {\n      this.layerManager.addManagedLayer(layer.addRef());\n    }\n  }\n\n  toJSON() {\n    return this.layerManager.managedLayers.map(x => x.name);\n  }\n\n  initializeLayerFromSpec(managedLayer: ManagedUserLayerWithSpecification, spec: any) {\n    this.master.initializeLayerFromSpec(managedLayer, spec);\n  }\n\n  getLayer(name: string, spec: any): ManagedUserLayerWithSpecification {\n    return this.master.getLayer(name, spec);\n  }\n\n  add(layer: ManagedUserLayer, index?: number|undefined) {\n    if (this.master.layerManager.managedLayers.indexOf(layer) === -1) {\n      layer.name = this.master.layerManager.getUniqueLayerName(layer.name);\n      this.master.layerManager.addManagedLayer(layer.addRef());\n    }\n    this.layerManager.addManagedLayer(layer, index);\n  }\n\n  setVoxelCoordinates(voxelCoordinates: vec3) {\n    this.master.setVoxelCoordinates(voxelCoordinates);\n  }\n\n  setSpatialCoordinates(spatialCoordinates: vec3) {\n    this.master.setSpatialCoordinates(spatialCoordinates);\n  }\n\n  get rootLayers () { return this.master.rootLayers; }\n}\n\ninterface UserLayerConstructor {\n  new(manager: LayerListSpecification, x: any): UserLayer;\n}\n\nconst layerTypes = new Map<string, UserLayerConstructor>();\nconst volumeLayerTypes = new Map<VolumeType, UserLayerConstructor>();\n\nexport function registerLayerType(name: string, layerConstructor: UserLayerConstructor) {\n  layerTypes.set(name, layerConstructor);\n}\n\nexport function registerVolumeLayerType(\n    volumeType: VolumeType, layerConstructor: UserLayerConstructor) {\n  volumeLayerTypes.set(volumeType, layerConstructor);\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport interface Handler { (element: HTMLElement): void; }\n\nexport function withFlex(value: any, handler: Handler) {\n  return (element: HTMLElement) => {\n    element.style.flex = value;\n    handler(element);\n  };\n}\nexport function withStyle(style: {}, handler: Handler) {\n  return (element: HTMLElement) => {\n    Object.assign(element.style, style);\n    handler(element);\n  };\n}\n\nexport function withAttributes(attributes: {}, handler: Handler) {\n  return (element: HTMLElement) => {\n    Object.assign(element, attributes);\n    handler(element);\n  };\n}\n\nexport function box(flexDirection: string, spec: Handler[]) {\n  return (container: HTMLElement) => {\n    container.style.display = 'flex';\n    container.style.flexDirection = flexDirection;\n    for (let handler of spec) {\n      let element = container.ownerDocument!.createElement('div');\n      container.appendChild(element);\n      handler(element);\n    }\n  };\n}\n","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {mat4} from 'neuroglancer/util/geom';\n\nexport const MESH_LAYER_RPC_ID = 'mesh/MeshLayer';\nexport const MULTISCALE_MESH_LAYER_RPC_ID = 'mesh/MultiscaleMeshLayer';\nexport const FRAGMENT_SOURCE_RPC_ID = 'mesh/FragmentSource';\n\nexport const MULTISCALE_FRAGMENT_SOURCE_RPC_ID = 'mesh/MultiscaleFragmentSource';\n\nexport type EncodedVertexPositions = Float32Array|Uint32Array|Uint16Array;\nexport type MeshVertexIndices = Uint16Array|Uint32Array;\nexport type OctahedronVertexNormals = Uint8Array;\n\nexport interface EncodedMeshData {\n  vertexPositions: EncodedVertexPositions;\n  vertexNormals: OctahedronVertexNormals;\n  indices: MeshVertexIndices;\n  strips: boolean;\n}\n\nexport interface MultiscaleFragmentFormat {\n  /**\n   * If `true`, vertex positions are specified relative to the fragment bounds, meaning (0, 0, 0) is\n   * the start corner of the fragment and (1, 1, 1) is the end corner.\n   *\n   * If `false`, vertex positions are in \"model\" coordinates.\n   */\n  fragmentRelativeVertices: boolean;\n\n  transform: mat4;\n  vertexPositionFormat: VertexPositionFormat;\n}\n\nexport enum VertexPositionFormat {\n  float32,\n  uint10,\n  uint16,\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {ChunkState} from 'neuroglancer/chunk_manager/base';\nimport {Chunk, ChunkManager, ChunkSource} from 'neuroglancer/chunk_manager/frontend';\nimport {EncodedMeshData, FRAGMENT_SOURCE_RPC_ID, MESH_LAYER_RPC_ID, MULTISCALE_FRAGMENT_SOURCE_RPC_ID, MULTISCALE_MESH_LAYER_RPC_ID, MultiscaleFragmentFormat, VertexPositionFormat} from 'neuroglancer/mesh/base';\nimport {getMultiscaleChunksToDraw, getMultiscaleFragmentKey, MultiscaleMeshManifest} from 'neuroglancer/mesh/multiscale';\nimport {PerspectiveViewReadyRenderContext, PerspectiveViewRenderContext, PerspectiveViewRenderLayer} from 'neuroglancer/perspective_view/render_layer';\nimport {forEachVisibleSegment, getObjectKey} from 'neuroglancer/segmentation_display_state/base';\nimport {getObjectColor, registerRedrawWhenSegmentationDisplayState3DChanged, SegmentationDisplayState3D, SegmentationLayerSharedObject} from 'neuroglancer/segmentation_display_state/frontend';\nimport {Borrowed} from 'neuroglancer/util/disposable';\nimport {getFrustrumPlanes, mat3, mat3FromMat4, mat4, vec3, vec4} from 'neuroglancer/util/geom';\nimport {getObjectId} from 'neuroglancer/util/object_id';\nimport {Buffer} from 'neuroglancer/webgl/buffer';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {ShaderBuilder, ShaderModule, ShaderProgram} from 'neuroglancer/webgl/shader';\nimport {registerSharedObjectOwner, RPC} from 'neuroglancer/worker_rpc';\n\nconst tempMat4 = mat4.create();\nconst tempModelMatrix = mat4.create();\nconst tempMat3 = mat3.create();\n\nconst DEBUG_MULTISCALE_FRAGMENTS = false;\n\nfunction copyMeshDataToGpu(gl: GL, chunk: FragmentChunk|MultiscaleFragmentChunk) {\n  chunk.vertexBuffer =\n      Buffer.fromData(gl, chunk.meshData.vertexPositions, gl.ARRAY_BUFFER, gl.STATIC_DRAW);\n  chunk.indexBuffer =\n      Buffer.fromData(gl, chunk.meshData.indices, gl.ELEMENT_ARRAY_BUFFER, gl.STATIC_DRAW);\n  chunk.normalBuffer =\n      Buffer.fromData(gl, chunk.meshData.vertexNormals, gl.ARRAY_BUFFER, gl.STATIC_DRAW);\n}\n\nfunction freeGpuMeshData(chunk: FragmentChunk|MultiscaleFragmentChunk) {\n  chunk.vertexBuffer.dispose();\n  chunk.indexBuffer.dispose();\n  chunk.normalBuffer.dispose();\n}\n\n/**\n * Decodes normal vectors in 2xSnorm8 octahedron encoding into normalized 3x32f vector.\n *\n * Zina H. Cigolle, Sam Donow, Daniel Evangelakos, Michael Mara, Morgan McGuire, and Quirin Meyer,\n * Survey of Efficient Representations for Independent Unit Vectors, Journal of Computer Graphics\n * Techniques (JCGT), vol. 3, no. 2, 1-30, 2014\n *\n * Available online http://jcgt.org/published/0003/02/01/\n */\nconst glsl_decodeNormalOctahedronSnorm8 = `\nhighp vec3 decodeNormalOctahedronSnorm8(highp vec2 e) {\n  vec3 v = vec3(e.xy, 1.0 - abs(e.x) - abs(e.y));\n  if (v.z < 0.0) v.xy = (1.0 - abs(v.yx)) * vec2(v.x > 0.0 ? 1.0 : -1.0, v.y > 0.0 ? 1.0 : -1.0);\n  return normalize(v);\n}\n`;\n\ninterface VertexPositionFormatHandler {\n  defineShader: (builder: ShaderBuilder) => void;\n  bind:\n      (gl: GL, shader: ShaderProgram, fragmentChunk: FragmentChunk|MultiscaleFragmentChunk) => void;\n  endLayer: (gl: GL, shader: ShaderProgram) => void;\n}\n\nfunction getFloatPositionHandler(glAttributeType: number): VertexPositionFormatHandler {\n  return {\n    defineShader: (builder: ShaderBuilder) => {\n      builder.addAttribute('highp vec3', 'aVertexPosition');\n      builder.addVertexCode(`highp vec3 getVertexPosition() { return aVertexPosition; }`);\n    },\n    bind(_gl: GL, shader: ShaderProgram, fragmentChunk: FragmentChunk|MultiscaleFragmentChunk) {\n      fragmentChunk.vertexBuffer.bindToVertexAttrib(\n          shader.attribute('aVertexPosition'),\n          /*components=*/ 3, glAttributeType, /* normalized=*/ true);\n    },\n    endLayer: (gl: GL, shader: ShaderProgram) => {\n      gl.disableVertexAttribArray(shader.attribute('aVertexPosition'));\n    }\n  };\n}\n\nconst vertexPositionHandlers: {[format: number]: VertexPositionFormatHandler} = {\n  [VertexPositionFormat.float32]: getFloatPositionHandler(WebGL2RenderingContext.FLOAT),\n  [VertexPositionFormat.uint16]: getFloatPositionHandler(WebGL2RenderingContext.UNSIGNED_SHORT),\n  [VertexPositionFormat.uint10]: {\n    defineShader: (builder: ShaderBuilder) => {\n      builder.addAttribute('highp uint', 'aVertexPosition');\n      builder.addVertexCode(`\nhighp vec3 getVertexPosition() {\n  return vec3(float(aVertexPosition & 1023u),\n              float((aVertexPosition >> 10) & 1023u),\n              float((aVertexPosition >> 20) & 1023u)) / 1023.0;\n}\n`);\n    },\n    bind(_gl: GL, shader: ShaderProgram, fragmentChunk: FragmentChunk|MultiscaleFragmentChunk) {\n      fragmentChunk.vertexBuffer.bindToVertexAttribI(\n          shader.attribute('aVertexPosition'),\n          /*components=*/ 1, WebGL2RenderingContext.UNSIGNED_INT);\n    },\n    endLayer: (gl: GL, shader: ShaderProgram) => {\n      gl.disableVertexAttribArray(shader.attribute('aVertexPosition'));\n    }\n  },\n};\n\nexport class MeshShaderManager {\n  private tempLightVec = new Float32Array(4);\n  private vertexPositionHandler = vertexPositionHandlers[this.vertexPositionFormat];\n  constructor(\n      public fragmentRelativeVertices: boolean, public vertexPositionFormat: VertexPositionFormat) {\n  }\n\n  defineShader(builder: ShaderBuilder) {\n    this.vertexPositionHandler.defineShader(builder);\n    builder.addAttribute('highp vec2', 'aVertexNormal');\n    builder.addVarying('highp vec4', 'vColor');\n    builder.addUniform('highp vec4', 'uLightDirection');\n    builder.addUniform('highp vec4', 'uColor');\n    builder.addUniform('highp mat3', 'uNormalMatrix');\n    builder.addUniform('highp mat4', 'uModelViewProjection');\n    builder.addUniform('highp uint', 'uPickID');\n    if (this.fragmentRelativeVertices) {\n      builder.addUniform('highp vec3', 'uFragmentOrigin');\n      builder.addUniform('highp vec3', 'uFragmentShape');\n    }\n    builder.addVertexCode(glsl_decodeNormalOctahedronSnorm8);\n    let vertexMain = ``;\n    if (this.fragmentRelativeVertices) {\n      vertexMain += `\nhighp vec3 vertexPosition = uFragmentOrigin + uFragmentShape * getVertexPosition();\nhighp vec3 normalMultiplier = 1.0 / uFragmentShape;\n`;\n    } else {\n      vertexMain += `\nhighp vec3 vertexPosition = getVertexPosition();\nhighp vec3 normalMultiplier = vec3(1.0, 1.0, 1.0);\n`;\n    }\n    vertexMain += `\ngl_Position = uModelViewProjection * vec4(vertexPosition, 1.0);\nvec3 normal = normalize(uNormalMatrix * normalMultiplier * decodeNormalOctahedronSnorm8(aVertexNormal));\nfloat lightingFactor = abs(dot(normal, uLightDirection.xyz)) + uLightDirection.w;\nvColor = vec4(lightingFactor * uColor.rgb, uColor.a);\n`;\n    builder.setVertexMain(vertexMain);\n    builder.setFragmentMain(`emit(vColor, uPickID);`);\n  }\n\n  beginLayer(gl: GL, shader: ShaderProgram, renderContext: PerspectiveViewRenderContext) {\n    let {lightDirection, ambientLighting, directionalLighting} = renderContext;\n    let lightVec = <vec3>this.tempLightVec;\n    vec3.scale(lightVec, lightDirection, directionalLighting);\n    lightVec[3] = ambientLighting;\n    gl.uniform4fv(shader.uniform('uLightDirection'), lightVec);\n  }\n\n  setColor(gl: GL, shader: ShaderProgram, color: vec4) {\n    gl.uniform4fv(shader.uniform('uColor'), color);\n  }\n\n  setPickID(gl: GL, shader: ShaderProgram, pickID: number) {\n    gl.uniform1ui(shader.uniform('uPickID'), pickID);\n  }\n\n  beginModel(\n      gl: GL, shader: ShaderProgram, renderContext: PerspectiveViewRenderContext, modelMat: mat4) {\n    gl.uniformMatrix4fv(\n        shader.uniform('uModelViewProjection'), false,\n        mat4.multiply(tempMat4, renderContext.dataToDevice, modelMat));\n    mat3FromMat4(tempMat3, modelMat);\n    mat3.invert(tempMat3, tempMat3);\n    mat3.transpose(tempMat3, tempMat3);\n    gl.uniformMatrix3fv(shader.uniform('uNormalMatrix'), false, tempMat3);\n  }\n\n  getShader(gl: GL, emitter: ShaderModule) {\n    return gl.memoize.get(\n        `mesh/MeshShaderManager:${getObjectId(emitter)}/` +\n            `${this.fragmentRelativeVertices}/${this.vertexPositionFormat}`,\n        () => {\n          let builder = new ShaderBuilder(gl);\n          builder.require(emitter);\n          this.defineShader(builder);\n          return builder.build();\n        });\n  }\n\n  drawFragmentHelper(\n      gl: GL, shader: ShaderProgram, fragmentChunk: FragmentChunk|MultiscaleFragmentChunk,\n      indexBegin: number, indexEnd: number) {\n    this.vertexPositionHandler.bind(gl, shader, fragmentChunk);\n    const {meshData} = fragmentChunk;\n    fragmentChunk.normalBuffer.bindToVertexAttrib(\n        shader.attribute('aVertexNormal'),\n        /*components=*/ 2, WebGL2RenderingContext.BYTE, /*normalized=*/ true);\n    fragmentChunk.indexBuffer.bind();\n    const {indices} = meshData;\n    gl.drawElements(\n        meshData.strips ? WebGL2RenderingContext.TRIANGLE_STRIP : WebGL2RenderingContext.TRIANGLES,\n        indexEnd - indexBegin,\n        indices.BYTES_PER_ELEMENT === 2 ? WebGL2RenderingContext.UNSIGNED_SHORT :\n                                          WebGL2RenderingContext.UNSIGNED_INT,\n        indexBegin * indices.BYTES_PER_ELEMENT);\n  }\n\n  drawFragment(gl: GL, shader: ShaderProgram, fragmentChunk: FragmentChunk) {\n    const {meshData} = fragmentChunk;\n    const {indices} = meshData;\n    this.drawFragmentHelper(gl, shader, fragmentChunk, 0, indices.length);\n  }\n\n  drawMultiscaleFragment(\n      gl: GL,\n      shader: ShaderProgram,\n      fragmentChunk: MultiscaleFragmentChunk,\n      subChunkBegin: number,\n      subChunkEnd: number,\n  ) {\n    const indexBegin = fragmentChunk.meshData.subChunkOffsets[subChunkBegin];\n    const indexEnd = fragmentChunk.meshData.subChunkOffsets[subChunkEnd];\n    this.drawFragmentHelper(gl, shader, fragmentChunk, indexBegin, indexEnd);\n  }\n\n  endLayer(gl: GL, shader: ShaderProgram) {\n    this.vertexPositionHandler.endLayer(gl, shader);\n    gl.disableVertexAttribArray(shader.attribute('aVertexNormal'));\n  }\n}\n\nexport class MeshLayer extends PerspectiveViewRenderLayer {\n  protected meshShaderManager =\n      new MeshShaderManager(/*fragmentRelativeVertices=*/ false, VertexPositionFormat.float32);\n  private shaders = new Map<ShaderModule, ShaderProgram>();\n  backend: SegmentationLayerSharedObject;\n\n  constructor(\n      public chunkManager: ChunkManager, public source: MeshSource,\n      public displayState: SegmentationDisplayState3D) {\n    super();\n\n    registerRedrawWhenSegmentationDisplayState3DChanged(displayState, this);\n\n    let sharedObject = this.backend =\n        this.registerDisposer(new SegmentationLayerSharedObject(chunkManager, displayState));\n    sharedObject.RPC_TYPE_ID = MESH_LAYER_RPC_ID;\n    sharedObject.initializeCounterpartWithChunkManager({\n      'source': source.addCounterpartRef(),\n    });\n    this.setReady(true);\n    sharedObject.visibility.add(this.visibility);\n    this.registerDisposer(displayState.renderScaleHistogram.visibility.add(this.visibility));\n  }\n\n  protected getShader(emitter: ShaderModule) {\n    let {shaders} = this;\n    let shader = shaders.get(emitter);\n    if (shader === undefined) {\n      shader = this.registerDisposer(this.meshShaderManager.getShader(this.gl, emitter));\n      shaders.set(emitter, shader);\n    }\n    return shader;\n  }\n\n  get isTransparent() {\n    return this.displayState.objectAlpha.value < 1.0;\n  }\n\n  get gl() {\n    return this.chunkManager.chunkQueueManager.gl;\n  }\n\n  draw(renderContext: PerspectiveViewRenderContext) {\n    if (!renderContext.emitColor && renderContext.alreadyEmittedPickID) {\n      // No need for a separate pick ID pass.\n      return;\n    }\n    let {gl, displayState, meshShaderManager} = this;\n    let alpha = Math.min(1.0, displayState.objectAlpha.value);\n    if (alpha <= 0.0) {\n      // Skip drawing.\n      return;\n    }\n    let shader = this.getShader(renderContext.emitter);\n    shader.bind();\n    const objectToDataMatrix = this.displayState.objectToDataTransform.transform;\n    meshShaderManager.beginLayer(gl, shader, renderContext);\n    meshShaderManager.beginModel(gl, shader, renderContext, objectToDataMatrix);\n\n    let {pickIDs} = renderContext;\n    const manifestChunks = this.source.chunks;\n\n    let totalChunks = 0, presentChunks = 0;\n    const {renderScaleHistogram} = this.displayState;\n    const fragmentChunks = this.source.fragmentSource.chunks;\n\n    forEachVisibleSegment(displayState, (objectId, rootObjectId) => {\n      const key = getObjectKey(objectId);\n      const manifestChunk = manifestChunks.get(key);\n      if (manifestChunk === undefined) return;\n      if (renderContext.emitColor) {\n        meshShaderManager.setColor(gl, shader, getObjectColor(displayState, rootObjectId, alpha));\n      }\n      if (renderContext.emitPickID) {\n        meshShaderManager.setPickID(gl, shader, pickIDs.registerUint64(this, objectId));\n      }\n      totalChunks += manifestChunk.fragmentIds.length;\n\n      for (const fragmentId of manifestChunk.fragmentIds) {\n        const fragment = fragmentChunks.get(`${key}/${fragmentId}`);\n        if (fragment !== undefined && fragment.state === ChunkState.GPU_MEMORY) {\n          meshShaderManager.drawFragment(gl, shader, fragment);\n          ++presentChunks;\n        }\n      }\n    });\n\n    if (renderContext.emitColor) {\n      renderScaleHistogram.begin(\n          this.chunkManager.chunkQueueManager.frameNumberCounter.frameNumber);\n      renderScaleHistogram.add(\n          Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY, presentChunks,\n          totalChunks - presentChunks);\n    }\n    meshShaderManager.endLayer(gl, shader);\n  }\n\n  isReady() {\n    const {displayState, source} = this;\n    let ready = true;\n    const fragmentChunks = source.fragmentSource.chunks;\n    forEachVisibleSegment(displayState, objectId => {\n      const key = getObjectKey(objectId);\n      const manifestChunk = source.chunks.get(key);\n      if (manifestChunk === undefined) {\n        ready = false;\n        return;\n      }\n      for (const fragmentId of manifestChunk.fragmentIds) {\n        const fragmentChunk = fragmentChunks.get(`${key}/${fragmentId}`);\n        if (fragmentChunk === undefined || fragmentChunk.state !== ChunkState.GPU_MEMORY) {\n          ready = false;\n          return;\n        }\n      }\n    });\n    return ready;\n  }\n}\n\nexport class ManifestChunk extends Chunk {\n  fragmentIds: string[];\n\n  constructor(source: MeshSource, x: any) {\n    super(source);\n    this.fragmentIds = x.fragmentIds;\n  }\n}\n\nexport class FragmentChunk extends Chunk {\n  source: FragmentSource;\n  vertexBuffer: Buffer;\n  indexBuffer: Buffer;\n  normalBuffer: Buffer;\n  meshData: EncodedMeshData;\n\n  constructor(source: FragmentSource, x: any) {\n    super(source);\n    this.meshData = x;\n  }\n\n  copyToGPU(gl: GL) {\n    super.copyToGPU(gl);\n    copyMeshDataToGpu(gl, this);\n  }\n\n  freeGPUMemory(gl: GL) {\n    super.freeGPUMemory(gl);\n    freeGpuMeshData(this);\n  }\n}\n\nexport class MeshSource extends ChunkSource {\n  fragmentSource = this.registerDisposer(new FragmentSource(this.chunkManager, this));\n  chunks: Map<string, ManifestChunk>;\n  initializeCounterpart(rpc: RPC, options: any) {\n    this.fragmentSource.initializeCounterpart(this.chunkManager.rpc!, {});\n    options['fragmentSource'] = this.fragmentSource.addCounterpartRef();\n    super.initializeCounterpart(rpc, options);\n  }\n  getChunk(x: any) {\n    return new ManifestChunk(this, x);\n  }\n}\n\n@registerSharedObjectOwner(FRAGMENT_SOURCE_RPC_ID)\nexport class FragmentSource extends ChunkSource {\n  chunks: Map<string, FragmentChunk>;\n  get key() {\n    return this.meshSource.key;\n  }\n  constructor(chunkManager: ChunkManager, public meshSource: MeshSource) {\n    super(chunkManager);\n  }\n  getChunk(x: any) {\n    return new FragmentChunk(this, x);\n  }\n}\n\n\nfunction hasFragmentChunk(\n    fragmentChunks: Map<string, MultiscaleFragmentChunk>, objectKey: string, lod: number,\n    chunkIndex: number) {\n  const fragmentChunk = fragmentChunks.get(getMultiscaleFragmentKey(objectKey, lod, chunkIndex));\n  return fragmentChunk !== undefined && fragmentChunk.state === ChunkState.GPU_MEMORY;\n}\n\nexport class MultiscaleMeshLayer extends PerspectiveViewRenderLayer {\n  protected meshShaderManager = new MeshShaderManager(\n      /*fragmentRelativeVertices=*/ this.source.format.fragmentRelativeVertices,\n      this.source.format.vertexPositionFormat);\n  private shaders = new Map<ShaderModule, ShaderProgram>();\n  backend: SegmentationLayerSharedObject;\n\n  constructor(\n      public chunkManager: ChunkManager, public source: MultiscaleMeshSource,\n      public displayState: SegmentationDisplayState3D) {\n    super();\n\n    registerRedrawWhenSegmentationDisplayState3DChanged(displayState, this);\n\n    let sharedObject = this.backend =\n        this.registerDisposer(new SegmentationLayerSharedObject(chunkManager, displayState));\n    sharedObject.RPC_TYPE_ID = MULTISCALE_MESH_LAYER_RPC_ID;\n    sharedObject.initializeCounterpartWithChunkManager({\n      'source': source.addCounterpartRef(),\n    });\n    this.setReady(true);\n    sharedObject.visibility.add(this.visibility);\n    this.registerDisposer(displayState.renderScaleHistogram.visibility.add(this.visibility));\n  }\n\n  protected getShader(emitter: ShaderModule) {\n    let {shaders} = this;\n    let shader = shaders.get(emitter);\n    if (shader === undefined) {\n      shader = this.registerDisposer(this.meshShaderManager.getShader(this.gl, emitter));\n      shaders.set(emitter, shader);\n    }\n    return shader;\n  }\n\n  get isTransparent() {\n    return this.displayState.objectAlpha.value < 1.0;\n  }\n\n  get gl() {\n    return this.chunkManager.chunkQueueManager.gl;\n  }\n\n  draw(renderContext: PerspectiveViewRenderContext) {\n    if (!renderContext.emitColor && renderContext.alreadyEmittedPickID) {\n      // No need for a separate pick ID pass.\n      return;\n    }\n    let {gl, displayState, meshShaderManager} = this;\n    let alpha = Math.min(1.0, displayState.objectAlpha.value);\n    if (alpha <= 0.0) {\n      // Skip drawing.\n      return;\n    }\n    let shader = this.getShader(renderContext.emitter);\n    shader.bind();\n    meshShaderManager.beginLayer(gl, shader, renderContext);\n\n    const {renderScaleHistogram} = this.displayState;\n    if (renderContext.emitColor) {\n      renderScaleHistogram.begin(\n          this.chunkManager.chunkQueueManager.frameNumberCounter.frameNumber);\n    }\n\n    let {pickIDs} = renderContext;\n\n    const objectToDataMatrix = mat4.multiply(\n        tempModelMatrix, this.displayState.objectToDataTransform.transform,\n        this.source.format.transform);\n\n    mat3FromMat4(tempMat3, objectToDataMatrix);\n    const scaleMultiplier = Math.pow(mat3.determinant(tempMat3), 1 / 3);\n\n    const {chunks} = this.source;\n    const fragmentChunks = this.source.fragmentSource.chunks;\n\n    const modelViewProjection =\n        mat4.multiply(mat4.create(), renderContext.dataToDevice, objectToDataMatrix);\n\n    const clippingPlanes = getFrustrumPlanes(new Float32Array(24), modelViewProjection);\n\n    const detailCutoff = this.displayState.renderScaleTarget.value;\n    const {fragmentRelativeVertices} = this.source.format;\n\n    meshShaderManager.beginModel(gl, shader, renderContext, objectToDataMatrix);\n\n    forEachVisibleSegment(displayState, (objectId, rootObjectId) => {\n      const key = getObjectKey(objectId);\n      const manifestChunk = chunks.get(key);\n      if (manifestChunk === undefined) return;\n      const {manifest} = manifestChunk;\n      const {octree, chunkShape, chunkGridSpatialOrigin, vertexOffsets} = manifest;\n      if (renderContext.emitColor) {\n        meshShaderManager.setColor(gl, shader, getObjectColor(displayState, rootObjectId, alpha));\n      }\n      if (renderContext.emitPickID) {\n        meshShaderManager.setPickID(gl, shader, pickIDs.registerUint64(this, objectId));\n      }\n      if (DEBUG_MULTISCALE_FRAGMENTS) {\n        console.log('drawing object, numChunks=', manifest.octree.length / 5, manifest.octree);\n      }\n      getMultiscaleChunksToDraw(\n          manifest, modelViewProjection, clippingPlanes, detailCutoff, renderContext.viewportWidth,\n          renderContext.viewportHeight,\n          (lod, chunkIndex, renderScale) => {\n            const has = hasFragmentChunk(fragmentChunks, key, lod, chunkIndex);\n            if (renderContext.emitColor) {\n              renderScaleHistogram.add(\n                  manifest.lodScales[lod] * scaleMultiplier, renderScale, has ? 1 : 0, has ? 0 : 1);\n            }\n            return has;\n          },\n          (lod, chunkIndex, subChunkBegin, subChunkEnd) => {\n            const fragmentKey = getMultiscaleFragmentKey(key, lod, chunkIndex);\n            const fragmentChunk = fragmentChunks.get(fragmentKey)!;\n            const x = octree[5 * chunkIndex], y = octree[5 * chunkIndex + 1],\n                  z = octree[5 * chunkIndex + 2];\n            const scale = 1 << lod;\n            if (fragmentRelativeVertices) {\n              gl.uniform3f(\n                  shader.uniform('uFragmentOrigin'),\n                  chunkGridSpatialOrigin[0] + (x * chunkShape[0]) * scale +\n                      vertexOffsets[lod * 3 + 0],\n                  chunkGridSpatialOrigin[1] + (y * chunkShape[1]) * scale +\n                      vertexOffsets[lod * 3 + 1],\n                  chunkGridSpatialOrigin[2] + (z * chunkShape[2]) * scale +\n                      vertexOffsets[lod * 3 + 2]);\n              gl.uniform3f(\n                  shader.uniform('uFragmentShape'), chunkShape[0] * scale, chunkShape[1] * scale,\n                  chunkShape[2] * scale);\n            }\n\n            meshShaderManager.drawMultiscaleFragment(\n                gl,\n                shader,\n                fragmentChunk,\n                subChunkBegin,\n                subChunkEnd,\n            );\n          });\n    });\n    meshShaderManager.endLayer(gl, shader);\n  }\n\n  isReady(renderContext: PerspectiveViewReadyRenderContext) {\n    let {displayState} = this;\n    let alpha = Math.min(1.0, displayState.objectAlpha.value);\n    if (alpha <= 0.0) {\n      // Skip drawing.\n      return true;\n    }\n    const objectToDataMatrix = this.displayState.objectToDataTransform.transform;\n    const {chunks} = this.source;\n    const fragmentChunks = this.source.fragmentSource.chunks;\n\n    const modelViewProjection =\n        mat4.multiply(mat4.create(), renderContext.dataToDevice, objectToDataMatrix);\n\n    const clippingPlanes = getFrustrumPlanes(new Float32Array(24), modelViewProjection);\n\n    const detailCutoff = this.displayState.renderScaleTarget.value;\n\n    let hasAllChunks = true;\n\n    forEachVisibleSegment(displayState, (objectId) => {\n      if (!hasAllChunks) return;\n      const key = getObjectKey(objectId);\n      const manifestChunk = chunks.get(key);\n      if (manifestChunk === undefined) {\n        hasAllChunks = false;\n        return;\n      }\n      const {manifest} = manifestChunk;\n      getMultiscaleChunksToDraw(\n          manifest, modelViewProjection, clippingPlanes, detailCutoff, renderContext.viewportWidth,\n          renderContext.viewportHeight, (lod, chunkIndex) => {\n            hasAllChunks = hasAllChunks && hasFragmentChunk(fragmentChunks, key, lod, chunkIndex);\n            return hasAllChunks;\n          }, () => {});\n    });\n    return hasAllChunks;\n  }\n}\n\nexport class MultiscaleManifestChunk extends Chunk {\n  manifest: MultiscaleMeshManifest;\n  source: MultiscaleMeshSource;\n\n  constructor(source: MultiscaleMeshSource, x: any) {\n    super(source);\n    this.manifest = x['manifest'];\n  }\n}\n\nexport class MultiscaleFragmentChunk extends Chunk {\n  meshData: EncodedMeshData&{subChunkOffsets: Uint32Array};\n  source: MultiscaleFragmentSource;\n  vertexBuffer: Buffer;\n  indexBuffer: Buffer;\n  normalBuffer: Buffer;\n\n  constructor(source: MultiscaleFragmentSource, x: any) {\n    super(source);\n    this.meshData = x;\n  }\n\n  copyToGPU(gl: GL) {\n    super.copyToGPU(gl);\n    copyMeshDataToGpu(gl, this);\n  }\n\n  freeGPUMemory(gl: GL) {\n    super.freeGPUMemory(gl);\n    freeGpuMeshData(this);\n  }\n}\n\nexport class MultiscaleMeshSource extends ChunkSource {\n  fragmentSource = this.registerDisposer(new MultiscaleFragmentSource(this.chunkManager, this));\n  chunks: Map<string, MultiscaleManifestChunk>;\n  format: MultiscaleFragmentFormat;\n  constructor(chunkManager: Borrowed<ChunkManager>, options: {format: MultiscaleFragmentFormat}) {\n    super(chunkManager, options);\n    this.format = options.format;\n  }\n  initializeCounterpart(rpc: RPC, options: any) {\n    this.fragmentSource.initializeCounterpart(this.chunkManager.rpc!, {});\n    options['fragmentSource'] = this.fragmentSource.addCounterpartRef();\n    options['format'] = this.format;\n    super.initializeCounterpart(rpc, options);\n  }\n  getChunk(x: any) {\n    return new MultiscaleManifestChunk(this, x);\n  }\n}\n\n@registerSharedObjectOwner(MULTISCALE_FRAGMENT_SOURCE_RPC_ID)\nexport class MultiscaleFragmentSource extends ChunkSource {\n  chunks: Map<string, MultiscaleFragmentChunk>;\n  get key() {\n    return this.meshSource.key;\n  }\n  constructor(chunkManager: ChunkManager, public meshSource: MultiscaleMeshSource) {\n    super(chunkManager);\n  }\n  getChunk(x: any) {\n    return new MultiscaleFragmentChunk(this, x);\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {isAABBVisible, mat4, vec3} from 'neuroglancer/util/geom';\nimport {getOctreeChildIndex} from 'neuroglancer/util/zorder';\n\nexport interface MultiscaleMeshManifest {\n  /**\n   * Size of finest-resolution (base) chunk in object coordinates.\n   */\n  chunkShape: vec3;\n\n  /**\n   * Starting corner position of (0, 0, 0) chunk in object coordinates.\n   */\n  chunkGridSpatialOrigin: vec3;\n\n  /**\n   * Axis-aligned bounding box lower bound of object in object coordinates to use for clipping and\n   * level-of-detail calculations.\n   */\n  clipLowerBound: vec3;\n\n  /**\n   * Axis-aligned bounding box upper bound of object in object coordinates to use for clipping and\n   * level-of-detail calculations.\n   */\n  clipUpperBound: vec3;\n\n  /**\n   * Specifies the number of levels of detail (as `lodScales.length`), and the resolution in object\n   * coordinates for each level of detail.  If `lodScales[lod] === 0`, then level-of-detail `lod`\n   * does not exist.\n   *\n   * Level of detail `0` is the finest resolution.\n   *\n   * The non-zero values must be non-decreasing.\n   *\n   * For each chunk, the chosen `lod` is the largest value such that\n   * `lodScales[lod] <= detailCutoff * pixelSize`, where `pixelSize` is the maximum spatial distance\n   * spanned by a single viewport pixel within the projected image of the chunk.\n   */\n  lodScales: Float32Array;\n\n  /**\n   * C order `[numLods, 3]` array specifying the xyz vertex position offset in object coordinates\n   * for each level of detail.\n   */\n  vertexOffsets: Float32Array;\n\n  /**\n   * Row-major `[n, 5]` array where each row is of the form `[x, y, z, start, end_and_empty]`, where\n   * `x`, `y`, and `z` are the chunk grid coordinates of the entry at a particular level of detail.\n   * Row `n-1` corresponds to level of detail `lodScales.length - 1`, the root of the octree.  Given\n   * a row corresponding to an octree node at level of detail `lod`, bits `start` specifies the row\n   * number of the first child octree node at level of detail `lod-1`, and bits `[0,30]` of\n   * `end_and_empty` specify one past the row number of the last child octree node.  Bit `31` of\n   * `end_and_empty` is set to `1` if the mesh for the octree node is empty and should not be\n   * requested/rendered.\n   */\n  octree: Uint32Array;\n}\n\n/**\n * @param detailCutoff Factor by which the spatial resolution of the mesh may be worse than the\n *     spatial resolution of a single viewport pixel.  For example, a value of 10 means that if a\n *     given portion of the object will be rendered such that a pixel corresponds to 50 nm, then a\n *     mesh level of detail down to 500 nm will be requested for that portion of the object.\n */\nexport function getDesiredMultiscaleMeshChunks(\n    manifest: MultiscaleMeshManifest, modelViewProjection: mat4, clippingPlanes: Float32Array,\n    detailCutoff: number, viewportWidth: number, viewportHeight: number,\n    callback: (lod: number, row: number, renderScale: number, empty: number) => void) {\n  const {octree, lodScales, chunkGridSpatialOrigin, chunkShape} = manifest;\n  const maxLod = lodScales.length - 1;\n  const m00 = modelViewProjection[0], m01 = modelViewProjection[4], m02 = modelViewProjection[8],\n        m10 = modelViewProjection[1], m11 = modelViewProjection[5], m12 = modelViewProjection[9],\n        m30 = modelViewProjection[3], m31 = modelViewProjection[7], m32 = modelViewProjection[11],\n        m33 = modelViewProjection[15];\n\n  const minWXcoeff = m30 > 0 ? 0 : 1;\n  const minWYcoeff = m31 > 0 ? 0 : 1;\n  const minWZcoeff = m32 > 0 ? 0 : 1;\n\n\n  const nearA = clippingPlanes[4 * 4], nearB = clippingPlanes[4 * 4 + 1],\n        nearC = clippingPlanes[4 * 4 + 2], nearD = clippingPlanes[4 * 4 + 3];\n\n  function getPointW(x: number, y: number, z: number) {\n    return m30 * x + m31 * y + m32 * z + m33;\n  }\n\n  function getBoxW(\n      xLower: number, yLower: number, zLower: number, xUpper: number, yUpper: number,\n      zUpper: number) {\n    return getPointW(\n        xLower + minWXcoeff * (xUpper - xLower), yLower + minWYcoeff * (yUpper - yLower),\n        zLower + minWZcoeff * (zUpper - zLower));\n  }\n\n  /**\n   * Minimum value of w within clipping frustrum (under the assumption that the minimum value is\n   * occurs occurs on the near clipping plane).\n   */\n  const minWClip = getPointW(-nearD * nearA, -nearD * nearB, -nearD * nearC);\n\n  const objectXLower = manifest.clipLowerBound[0], objectYLower = manifest.clipLowerBound[1],\n        objectZLower = manifest.clipLowerBound[2];\n  const objectXUpper = manifest.clipUpperBound[0], objectYUpper = manifest.clipUpperBound[1],\n        objectZUpper = manifest.clipUpperBound[2];\n\n  const xScale = Math.sqrt((m00 * viewportWidth) ** 2 + (m10 * viewportHeight) ** 2);\n  const yScale = Math.sqrt((m01 * viewportWidth) ** 2 + (m11 * viewportHeight) ** 2);\n  const zScale = Math.sqrt((m02 * viewportWidth) ** 2 + (m12 * viewportHeight) ** 2);\n\n  const scaleFactor = Math.max(xScale, yScale, zScale);\n\n  function handleChunk(lod: number, row: number, priorLodScale: number) {\n    const size = 1 << lod;\n    const rowOffset = row * 5;\n    const gridX = octree[rowOffset], gridY = octree[rowOffset + 1], gridZ = octree[rowOffset + 2],\n          childBegin = octree[rowOffset + 3], childEndAndEmpty = octree[rowOffset + 4];\n    let xLower = gridX * size * chunkShape[0] + chunkGridSpatialOrigin[0],\n        yLower = gridY * size * chunkShape[1] + chunkGridSpatialOrigin[1],\n        zLower = gridZ * size * chunkShape[2] + chunkGridSpatialOrigin[2];\n    let xUpper = xLower + size * chunkShape[0], yUpper = yLower + size * chunkShape[1],\n        zUpper = zLower + size * chunkShape[2];\n    xLower = Math.max(xLower, objectXLower);\n    yLower = Math.max(yLower, objectYLower);\n    zLower = Math.max(zLower, objectZLower);\n    xUpper = Math.min(xUpper, objectXUpper);\n    yUpper = Math.min(yUpper, objectYUpper);\n    zUpper = Math.min(zUpper, objectZUpper);\n\n    if (isAABBVisible(xLower, yLower, zLower, xUpper, yUpper, zUpper, clippingPlanes)) {\n      const minW = Math.max(minWClip, getBoxW(xLower, yLower, zLower, xUpper, yUpper, zUpper));\n      const pixelSize = minW / scaleFactor;\n\n      if (priorLodScale === 0 || pixelSize * detailCutoff < priorLodScale) {\n        const lodScale = lodScales[lod];\n        if (lodScale !== 0) {\n          callback(lod, row, lodScale / pixelSize, (childEndAndEmpty >>> 31));\n        }\n\n        if (lod > 0 && (lodScale === 0 || pixelSize * detailCutoff < lodScale)) {\n          const nextPriorLodScale = lodScale === 0 ? priorLodScale : lodScale;\n          const childEnd = (childEndAndEmpty & 0x7FFFFFFF) >>> 0;\n          for (let childRow = childBegin; childRow < childEnd; ++childRow) {\n            handleChunk(lod - 1, childRow, nextPriorLodScale);\n          }\n        }\n      }\n    }\n  }\n  handleChunk(maxLod, octree.length / 5 - 1, 0);\n}\n\nexport function getMultiscaleChunksToDraw(\n    manifest: MultiscaleMeshManifest, modelViewProjection: mat4, clippingPlanes: Float32Array,\n    detailCutoff: number, viewportWidth: number, viewportHeight: number,\n    hasChunk: (lod: number, row: number, renderScale: number) => boolean,\n    callback: (\n        lod: number, row: number, subChunkBegin: number, subChunkEnd: number,\n        renderScale: number) => void) {\n  const {lodScales} = manifest;\n  let maxLod = 0;\n  while (maxLod + 1 < lodScales.length && lodScales[maxLod + 1] !== 0) {\n    ++maxLod;\n  }\n  const stackEntryStride = 3;\n\n  // [row, parentSubChunkIndex, renderScale]\n  const stack: number[] = [];\n  let stackDepth = 0;\n  let priorSubChunkIndex = 0;\n  function emitChunksUpTo(targetStackIndex: number, subChunkIndex: number) {\n    while (true) {\n      if (stackDepth === 0) return;\n\n      // Finish last chunk of last (finest) lod.\n      const stackIndex = stackDepth - 1;\n      const entryLod = maxLod - stackIndex;\n      const entryRow = stack[stackIndex * stackEntryStride];\n      const numSubChunks = entryLod === 0 ? 1 : 8;\n      const entrySubChunkIndex = stack[stackIndex * stackEntryStride + 1];\n      const entryRenderScale = stack[stackIndex * stackEntryStride + 2];\n      if (targetStackIndex === stackDepth) {\n        const endSubChunk = subChunkIndex & (numSubChunks - 1);\n\n        if (priorSubChunkIndex !== endSubChunk && entryRow !== -1) {\n          callback(entryLod, entryRow, priorSubChunkIndex, endSubChunk, entryRenderScale);\n        }\n        priorSubChunkIndex = endSubChunk + 1;\n        return;\n      }\n      if (priorSubChunkIndex !== numSubChunks && entryRow !== -1) {\n        callback(entryLod, entryRow, priorSubChunkIndex, numSubChunks, entryRenderScale);\n      }\n      priorSubChunkIndex = entrySubChunkIndex + 1;\n      --stackDepth;\n    }\n  }\n\n  let priorMissingLod = 0;\n\n  const {octree} = manifest;\n  getDesiredMultiscaleMeshChunks(\n      manifest, modelViewProjection, clippingPlanes, detailCutoff, viewportWidth, viewportHeight,\n      (lod, row, renderScale, empty) => {\n        if (!empty && !hasChunk(lod, row, renderScale)) {\n          priorMissingLod = Math.max(lod, priorMissingLod);\n          return;\n        }\n        if (lod < priorMissingLod) return;\n        priorMissingLod = 0;\n        const rowOffset = row * 5;\n        const x = octree[rowOffset], y = octree[rowOffset + 1], z = octree[rowOffset + 2];\n        const subChunkIndex = getOctreeChildIndex(x, y, z);\n        const stackIndex = maxLod - lod;\n        emitChunksUpTo(stackIndex, subChunkIndex);\n        const stackOffset = stackIndex * stackEntryStride;\n        stack[stackOffset] = empty ? -1 : row;\n        stack[stackOffset + 1] = subChunkIndex;\n        stack[stackOffset + 2] = renderScale;\n        priorSubChunkIndex = 0;\n        stackDepth = stackIndex + 1;\n      });\n\n  emitChunksUpTo(0, 0);\n}\n\nexport function validateOctree(octree: Uint32Array) {\n  if (octree.length % 5 !== 0) {\n    throw new Error('Invalid length');\n  }\n  const numNodes = octree.length / 5;\n  const seenNodes = new Set<number>();\n  function exploreNode(node: number) {\n    if (seenNodes.has(node)) {\n      throw new Error('Previously seen node');\n    }\n    seenNodes.add(node);\n    if (node < 0 || node >= numNodes) {\n      throw new Error('Invalid node reference');\n    }\n    const x = octree[node * 5], y = octree[node * 5 + 1], z = octree[node * 5 + 2],\n          beginChild = octree[node * 5 + 3], endChild = octree[node * 5 + 4];\n    if (beginChild < 0 || endChild < 0 || endChild < beginChild || endChild > numNodes ||\n        beginChild + 8 < endChild) {\n      throw new Error('Invalid child references');\n    }\n    for (let child = beginChild; child < endChild; ++child) {\n      const childX = octree[child * 5], childY = octree[child * 5 + 1],\n            childZ = octree[child * 5 + 2];\n      if ((childX >>> 1) !== x || (childY >>> 1) !== y || (childZ >>> 1) != z) {\n        throw new Error('invalid child');\n      }\n      exploreNode(child);\n    }\n  }\n  if (numNodes === 0) return;\n  exploreNode(numNodes - 1);\n}\n\nexport function getMultiscaleFragmentKey(objectKey: string, lod: number, chunkIndex: number) {\n  return `${objectKey}/${lod}:${chunkIndex}`;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Borrowed, Owned, RefCounted} from 'neuroglancer/util/disposable';\nimport {mat3, mat4, quat, vec3} from 'neuroglancer/util/geom';\nimport {parseFiniteVec, verifyObject, verifyObjectProperty} from 'neuroglancer/util/json';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {Trackable} from 'neuroglancer/util/trackable';\nimport {TrackableEnum} from 'neuroglancer/util/trackable_enum';\n\nexport enum NavigationLinkType {\n  LINKED,\n  RELATIVE,\n  UNLINKED,\n}\n\nexport class TrackableNavigationLink extends TrackableEnum<NavigationLinkType> {\n  constructor(value = NavigationLinkType.LINKED) {\n    super(NavigationLinkType, value);\n  }\n}\n\nexport class VoxelSize extends RefCounted {\n  size: vec3;\n  valid: boolean;\n  changed = new NullarySignal();\n  constructor(voxelSize?: vec3) {\n    super();\n    let valid = true;\n    if (voxelSize == null) {\n      voxelSize = vec3.create();\n      valid = false;\n    }\n    this.size = voxelSize;\n    this.valid = valid;\n  }\n\n  reset() {\n    this.valid = false;\n    this.changed.dispatch();\n  }\n\n  /**\n   * This should be called after setting the voxel size initially.  The voxel\n   * size should not be changed once it is valid.\n   */\n  setValid() {\n    if (!this.valid) {\n      this.valid = true;\n      this.changed.dispatch();\n    }\n  }\n\n  toJSON() {\n    if (!this.valid) {\n      return undefined;\n    }\n    return Array.prototype.slice.call(this.size);\n  }\n\n  restoreState(obj: any) {\n    try {\n      parseFiniteVec(this.size, obj);\n      this.valid = true;\n      this.changed.dispatch();\n    } catch (e) {\n      this.valid = false;\n      this.changed.dispatch();\n    }\n  }\n\n  toString() {\n    if (!this.valid) {\n      return null;\n    }\n    return this.size.toString();\n  }\n\n  voxelFromSpatial(voxel: vec3, spatial: vec3) {\n    return vec3.divide(voxel, spatial, this.size);\n  }\n\n  spatialFromVoxel(spatial: vec3, voxel: vec3) {\n    return vec3.multiply(spatial, voxel, this.size);\n  }\n}\n\nconst tempVec3 = vec3.create();\nconst tempQuat = quat.create();\n\nfunction makeLinked<T extends RefCounted&{changed: NullarySignal}, Difference>(\n    self: T, peer: T, link: TrackableNavigationLink, operations: {\n      assign: (target: T, source: T) => void,\n      isValid: (a: T) => boolean,\n      difference: (a: T, b: T) => Difference,\n      add: (target: T, source: T, amount: Difference) => void,\n      subtract: (target: T, source: T, amount: Difference) => void\n    }) {\n  let updatingSelf = false;\n  let updatingPeer = false;\n  let selfMinusPeer: Difference|undefined;\n  self.registerDisposer(peer);\n  const handlePeerUpdate = () => {\n    if (updatingPeer) {\n      return;\n    }\n    updatingSelf = true;\n    switch (link.value) {\n      case NavigationLinkType.UNLINKED:\n        if (operations.isValid(self)) {\n          break;\n        } else {\n          // Fallthrough to LINKED case.\n        }\n      case NavigationLinkType.LINKED:\n        operations.assign(self, peer);\n        break;\n      case NavigationLinkType.RELATIVE:\n        operations.add(self, peer, selfMinusPeer!);\n        break;\n    }\n    updatingSelf = false;\n  };\n  const handleSelfUpdate = () => {\n    if (updatingSelf) {\n      return;\n    }\n    switch (link.value) {\n      case NavigationLinkType.UNLINKED:\n        break;\n      case NavigationLinkType.LINKED:\n        operations.assign(peer, self);\n        break;\n      case NavigationLinkType.RELATIVE:\n        operations.subtract(peer, self, selfMinusPeer!);\n        break;\n    }\n  };\n  let previousLinkValue = NavigationLinkType.UNLINKED;\n  const handleLinkUpdate = () => {\n    const linkValue = link.value;\n    if (linkValue !== previousLinkValue) {\n      switch (linkValue) {\n        case NavigationLinkType.UNLINKED:\n          selfMinusPeer = undefined;\n          break;\n        case NavigationLinkType.LINKED:\n          selfMinusPeer = undefined;\n          operations.assign(self, peer);\n          break;\n        case NavigationLinkType.RELATIVE:\n          selfMinusPeer = operations.difference(self, peer);\n          break;\n      }\n    }\n    previousLinkValue = linkValue;\n    self.changed.dispatch();\n  };\n  self.registerDisposer(self.changed.add(handleSelfUpdate));\n  self.registerDisposer(peer.changed.add(handlePeerUpdate));\n  self.registerDisposer(link.changed.add(handleLinkUpdate));\n  handleLinkUpdate();\n  return self;\n}\n\ninterface SpatialPositionOffset {\n  spatialOffset?: vec3;\n  voxelOffset?: vec3;\n}\n\nexport class SpatialPosition extends RefCounted {\n  voxelSize: VoxelSize;\n  spatialCoordinates: vec3;\n  spatialCoordinatesValid: boolean;\n  protected voxelCoordinates: vec3|null = null;\n  changed = new NullarySignal();\n  constructor(voxelSize?: Owned<VoxelSize>, spatialCoordinates?: vec3) {\n    super();\n    if (voxelSize == null) {\n      voxelSize = new VoxelSize();\n    }\n    this.voxelSize = voxelSize;\n\n    let spatialCoordinatesValid = true;\n    if (spatialCoordinates == null) {\n      spatialCoordinates = vec3.create();\n      spatialCoordinatesValid = false;\n    }\n    this.spatialCoordinates = spatialCoordinates;\n    this.spatialCoordinatesValid = spatialCoordinatesValid;\n\n    this.registerDisposer(voxelSize);\n    this.registerDisposer(voxelSize.changed.add(() => {\n      this.handleVoxelSizeChanged();\n    }));\n  }\n\n  get valid() {\n    return this.spatialCoordinatesValid && this.voxelSize.valid;\n  }\n\n  get voxelCoordinatesValid() {\n    return this.valid || this.voxelCoordinates != null;\n  }\n\n  reset() {\n    this.spatialCoordinatesValid = false;\n    this.voxelCoordinates = null;\n    this.voxelSize.reset();\n    this.changed.dispatch();\n  }\n\n  getVoxelCoordinates(out: vec3) {\n    let {voxelCoordinates} = this;\n    if (voxelCoordinates) {\n      vec3.copy(out, voxelCoordinates);\n    } else if (this.valid) {\n      this.voxelSize.voxelFromSpatial(out, this.spatialCoordinates);\n    } else {\n      return false;\n    }\n    return true;\n  }\n\n  /**\n   * Sets this position to the spatial coordinats corresponding to the specified\n   * voxelPosition.  If this.voxelSize.valid == false, then this position won't\n   * be set until it is.\n   */\n  setVoxelCoordinates(voxelCoordinates: vec3) {\n    let voxelSize = this.voxelSize;\n    if (voxelSize.valid) {\n      voxelSize.spatialFromVoxel(this.spatialCoordinates, voxelCoordinates);\n      this.markSpatialCoordinatesChanged();\n    } else {\n      let voxelCoordinates_ = this.voxelCoordinates;\n      if (!voxelCoordinates_) {\n        this.voxelCoordinates = voxelCoordinates_ = vec3.clone(voxelCoordinates);\n      } else {\n        vec3.copy(voxelCoordinates_, voxelCoordinates);\n      }\n    }\n    this.changed.dispatch();\n  }\n\n  markSpatialCoordinatesChanged() {\n    this.spatialCoordinatesValid = true;\n    this.voxelCoordinates = null;\n    this.changed.dispatch();\n  }\n\n  private handleVoxelSizeChanged() {\n    if (this.voxelCoordinates != null && !this.spatialCoordinatesValid) {\n      this.voxelSize.spatialFromVoxel(this.spatialCoordinates, this.voxelCoordinates);\n      this.spatialCoordinatesValid = true;\n    }\n    this.voxelCoordinates = null;\n    this.changed.dispatch();\n  }\n\n  toJSON() {\n    let empty = true;\n    let voxelSizeJson = this.voxelSize.toJSON();\n    let obj: any = {};\n    if (voxelSizeJson !== undefined) {\n      empty = false;\n      obj['voxelSize'] = voxelSizeJson;\n    }\n    if (this.voxelCoordinatesValid) {\n      let voxelCoordinates = tempVec3;\n      this.getVoxelCoordinates(voxelCoordinates);\n      obj['voxelCoordinates'] = Array.prototype.slice.call(voxelCoordinates);\n      empty = false;\n    } else if (this.spatialCoordinatesValid) {\n      obj['spatialCoordinates'] = Array.prototype.slice.call(this.spatialCoordinates);\n      empty = false;\n    }\n    if (empty) {\n      return undefined;\n    }\n    return obj;\n  }\n\n  restoreState(obj: any) {\n    verifyObject(obj);\n    verifyObjectProperty(obj, 'voxelSize', x => {\n      if (x !== undefined) {\n        this.voxelSize.restoreState(x);\n      }\n    });\n    this.spatialCoordinatesValid = false;\n    verifyObjectProperty(obj, 'voxelCoordinates', x => {\n      if (x !== undefined) {\n        this.setVoxelCoordinates(parseFiniteVec(vec3.create(), x));\n      }\n    });\n    verifyObjectProperty(obj, 'spatialCoordinates', x => {\n      if (x !== undefined) {\n        parseFiniteVec(this.spatialCoordinates, x);\n        this.markSpatialCoordinatesChanged();\n      }\n    });\n  }\n\n  snapToVoxel() {\n    if (!this.valid) {\n      let {voxelCoordinates} = this;\n      if (voxelCoordinates != null) {\n        for (let i = 0; i < 3; ++i) {\n          voxelCoordinates[i] = Math.round(voxelCoordinates[i]);\n        }\n        this.changed.dispatch();\n      }\n    } else {\n      let spatialCoordinates = this.spatialCoordinates;\n      let voxelSize = this.voxelSize.size;\n      for (let i = 0; i < 3; ++i) {\n        let voxelSizeValue = voxelSize[i];\n        spatialCoordinates[i] = Math.round(spatialCoordinates[i] / voxelSizeValue) * voxelSizeValue;\n      }\n      this.changed.dispatch();\n    }\n  }\n\n  assign(other: Borrowed<SpatialPosition>) {\n    this.spatialCoordinatesValid = other.spatialCoordinatesValid;\n    vec3.copy(this.spatialCoordinates, other.spatialCoordinates);\n    const {voxelCoordinates} = other;\n    this.voxelCoordinates = voxelCoordinates && vec3.clone(voxelCoordinates);\n    this.changed.dispatch();\n  }\n\n  /**\n   * Get the offset of `a` relative to `b`.\n   */\n  static getOffset(a: SpatialPosition, b: SpatialPosition): SpatialPositionOffset {\n    if (a.spatialCoordinatesValid && b.spatialCoordinatesValid) {\n      return {\n        spatialOffset: vec3.subtract(vec3.create(), a.spatialCoordinates, b.spatialCoordinates)\n      };\n    }\n    if (a.voxelCoordinates && b.voxelCoordinates) {\n      if (a.voxelSize !== b.voxelSize) {\n        throw new Error('Voxel offsets are only meaningful with identical voxelSize.');\n      }\n      return {voxelOffset: vec3.subtract(vec3.create(), a.voxelCoordinates, b.voxelCoordinates)};\n    }\n    return {};\n  }\n  static addOffset(\n      target: SpatialPosition, source: SpatialPosition, offset: SpatialPositionOffset,\n      scale: number = 1): void {\n    const {spatialOffset, voxelOffset} = offset;\n    if (spatialOffset !== undefined && source.spatialCoordinatesValid) {\n      vec3.scaleAndAdd(target.spatialCoordinates, source.spatialCoordinates, spatialOffset, scale);\n      target.markSpatialCoordinatesChanged();\n    } else if (voxelOffset !== undefined && source.getVoxelCoordinates(tempVec3)) {\n      target.setVoxelCoordinates(vec3.scaleAndAdd(tempVec3, tempVec3, voxelOffset, scale));\n    }\n  }\n}\n\nabstract class LinkedBase<T extends RefCounted&Trackable&{assign(other: T): void}> implements\n    Trackable {\n  value: T;\n  get changed() {\n    return this.value.changed;\n  }\n  constructor(public peer: Owned<T>, public link = new TrackableNavigationLink()) {}\n\n  toJSON() {\n    const {link} = this;\n    if (link.value === NavigationLinkType.LINKED) {\n      return undefined;\n    }\n    return {link: link.toJSON(), value: this.getValueJson()};\n  }\n\n  protected getValueJson(): any {\n    return this.value.toJSON();\n  }\n\n  reset() {\n    this.link.value = NavigationLinkType.LINKED;\n  }\n\n  restoreState(obj: any) {\n    if (obj === undefined || Object.keys(obj).length === 0) {\n      this.link.value = NavigationLinkType.LINKED;\n      return;\n    }\n    verifyObject(obj);\n    this.link.value = NavigationLinkType.UNLINKED;\n    verifyObjectProperty(obj, 'value', x => {\n      if (x !== undefined) {\n        this.value.restoreState(x);\n      }\n    });\n    verifyObjectProperty(obj, 'link', x => this.link.restoreState(x));\n  }\n\n  copyToPeer() {\n    if (this.link.value !== NavigationLinkType.LINKED) {\n      this.link.value = NavigationLinkType.UNLINKED;\n      this.peer.assign(this.value);\n      this.link.value = NavigationLinkType.LINKED;\n    }\n  }\n}\n\nexport class LinkedSpatialPosition extends LinkedBase<SpatialPosition> {\n  value = makeLinked(new SpatialPosition(this.peer.voxelSize.addRef()), this.peer, this.link, {\n    assign: (a: SpatialPosition, b: SpatialPosition) => a.assign(b),\n    isValid:\n        (a: SpatialPosition) => {\n          return a.spatialCoordinatesValid || a.voxelCoordinatesValid;\n        },\n    difference: SpatialPosition.getOffset,\n    add: SpatialPosition.addOffset,\n    subtract:\n        (target: SpatialPosition, source: SpatialPosition, amount: SpatialPositionOffset) => {\n          SpatialPosition.addOffset(target, source, amount, -1);\n        },\n  });\n\n  protected getValueJson() {\n    const value = this.value.toJSON() || {};\n    delete value['voxelSize'];\n    return value;\n  }\n}\n\nfunction quaternionIsIdentity(q: quat) {\n  return q[0] === 0 && q[1] === 0 && q[2] === 0 && q[3] === 1;\n}\n\nexport class OrientationState extends RefCounted {\n  orientation: quat;\n  changed = new NullarySignal();\n\n  constructor(orientation?: quat) {\n    super();\n    if (orientation == null) {\n      orientation = quat.create();\n    }\n    this.orientation = orientation;\n  }\n  toJSON() {\n    let {orientation} = this;\n    quat.normalize(this.orientation, this.orientation);\n    if (quaternionIsIdentity(orientation)) {\n      return undefined;\n    }\n    return Array.prototype.slice.call(this.orientation);\n  }\n  restoreState(obj: any) {\n    try {\n      parseFiniteVec(this.orientation, obj);\n      quat.normalize(this.orientation, this.orientation);\n    } catch (ignoredError) {\n      quat.identity(this.orientation);\n    }\n    this.changed.dispatch();\n  }\n\n  reset() {\n    quat.identity(this.orientation);\n    this.changed.dispatch();\n  }\n\n  snap() {\n    let mat = mat3.create();\n    mat3.fromQuat(mat, this.orientation);\n    let usedAxes = [false, false, false];\n    for (let i = 0; i < 3; ++i) {\n      let maxComponent = 0;\n      let argmaxComponent = 0;\n      for (let j = 0; j < 3; ++j) {\n        let value = mat[i * 3 + j];\n        mat[i * 3 + j] = 0;\n        if (usedAxes[j]) {\n          continue;\n        }\n        if (Math.abs(value) > Math.abs(maxComponent)) {\n          maxComponent = value;\n          argmaxComponent = j;\n        }\n      }\n      mat[i * 3 + argmaxComponent] = Math.sign(maxComponent);\n      usedAxes[argmaxComponent] = true;\n    }\n    quat.fromMat3(this.orientation, mat);\n    this.changed.dispatch();\n  }\n\n  /**\n   * Returns a new OrientationState with orientation fixed to peerToSelf * peer.orientation.  Any\n   * changes to the returned OrientationState will cause a corresponding change in peer, and vice\n   * versa.\n   */\n  static makeRelative(peer: OrientationState, peerToSelf: quat) {\n    let self = new OrientationState(quat.multiply(quat.create(), peer.orientation, peerToSelf));\n    let updatingPeer = false;\n    self.registerDisposer(peer.changed.add(() => {\n      if (!updatingPeer) {\n        updatingSelf = true;\n        quat.multiply(self.orientation, peer.orientation, peerToSelf);\n        self.changed.dispatch();\n        updatingSelf = false;\n      }\n    }));\n    let updatingSelf = false;\n    const selfToPeer = quat.invert(quat.create(), peerToSelf);\n    self.registerDisposer(self.changed.add(() => {\n      if (!updatingSelf) {\n        updatingPeer = true;\n        quat.multiply(peer.orientation, self.orientation, selfToPeer);\n        peer.changed.dispatch();\n        updatingPeer = false;\n      }\n    }));\n    return self;\n  }\n\n  assign(other: Borrowed<OrientationState>) {\n    quat.copy(this.orientation, other.orientation);\n    this.changed.dispatch();\n  }\n}\n\nexport class LinkedOrientationState extends LinkedBase<OrientationState> {\n  value = makeLinked(new OrientationState(), this.peer, this.link, {\n    assign: (a: OrientationState, b: OrientationState) => a.assign(b),\n    isValid: () => true,\n    difference:\n        (a: OrientationState, b: OrientationState) => {\n          const temp = quat.create();\n          return quat.multiply(temp, quat.invert(temp, b.orientation), a.orientation);\n        },\n    add:\n        (target: OrientationState, source: OrientationState, amount: quat) => {\n          quat.multiply(target.orientation, source.orientation, amount);\n          target.changed.dispatch();\n        },\n    subtract:\n        (target: OrientationState, source: OrientationState, amount: quat) => {\n          quat.multiply(target.orientation, source.orientation, quat.invert(tempQuat, amount));\n          target.changed.dispatch();\n        }\n  });\n}\n\nexport class Pose extends RefCounted {\n  position: SpatialPosition;\n  orientation: OrientationState;\n  changed = new NullarySignal();\n  constructor(position?: Owned<SpatialPosition>, orientation?: Owned<OrientationState>) {\n    super();\n    if (position == null) {\n      position = new SpatialPosition();\n    }\n    this.position = position;\n    if (orientation == null) {\n      orientation = new OrientationState();\n    }\n    this.orientation = orientation;\n    this.registerDisposer(this.position);\n    this.registerDisposer(this.orientation);\n    this.registerDisposer(this.position.changed.add(this.changed.dispatch));\n    this.registerDisposer(this.orientation.changed.add(this.changed.dispatch));\n  }\n\n  get valid() {\n    return this.position.valid;\n  }\n\n  /**\n   * Resets everything.\n   */\n  reset() {\n    this.position.reset();\n    this.orientation.reset();\n  }\n\n  toMat4(mat: mat4) {\n    mat4.fromRotationTranslation(\n        mat, this.orientation.orientation, this.position.spatialCoordinates);\n  }\n\n  toJSON() {\n    let positionJson = this.position.toJSON();\n    let orientationJson = this.orientation.toJSON();\n    if (positionJson === undefined && orientationJson === undefined) {\n      return undefined;\n    }\n    return {'position': positionJson, 'orientation': orientationJson};\n  }\n\n  restoreState(obj: any) {\n    verifyObject(obj);\n    verifyObjectProperty(obj, 'position', x => {\n      if (x !== undefined) {\n        this.position.restoreState(x);\n      }\n    });\n    verifyObjectProperty(obj, 'orientation', x => {\n      if (x !== undefined) {\n        this.orientation.restoreState(x);\n      }\n    });\n  }\n\n  /**\n   * Snaps the orientation to the nearest axis-aligned orientation, and\n   * snaps the position to the nearest voxel.\n   */\n  snap() {\n    this.orientation.snap();\n    this.position.snapToVoxel();\n    this.changed.dispatch();\n  }\n  translateAbsolute(translation: vec3) {\n    vec3.add(this.position.spatialCoordinates, this.position.spatialCoordinates, translation);\n    this.position.changed.dispatch();\n  }\n  translateRelative(translation: vec3) {\n    if (!this.valid) {\n      return;\n    }\n    const temp = tempVec3;\n    vec3.transformQuat(temp, translation, this.orientation.orientation);\n    vec3.add(this.position.spatialCoordinates, this.position.spatialCoordinates, temp);\n    this.position.changed.dispatch();\n  }\n  translateVoxelsRelative(translation: vec3) {\n    if (!this.valid) {\n      return;\n    }\n    var temp = vec3.create();\n    vec3.transformQuat(temp, translation, this.orientation.orientation);\n    vec3.multiply(temp, temp, this.position.voxelSize.size);\n    vec3.add(this.position.spatialCoordinates, this.position.spatialCoordinates, temp);\n    this.position.changed.dispatch();\n  }\n  rotateRelative(axis: vec3, angle: number) {\n    var temp = quat.create();\n    quat.setAxisAngle(temp, axis, angle);\n    var orientation = this.orientation.orientation;\n    quat.multiply(orientation, orientation, temp);\n    this.orientation.changed.dispatch();\n  }\n\n  rotateAbsolute(axis: vec3, angle: number, fixedPoint?: vec3) {\n    var temp = quat.create();\n    quat.setAxisAngle(temp, axis, angle);\n    var orientation = this.orientation.orientation;\n    if (fixedPoint !== undefined) {\n      // We want the coordinates in the transformed coordinate frame of the fixed point to remain\n      // the same after the rotation.\n\n      // We have the invariants:\n      // oldOrienation * fixedPointLocal + oldPosition == fixedPoint.\n      // newOrientation * fixedPointLocal + newPosition == fixedPoint.\n\n      // Therefore, we compute fixedPointLocal by:\n      // fixedPointLocal == inverse(oldOrientation) * (fixedPoint - oldPosition).\n      let {spatialCoordinates} = this.position;\n      let fixedPointLocal = vec3.subtract(tempVec3, fixedPoint, spatialCoordinates);\n      let invOrientation = quat.invert(tempQuat, orientation);\n      vec3.transformQuat(fixedPointLocal, fixedPointLocal, invOrientation);\n\n      // We then compute the newPosition by:\n      // newPosition := fixedPoint - newOrientation * fixedPointLocal.\n      quat.multiply(orientation, temp, orientation);\n      vec3.transformQuat(spatialCoordinates, fixedPointLocal, orientation);\n      vec3.subtract(spatialCoordinates, fixedPoint, spatialCoordinates);\n\n      this.position.changed.dispatch();\n    } else {\n      quat.multiply(orientation, temp, orientation);\n    }\n    this.orientation.changed.dispatch();\n  }\n}\n\nexport class TrackableZoomState extends RefCounted {\n  constructor(private value_ = Number.NaN, public defaultValue = value_) {\n    super();\n  }\n  get value() {\n    return this.value_;\n  }\n  set value(newValue: number) {\n    if (newValue !== this.value_) {\n      this.value_ = newValue;\n      this.changed.dispatch();\n    }\n  }\n  changed = new NullarySignal();\n\n  toJSON() {\n    let {value_, defaultValue} = this;\n    if (Number.isNaN(value_) && Number.isNaN(defaultValue) || value_ === defaultValue) {\n      return undefined;\n    }\n    return value_;\n  }\n\n  restoreState(obj: any) {\n    if (typeof obj === 'number' && Number.isFinite(obj) && obj > 0) {\n      this.value = obj;\n    } else {\n      this.value = this.defaultValue;\n    }\n  }\n\n  reset() {\n    this.value = this.defaultValue;\n  }\n\n  zoomBy(factor: number) {\n    let {value_} = this;\n    if (Number.isNaN(value_)) {\n      return;\n    }\n    this.value = value_ * factor;\n  }\n\n  assign(other: TrackableZoomState) {\n    this.value = other.value;\n  }\n\n  get valid() {\n    return !Number.isNaN(this.value);\n  }\n}\n\nexport class LinkedZoomState extends LinkedBase<TrackableZoomState> {\n  value = (() => {\n    const self = new TrackableZoomState();\n    const assign = (target: TrackableZoomState, source: TrackableZoomState) =>\n        target.assign(source);\n    const difference = (a: TrackableZoomState, b: TrackableZoomState) => {\n      return a.value / b.value;\n    };\n    const add = (target: TrackableZoomState, source: TrackableZoomState, amount: number) => {\n      target.value = source.value * amount;\n    };\n    const subtract = (target: TrackableZoomState, source: TrackableZoomState, amount: number) => {\n      target.value = source.value / amount;\n    };\n    const isValid = (x: TrackableZoomState) => x.valid;\n    return makeLinked(self, this.peer, this.link, {assign, isValid, difference, add, subtract});\n  })();\n}\n\nexport class NavigationState extends RefCounted {\n  changed = new NullarySignal();\n  zoomFactor: TrackableZoomState;\n\n  constructor(\n      public pose: Owned<Pose> = new Pose(),\n      zoomFactor: number|Owned<TrackableZoomState> = Number.NaN) {\n    super();\n    if (typeof zoomFactor === 'number') {\n      this.zoomFactor = new TrackableZoomState(zoomFactor);\n    } else {\n      this.zoomFactor = zoomFactor;\n    }\n    this.registerDisposer(this.zoomFactor);\n    this.registerDisposer(pose);\n    this.registerDisposer(this.pose.changed.add(() => {\n      this.changed.dispatch();\n    }));\n    this.registerDisposer(this.zoomFactor.changed.add(() => {\n      this.changed.dispatch();\n    }));\n    this.registerDisposer(this.voxelSize.changed.add(() => {\n      this.handleVoxelSizeChanged();\n    }));\n    this.handleVoxelSizeChanged();\n  }\n  get voxelSize() {\n    return this.pose.position.voxelSize;\n  }\n\n  /**\n   * Resets everything.\n   */\n  reset() {\n    this.pose.reset();\n    this.zoomFactor.reset();\n  }\n\n  private setZoomFactorFromVoxelSize() {\n    let {voxelSize} = this;\n    if (voxelSize.valid) {\n      this.zoomFactor.value = Math.min.apply(null, this.voxelSize.size);\n    }\n  }\n\n  /**\n   * Sets the zoomFactor to the minimum voxelSize if it is not already set.\n   */\n  private handleVoxelSizeChanged() {\n    if (!this.zoomFactor.valid) {\n      this.setZoomFactorFromVoxelSize();\n    }\n  }\n  get position() {\n    return this.pose.position;\n  }\n  toMat4(mat: mat4) {\n    this.pose.toMat4(mat);\n    let zoom = this.zoomFactor.value;\n    mat4.scale(mat, mat, vec3.fromValues(zoom, zoom, zoom));\n  }\n\n  get valid() {\n    return this.pose.valid;\n  }\n\n  toJSON() {\n    let poseJson = this.pose.toJSON();\n    let zoomFactorJson = this.zoomFactor.toJSON();\n    if (poseJson === undefined && zoomFactorJson === undefined) {\n      return undefined;\n    }\n    return {'pose': poseJson, 'zoomFactor': zoomFactorJson};\n  }\n\n  restoreState(obj: any) {\n    try {\n      verifyObject(obj);\n      verifyObjectProperty(obj, 'pose', x => {\n        if (x !== undefined) {\n          this.pose.restoreState(x);\n        }\n      });\n      verifyObjectProperty(obj, 'zoomFactor', x => {\n        if (x !== undefined) {\n          this.zoomFactor.restoreState(x);\n        }\n      });\n      this.handleVoxelSizeChanged();\n      this.changed.dispatch();\n    } catch (parseError) {\n      this.reset();\n    }\n  }\n\n  zoomBy(factor: number) {\n    this.zoomFactor.zoomBy(factor);\n  }\n}\n","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {MouseSelectionState, RenderLayer} from 'neuroglancer/layer';\nimport {Uint64} from 'neuroglancer/util/uint64';\n\nconst DEBUG_PICKING = false;\n\nexport class PickIDManager {\n  /**\n   * This specifies the render layer corresponding to each registered entry.\n   */\n  private renderLayers: (RenderLayer|null)[] = [null];\n\n  private pickData: any[] = [null];\n\n  /**\n   * This contains 3 consecutive values, specifying (startPickID, low, high), for each registered\n   * entry.  startPickID specifies the first uint32 pick ID corresponding to the entry.  low and\n   * high specify two additional numbers associated with the entry.\n   */\n  private values = [0, 0, 0];\n\n  private nextPickID = 1;\n\n  constructor() {}\n\n  clear() {\n    this.renderLayers.length = 1;\n    this.pickData.length = 1;\n    this.values.length = 3;\n    this.nextPickID = 1;\n  }\n\n  registerUint64(renderLayer: RenderLayer, x: Uint64, count = 1): number {\n    return this.register(renderLayer, count, x.low, x.high);\n  }\n\n  register(renderLayer: RenderLayer, count = 1, low = 0, high = 0, data: any = null): number {\n    let {renderLayers, values} = this;\n    let pickID = this.nextPickID;\n    this.nextPickID += count;\n    let index = renderLayers.length;\n    renderLayers[index] = renderLayer;\n    let valuesOffset = index * 3;\n    values[valuesOffset] = pickID;\n    values[valuesOffset + 1] = low;\n    values[valuesOffset + 2] = high;\n    this.pickData[index] = data;\n    return pickID;\n  }\n\n  /**\n   * Set the object state according to the specified pick ID.\n   */\n  setMouseState(mouseState: MouseSelectionState, pickID: number) {\n    // Binary search to find largest registered index with a pick ID <= pickID.\n    const {renderLayers, values} = this;\n    let lower = 0, upper = renderLayers.length - 1;\n    while (lower < upper) {\n      const mid = Math.ceil(lower + (upper - lower) / 2);\n      if (values[mid * 3] > pickID) {\n        upper = mid - 1;\n      } else {\n        lower = mid;\n      }\n    }\n    const pickedRenderLayer = mouseState.pickedRenderLayer = renderLayers[lower];\n    const valuesOffset = lower * 3;\n    const pickedOffset = mouseState.pickedOffset = pickID - values[valuesOffset];\n    if (DEBUG_PICKING) {\n      console.log(`Looking up pick ID ${pickID}: renderLayer`, pickedRenderLayer, `offset=${pickedOffset}`);\n    }\n    let {pickedValue} = mouseState;\n    pickedValue.low = values[valuesOffset + 1];\n    pickedValue.high = values[valuesOffset + 2];\n    mouseState.pickedAnnotationId = undefined;\n    mouseState.pickedAnnotationLayer = undefined;\n    if (pickedRenderLayer !== null) {\n      pickedRenderLayer.updateMouseState(mouseState, pickedValue, pickedOffset, this.pickData[lower]);\n    }\n  }\n}\n","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {AutomaticallyFocusedElement} from 'neuroglancer/util/automatic_focus';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {EventActionMap, KeyboardEventBinder} from 'neuroglancer/util/keyboard_bindings';\n\nexport const overlayKeyboardHandlerPriority = 100;\n\nimport './overlay.css';\n\nexport let overlaysOpen = 0;\n\nexport const defaultEventMap = EventActionMap.fromObject({\n  'escape': {action: 'close'},\n});\n\nexport class Overlay extends RefCounted {\n  container: HTMLDivElement;\n  content: HTMLDivElement;\n  keyMap = new EventActionMap();\n  constructor() {\n    super();\n    this.keyMap.addParent(defaultEventMap, Number.NEGATIVE_INFINITY);\n    ++overlaysOpen;\n    let container = this.container = document.createElement('div');\n    container.className = 'overlay';\n    let content = this.content = document.createElement('div');\n    this.registerDisposer(new AutomaticallyFocusedElement(content));\n    content.className = 'overlay-content';\n    container.appendChild(content);\n    document.body.appendChild(container);\n    this.registerDisposer(new KeyboardEventBinder(this.container, this.keyMap));\n    this.registerEventListener(container, 'action:close', () => {\n      this.dispose();\n    });\n    content.focus();\n  }\n\n  disposed() {\n    --overlaysOpen;\n    document.body.removeChild(this.container);\n    super.disposed();\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const PERSPECTIVE_VIEW_RPC_ID = 'perspective_view/PerspectiveView';\nexport const PERSPECTIVE_VIEW_ADD_LAYER_RPC_ID = 'perspective_view/addLayer';\nexport const PERSPECTIVE_VIEW_REMOVE_LAYER_RPC_ID = 'perspective_view/removeLayer';\nexport const PERSPECTIVE_VIEW_UPDATE_VIEWPORT_RPC_ID = 'perspective_view/updateViewport';\n","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport throttle from 'lodash/throttle';\nimport {AxesLineHelper} from 'neuroglancer/axes_lines';\nimport {DisplayContext} from 'neuroglancer/display_context';\nimport {makeRenderedPanelVisibleLayerTracker, VisibleRenderLayerTracker} from 'neuroglancer/layer';\nimport {PERSPECTIVE_VIEW_ADD_LAYER_RPC_ID, PERSPECTIVE_VIEW_REMOVE_LAYER_RPC_ID, PERSPECTIVE_VIEW_RPC_ID, PERSPECTIVE_VIEW_UPDATE_VIEWPORT_RPC_ID} from 'neuroglancer/perspective_view/base';\nimport {PerspectiveViewReadyRenderContext, PerspectiveViewRenderContext, PerspectiveViewRenderLayer} from 'neuroglancer/perspective_view/render_layer';\nimport {clearOutOfBoundsPickData, FramePickingData, pickDiameter, pickOffsetSequence, pickRadius, RenderedDataPanel, RenderedDataViewerState} from 'neuroglancer/rendered_data_panel';\nimport {SliceView, SliceViewRenderHelper} from 'neuroglancer/sliceview/frontend';\nimport {TrackableBoolean, TrackableBooleanCheckbox} from 'neuroglancer/trackable_boolean';\nimport {TrackableValue} from 'neuroglancer/trackable_value';\nimport {TrackableRGB} from 'neuroglancer/util/color';\nimport {Owned} from 'neuroglancer/util/disposable';\nimport {ActionEvent, registerActionListener} from 'neuroglancer/util/event_action_map';\nimport {kAxes, mat4, transformVectorByMat4, vec3, vec4} from 'neuroglancer/util/geom';\nimport {startRelativeMouseDrag} from 'neuroglancer/util/mouse_drag';\nimport {TouchRotateInfo, TouchTranslateInfo} from 'neuroglancer/util/touch_bindings';\nimport {WatchableMap} from 'neuroglancer/util/watchable_map';\nimport {withSharedVisibility} from 'neuroglancer/visibility_priority/frontend';\nimport {DepthBuffer, FramebufferConfiguration, makeTextureBuffers, OffscreenCopyHelper, TextureBuffer} from 'neuroglancer/webgl/offscreen';\nimport {ShaderBuilder} from 'neuroglancer/webgl/shader';\nimport {ScaleBarOptions, ScaleBarTexture} from 'neuroglancer/widget/scale_bar';\nimport {RPC, SharedObject} from 'neuroglancer/worker_rpc';\n\nimport 'neuroglancer/noselect.css';\nimport './panel.css';\n\nexport interface PerspectiveViewerState extends RenderedDataViewerState {\n  orthographicProjection: TrackableBoolean;\n  showSliceViews: TrackableBoolean;\n  showScaleBar: TrackableBoolean;\n  scaleBarOptions: TrackableValue<ScaleBarOptions>;\n  showSliceViewsCheckbox?: boolean;\n  crossSectionBackgroundColor: TrackableRGB;\n  perspectiveViewBackgroundColor: TrackableRGB;\n  rpc: RPC;\n}\n\nexport enum OffscreenTextures {\n  COLOR,\n  Z,\n  PICK,\n  NUM_TEXTURES\n}\n\nexport const glsl_perspectivePanelEmit = `\nvoid emit(vec4 color, highp uint pickId) {\n  out_color = color;\n  out_z = 1.0 - gl_FragCoord.z;\n  out_pickId = float(pickId);\n}\n`;\n\n/**\n * http://jcgt.org/published/0002/02/09/paper.pdf\n * http://casual-effects.blogspot.com/2015/03/implemented-weighted-blended-order.html\n */\nexport const glsl_computeOITWeight = `\nfloat computeOITWeight(float alpha) {\n  float a = min(1.0, alpha) * 8.0 + 0.01;\n  float b = -gl_FragCoord.z * 0.95 + 1.0;\n  return a * a * a * b * b * b;\n}\n`;\n\n// Color must be premultiplied by alpha.\nexport const glsl_perspectivePanelEmitOIT = [\n  glsl_computeOITWeight, `\nvoid emit(vec4 color, highp uint pickId) {\n  float weight = computeOITWeight(color.a);\n  vec4 accum = color * weight;\n  v4f_fragData0 = vec4(accum.rgb, color.a);\n  v4f_fragData1 = vec4(accum.a, 0.0, 0.0, 0.0);\n}\n`\n];\n\nexport function perspectivePanelEmit(builder: ShaderBuilder) {\n  builder.addOutputBuffer('vec4', `out_color`, OffscreenTextures.COLOR);\n  builder.addOutputBuffer('highp float', `out_z`, OffscreenTextures.Z);\n  builder.addOutputBuffer('highp float', `out_pickId`, OffscreenTextures.PICK);\n  builder.addFragmentCode(glsl_perspectivePanelEmit);\n}\n\nexport function perspectivePanelEmitOIT(builder: ShaderBuilder) {\n  builder.addOutputBuffer('vec4', 'v4f_fragData0', 0);\n  builder.addOutputBuffer('vec4', 'v4f_fragData1', 1);\n  builder.addFragmentCode(glsl_perspectivePanelEmitOIT);\n}\n\nconst tempVec3 = vec3.create();\nconst tempVec3b = vec3.create();\nconst tempVec4 = vec4.create();\nconst tempMat4 = mat4.create();\n\nfunction defineTransparencyCopyShader(builder: ShaderBuilder) {\n  builder.addOutputBuffer('vec4', 'v4f_fragColor', null);\n  builder.setFragmentMain(`\nvec4 v0 = getValue0();\nvec4 v1 = getValue1();\nvec4 accum = vec4(v0.rgb, v1.r);\nfloat revealage = v0.a;\n\nv4f_fragColor = vec4(accum.rgb / accum.a, revealage);\n`);\n}\n\nconst PerspectiveViewStateBase = withSharedVisibility(SharedObject);\nclass PerspectiveViewState extends PerspectiveViewStateBase {}\n\nexport class PerspectivePanel extends RenderedDataPanel {\n  viewer: PerspectiveViewerState;\n\n  protected visibleLayerTracker: Owned<VisibleRenderLayerTracker<PerspectiveViewRenderLayer>>;\n\n  /**\n   * If boolean value is true, sliceView is shown unconditionally, regardless of the value of\n   * this.viewer.showSliceViews.value.\n   */\n  sliceViews = (() => {\n    const sliceViewDisposers = new Map<SliceView, () => void>();\n    return this.registerDisposer(new WatchableMap<SliceView, boolean>(\n        (_unconditional, sliceView) => {\n          const disposer = sliceView.visibility.add(this.visibility);\n          sliceViewDisposers.set(sliceView, disposer);\n          this.scheduleRedraw();\n        },\n        (_unconditional, sliceView) => {\n          const disposer = sliceViewDisposers.get(sliceView)!;\n          sliceViewDisposers.delete(sliceView);\n          disposer();\n          sliceView.dispose();\n          this.scheduleRedraw();\n        }));\n  })();\n\n  /**\n   * Transform from camera space to OpenGL clip space.\n   */\n  projectionMat = mat4.create();\n\n  /**\n   * Transform from world space to camera space.\n   */\n  viewMat = mat4.create();\n\n  /**\n   * Inverse of `viewMat`.\n   */\n  viewMatInverse = mat4.create();\n\n  /**\n   * Transform from world space to OpenGL clip space.  Equal to `projectionMat * viewMat`.\n   */\n  viewProjectionMat = mat4.create();\n\n  /**\n   * Inverse of `viewProjectionMat`.\n   */\n  viewProjectionMatInverse = mat4.create();\n\n  /**\n   * Width of panel viewport in pixels.\n   */\n  width = 0;\n\n  /**\n   * Height of panel viewport in pixels.\n   */\n  height = 0;\n\n  private axesLineHelper = this.registerDisposer(AxesLineHelper.get(this.gl));\n  sliceViewRenderHelper =\n      this.registerDisposer(SliceViewRenderHelper.get(this.gl, perspectivePanelEmit));\n\n  protected offscreenFramebuffer = this.registerDisposer(new FramebufferConfiguration(this.gl, {\n    colorBuffers: [\n      new TextureBuffer(\n          this.gl, WebGL2RenderingContext.RGBA8, WebGL2RenderingContext.RGBA,\n          WebGL2RenderingContext.UNSIGNED_BYTE),\n      new TextureBuffer(\n          this.gl, WebGL2RenderingContext.R32F, WebGL2RenderingContext.RED,\n          WebGL2RenderingContext.FLOAT),\n      new TextureBuffer(\n          this.gl, WebGL2RenderingContext.R32F, WebGL2RenderingContext.RED,\n          WebGL2RenderingContext.FLOAT),\n    ],\n    depthBuffer: new DepthBuffer(this.gl)\n  }));\n\n  protected transparentConfiguration_: FramebufferConfiguration<TextureBuffer>|undefined;\n\n  protected offscreenCopyHelper = this.registerDisposer(OffscreenCopyHelper.get(this.gl));\n  protected transparencyCopyHelper =\n      this.registerDisposer(OffscreenCopyHelper.get(this.gl, defineTransparencyCopyShader, 2));\n\n  private sharedObject: PerspectiveViewState;\n\n  private scaleBarCopyHelper = this.registerDisposer(OffscreenCopyHelper.get(this.gl));\n  private scaleBarTexture = this.registerDisposer(new ScaleBarTexture(this.gl));\n\n  private nanometersPerPixel = 1;\n\n\n  constructor(context: DisplayContext, element: HTMLElement, viewer: PerspectiveViewerState) {\n    super(context, element, viewer);\n    this.registerDisposer(this.navigationState.changed.add(() => {\n      this.throttledSendViewportUpdate();\n      this.context.scheduleRedraw();\n    }));\n\n    const sharedObject = this.sharedObject = this.registerDisposer(new PerspectiveViewState());\n    sharedObject.RPC_TYPE_ID = PERSPECTIVE_VIEW_RPC_ID;\n    sharedObject.initializeCounterpart(viewer.rpc, {});\n    sharedObject.visibility.add(this.visibility);\n\n    this.visibleLayerTracker = makeRenderedPanelVisibleLayerTracker(\n        this.viewer.layerManager, PerspectiveViewRenderLayer, this.viewer.visibleLayerRoles, this,\n        layer => {\n          const {backend} = layer;\n          if (backend) {\n            backend.rpc!.invoke(\n                PERSPECTIVE_VIEW_ADD_LAYER_RPC_ID,\n                {layer: backend.rpcId, view: this.sharedObject.rpcId});\n            return () => {\n              backend.rpc!.invoke(\n                  PERSPECTIVE_VIEW_REMOVE_LAYER_RPC_ID,\n                  {layer: backend.rpcId, view: this.sharedObject.rpcId});\n            };\n          }\n          return undefined;\n        });\n\n    registerActionListener(element, 'rotate-via-mouse-drag', (e: ActionEvent<MouseEvent>) => {\n      startRelativeMouseDrag(e.detail, (_event, deltaX, deltaY) => {\n        this.navigationState.pose.rotateRelative(kAxes[1], deltaX / 4.0 * Math.PI / 180.0);\n        this.navigationState.pose.rotateRelative(kAxes[0], -deltaY / 4.0 * Math.PI / 180.0);\n      });\n    });\n\n    registerActionListener(\n        element, 'rotate-in-plane-via-touchrotate', (e: ActionEvent<TouchRotateInfo>) => {\n          const {detail} = e;\n          this.navigationState.pose.rotateRelative(kAxes[2], detail.angle - detail.prevAngle);\n        });\n\n    registerActionListener(\n        element, 'rotate-out-of-plane-via-touchtranslate', (e: ActionEvent<TouchTranslateInfo>) => {\n          const {detail} = e;\n          this.navigationState.pose.rotateRelative(kAxes[1], detail.deltaX / 4.0 * Math.PI / 180.0);\n          this.navigationState.pose.rotateRelative(\n              kAxes[0], -detail.deltaY / 4.0 * Math.PI / 180.0);\n        });\n\n    if (viewer.showSliceViewsCheckbox) {\n      let showSliceViewsCheckbox =\n          this.registerDisposer(new TrackableBooleanCheckbox(viewer.showSliceViews));\n      showSliceViewsCheckbox.element.className =\n          'perspective-panel-show-slice-views neuroglancer-noselect';\n      let showSliceViewsLabel = document.createElement('label');\n      showSliceViewsLabel.className = 'perspective-panel-show-slice-views neuroglancer-noselect';\n      showSliceViewsLabel.appendChild(document.createTextNode('Slices'));\n      showSliceViewsLabel.appendChild(showSliceViewsCheckbox.element);\n      this.element.appendChild(showSliceViewsLabel);\n    }\n    this.registerDisposer(viewer.orthographicProjection.changed.add(() => this.scheduleRedraw()));\n    this.registerDisposer(viewer.showScaleBar.changed.add(() => this.scheduleRedraw()));\n    this.registerDisposer(viewer.scaleBarOptions.changed.add(() => this.scheduleRedraw()));\n    this.registerDisposer(viewer.showSliceViews.changed.add(() => this.scheduleRedraw()));\n    this.registerDisposer(viewer.showAxisLines.changed.add(() => this.scheduleRedraw()));\n    this.registerDisposer(\n        viewer.crossSectionBackgroundColor.changed.add(() => this.scheduleRedraw()));\n    this.registerDisposer(\n        viewer.perspectiveViewBackgroundColor.changed.add(() => this.scheduleRedraw()));\n  }\n\n  translateByViewportPixels(deltaX: number, deltaY: number): void {\n    const temp = tempVec3;\n    const {viewProjectionMat} = this;\n    const {width, height} = this;\n    const {position} = this.viewer.navigationState;\n    const pos = position.spatialCoordinates;\n    vec3.transformMat4(temp, pos, viewProjectionMat);\n    temp[0] = -2 * deltaX / width;\n    temp[1] = 2 * deltaY / height;\n    vec3.transformMat4(pos, temp, this.viewProjectionMatInverse);\n    position.changed.dispatch();\n  }\n\n  get navigationState() {\n    return this.viewer.navigationState;\n  }\n\n  isReady() {\n    if (!this.visible) {\n      return true;\n    }\n    for (const [sliceView, unconditional] of this.sliceViews) {\n      if (unconditional || this.viewer.showSliceViews.value) {\n        if (!sliceView.isReady()) {\n          return false;\n        }\n      }\n    }\n    this.checkForResize();\n    const {width, height} = this;\n    if (width === 0 || height === 0) {\n      return true;\n    }\n    const {viewProjectionMat} = this;\n    this.updateProjectionMatrix();\n\n    const renderContext: PerspectiveViewReadyRenderContext = {\n      viewportWidth: width,\n      viewportHeight: height,\n      dataToDevice: viewProjectionMat,\n    };\n\n    let visibleLayers = this.visibleLayerTracker.getVisibleLayers();\n    for (let renderLayer of visibleLayers) {\n      if (!renderLayer.isReady(renderContext)) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  updateProjectionMatrix() {\n    const {projectionMat, viewProjectionMat} = this;\n    const zOffsetAmount = 100;\n    const widthOverHeight = this.width / this.height;\n    const fovy = Math.PI / 4.0;\n    const nearBound = 10, farBound = 5000;\n    if (this.viewer.orthographicProjection.value) {\n      // Pick orthographic projection to match perspective projection at plane parallel to image\n      // plane containing the center position.\n      const f = 1.0 / Math.tan(fovy / 2);\n      // We need -2 / (left - right) == f / widthOverHeight.\n      // left - right = - 2 * widthOverHeight * orthoScalar\n      // -2 / (left - right) = 1 / (widthOverHeight * orthoScalar).\n      // 1 / orthoScalar == f.\n      // orthoScalar = 1 / f\n      const orthoScalar = zOffsetAmount / f;\n      mat4.ortho(\n          projectionMat, -widthOverHeight * orthoScalar, widthOverHeight * orthoScalar,\n          -orthoScalar, orthoScalar, nearBound, farBound);\n      this.nanometersPerPixel = 1 / (2 * projectionMat[0]) * this.navigationState.zoomFactor.value;\n      this.nanometersPerPixel =\n          2 * widthOverHeight * orthoScalar / this.width * this.navigationState.zoomFactor.value;\n    } else {\n      mat4.perspective(projectionMat, fovy, widthOverHeight, nearBound, farBound);\n    }\n\n    const {viewMatInverse, viewMat} = this;\n    this.navigationState.toMat4(viewMatInverse);\n    vec3.set(tempVec3, 1, -1, -1);\n    mat4.scale(viewMatInverse, viewMatInverse, tempVec3);\n\n    let viewOffset = vec3.set(tempVec3, 0, 0, zOffsetAmount);\n    mat4.translate(viewMatInverse, viewMatInverse, viewOffset);\n\n    mat4.invert(viewMat, viewMatInverse);\n\n    mat4.multiply(viewProjectionMat, projectionMat, viewMat);\n    mat4.invert(this.viewProjectionMatInverse, viewProjectionMat);\n  }\n\n  private throttledSendViewportUpdate = this.registerCancellable(throttle(() => {\n    const {sharedObject} = this;\n    const {valid} = this.navigationState;\n    if (valid) {\n      this.updateProjectionMatrix();\n    }\n    sharedObject.rpc!.invoke(PERSPECTIVE_VIEW_UPDATE_VIEWPORT_RPC_ID, {\n      view: sharedObject.rpcId,\n      viewport: {\n        width: valid ? this.width : 0,\n        height: valid ? this.height : 0,\n        viewMat: this.viewMat,\n        projectionMat: this.projectionMat,\n        viewProjectionMat: this.viewProjectionMat,\n      },\n    });\n  }, 10));\n\n  panelSizeChanged() {\n    this.throttledSendViewportUpdate();\n  }\n\n  disposed() {\n    for (let sliceView of this.sliceViews.keys()) {\n      sliceView.dispose();\n    }\n    this.sliceViews.clear();\n    super.disposed();\n  }\n\n  issuePickRequest(glWindowX: number, glWindowY: number) {\n    const {offscreenFramebuffer} = this;\n    offscreenFramebuffer.readPixelFloat32IntoBuffer(\n        OffscreenTextures.Z, glWindowX - pickRadius, glWindowY - pickRadius, 0, pickDiameter,\n        pickDiameter);\n    offscreenFramebuffer.readPixelFloat32IntoBuffer(\n        OffscreenTextures.PICK, glWindowX - pickRadius, glWindowY - pickRadius,\n        4 * 4 * pickDiameter * pickDiameter, pickDiameter, pickDiameter);\n  }\n\n  completePickRequest(\n      glWindowX: number, glWindowY: number, data: Float32Array, pickingData: FramePickingData) {\n    const {mouseState} = this.viewer;\n    mouseState.pickedRenderLayer = null;\n    clearOutOfBoundsPickData(\n        data, 0, 4, glWindowX, glWindowY, pickingData.viewportWidth, pickingData.viewportHeight);\n    const numOffsets = pickOffsetSequence.length;\n    for (let i = 0; i < numOffsets; ++i) {\n      const offset = pickOffsetSequence[i];\n      let zValue = data[4 * offset];\n      if (zValue === 0) continue;\n      const relativeX = offset % pickDiameter;\n      const relativeY = (offset - relativeX) / pickDiameter;\n      let glWindowZ = 1.0 - zValue;\n      const out = mouseState.position;\n      out[0] = 2.0 * (glWindowX + relativeX - pickRadius) / pickingData.viewportWidth - 1.0;\n      out[1] = 2.0 * (glWindowY + relativeY - pickRadius) / pickingData.viewportHeight - 1.0;\n      out[2] = 2.0 * glWindowZ - 1.0;\n      vec3.transformMat4(out, out, pickingData.invTransform);\n      const pickValue = data[4 * pickDiameter * pickDiameter + 4 * offset];\n      pickingData.pickIDs.setMouseState(mouseState, pickValue);\n      mouseState.setActive(true);\n      return;\n    }\n    mouseState.setActive(false);\n  }\n\n  translateDataPointByViewportPixels(out: vec3, orig: vec3, deltaX: number, deltaY: number): vec3 {\n    const temp = tempVec3;\n    const {viewProjectionMat} = this;\n    const {width, height} = this;\n    vec3.transformMat4(temp, orig, viewProjectionMat);\n    temp[0] += 2 * deltaX / width;\n    temp[1] += -2 * deltaY / height;\n    return vec3.transformMat4(out, temp, this.viewProjectionMatInverse);\n  }\n\n  private get transparentConfiguration() {\n    let transparentConfiguration = this.transparentConfiguration_;\n    if (transparentConfiguration === undefined) {\n      transparentConfiguration = this.transparentConfiguration_ =\n          this.registerDisposer(new FramebufferConfiguration(this.gl, {\n            colorBuffers:\n                makeTextureBuffers(this.gl, 2, this.gl.RGBA32F, this.gl.RGBA, this.gl.FLOAT),\n            depthBuffer: this.offscreenFramebuffer.depthBuffer!.addRef(),\n          }));\n    }\n    return transparentConfiguration;\n  }\n\n  drawWithPicking(pickingData: FramePickingData): boolean {\n    if (!this.navigationState.valid) {\n      return false;\n    }\n    const {width, height} = this;\n\n    const showSliceViews = this.viewer.showSliceViews.value;\n    for (const [sliceView, unconditional] of this.sliceViews) {\n      if (unconditional || showSliceViews) {\n        sliceView.updateRendering();\n      }\n    }\n\n    let gl = this.gl;\n    this.offscreenFramebuffer.bind(width, height);\n\n    gl.disable(gl.SCISSOR_TEST);\n    const backgroundColor = this.viewer.perspectiveViewBackgroundColor.value;\n    this.gl.clearColor(backgroundColor[0], backgroundColor[1], backgroundColor[2], 0.0);\n    gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n\n    gl.enable(gl.DEPTH_TEST);\n    let {viewProjectionMat} = this;\n    this.updateProjectionMatrix();\n\n    // FIXME; avoid temporaries\n    let lightingDirection = vec3.create();\n    transformVectorByMat4(lightingDirection, kAxes[2], this.viewMatInverse);\n    vec3.normalize(lightingDirection, lightingDirection);\n\n    let ambient = 0.2;\n    let directional = 1 - ambient;\n\n    const renderContext: PerspectiveViewRenderContext = {\n      dataToDevice: viewProjectionMat,\n      lightDirection: lightingDirection,\n      ambientLighting: ambient,\n      directionalLighting: directional,\n      pickIDs: pickingData.pickIDs,\n      emitter: perspectivePanelEmit,\n      emitColor: true,\n      emitPickID: true,\n      alreadyEmittedPickID: false,\n      viewportWidth: width,\n      viewportHeight: height,\n    };\n\n    mat4.copy(pickingData.invTransform, this.viewProjectionMatInverse);\n\n    let visibleLayers = this.visibleLayerTracker.getVisibleLayers();\n\n    let hasTransparent = false;\n\n    let hasAnnotation = false;\n\n    // Draw fully-opaque layers first.\n    for (let renderLayer of visibleLayers) {\n      if (!renderLayer.isTransparent) {\n        if (!renderLayer.isAnnotation) {\n          renderLayer.draw(renderContext);\n        } else {\n          hasAnnotation = true;\n        }\n      } else {\n        hasTransparent = true;\n      }\n    }\n    this.drawSliceViews(renderContext);\n\n    if (hasAnnotation) {\n      gl.enable(WebGL2RenderingContext.BLEND);\n      gl.depthFunc(WebGL2RenderingContext.LEQUAL);\n      gl.blendFunc(WebGL2RenderingContext.SRC_ALPHA, WebGL2RenderingContext.ONE_MINUS_SRC_ALPHA);\n      // Render only to the color buffer, but not the pick or z buffer.  With blending enabled, the\n      // z and color values would be corrupted.\n      gl.drawBuffers([\n        gl.COLOR_ATTACHMENT0,\n        gl.NONE,\n        gl.NONE,\n      ]);\n      renderContext.emitPickID = false;\n\n      for (let renderLayer of visibleLayers) {\n        if (renderLayer.isAnnotation) {\n          renderLayer.draw(renderContext);\n        }\n      }\n      gl.depthFunc(WebGL2RenderingContext.LESS);\n      gl.disable(WebGL2RenderingContext.BLEND);\n      gl.drawBuffers([\n        gl.COLOR_ATTACHMENT0,\n        gl.COLOR_ATTACHMENT1,\n        gl.COLOR_ATTACHMENT2,\n      ]);\n      renderContext.emitPickID = true;\n    }\n\n    if (this.viewer.showAxisLines.value) {\n      this.drawAxisLines();\n    }\n\n    if (hasTransparent) {\n      // Draw transparent objects.\n      gl.depthMask(false);\n      gl.enable(WebGL2RenderingContext.BLEND);\n\n      // Compute accumulate and revealage textures.\n      const {transparentConfiguration} = this;\n      transparentConfiguration.bind(width, height);\n      this.gl.clearColor(0.0, 0.0, 0.0, 1.0);\n      gl.clear(WebGL2RenderingContext.COLOR_BUFFER_BIT);\n      renderContext.emitter = perspectivePanelEmitOIT;\n      gl.blendFuncSeparate(\n          WebGL2RenderingContext.ONE, WebGL2RenderingContext.ONE, WebGL2RenderingContext.ZERO,\n          WebGL2RenderingContext.ONE_MINUS_SRC_ALPHA);\n      renderContext.emitPickID = false;\n      for (let renderLayer of visibleLayers) {\n        if (renderLayer.isTransparent) {\n          renderLayer.draw(renderContext);\n        }\n      }\n\n      // Copy transparent rendering result back to primary buffer.\n      gl.disable(WebGL2RenderingContext.DEPTH_TEST);\n      this.offscreenFramebuffer.bindSingle(OffscreenTextures.COLOR);\n      gl.blendFunc(WebGL2RenderingContext.ONE_MINUS_SRC_ALPHA, WebGL2RenderingContext.SRC_ALPHA);\n      this.transparencyCopyHelper.draw(\n          transparentConfiguration.colorBuffers[0].texture,\n          transparentConfiguration.colorBuffers[1].texture);\n\n      gl.depthMask(true);\n      gl.disable(WebGL2RenderingContext.BLEND);\n      gl.enable(WebGL2RenderingContext.DEPTH_TEST);\n\n      // Restore framebuffer attachments.\n      this.offscreenFramebuffer.bind(width, height);\n    }\n\n    // Do picking only rendering pass.\n    gl.drawBuffers([gl.NONE, gl.COLOR_ATTACHMENT1, gl.COLOR_ATTACHMENT2]);\n    renderContext.emitter = perspectivePanelEmit;\n    renderContext.emitPickID = true;\n    renderContext.emitColor = false;\n\n    // Offset z values forward so that we reliably write pick IDs and depth information even though\n    // we've already done one drawing pass.\n    gl.enable(WebGL2RenderingContext.POLYGON_OFFSET_FILL);\n    gl.polygonOffset(-1, -1);\n    for (let renderLayer of visibleLayers) {\n      renderContext.alreadyEmittedPickID = !renderLayer.isTransparent && !renderLayer.isAnnotation;\n      renderLayer.draw(renderContext);\n    }\n    gl.disable(WebGL2RenderingContext.POLYGON_OFFSET_FILL);\n\n    if (this.viewer.showScaleBar.value && this.viewer.orthographicProjection.value) {\n      // Only modify color buffer.\n      gl.drawBuffers([\n        gl.COLOR_ATTACHMENT0,\n      ]);\n\n      gl.disable(WebGL2RenderingContext.DEPTH_TEST);\n      gl.enable(WebGL2RenderingContext.BLEND);\n      gl.blendFunc(WebGL2RenderingContext.SRC_ALPHA, WebGL2RenderingContext.ONE_MINUS_SRC_ALPHA);\n      const {scaleBarTexture} = this;\n      const options = this.viewer.scaleBarOptions.value;\n      const {dimensions} = scaleBarTexture;\n      dimensions.targetLengthInPixels = Math.min(\n          options.maxWidthFraction * width, options.maxWidthInPixels * options.scaleFactor);\n      dimensions.nanometersPerPixel = this.nanometersPerPixel;\n      scaleBarTexture.update(options);\n      gl.viewport(\n          options.leftPixelOffset * options.scaleFactor,\n          options.bottomPixelOffset * options.scaleFactor, scaleBarTexture.width,\n          scaleBarTexture.height);\n      this.scaleBarCopyHelper.draw(scaleBarTexture.texture);\n      gl.disable(WebGL2RenderingContext.BLEND);\n    }\n    this.offscreenFramebuffer.unbind();\n\n    // Draw the texture over the whole viewport.\n    this.setGLViewport();\n    this.offscreenCopyHelper.draw(\n        this.offscreenFramebuffer.colorBuffers[OffscreenTextures.COLOR].texture);\n    return true;\n  }\n\n  protected drawSliceViews(renderContext: PerspectiveViewRenderContext) {\n    let {sliceViewRenderHelper} = this;\n    let {lightDirection, ambientLighting, directionalLighting, dataToDevice} = renderContext;\n\n    const showSliceViews = this.viewer.showSliceViews.value;\n    for (const [sliceView, unconditional] of this.sliceViews) {\n      if (!unconditional && !showSliceViews) {\n        continue;\n      }\n      if (sliceView.width === 0 || sliceView.height === 0 || !sliceView.hasValidViewport) {\n        continue;\n      }\n      let scalar = Math.abs(vec3.dot(lightDirection, sliceView.viewportAxes[2]));\n      let factor = ambientLighting + scalar * directionalLighting;\n      let mat = tempMat4;\n      // Need a matrix that maps (+1, +1, 0) to projectionMat * (width, height, 0)\n      mat4.identity(mat);\n      mat[0] = sliceView.width / 2.0;\n      mat[5] = -sliceView.height / 2.0;\n      mat4.multiply(mat, sliceView.viewportToData, mat);\n      mat4.multiply(mat, dataToDevice, mat);\n      const backgroundColor = tempVec4;\n      const crossSectionBackgroundColor = this.viewer.crossSectionBackgroundColor.value;\n      backgroundColor[0] = crossSectionBackgroundColor[0];\n      backgroundColor[1] = crossSectionBackgroundColor[1];\n      backgroundColor[2] = crossSectionBackgroundColor[2];\n      backgroundColor[3] = 1;\n      sliceViewRenderHelper.draw(\n          sliceView.offscreenFramebuffer.colorBuffers[0].texture, mat,\n          vec4.fromValues(factor, factor, factor, 1), tempVec4, 0, 0, 1, 1);\n    }\n  }\n\n  protected drawAxisLines() {\n    const temp = tempVec3;\n    const temp2 = tempVec3b;\n    const {viewProjectionMat} = this;\n    const {position} = this.viewer.navigationState;\n    const pos = position.spatialCoordinates;\n    vec3.transformMat4(temp, pos, viewProjectionMat);\n    temp[0] = 0.5;\n    vec3.transformMat4(temp2, temp, this.viewProjectionMatInverse);\n    const length0 = vec3.distance(temp2, pos);\n    temp[0] = 0;\n    temp[1] = 0.5;\n    vec3.transformMat4(temp2, temp, this.viewProjectionMatInverse);\n    const length1 = vec3.distance(temp2, pos);\n\n    let {gl} = this;\n    let mat = tempMat4;\n    mat4.identity(mat);\n    // Draw axes lines.\n    let axisLength = Math.min(length0, length1);\n\n    // Construct matrix that maps [-1, +1] x/y range to the full viewport data\n    // coordinates.\n    mat[0] = axisLength;\n    mat[5] = axisLength;\n    mat[10] = axisLength;\n    let center = this.navigationState.position.spatialCoordinates;\n    mat[12] = center[0];\n    mat[13] = center[1];\n    mat[14] = center[2];\n    mat[15] = 1;\n    mat4.multiply(mat, this.viewProjectionMat, mat);\n\n    gl.drawBuffers([gl.COLOR_ATTACHMENT0]);\n    this.axesLineHelper.draw(mat, false);\n  }\n\n  zoomByMouse(factor: number) {\n    this.navigationState.zoomBy(factor);\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {VisibilityTrackedRenderLayer} from 'neuroglancer/layer';\nimport {PickIDManager} from 'neuroglancer/object_picking';\nimport {mat4, vec3} from 'neuroglancer/util/geom';\nimport {ShaderModule} from 'neuroglancer/webgl/shader';\nimport {SharedObject} from 'neuroglancer/worker_rpc';\n\nexport interface PerspectiveViewReadyRenderContext {\n  dataToDevice: mat4;\n\n  /**\n   * Width of GL viewport in pixels.\n   */\n  viewportWidth: number;\n\n  /**\n   * Height of GL viewport in pixels.\n   */\n  viewportHeight: number;\n}\n\nexport interface PerspectiveViewRenderContext extends PerspectiveViewReadyRenderContext {\n  lightDirection: vec3;\n  ambientLighting: number;\n  directionalLighting: number;\n  pickIDs: PickIDManager;\n  emitter: ShaderModule;\n\n  /**\n   * Specifies whether the emitted color value will be used.\n   */\n  emitColor: boolean;\n\n  /**\n   * Specifies whether the emitted pick ID will be used.\n   */\n  emitPickID: boolean;\n\n  /**\n   * Specifies whether there was a previous pick ID pass.\n   */\n  alreadyEmittedPickID: boolean;\n}\n\nexport class PerspectiveViewRenderLayer extends VisibilityTrackedRenderLayer {\n  draw(_renderContext: PerspectiveViewRenderContext) {\n    // Must be overridden by subclasses.\n  }\n\n  isReady(_renderContext: PerspectiveViewReadyRenderContext) {\n    return true;\n  }\n\n  isTransparent: boolean|undefined;\n  isAnnotation: boolean|undefined;\n  backend: SharedObject|undefined;\n}\n","/**\n * @license\n * Copyright 2019 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {TrackableValue} from 'neuroglancer/trackable_value';\nimport {verifyFinitePositiveFloat} from 'neuroglancer/util/json';\nimport {VisibilityPriorityAggregator} from 'neuroglancer/visibility_priority/frontend';\nimport { NullarySignal } from './util/signal';\n\nexport const numRenderScaleHistogramBins = 40;\nexport const renderScaleHistogramBinSize = 0.5;\nexport const renderScaleHistogramOrigin = -4;\n\nexport function getRenderScaleHistogramOffset(renderScale: number): number {\n  return (Math.log2(renderScale) - renderScaleHistogramOrigin) / renderScaleHistogramBinSize;\n}\n\nexport function getRenderScaleFromHistogramOffset(offset: number): number {\n  return 2 ** (offset * renderScaleHistogramBinSize + renderScaleHistogramOrigin);\n}\n\nexport function trackableRenderScaleTarget(initialValue: number) {\n  return new TrackableValue<number>(initialValue, verifyFinitePositiveFloat);\n}\n\nexport class RenderScaleHistogram {\n  visibility = new VisibilityPriorityAggregator();\n  changed = new NullarySignal();\n\n  /**\n   * Frame number corresponding to the current histogram.\n   */\n  frameNumber = -1;\n\n  /**\n   * Maps from spatial scale (nanometers) to histogram row index in the range\n   * `[0, spatialScales.size)`.\n   */\n  spatialScales = new Map<number, number>();\n\n  /**\n   * Current number of rows allocated for the histogram.\n   */\n  numHistogramRows = 1;\n\n  /**\n   * Initially allocate one row.\n   */\n  value = new Uint32Array(numRenderScaleHistogramBins * this.numHistogramRows * 2);\n\n  begin(frameNumber: number) {\n    if (frameNumber !== this.frameNumber) {\n      this.value.fill(0);\n      this.frameNumber = frameNumber;\n      this.spatialScales.clear();\n      this.changed.dispatch();\n    }\n  }\n\n  /**\n   * Adds a count to the histogram.\n   *\n   * @param spatialScale Spatial resolution of data in nanometers.\n   * @param renderScale Rendered scale of data in screen pixels.\n   * @param presentCount Number of present chunks.\n   * @param notPresentCount Number of desired but not-present chunks.\n   */\n  add(spatialScale: number, renderScale: number, presentCount: number, notPresentCount: number) {\n    let {spatialScales, numHistogramRows, value} = this;\n    let spatialScaleIndex = spatialScales.get(spatialScale);\n    if (spatialScaleIndex === undefined) {\n      spatialScaleIndex = spatialScales.size;\n      spatialScales.set(spatialScale, spatialScaleIndex);\n    }\n    if (spatialScaleIndex >= numHistogramRows) {\n      this.numHistogramRows = numHistogramRows *= 2;\n      const newValue = new Uint32Array(numHistogramRows * numRenderScaleHistogramBins * 2);\n      newValue.set(value);\n      this.value = value = newValue;\n    }\n    const index = spatialScaleIndex * numRenderScaleHistogramBins * 2 +\n        Math.min(\n            Math.max(0, Math.round(getRenderScaleHistogramOffset(renderScale))),\n            numRenderScaleHistogramBins - 1);\n    value[index] += presentCount;\n    value[index + numRenderScaleHistogramBins] += notPresentCount;\n  }\n}\n","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport 'neuroglancer/rendered_data_panel.css';\nimport 'neuroglancer/noselect.css';\n\nimport {Annotation} from 'neuroglancer/annotation';\nimport {getSelectedAnnotation} from 'neuroglancer/annotation/selection';\nimport {getAnnotationTypeRenderHandler} from 'neuroglancer/annotation/type_handler';\nimport {DisplayContext, RenderedPanel} from 'neuroglancer/display_context';\nimport {NavigationState} from 'neuroglancer/navigation_state';\nimport {PickIDManager} from 'neuroglancer/object_picking';\nimport {UserLayerWithAnnotations} from 'neuroglancer/ui/annotations';\nimport {AutomaticallyFocusedElement} from 'neuroglancer/util/automatic_focus';\nimport {ActionEvent, EventActionMap, registerActionListener} from 'neuroglancer/util/event_action_map';\nimport {AXES_NAMES, kAxes, mat4, vec2, vec3} from 'neuroglancer/util/geom';\nimport {KeyboardEventBinder} from 'neuroglancer/util/keyboard_bindings';\nimport {MouseEventBinder} from 'neuroglancer/util/mouse_bindings';\nimport {startRelativeMouseDrag} from 'neuroglancer/util/mouse_drag';\nimport {TouchEventBinder, TouchPinchInfo, TouchTranslateInfo} from 'neuroglancer/util/touch_bindings';\nimport {getWheelZoomAmount} from 'neuroglancer/util/wheel_zoom';\nimport {ViewerState} from 'neuroglancer/viewer_state';\n\nconst tempVec3 = vec3.create();\n\nexport interface RenderedDataViewerState extends ViewerState {\n  inputEventMap: EventActionMap;\n}\n\nexport class FramePickingData {\n  pickIDs = new PickIDManager();\n  viewportWidth: number = 0;\n  viewportHeight: number = 0;\n  invTransform = mat4.create();\n  frameNumber: number = -1;\n}\n\nexport class PickRequest {\n  buffer: WebGLBuffer|null = null;\n  glWindowX: number = 0;\n  glWindowY: number = 0;\n  frameNumber: number;\n  sync: WebGLSync|null;\n}\n\nconst pickRequestInterval = 30;\n\nexport const pickRadius = 12;\nexport const pickDiameter = 1 + pickRadius * 2;\n\n/**\n * Sequence of offsets into C order (pickDiamater, pickDiamater) array in order of increasing\n * distance from center.\n */\nexport const pickOffsetSequence = (() => {\n  const maxDist2 = pickRadius ** 2;\n  const getDist2 = (x: number, y: number) => (x - pickRadius) ** 2 + (y - pickRadius) ** 2;\n\n  let offsets = new Uint32Array(pickDiameter * pickDiameter);\n  let count = 0;\n  for (let x = 0; x < pickDiameter; ++x) {\n    for (let y = 0; y < pickDiameter; ++y) {\n      if (getDist2(x, y) > maxDist2) continue;\n      offsets[count++] = y * pickDiameter + x;\n    }\n  }\n  offsets = offsets.subarray(0, count);\n  offsets.sort((a, b) => {\n    const x1 = a % pickDiameter;\n    const y1 = (a - x1) / pickDiameter;\n    const x2 = b % pickDiameter;\n    const y2 = (b - x2) / pickDiameter;\n    return getDist2(x1, y1) - getDist2(x2, y2);\n  });\n\n  return offsets;\n})();\n\n/**\n * Sets array elements to 0 that would be outside the viewport.\n *\n * @param buffer Array view, which contains a C order (pickDiameter, pickDiameter) array.\n * @param baseOffset Offset into `buffer` corresponding to (0, 0).\n * @param stride Stride between consecutive elements of the array.\n * @param glWindowX Center x position, must be integer.\n * @param glWindowY Center y position, must be integer.\n * @param viewportWidth Width of viewport in pixels.\n * @param viewportHeight Width of viewport in pixels.\n */\nexport function clearOutOfBoundsPickData(\n    buffer: Float32Array, baseOffset: number, stride: number, glWindowX: number, glWindowY: number,\n    viewportWidth: number, viewportHeight: number) {\n  const startX = glWindowX - pickRadius;\n  const startY = glWindowY - pickRadius;\n  if (startX >= 0 && startY >= 0 && startX + pickDiameter <= viewportWidth &&\n      startY + pickDiameter <= viewportHeight) {\n    return;\n  }\n  for (let relativeY = 0; relativeY < pickDiameter; ++relativeY) {\n    for (let relativeX = 0; relativeX < pickDiameter; ++relativeX) {\n      const x = startX + relativeX;\n      const y = startY + relativeY;\n      if (x < 0 || y < 0 || x >= viewportWidth || y >= viewportHeight) {\n        buffer[baseOffset + (y * pickDiameter + x) * stride] = 0;\n      }\n    }\n  }\n}\n\nexport abstract class RenderedDataPanel extends RenderedPanel {\n  /**\n   * Current mouse position within the viewport, or -1 if the mouse is not in the viewport.\n   */\n  mouseX = -1;\n  mouseY = -1;\n\n  /**\n   * Equal to last-seen value of `this.element.clientWidth` and `this.element.clientHeight`.  If the\n   * size changed since the last frame, may not correspond to the last frame.\n   */\n  width: number;\n  height: number;\n\n  /**\n   * If `false`, either the mouse is not within the viewport, or a picking request was already\n   * issued for the current mouseX and mouseY after the most recent frame was rendered; when the\n   * current pick requests complete, no additional pick requests will be issued.\n   *\n   * If `true`, a picking request was not issued for the current mouseX and mouseY due to all pick\n   * buffers being in use; when a pick buffer becomes available, an additional pick request will be\n   * issued.\n   */\n  pickRequestPending = false;\n\n  private mouseStateForcer = () => this.blockOnPickRequest();\n\n  inputEventMap: EventActionMap;\n\n  navigationState: NavigationState;\n\n  pickingData = [new FramePickingData(), new FramePickingData()];\n  pickRequests = [new PickRequest(), new PickRequest()];\n  pickBufferContents: Float32Array = new Float32Array(2 * 4 * pickDiameter * pickDiameter);\n\n  /**\n   * Reads pick data for the current mouse position into the currently-bound pixel pack buffer.\n   */\n  abstract issuePickRequest(glWindowX: number, glWindowY: number): void;\n\n  /**\n   * Timer id for checking if outstanding pick requests have completed.\n   */\n  private pickTimerId = -1;\n\n  private cancelPickRequests() {\n    const {gl} = this;\n    for (const request of this.pickRequests) {\n      const {sync} = request;\n      if (sync !== null) {\n        gl.deleteSync(sync);\n      }\n      request.sync = null;\n    }\n    clearTimeout(this.pickTimerId);\n    this.pickTimerId = -1;\n  }\n\n  checkForResize() {\n    const {clientWidth, clientHeight} = this.element;\n    if (clientWidth !== this.width || clientHeight !== this.height) {\n      this.width = clientWidth;\n      this.height = clientHeight;\n      this.panelSizeChanged();\n    }\n  }\n\n  abstract panelSizeChanged(): void;\n\n  private issuePickRequestInternal(pickRequest: PickRequest) {\n    const {gl} = this;\n    let {buffer} = pickRequest;\n    if (buffer === null) {\n      buffer = pickRequest.buffer = gl.createBuffer();\n      gl.bindBuffer(WebGL2RenderingContext.PIXEL_PACK_BUFFER, buffer);\n      gl.bufferData(\n          WebGL2RenderingContext.PIXEL_PACK_BUFFER, 2 * 4 * 4 * pickDiameter * pickDiameter,\n          WebGL2RenderingContext.STREAM_READ);\n    } else {\n      gl.bindBuffer(WebGL2RenderingContext.PIXEL_PACK_BUFFER, buffer);\n    }\n    let glWindowX = this.mouseX;\n    let glWindowY = this.height - this.mouseY;\n    this.issuePickRequest(glWindowX, glWindowY);\n    pickRequest.sync = gl.fenceSync(WebGL2RenderingContext.SYNC_GPU_COMMANDS_COMPLETE, 0);\n    pickRequest.frameNumber = this.context.frameNumber;\n    pickRequest.glWindowX = glWindowX;\n    pickRequest.glWindowY = glWindowY;\n    gl.flush();\n    // TODO(jbms): maybe call gl.flush to ensure fence is submitted\n    gl.bindBuffer(WebGL2RenderingContext.PIXEL_PACK_BUFFER, null);\n    if (this.pickTimerId === -1) {\n      this.scheduleCheckForPickRequestCompletion();\n    }\n    this.pickRequestPending = false;\n    const {pickRequests} = this;\n    if (pickRequest !== pickRequests[0]) {\n      pickRequests[1] = pickRequests[0];\n      pickRequests[0] = pickRequest;\n    }\n    this.nextPickRequestTime = Date.now() + pickRequestInterval;\n  }\n\n  abstract completePickRequest(\n      glWindowX: number, glWindowY: number, data: Float32Array,\n      pickingData: FramePickingData): void;\n\n  private completePickInternal(pickRequest: PickRequest) {\n    const {gl} = this;\n    const {pickBufferContents} = this;\n    gl.bindBuffer(WebGL2RenderingContext.PIXEL_PACK_BUFFER, pickRequest.buffer);\n    gl.getBufferSubData(WebGL2RenderingContext.PIXEL_PACK_BUFFER, 0, pickBufferContents);\n    gl.bindBuffer(WebGL2RenderingContext.PIXEL_PACK_BUFFER, null);\n    const {pickingData} = this;\n    const {frameNumber} = pickRequest;\n    this.completePickRequest(\n        pickRequest.glWindowX, pickRequest.glWindowY, pickBufferContents,\n        pickingData[0].frameNumber === frameNumber ? pickingData[0] : pickingData[1]);\n  }\n\n  private scheduleCheckForPickRequestCompletion() {\n    this.pickTimerId = setTimeout(() => {\n      this.pickTimerId = -1;\n      this.checkForPickRequestCompletion();\n    }, 0);\n  }\n\n  private checkForPickRequestCompletion(checkingBeforeDraw = false, block = false) {\n    let currentFrameNumber = this.context.frameNumber;\n    let cancelIfNotReadyFrameNumber = -1;\n    if (checkingBeforeDraw) {\n      --currentFrameNumber;\n      cancelIfNotReadyFrameNumber = currentFrameNumber - 1;\n    }\n    const {pickRequests} = this;\n    const {gl} = this;\n    let remaining = false;\n    let cancelRemaining = false;\n    let available: PickRequest|undefined;\n    for (const pickRequest of pickRequests) {\n      const {sync} = pickRequest;\n      if (sync === null) continue;\n      const {frameNumber} = pickRequest;\n      if (!cancelRemaining && frameNumber >= currentFrameNumber - 1) {\n        if (block ||\n            gl.getSyncParameter(sync, WebGL2RenderingContext.SYNC_STATUS) ===\n                WebGL2RenderingContext.SIGNALED) {\n          this.completePickInternal(pickRequest);\n          cancelRemaining = true;\n        } else if (frameNumber !== cancelIfNotReadyFrameNumber) {\n          remaining = true;\n          continue;\n        }\n      }\n      gl.deleteSync(sync);\n      pickRequest.sync = null;\n      available = pickRequest;\n    }\n    const {pickTimerId} = this;\n    if (remaining && pickTimerId === -1) {\n      this.scheduleCheckForPickRequestCompletion();\n    } else if (!remaining && pickTimerId !== -1) {\n      clearTimeout(pickTimerId);\n      this.pickTimerId = -1;\n    }\n    if (!checkingBeforeDraw && available !== undefined && this.pickRequestPending &&\n        this.canIssuePickRequest()) {\n      this.issuePickRequestInternal(available);\n    }\n  }\n\n  private blockOnPickRequest() {\n    if (this.pickRequestPending) {\n      this.cancelPickRequests();\n      this.nextPickRequestTime = 0;\n      this.attemptToIssuePickRequest();\n    }\n    this.checkForPickRequestCompletion(/*checkingBeforeDraw=*/ false, /*block=*/ true);\n  }\n\n  draw() {\n    this.checkForResize();\n    const {width, height} = this;\n    if (width === 0 || height === 0) return;\n    this.checkForPickRequestCompletion(true);\n    const {pickingData} = this;\n    pickingData[0] = pickingData[1];\n    const currentFrameNumber = this.context.frameNumber;\n    const newPickingData = pickingData[1];\n    newPickingData.frameNumber = currentFrameNumber;\n    newPickingData.viewportWidth = width;\n    newPickingData.viewportHeight = height;\n    newPickingData.pickIDs.clear();\n    if (!this.drawWithPicking(newPickingData)) {\n      newPickingData.frameNumber = -1;\n      return;\n    }\n    // For the new frame, allow new pick requests regardless of interval since last request.\n    this.nextPickRequestTime = 0;\n    if (this.mouseX > 0) {\n      this.attemptToIssuePickRequest();\n    }\n  }\n\n  abstract drawWithPicking(pickingData: FramePickingData): boolean;\n\n  private nextPickRequestTime = 0;\n  private pendingPickRequestTimerId = -1;\n\n  private pendingPickRequestTimerExpired = () => {\n    this.pendingPickRequestTimerId = -1;\n    if (!this.pickRequestPending) return;\n    this.attemptToIssuePickRequest();\n  };\n\n  private canIssuePickRequest(): boolean {\n    const time = Date.now();\n    const {nextPickRequestTime, pendingPickRequestTimerId} = this;\n    if (time < nextPickRequestTime) {\n      if (pendingPickRequestTimerId == -1) {\n        this.pendingPickRequestTimerId =\n            setTimeout(this.pendingPickRequestTimerExpired, nextPickRequestTime - time);\n      }\n      return false;\n    }\n    return true;\n  }\n\n  private attemptToIssuePickRequest() {\n    if (!this.canIssuePickRequest()) return;\n    const currentFrameNumber = this.context.frameNumber;\n    const {gl} = this;\n\n    const {pickRequests} = this;\n\n    // Try to find an available PickRequest object.\n\n    for (const pickRequest of pickRequests) {\n      let {sync} = pickRequest;\n      if (sync !== null) {\n        if (pickRequest.frameNumber < currentFrameNumber - 1) {\n          gl.deleteSync(sync);\n        } else {\n          continue;\n        }\n      }\n      this.issuePickRequestInternal(pickRequest);\n      return;\n    }\n  }\n\n  /**\n   * Called each time the mouse position relative to the top level of the rendered viewport changes.\n   */\n  private updateMousePosition(mouseX: number, mouseY: number): void {\n    if (mouseX === this.mouseX && mouseY === this.mouseY) {\n      return;\n    }\n    this.mouseX = mouseX;\n    this.mouseY = mouseY;\n    if (mouseX < 0) {\n      // Mouse moved out of the viewport.\n      this.pickRequestPending = false;\n      this.cancelPickRequests();\n      return;\n    }\n    const currentFrameNumber = this.context.frameNumber;\n    const pickingData = this.pickingData[1];\n    if (pickingData.frameNumber !== currentFrameNumber ||\n        this.width !== pickingData.viewportWidth || this.height !== pickingData.viewportHeight) {\n      // Viewport size has changed since the last frame, which means a redraw is pending.  Don't\n      // issue pick request now.  Once will be issued automatically after the redraw.\n      return;\n    }\n    this.pickRequestPending = true;\n    this.attemptToIssuePickRequest();\n  }\n\n  constructor(\n      context: DisplayContext, element: HTMLElement, public viewer: RenderedDataViewerState) {\n    super(context, element, viewer.visibility);\n    this.inputEventMap = viewer.inputEventMap;\n\n    element.classList.add('neuroglancer-rendered-data-panel');\n    element.classList.add('neuroglancer-panel');\n    element.classList.add('neuroglancer-noselect');\n\n    this.registerDisposer(new AutomaticallyFocusedElement(element));\n    this.registerDisposer(new KeyboardEventBinder(element, this.inputEventMap));\n    this.registerDisposer(new MouseEventBinder(element, this.inputEventMap));\n    this.registerDisposer(new TouchEventBinder(element, this.inputEventMap));\n\n    this.registerEventListener(element, 'mousemove', this.onMousemove.bind(this));\n    this.registerEventListener(element, 'touchstart', this.onTouchstart.bind(this));\n    this.registerEventListener(element, 'mouseleave', this.onMouseout.bind(this));\n\n    registerActionListener(element, 'snap', () => {\n      this.navigationState.pose.snap();\n    });\n\n    registerActionListener(element, 'zoom-in', () => {\n      this.navigationState.zoomBy(0.5);\n    });\n\n    registerActionListener(element, 'zoom-out', () => {\n      this.navigationState.zoomBy(2.0);\n    });\n\n    registerActionListener(element, 'highlight', () => {\n      this.viewer.layerManager.invokeAction('highlight');\n    });\n\n    for (let axis = 0; axis < 3; ++axis) {\n      let axisName = AXES_NAMES[axis];\n      for (let sign of [-1, +1]) {\n        let signStr = (sign < 0) ? '-' : '+';\n        registerActionListener(element, `rotate-relative-${axisName}${signStr}`, () => {\n          this.navigationState.pose.rotateRelative(kAxes[axis], sign * 0.1);\n        });\n        let tempOffset = vec3.create();\n        registerActionListener(element, `${axisName}${signStr}`, () => {\n          let {navigationState} = this;\n          let offset = tempOffset;\n          offset[0] = 0;\n          offset[1] = 0;\n          offset[2] = 0;\n          offset[axis] = sign;\n          navigationState.pose.translateVoxelsRelative(offset);\n        });\n      }\n    }\n\n    registerActionListener(element, 'zoom-via-wheel', (event: ActionEvent<WheelEvent>) => {\n      const e = event.detail;\n      this.onMousemove(e);\n      this.zoomByMouse(getWheelZoomAmount(e));\n    });\n\n    registerActionListener(element, 'translate-via-mouse-drag', (e: ActionEvent<MouseEvent>) => {\n      startRelativeMouseDrag(e.detail, (_event, deltaX, deltaY) => {\n        this.translateByViewportPixels(deltaX, deltaY);\n      });\n    });\n\n    registerActionListener(\n        element, 'translate-in-plane-via-touchtranslate', (e: ActionEvent<TouchTranslateInfo>) => {\n          const {detail} = e;\n          this.translateByViewportPixels(detail.deltaX, detail.deltaY);\n        });\n\n    registerActionListener(\n        element, 'translate-z-via-touchtranslate', (e: ActionEvent<TouchTranslateInfo>) => {\n          const {detail} = e;\n          let {navigationState} = this;\n          let offset = tempVec3;\n          offset[0] = 0;\n          offset[1] = 0;\n          offset[2] = detail.deltaY + detail.deltaX;\n          navigationState.pose.translateVoxelsRelative(offset);\n        });\n\n    for (const amount of [1, 10]) {\n      registerActionListener(element, `z+${amount}-via-wheel`, (event: ActionEvent<WheelEvent>) => {\n        const e = event.detail;\n        let {navigationState} = this;\n        let offset = tempVec3;\n        let delta = e.deltaY !== 0 ? e.deltaY : e.deltaX;\n        offset[0] = 0;\n        offset[1] = 0;\n        offset[2] = (delta > 0 ? -1 : 1) * amount;\n        navigationState.pose.translateVoxelsRelative(offset);\n      });\n    }\n\n    registerActionListener(element, 'move-to-mouse-position', () => {\n      let {mouseState} = this.viewer;\n      if (mouseState.updateUnconditionally()) {\n        let position = this.navigationState.pose.position;\n        vec3.copy(position.spatialCoordinates, mouseState.position);\n        position.changed.dispatch();\n      }\n    });\n\n    registerActionListener(element, 'snap', () => this.navigationState.pose.snap());\n\n    registerActionListener(element, 'select-annotation', () => {\n      const {mouseState, layerManager} = this.viewer;\n      const state = getSelectedAnnotation(mouseState, layerManager);\n      if (state === undefined) {\n        return;\n      }\n      const userLayer = state.layer.layer;\n      if (userLayer !== null) {\n        this.viewer.selectedLayer.layer = state.layer;\n        this.viewer.selectedLayer.visible = true;\n        userLayer.tabs.value = 'annotations';\n        (<UserLayerWithAnnotations>userLayer).selectedAnnotation.value = {\n          id: state.id,\n          partIndex: state.partIndex\n        };\n      }\n    });\n\n    registerActionListener(element, 'move-annotation', (e: ActionEvent<MouseEvent>) => {\n      const {mouseState} = this.viewer;\n      const selectedAnnotationId = mouseState.pickedAnnotationId;\n      const annotationLayer = mouseState.pickedAnnotationLayer;\n      if (annotationLayer !== undefined) {\n        if (selectedAnnotationId !== undefined) {\n          e.stopPropagation();\n          let annotationRef = annotationLayer.source.getReference(selectedAnnotationId)!;\n          let ann = <Annotation>annotationRef.value;\n\n          const handler = getAnnotationTypeRenderHandler(ann.type);\n          const pickedOffset = mouseState.pickedOffset;\n          let repPoint = handler.getRepresentativePoint(\n              annotationLayer.objectToGlobal, ann, mouseState.pickedOffset);\n          let totDeltaVec = vec2.set(vec2.create(), 0, 0);\n          if (mouseState.updateUnconditionally()) {\n            startRelativeMouseDrag(\n                e.detail,\n                (_event, deltaX, deltaY) => {\n                  vec2.add(totDeltaVec, totDeltaVec, [deltaX, deltaY]);\n                  let newRepPt = this.translateDataPointByViewportPixels(\n                      vec3.create(), repPoint, totDeltaVec[0], totDeltaVec[1]);\n                  let newAnnotation = handler.updateViaRepresentativePoint(\n                      ann, newRepPt, annotationLayer.globalToObject, pickedOffset);\n                  annotationLayer.source.update(annotationRef, newAnnotation);\n                },\n                (_event) => {\n                  annotationRef.dispose();\n                });\n          }\n        }\n      }\n    });\n\n    registerActionListener(element, 'delete-annotation', () => {\n      const {mouseState} = this.viewer;\n      const selectedAnnotationId = mouseState.pickedAnnotationId;\n      const annotationLayer = mouseState.pickedAnnotationLayer;\n      if (annotationLayer !== undefined && !annotationLayer.source.readonly &&\n          selectedAnnotationId !== undefined) {\n        const ref = annotationLayer.source.getReference(selectedAnnotationId);\n        try {\n          annotationLayer.source.delete(ref);\n        } finally {\n          ref.dispose();\n        }\n      }\n    });\n\n    registerActionListener(element, 'zoom-via-touchpinch', (e: ActionEvent<TouchPinchInfo>) => {\n      const {detail} = e;\n      this.handleMouseMove(detail.centerX, detail.centerY);\n      const ratio = detail.prevDistance / detail.distance;\n      if (ratio > 0.1 && ratio < 10) {\n        this.zoomByMouse(ratio);\n      }\n    });\n  }\n\n  onMouseout(_event: MouseEvent) {\n    this.updateMousePosition(-1, -1);\n    this.viewer.mouseState.setForcer(undefined);\n  }\n\n  abstract translateByViewportPixels(deltaX: number, deltaY: number): void;\n\n  handleMouseMove(clientX: number, clientY: number) {\n    let {element} = this;\n    const bounds = element.getBoundingClientRect();\n    const mouseX = clientX - bounds.left;\n    const mouseY = clientY - bounds.top;\n    const {mouseState} = this.viewer;\n    mouseState.pageX = clientX + window.scrollX;\n    mouseState.pageY = clientY + window.scrollY;\n    mouseState.setForcer(this.mouseStateForcer);\n    this.updateMousePosition(mouseX, mouseY);\n  }\n\n  onMousemove(event: MouseEvent) {\n    let {element} = this;\n    if (event.target !== element) {\n      return;\n    }\n    this.handleMouseMove(event.clientX, event.clientY);\n  }\n\n  onTouchstart(event: TouchEvent) {\n    let {element} = this;\n    if (event.target !== element || event.targetTouches.length !== 1) {\n      return;\n    }\n    const {clientX, clientY} = event.targetTouches[0];\n    this.handleMouseMove(clientX, clientY);\n  }\n\n  disposed() {\n    let {mouseState} = this.viewer;\n    mouseState.removeForcer(this.mouseStateForcer);\n    const {gl} = this;\n    this.cancelPickRequests();\n    const {pendingPickRequestTimerId} = this;\n    if (pendingPickRequestTimerId !== -1) {\n      clearTimeout(pendingPickRequestTimerId);\n    }\n    for (const request of this.pickRequests) {\n      gl.deleteBuffer(request.buffer);\n    }\n    super.disposed();\n  }\n\n  abstract zoomByMouse(factor: number): void;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {hashCombine} from 'neuroglancer/gpu_hash/hash_function';\nimport {glsl_hashCombine, HashMapShaderManager, GPUHashTable} from 'neuroglancer/gpu_hash/shader';\nimport {HashTableBase} from 'neuroglancer/gpu_hash/hash_table';\nimport {hsvToRgb} from 'neuroglancer/util/colorspace';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {Uint64} from 'neuroglancer/util/uint64';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {ShaderBuilder, ShaderProgram} from 'neuroglancer/webgl/shader';\nimport {glsl_hsvToRgb, glsl_uint64} from 'neuroglancer/webgl/shader_lib';\nimport {getRandomUint32} from './util/random';\nimport {Trackable} from './util/trackable';\n\nconst NUM_COMPONENTS = 2;\n\nexport class SegmentColorShaderManager {\n  seedName = this.prefix + '_seed';\n\n  constructor(public prefix: string) {}\n\n  defineShader(builder: ShaderBuilder) {\n    const {seedName} = this;\n    builder.addUniform('highp uint', seedName);\n    builder.addFragmentCode(glsl_uint64);\n    builder.addFragmentCode(glsl_hashCombine);\n    builder.addFragmentCode(glsl_hsvToRgb);\n    let s = `\nvec3 ${this.prefix}(uint64_t x) {\n  uint h = hashCombine(${seedName}, x);\n  vec${NUM_COMPONENTS} v;\n`;\n    for (let i = 0; i < NUM_COMPONENTS; ++i) {\n      s += `\n  v[${i}] = float(h & 0xFFu) / 255.0;\n  h >>= 8u;\n`;\n    }\n    s += `\n  vec3 hsv = vec3(v.x, 0.5 + v.y * 0.5, 1.0);\n  return hsvToRgb(hsv);\n}\n`;\n    builder.addFragmentCode(s);\n  }\n\n  enable(gl: GL, shader: ShaderProgram, segmentColorHash: SegmentColorHash) {\n    gl.uniform1ui(shader.uniform(this.seedName), segmentColorHash.hashSeed);\n  }\n}\n\nlet tempColor = new Float32Array(3);\n\nexport class SegmentColorHash implements Trackable {\n  changed = new NullarySignal();\n\n  constructor(public hashSeed: number = getRandomUint32()) {}\n\n  static getDefault() {\n    return new SegmentColorHash(0);\n  }\n\n  compute(out: Float32Array, x: Uint64) {\n    let h = hashCombine(this.hashSeed, x.low);\n    h = hashCombine(h, x.high);\n    const c0 = (h & 0xFF) / 255;\n    const c1 = ((h >> 8) & 0xFF) / 255;\n    hsvToRgb(out, c0, 0.5 + 0.5 * c1, 1.0);\n    return out;\n  }\n\n  computeCssColor(x: Uint64) {\n    this.compute(tempColor, x);\n    return `rgb(${tempColor[0] * 100}%,${tempColor[1] * 100}%,${tempColor[2] * 100}%)`;\n  }\n\n  randomize() {\n    this.hashSeed = getRandomUint32();\n    this.changed.dispatch();\n  }\n\n  toString() {\n    return `new SegmentColorHash(${this.hashSeed})`;\n  }\n\n  toJSON() {\n    return this.hashSeed === 0 ? undefined : this.hashSeed;\n  }\n\n  reset() {\n    this.restoreState(0);\n  }\n\n  restoreState(x: any) {\n    const newSeed = x >>> 0;\n    if (newSeed !== this.hashSeed) {\n      this.hashSeed = newSeed;\n      this.changed.dispatch();\n    }\n  }\n}\n\n/**\n * Adds the shader code to get a segment's color if it is present in the map.\n */\nexport class SegmentStatedColorShaderManager {\n  private hashMapShaderManager = new HashMapShaderManager('segmentStatedColorHash');\n\n  constructor(public prefix: string) {}\n\n  defineShader(builder: ShaderBuilder) {\n    this.hashMapShaderManager.defineShader(builder);\n    let s = `\nbool ${this.getFunctionName}(uint64_t x, out vec3 value) {\n  uint64_t uint64Value;\n  if (${this.hashMapShaderManager.getFunctionName}(x, uint64Value)) {\n    uint uintValue = uint64Value.value[0];\n    value.x = float((uintValue & 0xff0000u) >> 16) / 255.0;\n    value.y = float((uintValue & 0x00ff00u) >>  8) / 255.0;\n    value.z = float((uintValue & 0x0000ffu))       / 255.0;\n    return true;\n  }\n  return false;\n}\n`;\n    builder.addFragmentCode(s);\n  }\n\n  get getFunctionName() {\n    return `${this.prefix}_get`;\n  }\n\n  enable<HashTable extends HashTableBase>(\n    gl: GL, shader: ShaderProgram, hashTable: GPUHashTable<HashTable>) {\n    this.hashMapShaderManager.enable(gl, shader, hashTable);\n  }\n\n  disable(gl: GL, shader: ShaderProgram) {\n    this.hashMapShaderManager.disable(gl, shader);\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {SharedDisjointUint64Sets} from 'neuroglancer/shared_disjoint_sets';\nimport {Uint64Set} from 'neuroglancer/uint64_set';\nimport {Uint64} from 'neuroglancer/util/uint64';\n\nexport interface VisibleSegmentsState {\n  visibleSegments: Uint64Set;\n  segmentEquivalences: SharedDisjointUint64Sets;\n}\n\n/**\n * Returns a string key for identifying a uint64 object id.  This is faster than\n * Uint64.prototype.toString().\n */\nexport function getObjectKey(objectId: Uint64): string {\n  return `${objectId.low},${objectId.high}`;\n}\n\nexport function forEachVisibleSegment(\n    state: VisibleSegmentsState, callback: (objectId: Uint64, rootObjectId: Uint64) => void) {\n  let {visibleSegments, segmentEquivalences} = state;\n  for (let rootObjectId of visibleSegments) {\n    // TODO(jbms): Remove this check if logic is added to ensure that it always holds.\n    if (!segmentEquivalences.disjointSets.isMinElement(rootObjectId)) {\n      continue;\n    }\n    for (let objectId of segmentEquivalences.setElements(rootObjectId)) {\n      callback(objectId, rootObjectId);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {ChunkManager} from 'neuroglancer/chunk_manager/frontend';\nimport {CoordinateTransform} from 'neuroglancer/coordinate_transform';\nimport {LayerSelectedValues, UserLayer} from 'neuroglancer/layer';\nimport {RenderScaleHistogram} from 'neuroglancer/render_scale_statistics';\nimport {SegmentColorHash} from 'neuroglancer/segment_color';\nimport {VisibleSegmentsState} from 'neuroglancer/segmentation_display_state/base';\nimport {SharedWatchableValue} from 'neuroglancer/shared_watchable_value';\nimport {TrackableAlphaValue} from 'neuroglancer/trackable_alpha';\nimport {TrackableValue} from 'neuroglancer/trackable_value';\nimport {Uint64Set} from 'neuroglancer/uint64_set';\nimport {Uint64Map} from 'neuroglancer/uint64_map';\nimport {hsvToRgb, rgbToHsv} from 'neuroglancer/util/colorspace';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {vec4} from 'neuroglancer/util/geom';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {Uint64} from 'neuroglancer/util/uint64';\nimport {withSharedVisibility} from 'neuroglancer/visibility_priority/frontend';\nimport {SharedObject} from 'neuroglancer/worker_rpc';\n\nexport class Uint64MapEntry {\n  constructor(public key: Uint64, public value: Uint64) {}\n  toString() {\n    return `${this.key}${this.value}`;\n  }\n}\n\nexport class SegmentSelectionState extends RefCounted {\n  selectedSegment = new Uint64();\n  hasSelectedSegment = false;\n  changed = new NullarySignal();\n\n  set(value: Uint64|null|undefined) {\n    if (value == null) {\n      if (this.hasSelectedSegment) {\n        this.hasSelectedSegment = false;\n        this.changed.dispatch();\n      }\n    } else {\n      let existingValue = this.selectedSegment;\n      if (!this.hasSelectedSegment || value.low !== existingValue.low ||\n          value.high !== existingValue.high) {\n        existingValue.low = value.low;\n        existingValue.high = value.high;\n        this.hasSelectedSegment = true;\n        this.changed.dispatch();\n      }\n    }\n  }\n\n  isSelected(value: Uint64) {\n    return this.hasSelectedSegment && Uint64.equal(value, this.selectedSegment);\n  }\n\n  bindTo(layerSelectedValues: LayerSelectedValues, userLayer: UserLayer) {\n    let temp = new Uint64();\n    this.registerDisposer(layerSelectedValues.changed.add(() => {\n      let value = layerSelectedValues.get(userLayer);\n      if (typeof value === 'number') {\n        temp.low = value;\n        temp.high = 0;\n        value = temp;\n      } else if (value instanceof Uint64MapEntry) {\n        value = value.value;\n      }\n      this.set(value);\n    }));\n  }\n}\n\nexport interface SegmentationDisplayState extends VisibleSegmentsState {\n  segmentSelectionState: SegmentSelectionState;\n  segmentColorHash: SegmentColorHash;\n  segmentStatedColors: Uint64Map;\n  saturation: TrackableAlphaValue;\n  highlightedSegments: Uint64Set;\n}\n\nexport interface SegmentationDisplayStateWithAlpha extends SegmentationDisplayState {\n  objectAlpha: TrackableAlphaValue;\n}\n\nexport interface SegmentationDisplayState3D extends SegmentationDisplayStateWithAlpha {\n  objectToDataTransform: CoordinateTransform;\n  renderScaleHistogram: RenderScaleHistogram;\n  renderScaleTarget: TrackableValue<number>;\n}\n\nexport function registerRedrawWhenSegmentationDisplayStateChanged(\n    displayState: SegmentationDisplayState, renderLayer: {redrawNeeded: NullarySignal}&RefCounted) {\n  const dispatchRedrawNeeded = renderLayer.redrawNeeded.dispatch;\n  renderLayer.registerDisposer(displayState.segmentColorHash.changed.add(dispatchRedrawNeeded));\n  renderLayer.registerDisposer(displayState.visibleSegments.changed.add(dispatchRedrawNeeded));\n  renderLayer.registerDisposer(displayState.saturation.changed.add(dispatchRedrawNeeded));\n  renderLayer.registerDisposer(displayState.highlightedSegments.changed.add(dispatchRedrawNeeded));\n  renderLayer.registerDisposer(displayState.segmentEquivalences.changed.add(dispatchRedrawNeeded));\n  renderLayer.registerDisposer(\n      displayState.segmentSelectionState.changed.add(dispatchRedrawNeeded));\n}\n\nexport function registerRedrawWhenSegmentationDisplayStateWithAlphaChanged(\n    displayState: SegmentationDisplayStateWithAlpha,\n    renderLayer: {redrawNeeded: NullarySignal}&RefCounted) {\n  registerRedrawWhenSegmentationDisplayStateChanged(displayState, renderLayer);\n  renderLayer.registerDisposer(\n      displayState.objectAlpha.changed.add(renderLayer.redrawNeeded.dispatch));\n}\n\nexport function registerRedrawWhenSegmentationDisplayState3DChanged(\n    displayState: SegmentationDisplayState3D,\n    renderLayer: {redrawNeeded: NullarySignal}&RefCounted) {\n  registerRedrawWhenSegmentationDisplayStateWithAlphaChanged(displayState, renderLayer);\n  renderLayer.registerDisposer(\n      displayState.objectToDataTransform.changed.add(renderLayer.redrawNeeded.dispatch));\n  renderLayer.registerDisposer(\n      displayState.renderScaleTarget.changed.add(renderLayer.redrawNeeded.dispatch));\n}\n\n/**\n * Temporary values used by getObjectColor.\n */\nconst tempColor = vec4.create();\nconst tempStatedColor = new Uint64();\n\n/**\n * Returns the alpha-premultiplied color to use.\n */\nexport function getObjectColor(\n    displayState: SegmentationDisplayState, objectId: Uint64, alpha: number = 1) {\n  const color = tempColor;\n  color[3] = alpha;\n  if (displayState.segmentStatedColors.has(objectId)) {\n    // If displayState maps the ID to a color, use it\n    displayState.segmentStatedColors.get(objectId, tempStatedColor);\n    color[0] = ((tempStatedColor.low & 0xff0000) >>> 16) / 255.0;\n    color[1] = ((tempStatedColor.low & 0x00ff00) >>>  8) / 255.0;\n    color[2] = ((tempStatedColor.low & 0x0000ff))        / 255.0;\n  } else {\n    displayState.segmentColorHash.compute(color, objectId);\n  }\n\n  if (displayState.segmentSelectionState.isSelected(objectId)) {\n    for (let i = 0; i < 3; ++i) {\n      color[i] = color[i] * 0.5 + 0.5;\n    }\n  }\n\n  // Apply saturation\n  let hsv = new Float32Array(3);\n  rgbToHsv(hsv, color[0], color[1], color[2]);\n  hsv[1] *= displayState.saturation.value;\n  let rgb = new Float32Array(3);\n  hsvToRgb(rgb, hsv[0], hsv[1], hsv[2]);\n  color[0] = rgb[0];\n  color[1] = rgb[1];\n  color[2] = rgb[2];\n\n  // Color highlighted segments\n  if (displayState.highlightedSegments.has(objectId)) {\n    // Make it vivid blue for selection\n    color[0] = 0.2;\n    color[1] = 0.2;\n    color[2] = 2.0;\n    color[3] = 1.0;\n  }\n\n  color[0] *= alpha;\n  color[1] *= alpha;\n  color[2] *= alpha;\n  return color;\n}\n\nconst Base = withSharedVisibility(SharedObject);\nexport class SegmentationLayerSharedObject extends Base {\n  constructor(public chunkManager: ChunkManager, public displayState: SegmentationDisplayState3D) {\n    super();\n  }\n\n  initializeCounterpartWithChunkManager(options: any) {\n    let {displayState} = this;\n    options['chunkManager'] = this.chunkManager.rpcId;\n    options['visibleSegments'] = displayState.visibleSegments.rpcId;\n    options['segmentEquivalences'] = displayState.segmentEquivalences.rpcId;\n    options['objectToDataTransform'] =\n        this.registerDisposer(SharedWatchableValue.makeFromExisting(\n                                  this.chunkManager.rpc!, this.displayState.objectToDataTransform))\n            .rpcId;\n    options['renderScaleTarget'] =\n        this.registerDisposer(SharedWatchableValue.makeFromExisting(\n                                  this.chunkManager.rpc!, this.displayState.renderScaleTarget))\n            .rpcId;\n    super.initializeCounterpart(this.chunkManager.rpc!, options);\n  }\n}\n","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport 'neuroglancer/noselect.css';\nimport 'neuroglancer/segmentation_user_layer.css';\n\nimport {UserLayer} from 'neuroglancer/layer';\nimport {LayerListSpecification, registerLayerType, registerVolumeLayerType} from 'neuroglancer/layer_specification';\nimport {MeshSource, MultiscaleMeshSource} from 'neuroglancer/mesh/frontend';\nimport {MeshLayer, MultiscaleMeshLayer} from 'neuroglancer/mesh/frontend';\nimport {Overlay} from 'neuroglancer/overlay';\nimport {RenderScaleHistogram, trackableRenderScaleTarget} from 'neuroglancer/render_scale_statistics';\nimport {SegmentColorHash} from 'neuroglancer/segment_color';\nimport {SegmentSelectionState, Uint64MapEntry} from 'neuroglancer/segmentation_display_state/frontend';\nimport {SharedDisjointUint64Sets} from 'neuroglancer/shared_disjoint_sets';\nimport {FRAGMENT_MAIN_START as SKELETON_FRAGMENT_MAIN_START, PerspectiveViewSkeletonLayer, SkeletonLayer, SkeletonRenderingOptions, SkeletonSource, SliceViewPanelSkeletonLayer, ViewSpecificSkeletonRenderingOptions} from 'neuroglancer/skeleton/frontend';\nimport {VolumeType} from 'neuroglancer/sliceview/volume/base';\nimport {SegmentationRenderLayer} from 'neuroglancer/sliceview/volume/segmentation_renderlayer';\nimport {trackableAlphaValue} from 'neuroglancer/trackable_alpha';\nimport {ElementVisibilityFromTrackableBoolean, TrackableBoolean, TrackableBooleanCheckbox} from 'neuroglancer/trackable_boolean';\nimport {ComputedWatchableValue} from 'neuroglancer/trackable_value';\nimport {Uint64Set} from 'neuroglancer/uint64_set';\nimport {Uint64Map} from 'neuroglancer/uint64_map';\nimport {UserLayerWithVolumeSourceMixin} from 'neuroglancer/user_layer_with_volume_source';\nimport {parseRGBColorSpecification, packColor} from 'neuroglancer/util/color';\nimport {Borrowed} from 'neuroglancer/util/disposable';\nimport {parseArray, verifyObjectProperty, verifyOptionalString, verifyObjectAsMap} from 'neuroglancer/util/json';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {Uint64} from 'neuroglancer/util/uint64';\nimport {makeWatchableShaderError} from 'neuroglancer/webgl/dynamic_shader';\nimport {EnumSelectWidget} from 'neuroglancer/widget/enum_widget';\nimport {RangeWidget} from 'neuroglancer/widget/range';\nimport {RenderScaleWidget} from 'neuroglancer/widget/render_scale_widget';\nimport {SegmentSetWidget} from 'neuroglancer/widget/segment_set_widget';\nimport {ShaderCodeWidget} from 'neuroglancer/widget/shader_code_widget';\nimport {Tab} from 'neuroglancer/widget/tab_view';\nimport {Uint64EntryWidget} from 'neuroglancer/widget/uint64_entry_widget';\n\nconst SELECTED_ALPHA_JSON_KEY = 'selectedAlpha';\nconst NOT_SELECTED_ALPHA_JSON_KEY = 'notSelectedAlpha';\nconst OBJECT_ALPHA_JSON_KEY = 'objectAlpha';\nconst SATURATION_JSON_KEY = 'saturation';\nconst HIDE_SEGMENT_ZERO_JSON_KEY = 'hideSegmentZero';\nconst MESH_JSON_KEY = 'mesh';\nconst SKELETONS_JSON_KEY = 'skeletons';\nconst SEGMENTS_JSON_KEY = 'segments';\nconst HIGHLIGHTS_JSON_KEY = 'highlights';\nconst EQUIVALENCES_JSON_KEY = 'equivalences';\nconst COLOR_SEED_JSON_KEY = 'colorSeed';\nconst SEGMENT_STATED_COLORS_JSON_KEY = 'segmentColors';\nconst MESH_RENDER_SCALE_JSON_KEY = 'meshRenderScale';\n\nconst SKELETON_RENDERING_JSON_KEY = 'skeletonRendering';\nconst SKELETON_SHADER_JSON_KEY = 'skeletonShader';\n\nconst Base = UserLayerWithVolumeSourceMixin(UserLayer);\nexport class SegmentationUserLayer extends Base {\n  displayState = {\n    segmentColorHash: SegmentColorHash.getDefault(),\n    segmentStatedColors: Uint64Map.makeWithCounterpart(this.manager.worker),\n    segmentSelectionState: new SegmentSelectionState(),\n    selectedAlpha: trackableAlphaValue(0.5),\n    saturation: trackableAlphaValue(1.0),\n    notSelectedAlpha: trackableAlphaValue(0),\n    objectAlpha: trackableAlphaValue(1.0),\n    hideSegmentZero: new TrackableBoolean(true, true),\n    visibleSegments: Uint64Set.makeWithCounterpart(this.manager.worker),\n    highlightedSegments: Uint64Set.makeWithCounterpart(this.manager.worker),\n    segmentEquivalences: SharedDisjointUint64Sets.makeWithCounterpart(this.manager.worker),\n    objectToDataTransform: this.transform,\n    skeletonRenderingOptions: new SkeletonRenderingOptions(),\n    shaderError: makeWatchableShaderError(),\n    renderScaleHistogram: new RenderScaleHistogram(),\n    renderScaleTarget: trackableRenderScaleTarget(1),\n  };\n\n  /**\n   * If meshPath is undefined, a default mesh source provided by the volume may be used.  If\n   * meshPath is null, the default mesh source is not used.\n   */\n  meshPath: string|null|undefined;\n  skeletonsPath: string|undefined;\n  meshLayer: Borrowed<MeshLayer|MultiscaleMeshLayer>|undefined;\n  skeletonLayer: Borrowed<SkeletonLayer>|undefined;\n\n  // Dispatched when either meshLayer or skeletonLayer changes.\n  objectLayerStateChanged = new NullarySignal();\n\n  constructor(public manager: LayerListSpecification, x: any) {\n    super(manager, x);\n    this.displayState.visibleSegments.changed.add(this.specificationChanged.dispatch);\n    this.displayState.segmentEquivalences.changed.add(this.specificationChanged.dispatch);\n    this.displayState.segmentSelectionState.bindTo(manager.layerSelectedValues, this);\n    this.displayState.selectedAlpha.changed.add(this.specificationChanged.dispatch);\n    this.displayState.saturation.changed.add(this.specificationChanged.dispatch);\n    this.displayState.notSelectedAlpha.changed.add(this.specificationChanged.dispatch);\n    this.displayState.objectAlpha.changed.add(this.specificationChanged.dispatch);\n    this.displayState.hideSegmentZero.changed.add(this.specificationChanged.dispatch);\n    this.displayState.skeletonRenderingOptions.changed.add(this.specificationChanged.dispatch);\n    this.displayState.segmentColorHash.changed.add(this.specificationChanged.dispatch);\n    this.displayState.segmentStatedColors.changed.add(this.specificationChanged.dispatch);\n    this.displayState.renderScaleTarget.changed.add(this.specificationChanged.dispatch);\n    this.tabs.add(\n        'rendering', {label: 'Rendering', order: -100, getter: () => new DisplayOptionsTab(this)});\n    this.tabs.default = 'rendering';\n  }\n\n  get volumeOptions() {\n    return {volumeType: VolumeType.SEGMENTATION};\n  }\n\n  restoreState(specification: any) {\n    super.restoreState(specification);\n    this.displayState.selectedAlpha.restoreState(specification[SELECTED_ALPHA_JSON_KEY]);\n    this.displayState.saturation.restoreState(specification[SATURATION_JSON_KEY]);\n    this.displayState.notSelectedAlpha.restoreState(specification[NOT_SELECTED_ALPHA_JSON_KEY]);\n    this.displayState.objectAlpha.restoreState(specification[OBJECT_ALPHA_JSON_KEY]);\n    this.displayState.hideSegmentZero.restoreState(specification[HIDE_SEGMENT_ZERO_JSON_KEY]);\n\n    const {skeletonRenderingOptions} = this.displayState;\n    skeletonRenderingOptions.restoreState(specification[SKELETON_RENDERING_JSON_KEY]);\n    const skeletonShader = specification[SKELETON_SHADER_JSON_KEY];\n    if (skeletonShader !== undefined) {\n      skeletonRenderingOptions.shader.restoreState(skeletonShader);\n    }\n    this.displayState.segmentColorHash.restoreState(specification[COLOR_SEED_JSON_KEY]);\n    this.displayState.renderScaleTarget.restoreState(specification[MESH_RENDER_SCALE_JSON_KEY]);\n\n    verifyObjectProperty(specification, EQUIVALENCES_JSON_KEY, y => {\n      this.displayState.segmentEquivalences.restoreState(y);\n    });\n\n    const restoreSegmentsList = (key: string, segments: Uint64Set) => {\n      verifyObjectProperty(specification, key, y => {\n        if (y !== undefined) {\n          let {segmentEquivalences} = this.displayState;\n          parseArray(y, value => {\n            let id = Uint64.parseString(String(value), 10);\n            segments.add(segmentEquivalences.get(id));\n          });\n        }\n      });\n    };\n\n    restoreSegmentsList(SEGMENTS_JSON_KEY, this.displayState.visibleSegments);\n    restoreSegmentsList(HIGHLIGHTS_JSON_KEY, this.displayState.highlightedSegments);\n\n    this.displayState.highlightedSegments.changed.add(() => {\n      this.specificationChanged.dispatch();\n    });\n\n    verifyObjectProperty(specification, SEGMENT_STATED_COLORS_JSON_KEY, y => {\n      if (y !== undefined) {\n        let {segmentEquivalences} = this.displayState;\n        let result = verifyObjectAsMap(y, x => parseRGBColorSpecification(String(x)));\n        for (let [idStr, colorVec] of result) {\n          const id = Uint64.parseString(String(idStr));\n          const color = new Uint64(packColor(colorVec));\n          this.displayState.segmentStatedColors.set(segmentEquivalences.get(id), color);\n        }\n      }\n    });\n\n    const {multiscaleSource} = this;\n    let meshPath = this.meshPath = specification[MESH_JSON_KEY] === null ?\n        null :\n        verifyOptionalString(specification[MESH_JSON_KEY]);\n    let skeletonsPath = this.skeletonsPath =\n        verifyObjectProperty(specification, SKELETONS_JSON_KEY, verifyOptionalString);\n\n    let remaining = 0;\n    if (meshPath != null) {\n      ++remaining;\n      this.manager.dataSourceProvider.getMeshSource(this.manager.chunkManager, meshPath)\n          .then(meshSource => {\n            if (!this.wasDisposed) {\n              this.addMesh(meshSource);\n              if (--remaining === 0) {\n                this.isReady = true;\n              }\n            }\n          });\n    }\n\n    if (skeletonsPath !== undefined) {\n      ++remaining;\n      this.manager.dataSourceProvider.getSkeletonSource(this.manager.chunkManager, skeletonsPath)\n          .then(skeletonSource => {\n            if (!this.wasDisposed) {\n              this.addSkeletonSource(skeletonSource);\n              if (--remaining === 0) {\n                this.isReady = true;\n              }\n            }\n          });\n    }\n\n    if (multiscaleSource !== undefined) {\n      ++remaining;\n      multiscaleSource.then(volume => {\n        if (!this.wasDisposed) {\n          const {displayState} = this;\n          this.addRenderLayer(new SegmentationRenderLayer(volume, {\n            ...displayState,\n            transform: displayState.objectToDataTransform,\n            renderScaleHistogram: this.sliceViewRenderScaleHistogram,\n            renderScaleTarget: this.sliceViewRenderScaleTarget,\n          }));\n          if (meshPath === undefined && skeletonsPath === undefined) {\n            ++remaining;\n            Promise.resolve(volume.getMeshSource()).then(objectSource => {\n              if (this.wasDisposed) {\n                if (objectSource !== null) {\n                  objectSource.dispose();\n                }\n                return;\n              }\n              if (--remaining === 0) {\n                this.isReady = true;\n              }\n              if ((objectSource instanceof MeshSource) ||\n                  (objectSource instanceof MultiscaleMeshSource)) {\n                this.addMesh(objectSource);\n              } else if (objectSource instanceof SkeletonSource) {\n                this.addSkeletonSource(objectSource);\n              }\n            });\n          }\n          if (--remaining === 0) {\n            this.isReady = true;\n          }\n        }\n      });\n    }\n  }\n\n  addMesh(meshSource: MeshSource|MultiscaleMeshSource) {\n    if (meshSource instanceof MeshSource) {\n      this.meshLayer = new MeshLayer(this.manager.chunkManager, meshSource, this.displayState);\n    } else {\n      this.meshLayer =\n          new MultiscaleMeshLayer(this.manager.chunkManager, meshSource, this.displayState);\n    }\n    this.addRenderLayer(this.meshLayer);\n    this.objectLayerStateChanged.dispatch();\n  }\n\n  addSkeletonSource(skeletonSource: SkeletonSource) {\n    let base = new SkeletonLayer(\n        this.manager.chunkManager, skeletonSource, this.manager.voxelSize, this.displayState);\n    this.skeletonLayer = base;\n    this.addRenderLayer(new PerspectiveViewSkeletonLayer(base.addRef()));\n    this.addRenderLayer(new SliceViewPanelSkeletonLayer(/* transfer ownership */ base));\n    this.objectLayerStateChanged.dispatch();\n  }\n\n  toJSON() {\n    const x = super.toJSON();\n    x['type'] = 'segmentation';\n    x[MESH_JSON_KEY] = this.meshPath;\n    x[SKELETONS_JSON_KEY] = this.skeletonsPath;\n    x[SELECTED_ALPHA_JSON_KEY] = this.displayState.selectedAlpha.toJSON();\n    x[NOT_SELECTED_ALPHA_JSON_KEY] = this.displayState.notSelectedAlpha.toJSON();\n    x[SATURATION_JSON_KEY] = this.displayState.saturation.toJSON();\n    x[OBJECT_ALPHA_JSON_KEY] = this.displayState.objectAlpha.toJSON();\n    x[HIDE_SEGMENT_ZERO_JSON_KEY] = this.displayState.hideSegmentZero.toJSON();\n    x[COLOR_SEED_JSON_KEY] = this.displayState.segmentColorHash.toJSON();\n    let {segmentStatedColors} = this.displayState;\n    if (segmentStatedColors.size > 0) {\n      let json = segmentStatedColors.toJSON();\n      // Convert colors from decimal integers to CSS \"#RRGGBB\" format.\n      Object.keys(json).map(k => json[k] = '#' + parseInt(json[k], 10).toString(16).padStart(6, '0'));\n      x[SEGMENT_STATED_COLORS_JSON_KEY] = json;\n    }\n    let {visibleSegments} = this.displayState;\n    if (visibleSegments.size > 0) {\n      x[SEGMENTS_JSON_KEY] = visibleSegments.toJSON();\n    }\n    let {highlightedSegments} = this.displayState;\n    if (highlightedSegments.size > 0) {\n      x[HIGHLIGHTS_JSON_KEY] = highlightedSegments.toJSON();\n    }\n    let {segmentEquivalences} = this.displayState;\n    if (segmentEquivalences.size > 0) {\n      x[EQUIVALENCES_JSON_KEY] = segmentEquivalences.toJSON();\n    }\n    x[SKELETON_RENDERING_JSON_KEY] = this.displayState.skeletonRenderingOptions.toJSON();\n    x[MESH_RENDER_SCALE_JSON_KEY] = this.displayState.renderScaleTarget.toJSON();\n    return x;\n  }\n\n  transformPickedValue(value: any) {\n    if (value == null) {\n      return value;\n    }\n    let {segmentEquivalences} = this.displayState;\n    if (segmentEquivalences.size === 0) {\n      return value;\n    }\n    if (typeof value === 'number') {\n      value = new Uint64(value, 0);\n    }\n    let mappedValue = segmentEquivalences.get(value);\n    if (Uint64.equal(mappedValue, value)) {\n      return value;\n    }\n    return new Uint64MapEntry(value, mappedValue);\n  }\n\n  handleAction(action: string) {\n    switch (action) {\n      case 'recolor': {\n        this.displayState.segmentColorHash.randomize();\n        break;\n      }\n      case 'clear-segments': {\n        this.displayState.visibleSegments.clear();\n        break;\n      }\n      case 'select': {\n        let {segmentSelectionState} = this.displayState;\n        if (segmentSelectionState.hasSelectedSegment) {\n          let segment = segmentSelectionState.selectedSegment;\n          let {visibleSegments} = this.displayState;\n          if (visibleSegments.has(segment)) {\n            visibleSegments.delete(segment);\n          } else {\n            visibleSegments.add(segment);\n          }\n        }\n        break;\n      }\n      case 'highlight': {\n        let {segmentSelectionState} = this.displayState;\n        if (segmentSelectionState.hasSelectedSegment) {\n          let segment = segmentSelectionState.selectedSegment;\n          let {highlightedSegments} = this.displayState;\n          if (highlightedSegments.has(segment)) {\n            highlightedSegments.delete(segment);\n          } else {\n            highlightedSegments.add(segment);\n          }\n        }\n        break;\n      }\n    }\n  }\n}\n\nfunction makeSkeletonShaderCodeWidget(layer: SegmentationUserLayer) {\n  return new ShaderCodeWidget({\n    fragmentMain: layer.displayState.skeletonRenderingOptions.shader,\n    shaderError: layer.displayState.shaderError,\n    fragmentMainStartLine: SKELETON_FRAGMENT_MAIN_START,\n  });\n}\n\nclass DisplayOptionsTab extends Tab {\n  visibleSegmentWidget = this.registerDisposer(new SegmentSetWidget(this.layer.displayState));\n  addSegmentWidget = this.registerDisposer(new Uint64EntryWidget());\n  selectedAlphaWidget =\n      this.registerDisposer(new RangeWidget(this.layer.displayState.selectedAlpha));\n  notSelectedAlphaWidget =\n      this.registerDisposer(new RangeWidget(this.layer.displayState.notSelectedAlpha));\n  saturationWidget = this.registerDisposer(new RangeWidget(this.layer.displayState.saturation));\n  objectAlphaWidget = this.registerDisposer(new RangeWidget(this.layer.displayState.objectAlpha));\n  codeWidget: ShaderCodeWidget|undefined;\n  constructor(public layer: SegmentationUserLayer) {\n    super();\n    const {element} = this;\n    element.classList.add('segmentation-dropdown');\n    let {selectedAlphaWidget, notSelectedAlphaWidget, saturationWidget, objectAlphaWidget} = this;\n    selectedAlphaWidget.promptElement.textContent = 'Opacity (on)';\n    notSelectedAlphaWidget.promptElement.textContent = 'Opacity (off)';\n    saturationWidget.promptElement.textContent = 'Saturation';\n    objectAlphaWidget.promptElement.textContent = 'Opacity (3d)';\n\n    if (this.layer.volumePath !== undefined) {\n      element.appendChild(this.selectedAlphaWidget.element);\n      element.appendChild(this.notSelectedAlphaWidget.element);\n      element.appendChild(this.saturationWidget.element);\n\n      {\n        const renderScaleWidget = this.registerDisposer(new RenderScaleWidget(\n            this.layer.sliceViewRenderScaleHistogram, this.layer.sliceViewRenderScaleTarget));\n        renderScaleWidget.label.textContent = 'Resolution (slice)';\n        element.appendChild(renderScaleWidget.element);\n      }\n    }\n    const has3dLayer = this.registerDisposer(new ComputedWatchableValue(\n        () => this.layer.meshPath || this.layer.meshLayer || this.layer.skeletonsPath ||\n                this.layer.skeletonLayer ?\n            true :\n            false,\n        this.layer.objectLayerStateChanged));\n    this.registerDisposer(\n        new ElementVisibilityFromTrackableBoolean(has3dLayer, this.objectAlphaWidget.element));\n\n    {\n      const renderScaleWidget = this.registerDisposer(new RenderScaleWidget(\n          this.layer.displayState.renderScaleHistogram, this.layer.displayState.renderScaleTarget));\n      renderScaleWidget.label.textContent = 'Resolution (mesh)';\n      element.appendChild(renderScaleWidget.element);\n      this.registerDisposer(\n          new ElementVisibilityFromTrackableBoolean(has3dLayer, renderScaleWidget.element));\n    }\n    element.appendChild(this.objectAlphaWidget.element);\n\n    {\n      const checkbox =\n          this.registerDisposer(new TrackableBooleanCheckbox(layer.displayState.hideSegmentZero));\n      checkbox.element.className =\n          'neuroglancer-segmentation-dropdown-hide-segment-zero neuroglancer-noselect';\n      const label = document.createElement('label');\n      label.className =\n          'neuroglancer-segmentation-dropdown-hide-segment-zero neuroglancer-noselect';\n      label.appendChild(document.createTextNode('Hide segment ID 0'));\n      label.appendChild(checkbox.element);\n      element.appendChild(label);\n    }\n\n    this.addSegmentWidget.element.classList.add('add-segment');\n    this.addSegmentWidget.element.title = 'Add one or more segment IDs';\n    element.appendChild(this.registerDisposer(this.addSegmentWidget).element);\n    this.registerDisposer(this.addSegmentWidget.valuesEntered.add((values: Uint64[]) => {\n      for (const value of values) {\n        this.layer.displayState.visibleSegments.add(value);\n      }\n    }));\n    element.appendChild(this.registerDisposer(this.visibleSegmentWidget).element);\n\n    const maybeAddSkeletonShaderUI = () => {\n      if (this.codeWidget !== undefined) {\n        return;\n      }\n      if (this.layer.skeletonsPath === null || this.layer.skeletonLayer === undefined) {\n        return;\n      }\n      const addViewSpecificSkeletonRenderingControls =\n          (options: ViewSpecificSkeletonRenderingOptions, viewName: string) => {\n            {\n              const widget = this.registerDisposer(new EnumSelectWidget(options.mode));\n              const label = document.createElement('label');\n              label.className =\n                  'neuroglancer-segmentation-dropdown-skeleton-render-mode neuroglancer-noselect';\n              label.appendChild(document.createTextNode(`Skeleton mode (${viewName})`));\n              label.appendChild(widget.element);\n              element.appendChild(label);\n            }\n            {\n              const widget = this.registerDisposer(\n                  new RangeWidget(options.lineWidth, {min: 1, max: 40, step: 1}));\n              widget.promptElement.textContent = `Skeleton line width (${viewName})`;\n              element.appendChild(widget.element);\n            }\n          };\n      addViewSpecificSkeletonRenderingControls(\n          layer.displayState.skeletonRenderingOptions.params2d, '2d');\n      addViewSpecificSkeletonRenderingControls(\n          layer.displayState.skeletonRenderingOptions.params3d, '3d');\n      let topRow = document.createElement('div');\n      topRow.className = 'neuroglancer-segmentation-dropdown-skeleton-shader-header';\n      let label = document.createElement('div');\n      label.style.flex = '1';\n      label.textContent = 'Skeleton shader:';\n      let helpLink = document.createElement('a');\n      let helpButton = document.createElement('button');\n      helpButton.type = 'button';\n      helpButton.textContent = '?';\n      helpButton.className = 'help-link';\n      helpLink.appendChild(helpButton);\n      helpLink.title = 'Documentation on skeleton rendering';\n      helpLink.target = '_blank';\n      helpLink.href =\n          'https://github.com/google/neuroglancer/blob/master/src/neuroglancer/sliceview/image_layer_rendering.md';\n\n      let maximizeButton = document.createElement('button');\n      maximizeButton.innerHTML = '&square;';\n      maximizeButton.className = 'maximize-button';\n      maximizeButton.title = 'Show larger editor view';\n      this.registerEventListener(maximizeButton, 'click', () => {\n        new ShaderCodeOverlay(this.layer);\n      });\n\n      topRow.appendChild(label);\n      topRow.appendChild(maximizeButton);\n      topRow.appendChild(helpLink);\n\n      element.appendChild(topRow);\n\n      const codeWidget = this.codeWidget =\n          this.registerDisposer(makeSkeletonShaderCodeWidget(this.layer));\n      element.appendChild(codeWidget.element);\n      codeWidget.textEditor.refresh();\n    };\n    this.registerDisposer(this.layer.objectLayerStateChanged.add(maybeAddSkeletonShaderUI));\n    maybeAddSkeletonShaderUI();\n\n    this.visibility.changed.add(() => {\n      if (this.visible) {\n        if (this.codeWidget !== undefined) {\n          this.codeWidget.textEditor.refresh();\n        }\n      }\n    });\n  }\n}\n\nclass ShaderCodeOverlay extends Overlay {\n  codeWidget = this.registerDisposer(makeSkeletonShaderCodeWidget(this.layer));\n  constructor(public layer: SegmentationUserLayer) {\n    super();\n    this.content.classList.add('neuroglancer-segmentation-layer-skeleton-shader-overlay');\n    this.content.appendChild(this.codeWidget.element);\n    this.codeWidget.textEditor.refresh();\n  }\n}\n\nregisterLayerType('segmentation', SegmentationUserLayer);\nregisterVolumeLayerType(VolumeType.SEGMENTATION, SegmentationUserLayer);\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {WatchableValueInterface} from 'neuroglancer/trackable_value';\nimport {DisjointUint64Sets} from 'neuroglancer/util/disjoint_sets';\nimport {parseArray} from 'neuroglancer/util/json';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {Uint64} from 'neuroglancer/util/uint64';\nimport {registerRPC, registerSharedObject, RPC, SharedObjectCounterpart} from 'neuroglancer/worker_rpc';\n\nconst RPC_TYPE_ID = 'DisjointUint64Sets';\nconst ADD_METHOD_ID = 'DisjointUint64Sets.add';\nconst CLEAR_METHOD_ID = 'DisjointUint64Sets.clear';\n\n@registerSharedObject(RPC_TYPE_ID)\nexport class SharedDisjointUint64Sets extends SharedObjectCounterpart implements\n    WatchableValueInterface<SharedDisjointUint64Sets> {\n  disjointSets = new DisjointUint64Sets();\n  changed = new NullarySignal();\n\n  /**\n   * For compatibility with `WatchableValueInterface`.\n   */\n  get value() {\n    return this;\n  }\n\n  static makeWithCounterpart(rpc: RPC) {\n    let obj = new this();\n    obj.initializeCounterpart(rpc);\n    return obj;\n  }\n\n  disposed() {\n    this.disjointSets = <any>undefined;\n    this.changed = <any>undefined;\n    super.disposed();\n  }\n\n  link(a: Uint64, b: Uint64) {\n    if (this.disjointSets.link(a, b)) {\n      let {rpc} = this;\n      if (rpc) {\n        rpc.invoke(\n            ADD_METHOD_ID,\n            {'id': this.rpcId, 'al': a.low, 'ah': a.high, 'bl': b.low, 'bh': b.high});\n      }\n      this.changed.dispatch();\n    }\n  }\n\n  get(x: Uint64): Uint64 {\n    return this.disjointSets.get(x);\n  }\n\n  clear() {\n    if (this.disjointSets.clear()) {\n      let {rpc} = this;\n      if (rpc) {\n        rpc.invoke(CLEAR_METHOD_ID, {'id': this.rpcId});\n      }\n      this.changed.dispatch();\n    }\n  }\n\n  setElements(a: Uint64) {\n    return this.disjointSets.setElements(a);\n  }\n\n  get size() {\n    return this.disjointSets.size;\n  }\n\n  toJSON() {\n    return this.disjointSets.toJSON();\n  }\n\n  /**\n   * Restores the state from a JSON representation.\n   */\n  restoreState(obj: any) {\n    this.clear();\n    if (obj !== undefined) {\n      let ids = [new Uint64(), new Uint64()];\n      parseArray(obj, z => {\n        parseArray(z, (s, index) => {\n          ids[index % 2].parseString(String(s), 10);\n          if (index !== 0) {\n            this.link(ids[0], ids[1]);\n          }\n        });\n      });\n    }\n  }\n}\n\nconst tempA = new Uint64();\nconst tempB = new Uint64();\n\nregisterRPC(ADD_METHOD_ID, function(x) {\n  let obj = <SharedDisjointUint64Sets>this.get(x['id']);\n  tempA.low = x['al'];\n  tempA.high = x['ah'];\n  tempB.low = x['bl'];\n  tempB.high = x['bh'];\n  if (obj.disjointSets.link(tempA, tempB)) {\n    obj.changed.dispatch();\n  }\n});\n\nregisterRPC(CLEAR_METHOD_ID, function(x) {\n  let obj = <SharedDisjointUint64Sets>this.get(x['id']);\n  if (obj.disjointSets.clear()) {\n    obj.changed.dispatch();\n  }\n});\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Facility for sharing arbitrary values that support structural cloning between threads.\n */\n\nimport {WatchableValue, WatchableValueInterface} from 'neuroglancer/trackable_value';\nimport {registerRPC, registerSharedObject, RPC, SharedObjectCounterpart} from 'neuroglancer/worker_rpc';\n\nconst CHANGED_RPC_METHOD_ID = 'SharedWatchableValue.changed';\n\n@registerSharedObject('SharedWatchableValue')\nexport class SharedWatchableValue<T> extends SharedObjectCounterpart implements\n    WatchableValueInterface<T> {\n  base: WatchableValueInterface<T>;\n\n  /**\n   * The value is being updated to reflect a remote change.\n   * @internal\n   */\n  updatingValue_ = false;\n\n  constructor(rpc?: RPC, options: any = {}) {\n    super(rpc, options);\n    if (rpc !== undefined) {\n      this.base = new WatchableValue<T>(options['value']);\n      this.setupChangedHandler();\n    }\n  }\n\n  initializeCounterpart(rpc: RPC, options: any = {}) {\n    options['value'] = this.value;\n    super.initializeCounterpart(rpc, options);\n  }\n\n  private setupChangedHandler() {\n    this.registerDisposer(this.base.changed.add(() => {\n      if (this.updatingValue_) {\n        this.updatingValue_ = false;\n      } else {\n        const {rpc} = this;\n        if (rpc !== null) {\n          rpc.invoke(CHANGED_RPC_METHOD_ID, {'id': this.rpcId, 'value': this.value});\n        }\n      }\n    }));\n  }\n\n  static makeFromExisting<T>(rpc: RPC, base: WatchableValueInterface<T>) {\n    let obj = new SharedWatchableValue<T>();\n    obj.base = base;\n    obj.setupChangedHandler();\n    obj.initializeCounterpart(rpc);\n    return obj;\n  }\n\n  static make<T>(rpc: RPC, value: T) {\n    return SharedWatchableValue.makeFromExisting(rpc, new WatchableValue<T>(value));\n  }\n\n  get value() {\n    return this.base.value;\n  }\n\n  set value(value: T) {\n    this.base.value = value;\n  }\n\n  get changed() {\n    return this.base.changed;\n  }\n}\n\nregisterRPC(CHANGED_RPC_METHOD_ID, function(x) {\n  const obj = <SharedWatchableValue<any>>this.get(x['id']);\n  obj.updatingValue_ = true;\n  obj.base.value = x['value'];\n  obj.updatingValue_ = false;\n});\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {DataType} from 'neuroglancer/util/data_type';\n\nexport const SINGLE_MESH_LAYER_RPC_ID = 'single_mesh/SingleMeshLayer';\nexport const GET_SINGLE_MESH_INFO_RPC_ID = 'single_mesh/getSingleMeshInfo';\n\nexport const SINGLE_MESH_CHUNK_KEY = '';\n\nexport interface VertexAttributeInfo {\n  name: string;\n  dataType: DataType;\n  numComponents: number;\n  source?: string;\n  min?: number;\n  max?: number;\n}\n\nexport interface SingleMeshInfo {\n  numVertices: number;\n  numTriangles: number;\n  // Perhaps bounding box?\n  // Perhaps transform data?\n  vertexAttributes: VertexAttributeInfo[];\n}\n\nexport interface SingleMeshData {\n  vertexPositions: Float32Array;\n  indices: Uint32Array;\n  vertexNormals?: Float32Array;\n  vertexAttributes: Float32Array[];\n}\n\nexport class SingleMeshSourceParameters {\n  meshSourceUrl: string;\n  attributeSourceUrls: string[];\n}\n\nexport class SingleMeshSourceParametersWithInfo extends SingleMeshSourceParameters {\n  info: SingleMeshInfo;\n\n  static RPC_ID = 'single_mesh/SingleMeshSource';\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {ChunkState} from 'neuroglancer/chunk_manager/base';\nimport {Chunk, ChunkManager, ChunkSource, WithParameters} from 'neuroglancer/chunk_manager/frontend';\nimport {CoordinateTransform} from 'neuroglancer/coordinate_transform';\nimport {PerspectiveViewRenderContext, PerspectiveViewRenderLayer} from 'neuroglancer/perspective_view/render_layer';\nimport {GET_SINGLE_MESH_INFO_RPC_ID, SINGLE_MESH_CHUNK_KEY, SINGLE_MESH_LAYER_RPC_ID, SingleMeshInfo, SingleMeshSourceParameters, SingleMeshSourceParametersWithInfo, VertexAttributeInfo} from 'neuroglancer/single_mesh/base';\nimport {TrackableValue} from 'neuroglancer/trackable_value';\nimport {DataType} from 'neuroglancer/util/data_type';\nimport {mat4, vec3} from 'neuroglancer/util/geom';\nimport {parseArray, stableStringify, verifyOptionalString, verifyString} from 'neuroglancer/util/json';\nimport {getObjectId} from 'neuroglancer/util/object_id';\nimport {Uint64} from 'neuroglancer/util/uint64';\nimport {withSharedVisibility} from 'neuroglancer/visibility_priority/frontend';\nimport {Buffer} from 'neuroglancer/webgl/buffer';\nimport {glsl_COLORMAPS} from 'neuroglancer/webgl/colormaps';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {makeWatchableShaderError} from 'neuroglancer/webgl/dynamic_shader';\nimport {CountingBuffer, countingBufferShaderModule, disableCountingBuffer, getCountingBuffer, IndexBufferAttributeHelper, makeIndexBuffer} from 'neuroglancer/webgl/index_emulation';\nimport {ShaderBuilder, ShaderModule, ShaderProgram, ShaderSamplerType} from 'neuroglancer/webgl/shader';\nimport {getShaderType} from 'neuroglancer/webgl/shader_lib';\nimport {compute1dTextureLayout, computeTextureFormat, getSamplerPrefixForDataType, OneDimensionalTextureAccessHelper, setOneDimensionalTextureData, TextureFormat} from 'neuroglancer/webgl/texture_access';\nimport {SharedObject} from 'neuroglancer/worker_rpc';\n\nexport const FRAGMENT_MAIN_START = '//NEUROGLANCER_SINGLE_MESH_LAYER_FRAGMENT_MAIN_START';\n\nconst DEFAULT_FRAGMENT_MAIN = `void main() {\n  emitGray();\n}\n`;\n\nexport type TrackableFragmentMain = TrackableValue<string>;\n\nexport function getTrackableFragmentMain(value = DEFAULT_FRAGMENT_MAIN) {\n  return new TrackableValue<string>(value, verifyString);\n}\n\nexport type TrackableAttributeNames = TrackableValue<Array<string|undefined>>;\n\nexport function getTrackableAttributeNames() {\n  return new TrackableValue<Array<string|undefined>>([], x => parseArray(x, verifyOptionalString));\n}\n\nexport class SingleMeshDisplayState {\n  shaderError = makeWatchableShaderError();\n  fragmentMain = getTrackableFragmentMain();\n  attributeNames = getTrackableAttributeNames();\n  objectToDataTransform = new CoordinateTransform();\n}\n\nexport function getShaderAttributeType(info: {dataType: DataType, numComponents: number}) {\n  return getShaderType(info.dataType, info.numComponents);\n}\n\nconst vertexAttributeSamplerSymbols: Symbol[] = [];\n\nconst vertexPositionTextureFormat = computeTextureFormat(new TextureFormat(), DataType.FLOAT32, 3);\nconst vertexNormalTextureFormat = vertexPositionTextureFormat;\n\nexport class SingleMeshShaderManager {\n  private tempLightVec = new Float32Array(4);\n\n  private textureAccessHelper = new OneDimensionalTextureAccessHelper('vertexData');\n  private indexBufferHelper = new IndexBufferAttributeHelper('vertexIndex');\n\n  constructor(\n      public attributeNames: (string|undefined)[], public attributeInfo: VertexAttributeInfo[],\n      public fragmentMain: string) {}\n\n  defineAttributeAccess(builder: ShaderBuilder, vertexIndexVariable: string) {\n    let {textureAccessHelper} = this;\n    textureAccessHelper.defineShader(builder);\n    let numAttributes = 2;\n    const {attributeNames} = this;\n    for (const attributeName of attributeNames) {\n      if (attributeName !== undefined) {\n        ++numAttributes;\n      }\n    }\n    for (let j = vertexAttributeSamplerSymbols.length; j < numAttributes; ++j) {\n      vertexAttributeSamplerSymbols[j] =\n          Symbol(`SingleMeshShaderManager.vertexAttributeTextureUnit${j}`);\n    }\n    numAttributes = 0;\n\n    builder.addTextureSampler(\n        `sampler2D`, 'uVertexAttributeSampler0', vertexAttributeSamplerSymbols[numAttributes++]);\n    builder.addTextureSampler(\n        `sampler2D`, 'uVertexAttributeSampler1', vertexAttributeSamplerSymbols[numAttributes++]);\n\n    builder.addVertexCode(textureAccessHelper.getAccessor(\n        'readVertexPosition', 'uVertexAttributeSampler0', DataType.FLOAT32, 3));\n    builder.addVertexCode(textureAccessHelper.getAccessor(\n        'readVertexNormal', 'uVertexAttributeSampler1', DataType.FLOAT32, 3));\n    let vertexMain = `\nvec3 vertexPosition = readVertexPosition(${vertexIndexVariable});\nvec3 vertexNormal = readVertexNormal(${vertexIndexVariable});\n`;\n    this.attributeInfo.forEach((info, i) => {\n      const attributeName = attributeNames[i];\n      if (attributeName !== undefined) {\n        builder.addTextureSampler(\n            `${getSamplerPrefixForDataType(info.dataType)}sampler2D` as ShaderSamplerType,\n            `uVertexAttributeSampler${numAttributes}`,\n            vertexAttributeSamplerSymbols[numAttributes]);\n\n        const attributeType = getShaderAttributeType(info);\n        builder.addVarying(`highp ${attributeType}`, `vCustom${i}`);\n        builder.addFragmentCode(`\n#define ${attributeNames[i]} vCustom${i}\n`);\n        builder.addVertexCode(textureAccessHelper.getAccessor(\n            `readAttribute${i}`, `uVertexAttributeSampler${numAttributes}`, info.dataType,\n            info.numComponents));\n        vertexMain += `vCustom${i} = readAttribute${i}(${vertexIndexVariable});\\n`;\n        ++numAttributes;\n      }\n    });\n    builder.addVertexMain(vertexMain);\n  }\n\n  defineShader(builder: ShaderBuilder) {\n    builder.require(countingBufferShaderModule);\n    this.indexBufferHelper.defineShader(builder);\n    builder.addVarying('highp float', 'vLightingFactor');\n    builder.addUniform('highp vec4', 'uLightDirection');\n    builder.addUniform('highp vec4', 'uColor');\n    builder.addUniform('highp mat4', 'uModelMatrix');\n    builder.addUniform('highp mat4', 'uProjection');\n    builder.addUniform('highp uint', 'uPickID');\n    builder.addVarying('highp uint', 'vPickID', 'flat');\n    builder.addVertexMain(`\nuint triangleIndex = getPrimitiveIndex() / 3u;\nvPickID = uPickID + triangleIndex;\n`);\n    builder.addFragmentCode(`\nvoid emitPremultipliedRGBA(vec4 color) {\n  emit(vec4(color.rgb * vLightingFactor, color.a), vPickID);\n}\nvoid emitRGBA(vec4 color) {\n  color = clamp(color, 0.0, 1.0);\n  color.xyz *= color.a;\n  emitPremultipliedRGBA(color);\n}\nvoid emitRGB(vec3 color) {\n  emitRGBA(vec4(color, 1.0));\n}\nvoid emitGray() {\n  emitRGB(vec3(1.0, 1.0, 1.0));\n}\n`);\n    builder.addFragmentCode(glsl_COLORMAPS);\n\n    // Make sure defineAttributeAccess is the last thing that adds fragment code prior to\n    // this.fragmentMain, so that the #define attributes don't mess anything up.\n    this.defineAttributeAccess(builder, 'vertexIndex');\n\n    builder.addVertexMain(`\ngl_Position = uProjection * (uModelMatrix * vec4(vertexPosition, 1.0));\nvec3 normal = normalize((uModelMatrix * vec4(vertexNormal, 0.0)).xyz);\nvLightingFactor = abs(dot(normal, uLightDirection.xyz)) + uLightDirection.w;\n`);\n    builder.setFragmentMainFunction(FRAGMENT_MAIN_START + '\\n' + this.fragmentMain);\n  }\n\n  beginLayer(gl: GL, shader: ShaderProgram, renderContext: PerspectiveViewRenderContext) {\n    let {dataToDevice, lightDirection, ambientLighting, directionalLighting} = renderContext;\n    gl.uniformMatrix4fv(shader.uniform('uProjection'), false, dataToDevice);\n    let lightVec = <vec3>this.tempLightVec;\n    vec3.scale(lightVec, lightDirection, directionalLighting);\n    lightVec[3] = ambientLighting;\n    gl.uniform4fv(shader.uniform('uLightDirection'), lightVec);\n  }\n\n  setPickID(gl: GL, shader: ShaderProgram, pickID: number) {\n    gl.uniform1ui(shader.uniform('uPickID'), pickID);\n  }\n\n  beginObject(gl: GL, shader: ShaderProgram, objectToDataMatrix: mat4) {\n    gl.uniformMatrix4fv(shader.uniform('uModelMatrix'), false, objectToDataMatrix);\n  }\n\n  getShader(gl: GL, emitter: ShaderModule) {\n    const key = {\n      attributeNames: this.attributeNames,\n      attributeInfo: this.attributeInfo,\n      fragmentMain: this.fragmentMain\n    };\n    return gl.memoize.get(\n        `single_mesh/SingleMeshShaderManager:${getObjectId(emitter)}:${stableStringify(key)}`,\n        () => {\n          let builder = new ShaderBuilder(gl);\n          builder.require(emitter);\n          this.defineShader(builder);\n          return builder.build();\n        });\n  }\n\n  bindVertexData(gl: GL, shader: ShaderProgram, data: VertexChunkData) {\n    this.textureAccessHelper.setupTextureLayout(gl, shader, data);\n    let index = 0;\n    const bindTexture = (texture: WebGLTexture|null) => {\n      const textureUnit = WebGL2RenderingContext.TEXTURE0 +\n          shader.textureUnit(vertexAttributeSamplerSymbols[index]);\n      gl.activeTexture(textureUnit);\n      gl.bindTexture(WebGL2RenderingContext.TEXTURE_2D, texture);\n      ++index;\n    };\n    bindTexture(data.vertexTexture);\n    bindTexture(data.normalTexture);\n    const {attributeNames} = this;\n    data.vertexAttributeTextures.forEach((texture, i) => {\n      if (attributeNames[i] !== undefined) {\n        bindTexture(texture);\n      }\n    });\n  }\n\n  disableVertexData(gl: GL, shader: ShaderProgram) {\n    let numTextures = 2;\n    let numVertexAttributes = this.attributeInfo.length;\n    let {attributeNames} = this;\n    for (let i = 0; i < numVertexAttributes; ++i) {\n      if (attributeNames[i] !== undefined) {\n        ++numTextures;\n      }\n    }\n    for (let i = 0; i < numTextures; ++i) {\n      let curTextureUnit =\n          shader.textureUnit(vertexAttributeSamplerSymbols[i]) + WebGL2RenderingContext.TEXTURE0;\n      gl.activeTexture(curTextureUnit);\n      gl.bindTexture(gl.TEXTURE_2D, null);\n    }\n  }\n\n  drawFragment(\n      gl: GL, shader: ShaderProgram, chunk: SingleMeshChunk, countingBuffer: CountingBuffer) {\n    countingBuffer.ensure(chunk.numIndices).bind(shader);\n    this.bindVertexData(gl, shader, chunk.vertexData);\n    this.indexBufferHelper.bind(chunk.indexBuffer, shader);\n    gl.drawArrays(WebGL2RenderingContext.TRIANGLES, 0, chunk.numIndices);\n  }\n\n  endLayer(gl: GL, shader: ShaderProgram) {\n    disableCountingBuffer(gl, shader);\n    this.indexBufferHelper.disable(shader);\n    this.disableVertexData(gl, shader);\n  }\n}\n\nexport class VertexChunkData {\n  vertexPositions: Float32Array;\n  vertexNormals: Float32Array;\n  vertexTexture: WebGLTexture|null;\n  normalTexture: WebGLTexture|null;\n  vertexAttributes: Float32Array[];\n  vertexAttributeTextures: (WebGLTexture|null)[];\n\n  // Emulation of buffer as texture.\n  textureXBits: number;\n  textureWidth: number;\n  textureHeight: number;\n\n  copyToGPU(gl: GL, attributeFormats: TextureFormat[]) {\n    let numVertices = this.vertexPositions.length / 3;\n    compute1dTextureLayout(this, gl, /*texelsPerElement=*/ 1, numVertices);\n    const getBufferTexture = (data: Float32Array, format: TextureFormat) => {\n      let texture = gl.createTexture();\n      gl.bindTexture(WebGL2RenderingContext.TEXTURE_2D, texture);\n      setOneDimensionalTextureData(gl, this, format, data);\n      return texture;\n    };\n    this.vertexTexture = getBufferTexture(this.vertexPositions, vertexPositionTextureFormat);\n    this.normalTexture = getBufferTexture(this.vertexNormals, vertexNormalTextureFormat);\n    this.vertexAttributeTextures =\n        this.vertexAttributes.map((data, i) => getBufferTexture(data, attributeFormats[i]));\n    gl.bindTexture(WebGL2RenderingContext.TEXTURE_2D, null);\n  }\n\n  freeGPUMemory(gl: GL) {\n    gl.deleteTexture(this.vertexTexture);\n    gl.deleteTexture(this.normalTexture);\n    let {vertexAttributeTextures} = this;\n    for (const buffer of vertexAttributeTextures) {\n      gl.deleteTexture(buffer);\n    }\n    vertexAttributeTextures.length = 0;\n  }\n}\n\nexport class SingleMeshChunk extends Chunk {\n  source: SingleMeshSource;\n  indexBuffer: Buffer;\n  numIndices: number;\n  indices: Uint32Array;\n  vertexData: VertexChunkData;\n\n  constructor(source: SingleMeshSource, x: any) {\n    super(source);\n\n    const vertexData = this.vertexData = new VertexChunkData();\n    vertexData.vertexPositions = x['vertexPositions'];\n    vertexData.vertexNormals = x['vertexNormals'];\n    vertexData.vertexAttributes = x['vertexAttributes'];\n    let indices = this.indices = x['indices'];\n    this.numIndices = indices.length;\n  }\n\n  copyToGPU(gl: GL) {\n    super.copyToGPU(gl);\n    this.vertexData.copyToGPU(gl, this.source.attributeTextureFormats);\n    this.indexBuffer = makeIndexBuffer(gl, this.indices);\n  }\n\n  freeGPUMemory(gl: GL) {\n    super.freeGPUMemory(gl);\n    this.vertexData.freeGPUMemory(gl);\n    this.indexBuffer.dispose();\n  }\n}\n\nexport function getAttributeTextureFormats(vertexAttributes: VertexAttributeInfo[]) {\n  return vertexAttributes.map(\n      x => computeTextureFormat(new TextureFormat(), x.dataType, x.numComponents));\n}\n\nexport class SingleMeshSource extends\n(WithParameters(ChunkSource, SingleMeshSourceParametersWithInfo)) {\n  attributeTextureFormats = getAttributeTextureFormats(this.info.vertexAttributes);\n\n  get info() {\n    return this.parameters.info;\n  }\n\n  getChunk(x: any) {\n    return new SingleMeshChunk(this, x);\n  }\n}\n\nconst SharedObjectWithSharedVisibility = withSharedVisibility(SharedObject);\nclass SingleMeshLayerSharedObject extends SharedObjectWithSharedVisibility {}\n\nexport class SingleMeshLayer extends PerspectiveViewRenderLayer {\n  protected shaderManager: SingleMeshShaderManager|undefined;\n  private shaders = new Map<ShaderModule, ShaderProgram|null>();\n  private sharedObject = this.registerDisposer(new SingleMeshLayerSharedObject());\n  private fallbackFragmentMain = DEFAULT_FRAGMENT_MAIN;\n  protected countingBuffer = this.registerDisposer(getCountingBuffer(this.gl));\n\n  constructor(public source: SingleMeshSource, public displayState: SingleMeshDisplayState) {\n    super();\n\n    this.displayState.shaderError.value = undefined;\n    const shaderChanged = () => {\n      this.shaderManager = undefined;\n      this.displayState.shaderError.value = undefined;\n      this.disposeShaders();\n      this.redrawNeeded.dispatch();\n    };\n    this.registerDisposer(displayState.fragmentMain.changed.add(shaderChanged));\n    this.registerDisposer(displayState.attributeNames.changed.add(shaderChanged));\n    this.registerDisposer(displayState.objectToDataTransform.changed.add(() => {\n      this.redrawNeeded.dispatch();\n    }));\n    this.displayState.shaderError.value = undefined;\n    const {sharedObject} = this;\n    sharedObject.visibility.add(this.visibility);\n    sharedObject.RPC_TYPE_ID = SINGLE_MESH_LAYER_RPC_ID;\n    sharedObject.initializeCounterpart(source.chunkManager.rpc!, {\n      'chunkManager': source.chunkManager.rpcId,\n      'source': source.addCounterpartRef(),\n    });\n    this.setReady(true);\n  }\n\n  private disposeShaders() {\n    let {shaders} = this;\n    for (let shader of shaders.values()) {\n      if (shader !== null) {\n        shader.dispose();\n      }\n    }\n    shaders.clear();\n  }\n\n  disposed() {\n    this.disposeShaders();\n    super.disposed();\n  }\n\n  protected makeShaderManager(fragmentMain = this.displayState.fragmentMain.value) {\n    return new SingleMeshShaderManager(\n        this.displayState.attributeNames.value, this.source.info.vertexAttributes, fragmentMain);\n  }\n\n  protected getShader(emitter: ShaderModule): ShaderProgram|null {\n    let {shaders} = this;\n    let shader = shaders.get(emitter);\n    if (shader === undefined) {\n      shader = null;\n      let {shaderManager} = this;\n      if (shaderManager === undefined) {\n        shaderManager = this.shaderManager = this.makeShaderManager();\n      }\n      const fragmentMain = this.displayState.fragmentMain.value;\n      try {\n        shader = shaderManager.getShader(this.gl, emitter);\n        this.fallbackFragmentMain = fragmentMain;\n        this.displayState.shaderError.value = null;\n      } catch (shaderError) {\n        this.displayState.shaderError.value = shaderError;\n        let {fallbackFragmentMain} = this;\n        if (fallbackFragmentMain !== fragmentMain) {\n          shaderManager = this.shaderManager = this.makeShaderManager(fallbackFragmentMain);\n          try {\n            shader = shaderManager.getShader(this.gl, emitter);\n          } catch (otherShaderError) {\n          }\n        }\n      }\n      shaders.set(emitter, shader);\n    }\n    return shader;\n  }\n\n  get isTransparent() {\n    return this.displayState.fragmentMain.value.match(/emitRGBA|emitPremultipliedRGBA/) !== null;\n  }\n\n  get gl() {\n    return this.source.gl;\n  }\n\n  draw(renderContext: PerspectiveViewRenderContext) {\n    if (!renderContext.emitColor && renderContext.alreadyEmittedPickID) {\n      // No need for a separate pick ID pass.\n      return;\n    }\n    let chunk = <SingleMeshChunk|undefined>this.source.chunks.get(SINGLE_MESH_CHUNK_KEY);\n    if (chunk === undefined || chunk.state !== ChunkState.GPU_MEMORY) {\n      return;\n    }\n    let shader = this.getShader(renderContext.emitter);\n    if (shader === null) {\n      return;\n    }\n\n    let {gl} = this;\n    let shaderManager = this.shaderManager!;\n    shader.bind();\n    shaderManager.beginLayer(gl, shader, renderContext);\n\n\n    let {pickIDs} = renderContext;\n\n    shaderManager.beginObject(gl, shader, this.displayState.objectToDataTransform.transform);\n    if (renderContext.emitPickID) {\n      shaderManager.setPickID(gl, shader, pickIDs.register(this, chunk.numIndices / 3));\n    }\n    shaderManager.drawFragment(gl, shader, chunk, this.countingBuffer);\n    shaderManager.endLayer(gl, shader);\n  }\n\n  drawPicking(renderContext: PerspectiveViewRenderContext) {\n    this.draw(renderContext);\n  }\n\n  transformPickedValue(_pickedValue: Uint64, pickedOffset: number) {\n    let chunk = <SingleMeshChunk|undefined>this.source.chunks.get(SINGLE_MESH_CHUNK_KEY);\n    if (chunk === undefined) {\n      return undefined;\n    }\n    let startIndex = pickedOffset * 3;\n    let {indices} = chunk;\n\n    if (startIndex >= indices.length) {\n      return undefined;\n    }\n\n    // FIXME: compute closest vertex position.  For now just use first vertex.\n    let vertexIndex = indices[startIndex];\n\n    let values: string[] = [];\n    let attributeNames = this.displayState.attributeNames.value;\n    chunk.vertexData.vertexAttributes.forEach((attributes, i) => {\n      const attributeName = attributeNames[i];\n      if (attributeName !== undefined) {\n        values.push(`${attributeName}=${attributes[vertexIndex].toPrecision(6)}`);\n      }\n    });\n\n    return values.join(', ');\n  }\n}\n\nfunction getSingleMeshInfo(chunkManager: ChunkManager, parameters: SingleMeshSourceParameters) {\n  return chunkManager.memoize.getUncounted(\n      {type: 'single_mesh:getMeshInfo', parameters},\n      () => chunkManager.rpc!.promiseInvoke<SingleMeshInfo>(\n          GET_SINGLE_MESH_INFO_RPC_ID,\n          {'chunkManager': chunkManager.addCounterpartRef(), 'parameters': parameters}));\n}\n\nexport function getSingleMeshSource(\n    chunkManager: ChunkManager, parameters: SingleMeshSourceParameters) {\n  return getSingleMeshInfo(chunkManager, parameters)\n      .then(\n          info =>\n              chunkManager.getChunkSource(SingleMeshSource, {parameters: {...parameters, info}}));\n}\n","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport debounce from 'lodash/debounce';\nimport {UserLayer} from 'neuroglancer/layer';\nimport {LayerListSpecification, registerLayerType} from 'neuroglancer/layer_specification';\nimport {Overlay} from 'neuroglancer/overlay';\nimport {SingleMeshSourceParameters} from 'neuroglancer/single_mesh/base';\nimport {VertexAttributeInfo} from 'neuroglancer/single_mesh/base';\nimport {FRAGMENT_MAIN_START, getShaderAttributeType, getSingleMeshSource, SingleMeshDisplayState, SingleMeshLayer, SingleMeshSource, TrackableAttributeNames} from 'neuroglancer/single_mesh/frontend';\nimport {UserLayerWithCoordinateTransformMixin} from 'neuroglancer/user_layer_with_coordinate_transform';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {removeFromParent} from 'neuroglancer/util/dom';\nimport {parseArray, verifyObjectProperty, verifyOptionalString, verifyString} from 'neuroglancer/util/json';\nimport {ShaderCodeWidget} from 'neuroglancer/widget/shader_code_widget';\nimport {Tab} from 'neuroglancer/widget/tab_view';\n\nimport './single_mesh_user_layer.css';\n\nfunction makeValidIdentifier(x: string) {\n  return x.split(/[^a-zA-Z0-9]+/).filter(y => y).join('_');\n}\n\nfunction pickAttributeNames(existingNames: string[]) {\n  const seenNames = new Set<string>();\n  let result: string[] = [];\n  for (let existingName of existingNames) {\n    let name = makeValidIdentifier(existingName);\n    let suffix = '';\n    let suffixNumber = 0;\n    while (seenNames.has(name + suffix)) {\n      suffix = '' + (++suffixNumber);\n    }\n    result.push(name + suffix);\n  }\n  return result;\n}\n\nconst BaseUserLayer = UserLayerWithCoordinateTransformMixin(UserLayer);\n\nexport class SingleMeshUserLayer extends BaseUserLayer {\n  parameters: SingleMeshSourceParameters;\n  meshSource: SingleMeshSource|undefined;\n  displayState = new SingleMeshDisplayState();\n  userSpecifiedAttributeNames: (string|undefined)[]|undefined;\n  defaultAttributeNames: string[]|undefined;\n  constructor(public manager: LayerListSpecification, x: any) {\n    super(manager, x);\n    this.displayState.objectToDataTransform = this.transform;\n    this.parameters = {\n      meshSourceUrl: verifyObjectProperty(x, 'source', verifyString),\n      attributeSourceUrls: verifyObjectProperty(\n          x, 'vertexAttributeSources',\n          y => {\n            if (y !== undefined) {\n              return parseArray(y, verifyString);\n            } else {\n              return [];\n            }\n          }),\n    };\n    this.displayState.fragmentMain.restoreState(x['shader']);\n    this.userSpecifiedAttributeNames = verifyObjectProperty(x, 'vertexAttributeNames', y => {\n      if (y === undefined) {\n        return undefined;\n      }\n      return parseArray(y, z => {\n        let result = verifyOptionalString(z);\n        if (result) {\n          return result;\n        }\n        return undefined;\n      });\n    });\n    getSingleMeshSource(manager.chunkManager, this.parameters).then(source => {\n      if (this.wasDisposed) {\n        return;\n      }\n      this.meshSource = source;\n      const defaultAttributeNames = this.defaultAttributeNames =\n          pickAttributeNames(source.info.vertexAttributes.map(a => a.name));\n      const {userSpecifiedAttributeNames} = this;\n      let initialAttributeNames: (string|undefined)[];\n      if (userSpecifiedAttributeNames !== undefined &&\n          userSpecifiedAttributeNames.length === defaultAttributeNames.length) {\n        initialAttributeNames = userSpecifiedAttributeNames;\n        this.userSpecifiedAttributeNames = undefined;\n      } else {\n        initialAttributeNames = Array.from(defaultAttributeNames);\n      }\n      this.displayState.attributeNames.value = initialAttributeNames;\n      this.addRenderLayer(new SingleMeshLayer(source, this.displayState));\n      this.isReady = true;\n    });\n    this.registerDisposer(this.displayState.fragmentMain.changed.add(() => {\n      this.specificationChanged.dispatch();\n    }));\n    this.registerDisposer(this.displayState.attributeNames.changed.add(() => {\n      this.specificationChanged.dispatch();\n    }));\n    this.tabs.add(\n        'rendering', {label: 'Rendering', order: -100, getter: () => new DisplayOptionsTab(this)});\n    this.tabs.default = 'rendering';\n  }\n  toJSON() {\n    let x = super.toJSON();\n    x['type'] = 'mesh';\n    let {parameters} = this;\n    let {attributeSourceUrls} = parameters;\n    x['source'] = this.parameters.meshSourceUrl;\n    if (attributeSourceUrls) {\n      x['vertexAttributeSources'] = attributeSourceUrls;\n    }\n    x['shader'] = this.displayState.fragmentMain.toJSON();\n    let persistentAttributeNames: (string|undefined)[]|undefined = undefined;\n    if (this.meshSource === undefined) {\n      persistentAttributeNames = this.userSpecifiedAttributeNames;\n    } else {\n      const defaultAttributeNames = this.defaultAttributeNames!;\n      const attributeNames = this.displayState.attributeNames.value;\n      // Check if equal.\n      let equal = true;\n      const numAttributes = attributeNames.length;\n      for (let i = 0; i < numAttributes; ++i) {\n        if (attributeNames[i] !== defaultAttributeNames[i]) {\n          equal = false;\n          break;\n        }\n      }\n      if (equal) {\n        persistentAttributeNames = undefined;\n      } else {\n        persistentAttributeNames = Array.from(attributeNames);\n      }\n    }\n    x['vertexAttributeNames'] = persistentAttributeNames;\n    return x;\n  }\n}\n\nfunction makeShaderCodeWidget(layer: SingleMeshUserLayer) {\n  return new ShaderCodeWidget({\n    fragmentMain: layer.displayState.fragmentMain,\n    shaderError: layer.displayState.shaderError,\n    fragmentMainStartLine: FRAGMENT_MAIN_START,\n  });\n}\n\n/**\n * Time in milliseconds during which the input field must not be modified before the shader is\n * recompiled.\n */\nconst SHADER_UPDATE_DELAY = 500;\n\nclass VertexAttributeWidget extends RefCounted {\n  element = document.createElement('div');\n\n  attributeNameElements: HTMLInputElement[]|undefined;\n\n  private debouncedValueUpdater = debounce(() => {\n    this.updateAttributeNames();\n  }, SHADER_UPDATE_DELAY);\n\n  constructor(\n      public attributeNames: TrackableAttributeNames,\n      public getAttributeInfo: () => VertexAttributeInfo[] | undefined) {\n    super();\n    this.element.className = 'neuroglancer-single-mesh-attribute-widget';\n\n    this.updateInputElements();\n    this.registerDisposer(attributeNames.changed.add(() => {\n      this.updateInputElements();\n    }));\n  }\n\n  private updateInputElements() {\n    const attributeNames = this.attributeNames;\n    let {attributeNameElements} = this;\n    if (attributeNameElements === undefined) {\n      let attributeInfo = this.getAttributeInfo();\n      if (attributeInfo === undefined) {\n        return;\n      }\n      attributeNameElements = this.attributeNameElements = new Array<HTMLInputElement>();\n      let previousSource: string|undefined = undefined;\n      let numAttributes = attributeNames.value.length;\n      let {element} = this;\n      for (let i = 0; i < numAttributes; ++i) {\n        let info = attributeInfo[i];\n        let {source} = info;\n        if (source !== previousSource && source !== undefined) {\n          previousSource = source;\n          let div = document.createElement('div');\n          div.className = 'neuroglancer-single-mesh-source-header';\n          div.textContent = source;\n          element.appendChild(div);\n        }\n        let div = document.createElement('div');\n        div.className = 'neuroglancer-single-mesh-attribute';\n        let input = document.createElement('input');\n        input.title = info.name;\n        this.registerEventListener(input, 'input', this.debouncedValueUpdater);\n        input.type = 'text';\n        div.textContent = getShaderAttributeType(info);\n        div.appendChild(input);\n        if (info.min !== undefined && info.max !== undefined) {\n          let minMaxText = document.createElement('span');\n          minMaxText.className = 'neuroglancer-single-mesh-attribute-range';\n          minMaxText.textContent = `[${info.min.toPrecision(6)}, ${info.max.toPrecision(6)}]`;\n          div.appendChild(minMaxText);\n        }\n        attributeNameElements[i] = input;\n        element.appendChild(div);\n      }\n    }\n    const attributeNamesValue = attributeNames.value;\n    attributeNamesValue.forEach((name, i) => {\n      attributeNameElements![i].value = name || '';\n    });\n  }\n\n  disposed() {\n    removeFromParent(this.element);\n  }\n\n  private updateAttributeNames() {\n    const attributeNames = this.attributeNames.value;\n    const attributeNameElements = this.attributeNameElements!;\n    let changed = false;\n    attributeNames.forEach((name, i) => {\n      let newName: string|undefined = attributeNameElements[i].value;\n      if (!newName) {\n        newName = undefined;\n      }\n      if (newName !== name) {\n        changed = true;\n        attributeNames[i] = newName;\n      }\n    });\n    if (changed) {\n      this.attributeNames.changed.dispatch();\n    }\n  }\n}\n\nfunction makeVertexAttributeWidget(layer: SingleMeshUserLayer) {\n  return new VertexAttributeWidget(\n      layer.displayState.attributeNames,\n      () => layer.meshSource && layer.meshSource.info.vertexAttributes);\n}\n\nclass DisplayOptionsTab extends Tab {\n  attributeWidget = this.registerDisposer(makeVertexAttributeWidget(this.layer));\n  codeWidget = this.registerDisposer(makeShaderCodeWidget(this.layer));\n  constructor(public layer: SingleMeshUserLayer) {\n    super();\n    const {element} = this;\n    element.classList.add('neuroglancer-single-mesh-dropdown');\n    let topRow = document.createElement('div');\n    topRow.className = 'neuroglancer-single-mesh-dropdown-top-row';\n    let spacer = document.createElement('div');\n    spacer.style.flex = '1';\n    let helpLink = document.createElement('a');\n    let helpButton = document.createElement('button');\n    helpButton.type = 'button';\n    helpButton.textContent = '?';\n    helpButton.className = 'help-link';\n    helpLink.appendChild(helpButton);\n    helpLink.title = 'Documentation on single mesh layer rendering';\n    helpLink.target = '_blank';\n    helpLink.href =\n        'https://github.com/google/neuroglancer/blob/master/src/neuroglancer/sliceview/image_layer_rendering.md';\n\n    let maximizeButton = document.createElement('button');\n    maximizeButton.innerHTML = '&square;';\n    maximizeButton.className = 'maximize-button';\n    maximizeButton.title = 'Show larger editor view';\n    this.registerEventListener(maximizeButton, 'click', () => {\n      new ShaderCodeOverlay(this.layer);\n    });\n\n    topRow.appendChild(spacer);\n    topRow.appendChild(maximizeButton);\n    topRow.appendChild(helpLink);\n\n    element.appendChild(topRow);\n    element.appendChild(this.attributeWidget.element);\n    element.appendChild(this.codeWidget.element);\n    this.codeWidget.textEditor.refresh();\n\n    this.visibility.changed.add(() => {\n      if (this.visible) {\n        this.codeWidget.textEditor.refresh();\n      }\n    });\n  }\n}\n\nclass ShaderCodeOverlay extends Overlay {\n  attributeWidget = this.registerDisposer(makeVertexAttributeWidget(this.layer));\n  codeWidget = this.registerDisposer(makeShaderCodeWidget(this.layer));\n  constructor(public layer: SingleMeshUserLayer) {\n    super();\n    this.content.classList.add('neuroglancer-single-mesh-layer-shader-overlay');\n    this.content.appendChild(this.attributeWidget.element);\n    this.content.appendChild(this.codeWidget.element);\n    this.codeWidget.textEditor.refresh();\n  }\n}\n\nregisterLayerType('mesh', SingleMeshUserLayer);\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {DataType} from 'neuroglancer/util/data_type';\n\nexport const SKELETON_LAYER_RPC_ID = 'skeleton/SkeletonLayer';\n\nexport interface VertexAttributeInfo {\n  dataType: DataType;\n  numComponents: number;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {ChunkState} from 'neuroglancer/chunk_manager/base';\nimport {Chunk, ChunkManager, ChunkSource} from 'neuroglancer/chunk_manager/frontend';\nimport {RenderLayer} from 'neuroglancer/layer';\nimport {VoxelSize} from 'neuroglancer/navigation_state';\nimport {PerspectiveViewRenderContext, PerspectiveViewRenderLayer} from 'neuroglancer/perspective_view/render_layer';\nimport {forEachVisibleSegment, getObjectKey} from 'neuroglancer/segmentation_display_state/base';\nimport {getObjectColor, registerRedrawWhenSegmentationDisplayState3DChanged, SegmentationDisplayState3D, SegmentationLayerSharedObject} from 'neuroglancer/segmentation_display_state/frontend';\nimport {SKELETON_LAYER_RPC_ID, VertexAttributeInfo} from 'neuroglancer/skeleton/base';\nimport {SliceViewPanelRenderContext, SliceViewPanelRenderLayer} from 'neuroglancer/sliceview/panel';\nimport {TrackableValue, WatchableValue} from 'neuroglancer/trackable_value';\nimport {DataType} from 'neuroglancer/util/data_type';\nimport {Borrowed, RefCounted} from 'neuroglancer/util/disposable';\nimport {mat4, vec3} from 'neuroglancer/util/geom';\nimport {verifyFinitePositiveFloat, verifyString} from 'neuroglancer/util/json';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {CompoundTrackable, Trackable} from 'neuroglancer/util/trackable';\nimport {TrackableEnum} from 'neuroglancer/util/trackable_enum';\nimport {Buffer} from 'neuroglancer/webgl/buffer';\nimport {CircleShader} from 'neuroglancer/webgl/circles';\nimport {GL} from 'neuroglancer/webgl/context';\n\nimport {parameterizedEmitterDependentShaderGetter, WatchableShaderError} from 'neuroglancer/webgl/dynamic_shader';\nimport {LineShader} from 'neuroglancer/webgl/lines';\nimport {ShaderBuilder, ShaderProgram, ShaderSamplerType} from 'neuroglancer/webgl/shader';\nimport {compute1dTextureLayout, computeTextureFormat, getSamplerPrefixForDataType, OneDimensionalTextureAccessHelper, setOneDimensionalTextureData, TextureFormat} from 'neuroglancer/webgl/texture_access';\nimport {glsl_COLORMAPS} from 'neuroglancer/webgl/colormaps';\n\nconst tempMat2 = mat4.create();\n\nconst DEFAULT_FRAGMENT_MAIN = `void main() {\n  emitDefault();\n}\n`;\n\nexport const FRAGMENT_MAIN_START = '//NEUROGLANCER_SKELETON_LAYER_FRAGMENT_MAIN_START';\n\nexport type TrackableFragmentMain = TrackableValue<string>;\n\nexport function getTrackableFragmentMain(value = DEFAULT_FRAGMENT_MAIN) {\n  return new TrackableValue<string>(value, verifyString);\n}\n\ninterface VertexAttributeRenderInfo extends VertexAttributeInfo {\n  name: string;\n  webglDataType: number;\n  glslDataType: string;\n}\n\nconst vertexAttributeSamplerSymbols: Symbol[] = [];\n\nconst vertexPositionTextureFormat = computeTextureFormat(new TextureFormat(), DataType.FLOAT32, 3);\n\nclass RenderHelper extends RefCounted {\n  private textureAccessHelper = new OneDimensionalTextureAccessHelper('vertexData');\n  private lineShader = this.registerDisposer(new LineShader(this.gl, 1));\n  private circleShader = this.registerDisposer(new CircleShader(this.gl, 2));\n\n  get vertexAttributes(): VertexAttributeRenderInfo[] {\n    return this.base.vertexAttributes;\n  }\n\n  defineCommonShader(builder: ShaderBuilder) {\n    builder.addUniform('highp vec4', 'uColor');\n    builder.addUniform('highp mat4', 'uProjection');\n    builder.addUniform('highp uint', 'uPickID');\n  }\n\n  edgeShaderGetter = parameterizedEmitterDependentShaderGetter(\n      this, this.gl,\n      {type: 'skeleton/SkeletonShaderManager/edge', vertexAttributes: this.vertexAttributes},\n      this.base.fallbackFragmentMain, this.base.displayState.skeletonRenderingOptions.shader,\n      this.base.displayState.shaderError, (builder: ShaderBuilder, fragmentMain: string) => {\n        this.defineAttributeAccess(builder);\n        this.lineShader.defineShader(builder);\n        builder.addAttribute('highp uvec2', 'aVertexIndex');\n        this.defineCommonShader(builder);\n        let vertexMain = `\nhighp vec3 vertexA = readAttribute0(aVertexIndex.x);\nhighp vec3 vertexB = readAttribute0(aVertexIndex.y);\nemitLine(uProjection, vertexA, vertexB);\nhighp uint lineEndpointIndex = getLineEndpointIndex();\nhighp uint vertexIndex = aVertexIndex.x * lineEndpointIndex + aVertexIndex.y * (1u - lineEndpointIndex);\n`;\n\n        builder.addFragmentCode(`\nvec4 segmentColor() {\n  return uColor;\n}\nvoid emitRGB(vec3 color) {\n  emit(vec4(color * uColor.a, uColor.a * getLineAlpha() * ${this.getCrossSectionFadeFactor()}), uPickID);\n}\nvoid emitDefault() {\n  //emit(vec4(uColor.rgb, uColor.a * ${this.getCrossSectionFadeFactor()}), uPickID);\n  emit(vec4(uColor.rgb, uColor.a * getLineAlpha() * ${this.getCrossSectionFadeFactor()}), uPickID);\n}\n`);\n        builder.addFragmentCode(glsl_COLORMAPS);\n        const {vertexAttributes} = this;\n        const numAttributes = vertexAttributes.length;\n        for (let i = 1; i < numAttributes; ++i) {\n          const info = vertexAttributes[i];\n          builder.addVarying(`highp ${info.glslDataType}`, `vCustom${i}`);\n          vertexMain += `vCustom${i} = readAttribute${i}(vertexIndex);\\n`;\n          builder.addFragmentCode(`#define ${info.name} vCustom${i}\\n`);\n        }\n        builder.setVertexMain(vertexMain);\n        builder.setFragmentMainFunction(FRAGMENT_MAIN_START + '\\n' + fragmentMain);\n      });\n\n  nodeShaderGetter = parameterizedEmitterDependentShaderGetter(\n      this, this.gl,\n      {type: 'skeleton/SkeletonShaderManager/node', vertexAttributes: this.vertexAttributes},\n      this.base.fallbackFragmentMain, this.base.displayState.skeletonRenderingOptions.shader,\n      this.base.displayState.shaderError, (builder: ShaderBuilder, fragmentMain: string) => {\n        this.defineAttributeAccess(builder);\n        this.circleShader.defineShader(builder, /*crossSectionFade=*/ this.targetIsSliceView);\n        this.defineCommonShader(builder);\n        let vertexMain = `\nhighp uint vertexIndex = uint(gl_InstanceID);\nhighp vec3 vertexPosition = readAttribute0(vertexIndex);\nemitCircle(uProjection * vec4(vertexPosition, 1.0));\n`;\n\n        builder.addFragmentCode(`\nvec4 segmentColor() {\n  return uColor;\n}\nvoid emitRGBA(vec4 color) {\n  vec4 borderColor = color;\n  emit(getCircleColor(color, borderColor), uPickID);\n}\nvoid emitRGB(vec3 color) {\n  emitRGBA(vec4(color, 1.0));\n}\nvoid emitDefault() {\n  emitRGBA(uColor);\n}\n`);\n        builder.addFragmentCode(glsl_COLORMAPS);\n        const {vertexAttributes} = this;\n        const numAttributes = vertexAttributes.length;\n        for (let i = 1; i < numAttributes; ++i) {\n          const info = vertexAttributes[i];\n          builder.addVarying(`highp ${info.glslDataType}`, `vCustom${i}`);\n          vertexMain += `vCustom${i} = readAttribute${i}(vertexIndex);\\n`;\n          builder.addFragmentCode(`#define ${info.name} vCustom${i}\\n`);\n        }\n        builder.setVertexMain(vertexMain);\n        builder.setFragmentMainFunction(FRAGMENT_MAIN_START + '\\n' + fragmentMain);\n      });\n\n  get gl(): GL {\n    return this.base.gl;\n  }\n\n  constructor(public base: SkeletonLayer, public targetIsSliceView: boolean) {\n    super();\n  }\n\n  defineAttributeAccess(builder: ShaderBuilder) {\n    const {textureAccessHelper} = this;\n    textureAccessHelper.defineShader(builder);\n    const numAttributes = this.vertexAttributes.length;\n    for (let j = vertexAttributeSamplerSymbols.length; j < numAttributes; ++j) {\n      vertexAttributeSamplerSymbols[j] = Symbol(`SkeletonShader.vertexAttributeTextureUnit${j}`);\n    }\n    this.vertexAttributes.forEach((info, i) => {\n      builder.addTextureSampler(\n          `${getSamplerPrefixForDataType(info.dataType)}sampler2D` as ShaderSamplerType,\n          `uVertexAttributeSampler${i}`, vertexAttributeSamplerSymbols[i]);\n      builder.addVertexCode(textureAccessHelper.getAccessor(\n          `readAttribute${i}`, `uVertexAttributeSampler${i}`, info.dataType, info.numComponents));\n    });\n  }\n\n  getCrossSectionFadeFactor() {\n    if (this.targetIsSliceView) {\n      return `(clamp(1.0 - 2.0 * abs(0.5 - gl_FragCoord.z), 0.0, 1.0))`;\n    } else {\n      return `(1.0)`;\n    }\n  }\n\n  beginLayer(\n      gl: GL, shader: ShaderProgram,\n      renderContext: SliceViewPanelRenderContext|PerspectiveViewRenderContext,\n      objectToDataMatrix: mat4) {\n    let {dataToDevice} = renderContext;\n    let mat = mat4.multiply(tempMat2, dataToDevice, objectToDataMatrix);\n    gl.uniformMatrix4fv(shader.uniform('uProjection'), false, mat);\n  }\n\n  setColor(gl: GL, shader: ShaderProgram, color: vec3) {\n    gl.uniform4fv(shader.uniform('uColor'), color);\n  }\n\n  setPickID(gl: GL, shader: ShaderProgram, pickID: number) {\n    gl.uniform1ui(shader.uniform('uPickID'), pickID);\n  }\n\n  drawSkeleton(\n      gl: GL, edgeShader: ShaderProgram, nodeShader: ShaderProgram|null,\n      skeletonChunk: SkeletonChunk, renderContext: {viewportWidth: number, viewportHeight: number},\n    lineWidth: number,\n    pointDiameter: number) {\n    const {vertexAttributes} = this;\n    const numAttributes = vertexAttributes.length;\n    const {vertexAttributeTextures} = skeletonChunk;\n    for (let i = 0; i < numAttributes; ++i) {\n      const textureUnit = WebGL2RenderingContext.TEXTURE0 +\n          edgeShader.textureUnit(vertexAttributeSamplerSymbols[i]);\n      gl.activeTexture(textureUnit);\n      gl.bindTexture(WebGL2RenderingContext.TEXTURE_2D, vertexAttributeTextures[i]);\n    }\n\n    // Draw edges\n    {\n      edgeShader.bind();\n      this.textureAccessHelper.setupTextureLayout(gl, edgeShader, skeletonChunk);\n      const aVertexIndex = edgeShader.attribute('aVertexIndex');\n      skeletonChunk.indexBuffer.bindToVertexAttribI(\n          aVertexIndex, 2, WebGL2RenderingContext.UNSIGNED_INT);\n      gl.vertexAttribDivisor(aVertexIndex, 1);\n      this.lineShader.draw(\n          edgeShader, renderContext, lineWidth, this.targetIsSliceView ? 1.0 : 0.0,\n          skeletonChunk.numIndices / 2);\n      gl.vertexAttribDivisor(aVertexIndex, 0);\n      gl.disableVertexAttribArray(aVertexIndex);\n    }\n\n    if (nodeShader !== null) {\n      nodeShader.bind();\n      this.textureAccessHelper.setupTextureLayout(gl, nodeShader, skeletonChunk);\n      this.circleShader.draw(\n          nodeShader, renderContext, {\n            interiorRadiusInPixels: pointDiameter / 2,\n            borderWidthInPixels: 0,\n            featherWidthInPixels: this.targetIsSliceView ? 1.0 : 0.0,\n          },\n          skeletonChunk.numVertices);\n    }\n  }\n\n  endLayer(gl: GL, shader: ShaderProgram) {\n    const {vertexAttributes} = this;\n    const numAttributes = vertexAttributes.length;\n    for (let i = 0; i < numAttributes; ++i) {\n      let curTextureUnit =\n          shader.textureUnit(vertexAttributeSamplerSymbols[i]) + WebGL2RenderingContext.TEXTURE0;\n      gl.activeTexture(curTextureUnit);\n      gl.bindTexture(gl.TEXTURE_2D, null);\n    }\n  }\n}\n\nexport enum SkeletonRenderMode {\n  LINES,\n  LINES_AND_POINTS,\n}\n\nexport class TrackableSkeletonRenderMode extends TrackableEnum<SkeletonRenderMode> {\n  constructor(value: SkeletonRenderMode, defaultValue: SkeletonRenderMode = value) {\n    super(SkeletonRenderMode, value, defaultValue);\n  }\n}\n\nexport class TrackableSkeletonLineWidth extends TrackableValue<number> {\n  constructor(value: number, defaultValue: number = value) {\n    super(value, verifyFinitePositiveFloat, defaultValue);\n  }\n}\n\nexport interface ViewSpecificSkeletonRenderingOptions {\n  mode: TrackableSkeletonRenderMode;\n  lineWidth: TrackableSkeletonLineWidth;\n}\n\nexport class SkeletonRenderingOptions implements Trackable {\n  private compound = new CompoundTrackable();\n  get changed() {\n    return this.compound.changed;\n  }\n\n  shader = getTrackableFragmentMain();\n  params2d: ViewSpecificSkeletonRenderingOptions = {\n    mode: new TrackableSkeletonRenderMode(SkeletonRenderMode.LINES_AND_POINTS),\n    lineWidth: new TrackableSkeletonLineWidth(5),\n  };\n  params3d: ViewSpecificSkeletonRenderingOptions = {\n    mode: new TrackableSkeletonRenderMode(SkeletonRenderMode.LINES),\n    lineWidth: new TrackableSkeletonLineWidth(2),\n  };\n\n  constructor() {\n    const {compound} = this;\n    compound.add('shader', this.shader);\n    compound.add('mode2d', this.params2d.mode);\n    compound.add('lineWidth2d', this.params2d.lineWidth);\n    compound.add('mode3d', this.params3d.mode);\n    compound.add('lineWidth3d', this.params3d.lineWidth);\n  }\n\n  reset() {\n    this.compound.reset();\n  }\n\n  restoreState(obj: any) {\n    if (obj === undefined) return;\n    this.compound.restoreState(obj);\n  }\n\n  toJSON(): any {\n    const obj = this.compound.toJSON();\n    for (const _ in obj) return obj;\n    return undefined;\n  }\n}\n\nexport interface SkeletonLayerDisplayState extends SegmentationDisplayState3D {\n  shaderError: WatchableShaderError;\n  skeletonRenderingOptions: SkeletonRenderingOptions;\n}\n\nexport class SkeletonLayer extends RefCounted {\n  private tempMat = mat4.create();\n  redrawNeeded = new NullarySignal();\n  private sharedObject: SegmentationLayerSharedObject;\n  vertexAttributes: VertexAttributeRenderInfo[];\n  fallbackFragmentMain = new WatchableValue<string>(DEFAULT_FRAGMENT_MAIN);\n\n  get visibility() {\n    return this.sharedObject.visibility;\n  }\n\n  constructor(\n      public chunkManager: ChunkManager, public source: SkeletonSource,\n      public voxelSizeObject: VoxelSize, public displayState: SkeletonLayerDisplayState) {\n    super();\n\n    registerRedrawWhenSegmentationDisplayState3DChanged(displayState, this);\n    this.displayState.shaderError.value = undefined;\n    const {skeletonRenderingOptions: renderingOptions} = displayState;\n    this.registerDisposer(renderingOptions.shader.changed.add(() => {\n      this.displayState.shaderError.value = undefined;\n      this.redrawNeeded.dispatch();\n    }));\n    let sharedObject = this.sharedObject =\n        this.registerDisposer(new SegmentationLayerSharedObject(chunkManager, displayState));\n    sharedObject.RPC_TYPE_ID = SKELETON_LAYER_RPC_ID;\n    sharedObject.initializeCounterpartWithChunkManager({\n      'source': source.addCounterpartRef(),\n    });\n\n    const vertexAttributes = this.vertexAttributes = [vertexPositionAttribute];\n\n    for (let [name, info] of source.vertexAttributes) {\n      vertexAttributes.push({\n        name,\n        dataType: info.dataType,\n        numComponents: info.numComponents,\n        webglDataType: getWebglDataType(info.dataType),\n        glslDataType: info.numComponents > 1 ? `vec${info.numComponents}` : 'float',\n      });\n    }\n  }\n\n  get gl() {\n    return this.chunkManager.chunkQueueManager.gl;\n  }\n\n  draw(\n      renderContext: SliceViewPanelRenderContext|PerspectiveViewRenderContext, layer: RenderLayer,\n    renderHelper: RenderHelper, renderOptions: ViewSpecificSkeletonRenderingOptions) {\n    let lineWidth = renderOptions.lineWidth.value;\n    let {gl, source, displayState} = this;\n    let alpha = Math.min(1.0, displayState.objectAlpha.value);\n    if (alpha <= 0.0) {\n      // Skip drawing.\n      return;\n    }\n    let pointDiameter: number;\n    if (renderOptions.mode.value === SkeletonRenderMode.LINES_AND_POINTS) {\n      pointDiameter = Math.max(10, lineWidth * 2);\n    } else {\n      pointDiameter = lineWidth;\n    }\n\n    const edgeShader = renderHelper.edgeShaderGetter(renderContext.emitter);\n    const nodeShader = renderHelper.nodeShaderGetter(renderContext.emitter);\n    if (edgeShader === null || nodeShader === null) {\n      // Shader error, skip drawing.\n      return;\n    }\n\n    let objectToDataMatrix = this.tempMat;\n    mat4.identity(objectToDataMatrix);\n    if (source.skeletonVertexCoordinatesInVoxels) {\n      mat4.scale(objectToDataMatrix, objectToDataMatrix, this.voxelSizeObject.size);\n    }\n    mat4.multiply(objectToDataMatrix, objectToDataMatrix, source.transform);\n    mat4.multiply(\n        objectToDataMatrix, this.displayState.objectToDataTransform.transform, objectToDataMatrix);\n\n    edgeShader.bind();\n    renderHelper.beginLayer(gl, edgeShader, renderContext, objectToDataMatrix);\n\n    nodeShader.bind();\n    renderHelper.beginLayer(gl, nodeShader, renderContext, objectToDataMatrix);\n\n    const skeletons = source.chunks;\n    const {pickIDs} = renderContext;\n\n    forEachVisibleSegment(displayState, (objectId, rootObjectId) => {\n      const key = getObjectKey(objectId);\n      const skeleton = skeletons.get(key);\n      if (skeleton === undefined || skeleton.state !== ChunkState.GPU_MEMORY) {\n        return;\n      }\n      if (renderContext.emitColor) {\n        edgeShader.bind();\n        renderHelper.setColor(\n            gl, edgeShader, <vec3><Float32Array>getObjectColor(displayState, rootObjectId, alpha));\n        nodeShader.bind();\n        renderHelper.setColor(\n            gl, nodeShader, <vec3><Float32Array>getObjectColor(displayState, rootObjectId, alpha));\n      }\n      if (renderContext.emitPickID) {\n        edgeShader.bind();\n        renderHelper.setPickID(gl, edgeShader, pickIDs.registerUint64(layer, objectId));\n        nodeShader.bind();\n        renderHelper.setPickID(gl, nodeShader, pickIDs.registerUint64(layer, objectId));\n      }\n      renderHelper.drawSkeleton(\n          gl, edgeShader, nodeShader, skeleton, renderContext, lineWidth!, pointDiameter);\n    });\n    renderHelper.endLayer(gl, edgeShader);\n  }\n}\n\nexport class PerspectiveViewSkeletonLayer extends PerspectiveViewRenderLayer {\n  private renderHelper = this.registerDisposer(new RenderHelper(this.base, false));\n  private renderOptions = this.base.displayState.skeletonRenderingOptions.params3d;\n\n  constructor(public base: SkeletonLayer) {\n    super();\n    this.registerDisposer(base);\n    this.registerDisposer(base.redrawNeeded.add(this.redrawNeeded.dispatch));\n    const {renderOptions} = this;\n    this.registerDisposer(renderOptions.mode.changed.add(this.redrawNeeded.dispatch));\n    this.registerDisposer(renderOptions.lineWidth.changed.add(this.redrawNeeded.dispatch));\n    this.setReady(true);\n    this.registerDisposer(base.visibility.add(this.visibility));\n  }\n  get gl() {\n    return this.base.gl;\n  }\n\n  get isTransparent() {\n    return this.base.displayState.objectAlpha.value < 1.0;\n  }\n\n  draw(renderContext: PerspectiveViewRenderContext) {\n    if (!renderContext.emitColor && renderContext.alreadyEmittedPickID) {\n      // No need for a separate pick ID pass.\n      return;\n    }\n    this.base.draw(renderContext, this, this.renderHelper, this.renderOptions);\n  }\n}\n\nexport class SliceViewPanelSkeletonLayer extends SliceViewPanelRenderLayer {\n  private renderHelper = this.registerDisposer(new RenderHelper(this.base, true));\n  private renderOptions = this.base.displayState.skeletonRenderingOptions.params2d;\n  constructor(public base: SkeletonLayer) {\n    super();\n    this.registerDisposer(base);\n    const {renderOptions} = this;\n    this.registerDisposer(renderOptions.mode.changed.add(this.redrawNeeded.dispatch));\n    this.registerDisposer(renderOptions.lineWidth.changed.add(this.redrawNeeded.dispatch));\n    this.registerDisposer(base.redrawNeeded.add(this.redrawNeeded.dispatch));\n    this.setReady(true);\n    this.registerDisposer(base.visibility.add(this.visibility));\n  }\n  get gl() {\n    return this.base.gl;\n  }\n\n  draw(renderContext: SliceViewPanelRenderContext) {\n    this.base.draw(renderContext, this, this.renderHelper, this.renderOptions);\n  }\n}\n\nfunction getWebglDataType(dataType: DataType) {\n  switch (dataType) {\n    case DataType.FLOAT32:\n      return WebGL2RenderingContext.FLOAT;\n    default:\n      throw new Error(`Data type not supported by WebGL: ${DataType[dataType]}`);\n  }\n}\n\nconst vertexPositionAttribute: VertexAttributeRenderInfo = {\n  dataType: DataType.FLOAT32,\n  numComponents: 3,\n  name: '',\n  webglDataType: WebGL2RenderingContext.FLOAT,\n  glslDataType: 'vec3',\n};\n\nexport class SkeletonChunk extends Chunk {\n  source: SkeletonSource;\n  vertexAttributes: Uint8Array;\n  indices: Uint32Array;\n  indexBuffer: Buffer;\n  numIndices: number;\n  numVertices: number;\n  vertexAttributeOffsets: Uint32Array;\n  vertexAttributeTextures: (WebGLTexture|null)[];\n\n  // Emulation of buffer as texture.\n  textureXBits: number;\n  textureWidth: number;\n  textureHeight: number;\n\n  constructor(source: SkeletonSource, x: any) {\n    super(source);\n    this.vertexAttributes = x['vertexAttributes'];\n    let indices = this.indices = x['indices'];\n    this.numVertices = x['numVertices'];\n    this.vertexAttributeOffsets = x['vertexAttributeOffsets'];\n    this.numIndices = indices.length;\n  }\n\n  copyToGPU(gl: GL) {\n    super.copyToGPU(gl);\n    compute1dTextureLayout(this, gl, /*texelsPerElement=*/ 1, this.numVertices);\n    const {attributeTextureFormats} = this.source;\n    const {vertexAttributes, vertexAttributeOffsets} = this;\n    const vertexAttributeTextures: (WebGLTexture|null)[] = this.vertexAttributeTextures = [];\n    for (let i = 0, numAttributes = vertexAttributeOffsets.length; i < numAttributes; ++i) {\n      const texture = gl.createTexture();\n      gl.bindTexture(WebGL2RenderingContext.TEXTURE_2D, texture);\n      setOneDimensionalTextureData(\n          gl, this, attributeTextureFormats[i],\n          vertexAttributes.subarray(\n              vertexAttributeOffsets[i],\n              i + 1 !== numAttributes ? vertexAttributeOffsets[i + 1] : vertexAttributes.length));\n      vertexAttributeTextures[i] = texture;\n    }\n    gl.bindTexture(WebGL2RenderingContext.TEXTURE_2D, null);\n    this.indexBuffer = Buffer.fromData(\n        gl, this.indices, WebGL2RenderingContext.ARRAY_BUFFER, WebGL2RenderingContext.STATIC_DRAW);\n  }\n\n  freeGPUMemory(gl: GL) {\n    super.freeGPUMemory(gl);\n    const {vertexAttributeTextures} = this;\n    for (const texture of vertexAttributeTextures) {\n      gl.deleteTexture(texture);\n    }\n    vertexAttributeTextures.length = 0;\n    this.indexBuffer.dispose();\n  }\n}\n\nconst emptyVertexAttributes = new Map<string, VertexAttributeInfo>();\n\nfunction getAttributeTextureFormats(vertexAttributes: Map<string, VertexAttributeInfo>):\n    TextureFormat[] {\n  const attributeTextureFormats: TextureFormat[] = [vertexPositionTextureFormat];\n  for (const info of vertexAttributes.values()) {\n    attributeTextureFormats.push(\n        computeTextureFormat(new TextureFormat(), info.dataType, info.numComponents));\n  }\n  return attributeTextureFormats;\n}\n\nexport class SkeletonSource extends ChunkSource {\n  private attributeTextureFormats_?: TextureFormat[];\n\n  get attributeTextureFormats() {\n    let attributeTextureFormats = this.attributeTextureFormats_;\n    if (attributeTextureFormats === undefined) {\n      attributeTextureFormats = this.attributeTextureFormats_ =\n          getAttributeTextureFormats(this.vertexAttributes);\n    }\n    return attributeTextureFormats;\n  }\n\n  chunks: Map<string, SkeletonChunk>;\n  getChunk(x: any) {\n    return new SkeletonChunk(this, x);\n  }\n\n  transform: mat4;\n\n  constructor(chunkManager: Borrowed<ChunkManager>, options: {transform?: mat4}) {\n    super(chunkManager, options);\n    const {transform = mat4.create()} = options;\n    this.transform = transform;\n  }\n\n  /**\n   * Specifies whether the skeleton vertex coordinates are specified in units of voxels rather than\n   * nanometers.\n   */\n  get skeletonVertexCoordinatesInVoxels() {\n    return true;\n  }\n\n  get vertexAttributes(): Map<string, VertexAttributeInfo> {\n    return emptyVertexAttributes;\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {CoordinateTransform} from 'neuroglancer/coordinate_transform';\nimport {ChunkLayout} from 'neuroglancer/sliceview/chunk_layout';\nimport {WatchableValueInterface} from 'neuroglancer/trackable_value';\nimport {partitionArray} from 'neuroglancer/util/array';\nimport {approxEqual} from 'neuroglancer/util/compare';\nimport {DATA_TYPE_BYTES, DataType} from 'neuroglancer/util/data_type';\nimport {effectiveScalingFactorFromMat4, identityMat4, kAxes, kInfinityVec, kZeroVec, mat4, rectifyTransformMatrixIfAxisAligned, transformVectorByMat4, vec3} from 'neuroglancer/util/geom';\nimport {SharedObject} from 'neuroglancer/worker_rpc';\n\nexport {DATA_TYPE_BYTES, DataType};\n\nconst DEBUG_CHUNK_INTERSECTIONS = false;\nconst DEBUG_VISIBLE_SOURCES = false;\n\nconst tempVec3 = vec3.create();\n\n/**\n * Average cross-sectional area contained within a chunk of the specified size and rotation.\n *\n * This is estimated by taking the total volume of the chunk and dividing it by the total length of\n * the chunk along the z axis.\n */\nfunction estimateSliceAreaPerChunk(zAxis: vec3, chunkLayout: ChunkLayout) {\n  const chunkSize = chunkLayout.size;\n  const zAxisRotated = chunkLayout.globalToLocalSpatialVector(tempVec3, zAxis);\n\n  // Minimum and maximum dot product of zAxisRotated with each of the corners of the chunk.  Both\n  // are initialized to 0 because the origin of the chunk has a projection of 0.\n  let minProjection = 0, maxProjection = 0;\n  let chunkVolume = 1;\n  for (let i = 0; i < 3; ++i) {\n    const chunkSizeValue = chunkSize[i];\n    chunkVolume *= chunkSizeValue;\n    const projection = chunkSizeValue * zAxisRotated[i];\n    minProjection = Math.min(minProjection, projection);\n    maxProjection = Math.max(maxProjection, projection);\n  }\n  const projectionLength = maxProjection - minProjection;\n  return chunkVolume / projectionLength;\n}\n\n/**\n * All valid chunks are in the range [lowerBound, upperBound).\n *\n * @param lowerBound Output parameter for lowerBound.\n * @param upperBound Output parameter for upperBound.\n * @param sources Sources for which to compute the chunk bounds.\n */\nfunction computeSourcesChunkBounds(\n    sourcesLowerBound: vec3, sourcesUpperBound: vec3, sources: Iterable<SliceViewChunkSource>) {\n  for (let i = 0; i < 3; ++i) {\n    sourcesLowerBound[i] = Number.POSITIVE_INFINITY;\n    sourcesUpperBound[i] = Number.NEGATIVE_INFINITY;\n  }\n\n  for (let source of sources) {\n    let {spec} = source;\n    let {lowerChunkBound, upperChunkBound} = spec;\n    for (let i = 0; i < 3; ++i) {\n      sourcesLowerBound[i] = Math.min(sourcesLowerBound[i], lowerChunkBound[i]);\n      sourcesUpperBound[i] = Math.max(sourcesUpperBound[i], upperChunkBound[i]);\n    }\n  }\n}\n\nenum BoundsComparisonResult {\n  // Needle is fully outside haystack.\n  FULLY_OUTSIDE,\n  // Needle is fully inside haystack.\n  FULLY_INSIDE,\n  // Needle is partially inside haystack.\n  PARTIALLY_INSIDE\n}\n\nfunction compareBoundsSingleDimension(\n    needleLower: number, needleUpper: number, haystackLower: number, haystackUpper: number) {\n  if (needleLower >= haystackUpper || needleUpper <= haystackLower) {\n    return BoundsComparisonResult.FULLY_OUTSIDE;\n  }\n  if (needleLower >= haystackLower && needleUpper <= haystackUpper) {\n    return BoundsComparisonResult.FULLY_INSIDE;\n  }\n  return BoundsComparisonResult.PARTIALLY_INSIDE;\n}\n\nfunction compareBounds(\n    needleLowerBound: vec3, needleUpperBound: vec3, haystackLowerBound: vec3,\n    haystackUpperBound: vec3) {\n  let curResult = BoundsComparisonResult.FULLY_INSIDE;\n  for (let i = 0; i < 3; ++i) {\n    let newResult = compareBoundsSingleDimension(\n        needleLowerBound[i], needleUpperBound[i], haystackLowerBound[i], haystackUpperBound[i]);\n    switch (newResult) {\n      case BoundsComparisonResult.FULLY_OUTSIDE:\n        return newResult;\n      case BoundsComparisonResult.PARTIALLY_INSIDE:\n        curResult = newResult;\n        break;\n    }\n  }\n  return curResult;\n}\n\nexport interface TransformedSource<Source extends SliceViewChunkSource = SliceViewChunkSource> {\n  source: Source;\n  chunkLayout: ChunkLayout;\n  voxelSize: vec3;\n}\n\nexport interface RenderLayer<Source extends SliceViewChunkSource> {\n  sources: Source[][];\n  transform: CoordinateTransform;\n  transformedSources: TransformedSource<Source>[][]|undefined;\n  transformedSourcesGeneration: number;\n  renderScaleTarget: WatchableValueInterface<number>;\n}\n\nexport function getTransformedSources<Source extends SliceViewChunkSource>(\n    renderLayer: RenderLayer<Source>) {\n  const {transform} = renderLayer;\n  let {transformedSources} = renderLayer;\n  const generation = transform.changed.count;\n  if (generation !== renderLayer.transformedSourcesGeneration) {\n    renderLayer.transformedSourcesGeneration = generation;\n    if (mat4.equals(transform.transform, identityMat4)) {\n      transformedSources = renderLayer.sources.map(\n          alternatives => alternatives.map(source => ({\n                                             source,\n                                             chunkLayout: source.spec.chunkLayout,\n                                             voxelSize: source.spec.voxelSize\n                                           })));\n    } else {\n      transformedSources = renderLayer.sources.map(alternatives => alternatives.map(source => {\n        const chunkLayout = source.spec.chunkLayout;\n        const transformedChunkLayout = ChunkLayout.get(\n            chunkLayout.size, getCombinedTransform(chunkLayout.transform, transform));\n        return {\n          chunkLayout: transformedChunkLayout,\n          source,\n          voxelSize: transformedChunkLayout.localSpatialVectorToGlobal(\n              vec3.create(), source.spec.voxelSize),\n        };\n      }));\n    }\n    renderLayer.transformedSources = transformedSources;\n  }\n  return transformedSources!;\n}\n\nfunction pickBestAlternativeSource<Source extends SliceViewChunkSource>(\n    zAxis: vec3, alternatives: TransformedSource<Source>[]) {\n  let numAlternatives = alternatives.length;\n  let bestAlternativeIndex = 0;\n  if (DEBUG_VISIBLE_SOURCES) {\n    console.log(alternatives);\n  }\n  if (numAlternatives > 1) {\n    let bestSliceArea = 0;\n    for (let alternativeIndex = 0; alternativeIndex < numAlternatives; ++alternativeIndex) {\n      let alternative = alternatives[alternativeIndex];\n      const {chunkLayout} = alternative;\n      let sliceArea = estimateSliceAreaPerChunk(zAxis, chunkLayout);\n      if (DEBUG_VISIBLE_SOURCES) {\n        console.log(`zAxis = ${zAxis}, chunksize = ${chunkLayout.size}, sliceArea = ${sliceArea}`);\n      }\n      if (sliceArea > bestSliceArea) {\n        bestSliceArea = sliceArea;\n        bestAlternativeIndex = alternativeIndex;\n      }\n    }\n  }\n  return alternatives[bestAlternativeIndex];\n}\n\nconst tempCorners = [vec3.create(), vec3.create(), vec3.create(), vec3.create()];\n\nexport class SliceViewBase<Source extends SliceViewChunkSource,\n                                          RLayer extends RenderLayer<Source>> extends SharedObject {\n  width = -1;\n  height = -1;\n  hasViewportToData = false;\n  /**\n   * Specifies whether width, height, and viewportToData are valid.\n   */\n  hasValidViewport = false;\n\n  // Transforms (x,y) viewport coordinates in the range:\n  //\n  // x=[left: -width/2, right: width/2] and\n  //\n  // y=[top: -height/2, bottom: height/2],\n  //\n  // to data coordinates.\n  viewportToData = mat4.create();\n\n  // Normalized x, y, and z viewport axes in data coordinate space.\n  viewportAxes = [vec3.create(), vec3.create(), vec3.create()];\n\n  // Viewport axes used for selecting visible sources.\n  previousViewportAxes = [vec3.create(), vec3.create()];\n\n  centerDataPosition = vec3.create();\n\n  viewportPlaneDistanceToOrigin: number = 0;\n\n  /**\n   * For each visible ChunkLayout, maps each visible GenericVolumeChunkSource to its priority index.\n   * Overall chunk priority ordering is based on a lexicographical ordering of (priorityIndex,\n   * -distanceToCenter).\n   */\n  visibleChunkLayouts = new Map<ChunkLayout, Map<Source, number>>();\n\n  visibleLayers = new Map<RLayer, TransformedSource<Source>[]>();\n\n  visibleSourcesStale = true;\n\n  /**\n   * Size in spatial units (nm) of a single pixel.\n   */\n  pixelSize: number = 0;\n\n  constructor() {\n    super();\n    mat4.identity(this.viewportToData);\n  }\n\n  /**\n   * Called when hasValidViewport == true and the viewport width/height or data transform matrix\n   * changes.\n   */\n  onViewportChanged() {}\n  maybeSetHasValidViewport() {\n    if (!this.hasValidViewport && this.width !== -1 && this.height !== -1 &&\n        this.hasViewportToData) {\n      this.hasValidViewport = true;\n      this.onHasValidViewport();\n    }\n    if (this.hasValidViewport) {\n      this.onViewportChanged();\n    }\n  }\n  onHasValidViewport() {}\n  setViewportSize(width: number, height: number) {\n    if (width !== this.width || height !== this.height) {\n      this.width = width;\n      this.height = height;\n      this.maybeSetHasValidViewport();\n      return true;\n    }\n    return false;\n  }\n  setViewportToDataMatrix(mat: mat4) {\n    if (this.hasViewportToData && mat4.equals(this.viewportToData, mat)) {\n      return false;\n    }\n\n    this.hasViewportToData = true;\n\n    let {viewportToData} = this;\n    mat4.copy(viewportToData, mat);\n    rectifyTransformMatrixIfAxisAligned(viewportToData);\n    vec3.transformMat4(this.centerDataPosition, kZeroVec, mat);\n\n    // Initialize to zero to avoid confusing TypeScript compiler.\n    let newPixelSize = 0;\n\n    // Swap previousViewportAxes with viewportAxes.\n    let viewportAxes = this.viewportAxes;\n    let previousViewportAxes = this.previousViewportAxes;\n\n    // Compute axes.\n    for (var i = 0; i < 3; ++i) {\n      let a = viewportAxes[i];\n      transformVectorByMat4(a, kAxes[i], viewportToData);\n      // a[3] is guaranteed to be 0.\n      if (i === 0) {\n        newPixelSize = vec3.length(a);\n      }\n      vec3.normalize(a, a);\n    }\n\n    this.viewportAxes = viewportAxes;\n    this.previousViewportAxes = previousViewportAxes;\n\n    if (!approxEqual(newPixelSize, this.pixelSize) ||\n        (vec3.dot(viewportAxes[0], previousViewportAxes[0]) < 0.95) ||\n        (vec3.dot(viewportAxes[1], previousViewportAxes[1]) < 0.95)) {\n      vec3.copy(previousViewportAxes[0], viewportAxes[0]);\n      vec3.copy(previousViewportAxes[1], viewportAxes[1]);\n      this.visibleSourcesStale = true;\n      this.pixelSize = newPixelSize;\n    }\n\n    // Compute viewport plane distance to origin.\n    this.viewportPlaneDistanceToOrigin = vec3.dot(this.centerDataPosition, this.viewportAxes[2]);\n    this.onViewportToDataMatrixChanged();\n    this.maybeSetHasValidViewport();\n    return true;\n  }\n\n  onViewportToDataMatrixChanged() {}\n\n  /**\n   * Computes the list of sources to use for each visible layer, based on the\n   * current pixelSize.\n   */\n  updateVisibleSources() {\n    if (!this.visibleSourcesStale) {\n      return;\n    }\n    this.visibleSourcesStale = false;\n    // Increase pixel size by a small margin.\n    let pixelSize = this.pixelSize * 1.1;\n    // console.log(\"pixelSize\", pixelSize);\n\n    let visibleChunkLayouts = this.visibleChunkLayouts;\n    const zAxis = this.viewportAxes[2];\n\n    let visibleLayers = this.visibleLayers;\n    visibleChunkLayouts.clear();\n    for (let [renderLayer, visibleSources] of visibleLayers) {\n      visibleSources.length = 0;\n      let transformedSources = getTransformedSources(renderLayer);\n      let numSources = transformedSources.length;\n      let scaleIndex: number;\n\n      // At the smallest scale, all alternative sources must have the same voxel size, which is\n      // considered to be the base voxel size.\n      let smallestVoxelSize = transformedSources[0][0].voxelSize;\n\n      const renderScaleTarget = renderLayer.renderScaleTarget.value;\n\n      /**\n       * Determines whether we should continue to look for a finer-resolution source *after* one\n       * with the specified voxelSize.\n       */\n      const canImproveOnVoxelSize = (voxelSize: vec3) => {\n        const targetSize = pixelSize * renderScaleTarget;\n        for (let i = 0; i < 3; ++i) {\n          const size = voxelSize[i];\n          // If size <= pixelSize, no need for improvement.\n          // If size === smallestVoxelSize, also no need for improvement.\n          if (size > targetSize && size > 1.01 * smallestVoxelSize[i]) {\n            return true;\n          }\n        }\n        return false;\n      };\n\n      const improvesOnPrevVoxelSize = (voxelSize: vec3, prevVoxelSize: vec3) => {\n        const targetSize = pixelSize * renderScaleTarget;\n        for (let i = 0; i < 3; ++i) {\n          const size = voxelSize[i];\n          const prevSize = prevVoxelSize[i];\n          if (Math.abs(targetSize - size) < Math.abs(targetSize - prevSize) &&\n              size < 1.01 * prevSize) {\n            return true;\n          }\n        }\n        return false;\n      };\n\n      /**\n       * Registers a source as being visible.  This should be called with consecutively decreasing\n       * values of scaleIndex.\n       */\n      const addVisibleSource =\n          (transformedSource: TransformedSource<Source>, sourceScaleIndex: number) => {\n            // Add to end of visibleSources list.  We will reverse the list after all sources are\n            // added.\n            const {source, chunkLayout} = transformedSource;\n            visibleSources[visibleSources.length++] = transformedSource;\n            let existingSources = visibleChunkLayouts.get(chunkLayout);\n            if (existingSources === undefined) {\n              existingSources = new Map<Source, number>();\n              visibleChunkLayouts.set(chunkLayout, existingSources);\n            }\n            existingSources.set(source, sourceScaleIndex);\n          };\n\n      scaleIndex = numSources - 1;\n      let prevVoxelSize: vec3|undefined;\n      while (true) {\n        const transformedSource = pickBestAlternativeSource(zAxis, transformedSources[scaleIndex]);\n        if (prevVoxelSize !== undefined &&\n            !improvesOnPrevVoxelSize(transformedSource.voxelSize, prevVoxelSize)) {\n          break;\n        }\n        addVisibleSource(transformedSource, scaleIndex);\n\n        if (scaleIndex === 0 || !canImproveOnVoxelSize(transformedSource.voxelSize)) {\n          break;\n        }\n        prevVoxelSize = transformedSource.voxelSize;\n        --scaleIndex;\n      }\n      // Reverse visibleSources list since we added sources from coarsest to finest resolution, but\n      // we want them ordered from finest to coarsest.\n      visibleSources.reverse();\n    }\n  }\n  computeVisibleChunks<T>(\n      getLayoutObject: (chunkLayout: ChunkLayout) => T,\n      addChunk:\n          (chunkLayout: ChunkLayout, layoutObject: T, lowerBound: vec3,\n           fullyVisibleSources: SliceViewChunkSource[]) => void) {\n    this.updateVisibleSources();\n\n    // Lower and upper bound in global data coordinates.\n    const globalCorners = tempCorners;\n    let {width, height, viewportToData} = this;\n    for (let i = 0; i < 3; ++i) {\n      globalCorners[0][i] = -kAxes[0][i] * width / 2 - kAxes[1][i] * height / 2;\n      globalCorners[1][i] = -kAxes[0][i] * width / 2 + kAxes[1][i] * height / 2;\n      globalCorners[2][i] = kAxes[0][i] * width / 2 - kAxes[1][i] * height / 2;\n      globalCorners[3][i] = kAxes[0][i] * width / 2 + kAxes[1][i] * height / 2;\n    }\n    for (let i = 0; i < 4; ++i) {\n      vec3.transformMat4(globalCorners[i], globalCorners[i], viewportToData);\n    }\n    // console.log(\"data bounds\", dataLowerBound, dataUpperBound);\n\n    // These variables hold the lower and upper bounds on chunk grid positions that intersect the\n    // viewing plane.\n    var lowerChunkBound = vec3.create();\n    var upperChunkBound = vec3.create();\n\n    let sourcesLowerChunkBound = vec3.create();\n    let sourcesUpperChunkBound = vec3.create();\n\n    // Vertex with maximal dot product with the positive viewport plane normal.\n    // Implicitly, negativeVertex = 1 - positiveVertex.\n    var positiveVertex = vec3.create();\n\n    var planeNormal = vec3.create();\n\n    // Sources whose bounds partially contain the current bounding box.\n    let partiallyVisibleSources = new Array<SliceViewChunkSource>();\n\n    // Sources whose bounds fully contain the current bounding box.\n    let fullyVisibleSources = new Array<SliceViewChunkSource>();\n\n    this.visibleChunkLayouts.forEach((visibleSources, chunkLayout) => {\n      let layoutObject = getLayoutObject(chunkLayout);\n      computeSourcesChunkBounds(\n          sourcesLowerChunkBound, sourcesUpperChunkBound, visibleSources.keys());\n      if (DEBUG_CHUNK_INTERSECTIONS) {\n        console.log(\n            `Initial sources chunk bounds: ` +\n            `${vec3.str(sourcesLowerChunkBound)}, ${vec3.str(sourcesUpperChunkBound)}`);\n      }\n\n      vec3.set(\n          lowerChunkBound, Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY,\n          Number.POSITIVE_INFINITY);\n      vec3.set(\n          upperChunkBound, Number.NEGATIVE_INFINITY, Number.NEGATIVE_INFINITY,\n          Number.NEGATIVE_INFINITY);\n\n      chunkLayout.globalToLocalSpatialVector(planeNormal, this.viewportAxes[2]);\n      for (let i = 0; i < 3; ++i) {\n        positiveVertex[i] = planeNormal[i] > 0 ? 1 : 0;\n      }\n\n      // Center position in chunk grid coordinates.\n      const planeDistanceToOrigin =\n          vec3.dot(chunkLayout.globalToLocalGrid(tempVec3, this.centerDataPosition), planeNormal);\n\n      for (let i = 0; i < 4; ++i) {\n        const localCorner = chunkLayout.globalToLocalGrid(tempVec3, globalCorners[i]);\n        for (let j = 0; j < 3; ++j) {\n          lowerChunkBound[j] = Math.min(lowerChunkBound[j], Math.floor(localCorner[j]));\n          upperChunkBound[j] = Math.max(upperChunkBound[j], Math.floor(localCorner[j]) + 1);\n        }\n      }\n      vec3.max(lowerChunkBound, lowerChunkBound, sourcesLowerChunkBound);\n      vec3.min(upperChunkBound, upperChunkBound, sourcesUpperChunkBound);\n\n      // console.log('chunkBounds', lowerBound, upperBound);\n\n      // Checks whether [lowerBound, upperBound) intersects the viewport plane.\n      //\n      // positiveVertexDistanceToOrigin = dot(planeNormal, lowerBound +\n      // positiveVertex * (upperBound - lowerBound)) - planeDistanceToOrigin;\n      // negativeVertexDistanceToOrigin = dot(planeNormal, lowerBound +\n      // negativeVertex * (upperBound - lowerBound)) - planeDistanceToOrigin;\n      //\n      // positive vertex must have positive distance, and negative vertex must\n      // have negative distance.\n      function intersectsPlane() {\n        var positiveVertexDistanceToOrigin = 0;\n        var negativeVertexDistanceToOrigin = 0;\n        // Check positive vertex.\n        for (let i = 0; i < 3; ++i) {\n          let normalValue = planeNormal[i];\n          let lowerValue = lowerChunkBound[i];\n          let upperValue = upperChunkBound[i];\n          let diff = upperValue - lowerValue;\n          let positiveOffset = positiveVertex[i] * diff;\n          // console.log(\n          //     normalValue, lowerValue, upperValue, diff, positiveOffset,\n          //     positiveVertexDistanceToOrigin, negativeVertexDistanceToOrigin);\n          positiveVertexDistanceToOrigin += normalValue * (lowerValue + positiveOffset);\n          negativeVertexDistanceToOrigin += normalValue * (lowerValue + diff - positiveOffset);\n        }\n        if (DEBUG_CHUNK_INTERSECTIONS) {\n          console.log(`    planeNormal = ${planeNormal}`);\n          console.log(\n              '    {positive,negative}VertexDistanceToOrigin: ', positiveVertexDistanceToOrigin,\n              negativeVertexDistanceToOrigin, planeDistanceToOrigin);\n          console.log(\n              '    intersectsPlane:', negativeVertexDistanceToOrigin, planeDistanceToOrigin,\n              positiveVertexDistanceToOrigin);\n        }\n        if (positiveVertexDistanceToOrigin < planeDistanceToOrigin) {\n          return false;\n        }\n\n        return negativeVertexDistanceToOrigin <= planeDistanceToOrigin;\n      }\n\n      fullyVisibleSources.length = 0;\n      partiallyVisibleSources.length = 0;\n      for (let source of visibleSources.keys()) {\n        let spec = source.spec;\n        let result = compareBounds(\n            lowerChunkBound, upperChunkBound, spec.lowerChunkBound, spec.upperChunkBound);\n        if (DEBUG_CHUNK_INTERSECTIONS) {\n          console.log(\n              `Comparing source bounds lowerBound=${vec3.str(lowerChunkBound)}, ` +\n                  `upperBound=${vec3.str(upperChunkBound)}, ` +\n                  `lowerChunkBound=${vec3.str(spec.lowerChunkBound)}, ` +\n                  `upperChunkBound=${vec3.str(spec.upperChunkBound)}, ` +\n                  `got ${BoundsComparisonResult[result]}`,\n              spec, source);\n        }\n        switch (result) {\n          case BoundsComparisonResult.FULLY_INSIDE:\n            fullyVisibleSources.push(source);\n            break;\n          case BoundsComparisonResult.PARTIALLY_INSIDE:\n            partiallyVisibleSources.push(source);\n            break;\n        }\n      }\n      let partiallyVisibleSourcesLength = partiallyVisibleSources.length;\n\n      // Mutates lowerBound and upperBound while running, but leaves them the\n      // same once finished.\n      function checkBounds(nextSplitDim: number) {\n        if (DEBUG_CHUNK_INTERSECTIONS) {\n          console.log(\n              `chunk bounds: ${lowerChunkBound} ${upperChunkBound} ` +\n              `fullyVisible: ${fullyVisibleSources} partiallyVisible: ` +\n              `${partiallyVisibleSources.slice(0, partiallyVisibleSourcesLength)}`);\n        }\n\n        if (fullyVisibleSources.length === 0 && partiallyVisibleSourcesLength === 0) {\n          if (DEBUG_CHUNK_INTERSECTIONS) {\n            console.log('  no visible sources');\n          }\n          return;\n        }\n\n        if (DEBUG_CHUNK_INTERSECTIONS) {\n          console.log(\n              `Check bounds: [ ${vec3.str(lowerChunkBound)}, ${vec3.str(upperChunkBound)} ]`);\n        }\n        var volume = 1;\n        for (let i = 0; i < 3; ++i) {\n          volume *= Math.max(0, upperChunkBound[i] - lowerChunkBound[i]);\n        }\n\n        if (volume === 0) {\n          if (DEBUG_CHUNK_INTERSECTIONS) {\n            console.log('  volume == 0');\n          }\n          return;\n        }\n\n        if (!intersectsPlane()) {\n          if (DEBUG_CHUNK_INTERSECTIONS) {\n            console.log('  doesn\\'t intersect plane');\n          }\n          return;\n        }\n\n        if (DEBUG_CHUNK_INTERSECTIONS) {\n          console.log(\n              'Within bounds: [' + vec3.str(lowerChunkBound) + ', ' + vec3.str(upperChunkBound) +\n              ']');\n        }\n\n        if (volume === 1) {\n          addChunk(chunkLayout, layoutObject, lowerChunkBound, fullyVisibleSources);\n          return;\n        }\n\n        var dimLower: number, dimUpper: number, diff: number;\n        while (true) {\n          dimLower = lowerChunkBound[nextSplitDim];\n          dimUpper = upperChunkBound[nextSplitDim];\n          diff = dimUpper - dimLower;\n          if (diff === 1) {\n            nextSplitDim = (nextSplitDim + 1) % 3;\n          } else {\n            break;\n          }\n        }\n\n        let splitPoint = dimLower + Math.floor(0.5 * diff);\n        let newNextSplitDim = (nextSplitDim + 1) % 3;\n        let fullyVisibleSourcesLength = fullyVisibleSources.length;\n\n        upperChunkBound[nextSplitDim] = splitPoint;\n\n        let oldPartiallyVisibleSourcesLength = partiallyVisibleSourcesLength;\n        function adjustSources() {\n          partiallyVisibleSourcesLength = partitionArray(\n              partiallyVisibleSources, 0, oldPartiallyVisibleSourcesLength, source => {\n                let spec = source.spec;\n                let result = compareBounds(\n                    lowerChunkBound, upperChunkBound, spec.lowerChunkBound, spec.upperChunkBound);\n                switch (result) {\n                  case BoundsComparisonResult.PARTIALLY_INSIDE:\n                    return true;\n                  case BoundsComparisonResult.FULLY_INSIDE:\n                    fullyVisibleSources.push(source);\n                  default:\n                    return false;\n                }\n              });\n        }\n\n        adjustSources();\n        checkBounds(newNextSplitDim);\n\n        // Truncate list of fully visible sources.\n        fullyVisibleSources.length = fullyVisibleSourcesLength;\n\n        // Restore partiallyVisibleSources.\n        partiallyVisibleSourcesLength = oldPartiallyVisibleSourcesLength;\n\n        upperChunkBound[nextSplitDim] = dimUpper;\n        lowerChunkBound[nextSplitDim] = splitPoint;\n\n        adjustSources();\n        checkBounds(newNextSplitDim);\n\n        lowerChunkBound[nextSplitDim] = dimLower;\n\n        // Truncate list of fully visible sources.\n        fullyVisibleSources.length = fullyVisibleSourcesLength;\n\n        // Restore partiallyVisibleSources.\n        partiallyVisibleSourcesLength = oldPartiallyVisibleSourcesLength;\n      }\n      checkBounds(0);\n    });\n  }\n}\n\n/**\n * By default, choose a chunk size with at most 2^18 = 262144 voxels.\n */\nexport const DEFAULT_MAX_VOXELS_PER_CHUNK_LOG2 = 18;\n\n/**\n * Specifies common options for getNearIsotropicBlockSize and getTwoDimensionalBlockSize.\n */\nexport interface BaseChunkLayoutOptions {\n  /**\n   * Number of channels.\n   */\n  numChannels: number;\n\n  /**\n   * Voxel size in nanometers.\n   */\n  voxelSize: vec3;\n\n  /**\n   * This, together with upperVoxelBound, specifies the total volume dimensions, which serves as a\n   * bound on the maximum chunk size.  If not specified, defaults to (0, 0, 0).\n   */\n  lowerVoxelBound?: vec3;\n\n  /**\n   * Upper voxel bound.  If not specified, the total volume dimensions are not used to bound the\n   * chunk size.\n   */\n  upperVoxelBound?: vec3;\n\n  /**\n   * Base 2 logarithm of the maximum number of voxels per chunk.  Defaults to\n   * DEFAULT_MAX_VOXELS_PER_CHUNK_LOG2.\n   */\n  maxVoxelsPerChunkLog2?: number;\n\n  /**\n   * Specifies an optional transform from local spatial coordinates to global coordinates.\n   */\n  transform?: mat4;\n}\n\nexport interface GetNearIsotropicBlockSizeOptions extends BaseChunkLayoutOptions {\n  maxBlockSize?: vec3;\n}\n\n/**\n * Determines a near-isotropic (in global spatial coordinates) block size.  All dimensions will be\n * powers of 2, and will not exceed upperVoxelBound - lowerVoxelBound.  The total number of voxels\n * will not exceed maxVoxelsPerChunkLog2.\n */\nexport function getNearIsotropicBlockSize(options: GetNearIsotropicBlockSizeOptions) {\n  let {\n    voxelSize,\n    lowerVoxelBound = kZeroVec,\n    upperVoxelBound,\n    maxVoxelsPerChunkLog2 = DEFAULT_MAX_VOXELS_PER_CHUNK_LOG2,\n    transform = identityMat4,\n    maxBlockSize = kInfinityVec,\n  } = options;\n\n  maxVoxelsPerChunkLog2 -= Math.log2(options.numChannels);\n\n  // Adjust voxelSize by effective scaling factor.\n  let temp = effectiveScalingFactorFromMat4(vec3.create(), transform);\n  voxelSize = vec3.multiply(temp, temp, voxelSize);\n\n  let chunkDataSize = vec3.fromValues(1, 1, 1);\n  let maxChunkDataSize: vec3;\n  if (upperVoxelBound === undefined) {\n    maxChunkDataSize = maxBlockSize;\n  } else {\n    maxChunkDataSize = vec3.create();\n    for (let i = 0; i < 3; ++i) {\n      maxChunkDataSize[i] =\n          Math.pow(2, Math.floor(Math.log2(upperVoxelBound[i] - lowerVoxelBound[i])));\n    }\n    vec3.min(maxChunkDataSize, maxChunkDataSize, maxBlockSize);\n  }\n\n  // Determine the dimension in which chunkDataSize should be increased.  This is the smallest\n  // dimension (in nanometers) that is < maxChunkDataSize (in voxels).\n  //\n  // Returns -1 if there is no such dimension.\n  function findNextDimension() {\n    let minSize = Infinity;\n    let minDimension = -1;\n    for (let i = 0; i < 3; ++i) {\n      if (chunkDataSize[i] >= maxChunkDataSize[i]) {\n        continue;\n      }\n      let size = chunkDataSize[i] * voxelSize[i];\n      if (size < minSize) {\n        minSize = size;\n        minDimension = i;\n      }\n    }\n    return minDimension;\n  }\n\n  for (let i = 0; i < maxVoxelsPerChunkLog2; ++i) {\n    let nextDim = findNextDimension();\n    if (nextDim === -1) {\n      break;\n    }\n    chunkDataSize[nextDim] *= 2;\n  }\n  return chunkDataSize;\n}\n\n/**\n * Computes a 3-d block size that has depth 1 in flatDimension and is near-isotropic (in nanometers)\n * in the other two dimensions.  The remaining options are the same as for\n * getNearIsotropicBlockSize.\n */\nexport function getTwoDimensionalBlockSize(options: {flatDimension: number}&\n                                           BaseChunkLayoutOptions) {\n  let {\n    lowerVoxelBound = kZeroVec,\n    upperVoxelBound = kInfinityVec,\n    flatDimension,\n    voxelSize,\n    maxVoxelsPerChunkLog2,\n    transform\n  } = options;\n  vec3.subtract(tempVec3, upperVoxelBound, lowerVoxelBound);\n  tempVec3[flatDimension] = 1;\n  return getNearIsotropicBlockSize({\n    voxelSize,\n    upperVoxelBound: tempVec3,\n    maxVoxelsPerChunkLog2,\n    transform,\n    numChannels: options.numChannels\n  });\n}\n\n/**\n * Returns an array of [xy, xz, yz] 2-dimensional block sizes.\n */\nexport function getTwoDimensionalBlockSizes(options: BaseChunkLayoutOptions) {\n  let chunkDataSizes = new Array<vec3>();\n  for (let i = 0; i < 3; ++i) {\n    chunkDataSizes[i] = getTwoDimensionalBlockSize({\n      numChannels: options.numChannels,\n      flatDimension: i,\n      voxelSize: options.voxelSize,\n      lowerVoxelBound: options.lowerVoxelBound,\n      upperVoxelBound: options.upperVoxelBound,\n      maxVoxelsPerChunkLog2: options.maxVoxelsPerChunkLog2,\n      transform: options.transform,\n    });\n  }\n  return chunkDataSizes;\n}\n\nexport enum ChunkLayoutPreference {\n  /**\n   * Indicates that isotropic chunks are desired.\n   */\n  ISOTROPIC = 0,\n\n  /**\n   * Indicates that 2-D chunks are desired.\n   */\n  FLAT = 1,\n}\n\nexport interface SliceViewSourceOptions {\n  /**\n   * Additional transform applied after the transform specified by the data source for transforming\n   * from local to global coordinates.\n   */\n  transform?: mat4;\n}\n\nexport function getCombinedTransform(transform: mat4|undefined, options: {transform?: mat4}) {\n  let additionalTransform = options.transform;\n  if (additionalTransform === undefined) {\n    if (transform === undefined) {\n      return identityMat4;\n    }\n    return transform;\n  }\n  if (transform === undefined) {\n    return additionalTransform;\n  }\n  return mat4.multiply(mat4.create(), additionalTransform, transform);\n}\n\n/**\n * Specifies parameters for getChunkDataSizes.\n */\nexport interface ChunkLayoutOptions {\n  /**\n   * Chunk sizes in voxels.\n   */\n  chunkDataSizes?: vec3[];\n\n  /**\n   * Preferred chunk layout, which determines chunk sizes to use if chunkDataSizes is not\n   * specified.\n   */\n  chunkLayoutPreference?: ChunkLayoutPreference;\n}\n\nexport function getChunkDataSizes(options: ChunkLayoutOptions&BaseChunkLayoutOptions) {\n  if (options.chunkDataSizes !== undefined) {\n    return options.chunkDataSizes;\n  }\n  const {chunkLayoutPreference = ChunkLayoutPreference.ISOTROPIC} = options;\n  switch (chunkLayoutPreference) {\n    case ChunkLayoutPreference.ISOTROPIC:\n      return [getNearIsotropicBlockSize(options)];\n    case ChunkLayoutPreference.FLAT:\n      let chunkDataSizes = getTwoDimensionalBlockSizes(options);\n      chunkDataSizes.push(getNearIsotropicBlockSize(options));\n      return chunkDataSizes;\n  }\n  throw new Error(`Invalid chunk layout preference: ${chunkLayoutPreference}.`);\n}\n\n/**\n * Generic specification for SliceView chunks specifying a layout and voxel size.\n */\nexport abstract class SliceViewChunkSpecification {\n  chunkLayout: ChunkLayout;\n  voxelSize: vec3;\n\n  // All valid chunks are in the range [lowerChunkBound, upperChunkBound).\n  lowerChunkBound: vec3;\n  upperChunkBound: vec3;\n\n  constructor(options: SliceViewChunkSpecificationOptions) {\n    let {\n      chunkSize,\n      voxelSize,\n      transform,\n      lowerChunkBound = kZeroVec,\n      upperChunkBound,\n    } = options;\n    this.voxelSize = voxelSize;\n    this.chunkLayout = ChunkLayout.get(chunkSize, transform);\n\n    this.lowerChunkBound = lowerChunkBound;\n    this.upperChunkBound = upperChunkBound;\n  }\n\n  toObject(): SliceViewChunkSpecificationOptions {\n    return {\n      transform: this.chunkLayout.transform,\n      chunkSize: this.chunkLayout.size,\n      voxelSize: this.voxelSize,\n      lowerChunkBound: this.lowerChunkBound,\n      upperChunkBound: this.upperChunkBound,\n    };\n  }\n}\n\n/**\n * Common parameters for SliceView Chunks.\n */\nexport interface SliceViewChunkSpecificationBaseOptions {\n  /**\n   * Transform local spatial coordinates to global coordinates.\n   */\n  transform?: mat4;\n\n  /**\n   * Voxel size in local spatial coordinates.\n   */\n  voxelSize: vec3;\n}\n\n\nexport interface SliceViewChunkSpecificationOptions extends SliceViewChunkSpecificationBaseOptions {\n  lowerChunkBound?: vec3;\n  upperChunkBound: vec3;\n\n  chunkSize: vec3;\n}\n\n\nexport interface SliceViewChunkSource {\n  spec: SliceViewChunkSpecification;\n}\n\nexport const SLICEVIEW_RPC_ID = 'SliceView';\nexport const SLICEVIEW_RENDERLAYER_RPC_ID = 'sliceview/RenderLayer';\nexport const SLICEVIEW_ADD_VISIBLE_LAYER_RPC_ID = 'SliceView.addVisibleLayer';\nexport const SLICEVIEW_REMOVE_VISIBLE_LAYER_RPC_ID = 'SliceView.removeVisibleLayer';\nexport const SLICEVIEW_UPDATE_VIEW_RPC_ID = 'SliceView.updateView';\nexport const SLICEVIEW_RENDERLAYER_UPDATE_TRANSFORM_RPC_ID = 'SliceView.updateTransform';\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Facilities for computing the intersection points between an axis-aligned bounding box and a\n * plane in a vertex shader.\n *\n * We use the approach described in the following paper to determine the\n * intersection between the\n * viewport plane and a given 3-D chunk inside of a WebGL vertex shader:\n *\n * A Vertex Program for Efficient Box-Plane Intersection\n * Christof Rezk Salama and Adreas Kolb\n * VMV 2005.\n * http://www.cg.informatik.uni-siegen.de/data/Publications/2005/rezksalamaVMV2005.pdf\n *\n */\n\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {mat4, transformVectorByMat4, vec3, vec3Key} from 'neuroglancer/util/geom';\nimport {Buffer} from 'neuroglancer/webgl/buffer';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {ShaderBuilder, ShaderProgram} from 'neuroglancer/webgl/shader';\n\nconst tempVec3 = vec3.create();\nconst tempVec3b = vec3.create();\n\n/**\n * Amount by which a computed intersection point may lie outside the [0, 1] range and still be\n * considered valid.  This needs to be non-zero in order to avoid vertex placement artifacts.\n */\nconst LAMBDA_EPSILON = 1e-3;\n\n/**\n * If the absolute value of the dot product of a cube edge direction and the viewport plane normal\n * is less than this value, intersections along that cube edge will be exluded.  This needs to be\n * non-zero in order to avoid vertex placement artifacts.\n */\nconst ORTHOGONAL_EPSILON = 1e-3;\n\nfunction findFrontVertexIndex(planeNormal: vec3) {\n  // Determine which vertex is front.\n  let frontVertexIndex = 0;\n  for (var axis_i = 0; axis_i < 3; ++axis_i) {\n    // If plane normal is negative in axis direction, then choose the vertex\n    // with the maximum axis_i-coordinate.\n    if (planeNormal[axis_i] < 0) {\n      frontVertexIndex += (1 << axis_i);\n    }\n  }\n  return frontVertexIndex;\n}\n\n// Specifies the positions of the 8 corners.\nexport const vertexBasePositions = new Float32Array([\n  0, 0, 0,  //\n  1, 0, 0,  //\n  0, 1, 0,  //\n  1, 1, 0,  //\n  0, 0, 1,  //\n  1, 0, 1,  //\n  0, 1, 1,  //\n  1, 1, 1,  //\n]);\n\nexport class SliceViewShaderBuffers extends RefCounted {\n  outputVertexIndices: Buffer;\n  vertexIndices: Int32Array;\n  constructor(gl: GL) {\n    super();\n    this.outputVertexIndices = this.registerDisposer(\n        Buffer.fromData(gl, new Float32Array([0, 1, 2, 3, 4, 5]), gl.ARRAY_BUFFER, gl.STATIC_DRAW));\n\n    // This specifies the original, \"uncorrected\" vertex positions.\n    // var vertexBasePositions = [\n    //   0, 0, 0,\n    //   1, 0, 0,\n    //   0, 1, 0,\n    //   0, 0, 1,\n    //   1, 0, 1,\n    //   1, 1, 0,\n    //   0, 1, 1,\n    //   1, 1, 1,\n    // ];\n\n    // correct_index, vertex_position, uncorrected_index\n    // 0:  0, 0, 0   0\n    // 1:  1, 0, 0   1\n    // 2:  0, 1, 0   2\n    // 4:  0, 0, 1   3\n    // 5:  1, 0, 1   4\n    // 3:  1, 1, 0   5\n    // 6:  0, 1, 1   6\n    // 7:  1, 1, 1   7\n\n    // This maps uncorrected vertex indices to corrected vertex indices.\n    let vertexUncorrectedToCorrected = [0, 1, 2, 4, 5, 3, 6, 7];\n\n    // This maps corrected vertex indices to uncorrected vertex indices.\n    let vertexCorrectedToUncorrected = [0, 1, 2, 5, 3, 4, 6, 7];\n\n\n    // Page 666\n    let vertexBaseIndices = [\n      0, 1, 1, 4, 4, 7, 4, 7,  //\n      1, 5, 0, 1, 1, 4, 4, 7,  //\n      0, 2, 2, 5, 5, 7, 5, 7,  //\n      2, 6, 0, 2, 2, 5, 5, 7,  //\n      0, 3, 3, 6, 6, 7, 6, 7,  //\n      3, 4, 0, 3, 3, 6, 6, 7,  //\n    ];\n\n    // Determined by looking at the figure and determining the corresponding\n    // vertex order for each possible front vertex.\n    let vertexPermutation = [\n      0, 1, 2, 3, 4, 5, 6, 7,  //\n      1, 4, 5, 0, 3, 7, 2, 6,  //\n      2, 6, 0, 5, 7, 3, 1, 4,  //\n      3, 0, 6, 4, 1, 2, 7, 5,  //\n      4, 3, 7, 1, 0, 6, 5, 2,  //\n      5, 2, 1, 7, 6, 0, 4, 3,  //\n      6, 7, 3, 2, 5, 4, 0, 1,  //\n      7, 5, 4, 6, 2, 1, 3, 0,  //\n    ];\n\n    let vertexIndices: number[] = [];\n    for (var p = 0; p < 8; ++p) {\n      for (var i = 0; i < vertexBaseIndices.length; ++i) {\n        const vertexPermutationIndex = vertexCorrectedToUncorrected[p] * 8 + vertexBaseIndices[i];\n        vertexIndices.push(vertexUncorrectedToCorrected[vertexPermutation[vertexPermutationIndex]]);\n      }\n    }\n\n    this.vertexIndices = new Int32Array(vertexIndices);\n  }\n\n  static get(gl: GL) {\n    return gl.memoize.get('SliceViewShaderBuffers', () => new SliceViewShaderBuffers(gl));\n  }\n}\n\nexport class BoundingBoxCrossSectionRenderHelper extends RefCounted {\n  data: SliceViewShaderBuffers;\n  static get(gl: GL) {\n    return gl.memoize.get(\n        'BoundingBoxCrossSectionRenderHelper',\n        () => new BoundingBoxCrossSectionRenderHelper(gl));\n  }\n  constructor(gl: GL) {\n    super();\n    this.data = this.registerDisposer(SliceViewShaderBuffers.get(gl));\n  }\n\n  defineShader(builder: ShaderBuilder) {\n    // Slice plane normal.\n    builder.addUniform('highp vec3', 'uPlaneNormal');\n\n    // Distance from the origin to the slice plane.\n    builder.addUniform('highp float', 'uPlaneDistance');\n\n    // Two-dimensional array of dimensions [6x4], specifying the first and\n    // second vertex index for each of the 4 candidate edges to test for each\n    // computed vertex.\n    builder.addUniform('highp ivec2', 'uVertexIndex', 24);\n\n    // Base vertex positions.\n    builder.addUniform('highp vec3', 'uVertexBasePosition', 8);\n    builder.addInitializer(shader => {\n      shader.gl.uniform3fv(\n          shader.uniform('uVertexBasePosition'), vertexBasePositions);\n    });\n\n    builder.addVertexCode(`\nvec3 getBoundingBoxPlaneIntersectionVertexPosition(vec3 chunkSize, vec3 boxLower, vec3 lowerClipBound, vec3 upperClipBound, int vertexIndex) {\n  for (int e = 0; e < 4; ++e) {\n    highp ivec2 vidx = uVertexIndex[vertexIndex*4 + e];\n    highp vec3 v1 = max(lowerClipBound, min(upperClipBound, chunkSize * uVertexBasePosition[vidx.x] + boxLower));\n    highp vec3 v2 = max(lowerClipBound, min(upperClipBound, chunkSize * uVertexBasePosition[vidx.y] + boxLower));\n    highp vec3 vDir = v2 - v1;\n    highp float denom = dot(vDir, uPlaneNormal);\n    if (abs(denom) > ${ORTHOGONAL_EPSILON}) {\n      highp float lambda = (uPlaneDistance - dot(v1, uPlaneNormal)) / denom;\n      if ((lambda >= -${LAMBDA_EPSILON}) && (lambda <= (1.0 + ${LAMBDA_EPSILON}))) {\n        lambda = clamp(lambda, 0.0, 1.0);\n        highp vec3 position = v1 + lambda * vDir;\n        return position;\n      }\n    }\n  }\n  return vec3(0, 0, 0);\n}\n`);\n  }\n\n  computeVertexPositionDebug(\n      chunkSize: vec3, uLowerClipBound: vec3, uUpperClipBound: vec3, uPlaneDistance: number,\n      uPlaneNormal: vec3, uTranslation: vec3, vertexIndex: number): vec3|undefined {\n    let frontVertexIndex = findFrontVertexIndex(uPlaneNormal);\n    let uVertexIndex =\n        this.data.vertexIndices.subarray(frontVertexIndex * 48, (frontVertexIndex + 1) * 48);\n    let vidx = [0, 0];\n    let v = [vec3.create(), vec3.create()];\n    let vDir = vec3.create(), position = vec3.create();\n    let uVertexBasePosition = (i: number) => <vec3>vertexBasePositions.subarray(i * 3, i * 3 + 3);\n    for (let e = 0; e < 4; ++e) {\n      for (let j = 0; j < 2; ++j) {\n        vidx[j] = uVertexIndex[2 * (vertexIndex * 4 + e) + j];\n        vec3.multiply(v[j], chunkSize, uVertexBasePosition(vidx[j]));\n        vec3.add(v[j], v[j], uTranslation);\n        vec3.min(v[j], v[j], uUpperClipBound);\n        vec3.max(v[j], v[j], uLowerClipBound);\n      }\n      vec3.subtract(vDir, v[1], v[0]);\n      let denom = vec3.dot(vDir, uPlaneNormal);\n      if (Math.abs(denom) > ORTHOGONAL_EPSILON) {\n        let lambda = (uPlaneDistance - vec3.dot(v[0], uPlaneNormal)) / denom;\n        if ((lambda >= -LAMBDA_EPSILON) && (lambda <= 1.0 + LAMBDA_EPSILON)) {\n          lambda = Math.max(0, Math.min(1, lambda));\n          vec3.scaleAndAdd(position, v[0], vDir, lambda);\n          return position;\n        } else {\n          console.log(\n              `vertex ${vertexIndex}, e = ${e}, skipped, deom = ${denom}, ` +\n              `vDir = ${vec3Key(vDir)}, ` +\n              `uPlaneNormal = ${vec3Key(uPlaneNormal)}, ` +\n              `lambda=${lambda}`);\n        }\n      } else {\n        console.log(\n            `vertex ${vertexIndex}, e = ${e}, skipped, deom = ${denom}, ` +\n            `vDir = ${vec3Key(vDir)}, uPlaneNormal = ${vec3Key(uPlaneNormal)}`);\n      }\n    }\n    return undefined;\n  }\n\n  setPlane(shader: ShaderProgram, planeNormal: vec3, planeDistanceToOrigin: number) {\n    const {gl} = shader;\n    gl.uniform3fv(shader.uniform('uPlaneNormal'), planeNormal);\n    gl.uniform1f(shader.uniform('uPlaneDistance'), planeDistanceToOrigin);\n\n    const frontVertexIndex = findFrontVertexIndex(planeNormal);\n    gl.uniform2iv(\n        shader.uniform('uVertexIndex'),\n        this.data.vertexIndices.subarray(frontVertexIndex * 48, (frontVertexIndex + 1) * 48));\n  }\n\n  setViewportPlane(\n      shader: ShaderProgram, viewportZAxis: vec3, viewportCenterPosition: vec3,\n      dataToObjectTransform: mat4) {\n    const localPlaneNormal = transformVectorByMat4(tempVec3, viewportZAxis, dataToObjectTransform);\n    const planeDistanceToOrigin = vec3.dot(\n        vec3.transformMat4(tempVec3b, viewportCenterPosition, dataToObjectTransform),\n        localPlaneNormal);\n    this.setPlane(shader, localPlaneNormal, planeDistanceToOrigin);\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport 'neuroglancer/sliceview/uncompressed_chunk_format';\nimport 'neuroglancer/sliceview/compressed_segmentation/chunk_format';\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {identityMat4, mat4, transformVectorByMat4, vec3} from 'neuroglancer/util/geom';\n\nexport class ChunkLayout {\n  /**\n   * Size of each chunk in local spatial coordinates.\n   */\n  size: vec3;\n\n  /**\n   * Transform from local spatial coordinates to global coordinates (nm).\n   */\n  transform: mat4;\n\n  /**\n   * Inverse of transform.  Transform from global spatial coordinates to local spatial coordinates.\n   */\n  invTransform: mat4;\n\n  constructor(size: vec3, transform: mat4 = identityMat4) {\n    this.size = vec3.clone(size);\n    this.transform = mat4.clone(transform);\n    this.invTransform = mat4.invert(mat4.create(), transform)!;\n  }\n  static cache = new Map<string, ChunkLayout>();\n  toObject(msg: any) {\n    msg['size'] = this.size;\n    msg['transform'] = this.transform;\n  }\n\n  static get(size: vec3, transform = identityMat4) {\n    let cache = ChunkLayout.cache;\n    const key = JSON.stringify([Array.from(size), Array.from(transform)]);\n    let obj = cache.get(key);\n    if (obj === undefined) {\n      obj = new ChunkLayout(size, transform);\n      cache.set(key, obj);\n    }\n    return obj;\n  }\n\n  static fromObject(msg: any) {\n    return ChunkLayout.get(msg['size'], msg['transform']);\n  }\n\n  /**\n   * Transform local spatial coordinates to global spatial coordinates.\n   */\n  localSpatialToGlobal(out: vec3, localSpatial: vec3): vec3 {\n    return vec3.transformMat4(out, localSpatial, this.transform);\n  }\n\n  /**\n   * Transform global spatial coordinates to local spatial coordinates.\n   */\n  globalToLocalSpatial(out: vec3, globalSpatial: vec3): vec3 {\n    return vec3.transformMat4(out, globalSpatial, this.invTransform);\n  }\n\n  globalToLocalGrid(out: vec3, globalSpatial: vec3): vec3 {\n    this.globalToLocalSpatial(out, globalSpatial);\n    vec3.divide(out, out, this.size);\n    return out;\n  }\n\n  localSpatialVectorToGlobal(out: vec3, localVector: vec3): vec3 {\n    return transformVectorByMat4(out, localVector, this.transform);\n  }\n\n  globalToLocalSpatialVector(out: vec3, globalVector: vec3): vec3 {\n    return transformVectorByMat4(out, globalVector, this.invTransform);\n  }\n\n  assignLocalSpatialToGlobalMat4(out: mat4): mat4 {\n    return mat4.copy(out, this.transform);\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {readSingleChannelValue as readSingleChannelValueUint32} from 'neuroglancer/sliceview/compressed_segmentation/decode_uint32';\nimport {readSingleChannelValue as readSingleChannelValueUint64} from 'neuroglancer/sliceview/compressed_segmentation/decode_uint64';\nimport {SingleTextureChunkFormat, SingleTextureVolumeChunk} from 'neuroglancer/sliceview/single_texture_chunk_format';\nimport {DataType, VolumeChunkSpecification} from 'neuroglancer/sliceview/volume/base';\nimport {ChunkFormatHandler, registerChunkFormatHandler} from 'neuroglancer/sliceview/volume/frontend';\nimport {VolumeChunkSource} from 'neuroglancer/sliceview/volume/frontend';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {vec3, vec3Key} from 'neuroglancer/util/geom';\nimport {Uint64} from 'neuroglancer/util/uint64';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {ShaderBuilder, ShaderProgram, ShaderSamplerType} from 'neuroglancer/webgl/shader';\nimport {getShaderType, glsl_getFortranOrderIndex, glsl_uint32, glsl_uint64} from 'neuroglancer/webgl/shader_lib';\nimport {compute1dTextureLayout, computeTextureFormat, OneDimensionalTextureAccessHelper, setOneDimensionalTextureData, TextureFormat} from 'neuroglancer/webgl/texture_access';\n\nclass TextureLayout extends RefCounted {\n  textureXBits: number;\n  textureWidth: number;\n  textureHeight: number;\n  subchunkGridSize: vec3;\n\n  constructor(gl: GL, public chunkDataSize: vec3, public subchunkSize: vec3, dataLength: number) {\n    super();\n    compute1dTextureLayout(this, gl, /*texelsPerElement=*/ 1, dataLength);\n    let subchunkGridSize = this.subchunkGridSize = vec3.create();\n    for (let i = 0; i < 3; ++i) {\n      subchunkGridSize[i] = Math.ceil(chunkDataSize[i] / subchunkSize[i]);\n    }\n  }\n\n  static get(gl: GL, chunkDataSize: vec3, subchunkSize: vec3, dataLength: number) {\n    return gl.memoize.get(\n        `sliceview.CompressedSegmentationTextureLayout:${vec3Key(chunkDataSize)},` +\n            `${vec3Key(subchunkSize)},${dataLength}`,\n        () => new TextureLayout(gl, chunkDataSize, subchunkSize, dataLength));\n  }\n}\n\nconst textureFormat = computeTextureFormat(new TextureFormat(), DataType.UINT32);\n\nexport class ChunkFormat extends SingleTextureChunkFormat<TextureLayout> {\n  static get(gl: GL, dataType: DataType, subchunkSize: vec3, numChannels: number) {\n    let shaderKey = `sliceview.CompressedSegmentationChunkFormat:${dataType}:${numChannels}`;\n    let cacheKey = `${shaderKey}:${vec3Key(subchunkSize)}`;\n    return gl.memoize.get(\n        cacheKey, () => new ChunkFormat(dataType, subchunkSize, numChannels, shaderKey));\n  }\n\n  private textureAccessHelper: OneDimensionalTextureAccessHelper;\n\n  get shaderSamplerType(): ShaderSamplerType {\n    return 'usampler2D';\n  }\n\n  constructor(\n      public dataType: DataType, public subchunkSize: vec3, public numChannels: number,\n      key: string) {\n    super(key);\n    this.textureAccessHelper = new OneDimensionalTextureAccessHelper('chunkData');\n  }\n\n  defineShader(builder: ShaderBuilder) {\n    super.defineShader(builder);\n    let {textureAccessHelper} = this;\n    textureAccessHelper.defineShader(builder);\n    let local = (x: string) => 'compressedSegmentationChunkFormat_' + x;\n    builder.addUniform('highp ivec3', 'uSubchunkGridSize');\n    builder.addUniform('highp ivec3', 'uSubchunkSize');\n    builder.addFragmentCode(glsl_getFortranOrderIndex);\n    const {dataType} = this;\n    const glslType = getShaderType(dataType);\n\n    if (dataType === DataType.UINT64) {\n      builder.addFragmentCode(glsl_uint64);\n    } else {\n      builder.addFragmentCode(glsl_uint32);\n    }\n    builder.addFragmentCode(textureAccessHelper.getAccessor(\n        local('readTextureValue'), 'uVolumeChunkSampler', DataType.UINT32, 1));\n    let fragmentCode = `\nuint ${local('getChannelOffset')}(int channelIndex) {\n  if (channelIndex == 0) {\n    return ${this.numChannels}u;\n  }\n  return ${local('readTextureValue')}(uint(channelIndex)).value;\n}\n${glslType} getDataValue (int channelIndex) {\n  ivec3 chunkPosition = getPositionWithinChunk();\n\n  // TODO: maybe premultiply this and store as uniform.\n  ivec3 subchunkGridPosition = chunkPosition / uSubchunkSize;\n  int subchunkGridOffset = getFortranOrderIndex(subchunkGridPosition, uSubchunkGridSize);\n\n  int channelOffset = int(${local('getChannelOffset')}(channelIndex));\n\n  // TODO: Maybe just combine this offset into subchunkGridStrides.\n  int subchunkHeaderOffset = subchunkGridOffset * 2 + channelOffset;\n\n  highp uint subchunkHeader0 = ${local('readTextureValue')}(uint(subchunkHeaderOffset)).value;\n  highp uint subchunkHeader1 = ${local('readTextureValue')}(uint(subchunkHeaderOffset + 1)).value;\n  highp uint outputValueOffset = (subchunkHeader0 & 0xFFFFFFu) + uint(channelOffset);\n  highp uint encodingBits = subchunkHeader0 >> 24u;\n  if (encodingBits > 0u) {\n    ivec3 subchunkPosition = chunkPosition - subchunkGridPosition * uSubchunkSize;\n    int subchunkOffset = getFortranOrderIndex(subchunkPosition, uSubchunkSize);\n    uint encodedValueBaseOffset = subchunkHeader1 + uint(channelOffset);\n    uint encodedValueOffset = encodedValueBaseOffset + uint(subchunkOffset) * encodingBits / 32u;\n    uint encodedValue = ${local('readTextureValue')}(encodedValueOffset).value;\n    uint wordOffset = uint(subchunkOffset) * encodingBits % 32u;\n    uint encodedValueShifted = encodedValue >> wordOffset;\n    uint decodedValue = encodedValueShifted - (encodedValueShifted >> encodingBits << encodingBits);\n    outputValueOffset += decodedValue * ${this.dataType === DataType.UINT64 ? '2u' : '1u'};\n  }\n  ${glslType} result;\n`;\n    if (dataType === DataType.UINT64) {\n      fragmentCode += `\n  result.value[0] = ${local('readTextureValue')}(outputValueOffset).value;\n  result.value[1] = ${local('readTextureValue')}(outputValueOffset+1u).value;\n`;\n    } else {\n      fragmentCode += `\n  result.value = ${local('readTextureValue')}(outputValueOffset).value;\n`;\n    }\n    fragmentCode += `\n  return result;\n}\n`;\n    builder.addFragmentCode(fragmentCode);\n  }\n\n  /**\n   * Called each time textureLayout changes while drawing chunks.\n   */\n  setupTextureLayout(gl: GL, shader: ShaderProgram, textureLayout: TextureLayout) {\n    const {subchunkGridSize} = textureLayout;\n    gl.uniform3i(\n        shader.uniform('uSubchunkGridSize'), subchunkGridSize[0], subchunkGridSize[1],\n        subchunkGridSize[2]);\n    this.textureAccessHelper.setupTextureLayout(gl, shader, textureLayout);\n  }\n\n  setTextureData(gl: GL, textureLayout: TextureLayout, data: Uint32Array) {\n    setOneDimensionalTextureData(gl, textureLayout, textureFormat, data);\n  }\n\n  getTextureLayout(gl: GL, chunkDataSize: vec3, dataLength: number) {\n    return TextureLayout.get(gl, chunkDataSize, this.subchunkSize, dataLength);\n  }\n\n  beginSource(gl: GL, shader: ShaderProgram) {\n    super.beginSource(gl, shader);\n    const {subchunkSize} = this;\n    gl.uniform3i(\n        shader.uniform('uSubchunkSize'), subchunkSize[0], subchunkSize[1], subchunkSize[2]);\n  }\n}\n\nexport class CompressedSegmentationVolumeChunk extends\n    SingleTextureVolumeChunk<Uint32Array, TextureLayout> {\n  chunkFormat: ChunkFormat;\n\n  setTextureData(gl: GL) {\n    let {data} = this;\n    let {chunkFormat} = this;\n    let textureLayout = this.textureLayout =\n        chunkFormat.getTextureLayout(gl, this.chunkDataSize, data.length);\n    chunkFormat.setTextureData(gl, textureLayout, data);\n  }\n\n  getChannelValueAt(dataPosition: vec3, channel: number): Uint64|number {\n    let {chunkDataSize, chunkFormat} = this;\n    let {data} = this;\n    let offset = data[channel];\n    if (chunkFormat.dataType === DataType.UINT64) {\n      let result = new Uint64();\n      readSingleChannelValueUint64(\n          result, data, /*baseOffset=*/ offset, chunkDataSize, chunkFormat.subchunkSize,\n          dataPosition);\n      return result;\n    } else {\n      return readSingleChannelValueUint32(\n          data, /*baseOffset=*/ offset, chunkDataSize, chunkFormat.subchunkSize, dataPosition);\n    }\n  }\n}\n\nexport class CompressedSegmentationChunkFormatHandler extends RefCounted implements\n    ChunkFormatHandler {\n  chunkFormat: ChunkFormat;\n\n  constructor(gl: GL, spec: VolumeChunkSpecification) {\n    super();\n    let {dataType} = spec;\n    if (dataType !== DataType.UINT64 && dataType !== DataType.UINT32) {\n      throw new Error(`Unsupported compressed segmentation data type: ${DataType[dataType]}`);\n    }\n    this.chunkFormat = this.registerDisposer(ChunkFormat.get(\n        gl, spec.dataType, spec.compressedSegmentationBlockSize!, spec.numChannels));\n  }\n\n  getChunk(source: VolumeChunkSource, x: any) {\n    return new CompressedSegmentationVolumeChunk(source, x);\n  }\n}\n\nregisterChunkFormatHandler((gl: GL, spec: VolumeChunkSpecification) => {\n  if (spec.compressedSegmentationBlockSize != null) {\n    return new CompressedSegmentationChunkFormatHandler(gl, spec);\n  }\n  return null;\n});\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file\n * Support for decompressing uint32 and uint64 segment label chunks.\n */\n\n/**\n * Determines the offset of the value at the specified dataPosition in a single-channel compressed\n * segmentation.\n *\n * @param baseOffset The base offset into `data' at which the compressed data for this channel\n * starts.\n * @param chunkDataSize A 3-element array specifying the size of the volume,\n * @param blockSize A 3-element array specifying the block size ued for compression.\n * @param dataPosition A 3-element array specifying the position within the volume from which to\n * read.\n * @returns The offset into `data', relative to baseOffset, at which the value is located.\n */\nexport function decodeValueOffset(\n    data: Uint32Array, baseOffset: number, chunkDataSize: ArrayLike<number>,\n    blockSize: ArrayLike<number>, dataPosition: ArrayLike<number>, uint32sPerElement: number) {\n  let gridOffset = 0, subchunkOffset = 0, gridStride = 1, subchunkStride = 1;\n  for (let i = 0; i < 3; ++i) {\n    let posValue = dataPosition[i];\n    let subchunkSizeValue = blockSize[i];\n    let gridSubscript = Math.floor(posValue / subchunkSizeValue);\n    let subchunkSubscript = posValue % subchunkSizeValue;\n    gridOffset += gridSubscript * gridStride;\n    gridStride *= Math.ceil(chunkDataSize[i] / subchunkSizeValue);\n    subchunkOffset += subchunkSubscript * subchunkStride;\n    subchunkStride *= subchunkSizeValue;\n  }\n  let subchunkHeaderOffset = baseOffset + gridOffset * 2;\n  let subchunkHeader0 = data[subchunkHeaderOffset];\n  let subchunkHeader1 = data[subchunkHeaderOffset + 1];\n  let outputValueOffset = subchunkHeader0 & 0xFFFFFF;\n  let encodingBits = (subchunkHeader0 >> 24) & 0xFF;\n  if (encodingBits > 0) {\n    let encodedValueBaseOffset = baseOffset + subchunkHeader1 & 0xFFFFFF;\n    let encodedValueOffset =\n        encodedValueBaseOffset + Math.floor(subchunkOffset * encodingBits / 32.0);\n    let encodedValue = data[encodedValueOffset];\n    let wordOffset = (subchunkOffset * encodingBits) % 32;\n\n    let decodedValue = (encodedValue >> wordOffset) & ((1 << encodingBits) - 1);\n    outputValueOffset += uint32sPerElement * decodedValue;\n  }\n  return outputValueOffset;\n}\n","// DO NOT EDIT.  Generated from\n// templates/neuroglancer/sliceview/compressed_segmentation/decode.template.ts.\n/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file\n * Support for decompressing uint64 segment label chunks.\n */\n\nimport {decodeValueOffset} from 'neuroglancer/sliceview/compressed_segmentation/decode_common';\n\n\n\n/**\n * Reads the single value at the specified dataPosition in a single-channel compressed segmentation.\n *\n * @param baseOffset The base offset into `data' at which the compressed data for this channel\n * starts.\n * @param chunkDataSize A 3-element array specifying the size of the volume.\n * @param blockSize A 3-element array specifying the block size ued for compression.\n * @param dataPosition A 3-element array specifying the position within the volume from which to\n * read.\n *\n * Stores the result in `out'.\n */\nexport function readSingleChannelValue(\n\n    data: Uint32Array, baseOffset: number, chunkDataSize: ArrayLike<number>,\n    blockSize: ArrayLike<number>, dataPosition: ArrayLike<number>) {\n  let outputValueOffset =\n      decodeValueOffset(data, baseOffset, chunkDataSize, blockSize, dataPosition, 1) + baseOffset;\n\n  return data[outputValueOffset];\n}\n\n/**\n * Reads the single value (of a single channel) at the specified dataPosition in a multi-channel\n * compressed segmentation.\n *\n * @param dataPosition A 4-element [x, y, z, channel] array specifying the position to read.\n */\nexport function readValue(\n\n    data: Uint32Array, baseOffset: number, chunkDataSize: ArrayLike<number>,\n    blockSize: ArrayLike<number>, dataPosition: ArrayLike<number>) {\n  return readSingleChannelValue(\n\n      data, baseOffset + data[dataPosition[3]], chunkDataSize, blockSize, dataPosition);\n}\n\n/**\n * Decodes a single channel of a compressed segmentation.\n *\n * This is not particularly efficient, because it is intended for testing purposes only.\n */\nexport function decodeChannel(\n    out: Uint32Array, data: Uint32Array, baseOffset: number, chunkDataSize: ArrayLike<number>,\n    blockSize: ArrayLike<number>) {\n  const expectedLength = chunkDataSize[0] * chunkDataSize[1] * chunkDataSize[2] * 1;\n  if (expectedLength !== out.length) {\n    throw new Error(\n        `Output length ${out.length} is not equal to expected length ${expectedLength}.`);\n  }\n  let vx = chunkDataSize[0];\n  let vy = chunkDataSize[1];\n  let vz = chunkDataSize[2];\n  let dataPosition = [0, 0, 0];\n  let outputOffset = 0;\n  for (let z = 0; z < vz; ++z) {\n    dataPosition[2] = z;\n    for (let y = 0; y < vy; ++y) {\n      dataPosition[1] = y;\n      for (let x = 0; x < vx; ++x) {\n        dataPosition[0] = x;\n        let outputValueOffset =\n            decodeValueOffset(data, baseOffset, chunkDataSize, blockSize, dataPosition, 1) +\n            baseOffset;\n        out[outputOffset++] = data[outputValueOffset];\n      }\n    }\n  }\n  return out;\n}\n\n/**\n * Decodes a multi-channel compressed segmentation.\n *\n * This is not particularly efficient, because it is intended for testing purposes only.\n */\nexport function decodeChannels(\n    out: Uint32Array, data: Uint32Array, baseOffset: number, chunkDataSize: ArrayLike<number>,\n    blockSize: ArrayLike<number>) {\n  const channelOutputLength = chunkDataSize[0] * chunkDataSize[1] * chunkDataSize[2] * 1;\n  const expectedLength = channelOutputLength * chunkDataSize[3];\n  if (expectedLength !== out.length) {\n    throw new Error(\n        `Output length ${out.length} is not equal to expected length ${expectedLength}.`);\n  }\n  const numChannels = chunkDataSize[3];\n  for (let channel = 0; channel < numChannels; ++channel) {\n    decodeChannel(\n        out.subarray(channelOutputLength * channel, channelOutputLength * (channel + 1)), data,\n        baseOffset + data[channel], chunkDataSize, blockSize);\n  }\n  return out;\n}\n","// DO NOT EDIT.  Generated from\n// templates/neuroglancer/sliceview/compressed_segmentation/decode.template.ts.\n/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file\n * Support for decompressing uint64 segment label chunks.\n */\n\nimport {decodeValueOffset} from 'neuroglancer/sliceview/compressed_segmentation/decode_common';\n\n\nimport {Uint64} from 'neuroglancer/util/uint64';\n\n\n/**\n * Reads the single value at the specified dataPosition in a single-channel compressed segmentation.\n *\n * @param baseOffset The base offset into `data' at which the compressed data for this channel\n * starts.\n * @param chunkDataSize A 3-element array specifying the size of the volume.\n * @param blockSize A 3-element array specifying the block size ued for compression.\n * @param dataPosition A 3-element array specifying the position within the volume from which to\n * read.\n *\n * Stores the result in `out'.\n */\nexport function readSingleChannelValue(\n\n    out: Uint64,\n\n    data: Uint32Array, baseOffset: number, chunkDataSize: ArrayLike<number>,\n    blockSize: ArrayLike<number>, dataPosition: ArrayLike<number>) {\n  let outputValueOffset =\n      decodeValueOffset(data, baseOffset, chunkDataSize, blockSize, dataPosition, 2) + baseOffset;\n\n  out.low = data[outputValueOffset];\n  out.high = data[outputValueOffset + 1];\n  return out;\n}\n\n/**\n * Reads the single value (of a single channel) at the specified dataPosition in a multi-channel\n * compressed segmentation.\n *\n * @param dataPosition A 4-element [x, y, z, channel] array specifying the position to read.\n */\nexport function readValue(\n\n    out: Uint64,\n\n    data: Uint32Array, baseOffset: number, chunkDataSize: ArrayLike<number>,\n    blockSize: ArrayLike<number>, dataPosition: ArrayLike<number>) {\n  return readSingleChannelValue(\n\n      out,\n\n      data, baseOffset + data[dataPosition[3]], chunkDataSize, blockSize, dataPosition);\n}\n\n/**\n * Decodes a single channel of a compressed segmentation.\n *\n * This is not particularly efficient, because it is intended for testing purposes only.\n */\nexport function decodeChannel(\n    out: Uint32Array, data: Uint32Array, baseOffset: number, chunkDataSize: ArrayLike<number>,\n    blockSize: ArrayLike<number>) {\n  const expectedLength = chunkDataSize[0] * chunkDataSize[1] * chunkDataSize[2] * 2;\n  if (expectedLength !== out.length) {\n    throw new Error(\n        `Output length ${out.length} is not equal to expected length ${expectedLength}.`);\n  }\n  let vx = chunkDataSize[0];\n  let vy = chunkDataSize[1];\n  let vz = chunkDataSize[2];\n  let dataPosition = [0, 0, 0];\n  let outputOffset = 0;\n  for (let z = 0; z < vz; ++z) {\n    dataPosition[2] = z;\n    for (let y = 0; y < vy; ++y) {\n      dataPosition[1] = y;\n      for (let x = 0; x < vx; ++x) {\n        dataPosition[0] = x;\n        let outputValueOffset =\n            decodeValueOffset(data, baseOffset, chunkDataSize, blockSize, dataPosition, 2) +\n            baseOffset;\n        out[outputOffset++] = data[outputValueOffset];\n\n        out[outputOffset++] = data[outputValueOffset + 1];\n      }\n    }\n  }\n  return out;\n}\n\n/**\n * Decodes a multi-channel compressed segmentation.\n *\n * This is not particularly efficient, because it is intended for testing purposes only.\n */\nexport function decodeChannels(\n    out: Uint32Array, data: Uint32Array, baseOffset: number, chunkDataSize: ArrayLike<number>,\n    blockSize: ArrayLike<number>) {\n  const channelOutputLength = chunkDataSize[0] * chunkDataSize[1] * chunkDataSize[2] * 2;\n  const expectedLength = channelOutputLength * chunkDataSize[3];\n  if (expectedLength !== out.length) {\n    throw new Error(\n        `Output length ${out.length} is not equal to expected length ${expectedLength}.`);\n  }\n  const numChannels = chunkDataSize[3];\n  for (let channel = 0; channel < numChannels; ++channel) {\n    decodeChannel(\n        out.subarray(channelOutputLength * channel, channelOutputLength * (channel + 1)), data,\n        baseOffset + data[channel], chunkDataSize, blockSize);\n  }\n  return out;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport debounce from 'lodash/debounce';\nimport {ChunkState} from 'neuroglancer/chunk_manager/base';\nimport {Chunk, ChunkManager, ChunkSource} from 'neuroglancer/chunk_manager/frontend';\nimport {LayerManager} from 'neuroglancer/layer';\nimport {NavigationState} from 'neuroglancer/navigation_state';\nimport {SLICEVIEW_ADD_VISIBLE_LAYER_RPC_ID, SLICEVIEW_REMOVE_VISIBLE_LAYER_RPC_ID, SLICEVIEW_RPC_ID, SLICEVIEW_UPDATE_VIEW_RPC_ID, SliceViewBase, SliceViewChunkSource as SliceViewChunkSourceInterface, SliceViewChunkSpecification, SliceViewSourceOptions} from 'neuroglancer/sliceview/base';\nimport {ChunkLayout} from 'neuroglancer/sliceview/chunk_layout';\nimport {RenderLayer} from 'neuroglancer/sliceview/renderlayer';\nimport {Disposer, invokeDisposers, RefCounted} from 'neuroglancer/util/disposable';\nimport {mat4, rectifyTransformMatrixIfAxisAligned, vec3, vec3Key, vec4} from 'neuroglancer/util/geom';\nimport {getObjectId} from 'neuroglancer/util/object_id';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {withSharedVisibility} from 'neuroglancer/visibility_priority/frontend';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {FramebufferConfiguration, makeTextureBuffers, StencilBuffer} from 'neuroglancer/webgl/offscreen';\nimport {ShaderBuilder, ShaderModule, ShaderProgram} from 'neuroglancer/webgl/shader';\nimport {getSquareCornersBuffer} from 'neuroglancer/webgl/square_corners_buffer';\nimport {registerSharedObjectOwner, RPC} from 'neuroglancer/worker_rpc';\n\nexport type GenericChunkKey = string;\n\nconst tempMat = mat4.create();\n\nclass FrontendSliceViewBase extends SliceViewBase<SliceViewChunkSource, RenderLayer> {}\nconst Base = withSharedVisibility(FrontendSliceViewBase);\n\n@registerSharedObjectOwner(SLICEVIEW_RPC_ID)\nexport class SliceView extends Base {\n  gl = this.chunkManager.gl;\n\n  dataToViewport = mat4.create();\n\n  // Transforms viewport coordinates to OpenGL normalized device coordinates\n  // [left: -1, right: 1], [top: 1, bottom: -1].\n  viewportToDevice = mat4.create();\n\n  // Equals viewportToDevice * dataToViewport.\n  dataToDevice = mat4.create();\n\n  visibleChunks = new Map<ChunkLayout, GenericChunkKey[]>();\n\n  viewChanged = new NullarySignal();\n\n  renderingStale = true;\n\n  visibleChunksStale = true;\n\n  visibleLayerList = new Array<RenderLayer>();\n\n  newVisibleLayers = new Set<RenderLayer>();\n\n  offscreenFramebuffer = this.registerDisposer(new FramebufferConfiguration(\n      this.gl,\n      {colorBuffers: makeTextureBuffers(this.gl, 1), depthBuffer: new StencilBuffer(this.gl)}));\n\n  numVisibleChunks = 0;\n\n  constructor(\n      public chunkManager: ChunkManager, public layerManager: LayerManager,\n      public navigationState: NavigationState) {\n    super();\n    mat4.identity(this.dataToViewport);\n    const rpc = this.chunkManager.rpc!;\n    this.initializeCounterpart(rpc, {\n      'chunkManager': chunkManager.rpcId,\n    });\n    this.registerDisposer(navigationState.changed.add(() => {\n      this.updateViewportFromNavigationState();\n    }));\n    this.updateViewportFromNavigationState();\n\n    this.registerDisposer(layerManager.layersChanged.add(() => {\n      if (this.hasValidViewport) {\n        this.updateVisibleLayers();\n      }\n    }));\n\n    this.viewChanged.add(() => {\n      this.renderingStale = true;\n    });\n    this.registerDisposer(\n        chunkManager.chunkQueueManager.visibleChunksChanged.add(this.viewChanged.dispatch));\n\n    this.updateViewportFromNavigationState();\n    this.updateVisibleLayers();\n  }\n\n  isReady() {\n    this.setViewportSizeDebounced.flush();\n    if (!this.hasValidViewport) {\n      return false;\n    }\n    this.maybeUpdateVisibleChunks();\n    let numValidChunks = 0;\n    for (const visibleSources of this.visibleLayers.values()) {\n      for (const {chunkLayout, source} of visibleSources) {\n        // FIXME: handle change to chunkLayout\n        const visibleChunks = this.visibleChunks.get(chunkLayout);\n        if (!visibleChunks) {\n          return false;\n        }\n        const {chunks} = source;\n        for (const key of visibleChunks) {\n          const chunk = chunks.get(key);\n          if (chunk && chunk.state === ChunkState.GPU_MEMORY) {\n            ++numValidChunks;\n          }\n        }\n      }\n    }\n    return numValidChunks === this.numVisibleChunks;\n  }\n\n  private updateViewportFromNavigationState() {\n    let {navigationState} = this;\n    if (!navigationState.valid) {\n      return;\n    }\n    navigationState.toMat4(tempMat);\n    this.setViewportToDataMatrix(tempMat);\n  }\n\n  private updateVisibleLayers = this.registerCancellable(debounce(() => {\n    this.updateVisibleLayersNow();\n  }, 0));\n\n  private invalidateVisibleSources = (() => {\n    this.visibleSourcesStale = true;\n    this.viewChanged.dispatch();\n  });\n\n  private bindVisibleRenderLayer(renderLayer: RenderLayer, disposers: Disposer[]) {\n    disposers.push(renderLayer.redrawNeeded.add(this.viewChanged.dispatch));\n    disposers.push(renderLayer.transform.changed.add(this.invalidateVisibleSources));\n    disposers.push(renderLayer.renderScaleTarget.changed.add(this.invalidateVisibleSources));\n    const {renderScaleHistogram} = renderLayer;\n    if (renderScaleHistogram !== undefined) {\n      disposers.push(renderScaleHistogram.visibility.add(this.visibility));\n    }\n  }\n\n  private visibleLayerDisposers = new Map<RenderLayer, Disposer[]>();\n\n  private updateVisibleLayersNow() {\n    if (this.wasDisposed) {\n      return false;\n    }\n    if (!this.hasValidViewport) {\n      return false;\n    }\n    let visibleLayers = this.visibleLayers;\n    let rpc = this.rpc!;\n    let rpcMessage: any = {'id': this.rpcId};\n    let newVisibleLayers = this.newVisibleLayers;\n    let changed = false;\n    let visibleLayerList = this.visibleLayerList;\n    const {visibleLayerDisposers} = this;\n    visibleLayerList.length = 0;\n    for (let renderLayer of this.layerManager.readyRenderLayers()) {\n      if (renderLayer instanceof RenderLayer) {\n        newVisibleLayers.add(renderLayer);\n        visibleLayerList.push(renderLayer);\n        if (!visibleLayers.has(renderLayer)) {\n          visibleLayers.set(renderLayer.addRef(), []);\n          const disposers: Disposer[] = [];\n          visibleLayerDisposers.set(renderLayer, disposers);\n          this.bindVisibleRenderLayer(renderLayer, disposers);\n          rpcMessage['layerId'] = renderLayer.rpcId;\n          rpc.invoke(SLICEVIEW_ADD_VISIBLE_LAYER_RPC_ID, rpcMessage);\n          changed = true;\n        }\n      }\n    }\n    for (let renderLayer of visibleLayers.keys()) {\n      if (!newVisibleLayers.has(renderLayer)) {\n        visibleLayers.delete(renderLayer);\n        const disposers = this.visibleLayerDisposers.get(renderLayer)!;\n        this.visibleLayerDisposers.delete(renderLayer);\n        invokeDisposers(disposers);\n        rpcMessage['layerId'] = renderLayer.rpcId;\n        rpc.invoke(SLICEVIEW_REMOVE_VISIBLE_LAYER_RPC_ID, rpcMessage);\n        renderLayer.dispose();\n        changed = true;\n      }\n    }\n    newVisibleLayers.clear();\n    if (changed) {\n      this.visibleSourcesStale = true;\n    }\n    // Unconditionally call viewChanged, because layers may have been reordered even if the set of\n    // sources is the same.\n    this.viewChanged.dispatch();\n    return changed;\n  }\n\n  onViewportChanged() {\n    var {width, height, viewportToDevice, dataToViewport, dataToDevice} = this;\n    // FIXME: Make this adjustable.\n    const sliceThickness = 10;\n    mat4.ortho(\n        viewportToDevice, -width / 2, width / 2, height / 2, -height / 2, -sliceThickness,\n        sliceThickness);\n    mat4.multiply(dataToDevice, viewportToDevice, dataToViewport);\n\n    this.visibleChunksStale = true;\n    this.viewChanged.dispatch();\n  }\n  setViewportSizeDebounced = this.registerCancellable(\n      debounce((width: number, height: number) => this.setViewportSize(width, height), 0));\n  setViewportSize(width: number, height: number) {\n    this.setViewportSizeDebounced.cancel();\n    if (super.setViewportSize(width, height)) {\n      this.rpc!.invoke(\n          SLICEVIEW_UPDATE_VIEW_RPC_ID, {id: this.rpcId, width: width, height: height});\n      // this.chunkManager.scheduleUpdateChunkPriorities();\n      return true;\n    }\n    return false;\n  }\n\n  onViewportToDataMatrixChanged() {\n    let {viewportToData, dataToViewport} = this;\n    mat4.invert(dataToViewport, viewportToData);\n    rectifyTransformMatrixIfAxisAligned(dataToViewport);\n    this.rpc!.invoke(\n        SLICEVIEW_UPDATE_VIEW_RPC_ID, {id: this.rpcId, viewportToData: viewportToData});\n  }\n\n  onHasValidViewport() {\n    this.updateVisibleLayers();\n  }\n\n  updateRendering() {\n    this.setViewportSizeDebounced.flush();\n    if (!this.renderingStale || !this.hasValidViewport || this.width === 0 || this.height === 0) {\n      return;\n    }\n    this.renderingStale = false;\n    this.maybeUpdateVisibleChunks();\n\n    let {gl, offscreenFramebuffer, width, height} = this;\n\n    offscreenFramebuffer.bind(width!, height!);\n    gl.disable(gl.SCISSOR_TEST);\n\n    // we have viewportToData\n    // we need: matrix that maps input x to the output x axis, scaled by\n\n    gl.clearStencil(0);\n    gl.clearColor(0, 0, 0, 0);\n    gl.colorMask(true, true, true, true);\n    gl.clear(gl.COLOR_BUFFER_BIT);\n    gl.enable(gl.STENCIL_TEST);\n    gl.disable(gl.DEPTH_TEST);\n    gl.stencilOpSeparate(\n        /*face=*/ gl.FRONT_AND_BACK, /*sfail=*/ gl.KEEP, /*dpfail=*/ gl.KEEP,\n        /*dppass=*/ gl.REPLACE);\n\n    let renderLayerNum = 0;\n    for (let renderLayer of this.visibleLayerList) {\n      gl.clear(gl.STENCIL_BUFFER_BIT);\n      gl.stencilFuncSeparate(\n          /*face=*/ gl.FRONT_AND_BACK,\n          /*func=*/ gl.GREATER,\n          /*ref=*/ 1,\n          /*mask=*/ 1);\n\n      renderLayer.setGLBlendMode(gl, renderLayerNum);\n      renderLayer.draw(this);\n      ++renderLayerNum;\n    }\n    gl.disable(gl.BLEND);\n    gl.disable(gl.STENCIL_TEST);\n    offscreenFramebuffer.unbind();\n  }\n\n  maybeUpdateVisibleChunks() {\n    this.updateVisibleLayers.flush();\n    if (!this.visibleChunksStale && !this.visibleSourcesStale) {\n      return false;\n    }\n    this.visibleChunksStale = false;\n    this.updateVisibleChunks();\n    return true;\n  }\n  updateVisibleChunks() {\n    let allVisibleChunks = this.visibleChunks;\n\n    function getLayoutObject(chunkLayout: ChunkLayout) {\n      let visibleChunks = allVisibleChunks.get(chunkLayout);\n      if (visibleChunks === undefined) {\n        visibleChunks = [];\n        allVisibleChunks.set(chunkLayout, visibleChunks);\n      } else {\n        visibleChunks.length = 0;\n      }\n      return visibleChunks;\n    }\n    let numVisibleChunks = 0;\n    function addChunk(\n        _chunkLayout: ChunkLayout, visibleChunks: string[], positionInChunks: vec3,\n        fullyVisibleSources: SliceViewChunkSource[]) {\n      let key = vec3Key(positionInChunks);\n      visibleChunks[visibleChunks.length] = key;\n      numVisibleChunks += fullyVisibleSources.length;\n    }\n    this.computeVisibleChunks(getLayoutObject, addChunk);\n    this.numVisibleChunks = numVisibleChunks;\n  }\n\n  disposed() {\n    for (const [renderLayer, disposers] of this.visibleLayerDisposers) {\n      invokeDisposers(disposers);\n      renderLayer.dispose();\n    }\n    this.visibleLayerDisposers.clear();\n    this.visibleLayers.clear();\n    this.visibleLayerList.length = 0;\n  }\n}\n\nexport interface SliceViewChunkSourceOptions {\n  spec: SliceViewChunkSpecification;\n}\n\nexport abstract class SliceViewChunkSource extends ChunkSource implements\n    SliceViewChunkSourceInterface {\n  chunks: Map<string, SliceViewChunk>;\n\n  spec: SliceViewChunkSpecification;\n\n  constructor(chunkManager: ChunkManager, options: SliceViewChunkSourceOptions) {\n    super(chunkManager, options);\n    this.spec = options.spec;\n  }\n\n  static encodeOptions(options: SliceViewChunkSourceOptions) {\n    const encoding = super.encodeOptions(options);\n    encoding.spec = options.spec.toObject();\n    return encoding;\n  }\n\n  initializeCounterpart(rpc: RPC, options: any) {\n    options['spec'] = this.spec.toObject();\n    super.initializeCounterpart(rpc, options);\n  }\n}\n\nexport interface SliceViewChunkSource {\n  // TODO(jbms): Move this declaration to the class definition above and declare abstract once\n  // TypeScript supports mixins with abstact classes.\n  getChunk(x: any): any;\n}\n\nexport class SliceViewChunk extends Chunk {\n  chunkGridPosition: vec3;\n  source: SliceViewChunkSource;\n\n  constructor(source: SliceViewChunkSource, x: any) {\n    super(source);\n    this.chunkGridPosition = x['chunkGridPosition'];\n    this.state = ChunkState.SYSTEM_MEMORY;\n  }\n}\n\n/**\n * Helper for rendering a SliceView that has been pre-rendered to a texture.\n */\nexport class SliceViewRenderHelper extends RefCounted {\n  private copyVertexPositionsBuffer = getSquareCornersBuffer(this.gl);\n  private shader: ShaderProgram;\n\n  private textureCoordinateAdjustment = new Float32Array(4);\n\n  constructor(public gl: GL, emitter: ShaderModule) {\n    super();\n    let builder = new ShaderBuilder(gl);\n    builder.addVarying('vec2', 'vTexCoord');\n    builder.addUniform('sampler2D', 'uSampler');\n    builder.addInitializer(shader => {\n      gl.uniform1i(shader.uniform('uSampler'), 0);\n    });\n    builder.addUniform('vec4', 'uColorFactor');\n    builder.addUniform('vec4', 'uBackgroundColor');\n    builder.addUniform('mat4', 'uProjectionMatrix');\n    builder.addUniform('vec4', 'uTextureCoordinateAdjustment');\n    builder.require(emitter);\n    builder.setFragmentMain(`\nvec4 sampledColor = texture(uSampler, vTexCoord);\nif (sampledColor.a == 0.0) {\n  sampledColor = uBackgroundColor;\n}\nemit(sampledColor * uColorFactor, 0u);\n`);\n    builder.addAttribute('vec4', 'aVertexPosition');\n    builder.setVertexMain(`\nvTexCoord = uTextureCoordinateAdjustment.xy + 0.5 * (aVertexPosition.xy + 1.0) * uTextureCoordinateAdjustment.zw;\ngl_Position = uProjectionMatrix * aVertexPosition;\n`);\n    this.shader = this.registerDisposer(builder.build());\n  }\n\n  draw(\n      texture: WebGLTexture|null, projectionMatrix: mat4, colorFactor: vec4, backgroundColor: vec4,\n      xStart: number, yStart: number, xEnd: number, yEnd: number) {\n    let {gl, shader, textureCoordinateAdjustment} = this;\n    textureCoordinateAdjustment[0] = xStart;\n    textureCoordinateAdjustment[1] = yStart;\n    textureCoordinateAdjustment[2] = xEnd - xStart;\n    textureCoordinateAdjustment[3] = yEnd - yStart;\n    shader.bind();\n    gl.activeTexture(gl.TEXTURE0);\n    gl.bindTexture(gl.TEXTURE_2D, texture);\n    gl.uniformMatrix4fv(shader.uniform('uProjectionMatrix'), false, projectionMatrix);\n    gl.uniform4fv(shader.uniform('uColorFactor'), colorFactor);\n    gl.uniform4fv(shader.uniform('uBackgroundColor'), backgroundColor);\n    gl.uniform4fv(shader.uniform('uTextureCoordinateAdjustment'), textureCoordinateAdjustment);\n\n    let aVertexPosition = shader.attribute('aVertexPosition');\n    this.copyVertexPositionsBuffer.bindToVertexAttrib(aVertexPosition, /*components=*/ 2);\n\n    gl.drawArrays(gl.TRIANGLE_FAN, 0, 4);\n\n    gl.disableVertexAttribArray(aVertexPosition);\n    gl.bindTexture(gl.TEXTURE_2D, null);\n  }\n\n  static get(gl: GL, emitter: ShaderModule) {\n    return gl.memoize.get(\n        `sliceview/SliceViewRenderHelper:${getObjectId(emitter)}`,\n        () => new SliceViewRenderHelper(gl, emitter));\n  }\n}\n\nexport interface MultiscaleSliceViewChunkSource {\n  /**\n   * @return Chunk sources for each scale, ordered by increasing minVoxelSize.  For each scale,\n   * there may be alternative sources with different chunk layouts.\n   */\n  getSources: (options: SliceViewSourceOptions) => SliceViewChunkSource[][];\n\n  chunkManager: ChunkManager;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {AxesLineHelper} from 'neuroglancer/axes_lines';\nimport {DisplayContext} from 'neuroglancer/display_context';\nimport {makeRenderedPanelVisibleLayerTracker, VisibilityTrackedRenderLayer} from 'neuroglancer/layer';\nimport {PickIDManager} from 'neuroglancer/object_picking';\nimport {FramePickingData, RenderedDataPanel, RenderedDataViewerState} from 'neuroglancer/rendered_data_panel';\nimport {SliceView, SliceViewRenderHelper} from 'neuroglancer/sliceview/frontend';\nimport {TrackableBoolean} from 'neuroglancer/trackable_boolean';\nimport {TrackableRGB} from 'neuroglancer/util/color';\nimport {ActionEvent, registerActionListener} from 'neuroglancer/util/event_action_map';\nimport {identityMat4, mat4, vec3, vec4} from 'neuroglancer/util/geom';\nimport {startRelativeMouseDrag} from 'neuroglancer/util/mouse_drag';\nimport {TouchRotateInfo} from 'neuroglancer/util/touch_bindings';\nimport {FramebufferConfiguration, OffscreenCopyHelper, TextureBuffer} from 'neuroglancer/webgl/offscreen';\nimport {ShaderBuilder, ShaderModule} from 'neuroglancer/webgl/shader';\nimport {ScaleBarTexture, TrackableScaleBarOptions} from 'neuroglancer/widget/scale_bar';\n\nexport interface SliceViewerState extends RenderedDataViewerState {\n  showScaleBar: TrackableBoolean;\n  scaleBarOptions: TrackableScaleBarOptions;\n  crossSectionBackgroundColor: TrackableRGB;\n}\n\nexport enum OffscreenTextures {\n  COLOR,\n  PICK,\n  NUM_TEXTURES\n}\n\nfunction sliceViewPanelEmitColor(builder: ShaderBuilder) {\n  builder.addOutputBuffer('vec4', 'out_fragColor', null);\n  builder.addFragmentCode(`\nvoid emit(vec4 color, highp uint pickId) {\n  out_fragColor = color;\n}\n`);\n}\n\nfunction sliceViewPanelEmitPickID(builder: ShaderBuilder) {\n  builder.addOutputBuffer('highp float', 'out_pickId', null);\n  builder.addFragmentCode(`\nvoid emit(vec4 color, highp uint pickId) {\n  out_pickId = float(pickId);\n}\n`);\n}\n\n\nexport interface SliceViewPanelRenderContext {\n  dataToDevice: mat4;\n  pickIDs: PickIDManager;\n  emitter: ShaderModule;\n\n  /**\n   * Specifies whether the emitted color value will be used.\n   */\n  emitColor: boolean;\n\n  /**\n   * Specifies whether the emitted pick ID will be used.\n   */\n  emitPickID: boolean;\n\n  /**\n   * Width of GL viewport in pixels.\n   */\n  viewportWidth: number;\n\n  /**\n   * Height of GL viewport in pixels.\n   */\n  viewportHeight: number;\n\n  sliceView: SliceView;\n}\n\nexport class SliceViewPanelRenderLayer extends VisibilityTrackedRenderLayer {\n  draw(_renderContext: SliceViewPanelRenderContext) {\n    // Must be overridden by subclasses.\n  }\n\n  isReady() {\n    return true;\n  }\n}\n\nconst tempVec4 = vec4.create();\n\nexport class SliceViewPanel extends RenderedDataPanel {\n  viewer: SliceViewerState;\n\n  private axesLineHelper = this.registerDisposer(AxesLineHelper.get(this.gl));\n  private sliceViewRenderHelper =\n      this.registerDisposer(SliceViewRenderHelper.get(this.gl, sliceViewPanelEmitColor));\n  private colorFactor = vec4.fromValues(1, 1, 1, 1);\n  private pickIDs = new PickIDManager();\n\n  private visibleLayerTracker = makeRenderedPanelVisibleLayerTracker(\n      this.viewer.layerManager, SliceViewPanelRenderLayer, this.viewer.visibleLayerRoles, this);\n\n  private offscreenFramebuffer = this.registerDisposer(new FramebufferConfiguration(this.gl, {\n    colorBuffers: [\n      new TextureBuffer(\n          this.gl, WebGL2RenderingContext.RGBA8, WebGL2RenderingContext.RGBA,\n          WebGL2RenderingContext.UNSIGNED_BYTE),\n      new TextureBuffer(\n          this.gl, WebGL2RenderingContext.R32F, WebGL2RenderingContext.RED,\n          WebGL2RenderingContext.FLOAT),\n    ]\n  }));\n\n  private offscreenCopyHelper = this.registerDisposer(OffscreenCopyHelper.get(this.gl));\n  private scaleBarCopyHelper = this.registerDisposer(OffscreenCopyHelper.get(this.gl));\n\n  private scaleBarTexture = this.registerDisposer(new ScaleBarTexture(this.gl));\n\n  get navigationState() {\n    return this.sliceView.navigationState;\n  }\n\n  constructor(\n      context: DisplayContext, element: HTMLElement, public sliceView: SliceView,\n      viewer: SliceViewerState) {\n    super(context, element, viewer);\n\n    registerActionListener(element, 'rotate-via-mouse-drag', (e: ActionEvent<MouseEvent>) => {\n      const {mouseState} = this.viewer;\n      if (mouseState.updateUnconditionally()) {\n        const initialPosition = vec3.clone(mouseState.position);\n        startRelativeMouseDrag(e.detail, (_event, deltaX, deltaY) => {\n          let {viewportAxes} = this.sliceView;\n          this.viewer.navigationState.pose.rotateAbsolute(\n              viewportAxes[1], -deltaX / 4.0 * Math.PI / 180.0, initialPosition);\n          this.viewer.navigationState.pose.rotateAbsolute(\n              viewportAxes[0], -deltaY / 4.0 * Math.PI / 180.0, initialPosition);\n        });\n      }\n    });\n\n    registerActionListener(\n        element, 'rotate-in-plane-via-touchrotate', (e: ActionEvent<TouchRotateInfo>) => {\n          const {detail} = e;\n          const {mouseState} = this.viewer;\n          this.handleMouseMove(detail.centerX, detail.centerY);\n          if (mouseState.updateUnconditionally()) {\n            const {viewportAxes} = this.sliceView;\n            this.navigationState.pose.rotateAbsolute(\n                viewportAxes[2], detail.angle - detail.prevAngle, mouseState.position);\n          }\n        });\n\n    this.registerDisposer(sliceView);\n    this.registerDisposer(\n        viewer.crossSectionBackgroundColor.changed.add(() => this.scheduleRedraw()));\n    this.registerDisposer(sliceView.visibility.add(this.visibility));\n    this.registerDisposer(sliceView.viewChanged.add(() => {\n      if (this.visible) {\n        context.scheduleRedraw();\n      }\n    }));\n    this.registerDisposer(viewer.showAxisLines.changed.add(() => {\n      if (this.visible) {\n        this.scheduleRedraw();\n      }\n    }));\n\n    this.registerDisposer(viewer.showScaleBar.changed.add(() => {\n      if (this.visible) {\n        this.context.scheduleRedraw();\n      }\n    }));\n    this.registerDisposer(viewer.scaleBarOptions.changed.add(() => {\n      if (this.visible) {\n        this.context.scheduleRedraw();\n      }\n    }));\n  }\n\n  translateByViewportPixels(deltaX: number, deltaY: number): void {\n    const {position} = this.viewer.navigationState;\n    const pos = position.spatialCoordinates;\n    vec3.set(pos, -deltaX, -deltaY, 0);\n    vec3.transformMat4(pos, pos, this.sliceView.viewportToData);\n    position.changed.dispatch();\n  }\n\n  translateDataPointByViewportPixels(out: vec3, orig: vec3, deltaX: number, deltaY: number): vec3 {\n    vec3.transformMat4(out, orig, this.sliceView.dataToViewport);\n    vec3.set(out, out[0] + deltaX, out[1] + deltaY, out[2]);\n    vec3.transformMat4(out, out, this.sliceView.viewportToData);\n    return out;\n  }\n\n  isReady() {\n    if (!this.visible) {\n      return false;\n    }\n\n    if (!this.sliceView.isReady()) {\n      return false;\n    }\n\n    let visibleLayers = this.visibleLayerTracker.getVisibleLayers();\n    for (let renderLayer of visibleLayers) {\n      if (!renderLayer.isReady()) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  drawWithPicking(pickingData: FramePickingData): boolean {\n    let {sliceView} = this;\n    sliceView.setViewportSize(this.width, this.height);\n    sliceView.updateRendering();\n    if (!sliceView.hasValidViewport) {\n      return false;\n    }\n    mat4.copy(pickingData.invTransform, sliceView.viewportToData);\n    const {gl} = this;\n\n    const {width, height, dataToDevice} = sliceView;\n    this.offscreenFramebuffer.bind(width, height);\n    gl.disable(WebGL2RenderingContext.SCISSOR_TEST);\n    this.gl.clearColor(0.0, 0.0, 0.0, 0.0);\n    gl.clear(WebGL2RenderingContext.COLOR_BUFFER_BIT);\n\n    // Draw axes lines.\n    // FIXME: avoid use of temporary matrix\n    let mat = mat4.create();\n\n    const backgroundColor = tempVec4;\n    const crossSectionBackgroundColor = this.viewer.crossSectionBackgroundColor.value;\n    backgroundColor[0] = crossSectionBackgroundColor[0];\n    backgroundColor[1] = crossSectionBackgroundColor[1];\n    backgroundColor[2] = crossSectionBackgroundColor[2];\n    backgroundColor[3] = 1;\n\n    this.offscreenFramebuffer.bindSingle(OffscreenTextures.COLOR);\n    this.sliceViewRenderHelper.draw(\n        sliceView.offscreenFramebuffer.colorBuffers[0].texture, identityMat4, this.colorFactor,\n        backgroundColor, 0, 0, 1, 1);\n\n    let visibleLayers = this.visibleLayerTracker.getVisibleLayers();\n    let {pickIDs} = this;\n    pickIDs.clear();\n    let renderContext: SliceViewPanelRenderContext = {\n      dataToDevice: sliceView.dataToDevice,\n      pickIDs: pickIDs,\n      emitter: sliceViewPanelEmitColor,\n      emitColor: true,\n      emitPickID: false,\n      viewportWidth: width,\n      viewportHeight: height,\n      sliceView,\n    };\n    gl.enable(WebGL2RenderingContext.BLEND);\n    gl.blendFunc(WebGL2RenderingContext.SRC_ALPHA, WebGL2RenderingContext.ONE_MINUS_SRC_ALPHA);\n    for (let renderLayer of visibleLayers) {\n      renderLayer.draw(renderContext);\n    }\n    gl.disable(WebGL2RenderingContext.BLEND);\n    this.offscreenFramebuffer.bindSingle(OffscreenTextures.PICK);\n    renderContext.emitColor = false;\n    renderContext.emitPickID = true;\n    renderContext.emitter = sliceViewPanelEmitPickID;\n\n    for (let renderLayer of visibleLayers) {\n      renderLayer.draw(renderContext);\n    }\n\n    if (this.viewer.showAxisLines.value || this.viewer.showScaleBar.value) {\n      if (this.viewer.showAxisLines.value) {\n        // Construct matrix that maps [-1, +1] x/y range to the full viewport data\n        // coordinates.\n        mat4.copy(mat, dataToDevice);\n        for (let i = 0; i < 3; ++i) {\n          mat[12 + i] = 0;\n        }\n\n        for (let i = 0; i < 4; ++i) {\n          mat[2 + 4 * i] = 0;\n        }\n\n\n        let axisLength = Math.min(width, height) / 4 * 1.5;\n        let pixelSize = sliceView.pixelSize;\n        for (let i = 0; i < 12; ++i) {\n          // pixelSize is nm / pixel\n          //\n          mat[i] *= axisLength * pixelSize;\n        }\n      }\n      this.offscreenFramebuffer.bindSingle(OffscreenTextures.COLOR);\n      if (this.viewer.showAxisLines.value) {\n        this.axesLineHelper.draw(mat);\n      }\n      if (this.viewer.showScaleBar.value) {\n        gl.enable(WebGL2RenderingContext.BLEND);\n        gl.blendFunc(WebGL2RenderingContext.SRC_ALPHA, WebGL2RenderingContext.ONE_MINUS_SRC_ALPHA);\n        const options = this.viewer.scaleBarOptions.value;\n        const {scaleBarTexture} = this;\n        const {dimensions} = scaleBarTexture;\n        dimensions.targetLengthInPixels = Math.min(\n            options.maxWidthFraction * width, options.maxWidthInPixels * options.scaleFactor);\n        dimensions.nanometersPerPixel = sliceView.pixelSize;\n        scaleBarTexture.update(options);\n        gl.viewport(\n            options.leftPixelOffset * options.scaleFactor,\n            options.bottomPixelOffset * options.scaleFactor, scaleBarTexture.width,\n            scaleBarTexture.height);\n        this.scaleBarCopyHelper.draw(scaleBarTexture.texture);\n        gl.disable(WebGL2RenderingContext.BLEND);\n      }\n    }\n\n    this.offscreenFramebuffer.unbind();\n\n    // Draw the texture over the whole viewport.\n    this.setGLViewport();\n    this.offscreenCopyHelper.draw(\n        this.offscreenFramebuffer.colorBuffers[OffscreenTextures.COLOR].texture);\n    return true;\n  }\n\n  panelSizeChanged() {\n    this.sliceView.setViewportSizeDebounced(this.width, this.height);\n  }\n\n  issuePickRequest(glWindowX: number, glWindowY: number) {\n    const {offscreenFramebuffer} = this;\n    offscreenFramebuffer.readPixelFloat32IntoBuffer(\n        OffscreenTextures.PICK, glWindowX, glWindowY, 0);\n  }\n\n  completePickRequest(\n      glWindowX: number, glWindowY: number, data: Float32Array, pickingData: FramePickingData) {\n    const {mouseState} = this.viewer;\n    mouseState.pickedRenderLayer = null;\n    const out = mouseState.position;\n    const {viewportWidth, viewportHeight} = pickingData;\n    const y = pickingData.viewportHeight - glWindowY;\n    vec3.set(out, glWindowX - viewportWidth / 2, y - viewportHeight / 2, 0);\n    vec3.transformMat4(out, out, pickingData.invTransform);\n    this.pickIDs.setMouseState(mouseState, data[0]);\n    mouseState.setActive(true);\n  }\n\n  /**\n   * Zooms by the specified factor, maintaining the data position that projects to the current mouse\n   * position.\n   */\n  zoomByMouse(factor: number) {\n    let {navigationState} = this;\n    if (!navigationState.valid) {\n      return;\n    }\n    let {sliceView} = this;\n    let {width, height} = sliceView;\n    let {mouseX, mouseY} = this;\n    mouseX -= width / 2;\n    mouseY -= height / 2;\n    let oldZoom = this.navigationState.zoomFactor.value;\n    // oldPosition + (mouseX * viewportAxes[0] + mouseY * viewportAxes[1]) * oldZoom\n    //     === newPosition + (mouseX * viewportAxes[0] + mouseY * viewportAxes[1]) * newZoom\n\n    // Therefore, we compute newPosition by:\n    // newPosition = oldPosition + (viewportAxes[0] * mouseX +\n    //                              viewportAxes[1] * mouseY) * (oldZoom - newZoom).\n    navigationState.zoomBy(factor);\n    let newZoom = navigationState.zoomFactor.value;\n\n    let {spatialCoordinates} = navigationState.position;\n    vec3.scaleAndAdd(\n        spatialCoordinates, spatialCoordinates, sliceView.viewportAxes[0],\n        mouseX * (oldZoom - newZoom));\n    vec3.scaleAndAdd(\n        spatialCoordinates, spatialCoordinates, sliceView.viewportAxes[1],\n        mouseY * (oldZoom - newZoom));\n    navigationState.position.changed.dispatch();\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {ChunkManager} from 'neuroglancer/chunk_manager/frontend';\nimport {CoordinateTransform} from 'neuroglancer/coordinate_transform';\nimport {RenderLayer as GenericRenderLayer} from 'neuroglancer/layer';\nimport {RenderScaleHistogram, trackableRenderScaleTarget} from 'neuroglancer/render_scale_statistics';\nimport {SharedWatchableValue} from 'neuroglancer/shared_watchable_value';\nimport {getTransformedSources, SLICEVIEW_RENDERLAYER_RPC_ID, SLICEVIEW_RENDERLAYER_UPDATE_TRANSFORM_RPC_ID, TransformedSource} from 'neuroglancer/sliceview/base';\nimport {SliceView, SliceViewChunkSource} from 'neuroglancer/sliceview/frontend';\nimport {WatchableValueInterface} from 'neuroglancer/trackable_value';\nimport {vec3} from 'neuroglancer/util/geom';\nimport {RpcId} from 'neuroglancer/worker_rpc';\nimport {SharedObject} from 'neuroglancer/worker_rpc';\n\nexport interface RenderLayerOptions {\n  transform?: CoordinateTransform;\n  renderScaleTarget?: WatchableValueInterface<number>;\n  renderScaleHistogram?: RenderScaleHistogram;\n}\n\nexport abstract class RenderLayer extends GenericRenderLayer {\n  rpcId: RpcId|null = null;\n  transform: CoordinateTransform;\n  transformedSources: TransformedSource<SliceViewChunkSource>[][];\n  transformedSourcesGeneration = -1;\n  renderScaleTarget: WatchableValueInterface<number>;\n  renderScaleHistogram?: RenderScaleHistogram;\n\n  constructor(\n      public chunkManager: ChunkManager, public sources: SliceViewChunkSource[][],\n      options: RenderLayerOptions) {\n    super();\n\n    const {\n      transform = new CoordinateTransform(),\n      renderScaleTarget = trackableRenderScaleTarget(1)\n    } = options;\n    this.renderScaleTarget = renderScaleTarget;\n    this.renderScaleHistogram = options.renderScaleHistogram;\n    this.transform = transform;\n    const transformedSources = getTransformedSources(this);\n\n    {\n      const {source, chunkLayout} = transformedSources[0][0];\n      const {spec} = source;\n      const voxelSize = this.voxelSize =\n          chunkLayout.localSpatialVectorToGlobal(vec3.create(), spec.voxelSize);\n      for (let i = 0; i < 3; ++i) {\n        voxelSize[i] = Math.abs(voxelSize[i]);\n      }\n    }\n\n    const sharedObject = this.registerDisposer(new SharedObject());\n    const rpc = this.chunkManager.rpc!;\n    sharedObject.RPC_TYPE_ID = SLICEVIEW_RENDERLAYER_RPC_ID;\n    const sourceIds = sources.map(alternatives => alternatives.map(source => source.rpcId!));\n    sharedObject.initializeCounterpart(rpc, {\n      sources: sourceIds,\n      transform: transform.transform,\n      renderScaleTarget:\n          this.registerDisposer(SharedWatchableValue.makeFromExisting(rpc, this.renderScaleTarget))\n              .rpcId\n    });\n    this.rpcId = sharedObject.rpcId;\n\n    this.registerDisposer(transform.changed.add(() => {\n      rpc.invoke(\n          SLICEVIEW_RENDERLAYER_UPDATE_TRANSFORM_RPC_ID,\n          {id: this.rpcId, value: transform.transform});\n    }));\n\n    this.setReady(true);\n  }\n\n  get gl() {\n    return this.chunkManager.chunkQueueManager.gl;\n  }\n\n  setGLBlendMode(gl: WebGL2RenderingContext, renderLayerNum: number): void {\n    // Default blend mode for non-blend-mode-aware layers\n    if (renderLayerNum > 0) {\n      gl.enable(gl.BLEND);\n      gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\n    }\n  }\n  abstract draw(sliceView: SliceView): void;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {VolumeChunk, VolumeChunkSource} from 'neuroglancer/sliceview/volume/frontend';\nimport {ChunkFormat} from 'neuroglancer/sliceview/volume/frontend';\nimport {TypedArray} from 'neuroglancer/util/array';\nimport {Disposable, RefCounted} from 'neuroglancer/util/disposable';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {ShaderBuilder, ShaderProgram, ShaderSamplerType, textureTargetForSamplerType} from 'neuroglancer/webgl/shader';\n\nconst textureUnitSymbol = Symbol('SingleTextureVolumeChunk.textureUnit');\nconst textureLayoutSymbol = Symbol('SingleTextureVolumeChunk.textureLayout');\n\nexport abstract class SingleTextureChunkFormat<TextureLayout extends Disposable> extends RefCounted\n    implements ChunkFormat {\n  constructor(public shaderKey: string) {\n    super();\n  }\n\n  defineShader(builder: ShaderBuilder) {\n    builder.addTextureSampler(this.shaderSamplerType, 'uVolumeChunkSampler', textureUnitSymbol);\n  }\n\n  abstract get shaderSamplerType(): ShaderSamplerType;\n\n  beginDrawing(gl: GL, shader: ShaderProgram) {\n    let textureUnit = shader.textureUnit(textureUnitSymbol);\n    gl.activeTexture(WebGL2RenderingContext.TEXTURE0 + textureUnit);\n    (<any>shader)[textureLayoutSymbol] = null;\n  }\n\n  endDrawing(gl: GL, shader: ShaderProgram) {\n    gl.bindTexture(textureTargetForSamplerType[this.shaderSamplerType], null);\n    (<any>shader)[textureLayoutSymbol] = null;\n  }\n\n  /**\n   * Called each time textureLayout changes while drawing chunks.\n   */\n  abstract setupTextureLayout(gl: GL, shader: ShaderProgram, textureLayout: TextureLayout): void;\n\n  bindChunk<Data>(\n      gl: GL, shader: ShaderProgram, chunk: SingleTextureVolumeChunk<Data, TextureLayout>) {\n    let textureLayout = chunk.textureLayout!;\n    let existingTextureLayout = (<any>shader)[textureLayoutSymbol];\n    if (existingTextureLayout !== textureLayout) {\n      (<any>shader)[textureLayoutSymbol] = textureLayout;\n      this.setupTextureLayout(gl, shader, textureLayout);\n    }\n    gl.bindTexture(textureTargetForSamplerType[this.shaderSamplerType], chunk.texture);\n  }\n\n  abstract setTextureData(gl: GL, textureLayout: TextureLayout, data: TypedArray): void;\n\n  /**\n   * Does nothing, but may be overridden by subclass.\n   */\n  beginSource(_gl: GL, _shader: ShaderProgram) {}\n}\n\nexport abstract class SingleTextureVolumeChunk<Data, TextureLayout extends Disposable> extends\n    VolumeChunk {\n  texture: WebGLTexture|null = null;\n  data: Data;\n  textureLayout: TextureLayout|null;\n  chunkFormat: SingleTextureChunkFormat<TextureLayout>;\n\n  constructor(source: VolumeChunkSource, x: any) {\n    super(source, x);\n    this.data = x['data'];\n  }\n\n  abstract setTextureData(gl: GL): void;\n\n  copyToGPU(gl: GL) {\n    super.copyToGPU(gl);\n    let texture = this.texture = gl.createTexture();\n    const textureTarget = textureTargetForSamplerType[this.chunkFormat.shaderSamplerType];\n    gl.bindTexture(textureTarget, texture);\n    this.setTextureData(gl);\n    gl.bindTexture(textureTarget, null);\n  }\n\n  freeGPUMemory(gl: GL) {\n    super.freeGPUMemory(gl);\n    gl.deleteTexture(this.texture);\n    this.texture = null;\n    this.textureLayout!.dispose();\n    this.textureLayout = null;\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {SingleTextureChunkFormat, SingleTextureVolumeChunk} from 'neuroglancer/sliceview/single_texture_chunk_format';\nimport {DataType, VolumeChunkSpecification} from 'neuroglancer/sliceview/volume/base';\nimport {VolumeChunkSource} from 'neuroglancer/sliceview/volume/frontend';\nimport {ChunkFormatHandler, registerChunkFormatHandler} from 'neuroglancer/sliceview/volume/frontend';\nimport {TypedArray, TypedArrayConstructor} from 'neuroglancer/util/array';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {vec3, vec3Key} from 'neuroglancer/util/geom';\nimport {Uint64} from 'neuroglancer/util/uint64';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {ShaderBuilder, ShaderProgram, ShaderSamplerPrefix, ShaderSamplerType} from 'neuroglancer/webgl/shader';\nimport {getShaderType} from 'neuroglancer/webgl/shader_lib';\nimport {computeTextureFormat, setThreeDimensionalTextureData, TextureFormat, ThreeDimensionalTextureAccessHelper} from 'neuroglancer/webgl/texture_access';\n\nclass TextureLayout extends RefCounted {\n  constructor(public chunkDataSize: vec3, public numChannels: number) {\n    super();\n  }\n\n  static get(gl: GL, chunkDataSize: vec3, numChannels: number) {\n    return gl.memoize.get(\n        `sliceview.UncompressedTextureLayout:${vec3Key(chunkDataSize)},${numChannels}`,\n        () => new TextureLayout(chunkDataSize, numChannels));\n  }\n}\n\nexport class ChunkFormat extends SingleTextureChunkFormat<TextureLayout> implements TextureFormat {\n  texelsPerElement: number;\n  textureInternalFormat: number;\n  textureFormat: number;\n  texelType: number;\n  arrayElementsPerTexel: number;\n  arrayConstructor: TypedArrayConstructor;\n  samplerPrefix: ShaderSamplerPrefix;\n  get shaderSamplerType() {\n    return `${this.samplerPrefix}sampler3D` as ShaderSamplerType;\n  }\n  private textureAccessHelper: ThreeDimensionalTextureAccessHelper;\n\n  static get(gl: GL, dataType: DataType, numChannels: number) {\n    let key = `sliceview.UncompressedChunkFormat:${dataType}:${numChannels}`;\n    return gl.memoize.get(key, () => new ChunkFormat(gl, dataType, numChannels, key));\n  }\n\n  constructor(_gl: GL, public dataType: DataType, public numChannels: number, key: string) {\n    super(key);\n    computeTextureFormat(this, dataType);\n    this.textureAccessHelper = new ThreeDimensionalTextureAccessHelper('chunkData');\n  }\n\n  defineShader(builder: ShaderBuilder) {\n    super.defineShader(builder);\n    let {textureAccessHelper} = this;\n    builder.addFragmentCode(\n        textureAccessHelper.getAccessor('readVolumeData', 'uVolumeChunkSampler', this.dataType));\n\n    let {numChannels} = this;\n    if (numChannels > 1) {\n      builder.addUniform('highp int', 'uChannelStride');\n      builder.addFragmentCode(`\nhighp int getChannelOffset(highp int channelIndex) {\n  return channelIndex * uChannelStride;\n}\n`);\n    } else {\n      builder.addFragmentCode(`highp int getChannelOffset(highp int channelIndex) { return 0; }`);\n    }\n    const shaderType = getShaderType(this.dataType);\n    builder.addFragmentCode(`\n${shaderType} getDataValue (highp int channelIndex) {\n  highp ivec3 p = getPositionWithinChunk();\n  return readVolumeData(ivec3(p.x, p.y, p.z + getChannelOffset(channelIndex)));\n}\n`);\n  }\n\n  /**\n   * Called each time textureLayout changes while drawing chunks.\n   */\n  setupTextureLayout(gl: GL, shader: ShaderProgram, textureLayout: TextureLayout) {\n    if (this.numChannels > 1) {\n      gl.uniform1i(shader.uniform('uChannelStride'), textureLayout.chunkDataSize[2]);\n    }\n  }\n\n  getTextureLayout(gl: GL, chunkDataSize: vec3) {\n    return TextureLayout.get(gl, chunkDataSize, this.numChannels);\n  }\n\n  setTextureData(gl: GL, textureLayout: TextureLayout, data: TypedArray) {\n    const {chunkDataSize} = textureLayout;\n    setThreeDimensionalTextureData(\n        gl, this, data, chunkDataSize[0], chunkDataSize[1], chunkDataSize[2] * this.numChannels);\n  }\n}\n\ninterface Source extends VolumeChunkSource {\n  chunkFormatHandler: UncompressedChunkFormatHandler;\n}\n\nexport class UncompressedVolumeChunk extends SingleTextureVolumeChunk<Uint8Array, TextureLayout> {\n  chunkFormat: ChunkFormat;\n  source: Source;\n\n  setTextureData(gl: GL) {\n    let {source} = this;\n    let {chunkFormatHandler} = source;\n    let {chunkFormat} = chunkFormatHandler;\n\n    let textureLayout: TextureLayout;\n    if (this.chunkDataSize === source.spec.chunkDataSize) {\n      this.textureLayout = textureLayout = chunkFormatHandler.textureLayout.addRef();\n    } else {\n      this.textureLayout = textureLayout = chunkFormat.getTextureLayout(gl, this.chunkDataSize);\n    }\n\n    this.chunkFormat.setTextureData(gl, textureLayout, this.data);\n  }\n\n  getChannelValueAt(dataPosition: vec3, channel: number): number|Uint64 {\n    let {chunkFormat} = this;\n    let chunkDataSize = this.chunkDataSize;\n    let index = dataPosition[0] +\n        chunkDataSize[0] *\n            (dataPosition[1] + chunkDataSize[1] * (dataPosition[2] + chunkDataSize[2] * channel));\n    let dataType = chunkFormat.dataType;\n    let data = this.data;\n    switch (dataType) {\n      case DataType.UINT8:\n      case DataType.FLOAT32:\n      case DataType.UINT16:\n      case DataType.UINT32:\n        return data[index];\n      case DataType.UINT64: {\n        let index2 = index * 2;\n        return new Uint64(data[index2], data[index2 + 1]);\n      }\n    }\n    throw new Error('Invalid data type: ' + dataType);\n  }\n}\n\nexport class UncompressedChunkFormatHandler extends RefCounted implements ChunkFormatHandler {\n  chunkFormat: ChunkFormat;\n  textureLayout: TextureLayout;\n\n  constructor(gl: GL, spec: VolumeChunkSpecification) {\n    super();\n    this.chunkFormat = this.registerDisposer(ChunkFormat.get(gl, spec.dataType, spec.numChannels));\n    this.textureLayout =\n        this.registerDisposer(this.chunkFormat.getTextureLayout(gl, spec.chunkDataSize));\n  }\n\n  getChunk(source: VolumeChunkSource, x: any) {\n    return new UncompressedVolumeChunk(source, x);\n  }\n}\n\nregisterChunkFormatHandler((gl: GL, spec: VolumeChunkSpecification) => {\n  if (spec.compressedSegmentationBlockSize == null) {\n    return new UncompressedChunkFormatHandler(gl, spec);\n  }\n  return null;\n});\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {SliceViewChunkSource, SliceViewChunkSpecification, SliceViewChunkSpecificationBaseOptions, SliceViewChunkSpecificationOptions, SliceViewSourceOptions} from 'neuroglancer/sliceview/base';\nimport {getCombinedTransform} from 'neuroglancer/sliceview/base';\n\nexport enum VectorGraphicsType {\n  LINE,\n  POINT\n}\n\nexport interface RenderLayer {\n  sources: VectorGraphicsChunkSource[][]|null;\n}\n\nexport interface VectorGraphicsChunkSpecificationSourceOptions {\n  vectorGraphicsSourceOptions: VectorGraphicsSourceOptions;\n}\n\nexport interface VectorGraphicsSourceOptions extends SliceViewSourceOptions {}\n\nexport interface VectorGraphicsChunkSource extends SliceViewChunkSource {\n  spec: VectorGraphicsChunkSpecification;\n}\n\nexport type VectorGraphicsChunkSpecificationOptions = SliceViewChunkSpecificationOptions;\n\nexport interface VectorGraphicsChunkSpecificationDefaultChunkSizeOptions extends\n    SliceViewChunkSpecificationBaseOptions {}\n\n/**\n * Specifies a chunk layout and voxel size.\n */\nexport class VectorGraphicsChunkSpecification extends SliceViewChunkSpecification {\n  constructor(options: VectorGraphicsChunkSpecificationOptions) {\n    super(options);\n  }\n\n  static make(options: VectorGraphicsChunkSpecificationOptions&\n              {vectorGraphicsSourceOptions: VectorGraphicsSourceOptions}) {\n    return new VectorGraphicsChunkSpecification(Object.assign(\n        {}, options,\n        {transform: getCombinedTransform(options.transform, options.vectorGraphicsSourceOptions)}));\n  }\n\n  static fromObject(msg: any) {\n    return new VectorGraphicsChunkSpecification(msg);\n  }\n\n  toObject(): SliceViewChunkSpecificationOptions {\n    return super.toObject();\n  }\n}\n\nexport const VECTOR_GRAPHICS_RPC_ID = 'vectorgraphics';\nexport const VECTOR_GRAPHICS_RENDERLAYER_RPC_ID = 'vectorgraphics/RenderLayer';\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {MultiscaleSliceViewChunkSource, SliceViewChunk, SliceViewChunkSource} from 'neuroglancer/sliceview/frontend';\nimport {SliceView} from 'neuroglancer/sliceview/frontend';\nimport {RenderLayer as GenericSliceViewRenderLayer} from 'neuroglancer/sliceview/renderlayer';\nimport {VectorGraphicsChunkSource as VectorGraphicsChunkSourceInterface, VectorGraphicsChunkSpecification, VectorGraphicsSourceOptions} from 'neuroglancer/sliceview/vector_graphics/base';\nimport {Owned} from 'neuroglancer/util/disposable';\nimport {Buffer} from 'neuroglancer/webgl/buffer';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {ShaderGetter} from 'neuroglancer/webgl/dynamic_shader';\nimport {ShaderBuilder, ShaderProgram} from 'neuroglancer/webgl/shader';\nimport {RpcId} from 'neuroglancer/worker_rpc';\n\nexport abstract class RenderLayer extends GenericSliceViewRenderLayer {\n  sources: VectorGraphicsChunkSource[][];\n  shader: ShaderProgram|undefined = undefined;\n  rpcId: RpcId|null = null;\n  protected shaderGetter: Owned<ShaderGetter>;\n\n  constructor(multiscaleSource: MultiscaleVectorGraphicsChunkSource, {\n    sourceOptions = <VectorGraphicsSourceOptions> {}\n  } = {}) {\n    super(multiscaleSource.chunkManager, multiscaleSource.getSources(sourceOptions), {});\n    this.shaderGetter = this.registerDisposer(new ShaderGetter(\n        this.gl, builder => this.defineShader(builder), () => this.getShaderKey()));\n  }\n\n  protected abstract getShaderKey(): string;\n\n  defineShader(builder: ShaderBuilder) {\n    builder.addFragmentCode(`\nvoid emit(vec4 color) {\n  v4f_fragColor = color;\n}\nvoid emitRGBA(vec4 rgba) {\n  emit(vec4(rgba.rgb, rgba.a * uOpacity));\n}\nvoid emitRGB(vec3 rgb) {\n  emit(vec4(rgb, uOpacity));\n}\nvoid emitGrayscale(float value) {\n  emit(vec4(value, value, value, uOpacity));\n}\nvoid emitTransparent() {\n  emit(vec4(0.0, 0.0, 0.0, 0.0));\n}\n`);\n  }\n\n  beginSlice(_sliceView: SliceView) {\n    let shader = this.shaderGetter.get();\n    if (shader === undefined) {\n      return undefined;\n    }\n    shader.bind();\n    return shader;\n  }\n\n  abstract endSlice(shader: ShaderProgram): void;\n\n  abstract draw(sliceView: SliceView): void;\n}\n\nexport class VectorGraphicsChunk extends SliceViewChunk {\n  source: VectorGraphicsChunkSource;\n  vertexPositions: Float32Array;\n  vertexBuffer: Buffer;\n  numPoints: number;\n\n  constructor(source: VectorGraphicsChunkSource, x: any) {\n    super(source, x);\n    this.vertexPositions = x['vertexPositions'];\n    this.numPoints = Math.floor(this.vertexPositions.length / 3);\n  }\n\n  copyToGPU(gl: GL) {\n    super.copyToGPU(gl);\n    this.vertexBuffer = Buffer.fromData(gl, this.vertexPositions, gl.ARRAY_BUFFER, gl.STATIC_DRAW);\n  }\n\n  freeGPUMemory(gl: GL) {\n    super.freeGPUMemory(gl);\n    this.vertexBuffer.dispose();\n  }\n}\n\nexport class VectorGraphicsChunkSource extends SliceViewChunkSource implements\n    VectorGraphicsChunkSourceInterface {\n  chunks: Map<string, VectorGraphicsChunk>;\n  spec: VectorGraphicsChunkSpecification;\n\n  getChunk(x: any): VectorGraphicsChunk {\n    return new VectorGraphicsChunk(this, x);\n  }\n\n  /**\n   * Specifies whether the point vertex coordinates are specified in units of voxels rather than\n   * nanometers.\n   */\n  get vectorGraphicsCoordinatesInVoxels() {\n    return true;\n  }\n}\n\nexport interface MultiscaleVectorGraphicsChunkSource extends MultiscaleSliceViewChunkSource {\n  /**\n   * @return Chunk sources for each scale, ordered by increasing minVoxelSize.  For each scale,\n   * there may be alternative sources with different chunk layouts.\n   */\n  getSources: (options: VectorGraphicsSourceOptions) => VectorGraphicsChunkSource[][];\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {ChunkState} from 'neuroglancer/chunk_manager/base';\nimport {SliceView} from 'neuroglancer/sliceview/frontend';\nimport {VectorGraphicsSourceOptions} from 'neuroglancer/sliceview/vector_graphics/base';\nimport {MultiscaleVectorGraphicsChunkSource, RenderLayer as GenericVectorGraphicsRenderLayer, VectorGraphicsChunkSource} from 'neuroglancer/sliceview/vector_graphics/frontend';\nimport {TrackableAlphaValue, trackableAlphaValue} from 'neuroglancer/trackable_alpha';\nimport {TrackableFiniteFloat, trackableFiniteFloat} from 'neuroglancer/trackable_finite_float';\nimport {trackableVec3, TrackableVec3} from 'neuroglancer/trackable_vec3';\nimport {mat4, vec3} from 'neuroglancer/util/geom';\nimport {Buffer} from 'neuroglancer/webgl/buffer';\nimport {ShaderBuilder, ShaderProgram} from 'neuroglancer/webgl/shader';\n\nconst tempMat4 = mat4.create();\n\nexport class VectorGraphicsLineRenderLayer extends GenericVectorGraphicsRenderLayer {\n  opacity: TrackableAlphaValue;\n  lineWidth: TrackableFiniteFloat;\n  color: TrackableVec3;\n  private vertexIndexBuffer: Buffer;\n  private normalDirectionBuffer: Buffer;\n\n\n  constructor(multiscaleSource: MultiscaleVectorGraphicsChunkSource, {\n    opacity = trackableAlphaValue(0.5),\n    lineWidth = trackableFiniteFloat(10.0),\n    color = trackableVec3(vec3.fromValues(255.0, 255.0, 255.0)),\n    sourceOptions = <VectorGraphicsSourceOptions>{},\n  } = {}) {\n    super(multiscaleSource, {sourceOptions});\n\n    this.opacity = opacity;\n    this.registerDisposer(opacity.changed.add(() => {\n      this.redrawNeeded.dispatch();\n    }));\n\n    this.lineWidth = lineWidth;\n    this.registerDisposer(lineWidth.changed.add(() => {\n      this.redrawNeeded.dispatch();\n    }));\n\n    this.color = color;\n    this.registerDisposer(color.changed.add(() => {\n      this.redrawNeeded.dispatch();\n    }));\n\n    let gl = this.gl;\n\n    let vertexIndex = new Float32Array([1, 0, 0, 1, 1, 0, 0, 1]);\n\n    this.vertexIndexBuffer =\n        this.registerDisposer(Buffer.fromData(gl, vertexIndex, gl.ARRAY_BUFFER, gl.STATIC_DRAW));\n\n    let normalDirection = new Float32Array([1, 1, -1, -1]);\n\n    this.normalDirectionBuffer = this.registerDisposer(\n        Buffer.fromData(gl, normalDirection, gl.ARRAY_BUFFER, gl.STATIC_DRAW));\n  }\n\n  getShaderKey() {\n    return `vectorgraphics.VectorGraphicsLineRenderLayer`;\n  }\n\n  defineShader(builder: ShaderBuilder) {\n    super.defineShader(builder);\n\n    builder.addUniform('highp float', 'uOpacity');\n    builder.addUniform('highp float', 'ulineWidth');\n    builder.addUniform('highp vec3', 'uColor');\n    builder.addVarying('vec3', 'vNormal');\n\n    builder.addAttribute('highp float', 'aNormalDirection');\n    builder.addAttribute('highp vec2', 'aVertexIndex');\n\n    builder.addAttribute('highp vec3', 'aVertexFirst');\n    builder.addAttribute('highp vec3', 'aVertexSecond');\n    builder.addUniform('highp mat4', 'uProjection');\n\n    builder.setFragmentMain(`\nfloat distance = length(vNormal);\n\nfloat antialiasing = 0.5;\n\nif (distance >= 1.0 - antialiasing) {\n  emitRGBA(vec4(uColor, (distance - 1.0) / -antialiasing ));\n}\nelse if (distance < 1.0 - antialiasing) {\n  emitRGB(uColor);\n}\n`);\n    builder.setVertexMain(`\nvec3 direction = vec3(0., 0., 0.);\ndirection.z = aNormalDirection;\n\nvec3 difference = aVertexSecond - aVertexFirst;\ndifference.z = 0.;\n\nvec3 normal = cross(difference, direction);\nnormal = normalize(normal);\nvNormal = normal;\n\nvec4 delta = vec4(normal * ulineWidth, 0.0);\nvec4 pos = vec4(aVertexFirst * aVertexIndex.x + aVertexSecond * aVertexIndex.y, 1.0);\n\ngl_Position = uProjection * (pos + delta);\n`);\n  }\n\n  beginSlice(_sliceView: SliceView) {\n    super.beginSlice(_sliceView);\n\n    let gl = this.gl;\n    let shader = this.shader!;\n    gl.uniform1f(shader.uniform('uOpacity'), this.opacity.value);\n    gl.uniform1f(shader.uniform('ulineWidth'), this.lineWidth.value);\n    gl.uniform3fv(shader.uniform('uColor'), this.color.value);\n\n    this.vertexIndexBuffer.bindToVertexAttrib(\n        shader.attribute('aVertexIndex'),\n        /*components=*/2);\n\n    this.normalDirectionBuffer.bindToVertexAttrib(\n        shader.attribute('aNormalDirection'),\n        /*components=*/1);\n\n    return shader;\n  }\n\n  endSlice(shader: ShaderProgram) {\n    let gl = this.gl;\n\n    gl.disableVertexAttribArray(shader.attribute('aVertexIndex'));\n    gl.disableVertexAttribArray(shader.attribute('aNormalDirection'));\n\n    gl.disableVertexAttribArray(shader.attribute('aVertexFirst'));\n    gl.disableVertexAttribArray(shader.attribute('aVertexSecond'));\n  }\n\n  draw(sliceView: SliceView) {\n    let visibleSources = sliceView.visibleLayers.get(this)!;\n    if (visibleSources.length === 0) {\n      return;\n    }\n\n    let gl = this.gl;\n\n    let shader = this.beginSlice(sliceView);\n    if (shader === undefined) {\n      console.log('error: shader undefined');\n      return;\n    }\n\n\n    for (let transformedSource of visibleSources) {\n      const chunkLayout = transformedSource.chunkLayout;\n      const source = transformedSource.source as VectorGraphicsChunkSource;\n      let voxelSize = source.spec.voxelSize;\n      let chunks = source.chunks;\n\n      let objectToDataMatrix = tempMat4;\n      mat4.identity(objectToDataMatrix);\n      if (source.vectorGraphicsCoordinatesInVoxels) {\n        mat4.scale(objectToDataMatrix, objectToDataMatrix, voxelSize);\n      }\n      mat4.multiply(objectToDataMatrix, chunkLayout.transform, objectToDataMatrix);\n\n      // Compute projection matrix that transforms vertex coordinates to device coordinates\n      gl.uniformMatrix4fv(\n          shader.uniform('uProjection'), false,\n          mat4.multiply(tempMat4, sliceView.dataToDevice, objectToDataMatrix));\n\n      let visibleChunks = sliceView.visibleChunks.get(chunkLayout);\n      if (!visibleChunks) {\n        continue;\n      }\n\n      for (let key of visibleChunks) {\n        let chunk = chunks.get(key);\n        if (chunk && chunk.state === ChunkState.GPU_MEMORY) {\n          let numInstances = chunk.numPoints / 2;  // Two points == One vector\n\n          const aVertexFirst = shader.attribute('aVertexFirst');\n          chunk.vertexBuffer.bindToVertexAttrib(\n              aVertexFirst,\n              /*components=*/3,\n              /*attributeType=*/WebGL2RenderingContext.FLOAT,\n              /*normalized=*/false,\n              /*stride=*/6 * 4,\n              /*offset=*/0);\n          gl.vertexAttribDivisor(aVertexFirst, 1);\n\n          const aVertexSecond = shader.attribute('aVertexSecond');\n          chunk.vertexBuffer.bindToVertexAttrib(\n              aVertexSecond,\n              /*components=*/3,\n              /*attributeType=*/WebGL2RenderingContext.FLOAT,\n              /*normalized=*/false,\n              /*stride=*/6 * 4,\n              /*offset=*/3 * 4);\n          gl.vertexAttribDivisor(aVertexSecond, 1);\n\n          gl.drawArraysInstanced(gl.TRIANGLE_STRIP, 0, 4, numInstances);\n\n          gl.vertexAttribDivisor(aVertexFirst, 0);\n          gl.vertexAttribDivisor(aVertexSecond, 0);\n        }\n      }\n    }\n    this.endSlice(shader);\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {ChunkLayoutOptions, getChunkDataSizes, getCombinedTransform, getNearIsotropicBlockSize, SliceViewChunkSource, SliceViewChunkSpecification, SliceViewChunkSpecificationBaseOptions, SliceViewChunkSpecificationOptions, SliceViewSourceOptions} from 'neuroglancer/sliceview/base';\nimport {DATA_TYPE_BYTES, DataType} from 'neuroglancer/util/data_type';\nimport {kInfinityVec, kZeroVec, prod3, vec3} from 'neuroglancer/util/geom';\n\nexport {DATA_TYPE_BYTES, DataType};\n\nexport interface RenderLayer {\n  sources: VolumeChunkSource[][]|null;\n}\n\n/**\n * Specifies the interpretation of volumetric data.\n */\nexport enum VolumeType {\n  UNKNOWN,\n  IMAGE,\n  SEGMENTATION,\n}\n\n/**\n * By default, choose a chunk size with at most 2^18 = 262144 voxels.\n */\nexport const DEFAULT_MAX_VOXELS_PER_CHUNK_LOG2 = 18;\n\nexport interface VolumeSourceOptions extends SliceViewSourceOptions {}\n\n/**\n * Common parameters for the VolumeChunkSpecification constructor and\n * VolumeChunkSpecification.getDefaults.\n */\n/**\n * Specifies constructor parameters for VolumeChunkSpecification.\n */\nexport interface VolumeChunkSpecificationBaseOptions extends\n    SliceViewChunkSpecificationBaseOptions {\n  /**\n   * Lower clipping bound (in nanometers), relative to chunkLayout coordinates.  If not specified,\n   * defaults to lowerVoxelBound * voxelSize.\n   *\n   * Both lowerClipBound and upperClipBound are applied during rendering but do not affect which\n   * chunks/voxels are actually retrieved.  That is determined by lowerVoxelBound and\n   * upperVoxelBound.\n   */\n  lowerClipBound?: vec3;\n\n  /**\n   * Upper clipping bound (in nanometers), relative to chunkLayout coordinates.  If not specified,\n   * defaults to upperVoxelBound * voxelSize.\n   */\n  upperClipBound?: vec3;\n\n  /**\n   * If not specified, defaults to (0, 0, 0).  This determines lowerChunkBound.  If this is not a\n   * multiple of chunkDataSize, then voxels at lower positions may still be requested.\n   */\n  lowerVoxelBound?: vec3;\n\n  /**\n   * Upper voxel bound, relative to chunkLayout coordinates.  This determines upperChunkBound.\n   */\n  upperVoxelBound: vec3;\n\n  /**\n   * Specifies offset for use by backend.ts:GenericVolumeChunkSource.computeChunkBounds in\n   * calculating chunk voxel coordinates.  The calculated chunk coordinates will be equal to the\n   * voxel position (in chunkLayout coordinates) plus this value.\n   *\n   * Defaults to kZeroVec if not specified.\n   */\n  baseVoxelOffset?: vec3;\n  numChannels: number;\n  dataType: DataType;\n\n  /**\n   * If set, indicates that the chunk is in compressed segmentation format with the specified block\n   * size.\n   */\n  compressedSegmentationBlockSize?: vec3;\n}\n\nexport interface VolumeChunkSpecificationOptions extends VolumeChunkSpecificationBaseOptions {\n  /**\n   * Chunk size in voxels.\n   */\n  chunkDataSize: vec3;\n}\n\n\nexport interface VolumeChunkSpecificationVolumeSourceOptions {\n  volumeSourceOptions: VolumeSourceOptions;\n}\n\n/**\n * Specifies additional parameters for VolumeChunkSpecification.withDefaultCompression.\n */\nexport interface VolumeChunkSpecificationDefaultCompressionOptions {\n  /**\n   * Volume type.\n   */\n  volumeType: VolumeType;\n  maxCompressedSegmentationBlockSize?: vec3;\n}\n\n/**\n * Specifies parameters for VolumeChunkSpecification.getDefaults.\n */\nexport interface VolumeChunkSpecificationGetDefaultsOptions extends\n    VolumeChunkSpecificationBaseOptions, VolumeChunkSpecificationDefaultCompressionOptions,\n    ChunkLayoutOptions, VolumeChunkSpecificationVolumeSourceOptions {}\n\n/**\n * Specifies a chunk layout and voxel size.\n */\nexport class VolumeChunkSpecification extends SliceViewChunkSpecification {\n  lowerClipBound: vec3;\n  upperClipBound: vec3;\n\n  lowerVoxelBound: vec3;\n  upperVoxelBound: vec3;\n\n  baseVoxelOffset: vec3;\n  chunkDataSize: vec3;\n  numChannels: number;\n  dataType: DataType;\n\n  chunkBytes: number;\n\n  compressedSegmentationBlockSize: vec3|undefined;\n\n  constructor(options: VolumeChunkSpecificationOptions) {\n    let {\n      lowerVoxelBound = kZeroVec,\n      upperVoxelBound,\n      chunkDataSize,\n      voxelSize,\n      transform,\n      baseVoxelOffset = kZeroVec\n    } = options;\n    let {\n      lowerClipBound = vec3.multiply(vec3.create(), voxelSize, lowerVoxelBound),\n      upperClipBound = vec3.multiply(vec3.create(), voxelSize, upperVoxelBound)\n    } = options;\n    const chunkSize = vec3.multiply(vec3.create(), chunkDataSize, voxelSize);\n    let lowerChunkBound = vec3.create();\n    let upperChunkBound = vec3.create();\n    for (let i = 0; i < 3; ++i) {\n      lowerChunkBound[i] = Math.floor(lowerVoxelBound[i] / chunkDataSize[i]);\n      upperChunkBound[i] = Math.floor((upperVoxelBound[i] - 1) / chunkDataSize[i] + 1);\n    }\n    super({voxelSize, transform, lowerChunkBound, upperChunkBound, chunkSize});\n    this.baseVoxelOffset = baseVoxelOffset;\n    this.lowerClipBound = lowerClipBound;\n    this.upperClipBound = upperClipBound;\n    this.lowerVoxelBound = lowerVoxelBound;\n    this.upperVoxelBound = upperVoxelBound;\n    this.chunkDataSize = chunkDataSize;\n\n    let dataType = this.dataType = options.dataType;\n    let numChannels = this.numChannels = options.numChannels;\n\n    this.chunkBytes = prod3(chunkDataSize) * DATA_TYPE_BYTES[dataType] * numChannels;\n\n    this.compressedSegmentationBlockSize = options.compressedSegmentationBlockSize;\n  }\n\n  static make(options: VolumeChunkSpecificationOptions&\n              {volumeSourceOptions: SliceViewSourceOptions}) {\n    return new VolumeChunkSpecification(Object.assign(\n        {}, options,\n        {transform: getCombinedTransform(options.transform, options.volumeSourceOptions)}));\n  }\n\n  static fromObject(msg: any) {\n    return new VolumeChunkSpecification(msg);\n  }\n  toObject(): VolumeChunkSpecificationOptions&SliceViewChunkSpecificationOptions {\n    return {\n      ...super.toObject(),\n      numChannels: this.numChannels,\n      chunkDataSize: this.chunkDataSize,\n      dataType: this.dataType,\n      lowerVoxelBound: this.lowerVoxelBound,\n      upperVoxelBound: this.upperVoxelBound,\n      lowerClipBound: this.lowerClipBound,\n      upperClipBound: this.upperClipBound,\n      baseVoxelOffset: this.baseVoxelOffset,\n      compressedSegmentationBlockSize: this.compressedSegmentationBlockSize,\n    };\n  }\n\n  /**\n   * Returns a VolumeChunkSpecification with default compression specified if suitable for the\n   * volumeType.\n   */\n  static withDefaultCompression(options: VolumeChunkSpecificationDefaultCompressionOptions&\n                                VolumeChunkSpecificationOptions&\n                                VolumeChunkSpecificationVolumeSourceOptions) {\n    let {\n      compressedSegmentationBlockSize,\n      dataType,\n      voxelSize,\n      transform,\n      lowerVoxelBound,\n      upperVoxelBound\n    } = options;\n    transform = getCombinedTransform(transform, options.volumeSourceOptions);\n    if (compressedSegmentationBlockSize === undefined &&\n        options.volumeType === VolumeType.SEGMENTATION &&\n        (dataType === DataType.UINT32 || dataType === DataType.UINT64)) {\n      compressedSegmentationBlockSize = getNearIsotropicBlockSize({\n        numChannels: options.numChannels,\n        voxelSize,\n        transform,\n        lowerVoxelBound,\n        upperVoxelBound,\n        maxVoxelsPerChunkLog2: 9,\n        maxBlockSize: vec3.min(\n            vec3.create(), options.chunkDataSize,\n            options.maxCompressedSegmentationBlockSize || kInfinityVec),\n      });\n    }\n    return new VolumeChunkSpecification(\n        Object.assign({}, options, {compressedSegmentationBlockSize, transform}));\n  }\n\n  static getDefaults(options: VolumeChunkSpecificationGetDefaultsOptions) {\n    const adjustedOptions = Object.assign(\n        {}, options,\n        {transform: getCombinedTransform(options.transform, options.volumeSourceOptions)});\n\n    let {chunkDataSizes = getChunkDataSizes(adjustedOptions)} = options;\n    return chunkDataSizes.map(\n        chunkDataSize => VolumeChunkSpecification.withDefaultCompression(\n            Object.assign({}, options, {chunkDataSize})));\n  }\n}\n\nexport interface VolumeChunkSource extends SliceViewChunkSource {\n  spec: VolumeChunkSpecification;\n}\n\nexport const VOLUME_RPC_ID = 'volume';\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {AnnotationSource} from 'neuroglancer/annotation';\nimport {ChunkManager} from 'neuroglancer/chunk_manager/frontend';\nimport {MeshSource, MultiscaleMeshSource} from 'neuroglancer/mesh/frontend';\nimport {SkeletonSource} from 'neuroglancer/skeleton/frontend';\nimport {DataType} from 'neuroglancer/sliceview/base';\nimport {MultiscaleSliceViewChunkSource, SliceViewChunk, SliceViewChunkSource} from 'neuroglancer/sliceview/frontend';\nimport {VolumeChunkSource as VolumeChunkSourceInterface, VolumeChunkSpecification, VolumeSourceOptions, VolumeType} from 'neuroglancer/sliceview/volume/base';\nimport {Disposable} from 'neuroglancer/util/disposable';\nimport {vec3, vec3Key} from 'neuroglancer/util/geom';\nimport {Uint64} from 'neuroglancer/util/uint64';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {ShaderBuilder, ShaderProgram} from 'neuroglancer/webgl/shader';\n\nexport type VolumeChunkKey = string;\n\nconst tempChunkGridPosition = vec3.create();\nconst tempLocalPosition = vec3.create();\n\n\nexport interface ChunkFormat {\n  shaderKey: string;\n\n  /**\n   * Called on the ChunkFormat of the first source of a RenderLayer.\n   *\n   * This should define a fragment shader function:\n   *\n   *   value_type getDataValue(int channelIndex);\n   *\n   * where value_type is the shader data type corresponding to the chunk data type.  This function\n   * should retrieve the value for channel `channelIndex` at position `getPositionWithinChunk()`\n   * within the chunk.\n   */\n  defineShader: (builder: ShaderBuilder) => void;\n\n  /**\n   * Called once per RenderLayer when starting to draw chunks, on the ChunkFormat of the first\n   * source.  This is not called before each source is drawn.\n   */\n  beginDrawing: (gl: GL, shader: ShaderProgram) => void;\n\n  /**\n   * Called once after all chunks have been drawn, on the ChunkFormat of the first source.\n   */\n  endDrawing: (gl: GL, shader: ShaderProgram) => void;\n\n  /**\n   * Called just before drawing each chunk, on the ChunkFormat .\n   */\n  bindChunk: (gl: GL, shader: ShaderProgram, chunk: SliceViewChunk) => void;\n\n  /**\n   * Called just before drawing chunks for the source.\n   */\n  beginSource: (gl: GL, shader: ShaderProgram) => void;\n}\n\nexport interface ChunkFormatHandler extends Disposable {\n  chunkFormat: ChunkFormat;\n  getChunk(source: SliceViewChunkSource, x: any): SliceViewChunk;\n}\n\nexport type ChunkFormatHandlerFactory = (gl: GL, spec: VolumeChunkSpecification) =>\n    ChunkFormatHandler|null;\n\nvar chunkFormatHandlers = new Array<ChunkFormatHandlerFactory>();\n\nexport function registerChunkFormatHandler(factory: ChunkFormatHandlerFactory) {\n  chunkFormatHandlers.push(factory);\n}\n\nexport function getChunkFormatHandler(gl: GL, spec: VolumeChunkSpecification) {\n  for (let handler of chunkFormatHandlers) {\n    let result = handler(gl, spec);\n    if (result != null) {\n      return result;\n    }\n  }\n  throw new Error('No chunk format handler found.');\n}\n\n\nexport class VolumeChunkSource extends SliceViewChunkSource implements VolumeChunkSourceInterface {\n  chunkFormatHandler: ChunkFormatHandler;\n\n  chunks: Map<string, VolumeChunk>;\n\n  spec: VolumeChunkSpecification;\n\n  constructor(chunkManager: ChunkManager, options: {spec: VolumeChunkSpecification}) {\n    super(chunkManager, options);\n    this.chunkFormatHandler =\n        this.registerDisposer(getChunkFormatHandler(chunkManager.chunkQueueManager.gl, this.spec));\n  }\n\n  get chunkFormat() {\n    return this.chunkFormatHandler.chunkFormat;\n  }\n\n  getValueAt(position: vec3, chunkLayout = this.spec.chunkLayout) {\n    const chunkGridPosition = tempChunkGridPosition;\n    const localPosition = tempLocalPosition;\n    let spec = this.spec;\n    let chunkSize = chunkLayout.size;\n    chunkLayout.globalToLocalSpatial(localPosition, position);\n    for (let i = 0; i < 3; ++i) {\n      const chunkSizeValue = chunkSize[i];\n      const localPositionValue = localPosition[i];\n      chunkGridPosition[i] = Math.floor(localPositionValue / chunkSizeValue);\n    }\n    let key = vec3Key(chunkGridPosition);\n    let chunk = <VolumeChunk>this.chunks.get(key);\n    if (!chunk) {\n      return null;\n    }\n    // Reuse temporary variable.\n    const dataPosition = chunkGridPosition;\n    const voxelSize = spec.voxelSize;\n    for (let i = 0; i < 3; ++i) {\n      dataPosition[i] =\n          Math.floor((localPosition[i] - chunkGridPosition[i] * chunkSize[i]) / voxelSize[i]);\n    }\n    let chunkDataSize = chunk.chunkDataSize;\n    for (let i = 0; i < 3; ++i) {\n      if (dataPosition[i] >= chunkDataSize[i]) {\n        return undefined;\n      }\n    }\n    let {numChannels} = spec;\n    if (numChannels === 1) {\n      return chunk.getChannelValueAt(dataPosition, 0);\n    } else {\n      let result = new Array<number|Uint64>(numChannels);\n      for (let i = 0; i < numChannels; ++i) {\n        result[i] = chunk.getChannelValueAt(dataPosition, i);\n      }\n      return result;\n    }\n  }\n\n  getChunk(x: any): VolumeChunk {\n    return <VolumeChunk>this.chunkFormatHandler.getChunk(this, x);\n  }\n}\n\nexport abstract class VolumeChunk extends SliceViewChunk {\n  source: VolumeChunkSource;\n  chunkDataSize: vec3;\n\n  get chunkFormat() {\n    return this.source.chunkFormat;\n  }\n\n  constructor(source: VolumeChunkSource, x: any) {\n    super(source, x);\n    this.chunkDataSize = x['chunkDataSize'] || source.spec.chunkDataSize;\n  }\n  abstract getChannelValueAt(dataPosition: vec3, channel: number): any;\n}\n\nexport type OptionalMeshSource = MeshSource|SkeletonSource|MultiscaleMeshSource|null;\n\n\nexport interface MultiscaleVolumeChunkSource extends MultiscaleSliceViewChunkSource {\n  /**\n   * @return Chunk sources for each scale, ordered by increasing minVoxelSize.  For each scale,\n   * there may be alternative sources with different chunk layouts.\n   */\n  getSources: (options: VolumeSourceOptions) => VolumeChunkSource[][];\n\n  numChannels: number;\n  dataType: DataType;\n  volumeType: VolumeType;\n\n  /**\n   * Returns the associated mesh source or skeleton source, if there is one.\n   *\n   * This only makes sense if volumeType === VolumeType.SEGMENTATION.\n   */\n  getMeshSource: () => Promise<OptionalMeshSource>| OptionalMeshSource;\n\n  getStaticAnnotations?: () => AnnotationSource;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {SliceView} from 'neuroglancer/sliceview/frontend';\nimport {MultiscaleVolumeChunkSource} from 'neuroglancer/sliceview/volume/frontend';\nimport {RenderLayer, RenderLayerBaseOptions} from 'neuroglancer/sliceview/volume/renderlayer';\nimport {TrackableAlphaValue} from 'neuroglancer/trackable_alpha';\nimport {BLEND_FUNCTIONS, BLEND_MODES, TrackableBlendModeValue} from 'neuroglancer/trackable_blend';\nimport {WatchableValue} from 'neuroglancer/trackable_value';\nimport {glsl_COLORMAPS} from 'neuroglancer/webgl/colormaps';\nimport {makeTrackableFragmentMain, WatchableShaderError} from 'neuroglancer/webgl/dynamic_shader';\nimport {ShaderBuilder, ShaderProgram} from 'neuroglancer/webgl/shader';\nimport {addControlsToBuilder, parseShaderUiControls, setControlsInShader, ShaderControlsParseResult, ShaderControlState} from 'neuroglancer/webgl/shader_ui_controls';\n\nexport const FRAGMENT_MAIN_START = '//NEUROGLANCER_IMAGE_RENDERLAYER_FRAGMENT_MAIN_START';\n\nconst DEFAULT_FRAGMENT_MAIN = `void main() {\n  emitGrayscale(toNormalized(getDataValue()));\n}\n`;\n\nexport function getTrackableFragmentMain(value = DEFAULT_FRAGMENT_MAIN) {\n  return makeTrackableFragmentMain(value);\n}\n\nexport interface ImageRenderLayerOptions extends RenderLayerBaseOptions {\n  shaderError: WatchableShaderError;\n  opacity: TrackableAlphaValue;\n  blendMode: TrackableBlendModeValue;\n  shaderControlState: ShaderControlState;\n}\n\nexport class ImageRenderLayer extends RenderLayer<ShaderControlsParseResult> {\n  opacity: TrackableAlphaValue;\n  blendMode: TrackableBlendModeValue;\n  shaderControlState: ShaderControlState;\n  constructor(multiscaleSource: MultiscaleVolumeChunkSource, options: ImageRenderLayerOptions) {\n    const {opacity, blendMode, shaderControlState} = options;\n    super(multiscaleSource, {\n      ...options,\n      fallbackShaderParameters: new WatchableValue<ShaderControlsParseResult>(\n          parseShaderUiControls(DEFAULT_FRAGMENT_MAIN)),\n      encodeShaderParameters: p => p.source,\n      shaderParameters: shaderControlState.parseResult,\n    });\n    this.shaderControlState = shaderControlState;\n    this.opacity = opacity;\n    this.blendMode = blendMode;\n    this.registerDisposer(opacity.changed.add(this.redrawNeeded.dispatch));\n    this.registerDisposer(blendMode.changed.add(this.redrawNeeded.dispatch));\n    this.registerDisposer(shaderControlState.changed.add(this.redrawNeeded.dispatch));\n  }\n\n  defineShader(builder: ShaderBuilder, shaderParseResult: ShaderControlsParseResult) {\n    if (shaderParseResult.errors.length !== 0) {\n      throw new Error('Invalid UI control specification');\n    }\n    builder.addUniform('highp float', 'uOpacity');\n    builder.addFragmentCode(`\nvoid emitRGBA(vec4 rgba) {\n  emit(vec4(rgba.rgb, rgba.a * uOpacity));\n}\nvoid emitRGB(vec3 rgb) {\n  emit(vec4(rgb, uOpacity));\n}\nvoid emitGrayscale(float value) {\n  emit(vec4(value, value, value, uOpacity));\n}\nvoid emitTransparent() {\n  emit(vec4(0.0, 0.0, 0.0, 0.0));\n}\n`);\n    builder.addFragmentCode(glsl_COLORMAPS);\n    addControlsToBuilder(shaderParseResult.controls, builder);\n    builder.setFragmentMainFunction(FRAGMENT_MAIN_START + '\\n' + shaderParseResult.code);\n  }\n\n  initializeShader(\n      _sliceView: SliceView, shader: ShaderProgram, parameters: ShaderControlsParseResult) {\n    const {gl} = this;\n    gl.uniform1f(shader.uniform('uOpacity'), this.opacity.value);\n    setControlsInShader(gl, shader, this.shaderControlState, parameters.controls);\n  }\n\n  setGLBlendMode(gl: WebGL2RenderingContext, renderLayerNum: number) {\n    const blendModeValue = this.blendMode.value;\n    if (blendModeValue === BLEND_MODES.ADDITIVE || renderLayerNum > 0) {\n      gl.enable(gl.BLEND);\n      BLEND_FUNCTIONS.get(blendModeValue)!(gl);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {ChunkState} from 'neuroglancer/chunk_manager/base';\nimport {getTransformedSources} from 'neuroglancer/sliceview/base';\nimport {BoundingBoxCrossSectionRenderHelper} from 'neuroglancer/sliceview/bounding_box_shader_helper';\nimport {ChunkLayout} from 'neuroglancer/sliceview/chunk_layout';\nimport {SliceView} from 'neuroglancer/sliceview/frontend';\nimport {RenderLayer as SliceViewRenderLayer, RenderLayerOptions as SliceViewRenderLayerOptions} from 'neuroglancer/sliceview/renderlayer';\nimport {VolumeChunkSpecification, VolumeSourceOptions} from 'neuroglancer/sliceview/volume/base';\nimport {ChunkFormat, MultiscaleVolumeChunkSource, VolumeChunkSource} from 'neuroglancer/sliceview/volume/frontend';\nimport {WatchableValueInterface} from 'neuroglancer/trackable_value';\nimport {BoundingBox, mat4, vec3, vec3Key} from 'neuroglancer/util/geom';\nimport {getObjectId} from 'neuroglancer/util/object_id';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {makeWatchableShaderError, ParameterizedContextDependentShaderGetter, parameterizedContextDependentShaderGetter, ParameterizedShaderGetterResult, WatchableShaderError} from 'neuroglancer/webgl/dynamic_shader';\nimport {ShaderBuilder, ShaderProgram} from 'neuroglancer/webgl/shader';\nimport {getShaderType} from 'neuroglancer/webgl/shader_lib';\n\nconst DEBUG_VERTICES = false;\n\n/**\n * Extra amount by which the chunk position computed in the vertex shader is shifted in the\n * direction of the component-wise absolute value of the plane normal.  In Neuroglancer, a\n * cross-section plane exactly on the boundary between two voxels is a common occurrence and is\n * intended to result in the display of the \"next\" (i.e. higher coordinate) plane rather than the\n * \"previous\" (lower coordinate) plane.  However, due to various sources of floating point\n * inaccuracy (in particular, shader code which has relaxed rules), values exactly on the boundary\n * between voxels may be slightly shifted in either direction.  To ensure that this doesn't result\n * in the display of the wrong data (i.e. the previous rather than next plane), we always shift\n * toward the \"next\" plane by this small amount.\n */\nconst CHUNK_POSITION_EPSILON = 1e-3;\n\nexport const glsl_getPositionWithinChunk = `\nhighp ivec3 getPositionWithinChunk () {\n  return ivec3(min(vChunkPosition, uChunkDataSize - 1.0));\n}\n`;\n\n\nconst tempMat4 = mat4.create();\nconst tempVec3 = vec3.create();\n\nclass VolumeSliceVertexComputationManager extends BoundingBoxCrossSectionRenderHelper {\n  static get(gl: GL) {\n    return gl.memoize.get(\n        'volume.VolumeSliceVertexComputationManager',\n        () => new VolumeSliceVertexComputationManager(gl));\n  }\n\n  defineShader(builder: ShaderBuilder) {\n    super.defineShader(builder);\n\n    // A number in [0, 6) specifying which vertex to compute.\n    builder.addAttribute('highp float', 'aVertexIndexFloat');\n\n    // Specifies translation of the current chunk.\n    builder.addUniform('highp vec3', 'uTranslation');\n\n    // Matrix by which computed vertices will be transformed.\n    builder.addUniform('highp mat4', 'uProjectionMatrix');\n\n    // Chunk size in voxels.\n    builder.addUniform('highp vec3', 'uChunkDataSize');\n\n    // Size of a voxel in nanometers.\n    builder.addUniform('highp vec3', 'uVoxelSize');\n\n    builder.addUniform('highp vec3', 'uLowerClipBound');\n    builder.addUniform('highp vec3', 'uUpperClipBound');\n\n    // Position within chunk of vertex, in floating point range [0, chunkDataSize].\n    builder.addVarying('highp vec3', 'vChunkPosition');\n\n    builder.setVertexMain(`\nvec3 chunkSize = uChunkDataSize * uVoxelSize;\nvec3 position = getBoundingBoxPlaneIntersectionVertexPosition(chunkSize, uTranslation, uLowerClipBound, uUpperClipBound, int(aVertexIndexFloat));\ngl_Position = uProjectionMatrix * vec4(position, 1.0);\nvChunkPosition = (position - uTranslation) / uVoxelSize +\n    ${CHUNK_POSITION_EPSILON} * abs(uPlaneNormal);\n`);\n\n    builder.addFragmentCode(glsl_getPositionWithinChunk);\n  }\n\n  computeVerticesDebug(\n      uChunkDataSize: vec3, uVoxelSize: vec3, uLowerClipBound: vec3, uUpperClipBound: vec3,\n      uPlaneDistance: number, uPlaneNormal: vec3, uTranslation: vec3, uProjectionMatrix: mat4) {\n    let chunkSize = vec3.multiply(vec3.create(), uChunkDataSize, uVoxelSize);\n    let gl_Position = vec3.create(), vChunkPosition = vec3.create(),\n        planeNormalAbs = vec3.fromValues(\n            Math.abs(uPlaneNormal[0]), Math.abs(uPlaneNormal[1]), Math.abs(uPlaneNormal[2]));\n    for (let vertexIndex = 0; vertexIndex < 6; ++vertexIndex) {\n      const position = this.computeVertexPositionDebug(\n          chunkSize, uLowerClipBound, uUpperClipBound, uPlaneDistance, uPlaneNormal, uTranslation,\n          vertexIndex);\n      if (position === undefined) {\n        console.log('no intersection found');\n        return;\n      }\n      vec3.transformMat4(gl_Position, position, uProjectionMatrix);\n      vec3.sub(vChunkPosition, position, uTranslation);\n      vec3.divide(vChunkPosition, vChunkPosition, uVoxelSize);\n      vec3.scaleAndAdd(vChunkPosition, vChunkPosition, planeNormalAbs, CHUNK_POSITION_EPSILON);\n      console.log(`vertex ${vertexIndex}, at ${gl_Position}, vChunkPosition = ${vChunkPosition}`);\n    }\n  }\n\n  beginSlice(_gl: GL, shader: ShaderProgram) {\n    let aVertexIndexFloat = shader.attribute('aVertexIndexFloat');\n    this.data.outputVertexIndices.bindToVertexAttrib(aVertexIndexFloat, 1);\n  }\n\n  endSlice(gl: GL, shader: ShaderProgram) {\n    let aVertexIndexFloat = shader.attribute('aVertexIndexFloat');\n    gl.disableVertexAttribArray(aVertexIndexFloat);\n  }\n\n  beginSource(\n      gl: GL, shader: ShaderProgram, sliceView: SliceView, dataToDeviceMatrix: mat4,\n      spec: VolumeChunkSpecification, chunkLayout: ChunkLayout) {\n    this.setViewportPlane(\n        shader, sliceView.viewportAxes[2], sliceView.centerDataPosition, chunkLayout.invTransform);\n\n    // Compute projection matrix that transforms chunk layout coordinates to device coordinates.\n    gl.uniformMatrix4fv(\n        shader.uniform('uProjectionMatrix'), false,\n        mat4.multiply(tempMat4, dataToDeviceMatrix, chunkLayout.transform));\n\n    gl.uniform3fv(shader.uniform('uVoxelSize'), spec.voxelSize);\n    gl.uniform3fv(shader.uniform('uLowerClipBound'), spec.lowerClipBound);\n    gl.uniform3fv(shader.uniform('uUpperClipBound'), spec.upperClipBound);\n    if (DEBUG_VERTICES) {\n      (<any>window)['debug_sliceView_uVoxelSize'] = spec.voxelSize;\n      (<any>window)['debug_sliceView_uLowerClipBound'] = spec.lowerClipBound;\n      (<any>window)['debug_sliceView_uUpperClipBound'] = spec.upperClipBound;\n      (<any>window)['debug_sliceView'] = sliceView;\n      (<any>window)['debug_sliceView_dataToDevice'] = dataToDeviceMatrix;\n    }\n  }\n\n  setupChunkDataSize(gl: GL, shader: ShaderProgram, chunkDataSize: vec3) {\n    gl.uniform3fv(shader.uniform('uChunkDataSize'), chunkDataSize);\n\n    if (DEBUG_VERTICES) {\n      (<any>window)['debug_sliceView_chunkDataSize'] = chunkDataSize;\n    }\n  }\n\n  drawChunk(gl: GL, shader: ShaderProgram, chunkPosition: vec3) {\n    gl.uniform3fv(shader.uniform('uTranslation'), chunkPosition);\n    gl.drawArrays(gl.TRIANGLE_FAN, 0, 6);\n\n    if (DEBUG_VERTICES) {\n      let sliceView: SliceView = (<any>window)['debug_sliceView'];\n      let chunkDataSize: vec3 = (<any>window)['debug_sliceView_chunkDataSize'];\n      let voxelSize: vec3 = (<any>window)['debug_sliceView_uVoxelSize'];\n      let lowerClipBound: vec3 = (<any>window)['debug_sliceView_uLowerClipBound'];\n      let upperClipBound: vec3 = (<any>window)['debug_sliceView_uUpperClipBound'];\n      console.log(\n          `Drawing chunk: ${vec3Key(chunkPosition)} of data size ${vec3Key(chunkDataSize)}`);\n      let dataToDeviceMatrix: mat4 = (<any>window)['debug_sliceView_dataToDevice'];\n      this.computeVerticesDebug(\n          chunkDataSize, voxelSize, lowerClipBound, upperClipBound,\n          sliceView.viewportPlaneDistanceToOrigin, sliceView.viewportAxes[2], chunkPosition,\n          dataToDeviceMatrix);\n    }\n  }\n}\n\nexport interface RenderLayerBaseOptions extends SliceViewRenderLayerOptions {\n  sourceOptions?: VolumeSourceOptions;\n  shaderError?: WatchableShaderError;\n}\n\nexport interface RenderLayerOptions<ShaderParameters> extends RenderLayerBaseOptions {\n  fallbackShaderParameters?: WatchableValueInterface<ShaderParameters>;\n  shaderParameters: WatchableValueInterface<ShaderParameters>;\n  encodeShaderParameters?: (parameters: ShaderParameters) => any;\n}\n\nfunction medianOf3(a: number, b: number, c: number) {\n  return a > b ? (c > a ? a : (b > c ? b : c)) : (c > b ? b : (a > c ? a : c));\n}\n\nexport abstract class RenderLayer<ShaderParameters = any> extends SliceViewRenderLayer {\n  sources: VolumeChunkSource[][];\n  vertexComputationManager: VolumeSliceVertexComputationManager;\n  protected shaderGetter: ParameterizedContextDependentShaderGetter<ChunkFormat, ShaderParameters>;\n  shaderParameters: WatchableValueInterface<ShaderParameters>;\n  constructor(\n      multiscaleSource: MultiscaleVolumeChunkSource,\n      options: RenderLayerOptions<ShaderParameters>) {\n    const {shaderError = makeWatchableShaderError(), shaderParameters} = options;\n    const {sourceOptions = {}} = options;\n    super(multiscaleSource.chunkManager, multiscaleSource.getSources(sourceOptions), options);\n    const {gl} = this;\n    this.shaderParameters = shaderParameters;\n    this.registerDisposer(shaderParameters.changed.add(this.redrawNeeded.dispatch));\n    this.shaderGetter = parameterizedContextDependentShaderGetter(this, gl, {\n      memoizeKey: `volume/RenderLayer:${getObjectId(this.constructor)}`,\n      fallbackParameters: options.fallbackShaderParameters,\n      parameters: shaderParameters,\n      encodeParameters: options.encodeShaderParameters,\n      shaderError,\n      defineShader:\n          (builder: ShaderBuilder, parameters: ShaderParameters, chunkFormat: ChunkFormat) => {\n            this.vertexComputationManager.defineShader(builder);\n            builder.addOutputBuffer('vec4', 'v4f_fragData0', 0);\n            builder.addFragmentCode(`\nvoid emit(vec4 color) {\n  v4f_fragData0 = color;\n}\n`);\n            chunkFormat.defineShader(builder);\n            builder.addFragmentCode(`\n${getShaderType(this.dataType)} getDataValue() { return getDataValue(0); }\n`);\n            this.defineShader(builder, parameters);\n          },\n      getContextKey: context => context.shaderKey,\n    });\n    this.vertexComputationManager = VolumeSliceVertexComputationManager.get(gl);\n\n    const transformedSources = getTransformedSources(this);\n\n    {\n      const {source, chunkLayout} = transformedSources[0][0];\n      const spec = <VolumeChunkSpecification>source.spec;\n\n      const boundingBox = this.boundingBox = new BoundingBox(\n          vec3.fromValues(Infinity, Infinity, Infinity),\n          vec3.fromValues(-Infinity, -Infinity, -Infinity));\n      const globalCorner = vec3.create();\n      const localCorner = tempVec3;\n\n      for (let cornerIndex = 0; cornerIndex < 8; ++cornerIndex) {\n        for (let i = 0; i < 3; ++i) {\n          localCorner[i] = cornerIndex & (1 << i) ? spec.upperClipBound[i] : spec.lowerClipBound[i];\n        }\n        chunkLayout.localSpatialToGlobal(globalCorner, localCorner);\n        vec3.min(boundingBox.lower, boundingBox.lower, globalCorner);\n        vec3.max(boundingBox.upper, boundingBox.upper, globalCorner);\n      }\n    }\n  }\n\n  get dataType() {\n    return this.sources![0][0].spec.dataType;\n  }\n\n  getValueAt(position: vec3) {\n    for (let alternatives of getTransformedSources(this)) {\n      for (let transformedSource of alternatives) {\n        const source = transformedSource.source as VolumeChunkSource;\n        let result = source.getValueAt(position, transformedSource.chunkLayout);\n        if (result != null) {\n          return result;\n        }\n      }\n    }\n    return null;\n  }\n\n\n  beginChunkFormat(sliceView: SliceView, chunkFormat: ChunkFormat):\n      ParameterizedShaderGetterResult<ShaderParameters> {\n    const {gl} = this;\n    const shaderResult = this.shaderGetter(chunkFormat);\n    const {shader, parameters, fallback} = shaderResult;\n    if (shader !== null) {\n      shader.bind();\n      this.vertexComputationManager.beginSlice(gl, shader);\n      this.initializeShader(sliceView, shader, parameters, fallback);\n      chunkFormat.beginDrawing(gl, shader);\n    }\n    return shaderResult;\n  }\n\n  abstract initializeShader(\n      sliceView: SliceView, shader: ShaderProgram, parameters: ShaderParameters,\n      fallback: boolean): void;\n\n  abstract defineShader(builder: ShaderBuilder, parameters: ShaderParameters): void;\n\n  endSlice(_sliceView: SliceView, shader: ShaderProgram, _parameters: ShaderParameters) {\n    const {gl} = this;\n    this.vertexComputationManager.endSlice(gl, shader);\n  }\n\n  draw(sliceView: SliceView) {\n    let visibleSources = sliceView.visibleLayers.get(this)!;\n    if (visibleSources.length === 0) {\n      return;\n    }\n\n    const {gl} = this;\n\n    let chunkPosition = vec3.create();\n    const {renderScaleHistogram, vertexComputationManager} = this;\n\n    if (renderScaleHistogram !== undefined) {\n      renderScaleHistogram.begin(\n          this.chunkManager.chunkQueueManager.frameNumberCounter.frameNumber);\n    }\n\n    let shaderResult: ParameterizedShaderGetterResult<ShaderParameters>;\n    let shader: ShaderProgram|null = null;\n    let prevChunkFormat: ChunkFormat|undefined;\n    const endShader = () => {\n      if (shader === null) return;\n      prevChunkFormat!.endDrawing(gl, shader);\n      this.endSlice(sliceView, shader, shaderResult.parameters);\n    };\n    for (let transformedSource of visibleSources) {\n      const chunkLayout = transformedSource.chunkLayout;\n      const source = transformedSource.source as VolumeChunkSource;\n\n      let originalChunkSize = chunkLayout.size;\n\n      let chunkDataSize: vec3|undefined;\n      let visibleChunks = sliceView.visibleChunks.get(chunkLayout);\n      if (!visibleChunks) {\n        continue;\n      }\n      const chunkFormat = source.chunkFormat;\n      if (chunkFormat !== prevChunkFormat) {\n        prevChunkFormat = chunkFormat;\n        endShader();\n        shaderResult = this.beginChunkFormat(sliceView, chunkFormat);\n        shader = shaderResult.shader;\n      }\n      if (shader === null) continue;\n      const chunks = source.chunks;\n\n      vertexComputationManager.beginSource(\n          gl, shader, sliceView, sliceView.dataToDevice, source.spec, chunkLayout);\n      chunkFormat.beginSource(gl, shader);\n      let presentCount = 0, notPresentCount = 0;\n      for (let key of visibleChunks) {\n        let chunk = chunks.get(key);\n        if (chunk && chunk.state === ChunkState.GPU_MEMORY) {\n          let newChunkDataSize = chunk.chunkDataSize;\n          if (chunkDataSize === undefined || !vec3.equals(chunkDataSize, newChunkDataSize)) {\n            chunkDataSize = newChunkDataSize;\n            vertexComputationManager.setupChunkDataSize(gl, shader, chunkDataSize);\n          }\n          vec3.multiply(chunkPosition, originalChunkSize, chunk.chunkGridPosition);\n          chunkFormat.bindChunk(gl, shader, chunk);\n          vertexComputationManager.drawChunk(gl, shader, chunkPosition);\n          ++presentCount;\n        } else {\n          ++notPresentCount;\n        }\n      }\n\n      if ((presentCount !== 0 || notPresentCount !== 0) && renderScaleHistogram !== undefined) {\n        const {voxelSize} = transformedSource;\n        // TODO(jbms): replace median hack with more accurate estimate, e.g. based on ellipsoid\n        // cross section.\n        const medianVoxelSize = medianOf3(voxelSize[0], voxelSize[1], voxelSize[2]);\n        renderScaleHistogram.add(\n            medianVoxelSize, medianVoxelSize / sliceView.pixelSize, presentCount, notPresentCount);\n      }\n    }\n    endShader();\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {HashMapUint64} from 'neuroglancer/gpu_hash/hash_table';\nimport {GPUHashTable, HashMapShaderManager, HashSetShaderManager} from 'neuroglancer/gpu_hash/shader';\nimport {SegmentColorShaderManager, SegmentStatedColorShaderManager} from 'neuroglancer/segment_color';\nimport {registerRedrawWhenSegmentationDisplayStateChanged, SegmentationDisplayState} from 'neuroglancer/segmentation_display_state/frontend';\nimport {SliceView} from 'neuroglancer/sliceview/frontend';\nimport {MultiscaleVolumeChunkSource} from 'neuroglancer/sliceview/volume/frontend';\nimport {RenderLayer, RenderLayerBaseOptions} from 'neuroglancer/sliceview/volume/renderlayer';\nimport {TrackableAlphaValue} from 'neuroglancer/trackable_alpha';\nimport {TrackableBoolean} from 'neuroglancer/trackable_boolean';\nimport {AggregateWatchableValue, makeCachedDerivedWatchableValue} from 'neuroglancer/trackable_value';\nimport {DisjointUint64Sets} from 'neuroglancer/util/disjoint_sets';\nimport {ShaderBuilder, ShaderProgram} from 'neuroglancer/webgl/shader';\n\nexport class EquivalencesHashMap {\n  generation = Number.NaN;\n  hashMap = new HashMapUint64();\n  constructor(public disjointSets: DisjointUint64Sets) {}\n  update() {\n    let {disjointSets} = this;\n    const {generation} = disjointSets;\n    if (this.generation !== generation) {\n      this.generation = generation;\n      let {hashMap} = this;\n      hashMap.clear();\n      for (let [objectId, minObjectId] of disjointSets.mappings()) {\n        hashMap.set(objectId, minObjectId);\n      }\n    }\n  }\n}\n\nexport interface SliceViewSegmentationDisplayState extends SegmentationDisplayState,\n                                                           RenderLayerBaseOptions {\n  selectedAlpha: TrackableAlphaValue;\n  notSelectedAlpha: TrackableAlphaValue;\n  hideSegmentZero: TrackableBoolean;\n}\n\ninterface ShaderParameters {\n  hasEquivalences: boolean;\n  hasSegmentStatedColors: boolean;\n  hasHighlightedSegments: boolean;\n  hideSegmentZero: boolean;\n}\n\nexport class SegmentationRenderLayer extends RenderLayer<ShaderParameters> {\n  protected segmentColorShaderManager = new SegmentColorShaderManager('segmentColorHash');\n  protected segmentStatedColorShaderManager =\n      new SegmentStatedColorShaderManager('segmentStatedColor');\n  private gpuSegmentStatedColorHashTable =\n      GPUHashTable.get(this.gl, this.displayState.segmentStatedColors.hashTable);\n\n  private hashTableManager = new HashSetShaderManager('visibleSegments');\n  private gpuHashTable = GPUHashTable.get(this.gl, this.displayState.visibleSegments.hashTable);\n  private hashTableManagerHighlighted = new HashSetShaderManager('highlightedSegments');\n  private gpuHashTableHighlighted =\n      GPUHashTable.get(this.gl, this.displayState.highlightedSegments.hashTable);\n\n  private equivalencesShaderManager = new HashMapShaderManager('equivalences');\n  private equivalencesHashMap =\n      new EquivalencesHashMap(this.displayState.segmentEquivalences.disjointSets);\n  private gpuEquivalencesHashTable = GPUHashTable.get(this.gl, this.equivalencesHashMap.hashMap);\n\n  constructor(\n      multiscaleSource: MultiscaleVolumeChunkSource,\n    public displayState: SliceViewSegmentationDisplayState) {\n    super(multiscaleSource, {\n      shaderParameters: new AggregateWatchableValue(\n          refCounted => ({\n            hasEquivalences: refCounted.registerDisposer(makeCachedDerivedWatchableValue(\n                x => x.size !== 0, [displayState.segmentEquivalences])),\n            hasHighlightedSegments: refCounted.registerDisposer(makeCachedDerivedWatchableValue(\n                x => x.size !== 0, [displayState.highlightedSegments])),\n            hasSegmentStatedColors: refCounted.registerDisposer(makeCachedDerivedWatchableValue(\n                x => x.size !== 0, [displayState.segmentStatedColors])),\n            hideSegmentZero: displayState.hideSegmentZero,\n          })),\n      transform: displayState.transform,\n      renderScaleHistogram: displayState.renderScaleHistogram,\n      renderScaleTarget: displayState.renderScaleTarget,\n    });\n    this.registerDisposer(this.shaderParameters as AggregateWatchableValue<ShaderParameters>);\n    registerRedrawWhenSegmentationDisplayStateChanged(displayState, this);\n    this.registerDisposer(displayState.selectedAlpha.changed.add(this.redrawNeeded.dispatch));\n    this.registerDisposer(displayState.notSelectedAlpha.changed.add(this.redrawNeeded.dispatch));\n  }\n\n  defineShader(builder: ShaderBuilder, parameters: ShaderParameters) {\n    this.hashTableManager.defineShader(builder);\n    builder.addFragmentCode(`\nuint64_t getUint64DataValue() {\n  return toUint64(getDataValue());\n}\n`);\n    if (parameters.hasEquivalences) {\n      this.equivalencesShaderManager.defineShader(builder);\n      builder.addFragmentCode(`\nuint64_t getMappedObjectId() {\n  uint64_t value = getUint64DataValue();\n  uint64_t mappedValue;\n  if (${this.equivalencesShaderManager.getFunctionName}(value, mappedValue)) {\n    return mappedValue;\n  }\n  return value;\n}\n`);\n    } else {\n      builder.addFragmentCode(`\nuint64_t getMappedObjectId() {\n  return getUint64DataValue();\n}\n`);\n    }\n    this.segmentColorShaderManager.defineShader(builder);\n    builder.addUniform('highp uvec2', 'uSelectedSegment');\n    builder.addUniform('highp uint', 'uShowAllSegments');\n    builder.addUniform('highp float', 'uSelectedAlpha');\n    builder.addUniform('highp float', 'uNotSelectedAlpha');\n    builder.addUniform('highp float', 'uSaturation');\n    let fragmentMain = `\n  uint64_t value = getMappedObjectId();\n\n  float alpha = uSelectedAlpha;\n  float saturation = uSaturation;\n`;\n    if (parameters.hideSegmentZero) {\n      fragmentMain += `\n  if (value.value[0] == 0u && value.value[1] == 0u) {\n    emit(vec4(vec4(0, 0, 0, 0)));\n    return;\n  }\n`;\n    }\n    fragmentMain += `\n  bool has = uShowAllSegments != 0u ? true : ${this.hashTableManager.hasFunctionName}(value);\n  if (uSelectedSegment == value.value) {\n    saturation = has ? 0.5 : 0.75;\n  } else if (!has) {\n    alpha = uNotSelectedAlpha;\n  }\n`;\n    // If the value has a mapped color, use it; otherwise, compute the color.\n    if (parameters.hasSegmentStatedColors) {\n      this.segmentStatedColorShaderManager.defineShader(builder);\n      fragmentMain += `\n  vec3 rgb;\n  if (!${this.segmentStatedColorShaderManager.getFunctionName}(value, rgb)) {\n    rgb = segmentColorHash(value);\n  }\n`;\n    } else {\n      fragmentMain += `\n  vec3 rgb = segmentColorHash(value);\n`;\n    }\n\n    if (parameters.hasHighlightedSegments) {\n      this.hashTableManagerHighlighted.defineShader(builder);\n      // Override color for all highlighted segments.\n      fragmentMain += `\n  if (${this.hashTableManagerHighlighted.hasFunctionName}(value)) {\n    rgb = vec3(0.2,0.2,2.0);\n    saturation = 1.0;\n  };\n`;\n    }\n\n    fragmentMain += `\n  emit(vec4(mix(vec3(1.0,1.0,1.0), rgb, saturation), alpha));\n`;\n    builder.setFragmentMain(fragmentMain);\n  }\n\n  initializeShader(_sliceView: SliceView, shader: ShaderProgram, parameters: ShaderParameters) {\n    const {gl} = this;\n    const {displayState} = this;\n    const {segmentSelectionState, visibleSegments} = this.displayState;\n    let selectedSegmentLow = 0, selectedSegmentHigh = 0;\n    if (segmentSelectionState.hasSelectedSegment) {\n      let seg = segmentSelectionState.selectedSegment;\n      selectedSegmentLow = seg.low;\n      selectedSegmentHigh = seg.high;\n    }\n    gl.uniform1f(shader.uniform('uSelectedAlpha'), this.displayState.selectedAlpha.value);\n    gl.uniform1f(shader.uniform('uSaturation'), this.displayState.saturation.value);\n    gl.uniform1f(shader.uniform('uNotSelectedAlpha'), this.displayState.notSelectedAlpha.value);\n    gl.uniform2ui(shader.uniform('uSelectedSegment'), selectedSegmentLow, selectedSegmentHigh);\n    gl.uniform1ui(shader.uniform('uShowAllSegments'), visibleSegments.hashTable.size ? 0 : 1);\n    this.hashTableManager.enable(gl, shader, this.gpuHashTable);\n    if (parameters.hasHighlightedSegments) {\n      this.hashTableManagerHighlighted.enable(gl, shader, this.gpuHashTableHighlighted);\n    }\n    if (parameters.hasEquivalences) {\n      this.equivalencesHashMap.update();\n      this.equivalencesShaderManager.enable(gl, shader, this.gpuEquivalencesHashTable);\n    }\n\n    this.segmentColorShaderManager.enable(gl, shader, displayState.segmentColorHash);\n    if (parameters.hasSegmentStatedColors) {\n      this.segmentStatedColorShaderManager.enable(gl, shader, this.gpuSegmentStatedColorHashTable);\n    }\n  }\n  endSlice(sliceView: SliceView, shader: ShaderProgram, parameters: ShaderParameters) {\n    const {gl} = this;\n    this.hashTableManager.disable(gl, shader);\n    if (parameters.hasHighlightedSegments) {\n      this.hashTableManagerHighlighted.disable(gl, shader);\n    }\n    if (parameters.hasEquivalences) {\n      this.equivalencesShaderManager.disable(gl, shader);\n    }\n    if (parameters.hasSegmentStatedColors) {\n      this.segmentStatedColorShaderManager.disable(gl, shader);\n    }\n    super.endSlice(sliceView, shader, parameters);\n  }\n}\n","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport './status.css';\n\nlet statusContainer: HTMLElement|null = null;\n\nexport var DEFAULT_STATUS_DELAY = 200;\n\nexport type Delay = boolean | number;\n\nexport class StatusMessage {\n  element: HTMLElement;\n  private timer: number|null;\n  constructor(delay: Delay = false) {\n    if (statusContainer === null) {\n      statusContainer = document.createElement('ul');\n      statusContainer.id = 'statusContainer';\n      const el: HTMLElement | null = document.getElementById('neuroglancer-container');\n      if (el) {\n        el.appendChild(statusContainer);\n      } else {\n        document.body.appendChild(statusContainer);\n      }\n    }\n    let element = document.createElement('li');\n    this.element = element;\n    if (delay === true) {\n      delay = DEFAULT_STATUS_DELAY;\n    }\n    if (delay !== false) {\n      this.setVisible(false);\n      this.timer = setTimeout(this.setVisible.bind(this, true), delay);\n    } else {\n      this.timer = null;\n    }\n    statusContainer.appendChild(element);\n  }\n  dispose() {\n    statusContainer!.removeChild(this.element);\n    this.element = <any>undefined;\n    if (this.timer !== null) {\n      clearTimeout(this.timer);\n    }\n  }\n  setText(text: string, makeVisible?: boolean) {\n    this.element.textContent = text;\n    if (makeVisible) {\n      this.setVisible(true);\n    }\n  }\n  setHTML(text: string, makeVisible?: boolean) {\n    this.element.innerHTML = text;\n    if (makeVisible) {\n      this.setVisible(true);\n    }\n  }\n  setVisible(value: boolean) {\n    if (this.timer !== null) {\n      clearTimeout(this.timer);\n      this.timer = null;\n    }\n    this.element.style.display = value ? 'block' : 'none';\n  }\n\n  static forPromise<T>(\n      promise: Promise<T>,\n      options: {initialMessage: string, delay?: Delay, errorPrefix: string}): Promise<T> {\n    let status = new StatusMessage(options.delay);\n    status.setText(options.initialMessage);\n    let dispose = status.dispose.bind(status);\n    promise.then(dispose, reason => {\n      let msg: string;\n      if (reason instanceof Error) {\n        msg = reason.message;\n      } else {\n        msg = '' + reason;\n      }\n      let {errorPrefix = ''} = options;\n      status.setErrorMessage(errorPrefix + msg);\n      status.setVisible(true);\n    });\n    return promise;\n  }\n\n  setErrorMessage(message: string) {\n    this.element.textContent = message + ' ';\n    let button = document.createElement('button');\n    button.textContent = 'Dismiss';\n    button.addEventListener('click', () => {\n      this.dispose();\n    });\n    this.element.appendChild(button);\n  }\n\n  static showMessage(message: string): StatusMessage {\n    const msg = new StatusMessage();\n    msg.element.textContent = message;\n    msg.setVisible(true);\n    return msg;\n  }\n\n  static showTemporaryMessage(message: string, closeAfter: number = 2000): StatusMessage {\n    const msg = this.showMessage(message);\n    setTimeout(() => msg.dispose(), closeAfter);\n    return msg;\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Convenience interface for creating TrackableValue instances designed to represent alpha\n * (opacity) values.\n */\n\nimport {TrackableValue} from 'neuroglancer/trackable_value';\nimport {verifyFloat01} from 'neuroglancer/util/json';\n\nexport type TrackableAlphaValue = TrackableValue<number>;\n\nexport function trackableAlphaValue(initialValue = 0.5) {\n  return new TrackableValue<number>(initialValue, verifyFloat01);\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {TrackableEnum} from 'neuroglancer/util/trackable_enum';\n\nexport enum BLEND_MODES {\n  DEFAULT = 0,\n  ADDITIVE = 1\n}\n\nexport const BLEND_FUNCTIONS = new Map([\n  [\n    BLEND_MODES.DEFAULT,\n    (gl: WebGL2RenderingContext) => {\n      gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\n    }\n  ],\n  [\n    BLEND_MODES.ADDITIVE,\n    (gl: WebGL2RenderingContext) => {\n      gl.blendFunc(gl.SRC_ALPHA, gl.ONE);\n    }\n  ]\n]);\n\nexport type TrackableBlendModeValue = TrackableEnum<BLEND_MODES>;\n\nexport function trackableBlendModeValue(initialValue = BLEND_MODES.DEFAULT) {\n  return new TrackableEnum(BLEND_MODES, initialValue);\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport debounce from 'lodash/debounce';\nimport {WatchableValueInterface} from 'neuroglancer/trackable_value';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {Trackable} from 'neuroglancer/util/trackable';\n\nexport class TrackableBoolean implements Trackable {\n  get value() {\n    return this.value_;\n  }\n  set value(newValue: boolean) {\n    if (newValue !== this.value_) {\n      this.value_ = newValue;\n      this.changed.dispatch();\n    }\n  }\n  toggle() {\n    this.value = !this.value;\n  }\n  changed = new NullarySignal();\n  constructor(private value_: boolean, public defaultValue: boolean = value_) {}\n  toJSON() {\n    let {value_} = this;\n    if (value_ === this.defaultValue) {\n      return undefined;\n    }\n    return this.value_;\n  }\n  restoreState(x: any) {\n    if (x === true || x === false) {\n      this.value = x;\n      return;\n    }\n    this.value = this.defaultValue;\n  }\n  reset() {\n    this.value = this.defaultValue;\n  }\n}\n\nexport class TrackableBooleanCheckbox extends RefCounted {\n  element = document.createElement('input');\n  constructor(public model: TrackableBoolean) {\n    super();\n    let {element} = this;\n    element.type = 'checkbox';\n    this.registerDisposer(model.changed.add(() => {\n      this.updateCheckbox();\n    }));\n    this.updateCheckbox();\n    this.registerEventListener(element, 'change', function(this: typeof element, _e: Event) {\n      model.value = this.checked;\n    });\n\n    // Prevent the checkbox from becoming focused.\n    element.addEventListener('mousedown', (event: MouseEvent) => {\n      event.preventDefault();\n    });\n  }\n\n  updateCheckbox() {\n    this.element.checked = this.model.value;\n  }\n\n  disposed() {\n    let {element} = this;\n    let {parentElement} = element;\n    if (parentElement) {\n      parentElement.removeChild(element);\n    }\n    super.disposed();\n  }\n}\n\nexport class ElementVisibilityFromTrackableBoolean extends RefCounted {\n  private initialDisplay = this.element.style.display;\n  constructor(public model: WatchableValueInterface<boolean>, public element: HTMLElement) {\n    super();\n    this.updateVisibility();\n    this.registerDisposer(\n        model.changed.add(this.registerCancellable(debounce(() => this.updateVisibility(), 0))));\n  }\n\n  updateVisibility() {\n    this.element.style.display = this.model.value ? this.initialDisplay : 'none';\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Convenience interface for creating TrackableValue instances designed to represent alpha\n * (opacity) values.\n */\n\nimport {TrackableValue} from 'neuroglancer/trackable_value';\nimport {verifyFiniteFloat} from 'neuroglancer/util/json';\n\nexport type TrackableFiniteFloat = TrackableValue<number>;\n\nexport function trackableFiniteFloat(initialValue = 1.0) {\n  return new TrackableValue<number>(initialValue, verifyFiniteFloat);\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport debounce from 'lodash/debounce';\nimport {Borrowed, Disposer, Owned, RefCounted} from 'neuroglancer/util/disposable';\nimport {NullaryReadonlySignal, NullarySignal} from 'neuroglancer/util/signal';\nimport {Trackable} from 'neuroglancer/util/trackable';\n\nexport interface WatchableValueInterface<T> {\n  value: T;\n  changed: NullaryReadonlySignal;\n}\n\nexport class WatchableValue<T> implements WatchableValueInterface<T> {\n  get value() {\n    return this.value_;\n  }\n  set value(newValue: T) {\n    if (newValue !== this.value_) {\n      this.value_ = newValue;\n      this.changed.dispatch();\n    }\n  }\n  changed = new NullarySignal();\n  constructor(protected value_: T) {}\n}\n\nexport class TrackableValue<T> extends WatchableValue<T> implements Trackable {\n  constructor(value: T, public validator: (value: any) => T, public defaultValue = value) {\n    super(value);\n  }\n  toJSON() {\n    let {value_} = this;\n    if (value_ === this.defaultValue) {\n      return undefined;\n    }\n    return this.value_;\n  }\n  reset() {\n    this.value = this.defaultValue;\n  }\n  restoreState(x: any) {\n    if (x !== undefined) {\n      let {validator} = this;\n      try {\n        this.value = validator(x);\n        return;\n      } catch (ignoredError) {\n      }\n    }\n    this.value = this.defaultValue;\n  }\n}\n\nclass DerivedWatchableValue<U> extends RefCounted implements WatchableValueInterface<U> {\n  changed = new NullarySignal();\n  get value() {\n    return this.f(...this.ws.map(w => w.value));\n  }\n  private f: (...v: any[]) => U;\n  private ws: WatchableValueInterface<any>[];\n\n  constructor(f: (...v: any[]) => U, ws: WatchableValueInterface<any>[]) {\n    super();\n    this.f = f;\n    this.ws = ws;\n    for (const w of ws) {\n      this.registerDisposer(w.changed.add(this.changed.dispatch));\n    }\n  }\n}\n\nexport function makeDerivedWatchableValue<U, T extends any[]>(\n    f: (...v: T) => U, ...ws: {[K in keyof T]: WatchableValueInterface<T[K]>}) {\n  return new DerivedWatchableValue(f, ws);\n}\n\nclass CachedLazyDerivedWatchableValue<U> extends RefCounted implements WatchableValueInterface<U> {\n  changed = new NullarySignal();\n  private value_: U|undefined;\n  private valueGeneration = -1;\n  get value() {\n    const generation = this.changed.count;\n    if (generation !== this.valueGeneration) {\n      this.value_ = this.f(...this.ws.map(w => w.value));\n      this.valueGeneration = generation;\n    }\n    return this.value_ as U;\n  }\n  private f: (...v: any[]) => U;\n  private ws: WatchableValueInterface<any>[];\n\n  constructor(f: (...v: any[]) => U, ws: WatchableValueInterface<any>[]) {\n    super();\n    this.f = f;\n    this.ws = ws;\n    for (const w of ws) {\n      this.registerDisposer(w.changed.add(this.changed.dispatch));\n    }\n  }\n}\n\nexport function makeCachedLazyDerivedWatchableValue<U, T extends any[]>(\n    f: (...v: T) => U, ...ws: {[K in keyof T]: WatchableValueInterface<T[K]>}) {\n  return new CachedLazyDerivedWatchableValue(f, ws);\n}\n\nexport class CachedWatchableValue<T> extends RefCounted implements WatchableValueInterface<T> {\n  changed = new NullarySignal();\n  value: T;\n  constructor(\n      base: WatchableValueInterface<T>, isEqual: (a: T, b: T) => boolean = (a, b) => a === b) {\n    super();\n    this.value = base.value;\n    this.registerDisposer(base.changed.add(() => {\n      const newValue = base.value;\n      if (!isEqual(this.value, newValue)) {\n        this.value = newValue;\n        this.changed.dispatch();\n      }\n    }));\n  }\n}\n\nexport function makeCachedDerivedWatchableValue<U, T extends any[]>(\n    f: (...v: T) => U, ws: {[K in keyof T]: WatchableValueInterface<T[K]>},\n    isEqual?: (a: U, b: U) => boolean) {\n  const derived = new DerivedWatchableValue(f, ws);\n  const cached = new CachedWatchableValue(derived, isEqual);\n  cached.registerDisposer(derived);\n  return cached;\n}\n\nexport class AggregateWatchableValue<T> extends RefCounted implements WatchableValueInterface<T> {\n  changed = new NullarySignal();\n  value: T;\n  constructor(\n      getWatchables: (self: RefCounted) => {[k in keyof T]: WatchableValueInterface<T[k]>}) {\n    super();\n    const watchables = getWatchables(this);\n    const keys = Object.keys(watchables) as (keyof T)[];\n    const updateValue = () => {\n      const obj = {} as T;\n      for (const k of keys) {\n        obj[k] = watchables[k].value;\n      }\n      this.value = obj;\n      this.changed.dispatch();\n    };\n    updateValue();\n    for (const k of keys) {\n      const watchable = watchables[k];\n      // Ensure a unique function is used each time in case the same watchable is assigned to\n      // multiple properties.\n      this.registerDisposer(watchable.changed.add(() => updateValue()));\n    }\n  }\n}\n\nexport class ComputedWatchableValue<U> extends RefCounted implements WatchableValueInterface<U> {\n  get value() {\n    return this.f();\n  }\n  changed = new NullarySignal();\n  constructor(public f: () => U, ...signals: NullarySignal[]) {\n    super();\n    for (const signal of signals) {\n      this.registerDisposer(signal.add(this.changed.dispatch));\n    }\n  }\n}\n\nexport class WatchableRefCounted<T extends RefCounted> extends RefCounted implements\n    WatchableValueInterface<T|undefined> {\n  changed = new NullarySignal();\n\n  private value_: Owned<T>|undefined;\n  private valueHandler: (() => void)|undefined;\n\n  get value(): Borrowed<T>|undefined {\n    return this.value_;\n  }\n\n  set value(value: Owned<T>|undefined) {\n    const {value_} = this;\n    this.value_ = value;\n    if (value_ !== undefined) {\n      value_.dispose();\n      value_.unregisterDisposer(this.valueHandler!);\n      this.valueHandler = undefined;\n    }\n    if (value !== undefined) {\n      const valueHandler = this.valueHandler = () => {\n        if (this.value_ === value) {\n          this.value_ = undefined;\n          this.changed.dispatch();\n        }\n      };\n      value.registerDisposer(valueHandler);\n    }\n\n    if (value !== value_) {\n      this.changed.dispatch();\n    }\n  }\n\n  reset() {\n    this.value = undefined;\n  }\n\n  disposed() {\n    if (this.value_ !== undefined) {\n      this.value_.unregisterDisposer(this.valueHandler!);\n      this.value_.dispose();\n    }\n    this.value_ = undefined;\n    super.disposed();\n  }\n}\n\n\nexport interface TrackableValueInterface<T> extends WatchableValueInterface<T>, Trackable {}\n\nexport class TrackableRefCounted<T extends RefCounted> extends WatchableRefCounted<T> implements\n    TrackableValueInterface<T|undefined> {\n  constructor(\n      public validator: (value: any) => T | undefined, public jsonConverter: (value: T) => any) {\n    super();\n  }\n  toJSON() {\n    const {value} = this;\n    return value && this.jsonConverter(value);\n  }\n\n  restoreState(x: any) {\n    this.value = this.validator(x);\n  }\n}\n\nexport class WatchableSet<T> {\n  changed = new NullarySignal();\n  values: Set<T>;\n  constructor(values?: Iterable<T>) {\n    if (values === undefined) {\n      this.values = new Set();\n    } else {\n      this.values = new Set(values);\n    }\n  }\n  add(x: T) {\n    const {values} = this;\n    if (!values.has(x)) {\n      values.add(x);\n      this.changed.dispatch();\n    }\n    return this;\n  }\n  delete(x: T) {\n    const {values} = this;\n    if (values.delete(x)) {\n      this.changed.dispatch();\n      return true;\n    }\n    return false;\n  }\n  has(x: T) {\n    return this.values.has(x);\n  }\n  get size() {\n    return this.values.size;\n  }\n  [Symbol.iterator]() {\n    return this.values[Symbol.iterator]();\n  }\n  clear() {\n    const {values} = this;\n    if (values.size > 0) {\n      values.clear();\n      this.changed.dispatch();\n    }\n  }\n}\n\nexport function registerNested<T>(\n    baseState: WatchableValueInterface<T>, f: (context: RefCounted, value: T) => void): Disposer {\n  let value: T;\n  let context: RefCounted;\n\n  function updateValue() {\n    value = baseState.value;\n    context = new RefCounted();\n    f(context, value);\n  }\n\n  const handleChange = debounce(() => {\n    if (baseState.value !== value) {\n      context.dispose();\n      updateValue();\n    }\n  }, 0);\n\n  const signalDisposer = baseState.changed.add(handleChange);\n\n  updateValue();\n\n  return () => {\n    handleChange.cancel();\n    signalDisposer();\n    context.dispose();\n  };\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\nimport {vec3} from 'neuroglancer/util/geom';\nimport {verify3dVec} from 'neuroglancer/util/json';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {Trackable} from 'neuroglancer/util/trackable';\n\nexport function trackableVec3(defaultValue = vec3.create()) {\n  return new TrackableVec3(defaultValue, defaultValue);\n}\n\nexport class TrackableVec3 implements Trackable {\n  get value() {\n    return this.value_;\n  }\n  set value(newValue: vec3) {\n    if (newValue !== this.value_) {\n      this.value_ = newValue;\n      this.changed.dispatch();\n    }\n  }\n  changed = new NullarySignal();\n  constructor(private value_: vec3, public defaultValue: vec3) {}\n  toJSON() {\n    let {value_} = this;\n    if (value_ === this.defaultValue) {\n      return undefined;\n    }\n    return this.value_.toString();\n  }\n  restoreState(x: any) {\n    try {\n      this.value = verify3dVec(x.split(','));\n    } catch (e) {\n      this.value = this.defaultValue;\n    }\n  }\n  reset() {\n    this.value = this.defaultValue;\n  }\n}\n","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file User interface for display and editing annotations.\n */\n\nimport './annotations.css';\n\nimport debounce from 'lodash/debounce';\nimport {Annotation, AnnotationReference, AnnotationType, AxisAlignedBoundingBox, Ellipsoid, getAnnotationTypeHandler, Line} from 'neuroglancer/annotation';\nimport {AnnotationLayer, AnnotationLayerState, PerspectiveViewAnnotationLayer, SliceViewAnnotationLayer} from 'neuroglancer/annotation/frontend';\nimport {DataFetchSliceViewRenderLayer, MultiscaleAnnotationSource} from 'neuroglancer/annotation/frontend_source';\nimport {setAnnotationHoverStateFromMouseState} from 'neuroglancer/annotation/selection';\nimport {MouseSelectionState, UserLayer} from 'neuroglancer/layer';\nimport {VoxelSize} from 'neuroglancer/navigation_state';\nimport {SegmentationDisplayState} from 'neuroglancer/segmentation_display_state/frontend';\nimport {TrackableAlphaValue, trackableAlphaValue} from 'neuroglancer/trackable_alpha';\nimport {registerNested, TrackableValueInterface, WatchableRefCounted, WatchableValue} from 'neuroglancer/trackable_value';\nimport {registerTool, Tool} from 'neuroglancer/ui/tool';\nimport {TrackableRGB} from 'neuroglancer/util/color';\nimport {Borrowed, Owned, RefCounted} from 'neuroglancer/util/disposable';\nimport {removeChildren, removeFromParent} from 'neuroglancer/util/dom';\nimport {mat3, mat3FromMat4, mat4, transformVectorByMat4, vec3} from 'neuroglancer/util/geom';\nimport {verifyObject, verifyObjectProperty, verifyOptionalInt, verifyOptionalString, verifyString} from 'neuroglancer/util/json';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {formatBoundingBoxVolume, formatIntegerBounds, formatIntegerPoint, formatLength} from 'neuroglancer/util/spatial_units';\nimport {Uint64} from 'neuroglancer/util/uint64';\nimport {WatchableVisibilityPriority} from 'neuroglancer/visibility_priority/frontend';\nimport {makeCloseButton} from 'neuroglancer/widget/close_button';\nimport {ColorWidget} from 'neuroglancer/widget/color';\nimport {RangeWidget} from 'neuroglancer/widget/range';\nimport {StackView, Tab} from 'neuroglancer/widget/tab_view';\nimport {makeTextIconButton} from 'neuroglancer/widget/text_icon_button';\nimport {Uint64EntryWidget} from 'neuroglancer/widget/uint64_entry_widget';\n\ntype AnnotationIdAndPart = {\n  id: string,\n  partIndex?: number\n};\n\nexport class AnnotationSegmentListWidget extends RefCounted {\n  element = document.createElement('div');\n  private addSegmentWidget = this.registerDisposer(new Uint64EntryWidget());\n  private segmentationState: SegmentationDisplayState|undefined|null;\n  private debouncedUpdateView = debounce(() => this.updateView(), 0);\n  constructor(\n      public reference: Borrowed<AnnotationReference>,\n      public annotationLayer: AnnotationLayerState) {\n    super();\n    this.element.className = 'neuroglancer-annotation-segment-list';\n    const {addSegmentWidget} = this;\n    addSegmentWidget.element.style.display = 'inline-block';\n    addSegmentWidget.element.title = 'Associate segments';\n    this.element.appendChild(addSegmentWidget.element);\n    this.registerDisposer(annotationLayer.segmentationState.changed.add(this.debouncedUpdateView));\n    this.registerDisposer(() => this.unregisterSegmentationState());\n    this.registerDisposer(this.addSegmentWidget.valuesEntered.add(values => {\n      const annotation = this.reference.value;\n      if (annotation == null) {\n        return;\n      }\n      const existingSegments = annotation.segments;\n      const segments = [...(existingSegments || []), ...values];\n      const newAnnotation = {...annotation, segments};\n      this.annotationLayer.source.update(this.reference, newAnnotation);\n      this.annotationLayer.source.commit(this.reference);\n    }));\n    this.registerDisposer(reference.changed.add(this.debouncedUpdateView));\n    this.updateView();\n  }\n\n  private unregisterSegmentationState() {\n    const {segmentationState} = this;\n    if (segmentationState != null) {\n      segmentationState.visibleSegments.changed.remove(this.debouncedUpdateView);\n      segmentationState.segmentColorHash.changed.remove(this.debouncedUpdateView);\n      segmentationState.segmentSelectionState.changed.remove(this.debouncedUpdateView);\n      this.segmentationState = undefined;\n    }\n  }\n\n  private updateView() {\n    const segmentationState = this.annotationLayer.segmentationState.value;\n    if (segmentationState !== this.segmentationState) {\n      this.unregisterSegmentationState();\n      this.segmentationState = segmentationState;\n      if (segmentationState != null) {\n        segmentationState.visibleSegments.changed.add(this.debouncedUpdateView);\n        segmentationState.segmentColorHash.changed.add(this.debouncedUpdateView);\n        segmentationState.segmentSelectionState.changed.add(this.debouncedUpdateView);\n      }\n    }\n\n    const {element} = this;\n    // Remove existing segment representations.\n    for (let child = this.addSegmentWidget.element.nextElementSibling; child !== null;) {\n      const next = child.nextElementSibling;\n      element.removeChild(child);\n      child = next;\n    }\n    element.style.display = 'none';\n    const annotation = this.reference.value;\n    if (annotation == null) {\n      return;\n    }\n    const segments = annotation.segments;\n    if (segmentationState === null) {\n      return;\n    }\n    element.style.display = '';\n    if (segments === undefined || segments.length === 0) {\n      return;\n    }\n    const segmentColorHash = segmentationState ? segmentationState.segmentColorHash : undefined;\n    segments.forEach((segment, index) => {\n      if (index !== 0) {\n        element.appendChild(document.createTextNode(' '));\n      }\n      const child = document.createElement('span');\n      child.title =\n          'Double click to toggle segment visibility, control+click to disassociate segment from annotation.';\n      child.className = 'neuroglancer-annotation-segment-item';\n      child.textContent = segment.toString();\n      if (segmentationState !== undefined) {\n        child.style.backgroundColor = segmentColorHash!.computeCssColor(segment);\n        child.addEventListener('mouseenter', () => {\n          segmentationState.segmentSelectionState.set(segment);\n        });\n        child.addEventListener('mouseleave', () => {\n          segmentationState.segmentSelectionState.set(null);\n        });\n        child.addEventListener('dblclick', (event: MouseEvent) => {\n          if (event.ctrlKey) {\n            return;\n          }\n          if (segmentationState.visibleSegments.has(segment)) {\n            segmentationState.visibleSegments.delete(segment);\n          } else {\n            segmentationState.visibleSegments.add(segment);\n          }\n        });\n      }\n      child.addEventListener('click', (event: MouseEvent) => {\n        if (!event.ctrlKey) {\n          return;\n        }\n        const existingSegments = annotation.segments || [];\n        const newSegments = existingSegments.filter(x => !Uint64.equal(segment, x));\n        const newAnnotation = {...annotation, segments: newSegments ? newSegments : undefined};\n        this.annotationLayer.source.update(this.reference, newAnnotation);\n        this.annotationLayer.source.commit(this.reference);\n      });\n      element.appendChild(child);\n    });\n  }\n}\n\nexport class SelectedAnnotationState extends RefCounted implements\n    TrackableValueInterface<AnnotationIdAndPart|undefined> {\n  private value_: AnnotationIdAndPart|undefined;\n  changed = new NullarySignal();\n\n  private annotationLayer: AnnotationLayerState|undefined;\n  private reference_: Owned<AnnotationReference>|undefined;\n\n  get reference() {\n    return this.reference_;\n  }\n\n  constructor(public annotationLayerState: Owned<WatchableRefCounted<AnnotationLayerState>>) {\n    super();\n    this.registerDisposer(annotationLayerState);\n    this.registerDisposer(annotationLayerState.changed.add(this.validate));\n    this.updateAnnotationLayer();\n    this.reference_ = undefined;\n    this.value_ = undefined;\n  }\n\n  get value() {\n    return this.value_;\n  }\n\n  get validValue() {\n    return this.annotationLayer && this.value_;\n  }\n\n  set value(value: AnnotationIdAndPart|undefined) {\n    this.value_ = value;\n    const reference = this.reference_;\n    if (reference !== undefined) {\n      if (value === undefined || reference.id !== value.id) {\n        this.unbindReference();\n      }\n    }\n    this.validate();\n    this.changed.dispatch();\n  }\n\n  private updateAnnotationLayer() {\n    const annotationLayer = this.annotationLayerState.value;\n    if (annotationLayer === this.annotationLayer) {\n      return false;\n    }\n    this.unbindLayer();\n    this.annotationLayer = annotationLayer;\n    if (annotationLayer !== undefined) {\n      annotationLayer.source.changed.add(this.validate);\n    }\n    return true;\n  }\n\n  private unbindLayer() {\n    if (this.annotationLayer !== undefined) {\n      this.annotationLayer.source.changed.remove(this.validate);\n      this.annotationLayer = undefined;\n    }\n  }\n\n  disposed() {\n    this.unbindLayer();\n    this.unbindReference();\n    super.disposed();\n  }\n\n  private unbindReference() {\n    const reference = this.reference_;\n    if (reference !== undefined) {\n      reference.changed.remove(this.referenceChanged);\n      this.reference_ = undefined;\n    }\n  }\n\n  private referenceChanged = (() => {\n    this.validate();\n    this.changed.dispatch();\n  });\n\n  private validate = (() => {\n    const updatedLayer = this.updateAnnotationLayer();\n    const {annotationLayer} = this;\n    if (annotationLayer !== undefined) {\n      const value = this.value_;\n      if (value !== undefined) {\n        let reference = this.reference_;\n        if (reference !== undefined && reference.id !== value.id) {\n          // Id changed.\n          value.id = reference.id;\n        } else if (reference === undefined) {\n          reference = this.reference_ = annotationLayer.source.getReference(value.id);\n          reference.changed.add(this.referenceChanged);\n        }\n        if (reference.value === null) {\n          this.unbindReference();\n          this.value = undefined;\n          return;\n        }\n      } else {\n        this.unbindReference();\n      }\n    }\n    if (updatedLayer) {\n      this.changed.dispatch();\n    }\n  });\n\n  toJSON() {\n    const value = this.value_;\n    if (value === undefined) {\n      return undefined;\n    }\n    if (value.partIndex === 0) {\n      return value.id;\n    }\n    return value;\n  }\n  reset() {\n    this.value = undefined;\n  }\n  restoreState(x: any) {\n    if (x === undefined) {\n      this.value = undefined;\n      return;\n    }\n    if (typeof x === 'string') {\n      this.value = {'id': x, 'partIndex': 0};\n      return;\n    }\n    verifyObject(x);\n    this.value = {\n      'id': verifyObjectProperty(x, 'id', verifyString),\n      'partIndex': verifyObjectProperty(x, 'partIndex', verifyOptionalInt),\n    };\n  }\n}\n\nconst tempVec3 = vec3.create();\n\nfunction makePointLink(\n    point: vec3, transform: mat4, voxelSize: VoxelSize,\n    setSpatialCoordinates?: (point: vec3) => void) {\n  const spatialPoint = vec3.transformMat4(vec3.create(), point, transform);\n  const positionText = formatIntegerPoint(voxelSize.voxelFromSpatial(tempVec3, spatialPoint));\n  if (setSpatialCoordinates !== undefined) {\n    const element = document.createElement('span');\n    element.className = 'neuroglancer-voxel-coordinates-link';\n    element.textContent = positionText;\n    element.title = `Center view on voxel coordinates ${positionText}.`;\n    element.addEventListener('click', () => {\n      setSpatialCoordinates(spatialPoint);\n    });\n    return element;\n  } else {\n    return document.createTextNode(positionText);\n  }\n}\n\nexport function getPositionSummary(\n    element: HTMLElement, annotation: Annotation, transform: mat4, voxelSize: VoxelSize,\n    setSpatialCoordinates?: (point: vec3) => void) {\n  const makePointLinkWithTransform = (point: vec3) =>\n      makePointLink(point, transform, voxelSize, setSpatialCoordinates);\n\n  switch (annotation.type) {\n    case AnnotationType.AXIS_ALIGNED_BOUNDING_BOX:\n    case AnnotationType.LINE:\n      element.appendChild(makePointLinkWithTransform(annotation.pointA));\n      element.appendChild(document.createTextNode(''));\n      element.appendChild(makePointLinkWithTransform(annotation.pointB));\n      break;\n    case AnnotationType.POINT:\n      element.appendChild(makePointLinkWithTransform(annotation.point));\n      break;\n    case AnnotationType.ELLIPSOID:\n      element.appendChild(makePointLinkWithTransform(annotation.center));\n      const transformedRadii = transformVectorByMat4(tempVec3, annotation.radii, transform);\n      voxelSize.voxelFromSpatial(transformedRadii, transformedRadii);\n      element.appendChild(document.createTextNode('' + formatIntegerBounds(transformedRadii)));\n      break;\n  }\n}\n\nfunction getCenterPosition(annotation: Annotation, transform: mat4) {\n  const center = vec3.create();\n  switch (annotation.type) {\n    case AnnotationType.AXIS_ALIGNED_BOUNDING_BOX:\n    case AnnotationType.LINE:\n      vec3.add(center, annotation.pointA, annotation.pointB);\n      vec3.scale(center, center, 0.5);\n      break;\n    case AnnotationType.POINT:\n      vec3.copy(center, annotation.point);\n      break;\n    case AnnotationType.ELLIPSOID:\n      vec3.copy(center, annotation.center);\n      break;\n  }\n  return vec3.transformMat4(center, center, transform);\n}\n\nexport class AnnotationLayerView extends Tab {\n  private annotationListContainer = document.createElement('ul');\n  private annotationListElements = new Map<string, HTMLElement>();\n  private previousSelectedId: string|undefined;\n  private previousHoverId: string|undefined;\n  private updated = false;\n\n  constructor(\n      public layer: Borrowed<UserLayerWithAnnotations>,\n      public state: Owned<SelectedAnnotationState>,\n      public annotationLayer: Owned<AnnotationLayerState>, public voxelSize: Owned<VoxelSize>,\n      public setSpatialCoordinates: (point: vec3) => void) {\n    super();\n    this.element.classList.add('neuroglancer-annotation-layer-view');\n    this.annotationListContainer.classList.add('neuroglancer-annotation-list');\n    this.registerDisposer(state);\n    this.registerDisposer(voxelSize);\n    this.registerDisposer(annotationLayer);\n    const {source} = annotationLayer;\n    const updateView = () => {\n      this.updated = false;\n      this.updateView();\n    };\n    this.registerDisposer(\n        source.childAdded.add((annotation) => this.addAnnotationElement(annotation)));\n    this.registerDisposer(\n        source.childUpdated.add((annotation) => this.updateAnnotationElement(annotation)));\n    this.registerDisposer(\n        source.childDeleted.add((annotationId) => this.deleteAnnotationElement(annotationId)));\n    this.registerDisposer(this.visibility.changed.add(() => this.updateView()));\n    this.registerDisposer(annotationLayer.transform.changed.add(updateView));\n    this.updateView();\n\n    const toolbox = document.createElement('div');\n    toolbox.className = 'neuroglancer-annotation-toolbox';\n\n    layer.initializeAnnotationLayerViewTab(this);\n\n    {\n      const widget = this.registerDisposer(new RangeWidget(this.annotationLayer.fillOpacity));\n      widget.promptElement.textContent = 'Fill opacity';\n      this.element.appendChild(widget.element);\n    }\n\n    const colorPicker = this.registerDisposer(new ColorWidget(this.annotationLayer.color));\n    colorPicker.element.title = 'Change annotation display color';\n    toolbox.appendChild(colorPicker.element);\n    if (!annotationLayer.source.readonly) {\n      const pointButton = document.createElement('button');\n      pointButton.textContent = getAnnotationTypeHandler(AnnotationType.POINT).icon;\n      pointButton.title = 'Annotate point';\n      pointButton.addEventListener('click', () => {\n        this.layer.tool.value = new PlacePointTool(this.layer, {});\n      });\n      toolbox.appendChild(pointButton);\n\n\n      const boundingBoxButton = document.createElement('button');\n      boundingBoxButton.textContent =\n          getAnnotationTypeHandler(AnnotationType.AXIS_ALIGNED_BOUNDING_BOX).icon;\n      boundingBoxButton.title = 'Annotate bounding box';\n      boundingBoxButton.addEventListener('click', () => {\n        this.layer.tool.value = new PlaceBoundingBoxTool(this.layer, {});\n      });\n      toolbox.appendChild(boundingBoxButton);\n\n\n      const lineButton = document.createElement('button');\n      lineButton.textContent = getAnnotationTypeHandler(AnnotationType.LINE).icon;\n      lineButton.title = 'Annotate line';\n      lineButton.addEventListener('click', () => {\n        this.layer.tool.value = new PlaceLineTool(this.layer, {});\n      });\n      toolbox.appendChild(lineButton);\n\n\n      const ellipsoidButton = document.createElement('button');\n      ellipsoidButton.textContent = getAnnotationTypeHandler(AnnotationType.ELLIPSOID).icon;\n      ellipsoidButton.title = 'Annotate ellipsoid';\n      ellipsoidButton.addEventListener('click', () => {\n        this.layer.tool.value = new PlaceSphereTool(this.layer, {});\n      });\n      toolbox.appendChild(ellipsoidButton);\n    }\n    this.element.appendChild(toolbox);\n\n    this.element.appendChild(this.annotationListContainer);\n\n    this.annotationListContainer.addEventListener('mouseleave', () => {\n      this.annotationLayer.hoverState.value = undefined;\n    });\n    this.registerDisposer(\n        this.annotationLayer.hoverState.changed.add(() => this.updateHoverView()));\n    this.registerDisposer(this.state.changed.add(() => this.updateSelectionView()));\n  }\n\n  private clearSelectionClass() {\n    const {previousSelectedId} = this;\n    if (previousSelectedId !== undefined) {\n      const element = this.annotationListElements.get(previousSelectedId);\n      if (element !== undefined) {\n        element.classList.remove('neuroglancer-annotation-selected');\n      }\n      this.previousSelectedId = undefined;\n    }\n  }\n\n  private clearHoverClass() {\n    const {previousHoverId} = this;\n    if (previousHoverId !== undefined) {\n      const element = this.annotationListElements.get(previousHoverId);\n      if (element !== undefined) {\n        element.classList.remove('neuroglancer-annotation-hover');\n      }\n      this.previousHoverId = undefined;\n    }\n  }\n\n  private updateSelectionView() {\n    const selectedValue = this.state.value;\n    let newSelectedId: string|undefined;\n    if (selectedValue !== undefined) {\n      newSelectedId = selectedValue.id;\n    }\n    const {previousSelectedId} = this;\n    if (newSelectedId === previousSelectedId) {\n      return;\n    }\n    this.clearSelectionClass();\n    if (newSelectedId !== undefined) {\n      const element = this.annotationListElements.get(newSelectedId);\n      if (element !== undefined) {\n        element.classList.add('neuroglancer-annotation-selected');\n        element.scrollIntoView();\n      }\n    }\n    this.previousSelectedId = newSelectedId;\n  }\n\n  private updateHoverView() {\n    const selectedValue = this.annotationLayer.hoverState.value;\n    let newHoverId: string|undefined;\n    if (selectedValue !== undefined) {\n      newHoverId = selectedValue.id;\n    }\n    const {previousHoverId} = this;\n    if (newHoverId === previousHoverId) {\n      return;\n    }\n    this.clearHoverClass();\n    if (newHoverId !== undefined) {\n      const element = this.annotationListElements.get(newHoverId);\n      if (element !== undefined) {\n        element.classList.add('neuroglancer-annotation-hover');\n      }\n    }\n    this.previousHoverId = newHoverId;\n  }\n\n  private addAnnotationElementHelper(annotation: Annotation) {\n    this.annotationListContainer.appendChild(this.makeAnnotationListElement(annotation));\n  }\n\n  private updateView() {\n    if (!this.visible) {\n      return;\n    }\n    if (this.updated) {\n      return;\n    }\n    const {annotationLayer, annotationListContainer, annotationListElements} = this;\n    const {source} = annotationLayer;\n    removeChildren(annotationListContainer);\n    annotationListElements.clear();\n    for (const annotation of source) {\n      this.addAnnotationElementHelper(annotation);\n    }\n    this.resetOnUpdate();\n  }\n\n  private addAnnotationElement(annotation: Annotation) {\n    if (!this.visible) {\n      this.updated = false;\n      return;\n    }\n    if (!this.updated) {\n      this.updateView();\n      return;\n    }\n    this.addAnnotationElementHelper(annotation);\n    this.resetOnUpdate();\n  }\n\n  private updateAnnotationElement(annotation: Annotation) {\n    if (!this.visible) {\n      this.updated = false;\n      return;\n    }\n    if (!this.updated) {\n      this.updateView();\n      return;\n    }\n    const {annotationListElements} = this;\n    const element = annotationListElements.get(annotation.id);\n    if (!element) {\n      return;\n    }\n    const {annotationListContainer} = this;\n    const newElement = this.makeAnnotationListElement(annotation);\n    annotationListContainer.replaceChild(newElement, element);\n    annotationListElements.set(annotation.id, newElement);\n    this.resetOnUpdate();\n  }\n\n  private deleteAnnotationElement(annotationId: string) {\n    if (!this.visible) {\n      this.updated = false;\n      return;\n    }\n    if (!this.updated) {\n      this.updateView();\n      return;\n    }\n    let element = this.annotationListElements.get(annotationId);\n    if (element) {\n      removeFromParent(element);\n      this.annotationListElements.delete(annotationId);\n    }\n    this.resetOnUpdate();\n  }\n\n  private resetOnUpdate() {\n    this.clearHoverClass();\n    this.clearSelectionClass();\n    this.updated = true;\n    this.updateHoverView();\n    this.updateSelectionView();\n  }\n\n  private makeAnnotationListElement(annotation: Annotation) {\n    const transform = this.annotationLayer.objectToGlobal;\n    const element = document.createElement('li');\n    element.title = 'Click to select, right click to recenter view.';\n\n    const icon = document.createElement('div');\n    icon.className = 'neuroglancer-annotation-icon';\n    icon.textContent = getAnnotationTypeHandler(annotation.type).icon;\n    element.appendChild(icon);\n\n    const position = document.createElement('div');\n    position.className = 'neuroglancer-annotation-position';\n    getPositionSummary(position, annotation, transform, this.voxelSize, this.setSpatialCoordinates);\n    element.appendChild(position);\n\n    if (annotation.description) {\n      const description = document.createElement('div');\n      description.className = 'neuroglancer-annotation-description';\n      description.textContent = annotation.description;\n      element.appendChild(description);\n    }\n\n    this.annotationListElements.set(annotation.id, element);\n    element.addEventListener('mouseenter', () => {\n      this.annotationLayer.hoverState.value = {id: annotation.id, partIndex: 0};\n    });\n    element.addEventListener('click', () => {\n      this.state.value = {id: annotation.id, partIndex: 0};\n    });\n\n    element.addEventListener('mouseup', (event: MouseEvent) => {\n      if (event.button === 2) {\n        this.setSpatialCoordinates(\n            getCenterPosition(annotation, this.annotationLayer.objectToGlobal));\n      }\n    });\n\n    return element;\n  }\n}\n\nexport class AnnotationDetailsTab extends Tab {\n  private valid = false;\n  private mouseEntered = false;\n  private hoverState: WatchableValue<{id: string, partIndex?: number}|undefined>|undefined;\n  private segmentListWidget: AnnotationSegmentListWidget|undefined;\n  constructor(\n      public state: Owned<SelectedAnnotationState>, public voxelSize: VoxelSize,\n      public setSpatialCoordinates: (point: vec3) => void) {\n    super();\n    this.element.classList.add('neuroglancer-annotation-details');\n    this.registerDisposer(state);\n    this.registerDisposer(voxelSize);\n    this.registerDisposer(this.state.changed.add(() => {\n      this.valid = false;\n      this.updateView();\n    }));\n    this.registerDisposer(this.visibility.changed.add(() => this.updateView()));\n    this.state.changed.add(() => {\n      this.valid = false;\n      this.updateView();\n    });\n    this.element.addEventListener('mouseenter', () => {\n      this.mouseEntered = true;\n      if (this.hoverState !== undefined) {\n        this.hoverState.value = this.state.value;\n      }\n    });\n    this.element.addEventListener('mouseleave', () => {\n      this.mouseEntered = false;\n      if (this.hoverState !== undefined) {\n        this.hoverState.value = undefined;\n      }\n    });\n    this.updateView();\n  }\n\n  private updateView() {\n    if (!this.visible) {\n      this.element.style.display = 'none';\n      this.hoverState = undefined;\n      return;\n    }\n    this.element.style.display = null;\n    if (this.valid) {\n      return;\n    }\n    const {element} = this;\n    removeChildren(element);\n    this.valid = true;\n    const {reference} = this.state;\n    if (reference === undefined) {\n      return;\n    }\n    const value = this.state.value!;\n    const annotation = reference.value;\n    if (annotation == null) {\n      return;\n    }\n    const annotationLayer = this.state.annotationLayerState.value!;\n    this.hoverState = annotationLayer.hoverState;\n    if (this.mouseEntered) {\n      this.hoverState.value = value;\n    }\n\n    const {objectToGlobal} = annotationLayer;\n    const {voxelSize} = this;\n\n    const handler = getAnnotationTypeHandler(annotation.type);\n\n    const title = document.createElement('div');\n    title.className = 'neuroglancer-annotation-details-title';\n\n    const icon = document.createElement('div');\n    icon.className = 'neuroglancer-annotation-details-icon';\n    icon.textContent = handler.icon;\n\n    const titleText = document.createElement('div');\n    titleText.className = 'neuroglancer-annotation-details-title-text';\n    titleText.textContent = `${handler.description}`;\n    title.appendChild(icon);\n    title.appendChild(titleText);\n\n    if (!annotationLayer.source.readonly) {\n      const deleteButton = makeTextIconButton('', 'Delete annotation');\n      deleteButton.addEventListener('click', () => {\n        const ref = annotationLayer.source.getReference(value.id);\n        try {\n          annotationLayer.source.delete(ref);\n        } finally {\n          ref.dispose();\n        }\n      });\n      title.appendChild(deleteButton);\n    }\n\n    const closeButton = makeCloseButton();\n    closeButton.title = 'Hide annotation details';\n    closeButton.addEventListener('click', () => {\n      this.state.value = undefined;\n    });\n    title.appendChild(closeButton);\n\n    element.appendChild(title);\n\n    const position = document.createElement('div');\n    position.className = 'neuroglancer-annotation-details-position';\n    getPositionSummary(position, annotation, objectToGlobal, voxelSize, this.setSpatialCoordinates);\n    element.appendChild(position);\n\n    if (annotation.type === AnnotationType.AXIS_ALIGNED_BOUNDING_BOX) {\n      const volume = document.createElement('div');\n      volume.className = 'neuroglancer-annotation-details-volume';\n      volume.textContent =\n          formatBoundingBoxVolume(annotation.pointA, annotation.pointB, objectToGlobal);\n      element.appendChild(volume);\n\n      // FIXME: only do this if it is axis aligned\n      const spatialOffset = transformVectorByMat4(\n          tempVec3, vec3.subtract(tempVec3, annotation.pointA, annotation.pointB), objectToGlobal);\n      const voxelVolume = document.createElement('div');\n      voxelVolume.className = 'neuroglancer-annotation-details-volume-in-voxels';\n      const voxelOffset = voxelSize.voxelFromSpatial(tempVec3, spatialOffset);\n      voxelVolume.textContent = `${formatIntegerBounds(voxelOffset)}`;\n      element.appendChild(voxelVolume);\n    } else if (annotation.type === AnnotationType.LINE) {\n      const spatialOffset = transformVectorByMat4(\n          tempVec3, vec3.subtract(tempVec3, annotation.pointA, annotation.pointB), objectToGlobal);\n      const length = document.createElement('div');\n      length.className = 'neuroglancer-annotation-details-length';\n      const spatialLengthText = formatLength(vec3.length(spatialOffset));\n      let voxelLengthText = '';\n      if (voxelSize.valid) {\n        const voxelLength = vec3.length(voxelSize.voxelFromSpatial(tempVec3, spatialOffset));\n        voxelLengthText = `, ${Math.round(voxelLength)} vx`;\n      }\n      length.textContent = spatialLengthText + voxelLengthText;\n      element.appendChild(length);\n    }\n\n    let {segmentListWidget} = this;\n    if (segmentListWidget !== undefined) {\n      if (segmentListWidget.reference !== reference) {\n        segmentListWidget.dispose();\n        this.unregisterDisposer(segmentListWidget);\n        segmentListWidget = this.segmentListWidget = undefined;\n      }\n    }\n    if (segmentListWidget === undefined) {\n      this.segmentListWidget = segmentListWidget =\n          this.registerDisposer(new AnnotationSegmentListWidget(reference, annotationLayer));\n    }\n    element.appendChild(segmentListWidget.element);\n\n    const description = document.createElement('textarea');\n    description.value = annotation.description || '';\n    description.rows = 3;\n    description.className = 'neuroglancer-annotation-details-description';\n    description.placeholder = 'Description';\n    if (annotationLayer.source.readonly) {\n      description.readOnly = true;\n    } else {\n      description.addEventListener('change', () => {\n        const x = description.value;\n        annotationLayer.source.update(reference, {...annotation, description: x ? x : undefined});\n        annotationLayer.source.commit(reference);\n      });\n    }\n    element.appendChild(description);\n  }\n}\n\nexport class AnnotationTab extends Tab {\n  private stack = this.registerDisposer(\n      new StackView<AnnotationLayerState, AnnotationLayerView>(annotationLayerState => {\n        return new AnnotationLayerView(\n            this.layer, this.state.addRef(), annotationLayerState.addRef(), this.voxelSize.addRef(),\n            this.setSpatialCoordinates);\n      }, this.visibility));\n  private detailsTab = this.registerDisposer(\n      new AnnotationDetailsTab(this.state, this.voxelSize.addRef(), this.setSpatialCoordinates));\n  constructor(\n      public layer: Borrowed<UserLayerWithAnnotations>,\n      public state: Owned<SelectedAnnotationState>, public voxelSize: Owned<VoxelSize>,\n      public setSpatialCoordinates: (point: vec3) => void) {\n    super();\n    this.registerDisposer(state);\n    this.registerDisposer(voxelSize);\n    const {element} = this;\n    element.classList.add('neuroglancer-annotations-tab');\n    element.appendChild(this.stack.element);\n    element.appendChild(this.detailsTab.element);\n    const updateDetailsVisibility = () => {\n      this.detailsTab.visibility.value = this.state.validValue !== undefined && this.visible ?\n          WatchableVisibilityPriority.VISIBLE :\n          WatchableVisibilityPriority.IGNORED;\n    };\n    this.registerDisposer(this.state.changed.add(updateDetailsVisibility));\n    this.registerDisposer(this.visibility.changed.add(updateDetailsVisibility));\n    const setAnnotationLayerView = () => {\n      this.stack.selected = this.state.annotationLayerState.value;\n    };\n    this.registerDisposer(this.state.annotationLayerState.changed.add(setAnnotationLayerView));\n    setAnnotationLayerView();\n  }\n}\n\nfunction getSelectedAssocatedSegment(annotationLayer: AnnotationLayerState) {\n  let segments: Uint64[]|undefined;\n  const segmentationState = annotationLayer.segmentationState.value;\n  if (segmentationState != null) {\n    if (segmentationState.segmentSelectionState.hasSelectedSegment) {\n      segments = [segmentationState.segmentSelectionState.selectedSegment.clone()];\n    }\n  }\n  return segments;\n}\n\nabstract class PlaceAnnotationTool extends Tool {\n  group: string;\n  annotationDescription: string|undefined;\n  constructor(public layer: UserLayerWithAnnotations, options: any) {\n    super();\n    if (layer.annotationLayerState === undefined) {\n      throw new Error(`Invalid layer for annotation tool.`);\n    }\n    this.annotationDescription = verifyObjectProperty(options, 'description', verifyOptionalString);\n  }\n\n  get annotationLayer() {\n    return this.layer.annotationLayerState.value;\n  }\n}\n\nconst ANNOTATE_POINT_TOOL_ID = 'annotatePoint';\nconst ANNOTATE_LINE_TOOL_ID = 'annotateLine';\nconst ANNOTATE_BOUNDING_BOX_TOOL_ID = 'annotateBoundingBox';\nconst ANNOTATE_ELLIPSOID_TOOL_ID = 'annotateSphere';\n\nexport class PlacePointTool extends PlaceAnnotationTool {\n  constructor(layer: UserLayerWithAnnotations, options: any) {\n    super(layer, options);\n  }\n\n  trigger(mouseState: MouseSelectionState) {\n    const {annotationLayer} = this;\n    if (annotationLayer === undefined) {\n      // Not yet ready.\n      return;\n    }\n    if (mouseState.active) {\n      const annotation: Annotation = {\n        id: '',\n        description: '',\n        segments: getSelectedAssocatedSegment(annotationLayer),\n        point:\n            vec3.transformMat4(vec3.create(), mouseState.position, annotationLayer.globalToObject),\n        type: AnnotationType.POINT,\n      };\n      const reference = annotationLayer.source.add(annotation, /*commit=*/ true);\n      this.layer.selectedAnnotation.value = {id: reference.id};\n      reference.dispose();\n    }\n  }\n\n  get description() {\n    return `annotate point`;\n  }\n\n  toJSON() {\n    return ANNOTATE_POINT_TOOL_ID;\n  }\n}\n\nfunction getMousePositionInAnnotationCoordinates(\n    mouseState: MouseSelectionState, annotationLayer: AnnotationLayerState) {\n  return vec3.transformMat4(vec3.create(), mouseState.position, annotationLayer.globalToObject);\n}\n\nabstract class TwoStepAnnotationTool extends PlaceAnnotationTool {\n  inProgressAnnotation:\n      {annotationLayer: AnnotationLayerState, reference: AnnotationReference, disposer: () => void}|\n      undefined;\n\n  abstract getInitialAnnotation(\n      mouseState: MouseSelectionState, annotationLayer: AnnotationLayerState): Annotation;\n  abstract getUpdatedAnnotation(\n      oldAnnotation: Annotation, mouseState: MouseSelectionState,\n      annotationLayer: AnnotationLayerState): Annotation;\n\n  trigger(mouseState: MouseSelectionState) {\n    const {annotationLayer} = this;\n    if (annotationLayer === undefined) {\n      // Not yet ready.\n      return;\n    }\n    if (mouseState.active) {\n      const updatePointB = () => {\n        const state = this.inProgressAnnotation!;\n        const reference = state.reference;\n        const newAnnotation =\n            this.getUpdatedAnnotation(reference.value!, mouseState, annotationLayer);\n        state.annotationLayer.source.update(reference, newAnnotation);\n        this.layer.selectedAnnotation.value = {id: reference.id};\n      };\n\n      if (this.inProgressAnnotation === undefined) {\n        const reference = annotationLayer.source.add(\n            this.getInitialAnnotation(mouseState, annotationLayer), /*commit=*/ false);\n        this.layer.selectedAnnotation.value = {id: reference.id};\n        const mouseDisposer = mouseState.changed.add(updatePointB);\n        const disposer = () => {\n          mouseDisposer();\n          reference.dispose();\n        };\n        this.inProgressAnnotation = {\n          annotationLayer,\n          reference,\n          disposer,\n        };\n      } else {\n        updatePointB();\n        this.inProgressAnnotation.annotationLayer.source.commit(\n            this.inProgressAnnotation.reference);\n        this.inProgressAnnotation.disposer();\n        this.inProgressAnnotation = undefined;\n      }\n    }\n  }\n\n  disposed() {\n    this.deactivate();\n    super.disposed();\n  }\n\n  deactivate() {\n    if (this.inProgressAnnotation !== undefined) {\n      this.inProgressAnnotation.annotationLayer.source.delete(this.inProgressAnnotation.reference);\n      this.inProgressAnnotation.disposer();\n      this.inProgressAnnotation = undefined;\n    }\n  }\n}\n\n\nabstract class PlaceTwoCornerAnnotationTool extends TwoStepAnnotationTool {\n  annotationType: AnnotationType.LINE|AnnotationType.AXIS_ALIGNED_BOUNDING_BOX;\n\n  getInitialAnnotation(mouseState: MouseSelectionState, annotationLayer: AnnotationLayerState):\n      Annotation {\n    const point = getMousePositionInAnnotationCoordinates(mouseState, annotationLayer);\n    return <AxisAlignedBoundingBox|Line>{\n      id: '',\n      type: this.annotationType,\n      description: '',\n      pointA: point,\n      pointB: point,\n    };\n  }\n\n  getUpdatedAnnotation(\n      oldAnnotation: AxisAlignedBoundingBox|Line, mouseState: MouseSelectionState,\n      annotationLayer: AnnotationLayerState): Annotation {\n    const point = getMousePositionInAnnotationCoordinates(mouseState, annotationLayer);\n    return {...oldAnnotation, pointB: point};\n  }\n}\n\nexport class PlaceBoundingBoxTool extends PlaceTwoCornerAnnotationTool {\n  get description() {\n    return `annotate bounding box`;\n  }\n\n  toJSON() {\n    return ANNOTATE_BOUNDING_BOX_TOOL_ID;\n  }\n}\nPlaceBoundingBoxTool.prototype.annotationType = AnnotationType.AXIS_ALIGNED_BOUNDING_BOX;\n\nexport class PlaceLineTool extends PlaceTwoCornerAnnotationTool {\n  get description() {\n    return `annotate line`;\n  }\n\n  getInitialAnnotation(mouseState: MouseSelectionState, annotationLayer: AnnotationLayerState):\n      Annotation {\n    const result = super.getInitialAnnotation(mouseState, annotationLayer);\n    result.segments = getSelectedAssocatedSegment(annotationLayer);\n    return result;\n  }\n\n  getUpdatedAnnotation(\n      oldAnnotation: Line|AxisAlignedBoundingBox, mouseState: MouseSelectionState,\n      annotationLayer: AnnotationLayerState) {\n    const result = super.getUpdatedAnnotation(oldAnnotation, mouseState, annotationLayer);\n    const segments = result.segments;\n    if (segments !== undefined && segments.length > 0) {\n      segments.length = 1;\n    }\n    let newSegments = getSelectedAssocatedSegment(annotationLayer);\n    if (newSegments && segments) {\n      newSegments = newSegments.filter(x => segments.findIndex(y => Uint64.equal(x, y)) === -1);\n    }\n    result.segments = [...(segments || []), ...(newSegments || [])] || undefined;\n    return result;\n  }\n\n  toJSON() {\n    return ANNOTATE_LINE_TOOL_ID;\n  }\n}\nPlaceLineTool.prototype.annotationType = AnnotationType.LINE;\n\nclass PlaceSphereTool extends TwoStepAnnotationTool {\n  getInitialAnnotation(mouseState: MouseSelectionState, annotationLayer: AnnotationLayerState):\n      Annotation {\n    const point = getMousePositionInAnnotationCoordinates(mouseState, annotationLayer);\n\n    return <Ellipsoid>{\n      type: AnnotationType.ELLIPSOID,\n      id: '',\n      description: '',\n      segments: getSelectedAssocatedSegment(annotationLayer),\n      center: point,\n      radii: vec3.fromValues(0, 0, 0),\n    };\n  }\n\n  getUpdatedAnnotation(\n      oldAnnotation: Ellipsoid, mouseState: MouseSelectionState,\n      annotationLayer: AnnotationLayerState) {\n    const spatialCenter =\n        vec3.transformMat4(vec3.create(), oldAnnotation.center, annotationLayer.objectToGlobal);\n\n    const radius = vec3.distance(spatialCenter, mouseState.position);\n\n    const tempMatrix = mat3.create();\n    tempMatrix[0] = tempMatrix[4] = tempMatrix[8] = 1 / (radius * radius);\n\n\n    const objectToGlobalLinearTransform =\n        mat3FromMat4(mat3.create(), annotationLayer.objectToGlobal);\n    mat3.multiply(tempMatrix, tempMatrix, objectToGlobalLinearTransform);\n    mat3.transpose(objectToGlobalLinearTransform, objectToGlobalLinearTransform);\n    mat3.multiply(tempMatrix, objectToGlobalLinearTransform, tempMatrix);\n\n    return <Ellipsoid>{\n      ...oldAnnotation,\n      radii: vec3.fromValues(\n          1 / Math.sqrt(tempMatrix[0]), 1 / Math.sqrt(tempMatrix[4]), 1 / Math.sqrt(tempMatrix[8])),\n    };\n  }\n  get description() {\n    return `annotate ellipsoid`;\n  }\n\n  toJSON() {\n    return ANNOTATE_ELLIPSOID_TOOL_ID;\n  }\n}\n\nregisterTool(\n    ANNOTATE_POINT_TOOL_ID,\n    (layer, options) => new PlacePointTool(<UserLayerWithAnnotations>layer, options));\nregisterTool(\n    ANNOTATE_BOUNDING_BOX_TOOL_ID,\n    (layer, options) => new PlaceBoundingBoxTool(<UserLayerWithAnnotations>layer, options));\nregisterTool(\n    ANNOTATE_LINE_TOOL_ID,\n    (layer, options) => new PlaceLineTool(<UserLayerWithAnnotations>layer, options));\nregisterTool(\n    ANNOTATE_ELLIPSOID_TOOL_ID,\n    (layer, options) => new PlaceSphereTool(<UserLayerWithAnnotations>layer, options));\n\nexport interface UserLayerWithAnnotations extends UserLayer {\n  annotationLayerState: WatchableRefCounted<AnnotationLayerState>;\n  selectedAnnotation: SelectedAnnotationState;\n  annotationColor: TrackableRGB;\n  annotationFillOpacity: TrackableAlphaValue;\n  initializeAnnotationLayerViewTab(tab: AnnotationLayerView): void;\n}\n\nexport function getAnnotationRenderOptions(userLayer: UserLayerWithAnnotations) {\n  return {color: userLayer.annotationColor, fillOpacity: userLayer.annotationFillOpacity};\n}\n\nconst SELECTED_ANNOTATION_JSON_KEY = 'selectedAnnotation';\nconst ANNOTATION_COLOR_JSON_KEY = 'annotationColor';\nconst ANNOTATION_FILL_OPACITY_JSON_KEY = 'annotationFillOpacity';\nexport function UserLayerWithAnnotationsMixin<TBase extends {new (...args: any[]): UserLayer}>(\n    Base: TBase) {\n  abstract class C extends Base implements UserLayerWithAnnotations {\n    annotationLayerState = this.registerDisposer(new WatchableRefCounted<AnnotationLayerState>());\n    selectedAnnotation =\n        this.registerDisposer(new SelectedAnnotationState(this.annotationLayerState.addRef()));\n    annotationColor = new TrackableRGB(vec3.fromValues(1, 1, 0));\n    annotationFillOpacity = trackableAlphaValue(0.0);\n\n    constructor(...args: any[]) {\n      super(...args);\n      this.selectedAnnotation.changed.add(this.specificationChanged.dispatch);\n      this.annotationColor.changed.add(this.specificationChanged.dispatch);\n      this.annotationFillOpacity.changed.add(this.specificationChanged.dispatch);\n      this.tabs.add('annotations', {\n        label: 'Annotations',\n        order: 10,\n        getter: () => new AnnotationTab(\n            this, this.selectedAnnotation.addRef(), this.manager.voxelSize.addRef(),\n            point => this.manager.setSpatialCoordinates(point))\n      });\n      this.annotationLayerState.changed.add(() => {\n        const state = this.annotationLayerState.value;\n        if (state !== undefined) {\n          const annotationLayer = new AnnotationLayer(this.manager.chunkManager, state.addRef());\n          setAnnotationHoverStateFromMouseState(state, this.manager.layerSelectedValues.mouseState);\n          this.addRenderLayer(new SliceViewAnnotationLayer(annotationLayer));\n          this.addRenderLayer(new PerspectiveViewAnnotationLayer(annotationLayer.addRef()));\n          if (annotationLayer.source instanceof MultiscaleAnnotationSource) {\n            const dataFetchLayer = this.registerDisposer(\n                new DataFetchSliceViewRenderLayer(annotationLayer.source.addRef()));\n            this.registerDisposer(registerNested(state.filterBySegmentation, (context, value) => {\n              if (!value) {\n                this.addRenderLayer(dataFetchLayer.addRef());\n                context.registerDisposer(() => this.removeRenderLayer(dataFetchLayer));\n              }\n            }));\n          }\n        }\n      });\n    }\n\n    restoreState(specification: any) {\n      super.restoreState(specification);\n      this.selectedAnnotation.restoreState(specification[SELECTED_ANNOTATION_JSON_KEY]);\n      this.annotationColor.restoreState(specification[ANNOTATION_COLOR_JSON_KEY]);\n      this.annotationFillOpacity.restoreState(specification[ANNOTATION_FILL_OPACITY_JSON_KEY]);\n    }\n\n    toJSON() {\n      const x = super.toJSON();\n      x[SELECTED_ANNOTATION_JSON_KEY] = this.selectedAnnotation.toJSON();\n      x[ANNOTATION_COLOR_JSON_KEY] = this.annotationColor.toJSON();\n      x[ANNOTATION_FILL_OPACITY_JSON_KEY] = this.annotationFillOpacity.toJSON();\n      return x;\n    }\n\n    initializeAnnotationLayerViewTab(tab: AnnotationLayerView) {\n      tab;\n    }\n  }\n  return C;\n}\n","// extracted by mini-css-extract-plugin","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {RefCounted, registerEventListener} from 'neuroglancer/util/disposable';\nimport {removeFromParent} from 'neuroglancer/util/dom';\nimport {NullarySignal} from 'neuroglancer/util/signal';\n\nimport './context_menu.css';\n\nexport function positionContextMenu(menu: HTMLElement, event: MouseEvent) {\n  // Set the display to block before checking the offset, or the offset will be\n  // reported as 0 and the context menu wont display correctly when too close to\n  // the right side of the browser window.\n  menu.style.display = 'block';\n  const {offsetWidth, offsetHeight} = menu;\n  const viewportWidth = document.documentElement!.clientWidth;\n  const viewportHeight = document.documentElement!.clientHeight;\n  const posX =\n      document.documentElement!.scrollLeft + Math.min(viewportWidth - offsetWidth, event.clientX);\n  const posY =\n      document.documentElement!.scrollTop + Math.min(viewportHeight - offsetHeight, event.clientY);\n  menu.style.left = posX + 'px';\n  menu.style.top = posY + 'px';\n}\n\nexport class ContextMenu extends RefCounted {\n  element = document.createElement('div');\n  private menuDisposer: (() => void)|undefined;\n  private parentDisposers = new Map<HTMLElement, () => void>();\n  private disabledValue = false;\n  opened = new NullarySignal();\n  closed = new NullarySignal();\n  get disabled () {\n    return this.disabledValue;\n  }\n  set disabled(value: boolean) {\n    if (this.disabledValue !== value) {\n      this.disabledValue = value;\n      if (value) {\n        this.hide();\n      }\n    }\n  }\n  constructor(parent?: HTMLElement) {\n    super();\n    const {element} = this;\n    element.className = 'neuroglancer-context-menu';\n    element.style.display = 'none';\n    element.tabIndex = -1;\n    document.body.appendChild(element);\n    if (parent !== undefined) {\n      this.registerParent(parent);\n    }\n  }\n\n\n  get open () {\n    return this.menuDisposer !== undefined;\n  }\n\n  registerParent(parent: HTMLElement) {\n    const {parentDisposers} = this;\n    if (parentDisposers.has(parent)) {\n      return;\n    }\n    parentDisposers.set(\n        parent, registerEventListener(parent, 'contextmenu', (event: MouseEvent) => {\n          this.show(event);\n          event.stopPropagation();\n          event.preventDefault();\n        }));\n  }\n\n  show(originalEvent: MouseEvent) {\n    if (this.disabledValue) {\n      return;\n    }\n    this.hide();\n    const {element} = this;\n    const mousedownDisposer = registerEventListener(document, 'mousedown', (event: MouseEvent) => {\n      if (event.target instanceof Node && !element.contains(event.target)) {\n        this.hide();\n      }\n    }, /*capture=*/true);\n    const keydownDisposer = registerEventListener(document, 'keydown', (event: KeyboardEvent) => {\n      if (event.code === 'Escape') {\n        this.hide();\n      }\n    }, /*capture=*/true);\n    const menuDisposer = () => {\n      keydownDisposer();\n      mousedownDisposer();\n      element.style.display = 'none';\n    };\n    this.opened.dispatch();\n    positionContextMenu(element, originalEvent);\n    this.menuDisposer = menuDisposer;\n  }\n\n  unregisterParent(parent: HTMLElement) {\n    const {parentDisposers} = this;\n    const disposer = parentDisposers.get(parent);\n    if (disposer !== undefined) {\n      disposer();\n      parentDisposers.delete(parent);\n    }\n  }\n\n  disposed() {\n    const {parentDisposers} = this;\n    for (const disposer of parentDisposers.values()) {\n      disposer();\n    }\n    parentDisposers.clear();\n    removeFromParent(this.element);\n  }\n\n  hide() {\n    if (this.menuDisposer !== undefined) {\n      this.menuDisposer();\n      this.menuDisposer = undefined;\n      this.closed.dispatch();\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {eventHasInputTextTarget} from 'neuroglancer/util/clipboard';\nimport {vec3} from 'neuroglancer/util/geom';\nimport {getCachedJson} from 'neuroglancer/util/trackable';\nimport {Viewer} from 'neuroglancer/viewer';\n\nexport function bindDefaultCopyHandler(viewer: Viewer) {\n  viewer.registerEventListener(document, 'copy', (event: ClipboardEvent) => {\n    if (eventHasInputTextTarget(event)) {\n      return;\n    }\n    const stateJson = getCachedJson(viewer.state).value;\n    const {clipboardData} = event;\n    if (clipboardData !== null) {\n      clipboardData.setData('text/plain', JSON.stringify(stateJson, undefined, '  '));\n    }\n    event.preventDefault();\n  });\n}\n\n/**\n * Checks if s consists of 3 numbers separated by whitespace or commas, with optional parentheses or\n * brackets before and after.\n *\n * @param s The string to parse.\n * @return The parsed vector, or undefined if parsing failed.\n */\nexport function parsePositionString(s: string): vec3|undefined {\n  const match = s.match(\n      /^[\\[\\]{}()\\s,]*(\\d+(?:\\.\\d+)?)[,\\s]+(\\d+(?:\\.\\d+)?)[,\\s]+(\\d+(?:\\.\\d+)?)[\\[\\]{}()\\s,]*$/);\n  if (match !== null) {\n    return vec3.fromValues(parseFloat(match[1]), parseFloat(match[2]), parseFloat(match[3]));\n  }\n  return undefined;\n}\n\nexport function bindDefaultPasteHandler(viewer: Viewer) {\n  viewer.registerEventListener(document, 'paste', (event: ClipboardEvent) => {\n    if (eventHasInputTextTarget(event)) {\n      return;\n    }\n    const {clipboardData} = event;\n    if (clipboardData !== null) {\n      const data = clipboardData.getData('text/plain');\n      const parsedPosition = parsePositionString(data);\n      if (parsedPosition !== undefined) {\n        viewer.navigationState.position.setVoxelCoordinates(parsedPosition);\n      }\n    }\n    event.preventDefault();\n  });\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {EventActionMap} from 'neuroglancer/util/event_action_map';\nimport {InputEventBindings} from 'neuroglancer/viewer';\n\nlet defaultGlobalBindings: EventActionMap|undefined;\n\nexport function getDefaultGlobalBindings() {\n  if (defaultGlobalBindings === undefined) {\n    const map = new EventActionMap();\n    map.set('keyl', 'recolor');\n    map.set('keyx', 'clear-segments');\n    map.set('keys', 'toggle-show-slices');\n    map.set('keyb', 'toggle-scale-bar');\n    map.set('shift+keyb', 'toggle-default-annotations');\n    map.set('keya', 'toggle-axis-lines');\n    map.set('keyo', 'toggle-orthographic-projection');\n\n    for (let i = 1; i <= 9; ++i) {\n      map.set('digit' + i, 'toggle-layer-' + i);\n      map.set('control+digit' + i, 'select-layer-' + i);\n    }\n\n    map.set('keyn', 'add-layer');\n    map.set('keyh', 'help');\n\n    map.set('space', 'toggle-layout');\n    map.set('shift+space', 'toggle-layout-alternative');\n    map.set('backslash', 'toggle-show-statistics');\n    defaultGlobalBindings = map;\n  }\n  return defaultGlobalBindings;\n}\n\nlet defaultRenderedDataPanelBindings: EventActionMap|undefined;\nexport function getDefaultRenderedDataPanelBindings() {\n  if (defaultRenderedDataPanelBindings === undefined) {\n    defaultRenderedDataPanelBindings = EventActionMap.fromObject(\n        {\n          'arrowleft': 'x-',\n          'arrowright': 'x+',\n          'arrowup': 'y-',\n          'arrowdown': 'y+',\n          'comma': 'z-',\n          'period': 'z+',\n          'keyz': 'snap',\n          'control+equal': 'zoom-in',\n          'control+shift+equal': 'zoom-in',\n          'control+minus': 'zoom-out',\n          'keyr': 'rotate-relative-z-',\n          'keye': 'rotate-relative-z+',\n          'shift+arrowdown': 'rotate-relative-x-',\n          'shift+arrowup': 'rotate-relative-x+',\n          'shift+arrowleft': 'rotate-relative-y-',\n          'shift+arrowright': 'rotate-relative-y+',\n          'at:control+wheel': {action: 'zoom-via-wheel', preventDefault: true},\n          'at:wheel': {action: 'z+1-via-wheel', preventDefault: true},\n          'at:shift+wheel': {action: 'z+10-via-wheel', preventDefault: true},\n          'at:dblclick0': 'select',\n          'at:control+mousedown0': 'annotate',\n          'at:mousedown2': 'move-to-mouse-position',\n          'at:control+mousedown2': 'select-annotation',\n          'at:alt+mousedown0': 'move-annotation',\n          'at:control+alt+mousedown2': 'delete-annotation',\n          'at:touchpinch': 'zoom-via-touchpinch',\n          'at:touchrotate': 'rotate-in-plane-via-touchrotate',\n          'at:touchtranslate2': 'translate-in-plane-via-touchtranslate',\n          'at:touchhold1': 'move-to-mouse-position',\n          'at:touchtap1x2': 'select',\n          'at:touchtap2x3': 'snap',\n        },\n        {label: 'All Data Panels'});\n  }\n  return defaultRenderedDataPanelBindings;\n}\n\nlet defaultPerspectivePanelBindings: EventActionMap|undefined;\nexport function getDefaultPerspectivePanelBindings() {\n  if (defaultPerspectivePanelBindings === undefined) {\n    defaultPerspectivePanelBindings = EventActionMap.fromObject(\n        {\n          'at:mousedown0': {action: 'rotate-via-mouse-drag', stopPropagation: true},\n          'at:shift+mousedown0': {action: 'translate-via-mouse-drag', stopPropagation: true},\n          'at:touchtranslate1': 'rotate-out-of-plane-via-touchtranslate',\n        },\n        {parents: [[getDefaultRenderedDataPanelBindings(), Number.NEGATIVE_INFINITY]]});\n  }\n  return defaultPerspectivePanelBindings;\n}\n\nlet defaultSliceViewPanelBindings: EventActionMap|undefined;\nexport function getDefaultSliceViewPanelBindings() {\n  if (defaultSliceViewPanelBindings === undefined) {\n    defaultSliceViewPanelBindings = EventActionMap.fromObject(\n        {\n          'at:mousedown0': {action: 'translate-via-mouse-drag', stopPropagation: true},\n          'at:shift+mousedown0': {action: 'rotate-via-mouse-drag', stopPropagation: true},\n          'at:touchtranslate1': 'translate-z-via-touchtranslate',\n        },\n        {parents: [[getDefaultRenderedDataPanelBindings(), Number.NEGATIVE_INFINITY]]});\n  }\n  return defaultSliceViewPanelBindings;\n}\n\nexport function setDefaultInputEventBindings(inputEventBindings: InputEventBindings) {\n  inputEventBindings.global.addParent(getDefaultGlobalBindings(), Number.NEGATIVE_INFINITY);\n  inputEventBindings.sliceView.addParent(\n      getDefaultSliceViewPanelBindings(), Number.NEGATIVE_INFINITY);\n  inputEventBindings.perspectiveView.addParent(\n      getDefaultPerspectivePanelBindings(), Number.NEGATIVE_INFINITY);\n}\n","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport './default_viewer.css';\n\nimport {ViewerOptions} from 'neuroglancer/viewer';\nimport {disableContextMenu, disableWheel} from 'neuroglancer/ui/disable_default_actions';\nimport {makeMinimalViewer} from './minimal_viewer';\n\nexport function makeDefaultViewer(options?: Partial<ViewerOptions>) {\n  disableContextMenu();\n  disableWheel();\n  return makeMinimalViewer(options);\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {StatusMessage} from 'neuroglancer/status';\nimport {bindDefaultCopyHandler, bindDefaultPasteHandler} from 'neuroglancer/ui/default_clipboard_handling';\nimport {setDefaultInputEventBindings} from 'neuroglancer/ui/default_input_event_bindings';\nimport {makeDefaultViewer} from 'neuroglancer/ui/default_viewer';\nimport {UrlHashBinding} from 'neuroglancer/ui/url_hash_binding';\n\n/**\n * Sets up the default neuroglancer viewer.\n */\nexport function setupDefaultViewer() {\n  let viewer = (<any>window)['viewer'] = makeDefaultViewer();\n  setDefaultInputEventBindings(viewer.inputEventBindings);\n\n  const hashBinding = viewer.registerDisposer(new UrlHashBinding(viewer.state));\n  viewer.registerDisposer(hashBinding.parseError.changed.add(() => {\n    const {value} = hashBinding.parseError;\n    if (value !== undefined) {\n      const status = new StatusMessage();\n      status.setErrorMessage(`Error parsing state: ${value.message}`);\n      console.log('Error parsing state', value);\n    }\n    hashBinding.parseError;\n  }));\n  hashBinding.updateFromUrlHash();\n\n  bindDefaultCopyHandler(viewer);\n  bindDefaultPasteHandler(viewer);\n\n  return viewer;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {registerEventListener} from 'neuroglancer/util/disposable';\n\n/**\n * Prevent context menu on right click, as this interferes with other event handlers for right mouse\n * clicks.\n */\nexport function disableContextMenu() {\n  return registerEventListener(document, 'contextmenu', (e: Event) => {\n    e.preventDefault();\n  });\n}\n\nexport function disableWheel() {\n  return registerEventListener(document, 'wheel', (e: WheelEvent) => {\n    if (e.ctrlKey) {\n      e.preventDefault();\n    }\n  });\n}\n","// extracted by mini-css-extract-plugin","\n/**\n * @license\n * Copyright 2019 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport 'neuroglancer/ui/drag_resize.css';\n\nimport {WatchableValueInterface} from 'neuroglancer/trackable_value';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {removeFromParent} from 'neuroglancer/util/dom';\nimport {startRelativeMouseDrag} from 'neuroglancer/util/mouse_drag';\n\nexport class DragResizablePanel extends RefCounted {\n  gutter = document.createElement('div');\n\n  private sizeProp: 'width'|'height' = this.direction === 'horizontal' ? 'width' : 'height';\n\n  constructor(\n      public element: HTMLElement, public visible: WatchableValueInterface<boolean>,\n      public size: WatchableValueInterface<number>, public direction: 'horizontal'|'vertical',\n      public minSize = 0) {\n    super();\n    const {gutter} = this;\n    gutter.className = `neuroglancer-resize-gutter-${direction}`;\n    element.insertAdjacentElement('beforebegin', gutter);\n    this.registerDisposer(visible.changed.add(() => this.updateView()));\n    this.registerDisposer(size.changed.add(() => this.updateView()));\n    const dragStart = (event: MouseEvent) => {\n      if ('button' in event && event.button !== 0) {\n        return;\n      }\n      event.preventDefault();\n      // Get initial size\n      const initialRect = element.getBoundingClientRect();\n      let size = initialRect[this.sizeProp];\n      const visibleCutoff = this.minSize / 2;\n      startRelativeMouseDrag(event, (_event, deltaX: number, deltaY: number) => {\n        size -= (direction === 'horizontal' ? deltaX : deltaY);\n        if (size < visibleCutoff) {\n          this.visible.value = false;\n        } else if (this.visible.value === false && size > visibleCutoff) {\n          this.visible.value = true;\n        }\n        this.size.value = Math.max(this.minSize, size);\n      });\n    };\n    this.registerEventListener(gutter, 'pointerdown', dragStart);\n    this.updateView();\n  }\n\n  private updateView() {\n    const {element, gutter} = this;\n    const {visible} = this;\n    if (!visible.value) {\n      element.style.display = 'none';\n      gutter.style.display = 'none';\n      return;\n    }\n    element.style.display = '';\n    gutter.style.display = '';\n    element.style[this.sizeProp] = Math.max(this.minSize, this.size.value) + 'px';\n  }\n\n  disposed() {\n    removeFromParent(this.gutter);\n    super.disposed();\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {LayerListSpecification, ManagedUserLayerWithSpecification} from 'neuroglancer/layer_specification';\nimport {Borrowed, Owned} from 'neuroglancer/util/disposable';\nimport {decodeParametersFromDragTypeList, DragInfo, encodeParametersAsDragType, setDropEffect} from 'neuroglancer/util/drag_and_drop';\nimport {parseArray, verifyBoolean, verifyObjectProperty, verifyString} from 'neuroglancer/util/json';\n\nconst layerDragTypePrefix = 'neuroglancer-layer\\0';\n\nexport interface LayerDragSourceInfo {\n  manager: Owned<LayerListSpecification>;\n  layers: Owned<ManagedUserLayerWithSpecification>[];\n  layoutSpec: any;\n}\n\ninterface LayerDragSourceData extends LayerDragSourceInfo {\n  disposer: () => void;\n}\n\nlet dragSource: LayerDragSourceData|undefined;\n\nexport function startLayerDrag(event: DragEvent, sourceInfo: LayerDragSourceInfo) {\n  event.dataTransfer!.setData(\n      encodeParametersAsDragType(\n          layerDragTypePrefix,\n          sourceInfo.layers.map(layer => ({name: layer.name, visible: layer.visible}))),\n      JSON.stringify(\n          {layers: sourceInfo.layers.map(layer => layer.toJSON()), layout: sourceInfo.layoutSpec}));\n  if (dragSource !== undefined) {\n    dragSource.disposer();\n  }\n  let newDragSource: LayerDragSourceData;\n  let disposer = () => {\n    sourceInfo.manager.unregisterDisposer(disposer);\n    for (const layer of sourceInfo.layers) {\n      layer.dispose();\n    }\n    sourceInfo.manager.dispose();\n    if (dragSource === newDragSource) {\n      dragSource = undefined;\n    }\n  };\n  dragSource = newDragSource = {\n    manager: sourceInfo.manager.addRef(),\n    layers: sourceInfo.layers.map(x => x.addRef()),\n    layoutSpec: sourceInfo.layoutSpec,\n    disposer,\n  };\n}\n\nexport function endLayerDrag(event?: DragEvent) {\n  if (dragSource !== undefined) {\n    if (event && event.dataTransfer!.dropEffect === 'move') {\n      const removedLayers = new Set(dragSource.layers);\n      dragSource.manager.layerManager.filter(\n          (x: ManagedUserLayerWithSpecification) => !removedLayers.has(x));\n    }\n    dragSource.disposer();\n  }\n}\n\n\nexport function getLayerDragInfo(event: DragEvent): DragInfo|undefined {\n  return decodeParametersFromDragTypeList(event.dataTransfer!.types, layerDragTypePrefix);\n}\n\nfunction getCompatibleDragSource(manager: Borrowed<LayerListSpecification>): LayerDragSourceInfo|undefined {\n  if (dragSource !== undefined && dragSource.manager.rootLayers === manager.rootLayers) {\n    return dragSource;\n  }\n  return undefined;\n}\n\nexport class DropLayers {\n  dragType: string|undefined;\n\n  sourceManager: Borrowed<LayerListSpecification>|undefined;\n\n  moveSupported: boolean;\n\n  manager: Borrowed<LayerListSpecification>;\n\n  // Maps each layer to its index in the specification.\n  layers: Map<Owned<ManagedUserLayerWithSpecification>, number>;\n\n  numSourceLayers: number;\n\n  // LayerGroupViewer layout specification associated with these layers.  Only used if the drop\n  // operation creates a new layer group viewer.\n  layoutSpec: any;\n\n  /**\n   * Called in the 'drop' event handler to actually initialize the layers if they are external.\n   * Returns false if any layers failed to initialized.\n   */\n  finalize(event: DragEvent): boolean {\n    const {dragType} = this;\n    if (dragType !== undefined) {\n      try {\n        const {layers: spec, layout} = JSON.parse(event.dataTransfer!.getData(dragType));\n        if (!Array.isArray(spec) || this.numSourceLayers !== spec.length) {\n          throw new Error('Invalid layer drop data');\n        }\n        this.layoutSpec = layout;\n        for (const [layer, index] of this.layers) {\n          this.manager.initializeLayerFromSpec(layer, spec[index]);\n        }\n        return true;\n      } catch {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  get method () {\n    if (this.sourceManager !== undefined) {\n      if (this.manager === this.sourceManager) {\n        return 'move';\n      } else {\n        return 'link';\n      }\n    } else {\n      return 'copy';\n    }\n  }\n\n  compatibleWithMethod(otherMethod: string) {\n    if (this.method === otherMethod) {\n      return true;\n    }\n    if (!this.moveSupported && otherMethod === 'move') {\n      return true;\n    }\n    return false;\n  }\n}\n\nexport function getDefaultLayerDropEfect(manager: Borrowed<LayerListSpecification>, newTarget = false) {\n  const source = getCompatibleDragSource(manager);\n  if (source === undefined) {\n    return 'copy';\n  }\n  if (!newTarget && source.manager === manager) {\n    return 'move';\n  }\n  return 'link';\n}\n\nexport function getLayerDropEffect(\n    event: DragEvent, manager: Borrowed<LayerListSpecification>, newTarget = false): 'move'|'copy'|\n    'link' {\n  if (event.shiftKey) {\n    return 'copy';\n  } else if (event.ctrlKey) {\n    return 'move';\n  } else {\n    return getDefaultLayerDropEfect(manager, newTarget);\n  }\n}\n\nexport function updateLayerDropEffect(\n    event: DragEvent, manager: Borrowed<LayerListSpecification>, newTarget = false): 'move'|'copy'|\n    'link' {\n  return setDropEffect(event, getLayerDropEffect(event, manager, newTarget));\n}\n\nexport function getDropLayers(\n    event: DragEvent, manager: Borrowed<LayerListSpecification>, forceCopy: boolean,\n    allowMove: boolean, newTarget: boolean): DropLayers|undefined {\n  const source = getCompatibleDragSource(manager);\n  const moveSupported = !newTarget && source !== undefined && source.manager === manager;\n  if (!forceCopy) {\n    if (source !== undefined) {\n      const result = new DropLayers();\n      result.manager = manager;\n      result.numSourceLayers = source.layers.length;\n      result.sourceManager = source.manager;\n      result.moveSupported = moveSupported;\n      result.layers = new Map();\n      result.layoutSpec = source.layoutSpec;\n      if (!newTarget && source.manager === manager) {\n        if (allowMove) {\n          source.layers.forEach((layer, index) => {\n            result.layers.set(layer, index);\n          });\n        } else {\n          return undefined;\n        }\n      }\n      source.layers.forEach((layer, index) => {\n        if (newTarget || !manager.layerManager.has(layer)) {\n          result.layers.set(layer.addRef(), index);\n        }\n      });\n      return result;\n    }\n  }\n  const info = getLayerDragInfo(event);\n  if (info !== undefined) {\n    try {\n      const layers = parseArray(info.parameters, (layerInfo, index) => {\n        const name = verifyObjectProperty(layerInfo, 'name', verifyString);\n        const visible = verifyObjectProperty(layerInfo, 'visible', verifyBoolean);\n        const newLayer = new ManagedUserLayerWithSpecification(name, null, manager);\n        newLayer.visible = visible;\n        return <[ManagedUserLayerWithSpecification, number]>[newLayer, index];\n      });\n      const result = new DropLayers();\n      result.numSourceLayers = layers.length;\n      result.moveSupported = moveSupported;\n      result.manager = manager;\n      result.dragType = info.dragType;\n      result.layers = new Map(layers);\n      return result;\n    } catch {\n    }\n  }\n  return undefined;\n}\n","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Side panel for displaying/editing layer details.\n */\n\nimport 'neuroglancer/ui/layer_side_panel.css';\n\nimport {LayerManager, ManagedUserLayer, SelectedLayerState, UserLayer} from 'neuroglancer/layer';\nimport {Borrowed, RefCounted} from 'neuroglancer/util/disposable';\nimport {removeFromParent} from 'neuroglancer/util/dom';\nimport {WatchableVisibilityPriority} from 'neuroglancer/visibility_priority/frontend';\nimport {makeCloseButton} from 'neuroglancer/widget/close_button';\nimport {StackView, Tab, TabView} from 'neuroglancer/widget/tab_view';\n\nclass UserLayerInfoPanel extends Tab {\n  tabView = new TabView(this.layer.tabs.addRef(), this.visibility);\n  constructor(public layer: UserLayer) {\n    super();\n    this.element.appendChild(this.tabView.element);\n    this.element.classList.add('neuroglancer-layer-side-panel-info-panel');\n    this.tabView.element.style.flex = '1';\n  }\n}\n\nclass EmptyUserLayerInfoPanel extends Tab {\n  get layer(): null {\n    return null;\n  }\n\n  constructor() {\n    super();\n    this.element.classList.add('neuroglancer-layer-side-panel-info-panel-empty');\n    this.element.textContent =\n        'Information about this layer will be available once it finishes loading.';\n  }\n}\n\nclass ManagedUserLayerInfoPanel extends Tab {\n  element = document.createElement('div');\n  private title = document.createElement('div');\n  private layerName = document.createElement('input');\n  private stack = this.registerDisposer(\n      new StackView<UserLayer|null, UserLayerInfoPanel|EmptyUserLayerInfoPanel>(userLayer => {\n        if (userLayer === null) {\n          return new EmptyUserLayerInfoPanel();\n        } else {\n          return new UserLayerInfoPanel(userLayer);\n        }\n      }, this.visibility));\n\n  constructor(\n      public layer: Borrowed<ManagedUserLayer>, public layerManager: Borrowed<LayerManager>,\n      public collapse: () => void) {\n    super();\n    const {element, title, layerName, stack} = this;\n    element.className = 'neuroglancer-managed-user-layer-info-panel';\n    title.className = 'neuroglancer-layer-side-panel-title';\n    stack.element.classList.add('neuroglancer-layer-side-panel-content-container');\n    element.appendChild(title);\n    element.appendChild(stack.element);\n\n    const collapseButton = makeCloseButton();\n    collapseButton.title = 'Close side panel';\n    collapseButton.addEventListener('click', () => {\n      this.collapse();\n    });\n    title.appendChild(layerName);\n    layerName.spellcheck = false;\n    layerName.title = 'Rename layer';\n    title.appendChild(collapseButton);\n    layerName.addEventListener('change', () => this.handleLayerNameViewChanged());\n    layerName.addEventListener('blur', () => this.handleLayerNameViewChanged());\n    this.registerDisposer(layer.layerChanged.add(() => this.handleLayerNameModelChanged()));\n    this.handleUserLayerChanged();\n    this.handleLayerNameModelChanged();\n  }\n\n  private handleUserLayerChanged() {\n    if (this.stack.selected !== this.layer.layer) {\n      this.stack.invalidateAll();\n      this.stack.selected = this.layer.layer;\n    }\n  }\n\n  private handleLayerNameModelChanged() {\n    this.layerName.value = this.layer.name;\n  }\n\n  private handleLayerNameViewChanged() {\n    const {layer} = this;\n    if (layer !== undefined) {\n      let newName = this.layerName.value;\n      if (newName !== layer.name) {\n        newName = this.layerManager.getUniqueLayerName(newName);\n        this.layerName.value = newName;\n        layer.name = newName;\n        layer.layerChanged.dispatch();\n      }\n    }\n  }\n}\n\nexport class LayerInfoPanelContainer extends RefCounted {\n  element = document.createElement('div');\n  private stack = this.registerDisposer(new StackView<ManagedUserLayer, ManagedUserLayerInfoPanel>(\n      layer =>\n          new ManagedUserLayerInfoPanel(layer, this.state.layerManager, this.collapse.bind(this))));\n  constructor(public state: SelectedLayerState) {\n    super();\n    const {element, stack} = this;\n    element.className = 'neuroglancer-layer-side-panel';\n    stack.element.classList.add('neuroglancer-layer-info-panel-container');\n    element.appendChild(stack.element);\n    this.registerDisposer(state.changed.add(() => this.handleStateChanged()));\n    this.registerDisposer(state.layerManager.layersChanged.add(() => this.handleLayersChanged()));\n    this.handleStateChanged();\n  }\n\n  private handleLayersChanged() {\n    const {layerManager} = this.state;\n    const {stack} = this;\n    for (const layer of stack.tabs.keys()) {\n      if (!layerManager.has(layer)) {\n        stack.invalidate(layer);\n      }\n    }\n  }\n\n  collapse() {\n    const {state} = this;\n    if (state.visible === true) {\n      this.state.visible = false;\n      this.state.changed.dispatch();\n    }\n  }\n\n  private handleStateChanged() {\n    const {state} = this;\n    const {visible} = state;\n    this.element.style.display = visible ? null : 'none';\n    this.stack.visibility.value =\n        visible ? WatchableVisibilityPriority.VISIBLE : WatchableVisibilityPriority.IGNORED;\n    this.stack.selected = state.layer;\n  }\n\n  disposed() {\n    removeFromParent(this.element);\n    super.disposed();\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport 'neuroglancer/sliceview/chunk_format_handlers';\n\nimport {StatusMessage} from 'neuroglancer/status';\nimport {DisplayContext} from 'neuroglancer/display_context';\nimport {Viewer, ViewerOptions} from 'neuroglancer/viewer';\n\nexport function makeMinimalViewer(options?: Partial<ViewerOptions>, target = document.getElementById('neuroglancer-container')! ) {\n  try {\n    let display = new DisplayContext(target);\n    return new Viewer(display, options);\n  } catch (error) {\n    StatusMessage.showMessage(`Error: ${error.message}`);\n    throw error;\n  }\n}\n","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file\n * Facility for showing a tooltip based on the mouse selection state.\n */\n\nimport './mouse_selection_state_tooltip.css';\n\nimport debounce from 'lodash/debounce';\nimport { Annotation, AnnotationType, AxisAlignedBoundingBox, AnnotationReference, getAnnotationTypeHandler} from 'neuroglancer/annotation';\nimport {getSelectedAnnotation} from 'neuroglancer/annotation/selection';\nimport {LayerManager, MouseSelectionState} from 'neuroglancer/layer';\nimport {VoxelSize} from 'neuroglancer/navigation_state';\nimport {getPositionSummary} from 'neuroglancer/ui/annotations';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {removeChildren} from 'neuroglancer/util/dom';\nimport {mat4} from 'neuroglancer/util/geom';\nimport {formatBoundingBoxVolume} from 'neuroglancer/util/spatial_units';\nimport {Tooltip} from 'neuroglancer/widget/tooltip';\n\nconst annotationTooltipHandlers = new Map<\n    AnnotationType,\n    (annotation: Annotation, element: HTMLElement, transform: mat4, voxelSize: VoxelSize) => void>([\n  [\n    AnnotationType.AXIS_ALIGNED_BOUNDING_BOX,\n    (annotation: AxisAlignedBoundingBox, element, transform, _voxelSize) => {\n      const volume = document.createElement('div');\n      volume.className = 'neuroglancer-annotation-details-volume';\n      volume.textContent = formatBoundingBoxVolume(annotation.pointA, annotation.pointB, transform);\n      element.appendChild(volume);\n    },\n  ],\n]);\n\nconst TOOLTIP_DELAY = 500;\n\nexport class MouseSelectionStateTooltipManager extends RefCounted {\n  private tooltip: Tooltip|undefined = undefined;\n\n  private debouncedShowTooltip =\n    this.registerCancellable(debounce(() => this.doCreateTooltip(), TOOLTIP_DELAY));\n\n  private debouncedShowTooltip0 =\n      this.registerCancellable(debounce(() => this.doCreateTooltip(), 0));\n\n\n  private reference: AnnotationReference|undefined;\n\n  private setReference(reference: AnnotationReference|undefined) {\n    const existing = this.reference;\n    if (existing !== undefined) {\n      existing.changed.remove(this.debouncedShowTooltip0);\n      existing.dispose();\n      this.reference = undefined;\n    }\n    this.reference = reference;\n    if (reference !== undefined) {\n      reference.changed.add(this.debouncedShowTooltip0);\n    }\n  }\n\n  constructor(\n      public mouseState: MouseSelectionState, public layerManager: LayerManager,\n      public voxelSize: VoxelSize) {\n    super();\n    this.registerDisposer(mouseState.changed.add(() => this.mouseStateChanged()));\n  }\n\n  private maybeCreateTooltip() {\n    const state = getSelectedAnnotation(this.mouseState, this.layerManager);\n    if (state === undefined) {\n      return false;\n    }\n    if (!this.voxelSize.valid) {\n      return false;\n    }\n    let {tooltip} = this;\n    if (tooltip === undefined) {\n      tooltip = this.tooltip = new Tooltip();\n      tooltip.element.classList.add('neuroglancer-mouse-selection-tooltip');\n    }\n\n    const reference = state.annotationLayer.source.getReference(state.id);\n    this.setReference(reference);\n    if (reference.value === null) {\n      return false;\n    }\n\n    removeChildren(tooltip.element);\n    const header = document.createElement('div');\n    header.className = 'neuroglancer-mouse-selection-tooltip-title';\n    header.textContent = `${state.layer.name}`;\n\n    const description = document.createElement('div');\n    description.className = 'neuroglancer-mouse-selection-tooltip-description';\n\n    const annotation = reference.value;\n\n    if (annotation === undefined) {\n      description.textContent = 'Loading...';\n    } else {\n      description.textContent = annotation.description || '';\n    }\n\n    tooltip.element.appendChild(header);\n    tooltip.element.appendChild(description);\n\n    if (annotation != null) {\n      const {segments} = annotation;\n      if (segments !== undefined && segments.length > 0) {\n        const segmentContainer = document.createElement('div');\n        segmentContainer.className = 'neuroglancer-annotation-segment-list';\n\n        const segmentationState = state.annotationLayer.segmentationState.value;\n        const segmentColorHash = segmentationState ? segmentationState.segmentColorHash : undefined;\n        segments.forEach((segment, index) => {\n          if (index !== 0) {\n            segmentContainer.appendChild(document.createTextNode(' '));\n          }\n          const child = document.createElement('span');\n          child.className = 'neuroglancer-annotation-segment-item';\n          child.textContent = segment.toString();\n          if (segmentColorHash !== undefined) {\n            child.style.backgroundColor = segmentColorHash!.computeCssColor(segment);\n          }\n          segmentContainer.appendChild(child);\n        });\n        tooltip.element.appendChild(segmentContainer);\n      }\n      const combinedTransform = state.annotationLayer.objectToGlobal;\n\n      const typeHandler = getAnnotationTypeHandler(annotation.type);\n\n      const positionElement = document.createElement('div');\n      positionElement.appendChild(document.createTextNode(typeHandler.icon));\n      getPositionSummary(positionElement, annotation, combinedTransform, this.voxelSize);\n      positionElement.className = 'neuroglancer-mouse-selection-tooltip-annotation-corners';\n      tooltip.element.appendChild(positionElement);\n\n      const handler = annotationTooltipHandlers.get(annotation.type);\n      if (handler !== undefined) {\n        handler(annotation, tooltip.element, combinedTransform, this.voxelSize);\n      }\n    }\n    return true;\n  }\n\n  private mouseStateChanged() {\n    const {tooltip} = this;\n    if (tooltip !== undefined) {\n      tooltip.dispose();\n      this.tooltip = undefined;\n    }\n    this.setReference(undefined);\n    this.debouncedShowTooltip();\n  }\n\n  private doCreateTooltip = (() => {\n    this.debouncedShowTooltip.cancel();\n    this.debouncedShowTooltip0.cancel();\n    const {mouseState} = this;\n    if (!this.maybeCreateTooltip()) {\n      const {tooltip} = this;\n      if (tooltip !== undefined) {\n        tooltip.dispose();\n        this.tooltip = undefined;\n      }\n      this.setReference(undefined);\n      return;\n    } else {\n      const tooltip = this.tooltip!;\n      tooltip.updatePosition(mouseState.pageX, mouseState.pageY);\n    }\n  });\n\n  disposed() {\n    const {tooltip} = this;\n    if (tooltip !== undefined) {\n      tooltip.dispose();\n      this.tooltip = undefined;\n    }\n    this.setReference(undefined);\n    super.disposed();\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {SpatialPosition} from 'neuroglancer/navigation_state';\nimport {Borrowed, registerEventListener} from 'neuroglancer/util/disposable';\nimport {positionDragType} from 'neuroglancer/widget/position_widget';\n\nexport function setupPositionDropHandlers(\n    target: EventTarget, position: Borrowed<SpatialPosition>) {\n  const dropDisposer = registerEventListener(target, 'drop', (event: DragEvent) => {\n    event.preventDefault();\n    if (event.dataTransfer!.types.indexOf(positionDragType) !== -1) {\n      const positionState = JSON.parse(event.dataTransfer!.getData(positionDragType));\n      position.restoreState(positionState);\n      event.stopPropagation();\n    }\n  });\n  const dragoverDisposer = registerEventListener(target, 'dragover', (event: DragEvent) => {\n    if (event.dataTransfer!.types.indexOf(positionDragType) !== -1) {\n      // Permit drag.\n      event.dataTransfer!.dropEffect = 'link';\n      event.preventDefault();\n      event.stopPropagation();\n    }\n  });\n  return () => {\n    dragoverDisposer();\n    dropDisposer();\n  };\n}\n","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Support for editing Neuroglancer state as JSON directly within browser.\n */\n\nimport 'codemirror/lib/codemirror.css';\nimport 'codemirror/mode/javascript/javascript';\nimport 'codemirror/addon/fold/foldcode';\nimport 'codemirror/addon/fold/foldgutter';\nimport 'codemirror/addon/fold/brace-fold';\nimport 'codemirror/addon/fold/foldgutter.css';\nimport 'codemirror/addon/lint/lint.css';\nimport './state_editor.css';\n\nimport CodeMirror from 'codemirror';\nimport debounce from 'lodash/debounce';\nimport {Overlay} from 'neuroglancer/overlay';\nimport {getCachedJson} from 'neuroglancer/util/trackable';\nimport {Viewer} from 'neuroglancer/viewer';\n\nconst valueUpdateDelay = 100;\n\nexport class StateEditorDialog extends Overlay {\n  textEditor: CodeMirror.Editor;\n  applyButton: HTMLButtonElement;\n  constructor(public viewer: Viewer) {\n    super();\n\n    this.content.classList.add('neuroglancer-state-editor');\n\n    const button = this.applyButton = document.createElement('button');\n    button.textContent = 'Apply changes';\n    this.content.appendChild(button);\n    button.addEventListener('click', () => this.applyChanges());\n    button.disabled = true;\n\n    this.textEditor = CodeMirror(_element => {}, <any>{\n      value: '',\n      mode: {'name': 'javascript', json: true},\n      foldGutter: true,\n      gutters: [\n        'CodeMirror-lint-markers',\n        'CodeMirror-foldgutter',\n      ],\n    });\n    this.updateView();\n\n    this.textEditor.on('change', () => {\n      this.debouncedValueUpdater();\n    });\n\n    this.content.appendChild(this.textEditor.getWrapperElement());\n    this.textEditor.refresh();\n  }\n\n  private applyChanges() {\n    if (this.parsedValue !== null) {\n      this.viewer.state.reset();\n      this.viewer.state.restoreState(this.parsedValue);\n    }\n    this.applyButton.disabled = true;\n  }\n\n  private updateView() {\n    this.textEditor.setValue(this.getJson());\n    (<any>this.textEditor).execCommand('foldAll');\n    (<any>this.textEditor).execCommand('unfold');\n  }\n\n  parsedValue: any = null;\n\n  debouncedValueUpdater = debounce(() => {\n    const value = this.textEditor.getValue();\n    try {\n      const json = JSON.parse(value);\n      this.parsedValue = json;\n      this.applyButton.disabled = false;\n      this.textEditor.setOption('lint', undefined);\n    } catch (parseError) {\n      this.parsedValue = null;\n      this.applyButton.disabled = true;\n      let line = 0, column = 0, message = 'Unknown parse error';\n      if (parseError instanceof Error) {\n        const m = parseError.message.match(/^((?:.|\\n)*) in JSON at position ([0-9]+)$/);\n        if (m !== null) {\n          message = m[1];\n          const offset = parseInt(m[2], 10);\n          const prefix = value.substring(0, offset);\n          const lines = prefix.split('\\n');\n          line = lines.length - 1;\n          column = lines[lines.length - 1].length;\n        } else {\n          message = parseError.message;\n        }\n      }\n      this.textEditor.setOption('lint', {\n        getAnnotations: () => {\n          return [{\n            message,\n            severity: 'error',\n            from: CodeMirror.Pos(line, column),\n          }];\n        },\n      });\n    }\n  }, valueUpdateDelay);\n\n  getJson() {\n    return JSON.stringify(getCachedJson(this.viewer.state).value, null, '  ');\n  }\n}\n","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2019 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport 'neuroglancer/ui/statistics.css';\n\nimport debounce from 'lodash/debounce';\nimport {ChunkDownloadStatistics, ChunkMemoryStatistics, ChunkPriorityTier, ChunkState, getChunkDownloadStatisticIndex, getChunkStateStatisticIndex, numChunkMemoryStatistics, numChunkStates, REQUEST_CHUNK_STATISTICS_RPC_ID} from 'neuroglancer/chunk_manager/base';\nimport {ChunkQueueManager, ChunkSource} from 'neuroglancer/chunk_manager/frontend';\nimport {TrackableBoolean} from 'neuroglancer/trackable_boolean';\nimport {TrackableValue, WatchableValueInterface} from 'neuroglancer/trackable_value';\nimport {Borrowed, RefCounted} from 'neuroglancer/util/disposable';\nimport {removeChildren, removeFromParent} from 'neuroglancer/util/dom';\nimport {verifyPositiveInt} from 'neuroglancer/util/json';\nimport {CompoundTrackable, Trackable} from 'neuroglancer/util/trackable';\n\nexport class StatisticsDisplayState implements Trackable {\n  private tracker = new CompoundTrackable();\n  get changed() {\n    return this.tracker.changed;\n  }\n  visible = new TrackableBoolean(false);\n  size = new TrackableValue<number>(100, verifyPositiveInt);\n  sortBy?: WatchableValueInterface<string>;\n  constructor() {\n    this.tracker.add('visible', this.visible);\n    this.tracker.add('size', this.size);\n  }\n\n  restoreState(obj: any) {\n    this.tracker.restoreState(obj);\n  }\n\n  reset() {\n    this.tracker.reset();\n  }\n\n  toJSON() {\n    const obj = this.tracker.toJSON();\n    for (const k of Object.keys(obj)) {\n      if (obj[k as keyof typeof obj] !== undefined) return obj;\n    }\n    return undefined;\n  }\n}\n\nfunction getProperties(obj: any): Map<string, string> {\n  const map = new Map<string, string>();\n  function handleObject(o: any, prefix: string) {\n    if (typeof o !== 'object') {\n      map.set(prefix, '' + o);\n      return;\n    }\n    for (const key of Object.keys(o)) {\n      handleObject(o[key], prefix + '.' + key);\n    }\n  }\n  handleObject(obj, '');\n  return map;\n}\n\nfunction getDistinguishingProperties(properties: Map<string,string>[]): string[] {\n  const selected = new Set<string>();\n  selected.add('.type');\n  const allProps = new Set<string>();\n  function areDistinguished(i: number, j: number) {\n    for (const prop of selected) {\n      if (properties[i].get(prop) !== properties[j].get(prop)) {\n        return true;\n      }\n    }\n    return false;\n  }\n  for (let i = 0, n = properties.length; i < n; ++i) {\n    for (const prop of properties[i].keys()) {\n      allProps.add(prop);\n    }\n    let matches: number[] = [];\n    for (let j = 0; j < i; ++j) {\n      if (!areDistinguished(i, j)) {\n        matches.push(j);\n      }\n    }\n    while (matches.length > 0) {\n      let bestReducedMatches: number[] = matches;\n      let bestProp: string|undefined = undefined;\n      for (const prop of allProps) {\n        if (selected.has(prop)) continue;\n        const reducedMatches: number[] = [];\n        for (const j of matches) {\n          if (properties[j].get(prop) === properties[i].get(prop)) {\n            reducedMatches.push(j);\n          }\n        }\n        if (reducedMatches.length < bestReducedMatches.length) {\n          bestReducedMatches = reducedMatches;\n          bestProp = prop;\n        }\n        if (reducedMatches.length === 0) break;\n      }\n      // Prevent infinite loop if there are no distinguishing properties.\n      if (bestProp === undefined) break;\n      matches = bestReducedMatches;\n      selected.add(bestProp);\n    }\n  }\n  return Array.from(selected);\n}\n\nfunction getNameFromProps(properties: Map<string,string>, selected: string[]) {\n  const result: any = {};\n  for (const prop of selected) {\n    const value = properties.get(prop);\n    if (value === undefined) continue;\n    if (prop === '') return value;\n    result[prop] = value;\n  }\n  return JSON.stringify(result);\n}\n\nfunction getFormattedNames(objects: any[]) {\n  const properties = objects.map(getProperties);\n  const selectedProps = getDistinguishingProperties(properties);\n  return properties.map(p => getNameFromProps(p, selectedProps));\n}\n\ntype ChunkStatistics = Map<number, Float64Array>;\n\n/**\n * Interval in ms at which to request new statistics from the backend thread.\n */\nconst requestDataInterval = 1000;\n\nexport class StatisticsPanel extends RefCounted {\n  element = document.createElement('div');\n  columns = new Map<string, (statistics: Float64Array) => number>();\n  data: ChunkStatistics|undefined = undefined;\n  private requestDataTimerId = -1;\n  private dataRequested = false;\n  constructor(\n      public chunkQueueManager: Borrowed<ChunkQueueManager>,\n      public displayState: StatisticsDisplayState) {\n    super();\n\n    const {element} = this;\n    element.className = 'neuroglancer-statistics-panel';\n\n    this.registerDisposer(this.displayState.changed.add(this.debouncedUpdateView));\n    this.registerDisposer(this.displayState.visible.changed.add(() => this.requestData()));\n    this.requestData();\n\n    const {columns} = this;\n    // Total number of visible-priority chunks\n    //    number in downloading state\n    //    number in other system memory state\n    //    number in gpu memory state\n    //    number in failed state\n    columns.set('Visible chunks/T', (statistics) => {\n      let sum = 0;\n      for (let state: ChunkState = 0; state < numChunkStates; ++state) {\n        sum += statistics[getChunkStateStatisticIndex(state, ChunkPriorityTier.VISIBLE) *\n                          numChunkMemoryStatistics + ChunkMemoryStatistics.numChunks];\n      }\n      return sum;\n    });\n\n    columns.set('Visible chunks/D', (statistics) => {\n      return (statistics\n                  [getChunkStateStatisticIndex(ChunkState.DOWNLOADING, ChunkPriorityTier.VISIBLE) *\n                       numChunkMemoryStatistics +\n                   ChunkMemoryStatistics.numChunks]);\n    });\n\n    columns.set('Visible chunks/M', (statistics) => {\n      return (\n          statistics\n              [getChunkStateStatisticIndex(ChunkState.SYSTEM_MEMORY, ChunkPriorityTier.VISIBLE) *\n                   numChunkMemoryStatistics +\n               ChunkMemoryStatistics.numChunks] +\n          statistics\n              [getChunkStateStatisticIndex(\n                   ChunkState.SYSTEM_MEMORY_WORKER, ChunkPriorityTier.VISIBLE) *\n                   numChunkMemoryStatistics +\n               ChunkMemoryStatistics.numChunks]);\n    });\n\n    columns.set('Visible chunks/G', (statistics) => {\n      return statistics[getChunkStateStatisticIndex(ChunkState.GPU_MEMORY, ChunkPriorityTier.VISIBLE) *\n                   numChunkMemoryStatistics +\n               ChunkMemoryStatistics.numChunks];\n    });\n\n    columns.set('Visible chunks/F', (statistics) => {\n      return statistics[getChunkStateStatisticIndex(ChunkState.FAILED, ChunkPriorityTier.VISIBLE) *\n                   numChunkMemoryStatistics +\n               ChunkMemoryStatistics.numChunks];\n    });\n\n    columns.set('Visible memory', (statistics) => {\n      return statistics[getChunkStateStatisticIndex(ChunkState.GPU_MEMORY, ChunkPriorityTier.VISIBLE) *\n                   numChunkMemoryStatistics +\n               ChunkMemoryStatistics.gpuMemoryBytes];\n    });\n\n    columns.set('Download latency', (statistics) => {\n      return statistics[getChunkDownloadStatisticIndex(ChunkDownloadStatistics.totalTime)] /\n          statistics[getChunkDownloadStatisticIndex(ChunkDownloadStatistics.totalChunks)];\n    });\n  }\n\n  disposed() {\n    clearTimeout(this.requestDataTimerId);\n    removeFromParent(this.element);\n    super.disposed();\n  }\n\n  private requestData() {\n    if (!this.displayState.visible.value) return;\n    if (this.dataRequested) return;\n    const {chunkQueueManager} = this;\n    const rpc = chunkQueueManager.rpc!;\n    this.dataRequested = true;\n    rpc.promiseInvoke<ChunkStatistics>(\n           REQUEST_CHUNK_STATISTICS_RPC_ID, {queue: chunkQueueManager.rpcId})\n        .then(data => {\n          this.dataRequested = false;\n          this.data = data;\n          this.debouncedUpdateView();\n          this.requestDataTimerId = setTimeout(() => {\n            this.requestDataTimerId = -1;\n            this.requestData();\n          }, requestDataInterval);\n        });\n  }\n\n  private debouncedUpdateView = this.registerCancellable(debounce(() => this.updateView(), 0));\n\n  private updateView() {\n    if (!this.displayState.visible.value) return;\n    const {data} = this;\n    if (data === undefined) return;\n    const {columns} = this;\n    const rpc = this.chunkQueueManager.rpc!;\n    const table = document.createElement('table');\n    const rows: [ChunkSource, ...number[]][] = [];\n    for (const [id, statistics] of data) {\n      const source = rpc.get(id) as ChunkSource | undefined;\n      if (source === undefined) continue;\n      const row: [ChunkSource, ...number[]] = [source];\n      for (const column of columns.values()) {\n        row.push(column(statistics));\n      }\n      rows.push(row);\n    }\n\n    const formattedNames =\n        getFormattedNames(rows.map(x => Object.assign({type: x[0].RPC_TYPE_ID}, x[0].key || {})));\n    const sourceFormattedNames = new Map<ChunkSource, string>();\n    formattedNames.forEach((name, i) => {\n      sourceFormattedNames.set(rows[i][0], name);\n    });\n\n    {\n      const thead = document.createElement('thead');\n      let tr = document.createElement('tr');\n      thead.appendChild(tr);\n      const addHeaderColumn = (label: string) => {\n        const td = document.createElement('td');\n        td.textContent = label;\n        tr.appendChild(td);\n      };\n      addHeaderColumn('Name');\n      let prevPrefix: string|undefined = undefined;\n      for (const column of columns.keys()) {\n        const sepIndex = column.indexOf('/');\n        let prefix = column;\n        if (sepIndex !== -1) {\n          prefix = column.substring(0, sepIndex);\n          if (prefix === prevPrefix) {\n            ++(tr.lastElementChild! as HTMLTableCellElement).colSpan;\n            continue;\n          }\n          prevPrefix = prefix;\n        }\n        addHeaderColumn(prefix);\n      }\n      tr = document.createElement('tr');\n      thead.appendChild(tr);\n      {\n        const td = document.createElement('td');\n        tr.appendChild(td);\n      }\n      for (const column of columns.keys()) {\n        const sepIndex = column.indexOf('/');\n        let suffix = '';\n        if (sepIndex !== -1) {\n          suffix = column.substring(sepIndex+1);\n        }\n        const td = document.createElement('td');\n        td.textContent = suffix;\n        tr.appendChild(td);\n      }\n      table.appendChild(thead);\n    }\n    const tbody = document.createElement('tbody');\n    // TODO: sort rows\n    for (const [source, ...values] of rows) {\n      const tr = document.createElement('tr');\n      const addColumn = (label: string) => {\n        const td = document.createElement('td');\n        td.textContent = label;\n        tr.appendChild(td);\n      };\n      addColumn(sourceFormattedNames.get(source)!);\n      for (const value of values) {\n        addColumn('' + value);\n      }\n      tbody.appendChild(tr);\n    }\n    table.appendChild(tbody);\n    removeChildren(this.element);\n    this.element.appendChild(table);\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Support for defining user-selectable annotation tools.\n */\n\nimport {MouseSelectionState, UserLayer} from 'neuroglancer/layer';\nimport {Owned, RefCounted} from 'neuroglancer/util/disposable';\nimport {verifyObject, verifyObjectProperty, verifyString} from 'neuroglancer/util/json';\n\nexport abstract class Tool extends RefCounted {\n  setActive(_value: boolean): void {}\n  abstract trigger(mouseState: MouseSelectionState): void;\n  abstract toJSON(): any;\n  deactivate(): void {}\n  description: string;\n}\n\nexport function restoreTool(layer: UserLayer, obj: any) {\n  if (obj === undefined) {\n    return undefined;\n  }\n  if (typeof obj === 'string') {\n    obj = {'type': obj};\n  }\n  verifyObject(obj);\n  const type = verifyObjectProperty(obj, 'type', verifyString);\n  const getter = tools.get(type);\n  if (getter === undefined) {\n    throw new Error(`Invalid tool type: ${JSON.stringify(obj)}.`);\n  }\n  return getter(layer, obj);\n}\n\nexport type ToolGetter = (layer: UserLayer, options: any) => Owned<Tool>;\n\nconst tools = new Map<string, ToolGetter>();\n\nexport function registerTool(type: string, getter: ToolGetter) {\n  tools.set(type, getter);\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport debounce from 'lodash/debounce';\nimport {WatchableValue} from 'neuroglancer/trackable_value';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {urlSafeParse, verifyObject} from 'neuroglancer/util/json';\nimport {getCachedJson, Trackable} from 'neuroglancer/util/trackable';\n\n/**\n * @file Implements a binding between a Trackable value and the URL hash state.\n */\n\n/**\n * Encodes a fragment string robustly.\n */\nfunction encodeFragment(fragment: string) {\n  return encodeURI(fragment).replace(/[!'()*;,]/g, function(c) {\n    return '%' + c.charCodeAt(0).toString(16).toUpperCase();\n  });\n}\n\n/**\n * An instance of this class manages a binding between a Trackable value and the URL hash state.\n * The binding is initialized in the constructor, and is removed when dispose is called.\n */\nexport class UrlHashBinding extends RefCounted {\n  /**\n   * Most recently parsed or set state string.\n   */\n  private prevStateString: string|undefined;\n\n  /**\n   * Generation number of previous state set.\n   */\n  private prevStateGeneration: number|undefined;\n\n  /**\n   * Most recent error parsing URL hash.\n   */\n  parseError = new WatchableValue<Error|undefined>(undefined);\n\n  constructor(public root: Trackable, updateDelayMilliseconds = 200) {\n    super();\n    this.registerEventListener(window, 'hashchange', () => this.updateFromUrlHash());\n    const throttledSetUrlHash = debounce(() => this.setUrlHash(), updateDelayMilliseconds);\n    this.registerDisposer(root.changed.add(throttledSetUrlHash));\n    this.registerDisposer(() => throttledSetUrlHash.cancel());\n  }\n\n  /**\n   * Sets the URL hash to match the current state.\n   */\n  setUrlHash() {\n    const cacheState = getCachedJson(this.root);\n    const {generation} = cacheState;\n    if (generation !== this.prevStateGeneration) {\n      this.prevStateGeneration = cacheState.generation;\n      let stateString = encodeFragment(JSON.stringify(cacheState.value));\n      if (stateString !== this.prevStateString) {\n        this.prevStateString = stateString;\n        if (decodeURIComponent(stateString) === '{}') {\n          history.replaceState(null, '', '#');\n        } else {\n          history.replaceState(null, '', '#!' + stateString);\n        }\n      }\n    }\n  }\n\n  /**\n   * Sets the current state to match the URL hash.  If it is desired to initialize the state based\n   * on the URL hash, then this should be called immediately after construction.\n   */\n  updateFromUrlHash() {\n    try {\n      let s = location.href.replace(/^[^#]+/, '');\n      if (s === '' || s === '#' || s === '#!') {\n        s = '#!{}';\n      }\n      if (s.startsWith('#!+')) {\n        s = s.slice(3);\n        // Firefox always %-encodes the URL even if it is not typed that way.\n        s = decodeURIComponent(s);\n        let state = urlSafeParse(s);\n        verifyObject(state);\n        this.root.restoreState(state);\n        this.prevStateString = undefined;\n      } else if (s.startsWith('#!')) {\n        s = s.slice(2);\n        s = decodeURIComponent(s);\n        if (s === this.prevStateString) {\n          return;\n        }\n        this.prevStateString = s;\n        this.root.reset();\n        let state = urlSafeParse(s);\n        verifyObject(state);\n        this.root.restoreState(state);\n      } else {\n        throw new Error(`URL hash is expected to be of the form \"#!{...}\" or \"#!+{...}\".`);\n      }\n      this.parseError.value = undefined;\n    } catch (parseError) {\n      this.parseError.value = parseError;\n    }\n  }\n}\n","/**\n * @license\n * This work is a derivative of the Google Neuroglancer project,\n * Copyright 2016 Google Inc.\n * The Derivative Work is covered by\n * Copyright 2019 Howard Hughes Medical Institute\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {HashMapUint64} from 'neuroglancer/gpu_hash/hash_table';\nimport {WatchableValueInterface} from 'neuroglancer/trackable_value';\nimport {Signal} from 'neuroglancer/util/signal';\nimport {Uint64} from 'neuroglancer/util/uint64';\nimport {registerRPC, registerSharedObject, RPC, SharedObjectCounterpart} from 'neuroglancer/worker_rpc';\n\n@registerSharedObject('Uint64Map')\nexport class Uint64Map extends SharedObjectCounterpart implements\n    WatchableValueInterface<Uint64Map> {\n  hashTable = new HashMapUint64();\n  changed = new Signal<(x: Uint64|null, add: boolean) => void>();\n\n  get value() {\n    return this;\n  }\n\n  static makeWithCounterpart(rpc: RPC) {\n    let obj = new Uint64Map();\n    obj.initializeCounterpart(rpc);\n    return obj;\n  }\n\n  disposed() {\n    super.disposed();\n    this.hashTable = <any>undefined;\n    this.changed = <any>undefined;\n  }\n\n  set_(key: Uint64, value: Uint64) {\n    return this.hashTable.set(key, value);\n  }\n\n  set(key: Uint64, value: Uint64) {\n    if (this.set_(key, value)) {\n      let {rpc} = this;\n      if (rpc) {\n        rpc.invoke('Uint64Map.set', {'id': this.rpcId, 'key': key, 'value': value});\n      }\n      this.changed.dispatch(key, true);\n    }\n  }\n\n  has(key: Uint64) {\n    return this.hashTable.has(key);\n  }\n\n  get(key: Uint64, value: Uint64): boolean {\n    return this.hashTable.get(key, value);\n  }\n\n  [Symbol.iterator]() {\n    return this.hashTable.entries();\n  }\n\n  delete_(key: Uint64) {\n    return this.hashTable.delete(key);\n  }\n\n  delete(key: Uint64) {\n    if (this.delete_(key)) {\n      let {rpc} = this;\n      if (rpc) {\n        rpc.invoke('Uint64Map.delete', {'id': this.rpcId, 'key': key});\n      }\n      this.changed.dispatch(key, false);\n    }\n  }\n\n  get size() {\n    return this.hashTable.size;\n  }\n\n  clear() {\n    if (this.hashTable.clear()) {\n      let {rpc} = this;\n      if (rpc) {\n        rpc.invoke('Uint64Map.clear', {'id': this.rpcId});\n      }\n      this.changed.dispatch(null, false);\n    }\n  }\n\n  toJSON() {\n    let result: {[key: string]: string} = {};\n    for (let [key, value] of this.hashTable.entries()) {\n      result[key.toString()] = value.toString();\n    }\n    return result;\n  }\n}\n\nregisterRPC('Uint64Map.set', function(x) {\n  let obj = this.get(x['id']);\n  if (obj.set_(x['key'], x['value'])) {\n    obj.changed.dispatch();\n  }\n});\n\nregisterRPC('Uint64Map.delete', function(x) {\n  let obj = this.get(x['id']);\n  if (obj.delete_(x['key'])) {\n    obj.changed.dispatch();\n  }\n});\n\nregisterRPC('Uint64Map.clear', function(x) {\n  let obj = this.get(x['id']);\n  if (obj.hashTable.clear()) {\n    obj.changed.dispatch();\n  }\n});\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {HashSetUint64} from 'neuroglancer/gpu_hash/hash_table';\nimport {WatchableValueInterface} from 'neuroglancer/trackable_value';\nimport {Signal} from 'neuroglancer/util/signal';\nimport {Uint64} from 'neuroglancer/util/uint64';\nimport {registerRPC, registerSharedObject, RPC, SharedObjectCounterpart} from 'neuroglancer/worker_rpc';\n\n@registerSharedObject('Uint64Set')\nexport class Uint64Set extends SharedObjectCounterpart implements\n    WatchableValueInterface<Uint64Set> {\n  hashTable = new HashSetUint64();\n  changed = new Signal<(x: Uint64|null, add: boolean) => void>();\n\n  get value() {\n    return this;\n  }\n\n  static makeWithCounterpart(rpc: RPC) {\n    let obj = new Uint64Set();\n    obj.initializeCounterpart(rpc);\n    return obj;\n  }\n\n  disposed() {\n    super.disposed();\n    this.hashTable = <any>undefined;\n    this.changed = <any>undefined;\n  }\n\n  add_(x: Uint64) {\n    return this.hashTable.add(x);\n  }\n\n  add(x: Uint64) {\n    if (this.add_(x)) {\n      let {rpc} = this;\n      if (rpc) {\n        rpc.invoke('Uint64Set.add', {'id': this.rpcId, 'value': x});\n      }\n      this.changed.dispatch(x, true);\n    }\n  }\n\n  has(x: Uint64) {\n    return this.hashTable.has(x);\n  }\n\n  [Symbol.iterator]() {\n    return this.hashTable.keys();\n  }\n\n  delete_(x: Uint64) {\n    return this.hashTable.delete(x);\n  }\n\n  delete(x: Uint64) {\n    if (this.delete_(x)) {\n      let {rpc} = this;\n      if (rpc) {\n        rpc.invoke('Uint64Set.delete', {'id': this.rpcId, 'value': x});\n      }\n      this.changed.dispatch(x, false);\n    }\n  }\n\n  get size() {\n    return this.hashTable.size;\n  }\n\n  clear() {\n    if (this.hashTable.clear()) {\n      let {rpc} = this;\n      if (rpc) {\n        rpc.invoke('Uint64Set.clear', {'id': this.rpcId});\n      }\n      this.changed.dispatch(null, false);\n    }\n  }\n\n  toJSON() {\n    let result = new Array<string>();\n    for (let id of this) {\n      result.push(id.toString());\n    }\n    // Need to sort entries, otherwise serialization changes every time.\n    result.sort();\n    return result;\n  }\n}\n\nregisterRPC('Uint64Set.add', function(x) {\n  let obj = this.get(x['id']);\n  if (obj.add_(x['value'])) {\n    obj.changed.dispatch();\n  }\n});\n\nregisterRPC('Uint64Set.delete', function(x) {\n  let obj = this.get(x['id']);\n  if (obj.delete_(x['value'])) {\n    obj.changed.dispatch();\n  }\n});\n\nregisterRPC('Uint64Set.clear', function(x) {\n  let obj = this.get(x['id']);\n  if (obj.hashTable.clear()) {\n    obj.changed.dispatch();\n  }\n});\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {CoordinateTransform} from 'neuroglancer/coordinate_transform';\nimport {UserLayer} from 'neuroglancer/layer';\nimport {CoordinateTransformTab} from 'neuroglancer/widget/coordinate_transform';\n\nconst TRANSFORM_JSON_KEY = 'transform';\n\nexport interface UserLayerWithCoordinateTransform extends UserLayer {\n  transform: CoordinateTransform;\n}\n\n/**\n * Mixin that adds a `transform` property to a user layer.\n */\nexport function UserLayerWithCoordinateTransformMixin<TBase extends {new (...args: any[]): UserLayer}>(\n    Base: TBase) {\n  class C extends Base implements UserLayerWithCoordinateTransform {\n    transform = new CoordinateTransform();\n\n    constructor(...args: any[]) {\n      super(...args);\n      this.transform.changed.add(this.specificationChanged.dispatch);\n      this.tabs.add('transform', {\n        label: 'Transform',\n        order: 100,\n        getter: () => new CoordinateTransformTab(this.transform)\n      });\n      const specification = args[1];\n      this.transform.restoreState(specification[TRANSFORM_JSON_KEY]);\n    }\n\n    toJSON(): any {\n      const x = super.toJSON();\n      x[TRANSFORM_JSON_KEY] = this.transform.toJSON();\n      return x;\n    }\n  }\n  return C;\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {AnnotationLayerState} from 'neuroglancer/annotation/frontend';\nimport {GetVolumeOptions} from 'neuroglancer/datasource';\nimport {RenderLayerRole, UserLayer} from 'neuroglancer/layer';\nimport {getVolumeWithStatusMessage} from 'neuroglancer/layer_specification';\nimport {RenderScaleHistogram, trackableRenderScaleTarget} from 'neuroglancer/render_scale_statistics';\nimport {MultiscaleVolumeChunkSource} from 'neuroglancer/sliceview/volume/frontend';\nimport {TrackableValue} from 'neuroglancer/trackable_value';\nimport {getAnnotationRenderOptions, UserLayerWithAnnotations, UserLayerWithAnnotationsMixin} from 'neuroglancer/ui/annotations';\nimport {UserLayerWithCoordinateTransform, UserLayerWithCoordinateTransformMixin} from 'neuroglancer/user_layer_with_coordinate_transform';\nimport {verifyObjectProperty, verifyOptionalString} from 'neuroglancer/util/json';\n\nconst SOURCE_JSON_KEY = 'source';\nconst CROSS_SECTION_RENDER_SCALE_JSON_KEY = 'crossSectionRenderScale';\n\ninterface BaseConstructor {\n  new(...args: any[]): UserLayerWithAnnotations&UserLayerWithCoordinateTransform;\n}\n\nfunction helper<TBase extends BaseConstructor>(Base: TBase) {\n  class C extends Base implements UserLayerWithVolumeSource {\n    volumePath: string|undefined;\n    multiscaleSource: Promise<MultiscaleVolumeChunkSource>|undefined;\n    volumeOptions: GetVolumeOptions|undefined;\n    sliceViewRenderScaleHistogram = new RenderScaleHistogram();\n    sliceViewRenderScaleTarget = (() => {\n      const target = trackableRenderScaleTarget(1);\n      target.changed.add(this.specificationChanged.dispatch);\n      return target;\n    })();\n\n    restoreState(specification: any) {\n      super.restoreState(specification);\n      const volumePath = this.volumePath =\n          verifyObjectProperty(specification, SOURCE_JSON_KEY, verifyOptionalString);\n      this.sliceViewRenderScaleTarget.restoreState(\n          specification[CROSS_SECTION_RENDER_SCALE_JSON_KEY]);\n\n      if (volumePath !== undefined) {\n        const multiscaleSource = this.multiscaleSource = getVolumeWithStatusMessage(\n            this.manager.dataSourceProvider, this.manager.chunkManager, volumePath,\n            this.volumeOptions);\n        multiscaleSource.then(volume => {\n          if (!this.wasDisposed) {\n            const staticAnnotations = volume.getStaticAnnotations && volume.getStaticAnnotations();\n            if (staticAnnotations !== undefined) {\n              this.annotationLayerState.value = new AnnotationLayerState({\n                transform: this.transform,\n                source: staticAnnotations,\n                role: RenderLayerRole.DEFAULT_ANNOTATION,\n                ...getAnnotationRenderOptions(this),\n              });\n            }\n          }\n        });\n      }\n    }\n\n    toJSON() {\n      const result = super.toJSON();\n      result[SOURCE_JSON_KEY] = this.volumePath;\n      result[CROSS_SECTION_RENDER_SCALE_JSON_KEY] = this.sliceViewRenderScaleTarget.toJSON();\n      return result;\n    }\n  }\n  return C;\n}\n\nexport interface UserLayerWithVolumeSource extends UserLayerWithAnnotations,\n                                                   UserLayerWithCoordinateTransform {\n  volumePath: string|undefined;\n  multiscaleSource: Promise<MultiscaleVolumeChunkSource>|undefined;\n  sliceViewRenderScaleHistogram: RenderScaleHistogram;\n  sliceViewRenderScaleTarget: TrackableValue<number>;\n}\n\n/**\n * Mixin that adds a `source` property to a user layer.\n */\nexport function UserLayerWithVolumeSourceMixin<TBase extends {new (...args: any[]): UserLayer}>(\n    Base: TBase) {\n  return helper(UserLayerWithAnnotationsMixin(UserLayerWithCoordinateTransformMixin(Base)));\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport interface DebouncedFunction {\n  /**\n   * Ensures the wrapped function will be run at the next animation frame.\n   */\n  (): void;\n\n  /**\n   * Cancels any outstanding call.\n   */\n  cancel(): void;\n\n  /**\n   * Runs any outstanding call immediately.\n   */\n  flush(): void;\n}\n\n/**\n * Returns a function that, when called, ensures `callback` is invoked at the next animation frame.\n */\nexport function animationFrameDebounce(callback: () => void): DebouncedFunction {\n  let handle = -1;\n  const cancel = () => {\n    if (handle !== -1) {\n      cancelAnimationFrame(handle);\n      handle = -1;\n    }\n  };\n  const flush = () => {\n    if (handle !== -1) {\n      handle = -1;\n      callback();\n    }\n  };\n  return Object.assign(() => {\n    if (handle === -1) {\n      handle = requestAnimationFrame(() => {\n        handle = -1;\n        callback();\n      });\n    }\n  }, {flush, cancel});\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport interface WritableArrayLike<T> {\n  length: number;\n  [n: number]: T;\n}\n\n/**\n * Partitions array[start:end] such that all elements for which predicate\n * returns true are before the elements for which predicate returns false.\n *\n * predicate will be called exactly once for each element in array[start:end],\n * in order.\n *\n * @returns {number} The index of the first element for which predicate returns\n * false, or end if there is no such element.\n */\nexport function partitionArray<T>(\n    array: T[], start: number, end: number, predicate: (x: T) => boolean): number {\n  while (start < end) {\n    let x = array[start];\n    if (predicate(x)) {\n      ++start;\n      continue;\n    }\n    --end;\n    array[start] = array[end];\n    array[end] = x;\n  }\n  return end;\n}\n\nexport interface TypedArrayConstructor {\n  new(n: number): TypedArray;\n  new(buffer: ArrayBuffer, byteOffset: number, length: number): TypedArray;\n  BYTES_PER_ELEMENT: number;\n}\n\nexport type TypedArray = Int8Array | Uint8Array | Int16Array | Uint16Array | Int32Array |\n    Uint32Array | Float32Array | Float64Array;\n\n/**\n * Returns an array of size newSize that starts with the contents of array.\n * Either returns array if it has the correct size, or a new array with zero\n * padding at the end.\n */\nexport function maybePadArray<T extends TypedArray>(array: T, newSize: number): T {\n  if (array.length === newSize) {\n    return array;\n  }\n  let newArray = new (<any>array.constructor)(newSize);\n  newArray.set(array);\n  return newArray;\n}\n\nexport function getFortranOrderStrides(size: ArrayLike<number>, baseStride = 1) {\n  let length = size.length;\n  let strides = new Array<number>(length);\n  let stride = strides[0] = baseStride;\n  for (let i = 1; i < length; ++i) {\n    stride *= size[i - 1];\n    strides[i] = stride;\n  }\n  return strides;\n}\n\n/**\n * Converts an array of shape [majorSize, minorSize] to\n * [minorSize, majorSize].\n */\nexport function transposeArray2d<T extends TypedArray>(\n    array: T, majorSize: number, minorSize: number): T {\n  let transpose = new (<any>array.constructor)(array.length);\n  for (let i = 0; i < majorSize * minorSize; i += minorSize) {\n    for (let j = 0; j < minorSize; j++) {\n      let index: number = i / minorSize;\n      transpose[j * majorSize + index] = array[i + j];\n    }\n  }\n  return transpose;\n}\n\nexport function tile2dArray<T extends TypedArray>(\n    array: T, majorDimension: number, minorTiles: number, majorTiles: number) {\n  const minorDimension = array.length / majorDimension;\n  const length = array.length * minorTiles * majorTiles;\n  const result: T = new (<any>array.constructor)(length);\n  const minorTileStride = array.length * majorTiles;\n  const majorTileStride = majorDimension;\n  const minorStride = majorDimension * majorTiles;\n  for (let minor = 0; minor < minorDimension; ++minor) {\n    for (let major = 0; major < majorDimension; ++major) {\n      const inputValue = array[minor * majorDimension + major];\n      const baseOffset = minor * minorStride + major;\n      for (let minorTile = 0; minorTile < minorTiles; ++minorTile) {\n        for (let majorTile = 0; majorTile < majorTiles; ++majorTile) {\n          result[minorTile * minorTileStride + majorTile * majorTileStride + baseOffset] =\n              inputValue;\n        }\n      }\n    }\n  }\n  return result;\n}\n\nexport function binarySearch<T>(\n    haystack: ArrayLike<T>, needle: T, compare: (a: T, b: T) => number, low = 0,\n    high = haystack.length) {\n  while (low < high) {\n    const mid = (low + high - 1) >> 1;\n    const compareResult = compare(needle, haystack[mid]);\n    if (compareResult > 0) {\n      low = mid + 1;\n    } else if (compareResult < 0) {\n      high = mid;\n    } else {\n      return mid;\n    }\n  }\n  return ~low;\n}\n\n\n/**\n * Returns the first index in `[begin, end)` for which `predicate` is `true`, or returns `end` if no\n * such index exists.\n *\n * For any index `i` in `(begin, end)`, it must be the case that `predicate(i) >= predicate(i - 1)`.\n */\nexport function binarySearchLowerBound(\n    begin: number, end: number, predicate: (index: number) => boolean): number {\n  let count = end - begin;\n  while (count > 0) {\n    let step = Math.floor(count / 2);\n    let i = begin + step;\n    if (predicate(i)) {\n      count = step;\n    } else {\n      begin = i + 1;\n      count -= step + 1;\n    }\n  }\n  return begin;\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport debounce from 'lodash/debounce';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport LinkedListOperations from 'neuroglancer/util/linked_list.0';\n\nclass AutomaticFocusList {\n  next0: AutomaticallyFocusedElement|null;\n  prev0: AutomaticallyFocusedElement|null;\n\n  constructor() {\n    LinkedListOperations.initializeHead(<any>this);\n  }\n}\n\nconst automaticFocusList = new AutomaticFocusList();\n\nconst maybeUpdateFocus = debounce(() => {\n  const {activeElement} = document;\n  if (activeElement === null || activeElement === document.body) {\n    const node = LinkedListOperations.front<AutomaticallyFocusedElement>(<any>automaticFocusList);\n    if (node !== null) {\n      node.element.focus();\n    }\n  }\n});\n\nwindow.addEventListener('focus', () => {\n  maybeUpdateFocus();\n}, true);\n\nwindow.addEventListener('blur', () => {\n  maybeUpdateFocus();\n}, true);\n\nexport class AutomaticallyFocusedElement extends RefCounted {\n  prev0: AutomaticallyFocusedElement|null = null;\n  next0: AutomaticallyFocusedElement|null = null;\n\n  private lastFocusedElement: Element|null = null;\n\n  private scheduleUpdateFocus = this.registerCancellable(debounce(() => {\n    const {activeElement} = document;\n    const {element} = this;\n    if (element.contains(activeElement) || activeElement instanceof HTMLInputElement ||\n        (activeElement instanceof HTMLElement && activeElement.isContentEditable) ||\n        activeElement instanceof HTMLTextAreaElement) {\n      // Never steal focus from descendant.\n      return;\n    }\n    if (activeElement != null &&\n        (activeElement === this.lastFocusedElement || activeElement.contains(element))) {\n      this.element.focus();\n    }\n    this.lastFocusedElement = null;\n  }, 0));\n\n  constructor(public element: HTMLElement) {\n    super();\n    element.tabIndex = -1;\n    this.registerEventListener(element, 'pointerdown', event => {\n      if (event.target !== element) return;\n      this.lastFocusedElement = null;\n      element.focus();\n    });\n    this.registerEventListener(element, 'mouseenter', () => {\n      this.lastFocusedElement = document.activeElement;\n      this.scheduleUpdateFocus();\n    });\n    this.registerEventListener(element, 'mouseleave', () => {\n      this.scheduleUpdateFocus.cancel();\n    });\n    // Insert at the end of the list.\n    LinkedListOperations.insertBefore(<any>automaticFocusList, this);\n    this.registerEventListener(element, 'focus', () => {\n      // Move to the beginning of the list.\n      LinkedListOperations.pop<AutomaticallyFocusedElement>(this);\n      LinkedListOperations.insertAfter(<any>automaticFocusList, this);\n    });\n    maybeUpdateFocus();\n  }\n\n  disposed() {\n    LinkedListOperations.pop<AutomaticallyFocusedElement>(this);\n    super.disposed();\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file\n * Cancellation token system with similarity to the cancellation_token in Microsoft's PPL.\n */\n\n/**\n * Interface used by cancelable operations to monitor whether cancellation has occurred.\n *\n * Note that this interface does not provide any way to trigger cancellation; for that,\n * CancellationTokenSource is used.\n */\nexport interface CancellationToken {\n  /**\n   * Indicates whether cancellation has occurred.\n   */\n  readonly isCanceled: boolean;\n\n  /**\n   * Add a cancellation handler function.  The handler will be invoked synchronously if\n   * this.isCanceled === true.  Otherwise, it will be invoked synchronously upon cancellation,\n   * unless it is removed prior to cancellation.\n   *\n   * The handler function must not throw any exceptions when called.\n   *\n   * @precondition The handler function must not already be registered.\n   *\n   * @param handler The handler function to add.\n   *\n   * @return A function that unregisters the handler.\n   */\n  add(handler: () => void): () => void;\n\n  /**\n   * Unregister a cancellation handler function.  If this.isCanceled, or the specified handler\n   * function has not been registered, then this function has no effect.\n   */\n  remove(handler: () => void): void;\n}\n\nclass CancellationError {\n  name = 'CancellationError';\n  message = 'CANCELED';\n  toString() {\n    return 'CANCELED';\n  }\n}\n\n/**\n * Singleton instance of CancellationError thrown to indicate cancellation.\n */\nexport const CANCELED = new CancellationError();\n\n/**\n * Throws CANCELED if token.isCanceled === true.\n */\nexport function throwIfCanceled(token: CancellationToken) {\n  if (token.isCanceled === true) {\n    throw CANCELED;\n  }\n}\n\nconst noopFunction = () => {};\n\n/**\n * CancellationToken that cannot be canceled.  This can be passed to operations that require a\n * CancellationToken but will not need to be canceled.\n */\nexport const uncancelableToken: CancellationToken = {\n  isCanceled: false,\n  add: () => noopFunction,\n  remove: noopFunction\n};\n\n/**\n * Class that can be used to trigger cancellation.\n */\nexport class CancellationTokenSource implements CancellationToken {\n  /**\n   * Trigger cancellation.\n   *\n   * If this.isCanceled === false, then each registered cancellation handler is invoked\n   * synchronously.\n   */\n  cancel() {\n    const {handlers} = this;\n    if (handlers !== null) {\n      this.handlers = null;\n      if (handlers !== undefined) {\n        for (let handler of handlers) {\n          handler();\n        }\n      }\n    }\n  }\n\n  get isCanceled() {\n    return this.handlers === null;\n  }\n\n  private handlers: Set<() => void>|undefined|null;\n\n  add(handler: () => void) {\n    let {handlers} = this;\n    if (handlers === null) {\n      handler();\n      return noopFunction;\n    }\n    if (handlers === undefined) {\n      handlers = this.handlers = new Set<() => void>();\n    }\n    handlers.add(handler);\n    return () => {\n      this.remove(handler);\n    };\n  }\n\n  remove(handler: () => void) {\n    const {handlers} = this;\n    if (handlers != null) {\n      handlers.delete(handler);\n    }\n  }\n}\n\n/**\n * Creates a CancellationToken corresponding to an asynchronous process with multiple consumers.  It\n * is cancelled only when the cancellation tokens corresponding to all of the consumers have been\n * cancelled.\n */\nexport class MultipleConsumerCancellationTokenSource extends CancellationTokenSource {\n  private consumers = new Set<CancellationToken>();\n\n  addConsumer(cancellationToken: CancellationToken = uncancelableToken) {\n    const {consumers} = this;\n    if (consumers.has(cancellationToken) || cancellationToken.isCanceled) {\n      return;\n    }\n    consumers.add(cancellationToken);\n    cancellationToken.add(() => {\n      consumers.delete(cancellationToken);\n      if (consumers.size === 0) {\n        this.cancel();\n      }\n    });\n  }\n}\n\n\n/**\n * Creates a promise and a dependent cancellation token.\n *\n * The dependent cancellation token will be canceled if the specified `cancellationToken` is\n * canceled while the promise is pending.\n *\n * @param cancellationToken The token that provides notification of cancellation.\n * @param executor The executor passed the resolve and reject functions for the promise, as well as\n * the dependent cancellation token.  If cancellation occurs after either resolve or reject is\n * called, then the dependent token is not cancelled.\n *\n * @returns A new Promise.\n */\nexport function makeCancelablePromise<T>(\n    cancellationToken: CancellationToken,\n    executor: (\n        resolve: (value: T|Promise<T>) => void, reject: (error: any) => void,\n        token: CancellationToken) => void) {\n  return new Promise<T>((resolve, reject) => {\n    if (cancellationToken === uncancelableToken) {\n      executor(resolve, reject, uncancelableToken);\n      return;\n    }\n    const scopedToken = new CancellationTokenSource();\n    const unregister = cancellationToken.add(() => {\n      scopedToken.cancel();\n    });\n    executor(\n        value => {\n          unregister();\n          resolve(value);\n        },\n        error => {\n          unregister();\n          reject(error);\n        },\n        scopedToken);\n  });\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {registerEventListener} from 'neuroglancer/util/disposable';\n\n/**\n * Returns true if the event appears to be targetted on input text and should not be overridden by a\n * global handler.\n */\nexport function eventHasInputTextTarget(event: Event) {\n  const selection = window.getSelection();\n  if (selection !== null && !selection.isCollapsed) {\n    return true;\n  }\n  const {tagName} = (<HTMLElement>event.target);\n  if (tagName === 'TEXTAREA' || tagName === 'INPUT') {\n    return true;\n  }\n  return false;\n}\n\nexport function setClipboard(data: string, format = 'text/plain') {\n  let success = false;\n  const cleanup = registerEventListener(document, 'copy', (event: ClipboardEvent) => {\n    const {clipboardData} = event;\n    if (clipboardData !== null) {\n      clipboardData.setData(format, data);\n      success = true;\n    }\n    event.stopPropagation();\n    event.preventDefault();\n  }, true);\n  try {\n    document.execCommand('copy');\n  } finally {\n    cleanup();\n  }\n  return success;\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Facilities for converting between strings and RGB/RGBA colors.\n */\n\nimport {WatchableValue} from 'neuroglancer/trackable_value';\nimport {float32ToString} from 'neuroglancer/util/float32_to_string';\nimport {vec3, vec4} from 'neuroglancer/util/geom';\nimport {hexEncodeByte} from 'neuroglancer/util/hex';\n\n/**\n * Parse the serialization of a color.\n *\n * This is based on the definition here:\n * https://html.spec.whatwg.org/multipage/canvas.html#serialisation-of-a-color\n */\nexport function parseColorSerialization(x: string) {\n  const rgbaPattern = /^rgba\\(([0-9]+), ([0-9]+), ([0-9]+), (0(?:\\.[0-9]+)?)\\)$/;\n  {\n    const m = x.match(rgbaPattern);\n    if (m !== null) {\n      return [parseInt(m[1], 10), parseInt(m[2], 10), parseInt(m[3], 10), parseFloat(m[4])];\n    }\n  }\n  const hexPattern = /^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/;\n  {\n    const m = x.match(hexPattern);\n    if (m !== null) {\n      return [parseInt(m[1], 16), parseInt(m[2], 16), parseInt(m[3], 16), 1.0];\n    }\n  }\n  throw new Error(`Invalid serialized color: ${JSON.stringify(x)}.`);\n}\n\nexport function parseRGBAColorSpecification(x: any) {\n  try {\n    if (typeof x !== 'string') {\n      throw new Error(`Expected string, but received ${JSON.stringify(x)}.`);\n    }\n    const context = document.createElement('canvas').getContext('2d')!;\n    context.fillStyle = x;\n    const result = parseColorSerialization(context.fillStyle);\n    return vec4.fromValues(result[0] / 255, result[1] / 255, result[2] / 255, result[3]);\n  } catch (parseError) {\n    throw new Error(`Failed to parse color specification: ${parseError.message}`);\n  }\n}\n\nexport function parseRGBColorSpecification(x: any) {\n  const result = parseRGBAColorSpecification(x);\n  return <vec3>result.subarray(0, 3);\n}\n\n/**\n * Returns an integer formed by concatenating the channels of the input color vector.\n * Each channel is clamped to the range [0.0, 1.0] before being converted to 8 bits.\n * An RGB color is packed into 24 bits, and a RGBA into 32 bits.\n */\nexport function packColor(x: vec3|vec4): number {\n  const size = (x[3] === undefined) ? 3 : 4;\n  let result = 0;\n  for (let i = 0; i < size; i++) {\n    // The \">>> 0\" ensures an unsigned value.\n    result = ((result << 8) >>> 0) + Math.min(255, Math.max(0, (Math.round(x[i] * 255))));\n  }\n  return result;\n}\n\nexport function serializeColor(x: vec3|vec4) {\n  if (x[3] === undefined || x[3] === 1) {\n    let result = '#';\n    for (let i = 0; i < 3; ++i) {\n      result += hexEncodeByte(Math.min(255, Math.max(0, Math.round(x[i] * 255))));\n    }\n    return result;\n  } else {\n    let result = 'rgba(';\n    for (let i = 0; i < 3; ++i) {\n      if (i !== 0) {\n        result += ', ';\n      }\n      result += Math.min(255, Math.max(0, Math.round(x[i] * 255)));\n    }\n    result += `, ${float32ToString(x[3])})`;\n    return result;\n  }\n}\n\nexport class TrackableRGB extends WatchableValue<vec3> {\n  constructor(public defaultValue: vec3) {\n    super(vec3.clone(defaultValue));\n  }\n  toString() {\n    return serializeColor(this.value);\n  }\n  toJSON() {\n    if (vec3.equals(this.value, this.defaultValue)) {\n      return undefined;\n    } else {\n      return serializeColor(this.value);\n    }\n  }\n  reset() {\n    this.value = vec3.clone(this.defaultValue);\n  }\n  restoreState(x: any) {\n    if (x === undefined) {\n      this.reset();\n      return;\n    }\n    const {value} = this;\n    const newValue = parseRGBColorSpecification(x);\n    if (!vec3.equals(value, newValue)) {\n      this.value = newValue;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Converts an HSV color (with h, s, v in [0,1]) to RGB (in range [0,1]).\n *\n * Based on goog/color/color.js in the Google Closure library.\n */\nexport function hsvToRgb(out: Float32Array, h: number, s: number, v: number): Float32Array {\n  h *= 6;\n  let hueIndex = Math.floor(h);\n  let remainder = h - hueIndex;\n  let val1 = v * (1 - s);\n  let val2 = v * (1 - (s * remainder));\n  let val3 = v * (1 - (s * (1 - remainder)));\n  switch (hueIndex % 6) {\n    case 0:\n      out[0] = v;\n      out[1] = val3;\n      out[2] = val1;\n      break;\n    case 1:\n      out[0] = val2;\n      out[1] = v;\n      out[2] = val1;\n      break;\n    case 2:\n      out[0] = val1;\n      out[1] = v;\n      out[2] = val3;\n      break;\n    case 3:\n      out[0] = val1;\n      out[1] = val2;\n      out[2] = v;\n      break;\n    case 4:\n      out[0] = val3;\n      out[1] = val1;\n      out[2] = v;\n      break;\n    case 5:\n      out[0] = v;\n      out[1] = val1;\n      out[2] = val2;\n      break;\n  }\n  return out;\n}\n\n\n/**\n * Converts from RGB values (with r,g,b in range [0,1]) to an array of HSV values (in range [0, 1])\n *\n * Based on goog/color/color.js in the Google Closure library.\n */\nexport function rgbToHsv(out: Float32Array, r: number, g: number, b:number): Float32Array {\n\n    const max = Math.max(Math.max(r, g), b);\n    const min = Math.min(Math.min(r, g), b);\n    out[2] = max;\n    if (min === max) {\n      out[0] = 0;\n      out[1] = 0;\n    } else {\n      const delta = (max - min);\n      out[1] = delta / max;\n\n      if (r === max) {\n        out[0] = (g - b) / delta;\n      } else if (g === max) {\n        out[0] = 2 + ((b - r) / delta);\n      } else {\n        out[0] = 4 + ((r - g) / delta);\n      }\n      out[0] /= 6.0;\n      if (out[0] < 0.0) {\n        out[0] += 1.0;\n      }\n      if (out[0] > 1.0) {\n        out[0] -= 1.0;\n      }\n    }\n    return out;\n  };\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function approxEqual(a: number, b: number): boolean {\n  if (a === b) {\n    return true;\n  }\n  return (Math.abs(a - b) / Math.min(Math.abs(a), Math.abs(b)) < 1e-6);\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport interface Completion { value: string; }\n\nexport interface CompletionWithDescription extends Completion { description?: string; }\n\nexport interface BasicCompletionResult {\n  completions: Completion[];\n  offset: number;\n}\n\nexport function applyCompletionOffset<T extends{offset: number}>(\n    offset: number, completionResult: T) {\n  completionResult.offset += offset;\n  return completionResult;\n}\n\nexport function getPrefixMatches(prefix: string, options: Iterable<string>) {\n  let result: Completion[] = [];\n  for (let option of options) {\n    if (option.startsWith(prefix)) {\n      result.push({value: option});\n    }\n  }\n  return result;\n}\n\nexport function getPrefixMatchesWithDescriptions<T>(\n    prefix: string, options: Iterable<T>, getValue: (x: T) => string,\n    getDescription: (x: T) => string | undefined) {\n  let result: CompletionWithDescription[] = [];\n  for (let option of options) {\n    let key = getValue(option);\n    if (key.startsWith(prefix)) {\n      result.push({value: key, description: getDescription(option)});\n    }\n  }\n  return result;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * If this is updated, DATA_TYPE_BYTES must also be updated.\n */\nexport enum DataType {\n  UINT8 = 0,\n  UINT16 = 1,\n  UINT32 = 2,\n  UINT64 = 3,\n  FLOAT32 = 4,\n}\n\ninterface DataTypeBytes {\n  [index: number]: number;\n}\n\nexport const DATA_TYPE_BYTES: DataTypeBytes = [];\nDATA_TYPE_BYTES[DataType.UINT8] = 1;\nDATA_TYPE_BYTES[DataType.UINT16] = 2;\nDATA_TYPE_BYTES[DataType.UINT32] = 4;\nDATA_TYPE_BYTES[DataType.UINT64] = 8;\nDATA_TYPE_BYTES[DataType.FLOAT32] = 4;\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Uint64} from 'neuroglancer/util/uint64';\n\nconst rankSymbol = Symbol('disjoint_sets:rank');\nconst parentSymbol = Symbol('disjoint_sets:parent');\nconst nextSymbol = Symbol('disjoint_sets:next');\nconst prevSymbol = Symbol('disjoint_sets:prev');\n\nfunction findRepresentative(v: any): any {\n  // First pass: find the root, which will be stored in ancestor.\n  let old = v;\n  let ancestor = v[parentSymbol];\n  while (ancestor !== v) {\n    v = ancestor;\n    ancestor = v[parentSymbol];\n  }\n  // Second pass: set all of the parent pointers along the path from the\n  // original element `old' to refer directly to the root `ancestor'.\n  v = old[parentSymbol];\n  while (ancestor !== v) {\n    old[parentSymbol] = ancestor;\n    old = v;\n    v = old[parentSymbol];\n  }\n  return ancestor;\n}\n\nfunction linkUnequalSetRepresentatives(i: any, j: any): any {\n  let iRank = i[rankSymbol];\n  let jRank = j[rankSymbol];\n  if (iRank > jRank) {\n    j[parentSymbol] = i;\n    return i;\n  }\n\n  i[parentSymbol] = j;\n  if (iRank === jRank) {\n    j[rankSymbol] = jRank + 1;\n  }\n  return j;\n}\n\nfunction spliceCircularLists(i: any, j: any) {\n  let iPrev = i[prevSymbol];\n  let jPrev = j[prevSymbol];\n\n  // Connect end of i to beginning of j.\n  j[prevSymbol] = iPrev;\n  iPrev[nextSymbol] = j;\n\n  // Connect end of j to beginning of i.\n  i[prevSymbol] = jPrev;\n  jPrev[nextSymbol] = i;\n}\n\n\n\nfunction* setElementIterator(i: any) {\n  let j = i;\n  do {\n    yield j;\n    j = j[nextSymbol];\n  } while (j !== i);\n}\n\nfunction initializeElement(v: any) {\n  v[parentSymbol] = v;\n  v[rankSymbol] = 0;\n  v[nextSymbol] = v[prevSymbol] = v;\n}\n\nconst minSymbol = Symbol('disjoint_sets:min');\n\nfunction isRootElement(v: any) {\n  return v[parentSymbol] === v;\n}\n\n/**\n * Represents a collection of disjoint sets of Uint64 values.\n *\n * Supports merging sets, retrieving the minimum Uint64 value contained in a set (the representative\n * value), and iterating over the elements contained in a set.\n */\nexport class DisjointUint64Sets {\n  private map = new Map<string, Uint64>();\n  generation = 0;\n\n  get(x: Uint64): Uint64 {\n    let key = x.toString();\n    let element = this.map.get(key);\n    if (element === undefined) {\n      return x;\n    }\n    return findRepresentative(element)[minSymbol];\n  }\n\n  isMinElement(x: Uint64) {\n    let y = this.get(x);\n    return (y === x || Uint64.equal(y, x));\n  }\n\n  private makeSet(x: Uint64): Uint64 {\n    let key = x.toString();\n    let {map} = this;\n    let element = map.get(key);\n    if (element === undefined) {\n      element = x.clone();\n      initializeElement(element);\n      (<any>element)[minSymbol] = element;\n      map.set(key, element);\n      return element;\n    }\n    return findRepresentative(element);\n  }\n\n  link(a: Uint64, b: Uint64): boolean {\n    a = this.makeSet(a);\n    b = this.makeSet(b);\n    if (a === b) {\n      return false;\n    }\n    this.generation++;\n    let newNode = linkUnequalSetRepresentatives(a, b);\n    spliceCircularLists(a, b);\n    let aMin = (<any>a)[minSymbol];\n    let bMin = (<any>b)[minSymbol];\n    newNode[minSymbol] = Uint64.less(aMin, bMin) ? aMin : bMin;\n    return true;\n  }\n\n  * setElements(a: Uint64): IterableIterator<Uint64> {\n    let key = a.toString();\n    let element = this.map.get(key);\n    if (element === undefined) {\n      yield a;\n    } else {\n      yield* setElementIterator(element);\n    }\n  }\n\n  clear() {\n    let {map} = this;\n    if (map.size === 0) {\n      return false;\n    }\n    ++this.generation;\n    map.clear();\n    return true;\n  }\n\n  get size() {\n    return this.map.size;\n  }\n\n  * mappings(temp = <[Uint64, Uint64]>new Array<Uint64>(2)) {\n    for (let element of this.map.values()) {\n      temp[0] = element;\n      temp[1] = findRepresentative(element)[minSymbol];\n      yield temp;\n    }\n  }\n\n  [Symbol.iterator]() {\n    return this.mappings();\n  }\n\n  /**\n   * Returns an array of arrays of strings, where the arrays contained in the outer array correspond\n   * to the disjoint sets, and the strings are the base-10 string representations of the members of\n   * each set.  The members are sorted in numerical order, and the sets are sorted in numerical\n   * order of their smallest elements.\n   */\n  toJSON(): string[][] {\n    let sets = new Array<Uint64[]>();\n    for (let element of this.map.values()) {\n      if (isRootElement(element)) {\n        let members = new Array<Uint64>();\n        for (let member of setElementIterator(element)) {\n          members.push(member);\n        }\n        members.sort(Uint64.compare);\n        sets.push(members);\n      }\n    }\n    sets.sort((a, b) => Uint64.compare(a[0], b[0]));\n    return sets.map(set => set.map(element => element.toString()));\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport interface Disposable { dispose: () => void; }\n\nexport type Disposer = Disposable | (() => void);\n\nexport function invokeDisposer(disposer: Disposer) {\n  if (typeof disposer === 'object') {\n    disposer.dispose();\n  } else {\n    disposer();\n  }\n}\n\nexport function invokeDisposers(disposers: Disposer[]) {\n  for (let i = disposers.length; i > 0; --i) {\n    invokeDisposer(disposers[i - 1]);\n  }\n}\n\nexport function registerEventListener(\n    target: EventTarget, type: string, listener: EventListenerOrEventListenerObject,\n    options?: boolean|AddEventListenerOptions) {\n  target.addEventListener(type, listener, options);\n  return () => target.removeEventListener(type, listener, options);\n}\n\nexport class RefCounted implements Disposable {\n  public refCount = 1;\n  wasDisposed: boolean|undefined;\n  private disposers: Disposer[];\n  addRef() {\n    ++this.refCount;\n    return this;\n  }\n  dispose() {\n    if (--this.refCount !== 0) {\n      return;\n    }\n    this.refCountReachedZero();\n  }\n\n  protected refCountReachedZero() {\n    this.disposed();\n    let {disposers} = this;\n    if (disposers !== undefined) {\n      invokeDisposers(disposers);\n      this.disposers = <any>undefined;\n    }\n    this.wasDisposed = true;\n  }\n  disposed() {}\n  registerDisposer<T extends Disposer>(f: T): T {\n    let {disposers} = this;\n    if (disposers == null) {\n      this.disposers = [f];\n    } else {\n      disposers.push(f);\n    }\n    return f;\n  }\n  unregisterDisposer<T extends Disposer>(f: T): T {\n    let {disposers} = this;\n    if (disposers != null) {\n      let index = disposers.indexOf(f);\n      if (index !== -1) {\n        disposers.splice(index, 1);\n      }\n    }\n    return f;\n  }\n  registerEventListener(\n      target: EventTarget, type: string, listener: EventListenerOrEventListenerObject,\n      options?: boolean|AddEventListenerOptions) {\n    this.registerDisposer(registerEventListener(target, type, listener, options));\n  }\n  registerCancellable<T extends{cancel: () => void}>(cancellable: T) {\n    this.registerDisposer(() => {\n      cancellable.cancel();\n    });\n    return cancellable;\n  }\n}\n\nexport class RefCountedValue<T> extends RefCounted {\n  constructor(public value: T) {\n    super();\n  }\n}\n\n/**\n * A variable of this type is associated with an increment of the reference count.  If a function\n * parameter is declared with this type, then callers must donate a reference count.\n */\nexport type Owned<T extends Disposable> = T;\n\n/**\n * A variable of this type is not associated with an increment of the reference count.\n */\nexport type Borrowed<T extends Disposable> = T;\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function removeChildren(element: HTMLElement) {\n  while (true) {\n    let child = element.firstElementChild;\n    if (!child) {\n      break;\n    }\n    element.removeChild(child);\n  }\n}\n\nexport function removeFromParent(element: HTMLElement) {\n  let {parentElement} = element;\n  if (parentElement) {\n    parentElement.removeChild(element);\n    return true;\n  }\n  return false;\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Facilities for encoding arbitrary strings as HTML5 Drag-and-drop types.\n *\n * The HTML5 Drag and Drop mechanism provides a way of attaching a set of (string key -> string\n * value) mappings to a drag.  The keys can be retrieved by any target the drag passes over, while\n * the values can only be retrieved when the actual \"drop\" happens.  Therefore, any data that needs\n * to be available prior to the drop must be stored as a key.  Additionally, the key strings are\n * munged.  According to the spec\n * <https://dev.w3.org/html5/spec-preview/dnd.html#the-drag-data-store>, the keys are converted to\n * ASCII lowercase, which means that only ASCII uppercase letters are modified, and all other\n * Unicode characters are preserved.  However, Chrome 62 does not appear to follow the spec, and\n * munges other characters as well.  Therefore, we hex encode to be safe.\n */\n\nimport {hexEncode, hexDecode} from 'neuroglancer/util/hex';\nimport {registerEventListener} from 'neuroglancer/util/disposable';\n\nexport function encodeStringAsDragType(s: string) {\n  return hexEncode(new TextEncoder().encode(s));\n}\n\nexport function decodeStringFromDragType(s: string) {\n  return new TextDecoder().decode(hexDecode(s));\n}\n\nexport function encodeDragType(prefix: string, parameters: any) {\n  return prefix + encodeStringAsDragType(JSON.stringify(parameters));\n}\n\nexport function decodeParametersFromDragType(dragType: string, prefix: string) {\n  if (!dragType.startsWith(prefix)) {\n    return undefined;\n  }\n  try {\n    const jsonString = decodeStringFromDragType(dragType.substring(prefix.length));\n    return JSON.parse(jsonString);\n  } catch {\n    return undefined;\n  }\n}\n\nexport function encodeParametersAsDragType(prefix: string, parameters: any) {\n  return prefix + encodeStringAsDragType(JSON.stringify(parameters));\n}\n\nexport interface DragInfo {\n  dragType: string;\n  parameters: any;\n}\n\nexport function decodeParametersFromDragTypeList(\n    dragTypes: ReadonlyArray<string>, prefix: string): DragInfo|undefined {\n  for (const dragType of dragTypes) {\n    const parameters = decodeParametersFromDragType(dragType, prefix);\n    if (parameters !== undefined) {\n      return {parameters, dragType};\n    }\n  }\n  return undefined;\n}\n\nlet savedDropEffect: string;\n\n/**\n * On Chrome 62, the dataTransfer.dropEffect property is reset to 'none' when the 'drop' event is\n * dispatched.  As a workaround, we store it in a global variable.\n *\n * The alternative workaround of recomputing it in the 'drop' event handler is problematic for a\n * different reason: the computation may depend on the modifier key states, and on Firefox 52, these\n * key states are not set in the 'drop' event.\n */\nexport function setDropEffect<T extends string>(event: DragEvent, dropEffect: T) {\n  event.dataTransfer!.dropEffect = dropEffect;\n  savedDropEffect = dropEffect;\n  return dropEffect;\n}\n\nexport function getDropEffect() {\n  return savedDropEffect;\n}\n\nexport function preventDrag(element: HTMLElement) {\n  element.draggable = true;\n  return registerEventListener(element, 'dragstart', (event: DragEvent) => {\n    event.stopPropagation();\n    event.preventDefault();\n  });\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file\n * Utilities for positioning dropdown menus.\n */\n\nexport function positionDropdown(dropdownElement: HTMLElement, associatedElement: HTMLElement, {\n  horizontal = false,\n  vertical = true,\n  topMargin = 6,\n  bottomMargin = 6,\n  leftMargin = 6,\n  rightMargin = 6,\n  maxHeight = true,\n  maxWidth = true\n} = {}) {\n  let rect = associatedElement.getBoundingClientRect();\n\n  if (horizontal) {\n    let viewportWidth = dropdownElement.ownerDocument!.documentElement!.clientHeight;\n    let distanceLeft = rect.right;\n    let distanceRight = viewportWidth - rect.left;\n    if (distanceLeft > distanceRight) {\n      dropdownElement.style.left = '';\n      dropdownElement.style.right = '0';\n      if (maxWidth) {\n        dropdownElement.style.maxWidth = (distanceLeft - leftMargin) + 'px';\n      }\n    } else {\n      dropdownElement.style.right = '';\n      dropdownElement.style.left = '0';\n      if (maxWidth) {\n        dropdownElement.style.maxWidth = (distanceRight - rightMargin) + 'px';\n      }\n    }\n  }\n\n  if (vertical) {\n    let viewportHeight = dropdownElement.ownerDocument!.documentElement!.clientHeight;\n    let distanceToTop = rect.top - topMargin;\n    let distanceToBottom = viewportHeight - rect.bottom - bottomMargin;\n    if (distanceToTop > distanceToBottom * 3) {\n      dropdownElement.style.top = '';\n      dropdownElement.style.bottom = '100%';\n      if (maxHeight) {\n        dropdownElement.style.maxHeight = distanceToTop + 'px';\n      }\n    } else {\n      dropdownElement.style.top = '100%';\n      dropdownElement.style.bottom = '';\n      if (maxHeight) {\n        dropdownElement.style.maxHeight = distanceToBottom + 'px';\n      }\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {registerEventListener} from 'neuroglancer/util/disposable';\nimport {HierarchicalMap, HierarchicalMapInterface} from 'neuroglancer/util/hierarchical_map';\n\n/**\n * @file Facilities for dispatching user-defined actions in response to input events.\n */\n\n/**\n * Specifies a unique string representation of an input event, used for matching an input event to a\n * corresponding action with which it has been associated.\n *\n * The EventIdentifier combines several pieces of information using the following syntax:\n *\n *   NormalizedEventIdentifier ::= phase ':' ( modifier '+' )* base-event-identifier\n *\n *   - The event `phase` name, corresponding to the phase of DOM event processing at which the event was\n *     received, which may be 'at', 'bubble', or 'capture'.  (Currently, 'capture' is not supported.)\n *\n *   - The set of `modifier` keys ('control', 'alt', 'meta', and/or 'shift') active when the event occurred.\n *\n *   - The `base-event-identifier`, which in the case of keyboard events is the lowercase KeyboardEvent\n *     `code`, and in the case of mouse events is one of:\n *\n *       - 'mousedown' + n\n *       - 'mouseup' + n\n *       - 'click' + n\n *       - 'dblclick' + n\n *       - 'wheel'\n *\n *     where `n` is the index of the mouse button, starting from 0.\n *\n * In the normalized form used for matching events, the set of modifiers must be specified in\n * exactly the order: 'control', 'alt', 'meta', 'shift'.  Consequently, there is exactly one\n * NormalizedEventIdentifier representation for a given input event.\n */\nexport type NormalizedEventIdentifier = string;\n\n/**\n * An EventIdentifier specifies a criteria for matching input events using a relaxed form of the\n * NormalizedEventIdentifier syntax.  Each EventIdentifier corresponds to one or more\n * NormalizedEventIdentifier values.\n *\n *   EventIdentifier ::= [ phase ':' ] ( modifier '+' )* base-event-identifier\n *\n * In addition to the phase being optional, the modifiers may be specified in any order.  If the\n * phase is not specified, then the EventIdentifier matches both the 'at' and 'bubble' phases.\n */\nexport type EventIdentifier = string;\n\n/**\n * Identifies a user-defined action name.  Actions are dispatched as DOM events, using 'action:'\n * prepended to the ActionIdentifier as the event type.\n */\nexport type ActionIdentifier = string;\n\n/**\n * Specifies how to handle an event.\n */\nexport interface EventAction {\n  /**\n   * Identifier of action to dispatch.\n   */\n  action: ActionIdentifier;\n\n  /**\n   * Whether to call `stopPropagation()` on the triggering event.  Defaults to true.\n   */\n  stopPropagation?: boolean;\n\n  /**\n   * Whether to call `preventDefault()` on the triggering event.  Defaults to true.  Additionally,\n   * if `preventDefault()` is called on the dispatched ActionEvent, `preventDefault()` will also be\n   * called on the triggering event regardless of the value of `preventDefault`.\n   */\n  preventDefault?: boolean;\n}\n\nexport type EventActionMapInterface =\n    HierarchicalMapInterface<NormalizedEventIdentifier, EventAction>;\n\nexport const enum Modifiers {\n  CONTROL = 1,\n  ALT = 2,\n  META = 4,\n  SHIFT = 8,\n}\n\nexport type ModifierMask = number;\n\nexport interface EventModifierKeyState {\n  ctrlKey: boolean;\n  altKey: boolean;\n  metaKey: boolean;\n  shiftKey: boolean;\n}\n\nexport function getEventModifierMask(event: EventModifierKeyState): ModifierMask {\n  return (event.ctrlKey ? Modifiers.CONTROL : 0) | (event.altKey ? Modifiers.ALT : 0) |\n      (event.metaKey ? Modifiers.META : 0) | (event.shiftKey ? Modifiers.SHIFT : 0);\n}\n\nexport function getStrokeIdentifier(keyName: string, modifiers: ModifierMask) {\n  let identifier = '';\n  if (modifiers & Modifiers.CONTROL) {\n    identifier += 'control+';\n  }\n  if (modifiers & Modifiers.ALT) {\n    identifier += 'alt+';\n  }\n  if (modifiers & Modifiers.META) {\n    identifier += 'meta+';\n  }\n  if (modifiers & Modifiers.SHIFT) {\n    identifier += 'shift+';\n  }\n  identifier += keyName;\n  return identifier;\n}\n\nfunction normalizeModifiersAndBaseIdentifier(identifier: string): string|undefined {\n  let parts = identifier.split('+');\n  let keyName: string|undefined;\n  let modifiers = 0;\n  for (let part of parts) {\n    switch (part) {\n      case 'control':\n        modifiers |= Modifiers.CONTROL;\n        break;\n      case 'alt':\n        modifiers |= Modifiers.ALT;\n        break;\n      case 'meta':\n        modifiers |= Modifiers.META;\n        break;\n      case 'shift':\n        modifiers |= Modifiers.SHIFT;\n        break;\n      default:\n        if (keyName === undefined) {\n          keyName = part;\n        } else {\n          return undefined;\n        }\n    }\n  }\n  if (keyName === undefined) {\n    return undefined;\n  }\n  return getStrokeIdentifier(keyName, modifiers);\n}\n\n/**\n * Specifies either an EventAction or a bare ActionIdentifier.\n */\ntype ActionOrEventAction = EventAction|ActionIdentifier;\n\n/**\n * Normalizes an ActionOrEventAction into an EventAction.\n */\nexport function normalizeEventAction(action: ActionOrEventAction): EventAction {\n  if (typeof action === 'string') {\n    return {action: action};\n  }\n  return action;\n}\n\n/**\n * Normalizes a user-specified EventIdentifier into a list of one or more corresponding\n * NormalizedEventIdentifier strings.\n */\nexport function*\n    normalizeEventIdentifier(identifier: EventIdentifier):\n        IterableIterator<NormalizedEventIdentifier> {\n  const firstColonOffset = identifier.indexOf(':');\n  const suffix =\n      normalizeModifiersAndBaseIdentifier(identifier.substring(firstColonOffset + 1));\n  if (suffix === undefined) {\n    throw new Error(`Invalid event identifier: ${JSON.stringify(identifier)}`);\n  }\n  if (firstColonOffset !== -1) {\n    const prefix = identifier.substring(0, firstColonOffset);\n    // TODO(jbms): Support capture phase.\n    if (prefix !== 'at' && prefix !== 'bubble') {\n      throw new Error(`Invalid event phase: ${JSON.stringify(prefix)}`);\n    }\n    yield`${prefix}:${suffix}`;\n  } else {\n    yield`at:${suffix}`;\n    yield`bubble:${suffix}`;\n  }\n}\n\n/**\n * Hierarchical map of `EventIdentifier` specifications to `EventAction` specifications.  These maps\n * are used by KeyboardEventBinder and MouseEventBinder to dispatch an ActionEvent in response to an\n * input event.\n */\nexport class EventActionMap extends HierarchicalMap<NormalizedEventIdentifier, EventAction, EventActionMap>\n    implements EventActionMapInterface {\n  label: string|undefined;\n\n  /**\n   * Returns a new EventActionMap with the specified bindings.\n   *\n   * The keys of the `bindings` object specify unnormalized event identifiers to be mapped to their\n   * corresponding `ActionOrEventAction` values.\n   */\n  static fromObject(\n      bindings: {[key: string]: ActionOrEventAction},\n      options: {label?: string, parents?: Iterable<[EventActionMap, number]>} = {}) {\n    const map = new EventActionMap();\n    map.label = options.label;\n    if (options.parents !== undefined) {\n      for (const [parent, priority] of options.parents) {\n        map.addParent(parent, priority);\n      }\n    }\n    for (const key of Object.keys(bindings)) {\n      map.set(key, normalizeEventAction(bindings[key]));\n    }\n    return map;\n  }\n\n  setFromObject(bindings: {[key: string]: ActionOrEventAction}) {\n    for (const key of Object.keys(bindings)) {\n      this.set(key, normalizeEventAction(bindings[key]));\n    }\n  }\n\n  /**\n   * Maps the specified event `identifier` to the specified `action`.\n   *\n   * The `identifier` may be unnormalized; the actual mapping is created for each corresponding\n   * normalized identifier.\n   */\n  set(identifier: EventIdentifier, action: ActionOrEventAction) {\n    const normalizedAction = normalizeEventAction(action);\n    for (const normalizedIdentifier of normalizeEventIdentifier(identifier)) {\n      super.set(normalizedIdentifier, normalizedAction);\n    }\n  }\n\n  /**\n   * Deletes the mapping for the specified `identifier`.\n   *\n   * The `identifier` may be unnormalized; the mapping is deleted for each corresponding normalized\n   * identifier.\n   */\n  delete(identifier: EventIdentifier) {\n    for (const normalizedIdentifier of normalizeEventIdentifier(identifier)) {\n      super.delete(normalizedIdentifier);\n    }\n  }\n\n  describe(): string {\n    const bindings = [];\n    const uniqueBindings = new Map<string, string>();\n    for (const [key, value] of this.entries()) {\n      const split = key.indexOf(':');\n      uniqueBindings.set(key.substring(split+1), value.action);\n    }\n    for (const [key, value] of uniqueBindings) {\n      bindings.push(`${key}${value}`);\n    }\n    return bindings.join(', ');\n  }\n}\n\nexport function dispatchEventAction(\n      originalEvent: Event, detail: any, eventAction: EventAction|undefined) {\n  if (eventAction === undefined) {\n    return;\n  }\n  if (eventAction.stopPropagation !== false) {\n    originalEvent.stopPropagation();\n  }\n  const actionEvent = new CustomEvent(\n      'action:' + eventAction.action, {'bubbles': true, detail: detail, cancelable: true});\n  const cancelled = !originalEvent.target!.dispatchEvent(actionEvent);\n  if (eventAction.preventDefault !== false || cancelled) {\n    originalEvent.preventDefault();\n  }\n}\n\nexport const eventPhaseNames: string[] = [];\neventPhaseNames[Event.AT_TARGET] = 'at';\neventPhaseNames[Event.CAPTURING_PHASE] = 'capture';\neventPhaseNames[Event.BUBBLING_PHASE] = 'bubble';\n\nexport function dispatchEvent(\n  baseIdentifier: EventIdentifier, originalEvent: Event, eventPhase: number, detail: any,\n    eventMap: EventActionMapInterface) {\n  const eventIdentifier = eventPhaseNames[eventPhase] + ':' + baseIdentifier;\n  const eventAction = eventMap.get(eventIdentifier);\n  dispatchEventAction(originalEvent, detail, eventAction);\n}\n\nexport function dispatchEventWithModifiers(\n    baseIdentifier: EventIdentifier, originalEvent: Event&EventModifierKeyState, detail: any,\n    eventMap: EventActionMapInterface) {\n  dispatchEvent(\n      getStrokeIdentifier(baseIdentifier, getEventModifierMask(originalEvent)), originalEvent,\n      originalEvent.eventPhase, detail, eventMap);\n}\n\n/**\n * DOM Event type used for dispatching actions.\n *\n * Additional information relevant to the acction is specified as the `detail` property.\n */\nexport interface ActionEvent<Info> extends CustomEvent {\n  detail: Info;\n}\n\n/**\n * Register an event listener for the specified `action`.\n *\n * There is no checking that the `TriggerEvent` type is suitable for use with the specified\n * `action`.\n *\n * @returns A nullary disposer function that unregisters the listener when called.\n */\nexport function registerActionListener<Info>(\n    target: EventTarget, action: ActionIdentifier, listener: (event: ActionEvent<Info>) => void,\n    options?: boolean|AddEventListenerOptions) {\n  return registerEventListener(target, `action:${action}`, listener, options);\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\nconst tempArray = new Float32Array(1);\n\n/**\n * Converts `x` into its nearest single precision float representation and\n * returns a minimal string representation, with as many digits as necessary\n * to uniquely distinguish single precision `x` from its adjacent single\n * precision values.\n *\n * E.g.: 0.299999999000000017179701217174d  0.30000001192092896f  '0.3')\n */\nexport function float32ToString(x: number) {\n  tempArray[0] = x;\n  x = tempArray[0];\n  for (let digits = 1; digits < 21; ++digits) {\n    let result = x.toPrecision(digits);\n    tempArray[0] = parseFloat(result);\n    if (tempArray[0] === x) {\n      return result;\n    }\n  }\n  return x.toString();\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {mat3, mat4, quat, vec3} from 'gl-matrix';\n\nexport {mat2, mat3, mat4, quat, vec2, vec3, vec4} from 'gl-matrix';\n\nexport const identityMat4 = mat4.create();\n\nexport const AXES_NAMES = ['x', 'y', 'z'];\n\nexport class BoundingBox {\n  constructor(public lower: vec3, public upper: vec3) {}\n}\n\nexport const kAxes = [\n  vec3.fromValues(1, 0, 0),\n  vec3.fromValues(0, 1, 0),\n  vec3.fromValues(0, 0, 1),\n];\nexport const kZeroVec = vec3.fromValues(0, 0, 0);\nexport const kOneVec = vec3.fromValues(1, 1, 1);\nexport const kInfinityVec = vec3.fromValues(Infinity, Infinity, Infinity);\nexport const kIdentityQuat = quat.create();\n\nexport function prod3(x: ArrayLike<number>) {\n  return x[0] * x[1] * x[2];\n}\n\nexport function prod4(x: ArrayLike<number>) {\n  return x[0] * x[1] * x[2] * x[3];\n}\n\n/**\n * Implements a one-to-one conversion from Vec3 to string, suitable for use a Map key.\n *\n * Specifically, returns the string representation of the 3 values separated by commas.\n */\nexport function vec3Key(x: ArrayLike<number>) {\n  return `${x[0]},${x[1]},${x[2]}`;\n}\n\nconst RECTIFY_EPSILON = 1e-4;\n\nexport function rectifyVec3IfAxisAligned(v: Float32Array, offset: number) {\n  let a0 = Math.abs(v[offset]), a1 = Math.abs(v[offset + 1]), a2 = Math.abs(v[offset + 2]);\n  let max = Math.max(a0, a1, a2);\n  if (a0 / max < RECTIFY_EPSILON) {\n    v[offset] = 0;\n  }\n  if (a1 / max < RECTIFY_EPSILON) {\n    v[offset + 1] = 0;\n  }\n  if (a2 / max < RECTIFY_EPSILON) {\n    v[offset + 2] = 0;\n  }\n}\n\n/**\n * Makes columns of m that are approximately axis-aligned exactly axis aligned.\n *\n * Note that mat is stored in Fortran order, and therefore the first column is m[0], m[1], m[2].\n */\nexport function rectifyTransformMatrixIfAxisAligned(m: mat4) {\n  rectifyVec3IfAxisAligned(m, 0);\n  rectifyVec3IfAxisAligned(m, 4);\n  rectifyVec3IfAxisAligned(m, 8);\n}\n\n/**\n * Transforms `a` by a 180-degree rotation about X, stores result in `out`.\n */\nexport function quatRotateX180(out: quat, a: quat) {\n  let x = a[0], y = a[1], z = a[2], w = a[3];\n  out[0] = w;\n  out[1] = z;\n  out[2] = -y;\n  out[3] = -x;\n}\n\n/**\n * Transforms `a` by a 180-degree rotation about Y, stores result in `out`.\n */\nexport function quatRotateY180(out: quat, a: quat) {\n  let x = a[0], y = a[1], z = a[2], w = a[3];\n  out[0] = -z;\n  out[1] = w;\n  out[2] = x;\n  out[3] = -y;\n}\n\n/**\n * Transforms `a` by a 180-degree rotation about Z, stores result in `out`.\n */\nexport function quatRotateZ180(out: quat, a: quat) {\n  let x = a[0], y = a[1], z = a[2], w = a[3];\n  out[0] = y;\n  out[1] = -x;\n  out[2] = w;\n  out[3] = -z;\n}\n\n\n/**\n * Transforms a vector `a` by a homogenous transformation matrix `m`.  The translation component of\n * `m` is ignored.\n */\nexport function transformVectorByMat4(out: vec3, a: vec3, m: mat4) {\n  let x = a[0], y = a[1], z = a[2];\n  out[0] = m[0] * x + m[4] * y + m[8] * z;\n  out[1] = m[1] * x + m[5] * y + m[9] * z;\n  out[2] = m[2] * x + m[6] * y + m[10] * z;\n  return out;\n}\n\n\n/**\n * Computes the effective scaling factor of each local spatial dimension by `m`, which is assumed to\n * transform local coordinates to global coordinates.\n */\nexport function effectiveScalingFactorFromMat4(out: vec3, m: mat4) {\n  const m0 = m[0], m1 = m[1], m2 = m[2], m4 = m[4], m5 = m[5], m6 = m[6], m8 = m[8], m9 = m[9],\n        m10 = m[10];\n  out[0] = Math.sqrt(m0 * m0 + m1 * m1 + m2 * m2);\n  out[1] = Math.sqrt(m4 * m4 + m5 * m5 + m6 * m6);\n  out[2] = Math.sqrt(m8 * m8 + m9 * m9 + m10 * m10);\n  return out;\n}\n\nexport function translationRotationScaleZReflectionToMat4(\n    out: mat4, translation: vec3, rotation: quat, scale: vec3, zReflection: number) {\n  const temp: Float32Array = out;\n  out[0] = scale[0];\n  out[1] = scale[1];\n  out[2] = scale[2] * zReflection;\n  return mat4.fromRotationTranslationScale(out, rotation, translation, <vec3>temp);\n}\n\n/**\n * Returns the value of `t` that minimizes `(p - (a + t * (b - a)))`.\n */\nexport function findClosestParameterizedLinePosition(a: vec3, b: vec3, p: vec3) {\n  // http://mathworld.wolfram.com/Point-LineDistance3-Dimensional.html\n  // Compute t: -dot(a-p, b-a) / |b - a|^2\n  const denominator = vec3.squaredDistance(a, b);\n  let numerator = 0;\n  for (let i = 0; i < 3; ++i) {\n    const aValue = a[i];\n    numerator -= (aValue - p[i]) * (b[i] - aValue);\n  }\n  return numerator / Math.max(denominator, 1e-6);\n}\n\n/**\n * Sets `out` to the position on the line segment `[a, b]` closest to `p`.\n */\nexport function projectPointToLineSegment(out: vec3, a: vec3, b: vec3, p: vec3) {\n  let t = findClosestParameterizedLinePosition(a, b, p);\n  t = Math.max(0.0, Math.min(1.0, t));\n  for (let i = 0; i < 3; ++i) {\n    const aValue = a[i];\n    out[i] = aValue + t * (b[i] - aValue);\n  }\n  return out;\n}\n\nexport function mat3FromMat4(out: mat3, m: mat4) {\n  const m00 = m[0], m01 = m[1], m02 = m[2], m10 = m[4], m11 = m[5], m12 = m[6], m20 = m[8],\n        m21 = m[9], m22 = m[10];\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m10;\n  out[4] = m11;\n  out[5] = m12;\n  out[6] = m20;\n  out[7] = m21;\n  out[8] = m22;\n  return out;\n}\n\n/**\n * Extracts the left, right, bottom, top, near, far clipping planes from `projectionMat`.\n * @param out Row-major array of shape `(6, 4)` specifying for each of the left, right, bottom, top,\n *     near, far clipping planes the `a`, `b`, `c`, `d` coefficients such that\n *     `0 < a * x + b * y + c * z + d` if the point `x, y, z` is inside the half-space of the\n * clipping plane.\n * @param m Projection matrix\n */\nexport function getFrustrumPlanes(out: Float32Array, m: mat4): Float32Array {\n  // http://web.archive.org/web/20120531231005/http://crazyjoke.free.fr/doc/3D/plane%20extraction.pdf\n  const m00 = m[0], m10 = m[1], m20 = m[2], m30 = m[3], m01 = m[4], m11 = m[5], m21 = m[6],\n        m31 = m[7], m02 = m[8], m12 = m[9], m22 = m[10], m32 = m[11], m03 = m[12], m13 = m[13],\n        m23 = m[14], m33 = m[15];\n\n  out[0] = m30 + m00;  // left: a\n  out[1] = m31 + m01;  // left: b\n  out[2] = m32 + m02;  // left: c\n  out[3] = m33 + m03;  // left: d\n\n  out[4] = m30 - m00;  // right: a\n  out[5] = m31 - m01;  // right: b\n  out[6] = m32 - m02;  // right: c\n  out[7] = m33 - m03;  // right: d\n\n  out[8] = m30 + m10;   // bottom: a\n  out[9] = m31 + m11;   // bottom: b\n  out[10] = m32 + m12;  // bottom: c\n  out[11] = m33 + m13;  // bottom: d\n\n  out[12] = m30 - m10;  // top: a\n  out[13] = m31 - m11;  // top: b\n  out[14] = m32 - m12;  // top: c\n  out[15] = m33 - m13;  // top: d\n\n  const nearA = m30 + m20;  // near: a\n  const nearB = m31 + m21;  // near: b\n  const nearC = m32 + m22;  // near: c\n  const nearD = m33 + m23;  // near: d\n\n  // Normalize near plane\n  const nearNorm = Math.sqrt(nearA ** 2 + nearB ** 2 + nearC ** 2);\n  out[16] = nearA / nearNorm;\n  out[17] = nearB / nearNorm;\n  out[18] = nearC / nearNorm;\n  out[19] = nearD / nearNorm;\n\n  out[20] = m30 - m20;  // far: a\n  out[21] = m31 - m21;  // far: b\n  out[22] = m32 - m22;  // far: c\n  out[23] = m33 - m23;  // far: d\n\n  return out;\n}\n\n/**\n * Checks whether the specified axis-aligned bounding box (AABB) intersects the view frustrum.\n *\n * @param clippingPlanes Array of length 24 specifying the clipping planes of the view frustrum, as\n *     computed by `getFrustrumPlanes`\n */\nexport function isAABBVisible(\n    xLower: number, yLower: number, zLower: number, xUpper: number, yUpper: number, zUpper: number,\n    clippingPlanes: Float32Array) {\n  for (let i = 0; i < 6; ++i) {\n    const a = clippingPlanes[i * 4], b = clippingPlanes[i * 4 + 1], c = clippingPlanes[i * 4 + 2],\n          d = clippingPlanes[i * 4 + 3];\n    const sum = Math.max(a * xLower, a * xUpper) + Math.max(b * yLower, b * yUpper) +\n        Math.max(c * zLower, c * zUpper) + d;\n    if (sum < 0) {\n      return false;\n    }\n  }\n  return true;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {CredentialsProvider, CredentialsWithGeneration, makeCredentialsGetter} from 'neuroglancer/credentials_provider';\nimport {StatusMessage} from 'neuroglancer/status';\nimport {CANCELED, CancellationTokenSource, uncancelableToken} from 'neuroglancer/util/cancellation';\nimport {Owned} from 'neuroglancer/util/disposable';\nimport {removeFromParent} from 'neuroglancer/util/dom';\nimport {parseArray, verifyObject, verifyString} from 'neuroglancer/util/json';\nimport {getRandomHexString} from 'neuroglancer/util/random';\nimport {Signal} from 'neuroglancer/util/signal';\n\nexport const AUTH_SERVER = 'https://accounts.google.com/o/oauth2/auth';\n\nconst AUTH_ORIGIN = 'https://accounts.google.com';\n\nexport function embedRelayFrame(proxyName: string, rpcToken: string) {\n  let iframe = document.createElement('iframe');\n  iframe.style.display = 'none';\n  iframe.id = proxyName;\n  iframe.name = proxyName;\n  const origin = location.origin;\n  iframe.src = `https://accounts.google.com/o/oauth2/postmessageRelay?` +\n      `parent=${encodeURIComponent(origin)}#rpctoken=${rpcToken}`;\n  document.body.appendChild(iframe);\n}\n\n/**\n * OAuth2 Token\n */\nexport interface OAuth2Token {\n  accessToken: string;\n  expiresIn: string;\n  tokenType: string;\n  scope: string;\n}\n\nclass PendingRequest {\n  finished = new Signal<(token?: OAuth2Token, error?: any) => void>();\n}\n\nclass AuthHandler {\n  proxyName = `postmessageRelay${getRandomHexString()}`;\n  rpcToken = `${getRandomHexString()}`;\n  relayReadyService = `oauth2relayReady:${this.rpcToken}`;\n  oauth2CallbackService = `oauth2callback:${this.rpcToken}`;\n  relayReadyPromise: Promise<void>;\n  pendingRequests = new Map<string, PendingRequest>();\n\n  constructor() {\n    embedRelayFrame(this.proxyName, this.rpcToken);\n\n    this.relayReadyPromise = new Promise<void>((relayReadyPromiseResolve) => {\n      addEventListener('message', (event: MessageEvent) => {\n        if (event.origin !== AUTH_ORIGIN) {\n          return;\n        }\n        try {\n          let data = verifyObject(JSON.parse(event.data));\n          let service = verifyString(data['s']);\n          if (service === this.relayReadyService) {\n            relayReadyPromiseResolve();\n          }\n\n          if (service === this.oauth2CallbackService) {\n            let args = parseArray(data['a'], x => x);\n            let arg = verifyString(args[0]);\n            let origin = location.origin;\n            if (!arg.startsWith(origin + '#') && !arg.startsWith(origin + '?')) {\n              throw new Error(\n                  `oauth2callback: URL ${JSON.stringify(arg)} ` +\n                  `does not match current origin ${origin}.`);\n            }\n            let hashPart = arg.substring(origin.length + 1);\n            let parts = hashPart.split('&');\n            let params = new Map<string, string>();\n            for (let part of parts) {\n              let match = part.match('^([a-z_]+)=(.*)$');\n              if (match === null) {\n                throw new Error(\n                    `oauth2callback: URL part ${JSON.stringify(match)} ` +\n                    `does not match expected pattern.`);\n              }\n              params.set(match[1], match[2]);\n            }\n            let state = params.get('state');\n            if (state === undefined) {\n              throw new Error(`oauth2callback: State argument is missing.`);\n            }\n            let request = this.pendingRequests.get(state);\n            if (request === undefined) {\n              // Request may have been cancelled.\n              return;\n            }\n            let error = params.get('error');\n            if (error !== undefined) {\n              let errorSubtype = params.get('error_subtype');\n              let fullMessage = error;\n              if (errorSubtype !== undefined) {\n                fullMessage += ': ' + errorSubtype;\n              }\n              request.finished.dispatch(\n                  undefined, new Error(`Error obtaining Google OAuth2 token: ${fullMessage}`));\n              return;\n            }\n            let accessToken = params.get('access_token');\n            let tokenType = params.get('token_type');\n            let expiresIn = params.get('expires_in');\n            let scope = params.get('scope');\n            if (accessToken === undefined || tokenType === undefined || expiresIn === undefined ||\n                scope === undefined) {\n              throw new Error(`oauth2callback: URL lacks expected parameters.`);\n            }\n            request.finished.dispatch({\n              accessToken: accessToken,\n              tokenType: tokenType,\n              expiresIn: expiresIn,\n              scope: scope\n            });\n            return;\n          }\n        } catch (parseError) {\n          throw new Error(\n              `Invalid message received from ${AUTH_ORIGIN}: ${JSON.stringify(event.data)}: ` +\n              `${parseError.message}.`);\n        }\n      });\n    });\n  }\n\n  addPendingRequest(state: string) {\n    let request = new PendingRequest();\n    this.pendingRequests.set(state, request);\n    request.finished.add(() => {\n      this.pendingRequests.delete(state);\n    });\n    return request;\n  }\n\n  makeAuthRequestUrl(options: {\n    clientId: string,\n    scopes: string[],\n    approvalPrompt?: 'force'|'auto',\n    state?: string,\n    origin?: string,\n    loginHint?: string,\n    authUser?: number,\n    immediate?: boolean\n  }) {\n    let url = `${AUTH_SERVER}?client_id=${encodeURIComponent(options.clientId)}`;\n    url += `&redirect_uri=postmessage`;\n    url += `&response_type=token`;\n    let {origin = location.origin} = options;\n    url += `&origin=${encodeURIComponent(origin)}`;\n    url += `&proxy=${this.proxyName}`;\n    url += `&include_granted_scopes=true`;\n    url += `&scope=${encodeURIComponent(options.scopes.join(' '))}`;\n    if (options.state) {\n      url += `&state=${options.state}`;\n    }\n    if (options.approvalPrompt) {\n      url += `&approval_prompt=${encodeURIComponent(options.approvalPrompt)}`;\n    }\n    if (options.loginHint) {\n      url += `&login_hint=${encodeURIComponent(options.loginHint)}`;\n    }\n    if (options.immediate) {\n      url += `&immediate=true`;\n    }\n    if (options.authUser !== undefined) {\n      url += `&authuser=${options.authUser}`;\n    }\n    return url;\n  }\n}\n\n\nlet authHandlerInstance: AuthHandler;\n\nfunction authHandler() {\n  if (authHandlerInstance === undefined) {\n    authHandlerInstance = new AuthHandler();\n  }\n  return authHandlerInstance;\n}\n\n/**\n * Obtain a Google OAuth2 authentication token.\n * @return A Promise that resolves to an authentication token.\n */\nexport function authenticateGoogleOAuth2(\n    options: {\n      clientId: string,\n      scopes: string[],\n      approvalPrompt?: 'force'|'auto',\n      loginHint?: string,\n      immediate?: boolean,\n      authUser?: number,\n    },\n    cancellationToken = uncancelableToken) {\n  const state = getRandomHexString();\n  const handler = authHandler();\n  const url = handler.makeAuthRequestUrl({\n    state,\n    clientId: options.clientId,\n    scopes: options.scopes,\n    approvalPrompt: options.approvalPrompt,\n    loginHint: options.loginHint,\n    immediate: options.immediate,\n    authUser: options.authUser,\n  });\n  const request = handler.addPendingRequest(state);\n  const promise = new Promise<OAuth2Token>((resolve, reject) => {\n    request.finished.add((token, error) => {\n      if (token !== undefined) {\n        resolve(token);\n      } else {\n        reject(error);\n      }\n    });\n  });\n  request.finished.add(cancellationToken.add(() => {\n    request.finished.dispatch(undefined, CANCELED);\n  }));\n  if (options.immediate) {\n    // For immediate mode auth, we can wait until the relay is ready, since we aren't opening a new\n    // window.\n    handler.relayReadyPromise.then(() => {\n      if (cancellationToken.isCanceled) {\n        return;\n      }\n      const iframe = document.createElement('iframe');\n      iframe.src = url;\n      iframe.style.display = 'none';\n      document.body.appendChild(iframe);\n      request.finished.add(() => {\n        removeFromParent(iframe);\n      });\n    });\n  } else {\n    if (!cancellationToken.isCanceled) {\n      const newWindow = open(url);\n      if (newWindow !== null) {\n        request.finished.add(() => {\n          newWindow.close();\n        });\n      }\n    }\n  }\n  return promise;\n}\n\nexport class GoogleOAuth2CredentialsProvider extends CredentialsProvider<OAuth2Token> {\n  constructor(public options: {clientId: string, scopes: string[], description: string}) {\n    super();\n  }\n\n  get = makeCredentialsGetter(cancellationToken => {\n    const {options} = this;\n    const status = new StatusMessage(/*delay=*/ true);\n    let cancellationSource: CancellationTokenSource|undefined;\n    return new Promise<OAuth2Token>((resolve, reject) => {\n      const dispose = () => {\n        cancellationSource = undefined;\n        status.dispose();\n      };\n      cancellationToken.add(() => {\n        if (cancellationSource !== undefined) {\n          cancellationSource.cancel();\n          cancellationSource = undefined;\n          status.dispose();\n          reject(CANCELED);\n        }\n      });\n      function writeLoginStatus(\n          msg = `${options.description} authorization required.`,\n          linkMessage = 'Request authorization.') {\n        status.setText(msg + '  ');\n        let button = document.createElement('button');\n        button.textContent = linkMessage;\n        status.element.appendChild(button);\n        button.addEventListener('click', () => {\n          login(/*immediate=*/ false);\n        });\n        status.setVisible(true);\n      }\n      function login(immediate: boolean) {\n        if (cancellationSource !== undefined) {\n          cancellationSource.cancel();\n        }\n        cancellationSource = new CancellationTokenSource();\n        writeLoginStatus(`Waiting for ${options.description} authorization...`, 'Retry');\n        authenticateGoogleOAuth2(\n            {\n              clientId: options.clientId,\n              scopes: options.scopes,\n              immediate: immediate,\n              authUser: 0,\n            },\n            cancellationSource)\n            .then(\n                token => {\n                  if (cancellationSource !== undefined) {\n                    dispose();\n                    resolve(token);\n                  }\n                },\n                reason => {\n                  if (cancellationSource !== undefined) {\n                    cancellationSource = undefined;\n                    if (immediate) {\n                      writeLoginStatus();\n                    } else {\n                      writeLoginStatus(\n                          `${options.description} authorization failed: ${reason}.`, 'Retry');\n                    }\n                  }\n                });\n      }\n      login(/*immediate=*/ true);\n    });\n  });\n}\n\nexport function fetchWithGoogleCredentials(\n    credentialsProvider: Owned<CredentialsProvider<OAuth2Token>>, input: string|Request,\n    init: RequestInit = {}): Promise<Response> {\n  function start(credentials: CredentialsWithGeneration<OAuth2Token>): Promise<Response> {\n    const token = credentials.credentials;\n    const headers = new Headers(init.headers);\n    headers.append('Authorization', `${token.tokenType} ${token.accessToken}`);\n    return fetch(input, {...init, mode: 'cors', headers}).then(response => {\n      if (response.status === 401) {\n        // 401: Authorization needed.  OAuth2 token may have expired.\n        return credentialsProvider.get(credentials).then(start);\n      }\n      return response;\n    });\n  }\n  const promise = credentialsProvider.get(/*invalidToken=*/ undefined).then(start);\n  const disposeRef = () => {\n    credentialsProvider.dispose();\n  };\n  promise.then(disposeRef, disposeRef);\n  return promise;\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function hexEncodeByte(x: number) {\n  return ('0' + x.toString(16)).slice(-2);\n}\n\nexport function hexEncode(arr: Uint8Array) {\n  return Array.prototype.map.call(arr, hexEncodeByte).join('');\n}\n\nexport function hexDecode(x: string) {\n  if (!/^(?:[0-9a-fA-F]{2})*$/.test(x)) {\n    throw new Error('Invalid hex-encoded string');\n  }\n  const length = x.length / 2;\n  const result = new Uint8Array(length);\n  for (let i = 0; i < length; ++i) {\n    result[i] = parseInt(x.substr(i * 2, 2), 16);\n  }\n  return result;\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Hierarchical mapping from keys to values.\n */\n\nexport interface HierarchicalMapInterface<Key, Value> {\n  get(key: Key): Value|undefined;\n  entries(): IterableIterator<[Key, Value]>;\n}\n\n/**\n * Maps string event identifiers to string action identifiers.\n *\n * When an event identifier is looked up in a given HierarchicalMap, it is resolved to a\n * corresponding action identifier in one of two ways:\n *\n * 1. via mappings defined directly on the HierarchicalMap.\n *\n * 2. via a recursive lookup on a \"parent\" HierarchicalMap that has been specified for the root\n *    HierarchicalMap on which the lookup was initiated.\n *\n * HierarchicalMap objects may be specified as \"parents\" of another HierarchicalMap along with a\n * specified numerical priority value, such that there is a directed graph of HierarchicalMap\n * objects.  Cycles in this graph may lead to infinite looping.\n *\n * Recursive lookups in parent HierarchicalMap objects are performed in order of decreasing\n * priority. The lookup stops as soon as a mapping is found.  Direct bindings have a priority of 0.\n * Therefore, parent maps with a priority higher than 0 take precedence over direct bindings.\n */\nexport class HierarchicalMap<Key, Value, Parent extends HierarchicalMapInterface<Key, Value> =\n                                                            HierarchicalMapInterface<Key, Value>>\n    implements HierarchicalMapInterface<Key, Value> {\n  parents = new Array<Parent>();\n  private parentPriorities = new Array<number>();\n  bindings = new Map<Key, Value>();\n\n  /**\n   * If an existing HierarchicalMap is specified, a shallow copy is made.\n   *\n   * @param existing Existing map to make a shallow copy of.\n   */\n  constructor(existing?: HierarchicalMap<Key, Value, Parent>) {\n    if (existing !== undefined) {\n      this.parents.push(...existing.parents);\n      this.parentPriorities.push(...existing.parentPriorities);\n      for (const [k, v] of existing.bindings) {\n        this.bindings.set(k, v);\n      }\n    }\n  }\n\n  /**\n   * Register `parent` as a parent map.  If `priority > 0`, this map will take precedence over\n   * direct bindings.\n   *\n   * @returns A nullary function that unregisters the parent (and may be called at most once).\n   */\n  addParent(parent: Parent, priority: number) {\n    const {parents, parentPriorities} = this;\n    let index = 0;\n    const {length} = parents;\n    while (index < length && priority < parentPriorities[index]) {\n      ++index;\n    }\n    parents.splice(index, 0, parent);\n    parentPriorities.splice(index, 0, priority);\n\n    return () => {\n      this.removeParent(parent);\n    };\n  }\n\n  /**\n   * Unregisters `parent` as a parent.\n   */\n  removeParent(parent: Parent) {\n    const index = this.parents.indexOf(parent);\n    if (index === -1) {\n      throw new Error(`Attempt to remove non-existent parent map.`);\n    }\n    this.parents.splice(index, 1);\n    this.parentPriorities.splice(index, 1);\n  }\n\n  /**\n   * Register a direct binding.\n   */\n  set(key: Key, value: Value) {\n    this.bindings.set(key, value);\n  }\n\n  /**\n   * Unregister a direct binding.\n   */\n  delete(key: Key) {\n    this.bindings.delete(key);\n  }\n\n  /**\n   * Deletes all bindings, including parents.\n   */\n  clear() {\n    this.bindings.clear();\n    this.parents.length = 0;\n    this.parentPriorities.length = 0;\n  }\n\n  /**\n   * Lookup the highest priority value to which the specified key is mapped.\n   */\n  get(key: Key): Value|undefined {\n    const {parents, parentPriorities} = this;\n    const numParents = parentPriorities.length;\n    let parentIndex = 0;\n    let value;\n    for (; parentIndex < numParents && parentPriorities[parentIndex] > 0; ++parentIndex) {\n      value = parents[parentIndex].get(key);\n      if (value !== undefined) {\n        return value;\n      }\n    }\n    value = this.bindings.get(key);\n    if (value !== undefined) {\n      return value;\n    }\n    for (; parentIndex < numParents; ++parentIndex) {\n      value = parents[parentIndex].get(key);\n      if (value !== undefined) {\n        return value;\n      }\n    }\n    return undefined;\n  }\n\n  /**\n   * Find all values to which the specified key is mapped.\n   */\n  * getAll(key: Key): IterableIterator<Value> {\n    const {parents, parentPriorities} = this;\n    const numParents = parentPriorities.length;\n    let parentIndex = 0;\n    let value;\n    while (parentIndex < numParents && parentPriorities[parentIndex] > 0) {\n      value = parents[parentIndex].get(key);\n      if (value !== undefined) {\n        yield value;\n      }\n    }\n    value = this.bindings.get(key);\n    if (value !== undefined) {\n      yield value;\n    }\n    while (parentIndex < numParents) {\n      value = parents[parentIndex].get(key);\n      if (value !== undefined) {\n        yield value;\n      }\n    }\n  }\n\n  * entries(): IterableIterator<[Key, Value]> {\n    const {parents, parentPriorities} = this;\n    const numParents = parentPriorities.length;\n    let parentIndex = 0;\n    while (parentIndex < numParents && parentPriorities[parentIndex] > 0) {\n      yield *parents[parentIndex].entries();\n    }\n    yield *this.bindings.entries();\n    while (parentIndex < numParents) {\n      yield *parents[parentIndex].entries();\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {CancellationToken, uncancelableToken} from 'neuroglancer/util/cancellation';\nimport {Uint64} from 'neuroglancer/util/uint64';\n\nexport class HttpError extends Error {\n  url: string;\n  status: number;\n  statusText: string;\n\n  constructor(url: string, status: number, statusText: string) {\n    let message = `Fetching ${JSON.stringify(url)} resulted in HTTP error ${status}`;\n    if (statusText) {\n      message += `: ${statusText}`;\n    }\n    message += '.';\n    super(message);\n    this.name = 'HttpError';\n    this.message = message;\n    this.url = url;\n    this.status = status;\n    this.statusText = statusText;\n  }\n\n  static fromResponse(response: Response) {\n    return new HttpError(response.url, response.status, response.statusText);\n  }\n}\n\n/**\n * Issues a `fetch` request.\n *\n * If the request fails due to an HTTP status outside `[200, 300)`, throws an `HttpError`.  If the\n * request fails due to a network or CORS restriction, throws an `HttpError` with a `status` of `0`.\n */\nexport async function fetchOk(input: RequestInfo, init?: RequestInit): Promise<Response> {\n  let response: Response;\n  try {\n    response = await fetch(input, init);\n  } catch (error) {\n    if (error instanceof TypeError) {\n      throw new HttpError('', 0, '');\n    }\n    throw error;\n  }\n  if (!response.ok) throw HttpError.fromResponse(response);\n  return response;\n}\n\nexport function responseArrayBuffer(response: Response): Promise<ArrayBuffer> {\n  return response.arrayBuffer();\n}\n\nexport function responseJson(response: Response): Promise<any> {\n  return response.json();\n}\n\nexport type ResponseTransform<T> = (response: Response) => Promise<T>;\n\n/**\n * Issues a `fetch` request in the same way as `fetchOk`, and returns the result of the promise\n * returned by `transformResponse`.\n *\n * Additionally, the request may be cancelled through `cancellationToken`.\n *\n * The `transformResponse` function should not do anything with the `Response` object after its\n * result becomes ready; otherwise, cancellation may not work as expected.\n */\nexport async function cancellableFetchOk<T>(\n    input: RequestInfo, init: RequestInit, transformResponse: ResponseTransform<T>,\n    cancellationToken: CancellationToken = uncancelableToken): Promise<T> {\n  if (cancellationToken === uncancelableToken) {\n    const response = await fetchOk(input, init);\n    return await transformResponse(response);\n  }\n  const abortController = new AbortController();\n  const unregisterCancellation = cancellationToken.add(() => abortController.abort());\n  try {\n    const response = await fetchOk(input, init);\n    return await transformResponse(response);\n  } finally {\n    unregisterCancellation();\n  }\n}\n\nconst tempUint64 = new Uint64();\n\nexport function getByteRangeHeader(startOffset: Uint64|number, endOffset: Uint64|number) {\n  let endOffsetStr: string;\n  if (typeof endOffset === 'number') {\n    endOffsetStr = `${endOffset - 1}`;\n  } else {\n    Uint64.decrement(tempUint64, endOffset);\n    endOffsetStr = tempUint64.toString();\n  }\n  return {'Range': `bytes=${startOffset}-${endOffsetStr}`};\n}\n\n/**\n * Parses a URL that may have a special protocol designation into a real URL.\n *\n * If the protocol is 'http' or 'https', the input string is returned as is.\n *\n * The special 'gs://bucket/path' syntax is supported for accessing Google Storage buckets.\n */\nexport function parseSpecialUrl(url: string): string {\n  const urlProtocolPattern = /^([^:\\/]+):\\/\\/([^\\/]+)(\\/.*)?$/;\n  let match = url.match(urlProtocolPattern);\n  if (match === null) {\n    throw new Error(`Invalid URL: ${JSON.stringify(url)}`);\n  }\n  const protocol = match[1];\n  if (protocol === 'gs') {\n    const bucket = match[2];\n    let path = match[3];\n    if (path === undefined) path = '';\n    return `https://storage.googleapis.com/${bucket}${path}`;\n  }\n  return url;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {WritableArrayLike} from 'neuroglancer/util/array';\nimport {vec3} from 'neuroglancer/util/geom';\n\nexport function verifyFloat(obj: any): number {\n  let t = typeof obj;\n  if (t === 'number' || t === 'string') {\n    let x = parseFloat('' + obj);\n    if (!Number.isNaN(x)) {\n      return x;\n    }\n  }\n  throw new Error(`Expected floating-point number, but received: ${JSON.stringify(obj)}.`);\n}\n\nexport function verifyFiniteFloat(obj: any): number {\n  let x = verifyFloat(obj);\n  if (Number.isFinite(x)) {\n    return x;\n  }\n  throw new Error(`Expected finite floating-point number, but received: ${x}.`);\n}\n\nexport function verifyFinitePositiveFloat(obj: any): number {\n  let x = verifyFiniteFloat(obj);\n  if (x > 0) {\n    return x;\n  }\n  throw new Error(`Expected positive finite floating-point number, but received: ${x}.`);\n}\n\nexport function parseXYZ<A extends WritableArrayLike<number>>(\n    out: A, obj: any, validator: (x: any) => number = verifyFloat): A {\n  verifyObject(obj);\n  out[0] = out[1] = out[2] = 0;\n  for (const key of Object.keys(obj)) {\n    switch (key) {\n    case 'x':\n      out[0] = validator(obj[key]);\n      break;\n    case 'y':\n      out[1] = validator(obj[key]);\n      break;\n    case 'z':\n      out[2] = validator(obj[key]);\n      break;\n    default:\n      throw new Error(\n          `Expected object to have keys ['x', 'y', 'z'], but received: ${JSON.stringify(obj)}.`);\n    }\n  }\n  return out;\n}\n\nexport function parseFiniteVec<U extends WritableArrayLike<number>>(out: U, obj: any[]) {\n  let length = out.length;\n  if (!Array.isArray(obj) || obj.length !== length) {\n    throw new Error('Incompatible sizes');\n  }\n\n  for (let i = 0; i < length; ++i) {\n    if (!Number.isFinite(parseFloat(obj[i]))) {\n      throw new Error('Non-finite value.');\n    }\n  }\n  for (let i = 0; i < length; ++i) {\n    out[i] = parseFloat(obj[i]);\n  }\n  return out;\n}\n\nexport function parseIntVec<U extends WritableArrayLike<number>>(out: U, obj: any) {\n  let length = out.length;\n  if (!Array.isArray(obj) || obj.length !== length) {\n    throw new Error('Incompatible sizes.');\n  }\n\n  for (let i = 0; i < length; ++i) {\n    let val = parseInt(obj[i], undefined);\n    if (!Number.isInteger(val)) {\n      throw new Error('Non-integer value.');\n    }\n  }\n\n  for (let i = 0; i < length; ++i) {\n    out[i] = parseInt(obj[i], undefined);\n  }\n  return out;\n}\n\n/**\n * Returns a JSON representation of x, with object keys sorted to ensure a\n * consistent result.\n */\nexport function stableStringify(x: any) {\n  if (typeof x === 'object') {\n    if (x === null) {\n      return 'null';\n    }\n    if (Array.isArray(x)) {\n      let s = '[';\n      let size = x.length;\n      let i = 0;\n      if (i < size) {\n        s += stableStringify(x[i]);\n        while (++i < size) {\n          s += ',';\n          s += stableStringify(x[i]);\n        }\n      }\n      s += ']';\n      return s;\n    }\n    let s = '{';\n    let keys = Object.keys(x).sort();\n    let i = 0;\n    let size = keys.length;\n    if (i < size) {\n      let key = keys[i];\n      s += JSON.stringify(key);\n      s += ':';\n      s += stableStringify(x[key]);\n      while (++i < size) {\n        s += ',';\n        key = keys[i];\n        s += JSON.stringify(key);\n        s += ':';\n        s += stableStringify(x[key]);\n      }\n    }\n    s += '}';\n    return s;\n  }\n  return JSON.stringify(x);\n}\n\nfunction swapQuotes(x: string) {\n  return x.replace(/['\"]/g, s => {\n    return (s === '\"' ? '\\'' : '\"');\n  });\n}\n\nexport function urlSafeStringifyString(x: string) {\n  return swapQuotes(JSON.stringify(swapQuotes(x)));\n}\n\nconst URL_SAFE_COMMA = '_';\n\nexport function urlSafeStringify(x: any): string {\n  if (typeof x === 'object') {\n    if (x === null) {\n      return 'null';\n    }\n    let toJSON = x['toJSON'];\n    if (typeof toJSON === 'function') {\n      return urlSafeStringify(toJSON.call(x));\n    }\n    if (Array.isArray(x)) {\n      let s = '[';\n      let size = x.length;\n      let i = 0;\n      if (i < size) {\n        s += urlSafeStringify(x[i]);\n        while (++i < size) {\n          s += URL_SAFE_COMMA;\n          s += urlSafeStringify(x[i]);\n        }\n      }\n      s += ']';\n      return s;\n    }\n    let s = '{';\n    let keys = Object.keys(x);\n    let first = true;\n    for (let key of keys) {\n      let value = x[key];\n      if (value === undefined) {\n        continue;\n      }\n      let valueString = urlSafeStringify(value);\n      if (!valueString) {\n        continue;\n      }\n      if (!first) {\n        s += URL_SAFE_COMMA;\n      } else {\n        first = false;\n      }\n      s += urlSafeStringifyString(key);\n      s += ':';\n      s += valueString;\n    }\n    s += '}';\n    return s;\n  }\n  if (typeof x === 'string') {\n    return urlSafeStringifyString(x);\n  }\n  return JSON.stringify(x);\n}\n\nconst SINGLE_QUOTE_STRING_PATTERN = /('(?:[^'\\\\]|(?:\\\\.))*')/;\nconst DOUBLE_QUOTE_STRING_PATTERN = /(\"(?:[^'\\\\]|(?:\\\\.))*\")/;\nconst SINGLE_OR_DOUBLE_QUOTE_STRING_PATTERN =\n    new RegExp(`${SINGLE_QUOTE_STRING_PATTERN.source}|${DOUBLE_QUOTE_STRING_PATTERN.source}`);\nconst DOUBLE_OR_SINGLE_QUOTE_STRING_PATTERN =\n    new RegExp(`${DOUBLE_QUOTE_STRING_PATTERN.source}|${SINGLE_QUOTE_STRING_PATTERN.source}`);\n\nconst DOUBLE_QUOTE_PATTERN = /^((?:[^\"'\\\\]|(?:\\\\[^']))*)(\"|\\\\')/;\nconst SINGLE_QUOTE_PATTERN = /^((?:[^\"'\\\\]|(?:\\\\.))*)'/;\n\nfunction convertStringLiteral(\n  x: string, quoteInitial: string, quoteReplace: string, quoteSearch: RegExp) {\n  if (x.length >= 2 && x.charAt(0) === quoteInitial && x.charAt(x.length - 1) === quoteInitial) {\n    let inner = x.substr(1, x.length - 2);\n    let s = quoteReplace;\n    while (inner.length > 0) {\n      let m = inner.match(quoteSearch);\n      if (m === null) {\n        s += inner;\n        break;\n      }\n      s += m[1];\n      if (m[2] === quoteReplace) {\n        // We received a single unescaped quoteReplace character.\n        s += '\\\\';\n        s += quoteReplace;\n      } else {\n        // We received \"\\\\\" + quoteInitial.  We need to remove the escaping.\n        s += quoteInitial;\n      }\n      inner = inner.substr(m.index! + m[0].length);\n    }\n    s += quoteReplace;\n    return s;\n  }\n  return x;\n}\n\n/**\n * Converts a string literal delimited by either single or double quotes into a string literal\n * delimited by double quotes.\n */\nexport function normalizeStringLiteral(x: string) {\n  return convertStringLiteral(x, '\\'', '\"', DOUBLE_QUOTE_PATTERN);\n}\n\n\n\n// quoteChar: des\nfunction convertJsonHelper(x: string, desiredCommaChar: string, desiredQuoteChar: string) {\n  const commaSearch = /[&_,]/g;\n  let quoteInitial: string;\n  let quoteSearch: RegExp;\n  let stringLiteralPattern: RegExp;\n  if (desiredQuoteChar === '\"') {\n    quoteInitial = '\\'';\n    quoteSearch = DOUBLE_QUOTE_PATTERN;\n    stringLiteralPattern = SINGLE_OR_DOUBLE_QUOTE_STRING_PATTERN;\n  } else {\n    quoteInitial = '\"';\n    quoteSearch = SINGLE_QUOTE_PATTERN;\n    stringLiteralPattern = DOUBLE_OR_SINGLE_QUOTE_STRING_PATTERN;\n  }\n  let s = '';\n  while (x.length > 0) {\n    let m = x.match(stringLiteralPattern);\n    let before: string;\n    let replacement: string;\n    if (m === null) {\n      before = x;\n      x = '';\n      replacement = '';\n    } else {\n      before = x.substr(0, m.index);\n      x = x.substr(m.index! + m[0].length);\n      let originalString = m[1];\n      if (originalString !== undefined) {\n        replacement =\n            convertStringLiteral(originalString, quoteInitial, desiredQuoteChar, quoteSearch);\n      } else {\n        replacement = m[2];\n      }\n    }\n    s += before.replace(commaSearch, desiredCommaChar);\n    s += replacement;\n  }\n  return s;\n}\n\nexport function urlSafeToJSON(x: string) {\n  return convertJsonHelper(x, ',', '\"');\n}\n\nexport function jsonToUrlSafe(x: string) {\n  return convertJsonHelper(x, '_', '\\'');\n}\n\nexport function urlSafeParse(x: string) {\n  return JSON.parse(urlSafeToJSON(x));\n}\n\n// Converts a string containing a Python literal into a string containing an equivalent JSON\n// literal.\nexport function pythonLiteralToJSON(x: string) {\n  let s = '';\n  while (x.length > 0) {\n    let m = x.match(SINGLE_OR_DOUBLE_QUOTE_STRING_PATTERN);\n    let before: string;\n    let replacement: string;\n    if (m === null) {\n      before = x;\n      x = '';\n      replacement = '';\n    } else {\n      before = x.substr(0, m.index);\n      x = x.substr(m.index! + m[0].length);\n      let singleQuoteString = m[1];\n      if (singleQuoteString !== undefined) {\n        replacement = normalizeStringLiteral(singleQuoteString);\n      } else {\n        replacement = m[2];\n      }\n    }\n    s += before.replace(/\\(/g, '[')\n             .replace(/\\)/g, ']')\n             .replace('True', 'true')\n             .replace('False', 'false')\n             .replace(/,\\s*([\\}\\]])/g, '$1');\n    s += replacement;\n  }\n  return s;\n}\n\n// Converts a string containing a Python literal into an equivalent JavaScript value.\nexport function pythonLiteralParse(x: string) {\n  return JSON.parse(pythonLiteralToJSON(x));\n}\n\n// Checks that `x' is an array, maps each element by parseElement.\nexport function parseArray<T>(x: any, parseElement: (x: any, index: number) => T): T[] {\n  if (!Array.isArray(x)) {\n    throw new Error(`Expected array, but received: ${JSON.stringify(x)}.`);\n  }\n  return (<any[]>x).map(parseElement);\n}\n\nexport function parseFixedLengthArray<T, U extends WritableArrayLike<T>>(\n    out: U, obj: any, parseElement: (x: any, index: number) => T): U {\n  const length = out.length;\n  if (!Array.isArray(obj) || obj.length !== length) {\n    throw new Error(`Expected length ${length} array, but received: ${JSON.stringify(obj)}.`);\n  }\n  for (let i = 0; i < length; ++i) {\n    out[i] = parseElement(obj[i], i);\n  }\n  return out;\n}\n\nexport function verifyObject(obj: any) {\n  if (typeof obj !== 'object' || obj == null || Array.isArray(obj)) {\n    throw new Error(`Expected JSON object, but received: ${JSON.stringify(obj)}.`);\n  }\n  return obj;\n}\n\nexport function verifyInt(obj: any) {\n  let result = parseInt(obj, 10);\n  if (!Number.isInteger(result)) {\n    throw new Error(`Expected integer, but received: ${JSON.stringify(obj)}.`);\n  }\n  return result;\n}\n\nexport function verifyPositiveInt(obj: any) {\n  let result = verifyInt(obj);\n  if (result <= 0) {\n    throw new Error(`Expected positive integer, but received: ${result}.`);\n  }\n  return result;\n}\n\nexport function verifyMapKey<U>(obj: any, map: Map<string, U>) {\n  let result = map.get(obj);\n  if (result === undefined) {\n    throw new Error(\n        `Expected one of ${JSON.stringify(Array.from(map.keys()))}, ` +\n        `but received: ${JSON.stringify(obj)}.`);\n  }\n  return result;\n}\n\nexport function verifyString(obj: any) {\n  if (typeof obj !== 'string') {\n    throw new Error(`Expected string, but received: ${JSON.stringify(obj)}.`);\n  }\n  return obj;\n}\n\nexport function verifyOptionalString(obj: any): string|undefined {\n  if (obj === undefined) {\n    return undefined;\n  }\n  return verifyString(obj);\n}\n\nexport function verifyOptionalInt(obj: any): number|undefined {\n  if (obj === undefined) {\n    return undefined;\n  }\n  return verifyInt(obj);\n}\n\nexport function verifyOptionalBoolean(obj: any): boolean|undefined {\n  if (obj === undefined) {\n    return undefined;\n  }\n  if (typeof obj === 'boolean') {\n    return obj;\n  } else if (obj === 'true') {\n    return true;\n  } else if (obj === 'false') {\n    return false;\n  } else {\n    throw new Error(`Expected string or boolean but received: ${JSON.stringify(obj)}`);\n  }\n}\n\nexport function valueOr<T>(value: T|undefined, defaultValue: T) {\n  return value === undefined ? defaultValue : value;\n}\n\nexport function verifyObjectProperty<T>(\n    obj: any, propertyName: string, validator: (value: any) => T): T {\n  let value = obj.hasOwnProperty(propertyName) ? obj[propertyName] : undefined;\n  try {\n    return validator(value);\n  } catch (parseError) {\n    throw new Error(\n        `Error parsing ${JSON.stringify(propertyName)} property: ${parseError.message}`);\n  }\n}\n\nexport function verifyObjectAsMap<T>(obj: any, validator: (value: any) => T): Map<string, T> {\n  verifyObject(obj);\n  let map = new Map<string, T>();\n  for (let key of Object.keys(obj)) {\n    try {\n      map.set(key, validator(obj[key]));\n    } catch (parseError) {\n      throw new Error(\n          `Error parsing value associated with key ${JSON.stringify(key)}: ${parseError.message}`);\n    }\n  }\n  return map;\n}\n\nexport function verifyFloat01(obj: any): number {\n  if (typeof obj !== 'number' || !Number.isFinite(obj) || obj < 0 || obj > 1) {\n    throw new Error(\n        `Expected floating point number in [0,1], but received: ${JSON.stringify(obj)}.`);\n  }\n  return obj;\n}\n\n/**\n * The query string parameters may either be specified in the usual\n * 'name=value&otherName=otherValue' form or as (optionally urlSafe) JSON: '{\"name\":\"value\"}`.\n */\nexport function parseQueryStringParameters(queryString: string) {\n  if (queryString === '') {\n    return {};\n  }\n  if (queryString.startsWith('{')) {\n    return urlSafeParse(queryString);\n  } else {\n    let result: any = {};\n    let parts = queryString.split(/[&;]/);\n    for (let part of parts) {\n      let m = part.match(/^([^=&;]+)=([^&;]*)$/);\n      if (m === null) {\n        throw new Error(`Invalid query string part: ${JSON.stringify(part)}.`);\n      }\n      result[m[1]] = decodeURIComponent(m[2]);\n    }\n    return result;\n  }\n}\n\n/**\n * Verifies that `obj' is a string that, when converted to uppercase, matches a string property of\n * `enumType`.\n *\n * Note: TypeScript does not seem to allow better typing of the return type.\n *\n * @returns The corresponding numerical value.\n */\nexport function verifyEnumString(obj: any, enumType: {[x: string]: any}): number {\n  if (typeof obj === 'string' && obj.match(/^[a-zA-Z]/) !== null) {\n    obj = obj.toUpperCase();\n    if (enumType.hasOwnProperty(obj)) {\n      return enumType[obj];\n    }\n  }\n  throw new Error(`Invalid enum value: ${JSON.stringify(obj)}.`);\n}\n\nexport function verify3dVec(obj: any) {\n  return parseFixedLengthArray(vec3.create(), obj, verifyFiniteFloat);\n}\n\nexport function verify3dScale(obj: any) {\n  return parseFixedLengthArray(vec3.create(), obj, verifyFinitePositiveFloat);\n}\n\nexport function verify3dDimensions(obj: any) {\n  return parseFixedLengthArray(vec3.create(), obj, verifyPositiveInt);\n}\n\nexport function verifyStringArray(a: any) {\n  if (!Array.isArray(a)) {\n    throw new Error(`Expected array, received: ${JSON.stringify(a)}.`);\n  }\n  for (let x of a) {\n    if (typeof x !== 'string') {\n      throw new Error(`Expected string, received: ${JSON.stringify(x)}.`);\n    }\n  }\n  return <string[]>a;\n}\n\nexport function verifyBoolean(x: any) {\n  if (typeof x !== 'boolean') {\n    throw new Error(`Expected boolean, received: ${JSON.stringify(x)}`);\n  }\n  return x;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Facility for triggering named actions in response to keyboard events.\n */\n\n// This is based on goog/ui/keyboardshortcuthandler.js in the Google Closure library.\n\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {ActionEvent, dispatchEventWithModifiers, EventActionMap, EventActionMapInterface, registerActionListener} from 'neuroglancer/util/event_action_map';\n\nconst globalKeys = new Set(\n    ['f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9', 'f10', 'f11', 'f12', 'escape', 'pause']);\nconst DEFAULT_TEXT_INPUTS = new Set([\n  'color', 'date', 'datetime', 'datetime-local', 'email', 'month', 'number', 'password', 'search',\n  'tel', 'text', 'time', 'url', 'week'\n]);\n\nexport class KeyboardEventBinder<EventMap extends EventActionMapInterface> extends RefCounted {\n  modifierShortcutsAreGlobal = true;\n  allShortcutsAreGlobal = false;\n  allowSpaceKeyOnButtons = false;\n  constructor(public target: EventTarget, public eventMap: EventMap) {\n    super();\n    this.registerEventListener(\n        target, 'keydown', this.handleKeyDown.bind(this), /*useCapture=*/false);\n  }\n\n  private shouldIgnoreEvent(key: string, event: KeyboardEvent) {\n    var el = <HTMLElement>event.target;\n    let {tagName} = el;\n    if (el === this.target) {\n      // If the event is directly on the target element, we never ignore it.\n      return false;\n    }\n    var isFormElement = tagName === 'TEXTAREA' || tagName === 'INPUT' || tagName === 'BUTTON' ||\n        tagName === 'SELECT';\n\n    var isContentEditable = !isFormElement &&\n        (el.isContentEditable || (el.ownerDocument && el.ownerDocument.designMode === 'on'));\n\n    if (!isFormElement && !isContentEditable) {\n      return false;\n    }\n    // Always allow keys registered as global to be used (typically Esc, the\n    // F-keys and other keys that are not typically used to manipulate text).\n    if (this.allShortcutsAreGlobal || globalKeys.has(key)) {\n      return false;\n    }\n    if (isContentEditable) {\n      // For events originating from an element in editing mode we only let\n      // global key codes through.\n      return true;\n    }\n    // Event target is one of (TEXTAREA, INPUT, BUTTON, SELECT).\n    // Allow modifier shortcuts, unless we shouldn't.\n    if (this.modifierShortcutsAreGlobal && (event.altKey || event.ctrlKey || event.metaKey)) {\n      return true;\n    }\n    // Allow ENTER to be used as shortcut for text inputs.\n    if (tagName === 'INPUT' && DEFAULT_TEXT_INPUTS.has((<HTMLInputElement>el).type)) {\n      return key !== 'enter';\n    }\n    // Checkboxes, radiobuttons and buttons. Allow all but SPACE as shortcut.\n    if (tagName === 'INPUT' || tagName === 'BUTTON') {\n      // TODO(gboyer): If more flexibility is needed, create protected helper\n      // methods for each case (e.g. button, input, etc).\n      if (this.allowSpaceKeyOnButtons) {\n        return false;\n      } else {\n        return key === 'space';\n      }\n    }\n    // Don't allow any additional shortcut keys for textareas or selects.\n    return true;\n  }\n\n  private handleKeyDown(event: KeyboardEvent) {\n    const key = getEventKeyName(event);\n    if (this.shouldIgnoreEvent(key, event)) {\n      return;\n    }\n    dispatchEventWithModifiers(key, event, event, this.eventMap);\n  }\n}\n\nexport function getEventKeyName(event: KeyboardEvent): string {\n  return event.code.toLowerCase();\n}\n\nexport {EventActionMapInterface, EventActionMap, registerActionListener, ActionEvent};\n","// DO NOT EDIT.  Generated from templates/neuroglancer/util/linked_list.template.ts.\n/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ninterface Node<T> {\n  next0: T|null;\n  prev0: T|null;\n}\n\nexport default class {\n  static insertAfter<T extends Node<T>>(head: T, x: T) {\n    let next = <T>head.next0;\n    x.next0 = next;\n    x.prev0 = head;\n    head.next0 = x;\n    next.prev0 = x;\n  }\n  static insertBefore<T extends Node<T>>(head: T, x: T) {\n    let prev = <T>head.prev0;\n    x.prev0 = prev;\n    x.next0 = head;\n    head.prev0 = x;\n    prev.next0 = x;\n  }\n  static front<T extends Node<T>>(head: T) {\n    let next = head.next0;\n    if (next === head) {\n      return null;\n    }\n    return next;\n  }\n  static back<T extends Node<T>>(head: T) {\n    let next = head.prev0;\n    if (next === head) {\n      return null;\n    }\n    return next;\n  }\n  static pop<T extends Node<T>>(x: T) {\n    let next = <T>x.next0;\n    let prev = <T>x.prev0;\n    next.prev0 = prev;\n    prev.next0 = next;\n    x.next0 = null;\n    x.prev0 = null;\n    return x;\n  }\n  static * iterator<T extends Node<T>>(head: T) {\n    for (let x = <T>head.next0; x !== head; x = <T>x.next0) {\n      yield x;\n    }\n  }\n  static * reverseIterator<T extends Node<T>>(head: T) {\n    for (let x = <T>head.prev0; x !== head; x = <T>x.prev0) {\n      yield x;\n    }\n  }\n  static initializeHead<T extends Node<T>>(head: T) {\n    head.next0 = head.prev0 = head;\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Returns the longest common prefix of a sequence of strings.\n *\n * Returns '' if the sequence of strings is empty.\n */\nexport function longestCommonPrefix(strings: Iterable<string>) {\n  let it = strings[Symbol.iterator]();\n  let {value: firstValue, done: noValues} = it.next();\n  if (noValues) {\n    // The sequence of strings is empty.\n    return '';\n  }\n  let commonPrefixLength = firstValue.length;\n  while (commonPrefixLength > 0) {\n    let {value, done} = it.next();\n    if (done) {\n      break;\n    }\n    let i = 0;\n    for (; i < commonPrefixLength; ++i) {\n      if (firstValue.charCodeAt(i) !== value.charCodeAt(i)) {\n        break;\n      }\n    }\n    commonPrefixLength = i;\n  }\n  return firstValue.substring(0, commonPrefixLength);\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {RefCounted, RefCountedValue} from 'neuroglancer/util/disposable';\nimport {stableStringify} from 'neuroglancer/util/json';\n\nexport class Memoize<Key, Value extends RefCounted> {\n  private map = new Map<Key, Value>();\n\n  /**\n   * If getter throws an exception, no value is added.\n   */\n  get<T extends Value>(key: Key, getter: () => T): T {\n    let {map} = this;\n    let obj = <T>map.get(key);\n    if (obj === undefined) {\n      obj = getter();\n      obj.registerDisposer(() => {\n        map.delete(key);\n      });\n      map.set(key, obj);\n    } else {\n      obj.addRef();\n    }\n    return obj;\n  }\n}\n\nexport class StringMemoize extends Memoize<string, RefCounted> {\n  get<T extends RefCounted>(x: any, getter: () => T) {\n    if (typeof x !== 'string') {\n      x = stableStringify(x);\n    }\n    return super.get(x, getter);\n  }\n\n  getUncounted<T>(x: any, getter: () => T) {\n    return this.get(x, () => new RefCountedValue(getter())).value;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Facility for triggering named actions in response to mouse events.\n */\n\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {ActionEvent, dispatchEventWithModifiers, EventActionMap, EventActionMapInterface, registerActionListener} from 'neuroglancer/util/event_action_map';\n\nexport class MouseEventBinder<EventMap extends EventActionMapInterface> extends RefCounted {\n  private dispatch(baseIdentifier: string, event: MouseEvent) {\n    dispatchEventWithModifiers(baseIdentifier, event, event, this.eventMap);\n  }\n  constructor(public target: EventTarget, public eventMap: EventMap) {\n    super();\n    this.registerEventListener(target, 'wheel', (event: WheelEvent) => {\n      this.dispatch('wheel', event);\n    });\n    this.registerEventListener(target, 'click', (event: MouseEvent) => {\n      this.dispatch(`click${event.button}`, event);\n    });\n    this.registerEventListener(target, 'dblclick', (event: MouseEvent) => {\n      this.dispatch(`dblclick${event.button}`, event);\n    });\n    this.registerEventListener(target, 'mousedown', (event: MouseEvent) => {\n      this.dispatch(`mousedown${event.button}`, event);\n    });\n    this.registerEventListener(target, 'mouseup', (event: MouseEvent) => {\n      this.dispatch(`mouseup${event.button}`, event);\n    });\n  }\n}\n\nexport {EventActionMapInterface, EventActionMap, registerActionListener, ActionEvent};\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport type RelativeDragHandler = (event: MouseEvent, deltaX: number, deltaY: number) => void;\nexport function startRelativeMouseDrag(\n    initialEvent: MouseEvent, handler: RelativeDragHandler,\n    finishDragHandler?: RelativeDragHandler) {\n  let {document} = initialEvent.view;\n  let prevClientX = initialEvent.clientX, prevClientY = initialEvent.clientY;\n  const mouseMoveHandler = (e: PointerEvent) => {\n    const deltaX = e.clientX - prevClientX;\n    const deltaY = e.clientY - prevClientY;\n    prevClientX = e.clientX;\n    prevClientY = e.clientY;\n    handler(e, deltaX, deltaY);\n  };\n  const button = initialEvent.button;\n  const cancel = (e: PointerEvent) => {\n    document.removeEventListener('pointermove', mouseMoveHandler, true);\n    document.removeEventListener('pointerup', mouseUpHandler, false);\n\n    if (finishDragHandler !== undefined) {\n      finishDragHandler(e, e.clientX - prevClientX, e.clientY - prevClientY);\n    }\n  };\n  const mouseUpHandler = (e: PointerEvent) => {\n    if (e.button === button) {\n      cancel(e);\n    }\n  };\n  document.addEventListener('pointermove', mouseMoveHandler, true);\n  document.addEventListener('pointerup', mouseUpHandler, false);\n  document.addEventListener('pointercancel', cancel, false);\n}\n","/**\n * @license\n * Copyright 2019 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function numberToStringFixed(v: number, maxDigits: number) {\n  let s = '';\n  for (let digits = 0; digits <= maxDigits; ++digits) {\n    s = v.toFixed(digits);\n    if (parseFloat(s) === v) {\n      break;\n    }\n  }\n  return s;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst OBJECT_ID_SYMBOL = Symbol('objectId');\nlet nextObjectId = 0;\n\n/**\n * Returns a string that uniquely identifies a particular primitive value or object instance.\n */\nexport function getObjectId(x: any) {\n  if (x instanceof Object) {\n    let id = x[OBJECT_ID_SYMBOL];\n    if (id === undefined) {\n      id = x[OBJECT_ID_SYMBOL] = nextObjectId++;\n    }\n    return `o${id}`;\n  } else {\n    return '' + JSON.stringify(x);\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {TypedArray} from 'neuroglancer/util/array';\n\nexport function getRandomHexString(numBits = 128) {\n  const numValues = Math.ceil(numBits / 32);\n  const data = new Uint32Array(numValues);\n  crypto.getRandomValues(data);\n  let s = '';\n  for (let i = 0; i < numValues; ++i) {\n    s += ('00000000' + data[i].toString(16)).slice(-8);\n  }\n  return s;\n}\n\n/**\n * Calls crypto.getRandomValues as many times as needed to fill array.\n */\nexport function getRandomValues<T extends TypedArray>(array: T): T {\n  let byteArray = new Uint8Array(array.buffer, array.byteOffset, array.byteLength);\n  const blockSize = 65536;\n  for (let i = 0, length = byteArray.length; i < length; i += blockSize) {\n    crypto.getRandomValues(byteArray.subarray(i, Math.min(length, i + blockSize)));\n  }\n  return array;\n}\n\nexport function getRandomUint32() {\n  const data = new Uint32Array(1);\n  crypto.getRandomValues(data);\n  return data[0];\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function scrollIntoViewIfNeeded(element: HTMLElement) {\n  const parent = element.parentElement!;\n  const elementLeft = element.offsetLeft - parent.clientLeft;\n  const elementTop = element.offsetTop - parent.clientTop;\n  const elementRight = elementLeft + element.offsetWidth;\n  const elementBottom = elementTop + element.offsetHeight;\n  const parentWidth = parent.clientWidth;\n  const parentHeight = parent.clientHeight;\n  const viewportLeft = parent.scrollLeft;\n  const viewportRight = viewportLeft + parentWidth;\n  const viewportTop = parent.scrollTop;\n  const viewportBottom = viewportTop + parentHeight;\n\n  const scrollLeftDelta =\n      Math.max(0.0, elementRight - viewportRight) || Math.min(0.0, elementLeft - viewportLeft);\n  const scrollTopDelta =\n      Math.max(0.0, elementBottom - viewportBottom) || Math.min(0.0, elementTop - viewportTop);\n\n  parent.scrollLeft += scrollLeftDelta;\n  parent.scrollTop += scrollTopDelta;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Simple signal dispatch mechanism.\n */\n\n/**\n * This class provides a simple signal dispatch mechanism.  Handlers can be added, and then the\n * `dispatch` method calls all of them.\n *\n * If specified, Callable should be an interface containing only a callable signature returning\n * void.  Due to limitations in TypeScript, any interface containing a callable signature will be\n * accepted by the compiler, but the resultant signature of `dispatch` will not be correct.\n */\nexport class Signal<Callable extends Function> {\n  private handlers = new Set<Callable>();\n\n  /**\n   * Count of number of times this signal has been dispatched.  This is incremented each time\n   * `dispatch` is called prior to invoking the handlers.\n   */\n  count = 0;\n\n  constructor() {\n    const obj = this;\n    this.dispatch = <Callable><Function>function(this: any) {\n      ++obj.count;\n      obj.handlers.forEach(handler => {\n        handler.apply(this, arguments);\n      });\n    };\n  }\n\n  /**\n   * Add a handler function.  If `dispatch` is currently be called, then the new handler will be\n   * called before `dispatch` returns.\n   *\n   * @param handler The handler function to add.\n   *\n   * @return A function that unregisters the handler.\n   */\n  add(handler: Callable): () => boolean {\n    this.handlers.add(handler);\n    return () => {\n      return this.remove(handler);\n    };\n  }\n\n  /**\n   * Remove a handler function.  If `dispatch` is currently be called and the new handler has not\n   * yet been called, then it will not be called.\n   *\n   * @param handler Handler to remove.\n   * @return `true` if the handler was present, `false` otherwise.\n   */\n  remove(handler: Callable): boolean {\n    return this.handlers.delete(handler);\n  }\n\n  /**\n   * Invokes each handler function with the same parameters (including `this`) with which it is\n   * called.  Handlers are invoked in the order in which they were added.\n   */\n  dispatch: Callable;\n\n  /**\n   * Disposes of resources.  No methods, including `dispatch`, may be invoked afterwards.\n   */\n  dispose() {\n    this.handlers = <any>undefined;\n  }\n}\n\n/**\n * Simple specialization of Signal for the common case of a nullary handler signature.\n */\nexport class NullarySignal extends Signal<() => void> {}\n\n/**\n * Interface for a signal excluding the dispatch method.\n *\n * Unlike Signal, this interface is covariant in the type of Callable.\n */\nexport interface ReadonlySignal<Callable extends Function> {\n  readonly count: number;\n  add(handler: Callable): () => void;\n  remove(handler: Callable): boolean;\n}\n\nexport type NullaryReadonlySignal = ReadonlySignal<() => void>;\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Signal} from 'neuroglancer/util/signal';\n\nexport function removeSignalBinding<T extends Function>(signal: Signal<T>, handler: T) {\n  signal.remove(handler);\n}\n\nexport function addSignalBinding<T extends Function>(signal: Signal<T>, handler: T) {\n  signal.add(handler);\n}\n\nexport interface SignalBindingUpdater<T extends Function> { (signal: Signal<T>, handler: T): void; }\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {mat3, mat4, prod3, transformVectorByMat4, vec3} from 'neuroglancer/util/geom';\nimport {pickLengthUnit, pickVolumeUnit} from 'neuroglancer/widget/scale_bar';\n\nexport function formatIntegerPoint(point: vec3) {\n  return `(${Math.floor(point[0])}, ${Math.floor(point[1])}, ${Math.floor(point[2])})`;\n}\n\nexport function formatIntegerBounds(bounds: vec3) {\n  let result = '';\n  for (let i = 0; i < 3; ++i) {\n    if (i !== 0) {\n      result += '  ';\n    }\n    result += Math.round(Math.abs(bounds[i]));\n  }\n  return result;\n}\n\nexport function formatLength(lengthInNanometers: number) {\n  const unit = pickLengthUnit(lengthInNanometers);\n  const value = lengthInNanometers / unit.lengthInNanometers;\n  return `${value.toPrecision(3)}\\u202f${unit.unit}`;\n}\n\nexport function formatVolume(volumeInCubicNanometers: number) {\n  const unit = pickVolumeUnit(volumeInCubicNanometers);\n  const value = volumeInCubicNanometers / Math.pow(unit.lengthInNanometers, 3);\n  return `${value.toPrecision(6)}\\u202f${unit.unit}`;\n}\n\nexport function formatBoundingBoxVolume(pointA: vec3, pointB: vec3, transform: mat4) {\n  let dimensionText = '';\n  const vector = vec3.create();\n  for (let axis = 0; axis < 3; ++axis) {\n    vec3.set(vector, 0, 0, 0);\n    vector[axis] = pointB[axis] - pointA[axis];\n    const spatialVector = transformVectorByMat4(vector, vector, transform);\n    const length = vec3.length(spatialVector);\n    if (axis !== 0) {\n      dimensionText += '  ';\n    }\n    dimensionText += formatLength(length);\n  }\n\n  const preTransformVolume = Math.abs(prod3(vec3.subtract(vector, pointB, pointA)));\n  const det = mat3.determinant(mat3.fromMat4(mat3.create(), transform));\n  const postTransformVolume = det * preTransformVolume;\n\n  return `${dimensionText}  [${formatVolume(postTransformVolume)}]`;\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Facility for triggering named actions in response to touch events.\n */\n\nimport throttle from 'lodash/throttle';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {ActionEvent, dispatchEvent, EventActionMap, EventActionMapInterface, registerActionListener} from 'neuroglancer/util/event_action_map';\n\nexport interface TouchTapInfo {\n  event: TouchEvent;\n  centerX: number;\n  centerY: number;\n}\n\nexport interface TouchTranslateInfo {\n  event: TouchEvent;\n  centerX: number;\n  centerY: number;\n  deltaX: number;\n  deltaY: number;\n}\n\nexport interface TouchPinchInfo {\n  event: TouchEvent;\n  centerX: number;\n  centerY: number;\n  distance: number;\n  prevDistance: number;\n}\n\nexport interface TouchRotateInfo {\n  event: TouchEvent;\n  centerX: number;\n  centerY: number;\n  angle: number;\n  prevAngle: number;\n}\n\nexport interface TouchHoldInfo {\n  event: TouchEvent;\n  centerX: number;\n  centerY: number;\n}\n\n/**\n * Minimum number of pixels in x and y that a touch point must move to trigger a\n * translate/rotate/pinch action.  This helps filter out spurious tiny movements that are hard to\n * avoid, especially with one finger touches.\n **/\nconst moveThreshold = 10;\n\n/**\n * Number of milliseconds that a set of touch points must be held without moving (per moveThreshold)\n * to trigger a touchhold action.\n **/\nconst holdThreshold = 1000;\n\n/**\n * Maximum duration of a tap.\n */\nconst maxTapDuration = 400;\n\n/**\n * Maximum number of milliseconds delay between two taps to trigger a multitap action.\n */\nconst multiTapMaxInterval = 500;\n\nconst rotateThreshold = Math.PI / 20;\nconst pinchThreshold = 20\nconst translateThreshold = 10;\n\nfunction norm2(deltaX: number, deltaY: number) {\n  return Math.sqrt(deltaX * deltaX + deltaY * deltaY);\n}\n\nfunction getTwoFingerDistanceAndAngle(touches: Iterable<Touch>) {\n  let [t0,t1] = touches;\n  if (t0.identifier > t1.identifier) {\n    [t1, t0] = [t0, t1];\n  }\n  const offsetX = t0.clientX - t1.clientX;\n  const offsetY = t0.clientY - t1.clientY;\n  const distance = norm2(offsetX, offsetY);\n  const angle = Math.atan2(offsetX, offsetY);\n  return {distance, angle};\n}\n\nfunction getAngleDifference(x: number, y: number) {\n  const TAU = Math.PI * 2;\n  const d = Math.abs(x - y) % TAU;\n  return Math.min(d, TAU - d);\n}\n\nexport class TouchEventBinder<EventMap extends EventActionMapInterface> extends RefCounted {\n  private dispatch(\n      eventIdentifier: string, event: Event, detail: any, eventPhase: number = event.eventPhase) {\n    dispatchEvent(eventIdentifier, event, eventPhase, detail, this.eventMap);\n  }\n  private prevTouches = new Map<number, Touch>();\n  private prevEvent?: TouchEvent;\n  private moved = false;\n\n  /**\n   * Initial angle for two-finger touch.  Once the difference between this ange the current angle\n   * exceeds `rotateThreshold`, `touchrotate` events are dispatched.\n   **/\n  private prevAngle = 0;\n  private rotated = false;\n\n  /**\n   * Initial distance for two-finger touch.  Once the difference between this ange the current\n   * distance exceeds `pinchThreshold`, `touchpinich` events are dispatched.\n   **/\n  private prevDistance = 0;\n  private pinched = false;\n\n  private prevCenterX = 0;\n  private prevCenterY = 0;\n  private translated = false;\n  \n  private startHold = this.registerCancellable(\n      throttle((event: TouchEvent, eventPhase: number, centerX: number, centerY: number) => {\n        const info = {event, centerX, centerY};\n        this.dispatch(`touchhold${event.targetTouches.length}`, event, info, eventPhase);\n      }, holdThreshold, {leading: false, trailing: true}));\n  private numPriorTaps = 0;\n  private priorTapNumTouches = 0;\n  private tapStartTime = 0;\n  private tapEndTime = 0;\n  private curTapNumTouches = 0;\n\n  private handleTouchEvent(event: TouchEvent) {\n    if (event.target === this.target) {\n      event.preventDefault();\n    } else {\n      return;\n    }\n    const newTouches = new Map<number, Touch>();\n    const {prevTouches, prevEvent} = this;\n    \n    // Compute average movement.\n    let centerX = 0, centerY = 0;\n    \n    for (const touch of event.targetTouches) {\n      newTouches.set(touch.identifier, touch);\n      centerX += touch.clientX;\n      centerY += touch.clientY;\n    }\n    centerX /= newTouches.size;\n    centerY /= newTouches.size;\n    // Remove touches that are no longer matched.\n    for (const [key, touch] of prevTouches.entries()) {\n      const newTouch = newTouches.get(key);\n      if (newTouch === undefined) {\n        prevTouches.delete(key);\n      } else {\n        const deltaX = newTouch.clientX - touch.clientX;\n        const deltaY = newTouch.clientY - touch.clientY;\n        if (Math.abs(deltaX) >= moveThreshold || Math.abs(deltaY) >= moveThreshold) {\n          this.moved = true;\n        }\n      }\n    }\n\n    if (prevEvent === undefined || prevEvent.targetTouches.length !== newTouches.size ||\n        newTouches.size == 0) {\n      this.moved = false;\n\n      if (event.type === 'touchstart') {\n        this.startHold(event, event.eventPhase, centerX, centerY);\n        if (prevEvent === undefined || prevEvent.targetTouches.length === 0) {\n          this.tapStartTime = Date.now();\n          this.curTapNumTouches = 0;\n        }\n        this.curTapNumTouches = Math.max(this.curTapNumTouches, event.targetTouches.length);\n      } else {\n        if (event.type == 'touchend') {\n          const now = Date.now();\n          if (event.targetTouches.length === 0 && now - this.tapStartTime < maxTapDuration) {\n            if (this.curTapNumTouches !== this.priorTapNumTouches ||\n                now - this.tapEndTime >= multiTapMaxInterval) {\n              this.numPriorTaps = 0;\n            }\n            ++this.numPriorTaps;\n            this.tapEndTime = now;\n            this.priorTapNumTouches = this.curTapNumTouches;\n            const info: TouchTapInfo = {event, centerX, centerY};\n            this.dispatch(`touchtap${this.curTapNumTouches}x${this.numPriorTaps}`, event, info);\n          }\n        }\n        this.startHold.cancel();\n      }\n      // Number of touches has changed.  Don't dispatch any events.\n      // TODO: handle tap events\n      this.prevTouches = newTouches;\n      this.prevEvent = event;\n\n      this.prevCenterX = centerX;\n      this.prevCenterY = centerY;\n      this.translated = false;\n\n      if (newTouches.size === 2) {\n        const {distance, angle} = getTwoFingerDistanceAndAngle(newTouches.values());\n        this.prevDistance = distance;\n        this.prevAngle = angle;\n        this.rotated = false;\n        this.pinched = false;\n      }\n      return;\n    }\n\n    if (!this.moved) {\n      return;\n    }\n    this.tapStartTime = 0;\n    this.startHold.cancel();\n    this.prevTouches = newTouches;\n    this.prevEvent = event;\n\n    let {prevCenterX, prevCenterY, translated} = this;\n    const deltaX = centerX - prevCenterX;\n    const deltaY = centerY - prevCenterY;\n    if (translated === false && norm2(deltaX, deltaY) >= translateThreshold) {\n      translated = this.translated = true;\n    }\n    if (translated === true && (deltaX !== 0 || deltaY !== 0)) {\n      this.prevCenterX = centerX;\n      this.prevCenterY = centerY;\n      const info: TouchTranslateInfo = {event, deltaX, deltaY, centerX, centerY};\n      this.dispatch(`touchtranslate${newTouches.size}`, event, info);\n    }\n\n    if (newTouches.size === 2) {\n      const {distance, angle} = getTwoFingerDistanceAndAngle(newTouches.values());\n      let {pinched, rotated, prevDistance, prevAngle} = this;\n      if (pinched === false && Math.abs(distance - prevDistance) >= pinchThreshold) {\n        this.pinched = pinched = true;\n      }\n\n      const angleDiff = getAngleDifference(angle, prevAngle);\n\n      if (rotated === false && angleDiff >= rotateThreshold) {\n        this.rotated = rotated = true;\n      }\n\n      if (pinched === true && distance != prevDistance) {\n        this.prevDistance = distance;\n        const info: TouchPinchInfo = {event, distance, prevDistance, centerX, centerY};\n        this.dispatch(`touchpinch`, event, info);\n      }\n\n      if (rotated === true && angle !== prevAngle) {\n        this.prevAngle = angle;\n        this.dispatch(`touchrotate`, event, {event, centerX, centerY, angle, prevAngle});\n      }\n    }\n  }\n  constructor(public target: HTMLElement, public eventMap: EventMap) {\n    super();\n    this.registerEventListener(target, 'touchstart', (event: TouchEvent) => {\n      this.handleTouchEvent(event);\n    });\n    this.registerEventListener(target, 'touchmove', (event: TouchEvent) => {\n      this.handleTouchEvent(event);\n    });\n    this.registerEventListener(target, 'touchend', (event: TouchEvent) => {\n      this.handleTouchEvent(event);\n    });\n  }\n}\n\nexport {EventActionMapInterface, EventActionMap, registerActionListener, ActionEvent};\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Defines a generic interface for a simple state tracking mechanism.\n */\n\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {verifyObject} from 'neuroglancer/util/json';\nimport {NullaryReadonlySignal, NullarySignal} from 'neuroglancer/util/signal';\n\nexport interface Trackable {\n  restoreState: (x: any) => void;\n  reset: () => void;\n  changed: NullaryReadonlySignal;\n  toJSON: () => any;\n}\n\nexport class CompoundTrackable extends RefCounted implements Trackable {\n  children = new Map<string, Trackable>();\n  changed = new NullarySignal();\n\n  add(key: string, value: Trackable): () => void {\n    const {children} = this;\n    if (children.has(key)) {\n      throw new Error(`Key ${JSON.stringify(key)} already registered.`);\n    }\n    this.children.set(key, value);\n    value.changed.add(this.changed.dispatch);\n    this.changed.dispatch();\n    return () => {\n      this.remove(key);\n    };\n  }\n\n  remove(key: string): void {\n    const {children} = this;\n    if (children.has(key)) {\n      throw new Error(`Key ${JSON.stringify(key)} not registered.`);\n    }\n    const value = children.get(key)!;\n    this.children.delete(key);\n    value.changed.remove(this.changed.dispatch);\n    this.changed.dispatch();\n  }\n\n  disposed() {\n    const {changed} = this;\n    for (let value of this.children.values()) {\n      value.changed.remove(changed.dispatch);\n    }\n    this.children = <any>undefined;\n    super.disposed();\n  }\n\n  toJSON() {\n    const result = this.baseJSON();\n    for (let [key, value] of this.children) {\n      result[key] = value.toJSON();\n    }\n    return result;\n  }\n\n  baseJSON() {\n    return <{[key: string]: any}>{};\n  }\n\n  reset() {\n    for (let value of this.children.values()) {\n      value.reset();\n    }\n  }\n\n  restoreState(x: any) {\n    verifyObject(x);\n    for (let [key, value] of this.children) {\n      try {\n        if (x.hasOwnProperty(key)) {\n          const subValue = x[key];\n          if (subValue === undefined) {\n            continue;\n          }\n          value.restoreState(subValue);\n        }\n      } catch (restoreError) {\n        throw new Error(`Error restoring property ${JSON.stringify(key)}: ${restoreError.message}`);\n      }\n    }\n  }\n}\n\nexport class PersistentCompoundTrackable extends CompoundTrackable {\n  lastState: {[key: string]: any} = {};\n\n  restoreState(x: any) {\n    verifyObject(x);\n    this.lastState = x;\n    super.restoreState(x);\n  }\n\n  reset () {\n    this.lastState = {};\n    super.reset();\n  }\n\n  baseJSON() {\n    const result = Object.assign(super.baseJSON(), this.lastState);\n    for (const key of this.children.keys()) {\n      delete result[key];\n    }\n    return result;\n  }\n\n  toJSON() {\n    const result = super.toJSON();\n    this.lastState = result;\n    return result;\n  }\n  add(key: string, value: Trackable) {\n    const result = super.add(key, value);\n    const existingValue = this.lastState[key];\n    if (existingValue !== undefined) {\n      value.reset();\n      value.restoreState(existingValue);\n    }\n    return result;\n  }\n}\n\n/**\n * Cache used by getCachedJson.\n */\nconst jsonCache = new WeakMap<Trackable, {value: any, generation: number}>();\n\n/**\n * Returns a JSON representation of a Trackable object.\n *\n * Recursively caches the result, such that it is only necessary to traverse the changed portions of\n * the object.\n *\n * The returned value must not be modified.\n */\nexport function getCachedJson(root: Trackable): {value: any, generation: number} {\n  let cacheState = jsonCache.get(root);\n  const generation = root.changed.count;\n  if (cacheState !== undefined) {\n    if (cacheState.generation === generation) {\n      return cacheState;\n    }\n  }\n  let value: any;\n  if (root instanceof CompoundTrackable) {\n    value = root.baseJSON();\n    for (let [k, v] of root.children) {\n      value[k] = getCachedJson(v).value;\n    }\n  } else {\n    value = root.toJSON();\n  }\n  if (cacheState === undefined) {\n    cacheState = {generation, value};\n    jsonCache.set(root, cacheState);\n  } else {\n    cacheState.generation = generation;\n    cacheState.value = value;\n  }\n  return cacheState;\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {verifyEnumString} from 'neuroglancer/util/json';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {Trackable} from 'neuroglancer/util/trackable';\n\nexport class TrackableEnum<T extends number> implements Trackable {\n  changed = new NullarySignal();\n\n  constructor(\n      public enumType: {[x: string]: any},\n      private value_: T,\n      private defaultValue: T = value_,\n  ) {}\n\n  set value(value: T) {\n    if (this.value_ !== value) {\n      this.value_ = value;\n      this.changed.dispatch();\n    }\n  }\n\n  get value() {\n    return this.value_;\n  }\n\n  reset() {\n    this.value = this.defaultValue;\n  }\n\n  restoreState(obj: any) {\n    this.value = <T>verifyEnumString(obj, this.enumType);\n  }\n\n  toJSON(): string {\n    return this.enumType[<number>this.value_].toLowerCase();\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst randomTempBuffer = new Uint32Array(2);\n\nconst trueBase = 0x100000000;\n\n// For dealing with the string representation in base b, we will represent the 64-bit number as\n//\n//   highPrime * intermediateBase[b] + lowPrime,\n//\n// where:\n//\n//   intermediateBaseForBase[b] = Math.pow(b, lowDigitsforBase[b]),\n//\n// and\n//\n//   lowDigitsForBase[b] = Math.floor(Math.log(Math.pow(2,53 - 32)) / Math.log(b)).\n\ninterface StringConversionData {\n  lowDigits: number;\n\n  lowBase: number;\n\n  pattern: RegExp;\n}\n\nlet stringConversionData: StringConversionData[] = [];\nfor (let base = 2; base <= 36; ++base) {\n  let lowDigits = Math.floor(32 / Math.log2(base));\n  let lowBase = Math.pow(base, lowDigits);\n  let patternString = `^[0-${String.fromCharCode('0'.charCodeAt(0) + Math.min(9, base - 1))}`;\n  if (base > 10) {\n    patternString += `a-${String.fromCharCode('a'.charCodeAt(0) + base - 11)}`;\n    patternString += `A-${String.fromCharCode('A'.charCodeAt(0) + base - 11)}`;\n  }\n  let maxDigits = Math.ceil(64 / Math.log2(base));\n  patternString += `]{1,${maxDigits}}$`;\n  let pattern = new RegExp(patternString);\n  stringConversionData[base] = {lowDigits, lowBase, pattern};\n}\n\n/**\n * Returns the high 32 bits of the result of the 32-bit integer multiply `a` and `b`.\n *\n * The low 32-bits can be obtained using the built-in `Math.imul` function.\n */\nfunction uint32MultiplyHigh(a: number, b: number) {\n  a >>>= 0;\n  b >>>= 0;\n\n  const a00 = a & 0xFFFF, a16 = a >>> 16;\n  const b00 = b & 0xFFFF, b16 = b >>> 16;\n\n  let c00 = a00 * b00;\n  let c16 = (c00 >>> 16) + (a16 * b00);\n  let c32 = c16 >>> 16;\n  c16 = (c16 & 0xFFFF) + (a00 * b16);\n  c32 += c16 >>> 16;\n  let c48 = c32 >>> 16;\n  c32 = (c32 & 0xFFFF) + (a16 * b16);\n  c48 += c32 >>> 16;\n\n  return (((c48 & 0xFFFF) << 16) | (c32 & 0xFFFF)) >>> 0;\n}\n\nexport class Uint64 {\n  constructor(public low: number = 0, public high: number = 0) {}\n\n  clone() {\n    return new Uint64(this.low, this.high);\n  }\n\n  assign(x: Uint64) {\n    this.low = x.low;\n    this.high = x.high;\n  }\n\n  toString(base = 10): string {\n    let vLow = this.low, vHigh = this.high;\n    if (vHigh === 0) {\n      return vLow.toString(base);\n    }\n    vHigh *= trueBase;\n    let {lowBase, lowDigits} = stringConversionData[base];\n    let vHighExtra = vHigh % lowBase;\n    vHigh = Math.floor(vHigh / lowBase);\n    vLow += vHighExtra;\n    vHigh += Math.floor(vLow / lowBase);\n    vLow = vLow % lowBase;\n    let vLowStr = vLow.toString(base);\n    return vHigh.toString(base) + '0'.repeat(lowDigits - vLowStr.length) + vLowStr;\n  }\n\n  /**\n   * Returns true if a is strictly less than b.\n   */\n  static less(a: Uint64, b: Uint64): boolean {\n    return a.high < b.high || (a.high === b.high && a.low < b.low);\n  }\n\n  /**\n   * Returns a negative number if a is strictly less than b, 0 if a is equal to b, or a positive\n   * number if a is strictly greater than b.\n   */\n  static compare(a: Uint64, b: Uint64): number {\n    return (a.high - b.high) || (a.low - b.low);\n  }\n\n  static ZERO = new Uint64(0, 0);\n  static ONE = new Uint64(1, 0);\n\n  static equal(a: Uint64, b: Uint64) {\n    return a.low === b.low && a.high === b.high;\n  }\n\n  static min(a: Uint64, b: Uint64): Uint64 {\n    return Uint64.less(a, b) ? a : b;\n  }\n\n  static max(a: Uint64, b: Uint64): Uint64 {\n    return Uint64.less(a, b) ? b : a;\n  }\n\n  static random() {\n    crypto.getRandomValues(randomTempBuffer);\n    return new Uint64(randomTempBuffer[0], randomTempBuffer[1]);\n  }\n\n  tryParseString(s: string, base = 10) {\n    const {lowDigits, lowBase, pattern} = stringConversionData[base];\n    if (!pattern.test(s)) {\n      return false;\n    }\n    if (s.length <= lowDigits) {\n      this.low = parseInt(s, base);\n      this.high = 0;\n      return true;\n    }\n    const splitPoint = s.length - lowDigits;\n    const lowPrime = parseInt(s.substr(splitPoint), base);\n    const highPrime = parseInt(s.substr(0, splitPoint), base);\n\n    let high: number, low: number;\n\n    if (lowBase === trueBase) {\n      high = highPrime;\n      low = lowPrime;\n    } else {\n      const highRemainder = Math.imul(highPrime, lowBase) >>> 0;\n      high = uint32MultiplyHigh(highPrime, lowBase) +\n          (Math.imul(Math.floor(highPrime / trueBase), lowBase) >>> 0);\n      low = lowPrime + highRemainder;\n      if (low >= trueBase) {\n        ++high;\n        low -= trueBase;\n      }\n    }\n    if ((low >>> 0) !== low || ((high >>> 0) !== high)) {\n      return false;\n    }\n    this.low = low;\n    this.high = high;\n    return true;\n  }\n\n  parseString(s: string, base = 10) {\n    if (!this.tryParseString(s, base)) {\n      throw new Error(`Failed to parse string as uint64 value: ${JSON.stringify(s)}.`);\n    }\n    return this;\n  }\n\n  static parseString(s: string, base = 10) {\n    let x = new Uint64();\n    return x.parseString(s, base);\n  }\n\n  valid() {\n    let {low, high} = this;\n    return ((low >>> 0) === low) && ((high >>> 0) === high);\n  }\n\n  toJSON() {\n    return this.toString();\n  }\n\n  static lshift(out: Uint64, input: Uint64, bits: number): Uint64 {\n    const {low, high} = input;\n    if (bits === 0) {\n      out.low = low;\n      out.high = high;\n    } else if (bits < 32) {\n      out.low = low << bits;\n      out.high = (high << bits) | (low >>> (32 - bits));\n    } else {\n      out.low = 0;\n      out.high = low << (bits - 32);\n    }\n    return out;\n  }\n\n  static rshift(out: Uint64, input: Uint64, bits: number) {\n    const {low, high} = input;\n    if (bits === 0) {\n      out.low = low;\n      out.high = high;\n    } else if (bits < 32) {\n      out.low = (low >>> bits) | (high << (32 - bits));\n      out.high = high >>> bits;\n    } else {\n      out.low = high >>> (bits - 32);\n      out.high = 0;\n    }\n    return out;\n  }\n\n  static or(out: Uint64, a: Uint64, b: Uint64): Uint64 {\n    out.low = a.low | b.low;\n    out.high = a.high | b.high;\n    return out;\n  }\n\n  static xor(out: Uint64, a: Uint64, b: Uint64): Uint64 {\n    out.low = a.low ^ b.low;\n    out.high = a.high ^ b.high;\n    return out;\n  }\n\n  static and(out: Uint64, a: Uint64, b: Uint64): Uint64 {\n    out.low = a.low & b.low;\n    out.high = a.high & b.high;\n    return out;\n  }\n\n  static add(out: Uint64, a: Uint64, b: Uint64): Uint64 {\n    let lowSum = a.low + b.low;\n    let highSum = a.high + b.high;\n    const low = lowSum >>> 0;\n    if (low !== lowSum) highSum += 1;\n    out.low = low;\n    out.high = highSum >>> 0;\n    return out;\n  }\n\n  static addUint32(out: Uint64, a: Uint64, b: number): Uint64 {\n    let lowSum = a.low + b;\n    let highSum = a.high;\n    const low = lowSum >>> 0;\n    if (low !== lowSum) highSum += 1;\n    out.low = low;\n    out.high = highSum >>> 0;\n    return out;\n  }\n\n  static decrement(out: Uint64, input: Uint64): Uint64 {\n    let {low, high} = input;\n    if (low === 0) {\n      high -= 1;\n    }\n    out.low = (low - 1) >>> 0;\n    out.high = high >>> 0;\n    return out;\n  }\n\n  static increment(out: Uint64, input: Uint64): Uint64 {\n    let {low, high} = input;\n    if (low === 0xFFFFFFFF) high += 1;\n    out.low = (low + 1) >>> 0;\n    out.high = high >>> 0;\n    return out;\n  }\n\n  static subtract(out: Uint64, a: Uint64, b: Uint64): Uint64 {\n    let lowSum = a.low - b.low;\n    let highSum = a.high - b.high;\n    const low = lowSum >>> 0;\n    if (low !== lowSum) highSum -= 1;\n    out.low = low;\n    out.high = highSum >>> 0;\n    return out;\n  }\n\n  static multiplyUint32(out: Uint64, a: Uint64, b: number): Uint64 {\n    const {low, high} = a;\n    out.low = Math.imul(low, b) >>> 0;\n    out.high = (Math.imul(high, b) + uint32MultiplyHigh(low, b)) >>> 0;\n    return out;\n  }\n\n  static lowMask(out: Uint64, bits: number) {\n    if (bits <= 32) {\n      out.high = 0;\n      out.low = 0xffffffff >>> (32 - bits);\n    } else {\n      out.high = 0xffffffff >>> (bits - 32);\n      out.low = 0xffffffff;\n    }\n    return out;\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {NullarySignal} from 'neuroglancer/util/signal';\n\nexport class WatchableMap<K, V> extends RefCounted {\n  changed = new NullarySignal();\n  map: Map<K, V>;\n  constructor(\n      private register: (v: V, k: K) => void, private unregister: (v: V, k: K) => void,\n      values?: Iterable<[K, V]>) {\n    super();\n    if (values === undefined) {\n      this.map = new Map();\n    } else {\n      this.map = new Map(values);\n      this.map.forEach(this.register);\n    }\n  }\n  set(key: K, value: V) {\n    const {map} = this;\n    const existing = map.get(key);\n    if (existing !== undefined) {\n      this.unregister(existing, key);\n    }\n    map.set(key, value);\n    this.register(value, key);\n    this.changed.dispatch();\n    return this;\n  }\n  delete(key: K) {\n    const {map} = this;\n    const existing = map.get(key);\n    if (existing !== undefined) {\n      this.unregister(existing, key);\n      this.changed.dispatch();\n      return true;\n    }\n    return false;\n  }\n  has(key: K) {\n    return this.map.has(key);\n  }\n  get size() {\n    return this.map.size;\n  }\n  [Symbol.iterator]() {\n    return this.map[Symbol.iterator]();\n  }\n  clear() {\n    const {map} = this;\n    if (map.size > 0) {\n      map.forEach(this.unregister);\n      map.clear();\n      this.changed.dispatch();\n    }\n  }\n  values() {\n    return this.map.values();\n  }\n  keys() {\n    return this.map.keys();\n  }\n  disposed() {\n    const {map} = this;\n    map.forEach(this.unregister);\n    this.map.clear();\n    super.disposed();\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst DOM_DELTA_PIXEL = 0;\nconst DOM_DELTA_LINE = 1;\nconst DOM_DELTA_PAGE = 2;\n\nexport function getWheelZoomAmount(event: WheelEvent) {\n  let multiplier = 0;\n  let {deltaMode} = event;\n  switch (deltaMode) {\n    case DOM_DELTA_PIXEL:\n      multiplier = 1 / 200.0;\n      break;\n    case DOM_DELTA_LINE:\n      multiplier = 1 / 10.0;\n      break;\n    case DOM_DELTA_PAGE:\n      multiplier = 2;\n      break;\n  }\n  return Math.exp(event.deltaY * multiplier);\n}\n","/**\n * @license\n * Copyright 2019 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Uint64} from './uint64';\n\nexport function getOctreeChildIndex(x: number, y: number, z: number) {\n  return (x & 1) | ((y << 1) & 2) | ((z << 2) & 4);\n}\n\n/**\n * Decodes a \"compressed\" 3-d morton index.\n *\n * Decoded bit `i` of `x`, `y`, and `z` is at bit `i + min(i, yBits) + min(i, zBits)`, `i + min(i +\n * 1, xBits) + min(i, zBits)`, and `i + min(i + 1, xBits) + min(i + 1, zBits)` of `zindex`,\n * respectively, for `i` in `[0, xBits)`, `[0, yBits)`, `[0, zBits)`, respectively.\n */\nexport function decodeZIndexCompressed(\n    zindex: Uint64, xBits: number, yBits: number, zBits: number): Uint32Array {\n  const maxCoordBits = Math.max(xBits, yBits, zBits);\n  let inputBit = 0;\n  let inputValue = zindex.low;\n  let x = 0, y = 0, z = 0;\n  for (let coordBit = 0; coordBit < maxCoordBits; ++coordBit) {\n    if (coordBit < xBits) {\n      const bit = (inputValue >>> inputBit) & 1;\n      x |= (bit << coordBit);\n      if (inputBit === 31) {\n        inputBit = 0;\n        inputValue = zindex.high;\n      } else {\n        ++inputBit;\n      }\n    }\n    if (coordBit < yBits) {\n      const bit = (inputValue >>> inputBit) & 1;\n      y |= (bit << coordBit);\n      if (inputBit === 31) {\n        inputBit = 0;\n        inputValue = zindex.high;\n      } else {\n        ++inputBit;\n      }\n    }\n    if (coordBit < zBits) {\n      const bit = (inputValue >>> inputBit) & 1;\n      z |= (bit << coordBit);\n      if (inputBit === 31) {\n        inputBit = 0;\n        inputValue = zindex.high;\n      } else {\n        ++inputBit;\n      }\n    }\n  }\n  return Uint32Array.of(x, y, z);\n}\n\nexport function encodeZIndexCompressed(\n    zindex: Uint64, xBits: number, yBits: number, zBits: number, x: number, y: number,\n    z: number): Uint64 {\n  const maxBits = Math.max(xBits, yBits, zBits);\n  let outputBit = 0;\n  let outputNum = 0;\n  let isHigh = false;\n  function writeBit(b: number): void {\n    outputNum |= (b & 1) << outputBit;\n    if (++outputBit === 32) {\n      zindex.low = outputNum;\n      outputNum = 0;\n      outputBit = 0;\n      isHigh = true;\n    }\n  }\n  for (let bit = 0; bit < maxBits; ++bit) {\n    if (bit < xBits) {\n      writeBit((x >> bit) & 1);\n    }\n    if (bit < yBits) {\n      writeBit((y >> bit) & 1);\n    }\n    if (bit < zBits) {\n      writeBit((z >> bit) & 1);\n    }\n  }\n  if (isHigh) {\n    zindex.high = outputNum;\n  } else {\n    zindex.high = 0;\n    zindex.low = outputNum;\n  }\n  return zindex;\n}\n\nfunction lessMsb(a: number, b: number) {\n  return a < b && a < (a ^ b);\n}\n\n/**\n * Returns `true` if `(x0, y0, z0)` occurs before `(x1, y1, z1)` in Z-curve order.\n */\nexport function zorder3LessThan(\n    x0: number, y0: number, z0: number, x1: number, y1: number, z1: number): boolean {\n  let mostSignificant0 = z0, mostSignificant1 = z1;\n\n  if (lessMsb(mostSignificant0 ^ mostSignificant1, y0 ^ y1)) {\n    mostSignificant0 = y0;\n    mostSignificant1 = y1;\n  }\n\n  if (lessMsb(mostSignificant0 ^ mostSignificant1, x0 ^ x1)) {\n    mostSignificant0 = x0;\n    mostSignificant1 = x1;\n  }\n\n  return mostSignificant0 < mostSignificant1;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {ChunkManager} from 'neuroglancer/chunk_manager/frontend';\nimport {DataSourceProvider, GetVectorGraphicsOptions} from 'neuroglancer/datasource';\nimport {UserLayer} from 'neuroglancer/layer';\nimport {LayerListSpecification, registerLayerType} from 'neuroglancer/layer_specification';\nimport {VectorGraphicsType} from 'neuroglancer/sliceview/vector_graphics/base';\nimport {MultiscaleVectorGraphicsChunkSource, RenderLayer} from 'neuroglancer/sliceview/vector_graphics/frontend';\nimport {VectorGraphicsLineRenderLayer} from 'neuroglancer/sliceview/vector_graphics/vector_graphics_line_renderlayer';\nimport {StatusMessage} from 'neuroglancer/status';\nimport {trackableAlphaValue} from 'neuroglancer/trackable_alpha';\nimport {trackableFiniteFloat} from 'neuroglancer/trackable_finite_float';\nimport {trackableVec3, TrackableVec3} from 'neuroglancer/trackable_vec3';\nimport {vec3} from 'neuroglancer/util/geom';\nimport {verifyEnumString, verifyFiniteFloat, verifyOptionalString} from 'neuroglancer/util/json';\nimport {RangeWidget} from 'neuroglancer/widget/range';\nimport {Tab} from 'neuroglancer/widget/tab_view';\nimport {Vec3Widget} from 'neuroglancer/widget/vec3_entry_widget';\n\nimport './image_user_layer.css';\nimport 'neuroglancer/maximize_button.css';\n\nfunction getVectorGraphicsWithStatusMessage(\n    dataSourceProvider: DataSourceProvider, chunkManager: ChunkManager, x: string,\n    options: GetVectorGraphicsOptions = {}): Promise<MultiscaleVectorGraphicsChunkSource> {\n  return StatusMessage.forPromise(\n      new Promise(function(resolve) {\n        resolve(dataSourceProvider.getVectorGraphicsSource(chunkManager, x, options));\n      }),\n      {\n        initialMessage: `Retrieving metadata for vector graphics source ${x}.`,\n        delay: true,\n        errorPrefix: `Error retrieving metadata for vector graphics source ${x}: `,\n      });\n}\n\nexport class VectorGraphicsUserLayer extends UserLayer {\n  vectorGraphicsPath: string|undefined;\n  vectorGraphicsLayerType: VectorGraphicsType;\n  opacity = trackableAlphaValue(0.5);\n  lineWidth = trackableFiniteFloat(10.0);\n  color = trackableVec3(vec3.fromValues(1.0, 1.0, 1.0));\n  renderLayer: RenderLayer;\n  constructor(manager: LayerListSpecification, x: any) {\n    super(manager, x);\n\n    this.opacity.restoreState(x['opacity']);\n    this.lineWidth.restoreState(x['linewidth']);\n    this.color.restoreState(x['color']);\n\n    this.lineWidth.changed.add(() => {\n      this.specificationChanged.dispatch();\n    });\n    this.color.changed.add(() => {\n      this.specificationChanged.dispatch();\n    });\n\n    this.vectorGraphicsLayerType = verifyEnumString(x['type'], VectorGraphicsType);\n\n    let vectorGraphicsPath = this.vectorGraphicsPath = verifyOptionalString(x['source']);\n    let remaining = 0;\n    if (vectorGraphicsPath !== undefined) {\n      ++remaining;\n      if (this.vectorGraphicsLayerType === VectorGraphicsType.LINE) {\n        getVectorGraphicsWithStatusMessage(\n            manager.dataSourceProvider, manager.chunkManager, vectorGraphicsPath)\n            .then(vectorGraphics => {\n              if (!this.wasDisposed) {\n                let renderLayer = this.renderLayer =\n                    new VectorGraphicsLineRenderLayer(vectorGraphics, {\n                      opacity: this.opacity,\n                      lineWidth: this.lineWidth,\n                      color: this.color,\n                      sourceOptions: {}\n                    });\n                this.addRenderLayer(renderLayer);\n                if (--remaining === 0) {\n                  this.isReady = true;\n                }\n              }\n            });\n      }\n    }\n    this.tabs.add(\n        'rendering', {label: 'Rendering', order: -100, getter: () => new DisplayOptionsTab(this)});\n    this.tabs.default = 'rendering';\n  }\n\n  toJSON() {\n    const x = super.toJSON();\n    x['type'] = this.getLayerType();\n    x['source'] = this.vectorGraphicsPath;\n    x['opacity'] = this.opacity.toJSON();\n    x['linewidth'] = this.lineWidth.toJSON();\n    x['color'] = this.color.toJSON();\n    return x;\n  }\n\n  getLayerType() {\n    let typeStr = VectorGraphicsType[this.vectorGraphicsLayerType];\n    return typeStr.toLowerCase();\n  }\n}\n\nclass DisplayOptionsTab extends Tab {\n  opacityWidget = this.registerDisposer(new RangeWidget(this.layer.opacity));\n  lineWidthWidget =\n      this.registerDisposer(new RangeWidget(this.layer.lineWidth, {min: 0, max: 50, step: 1}));\n  colorWidget = this.registerDisposer(new VectorGraphicsColorWidget(this.layer.color));\n\n  constructor(public layer: VectorGraphicsUserLayer) {\n    super();\n    const {element} = this;\n    element.classList.add('image-dropdown');\n    let {opacityWidget, lineWidthWidget, colorWidget} = this;\n    let topRow = document.createElement('div');\n    topRow.className = 'image-dropdown-top-row';\n    opacityWidget.promptElement.textContent = 'Opacity';\n    lineWidthWidget.promptElement.textContent = 'Line Width';\n    colorWidget.promptElement.textContent = 'Color';\n\n    let spacer = document.createElement('div');\n    spacer.style.flex = '1';\n    let helpLink = document.createElement('a');\n    let helpButton = document.createElement('button');\n    helpButton.type = 'button';\n    helpButton.textContent = '?';\n    helpButton.className = 'help-link';\n    helpLink.appendChild(helpButton);\n    helpLink.title = 'Documentation on vector graphics layer rendering';\n    helpLink.target = '_blank';\n    helpLink.href =\n        'https://github.com/google/neuroglancer/blob/master/src/neuroglancer/sliceview/vectorgraphics_layer_rendering.md';\n\n    topRow.appendChild(spacer);\n    topRow.appendChild(helpLink);\n\n    element.appendChild(topRow);\n    element.appendChild(this.opacityWidget.element);\n    element.appendChild(this.lineWidthWidget.element);\n    element.appendChild(this.colorWidget.element);\n  }\n}\n\n\nclass VectorGraphicsColorWidget extends Vec3Widget {\n  constructor(model: TrackableVec3) {\n    super(model);\n  }\n\n  verifyValue(value: any) {\n    let num = verifyFiniteFloat(value);\n    // Scale from [0,255] to [0,1]\n    num = num / 255.0;\n\n    if (num < 0.) {\n      return 0.;\n    }\n    if (num > 1.) {\n      return 1.;\n    }\n    return num;\n  }\n\n  updateInput() {\n    this.inputx.valueAsNumber = Math.round(this.model.value[0] * 255.);\n    this.inputy.valueAsNumber = Math.round(this.model.value[1] * 255.);\n    this.inputz.valueAsNumber = Math.round(this.model.value[2] * 255.);\n  }\n}\n\n\nregisterLayerType('line', VectorGraphicsUserLayer);\n// registerLayerType('point', VectorGraphicsUserLayer);\n","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport debounce from 'lodash/debounce';\nimport {CapacitySpecification, ChunkManager, ChunkQueueManager, FrameNumberCounter} from 'neuroglancer/chunk_manager/frontend';\nimport {defaultCredentialsManager} from 'neuroglancer/credentials_provider/default_manager';\nimport {InputEventBindings as DataPanelInputEventBindings} from 'neuroglancer/data_panel_layout';\nimport {DataSourceProvider} from 'neuroglancer/datasource';\nimport {getDefaultDataSourceProvider} from 'neuroglancer/datasource/default_provider';\nimport {DisplayContext} from 'neuroglancer/display_context';\nimport {InputEventBindingHelpDialog} from 'neuroglancer/help/input_event_bindings';\nimport {allRenderLayerRoles, LayerManager, LayerSelectedValues, MouseSelectionState, RenderLayerRole, SelectedLayerState} from 'neuroglancer/layer';\nimport {LayerDialog} from 'neuroglancer/layer_dialog';\nimport {RootLayoutContainer} from 'neuroglancer/layer_groups_layout';\nimport {TopLevelLayerListSpecification} from 'neuroglancer/layer_specification';\nimport {NavigationState, Pose} from 'neuroglancer/navigation_state';\nimport {overlaysOpen} from 'neuroglancer/overlay';\nimport {StatusMessage} from 'neuroglancer/status';\nimport {ElementVisibilityFromTrackableBoolean, TrackableBoolean, TrackableBooleanCheckbox} from 'neuroglancer/trackable_boolean';\nimport {makeDerivedWatchableValue, TrackableValue, WatchableValueInterface} from 'neuroglancer/trackable_value';\nimport {ContextMenu} from 'neuroglancer/ui/context_menu';\nimport {DragResizablePanel} from 'neuroglancer/ui/drag_resize';\nimport {LayerInfoPanelContainer} from 'neuroglancer/ui/layer_side_panel';\nimport {MouseSelectionStateTooltipManager} from 'neuroglancer/ui/mouse_selection_state_tooltip';\nimport {setupPositionDropHandlers} from 'neuroglancer/ui/position_drag_and_drop';\nimport {StateEditorDialog} from 'neuroglancer/ui/state_editor';\nimport {StatisticsDisplayState, StatisticsPanel} from 'neuroglancer/ui/statistics';\nimport {AutomaticallyFocusedElement} from 'neuroglancer/util/automatic_focus';\nimport {TrackableRGB} from 'neuroglancer/util/color';\nimport {Borrowed, Owned, RefCounted} from 'neuroglancer/util/disposable';\nimport {removeFromParent} from 'neuroglancer/util/dom';\nimport {registerActionListener} from 'neuroglancer/util/event_action_map';\nimport {vec3} from 'neuroglancer/util/geom';\nimport {EventActionMap, KeyboardEventBinder} from 'neuroglancer/util/keyboard_bindings';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {CompoundTrackable} from 'neuroglancer/util/trackable';\nimport {ViewerState, VisibilityPrioritySpecification} from 'neuroglancer/viewer_state';\nimport {WatchableVisibilityPriority} from 'neuroglancer/visibility_priority/frontend';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {AnnotationToolStatusWidget} from 'neuroglancer/widget/annotation_tool_status';\nimport {NumberInputWidget} from 'neuroglancer/widget/number_input_widget';\nimport {MousePositionWidget, PositionWidget, VoxelSizeWidget} from 'neuroglancer/widget/position_widget';\nimport {TrackableScaleBarOptions} from 'neuroglancer/widget/scale_bar';\nimport {makeTextIconButton} from 'neuroglancer/widget/text_icon_button';\nimport {RPC} from 'neuroglancer/worker_rpc';\n\ndeclare var NEUROGLANCER_OVERRIDE_DEFAULT_VIEWER_OPTIONS: any\n\nimport './viewer.css';\nimport 'neuroglancer/noselect.css';\nimport 'neuroglancer/ui/button.css';\n\n\nexport class DataManagementContext extends RefCounted {\n  worker: Worker;\n  chunkQueueManager: ChunkQueueManager;\n  chunkManager: ChunkManager;\n\n  get rpc(): RPC {\n    return this.chunkQueueManager.rpc!;\n  }\n\n  constructor(public gl: GL, public frameNumberCounter: FrameNumberCounter, bundleRoot: string = '') {\n    super();\n    const chunk_worker_url = bundleRoot + 'chunk_worker.bundle.js';\n    this.worker = new Worker(chunk_worker_url);\n    this.chunkQueueManager = this.registerDisposer(\n      new ChunkQueueManager(new RPC(this.worker), this.gl, this.frameNumberCounter, {\n        gpuMemory: new CapacitySpecification({defaultItemLimit: 1e6, defaultSizeLimit: 1e9}),\n        systemMemory: new CapacitySpecification({defaultItemLimit: 1e7, defaultSizeLimit: 2e9}),\n        download: new CapacitySpecification(\n            {defaultItemLimit: 32, defaultSizeLimit: Number.POSITIVE_INFINITY}),\n        compute: new CapacitySpecification({defaultItemLimit: 128, defaultSizeLimit: 5e8}),\n      }));\n    this.chunkQueueManager.registerDisposer(() => this.worker.terminate());\n    this.chunkManager = this.registerDisposer(new ChunkManager(this.chunkQueueManager));\n  }\n}\n\nexport class InputEventBindings extends DataPanelInputEventBindings {\n  global = new EventActionMap();\n}\n\nconst viewerUiControlOptionKeys: (keyof ViewerUIControlConfiguration)[] = [\n  'showHelpButton',\n  'showEditStateButton',\n  'showLayerPanel',\n  'showLocation',\n  'showAnnotationToolStatus',\n];\n\nconst viewerOptionKeys: (keyof ViewerUIOptions)[] =\n    ['showUIControls', 'showPanelBorders', ...viewerUiControlOptionKeys];\n\nexport class ViewerUIControlConfiguration {\n  showHelpButton = new TrackableBoolean(true);\n  showEditStateButton = new TrackableBoolean(true);\n  showLayerPanel = new TrackableBoolean(true);\n  showLocation = new TrackableBoolean(true);\n  showAnnotationToolStatus = new TrackableBoolean(true);\n}\n\nexport class ViewerUIConfiguration extends ViewerUIControlConfiguration {\n  /**\n   * If set to false, all UI controls (controlled individually by the options below) are disabled.\n   */\n  showUIControls = new TrackableBoolean(true);\n  showPanelBorders = new TrackableBoolean(true);\n}\n\nfunction setViewerUiConfiguration(\n    config: ViewerUIConfiguration, options: Partial<ViewerUIOptions>) {\n  for (const key of viewerOptionKeys) {\n    const value = options[key];\n    if (value !== undefined) {\n      config[key].value = value;\n    }\n  }\n}\n\ninterface ViewerUIOptions {\n  showUIControls: boolean;\n  showHelpButton: boolean;\n  showEditStateButton: boolean;\n  showLayerPanel: boolean;\n  showLocation: boolean;\n  showPanelBorders: boolean;\n  showAnnotationToolStatus: boolean;\n}\n\nexport interface ViewerOptions extends ViewerUIOptions, VisibilityPrioritySpecification {\n  dataContext: Owned<DataManagementContext>;\n  element: HTMLElement;\n  dataSourceProvider: Borrowed<DataSourceProvider>;\n  uiConfiguration: ViewerUIConfiguration;\n  showLayerDialog: boolean;\n  inputEventBindings: InputEventBindings;\n  resetStateWhenEmpty: boolean;\n  bundleRoot: string;\n}\n\nconst defaultViewerOptions = \"undefined\" !== typeof NEUROGLANCER_OVERRIDE_DEFAULT_VIEWER_OPTIONS ?\n  NEUROGLANCER_OVERRIDE_DEFAULT_VIEWER_OPTIONS : {\n    showLayerDialog: true,\n    resetStateWhenEmpty: true,\n  };\n\nfunction makeViewerContextMenu(viewer: Viewer) {\n  const menu = new ContextMenu();\n  const {element} = menu;\n  element.classList.add('neuroglancer-viewer-context-menu');\n  const addLimitWidget = (label: string, limit: TrackableValue<number>) => {\n    const widget = menu.registerDisposer(new NumberInputWidget(limit, {label}));\n    widget.element.classList.add('neuroglancer-viewer-context-menu-limit-widget');\n    element.appendChild(widget.element);\n  };\n  addLimitWidget('GPU memory limit', viewer.chunkQueueManager.capacities.gpuMemory.sizeLimit);\n  addLimitWidget('System memory limit', viewer.chunkQueueManager.capacities.systemMemory.sizeLimit);\n  addLimitWidget(\n      'Concurrent chunk requests', viewer.chunkQueueManager.capacities.download.itemLimit);\n\n  const addCheckbox = (label: string, value: TrackableBoolean) => {\n    const labelElement = document.createElement('label');\n    labelElement.textContent = label;\n    const checkbox = menu.registerDisposer(new TrackableBooleanCheckbox(value));\n    labelElement.appendChild(checkbox.element);\n    element.appendChild(labelElement);\n  };\n  addCheckbox('Show axis lines', viewer.showAxisLines);\n  addCheckbox('Show scale bar', viewer.showScaleBar);\n  addCheckbox('Show cross sections in 3-d', viewer.showPerspectiveSliceViews);\n  addCheckbox('Show default annotations', viewer.showDefaultAnnotations);\n  addCheckbox('Show chunk statistics', viewer.statisticsDisplayState.visible);\n  return menu;\n}\n\nexport class Viewer extends RefCounted implements ViewerState {\n  navigationState = this.registerDisposer(new NavigationState());\n  perspectiveNavigationState = new NavigationState(new Pose(this.navigationState.position), 1);\n  mouseState = new MouseSelectionState();\n  layerManager = this.registerDisposer(new LayerManager());\n  selectedLayer = this.registerDisposer(new SelectedLayerState(this.layerManager.addRef()));\n  showAxisLines = new TrackableBoolean(true, true);\n  showScaleBar = new TrackableBoolean(true, true);\n  showPerspectiveSliceViews = new TrackableBoolean(true, true);\n  visibleLayerRoles = allRenderLayerRoles();\n  showDefaultAnnotations = new TrackableBoolean(true, true);\n  crossSectionBackgroundColor = new TrackableRGB(vec3.fromValues(0.5, 0.5, 0.5));\n  perspectiveViewBackgroundColor = new TrackableRGB(vec3.fromValues(0, 0, 0));\n  scaleBarOptions = new TrackableScaleBarOptions();\n  contextMenu: ContextMenu;\n  statisticsDisplayState = new StatisticsDisplayState();\n\n  layerSelectedValues =\n      this.registerDisposer(new LayerSelectedValues(this.layerManager, this.mouseState));\n  resetInitiated = new NullarySignal();\n\n  get chunkManager() {\n    return this.dataContext.chunkManager;\n  }\n  get chunkQueueManager() {\n    return this.dataContext.chunkQueueManager;\n  }\n\n  layerSpecification: TopLevelLayerListSpecification;\n  layout: RootLayoutContainer;\n\n  state = new CompoundTrackable();\n\n  dataContext: Owned<DataManagementContext>;\n  visibility: WatchableVisibilityPriority;\n  inputEventBindings: InputEventBindings;\n  element: HTMLElement;\n  dataSourceProvider: Borrowed<DataSourceProvider>;\n\n  uiConfiguration: ViewerUIConfiguration;\n\n  private makeUiControlVisibilityState(key: keyof ViewerUIOptions) {\n    const showUIControls = this.uiConfiguration.showUIControls;\n    const option = this.uiConfiguration[key];\n    return this.registerDisposer(\n        makeDerivedWatchableValue((a, b) => a && b, showUIControls, option));\n  }\n\n  /**\n   * Logical and of each of the above values with the value of showUIControls.\n   */\n  uiControlVisibility:\n      {[key in keyof ViewerUIControlConfiguration]: WatchableValueInterface<boolean>} = <any>{};\n\n  showLayerDialog: boolean;\n  resetStateWhenEmpty: boolean;\n\n  get inputEventMap() {\n    return this.inputEventBindings.global;\n  }\n\n  visible = true;\n\n  constructor(public display: DisplayContext, options: Partial<ViewerOptions> = {}) {\n    super();\n\n    const {\n      dataContext = new DataManagementContext(display.gl, display, options.bundleRoot),\n      visibility = new WatchableVisibilityPriority(WatchableVisibilityPriority.VISIBLE),\n      inputEventBindings = {\n        global: new EventActionMap(),\n        sliceView: new EventActionMap(),\n        perspectiveView: new EventActionMap(),\n      },\n      element = display.makeCanvasOverlayElement(),\n      dataSourceProvider =\n          getDefaultDataSourceProvider({credentialsManager: defaultCredentialsManager}),\n      uiConfiguration = new ViewerUIConfiguration(),\n    } = options;\n    this.visibility = visibility;\n    this.inputEventBindings = inputEventBindings;\n    this.element = element;\n    this.dataSourceProvider = dataSourceProvider;\n    this.uiConfiguration = uiConfiguration;\n\n    this.registerDisposer(() => removeFromParent(this.element));\n\n    this.dataContext = this.registerDisposer(dataContext);\n\n    setViewerUiConfiguration(uiConfiguration, options);\n\n    const optionsWithDefaults = {...defaultViewerOptions, ...options};\n    const {\n      resetStateWhenEmpty,\n      showLayerDialog,\n    } = optionsWithDefaults;\n\n    for (const key of viewerUiControlOptionKeys) {\n      this.uiControlVisibility[key] = this.makeUiControlVisibilityState(key);\n    }\n    this.registerDisposer(this.uiConfiguration.showPanelBorders.changed.add(() => {\n      this.updateShowBorders();\n    }));\n\n    this.showLayerDialog = showLayerDialog;\n    this.resetStateWhenEmpty = resetStateWhenEmpty;\n\n    this.layerSpecification = new TopLevelLayerListSpecification(\n        this.dataSourceProvider, this.layerManager, this.chunkManager, this.layerSelectedValues,\n        this.navigationState.voxelSize);\n\n    this.registerDisposer(display.updateStarted.add(() => {\n      this.onUpdateDisplay();\n    }));\n\n    this.showDefaultAnnotations.changed.add(() => {\n      if (this.showDefaultAnnotations.value) {\n        this.visibleLayerRoles.add(RenderLayerRole.DEFAULT_ANNOTATION);\n      } else {\n        this.visibleLayerRoles.delete(RenderLayerRole.DEFAULT_ANNOTATION);\n      }\n    });\n\n    const {state} = this;\n    state.add('layers', this.layerSpecification);\n    state.add('navigation', this.navigationState);\n    state.add('showAxisLines', this.showAxisLines);\n    state.add('showScaleBar', this.showScaleBar);\n    state.add('showDefaultAnnotations', this.showDefaultAnnotations);\n\n    state.add('perspectiveOrientation', this.perspectiveNavigationState.pose.orientation);\n    state.add('perspectiveZoom', this.perspectiveNavigationState.zoomFactor);\n    state.add('showSlices', this.showPerspectiveSliceViews);\n    state.add('gpuMemoryLimit', this.dataContext.chunkQueueManager.capacities.gpuMemory.sizeLimit);\n    state.add(\n        'systemMemoryLimit', this.dataContext.chunkQueueManager.capacities.systemMemory.sizeLimit);\n    state.add(\n        'concurrentDownloads', this.dataContext.chunkQueueManager.capacities.download.itemLimit);\n    state.add('selectedLayer', this.selectedLayer);\n    state.add('crossSectionBackgroundColor', this.crossSectionBackgroundColor);\n    state.add('perspectiveViewBackgroundColor', this.perspectiveViewBackgroundColor);\n\n    this.registerDisposer(this.navigationState.changed.add(() => {\n      this.handleNavigationStateChanged();\n    }));\n\n    this.layerManager.initializePosition(this.navigationState.position);\n\n    this.registerDisposer(\n        this.layerSpecification.voxelCoordinatesSet.add((voxelCoordinates: vec3) => {\n          this.navigationState.position.setVoxelCoordinates(voxelCoordinates);\n        }));\n\n    this.registerDisposer(\n        this.layerSpecification.spatialCoordinatesSet.add((spatialCoordinates: vec3) => {\n          const {position} = this.navigationState;\n          vec3.copy(position.spatialCoordinates, spatialCoordinates);\n          position.markSpatialCoordinatesChanged();\n        }));\n\n\n    // Debounce this call to ensure that a transient state does not result in the layer dialog being\n    // shown.\n    const maybeResetState = this.registerCancellable(debounce(() => {\n      if (!this.wasDisposed && this.layerManager.managedLayers.length === 0 &&\n          this.resetStateWhenEmpty) {\n        // No layers, reset state.\n        this.navigationState.reset();\n        this.perspectiveNavigationState.pose.orientation.reset();\n        this.perspectiveNavigationState.zoomFactor.reset();\n        this.resetInitiated.dispatch();\n        if (!overlaysOpen && this.showLayerDialog && this.visibility.visible) {\n          new LayerDialog(this.layerSpecification);\n        }\n      }\n    }));\n    this.layerManager.layersChanged.add(maybeResetState);\n    maybeResetState();\n\n    this.registerDisposer(this.dataContext.chunkQueueManager.visibleChunksChanged.add(() => {\n      this.layerSelectedValues.handleLayerChange();\n    }));\n\n    this.registerDisposer(this.dataContext.chunkQueueManager.visibleChunksChanged.add(() => {\n      if (this.visible) {\n        display.scheduleRedraw();\n      }\n    }));\n\n    this.makeUI();\n    this.updateShowBorders();\n\n    state.add('layout', this.layout);\n\n\n    state.add('statistics', this.statisticsDisplayState);\n\n    this.registerActionListeners();\n    this.registerEventActionBindings();\n\n    this.registerDisposer(setupPositionDropHandlers(element, this.navigationState.position));\n\n    this.registerDisposer(new MouseSelectionStateTooltipManager(\n        this.mouseState, this.layerManager, this.navigationState.voxelSize));\n  }\n\n  private updateShowBorders() {\n    const {element} = this;\n    const className = 'neuroglancer-show-panel-borders';\n    if (this.uiConfiguration.showPanelBorders.value) {\n      element.classList.add(className);\n    } else {\n      element.classList.remove(className);\n    }\n  }\n\n  private makeUI() {\n    const gridContainer = this.element;\n    gridContainer.classList.add('neuroglancer-viewer');\n    gridContainer.classList.add('neuroglancer-noselect');\n    gridContainer.style.display = 'flex';\n    gridContainer.style.flexDirection = 'column';\n\n    const topRow = document.createElement('div');\n    topRow.title = 'Right click for settings';\n    topRow.classList.add('neuroglancer-viewer-top-row');\n    const contextMenu = this.contextMenu = this.registerDisposer(makeViewerContextMenu(this));\n    contextMenu.registerParent(topRow);\n    topRow.style.display = 'flex';\n    topRow.style.flexDirection = 'row';\n    topRow.style.alignItems = 'stretch';\n\n    const voxelSizeWidget = this.registerDisposer(\n        new VoxelSizeWidget(document.createElement('div'), this.navigationState.voxelSize));\n    this.registerDisposer(new ElementVisibilityFromTrackableBoolean(\n        this.uiControlVisibility.showLocation, voxelSizeWidget.element));\n    topRow.appendChild(voxelSizeWidget.element);\n\n    const positionWidget = this.registerDisposer(new PositionWidget(this.navigationState.position));\n    this.registerDisposer(new ElementVisibilityFromTrackableBoolean(\n        this.uiControlVisibility.showLocation, positionWidget.element));\n    topRow.appendChild(positionWidget.element);\n\n    const mousePositionWidget = this.registerDisposer(new MousePositionWidget(\n        document.createElement('div'), this.mouseState, this.navigationState.voxelSize));\n    mousePositionWidget.element.style.flex = '1';\n    mousePositionWidget.element.style.alignSelf = 'center';\n    this.registerDisposer(new ElementVisibilityFromTrackableBoolean(\n        this.uiControlVisibility.showLocation, mousePositionWidget.element));\n    topRow.appendChild(mousePositionWidget.element);\n\n    const annotationToolStatus =\n        this.registerDisposer(new AnnotationToolStatusWidget(this.selectedLayer));\n    topRow.appendChild(annotationToolStatus.element);\n    this.registerDisposer(new ElementVisibilityFromTrackableBoolean(\n        this.uiControlVisibility.showAnnotationToolStatus, annotationToolStatus.element));\n\n    {\n      const button = makeTextIconButton('{}', 'Edit JSON state');\n      this.registerEventListener(button, 'click', () => {\n        this.editJsonState();\n      });\n      this.registerDisposer(new ElementVisibilityFromTrackableBoolean(\n          this.uiControlVisibility.showEditStateButton, button));\n      topRow.appendChild(button);\n    }\n\n\n    {\n      const button = makeTextIconButton('?', 'Help');\n      this.registerEventListener(button, 'click', () => {\n        this.showHelpDialog();\n      });\n      this.registerDisposer(new ElementVisibilityFromTrackableBoolean(\n          this.uiControlVisibility.showHelpButton, button));\n      topRow.appendChild(button);\n    }\n\n    this.registerDisposer(new ElementVisibilityFromTrackableBoolean(\n        makeDerivedWatchableValue(\n            (...values: boolean[]) => values.reduce((a, b) => a || b, false),\n            this.uiControlVisibility.showHelpButton, this.uiControlVisibility.showEditStateButton,\n            this.uiControlVisibility.showLocation,\n            this.uiControlVisibility.showAnnotationToolStatus),\n        topRow));\n\n    gridContainer.appendChild(topRow);\n\n    const layoutAndSidePanel = document.createElement('div');\n    layoutAndSidePanel.style.display = 'flex';\n    layoutAndSidePanel.style.flex = '1';\n    layoutAndSidePanel.style.flexDirection = 'row';\n    this.layout = this.registerDisposer(new RootLayoutContainer(this, '4panel'));\n    layoutAndSidePanel.appendChild(this.layout.element);\n    const layerInfoPanel =\n        this.registerDisposer(new LayerInfoPanelContainer(this.selectedLayer.addRef()));\n    layoutAndSidePanel.appendChild(layerInfoPanel.element);\n    const self = this;\n    layerInfoPanel.registerDisposer(new DragResizablePanel(\n        layerInfoPanel.element, {\n          changed: self.selectedLayer.changed,\n          get value() {\n            return self.selectedLayer.visible;\n          },\n          set value(visible: boolean) {\n            self.selectedLayer.visible = visible;\n          }\n        },\n        this.selectedLayer.size, 'horizontal', 290));\n\n    gridContainer.appendChild(layoutAndSidePanel);\n\n    const statisticsPanel = this.registerDisposer(\n        new StatisticsPanel(this.chunkQueueManager, this.statisticsDisplayState));\n    gridContainer.appendChild(statisticsPanel.element);\n    statisticsPanel.registerDisposer(new DragResizablePanel(\n        statisticsPanel.element, this.statisticsDisplayState.visible,\n        this.statisticsDisplayState.size, 'vertical'));\n\n    const updateVisibility = () => {\n      const shouldBeVisible = this.visibility.visible;\n      if (shouldBeVisible !== this.visible) {\n        gridContainer.style.visibility = shouldBeVisible ? 'inherit' : 'hidden';\n        this.visible = shouldBeVisible;\n      }\n    };\n    updateVisibility();\n    this.registerDisposer(this.visibility.changed.add(updateVisibility));\n  }\n\n  /**\n   * Called once by the constructor to set up event handlers.\n   */\n  private registerEventActionBindings() {\n    const {element} = this;\n    this.registerDisposer(new KeyboardEventBinder(element, this.inputEventMap));\n    this.registerDisposer(new AutomaticallyFocusedElement(element));\n  }\n\n  bindAction(action: string, handler: () => void) {\n    this.registerDisposer(registerActionListener(this.element, action, handler));\n  }\n\n  /**\n   * Called once by the constructor to register the action listeners.\n   */\n  private registerActionListeners() {\n    for (const action of ['recolor', 'clear-segments', ]) {\n      this.bindAction(action, () => {\n        this.layerManager.invokeAction(action);\n      });\n    }\n\n    for (const action of ['select']) {\n      this.bindAction(action, () => {\n        this.mouseState.updateUnconditionally();\n        this.layerManager.invokeAction(action);\n      });\n    }\n\n    this.bindAction('help', () => this.showHelpDialog());\n\n    for (let i = 1; i <= 9; ++i) {\n      this.bindAction(`toggle-layer-${i}`, () => {\n        const layerIndex = i - 1;\n        const layers = this.layerManager.managedLayers;\n        if (layerIndex < layers.length) {\n          let layer = layers[layerIndex];\n          layer.setVisible(!layer.visible);\n        }\n      });\n      this.bindAction(`select-layer-${i}`, () => {\n        const layerIndex = i - 1;\n        const layers = this.layerManager.managedLayers;\n        if (layerIndex < layers.length) {\n          const layer = layers[layerIndex];\n          this.selectedLayer.layer = layer;\n          this.selectedLayer.visible = true;\n        }\n      });\n    }\n\n    this.bindAction('annotate', () => {\n      const selectedLayer = this.selectedLayer.layer;\n      if (selectedLayer === undefined) {\n        StatusMessage.showTemporaryMessage('The annotate command requires a layer to be selected.');\n        return;\n      }\n      const userLayer = selectedLayer.layer;\n      if (userLayer === null || userLayer.tool.value === undefined) {\n        StatusMessage.showTemporaryMessage(`The selected layer (${\n            JSON.stringify(selectedLayer.name)}) does not have an active annotation tool.`);\n        return;\n      }\n      userLayer.tool.value.trigger(this.mouseState);\n    });\n\n    this.bindAction('toggle-axis-lines', () => this.showAxisLines.toggle());\n    this.bindAction('toggle-scale-bar', () => this.showScaleBar.toggle());\n    this.bindAction('toggle-default-annotations', () => this.showDefaultAnnotations.toggle());\n    this.bindAction('toggle-show-slices', () => this.showPerspectiveSliceViews.toggle());\n    this.bindAction('toggle-show-statistics', () => this.showStatistics());\n  }\n\n  showHelpDialog() {\n    const {inputEventBindings} = this;\n    new InputEventBindingHelpDialog([\n      ['Global', inputEventBindings.global],\n      ['Slice View', inputEventBindings.sliceView],\n      ['Perspective View', inputEventBindings.perspectiveView],\n    ]);\n  }\n\n  editJsonState() {\n    new StateEditorDialog(this);\n  }\n\n  showStatistics(value: boolean|undefined = undefined) {\n    if (value === undefined) {\n      value = !this.statisticsDisplayState.visible.value;\n    }\n    this.statisticsDisplayState.visible.value = value;\n  }\n\n  get gl() {\n    return this.display.gl;\n  }\n\n  onUpdateDisplay() {\n    if (this.visible) {\n      this.dataContext.chunkQueueManager.chunkUpdateDeadline = null;\n    }\n  }\n\n  private handleNavigationStateChanged() {\n    if (this.visible) {\n      let {chunkQueueManager} = this.dataContext;\n      if (chunkQueueManager.chunkUpdateDeadline === null) {\n        chunkQueueManager.chunkUpdateDeadline = Date.now() + 10;\n      }\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {SharedWatchableValue} from 'neuroglancer/shared_watchable_value';\nimport {WatchableValue} from 'neuroglancer/trackable_value';\nimport {RPC} from 'neuroglancer/worker_rpc';\nimport {SharedObject} from 'neuroglancer/worker_rpc';\n\n/**\n * Numeric value specifying a visibility or prefetch priority.\n *\n * A value of `Number.POSITIVE_INFINITY` means visible.\n *\n * Any other finite value means not visible, and specifies the prefetch priority (higher means\n * higher priority); this should always be a small integer.\n *\n * A value of `Number.NEGATIVE_INFINITY` means ignored (not visible, and not prefetched).\n */\nexport type VisibilityPriority = number;\n\nexport class WatchableVisibilityPriority extends WatchableValue<VisibilityPriority> {\n  constructor(value = Number.NEGATIVE_INFINITY) {\n    super(value);\n  }\n\n  static VISIBLE = Number.POSITIVE_INFINITY;\n  static IGNORED = Number.NEGATIVE_INFINITY;\n  get visible() {\n    return this.value === Number.POSITIVE_INFINITY;\n  }\n\n  get ignored() {\n    return this.value === Number.NEGATIVE_INFINITY;\n  }\n}\n\nexport interface VisibilityPrioritySpecification { visibility: WatchableVisibilityPriority; }\n\n/**\n * Maintains the maximum value of multiple WatchableVisibilityPriority values.\n */\nexport class VisibilityPriorityAggregator extends WatchableVisibilityPriority {\n  private contributors = new Map<() => void, WatchableVisibilityPriority>();\n\n  /**\n   * Registers `x` to be included in the set of values to be aggregated.\n   *\n   * @returns A disposer function that unregisters the specified value.\n   */\n  add(x: WatchableVisibilityPriority) {\n    const {contributors} = this;\n    const changedDisposer = x.changed.add(() => {\n      this.update();\n    });\n    const disposer = () => {\n      contributors.delete(disposer);\n      changedDisposer();\n      this.update();\n    };\n    contributors.set(disposer, x);\n    this.update();\n    return disposer;\n  }\n\n  private update() {\n    let priority = Number.NEGATIVE_INFINITY;\n    for (const x of this.contributors.values()) {\n      priority = Math.max(priority, x.value);\n    }\n    this.value = priority;\n  }\n}\n\n/**\n * Mixin that adds a `visibility` property which is shared with the counterpart.\n */\nexport function withSharedVisibility<T extends{new (...args: any[]): SharedObject}>(Base: T) {\n  return class extends Base {\n    visibility = new VisibilityPriorityAggregator();\n\n    initializeCounterpart(rpc: RPC, options: any = {}) {\n      // Backend doesn't need to own a reference to SharedWatchableValue because frontend, which is\n      // the owner of this SharedObject, owns a reference.\n      options['visibility'] =\n          this.registerDisposer(SharedWatchableValue.makeFromExisting(rpc, this.visibility)).rpcId;\n      super.initializeCounterpart(rpc, options);\n    }\n  };\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Disposable, RefCountedValue} from 'neuroglancer/util/disposable';\nimport {stableStringify} from 'neuroglancer/util/json';\nimport {getObjectId} from 'neuroglancer/util/object_id';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {AttributeIndex} from 'neuroglancer/webgl/shader';\n\nexport type BufferType = number;\nexport type WebGLDataType = number;\nexport type WebGLBufferUsage = number;\nexport class Buffer implements Disposable {\n  buffer: WebGLBuffer|null;\n  constructor(\n      public gl: WebGL2RenderingContext,\n      public bufferType: BufferType = WebGL2RenderingContext.ARRAY_BUFFER) {\n    this.gl = gl;\n    // This should never return null.\n    this.buffer = gl.createBuffer();\n  }\n\n  bind() {\n    this.gl.bindBuffer(this.bufferType, this.buffer);\n  }\n\n  bindToVertexAttrib(\n      location: AttributeIndex, componentsPerVertexAttribute: number,\n      attributeType: WebGLDataType = WebGL2RenderingContext.FLOAT, normalized = false, stride = 0,\n      offset = 0) {\n    this.bind();\n    this.gl.enableVertexAttribArray(location);\n    this.gl.vertexAttribPointer(\n        location, componentsPerVertexAttribute, attributeType, normalized, stride, offset);\n  }\n\n  bindToVertexAttribI(\n      location: AttributeIndex, componentsPerVertexAttribute: number,\n      attributeType: WebGLDataType = WebGL2RenderingContext.UNSIGNED_INT, stride = 0, offset = 0) {\n    this.bind();\n    this.gl.enableVertexAttribArray(location);\n    this.gl.vertexAttribIPointer(\n        location, componentsPerVertexAttribute, attributeType, stride, offset);\n  }\n\n  setData(data: ArrayBufferView, usage: WebGLBufferUsage = WebGL2RenderingContext.STATIC_DRAW) {\n    let gl = this.gl;\n    this.bind();\n    gl.bufferData(this.bufferType, data, usage);\n  }\n\n  dispose() {\n    this.gl.deleteBuffer(this.buffer);\n    this.buffer = <any>undefined;\n    this.gl = <any>undefined;\n  }\n\n  static fromData(\n      gl: WebGL2RenderingContext, data: ArrayBufferView, bufferType?: BufferType,\n      usage?: WebGLBufferUsage) {\n    let buffer = new Buffer(gl, bufferType);\n    buffer.setData(data, usage);\n    return buffer;\n  }\n}\n\nexport function getMemoizedBuffer(\n    gl: GL, bufferType: number, getter: (...args: any[]) => ArrayBufferView, ...args: any[]) {\n  return gl.memoize.get(\n      stableStringify({id: 'getMemoizedBuffer', getter: getObjectId(getter), args}), () => {\n        const result = new RefCountedValue(\n            Buffer.fromData(gl, getter(...args), bufferType, WebGL2RenderingContext.STATIC_DRAW));\n        result.registerDisposer(result.value);\n        return result;\n      });\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Facilities for drawing circles in WebGL as quads (triangle fan).\n */\n\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {Buffer} from 'neuroglancer/webgl/buffer';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {QuadRenderHelper} from 'neuroglancer/webgl/quad';\nimport {ShaderBuilder, ShaderProgram} from 'neuroglancer/webgl/shader';\nimport {getSquareCornersBuffer} from 'neuroglancer/webgl/square_corners_buffer';\n\nexport const VERTICES_PER_CIRCLE = 4;\n\nexport class CircleShader extends RefCounted {\n  private squareCornersBuffer: Buffer;\n  private quadHelper: QuadRenderHelper;\n\n  constructor(gl: GL, public circlesPerInstance: number = 1) {\n    super();\n    this.squareCornersBuffer = getSquareCornersBuffer(\n        gl, -1, -1, 1, 1, /*minorTiles=*/circlesPerInstance, /*majorTiles=*/1);\n    this.quadHelper = this.registerDisposer(new QuadRenderHelper(gl, circlesPerInstance));\n  }\n\n  defineShader(builder: ShaderBuilder, crossSectionFade: boolean) {\n    // XY corners of square ranging from [-1, -1] to [1, 1].\n    builder.addAttribute('highp vec2', 'aCircleCornerOffset');\n\n    // x and y components: The x and y radii of the point in normalized device coordinates.\n    // z component: Starting point of border from [0, 1]..\n    // w component: Fraction of total radius that is feathered.\n    builder.addUniform('highp vec4', 'uCircleParams');\n\n    // 2-D position within circle quad, ranging from [-1, -1] to [1, 1].\n    builder.addVarying('highp vec2', 'vCircleCoord');\n    builder.addVertexCode(`\nvoid emitCircle(vec4 position) {\n  gl_Position = position;\n  gl_Position.xy += aCircleCornerOffset * uCircleParams.xy * gl_Position.w;\n  vCircleCoord = aCircleCornerOffset;\n}\n`);\n    if (crossSectionFade) {\n      builder.addFragmentCode(`\nfloat getCircleAlphaMultiplier() {\n  return 1.0 - 2.0 * abs(0.5 - gl_FragCoord.z);\n}\n`);\n    } else {\n      builder.addFragmentCode(`\nfloat getCircleAlphaMultiplier() {\n  return 1.0;\n}\n`);\n    }\n    builder.addFragmentCode(`\nvec4 getCircleColor(vec4 interiorColor, vec4 borderColor) {\n  float radius = length(vCircleCoord);\n  if (radius > 1.0) {\n    discard;\n  }\n\n  float borderColorFraction = clamp((radius - uCircleParams.z) / uCircleParams.w, 0.0, 1.0);\n  float feather = clamp((1.0 - radius) / uCircleParams.w, 0.0, 1.0);\n  vec4 color = mix(interiorColor, borderColor, borderColorFraction);\n\n  return vec4(color.rgb, color.a * feather * getCircleAlphaMultiplier());\n}\n`);\n  }\n\n  draw(\n      shader: ShaderProgram, renderContext: {viewportWidth: number, viewportHeight: number},\n      options: {\n        interiorRadiusInPixels: number,\n        borderWidthInPixels: number,\n        featherWidthInPixels: number\n      },\n      count: number) {\n    const {gl} = shader;\n    const aCircleCornerOffset = shader.attribute('aCircleCornerOffset');\n    this.squareCornersBuffer.bindToVertexAttrib(aCircleCornerOffset, /*components=*/2);\n    const totalRadius =\n        options.interiorRadiusInPixels + options.borderWidthInPixels + options.featherWidthInPixels;\n    gl.uniform4f(\n        shader.uniform('uCircleParams'), totalRadius / renderContext.viewportWidth,\n        totalRadius / renderContext.viewportHeight, options.interiorRadiusInPixels / totalRadius,\n        options.featherWidthInPixels === 0 ? 1e-6 : options.featherWidthInPixels / totalRadius);\n    this.quadHelper.draw(gl, count);\n    shader.gl.disableVertexAttribArray(aCircleCornerOffset);\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nexport const glsl_COLORMAPS = (`vec3 colormapJet(float x) {\n  vec3 result;\n  result.r = x < 0.89 ? ((x - 0.35) / 0.31) : (1.0 - (x - 0.89) / 0.11 * 0.5);\n  result.g = x < 0.64 ? ((x - 0.125) * 4.0) : (1.0 - (x - 0.64) / 0.27);\n  result.b = x < 0.34 ? (0.5 + x * 0.5 / 0.11) : (1.0 - (x - 0.34) / 0.31);\n  return clamp(result, 0.0, 1.0);\n}\n` +\n/*\n * Adapted from http://www.mrao.cam.ac.uk/~dag/CUBEHELIX/CubeHelix.m\n * which is licensed under http://unlicense.org/\n */\n`vec3 colormapCubehelix(float x) {\n  float xclamp = clamp(x, 0.0, 1.0);\n  float angle = 2.0 * 3.1415926 * (4.0 / 3.0 + xclamp);\n  float amp = xclamp * (1.0 - xclamp) / 2.0;\n  vec3 result;\n  float cosangle = cos(angle);\n  float sinangle = sin(angle);\n  result.r = -0.14861 * cosangle + 1.78277 * sinangle;\n  result.g = -0.29227 * cosangle + -0.90649 * sinangle;\n  result.b = 1.97294 * cosangle;\n  result = clamp(xclamp + amp * result, 0.0, 1.0);\n  return result;\n}\n`);\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {Memoize} from 'neuroglancer/util/memoize';\n\nexport interface GL extends WebGL2RenderingContext {\n  memoize: Memoize<any, RefCounted>;\n  maxTextureSize: number;\n  maxTextureImageUnits: number;\n  tempTextureUnit: number;\n}\n\nexport const DEBUG_SHADERS = false;\n\nexport function initializeWebGL(canvas: HTMLCanvasElement) {\n  let options: any = {\n    'antialias': false,\n    'stencil': true,\n  };\n  if (DEBUG_SHADERS) {\n    console.log('DEBUGGING via preserveDrawingBuffer');\n    options['preserveDrawingBuffer'] = true;\n  }\n  let gl =\n      <GL>canvas.getContext('webgl2', options);\n  if (gl == null) {\n    throw new Error('WebGL not supported.');\n  }\n  gl.memoize = new Memoize<any, RefCounted>();\n  gl.maxTextureSize = gl.getParameter(gl.MAX_TEXTURE_SIZE);\n  gl.maxTextureImageUnits = gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS);\n  gl.tempTextureUnit = gl.maxTextureImageUnits - 1;\n\n  // FIXME: verify that we received a stencil buffer\n  // var contextAttributes = gl.getContextAttributes();\n  // var haveStencilBuffer = contextAttributes.stencil;\n\n  for (const extension of ['EXT_color_buffer_float']) {\n    if (!gl.getExtension(extension)) {\n      throw new Error(`${extension} extension not available`);\n    }\n  }\n\n  // Extensions to attempt to add but not fail if they are not available.\n  for (const extension of [\n           // Some versions of Firefox 67.0 seem to require this extension being added in addition\n           // to EXT_color_buffer_float, despite the note here indicating it is unnecessary:\n           // https://developer.mozilla.org/en-US/docs/Web/API/EXT_float_blend\n           //\n           // See https://github.com/google/neuroglancer/issues/140\n           'EXT_float_blend',\n  ]) {\n    gl.getExtension(extension);\n  }\n  return gl;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {WatchableValue, WatchableValueInterface} from 'neuroglancer/trackable_value';\nimport {TrackableValue} from 'neuroglancer/trackable_value';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {stableStringify, verifyString} from 'neuroglancer/util/json';\nimport {getObjectId} from 'neuroglancer/util/object_id';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {ShaderBuilder, ShaderCompilationError, ShaderLinkError, ShaderModule, ShaderProgram} from 'neuroglancer/webgl/shader';\n\n/**\n * undefined means shader has not been compiled.  null means shader was compiled successfully.\n */\nexport type WatchableShaderError =\n    WatchableValue<ShaderCompilationError|ShaderLinkError|undefined|null>;\n\nexport function makeWatchableShaderError() {\n  return new WatchableValue<ShaderCompilationError|ShaderLinkError|undefined|null>(undefined);\n}\n\nexport type TrackableFragmentMain = TrackableValue<string>;\n\nexport function makeTrackableFragmentMain(value: string) {\n  return new TrackableValue<string>(value, verifyString);\n}\n\nexport class ShaderGetter extends RefCounted {\n  shaderUpdated = true;\n  shader: ShaderProgram|undefined = undefined;\n\n  invalidateShader() {\n    this.shaderUpdated = true;\n  }\n  constructor(\n      public gl: GL, private defineShader: (builder: ShaderBuilder) => void,\n      private getShaderKey: () => string,\n      public shaderError: WatchableShaderError = makeWatchableShaderError()) {\n    super();\n    shaderError.value = undefined;\n  }\n\n  get(): ShaderProgram|undefined {\n    if (!this.shaderUpdated) {\n      return this.shader;\n    }\n    this.shaderUpdated = false;\n    try {\n      let newShader = this.getShader();\n      this.disposeShader();\n      this.shader = newShader;\n      this.shaderError.value = null;\n    } catch (shaderError) {\n      this.shaderError.value = shaderError;\n    }\n    return this.shader;\n  }\n\n  private getShader() {\n    let key = this.getShaderKey();\n    return this.gl.memoize.get(key, () => this.buildShader());\n  }\n\n  private buildShader() {\n    let builder = new ShaderBuilder(this.gl);\n    this.defineShader(builder);\n    return builder.build();\n  }\n  disposed() {\n    super.disposed();\n    this.disposeShader();\n  }\n  private disposeShader() {\n    if (this.shader) {\n      this.shader.dispose();\n      this.shader = undefined;\n    }\n  }\n}\n\nexport interface ParameterizedShaderGetterResult<Parameters> {\n  shader: ShaderProgram|null;\n  fallback: boolean;\n  parameters: Parameters;\n}\n\nexport interface ParameterizedContextDependentShaderGetter<Context, Parameters> {\n  (context: Context): ParameterizedShaderGetterResult<Parameters>;\n}\n\nexport function parameterizedContextDependentShaderGetter<Parameters, Context, ContextKey>(\n    refCounted: RefCounted, gl: GL, options: {\n      memoizeKey: any,\n      parameters: WatchableValueInterface<Parameters>,\n      getContextKey: (context: Context) => ContextKey,\n      shaderError: WatchableShaderError,\n      defineShader: (builder: ShaderBuilder, parameters: Parameters, context: Context) => void,\n      fallbackParameters?: WatchableValueInterface<Parameters>,\n      encodeContext?: (context: Context) => any,\n      encodeParameters?: (parameters: Parameters) => any,\n    }): ParameterizedContextDependentShaderGetter<Context, Parameters> {\n  const shaders = new Map<ContextKey, {\n    generation: number,\n    shader: ShaderProgram | null,\n    fallback: boolean,\n    parameters: Parameters\n  }>();\n  const {\n    parameters,\n    fallbackParameters,\n    shaderError,\n    encodeParameters = (p: Parameters) => p,\n    getContextKey,\n    defineShader\n  } = options;\n  const {encodeContext = getContextKey} = options;\n  const stringMemoizeKey = stableStringify(options.memoizeKey);\n  function getNewShader(parameters: Parameters, context: Context) {\n    const key = JSON.stringify({\n      id: stringMemoizeKey,\n      context: encodeContext(context),\n      parameters: encodeParameters(parameters)\n    });\n    return gl.memoize.get(key, () => {\n      const builder = new ShaderBuilder(gl);\n      defineShader(builder, parameters, context);\n      return builder.build();\n    });\n  }\n  function getter(context: Context) {\n    const contextKey = encodeContext(context);\n    let entry = shaders.get(contextKey);\n    if (entry === undefined) {\n      entry = {generation: -1, shader: null, fallback: false, parameters: parameters.value};\n      shaders.set(contextKey, entry);\n    }\n    const generation = parameters.changed.count;\n    if (generation === entry.generation) {\n      return entry;\n    }\n    const parametersValue = entry.parameters = parameters.value;\n    const oldShader = entry.shader;\n    entry.generation = generation;\n    let newShader: ShaderProgram|null = null;\n    try {\n      newShader = getNewShader(parametersValue, context);\n      entry.fallback = false;\n      if (fallbackParameters !== undefined) {\n        fallbackParameters.value = parametersValue;\n      }\n      shaderError.value = null;\n    } catch (e) {\n      shaderError.value = e;\n      if (fallbackParameters !== undefined) {\n        try {\n          const fallbackParametersValue = fallbackParameters.value;\n          newShader = getNewShader(fallbackParametersValue, context);\n          entry.parameters = fallbackParametersValue;\n          entry.fallback = true;\n        } catch {\n        }\n      }\n    }\n    if (oldShader !== null) {\n      oldShader.dispose();\n    }\n    entry.shader = newShader;\n    return entry;\n  }\n  refCounted.registerDisposer(() => {\n    for (const entry of shaders.values()) {\n      const {shader} = entry;\n      if (shader !== null) {\n        shader.dispose();\n      }\n    }\n  });\n  return getter;\n}\n\nexport function parameterizedEmitterDependentShaderGetter<T>(\n    refCounted: RefCounted, gl: GL, memoizeKey: any, fallbackParameters: WatchableValueInterface<T>,\n    parameters: WatchableValueInterface<T>, shaderError: WatchableShaderError,\n    defineShader: (builder: ShaderBuilder, parameters: T) =>\n        void): ((emitter: ShaderModule) => ShaderProgram | null) {\n  const getter = parameterizedContextDependentShaderGetter(refCounted, gl, {\n    memoizeKey,\n    fallbackParameters,\n    parameters,\n    getContextKey: (emitter: ShaderModule) => emitter,\n    encodeContext: (emitter: ShaderModule) => getObjectId(emitter),\n    shaderError,\n    defineShader: (builder, parameters, emitter: ShaderModule) => {\n      builder.require(emitter);\n      return defineShader(builder, parameters);\n    },\n  });\n  return (emitter: ShaderModule) => getter(emitter).shader;\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Ellipse-related shader functions.\n */\n\nimport {mat3, vec2, vec3} from 'neuroglancer/util/geom';\n\n/**\n * Specifies the parameters of an ellipse in quadratic form.\n */\nexport const glsl_EllipseQuadraticForm = `\nstruct EllipseQuadraticForm {\n  highp float A;  // x*x coefficient\n  highp float B;  // x*y coefficient\n  highp float C;  // y*y coefficient\n  highp float D;  // x coefficient\n  highp float E;  // y coefficient\n  highp float F;  // 1 coefficient\n};\n`;\n\n/**\n * Given a 3-d ellipsoid, finds the ellipse corresponding to the z=0 cross-section.\n * @param A The positive semi-definite matrix defining the ellipsoid shape.\n * @param c The centroid.\n */\nexport const glsl_computeCrossSectionEllipse = [glsl_EllipseQuadraticForm, `\nEllipseQuadraticForm computeCrossSectionEllipse(mat3 A, vec3 c) {\n  EllipseQuadraticForm p;\n  p.A = A[0][0];\n  p.B = A[0][1] + A[1][0];\n  p.C = A[1][1];\n  p.D = -2.0 * c[0] * A[0][0] - c[1] * (A[0][1] + A[1][0]) +\n        c[2] * (A[0][2] + A[2][0]);\n  p.E = -c[0] * (A[0][1] + A[1][0]) - 2.0 * c[1] * A[1][1] +\n        c[2] * (A[1][2] + A[2][1]);\n  p.F = c[0] * c[0] * A[0][0] + c[0] * c[1] * (A[0][1] + A[1][0]) -\n        c[0] * c[2] * (A[0][2] + A[2][0]) + c[1] * c[1] * A[1][1] -\n        c[1] * c[2] * (A[1][2] + A[2][1]) + c[2] * c[2] * A[2][2] - 1.0;\n  return p;\n}\n`];\n\nexport function computeCrossSectionEllipseDebug(Ao: mat3, c: vec3) {\n  const A = [[Ao[0], Ao[1], Ao[2]], [Ao[3], Ao[4], Ao[5]], [Ao[6], Ao[7], Ao[8]]];\n  return {\n    A: A[0][0],\n    B: A[0][1] + A[1][0],\n    C: A[1][1],\n    D: -2.0 * c[0] * A[0][0] - c[1] * (A[0][1] + A[1][0]) + c[2] * (A[0][2] + A[2][0]),\n    E: -c[0] * (A[0][1] + A[1][0]) - 2.0 * c[1] * A[1][1] + c[2] * (A[1][2] + A[2][1]),\n    F: c[0] * c[0] * A[0][0] + c[0] * c[1] * (A[0][1] + A[1][0]) -\n        c[0] * c[2] * (A[0][2] + A[2][0]) + c[1] * c[1] * A[1][1] -\n        c[1] * c[2] * (A[1][2] + A[2][1]) + c[2] * c[2] * A[2][2] - 1.0,\n  };\n}\n\nexport const glsl_CenterOrientEllipse = `\nstruct CenterOrientEllipse {\n  vec2 k;   // center\n  vec2 u1;  // minor axis direction\n  vec2 u2;  // major axis direction\n  float a;  // semimajor axis\n  float b;  // semiminor axis\n  bool valid; // indicates if the ellipse is valid\n};\n`;\n\n/**\n * Compute the center-orient parameterization of an ellipse from the quadratic parameterization.\n *\n * See: https://www.geometrictools.com/Documentation/InformationAboutEllipses.pdf\n */\nexport const glsl_computeCenterOrientEllipse = [\n  glsl_EllipseQuadraticForm, glsl_CenterOrientEllipse, `\nCenterOrientEllipse computeCenterOrientEllipse(EllipseQuadraticForm p) {\n  CenterOrientEllipse r;\n  float a11 = p.A;\n  float a12 = p.B / 2.0;\n  float a22 = p.C;\n  float b1 = p.D;\n  float b2 = p.E;\n  float c = p.F;\n  float kdenom = 2.0 * (a12 * a12 - a11 * a22);\n  float k1 = r.k.x = (a22 * b1 - a12 * b2) / kdenom;\n  float k2 = r.k.y = (a11 * b2 - a12 * b1) / kdenom;\n  float mu = 1.0 / (a11 * k1 * k1 + 2.0 * a12 * k1 * k2 + a22 * k2 * k2 - c);\n  float m11 = mu * a11;\n  float m12 = mu * a12;\n  float m22 = mu * a22;\n  float lambdaTerm1 = m11 + m22;\n  float lambdaTerm2 = sqrt((m11 - m22) * (m11 - m22) + 4.0 * m12 * m12);\n  float lambda1 = ((lambdaTerm1 + lambdaTerm2) / 2.0);\n  float lambda2 = ((lambdaTerm1 - lambdaTerm2) / 2.0);\n  r.a = 1.0 / sqrt(lambda1);\n  r.b = 1.0 / sqrt(lambda2);\n  r.valid = lambda1 > 0.0 && lambda2 > 0.0;\n  if (abs(m12) < 1e-10) {\n    r.u1 = vec2(1.0, 0.0);\n  } else if (m11 >= m22) {\n    r.u1 = normalize(vec2(lambda1 - m22, m12));\n  } else {\n    r.u1 = normalize(vec2(m12, lambda1 - m11));\n  }\n  r.u2 = vec2(-r.u1.y, r.u1.x);\n  return r;\n}\n`\n];\n\nexport function computeCenterOrientEllipseDebug(\n    p: {A: number, B: number, C: number, D: number, E: number, F: number}) {\n  const a11 = p.A;\n  const a12 = p.B / 2.0;\n  const a22 = p.C;\n  const b1 = p.D;\n  const b2 = p.E;\n  const c = p.F;\n  const kdenom = 2.0 * (a12 * a12 - a11 * a22);\n  const k1 = (a22 * b1 - a12 * b2) / kdenom;\n  const k2 = (a11 * b2 - a12 * b1) / kdenom;\n  const mu = 1.0 / (a11 * k1 * k1 + 2.0 * a12 * k1 * k2 + a22 * k2 * k2 - c);\n  const m11 = mu * a11;\n  const m12 = mu * a12;\n  const m22 = mu * a22;\n  const lambdaTerm1 = m11 + m22;\n  const lambdaTerm2 = Math.sqrt((m11 - m22) * (m11 - m22) + 4.0 * m12 * m12);\n  const lambda1 = ((lambdaTerm1 + lambdaTerm2) / 2.0);\n  const lambda2 = ((lambdaTerm1 - lambdaTerm2) / 2.0);\n  const a = 1.0 / Math.sqrt(lambda1);\n  const b = 1.0 / Math.sqrt(lambda2);\n  let u1: vec2;\n  if (Math.abs(m12) < 1e-10) {\n    u1 = vec2.fromValues(1, 0);\n  } else if (m11 >= m22) {\n    u1 = vec2.fromValues(lambda1 - m22, m12);\n  } else {\n    u1 = vec2.fromValues(m12, lambda1 - m11);\n  }\n  vec2.normalize(u1, u1);\n  const u2 = vec2.fromValues(-u1[1], u1[0]);\n  return {k: vec2.fromValues(k1, k2), u1, u2, a, b, lambda1, lambda2, m11, m12, m22};\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {Buffer} from 'neuroglancer/webgl/buffer';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {ShaderBuilder, ShaderProgram} from 'neuroglancer/webgl/shader';\nimport {glsl_uint32} from 'neuroglancer/webgl/shader_lib';\n\nexport class CountingBuffer extends RefCounted {\n  length: number|undefined;\n  webglType: number|undefined;\n  buffer: Buffer;\n\n  constructor(public gl: GL) {\n    super();\n    this.buffer = this.registerDisposer(new Buffer(gl));\n  }\n\n  resize(length: number) {\n    let bufferData: ArrayBufferView;\n    if (length < 256) {\n      let data = bufferData = new Uint8Array(length);\n      for (let i = 0; i < length; ++i) {\n        data[i] = i;\n      }\n      this.webglType = WebGL2RenderingContext.UNSIGNED_BYTE;\n    } else if (length < 65536) {\n      const data = bufferData = new Uint16Array(length);\n      for (let i = 0; i < length; ++i) {\n        data[i] = i;\n      }\n      this.webglType = WebGL2RenderingContext.UNSIGNED_SHORT;\n    } else {\n      const data = bufferData = new Uint32Array(length);\n      for (let i = 0; i < length; ++i) {\n        data[i] = i;\n      }\n      this.webglType = WebGL2RenderingContext.UNSIGNED_INT;\n    }\n    this.buffer.setData(bufferData);\n    this.length = length;\n  }\n\n  ensure(length: number) {\n    if (this.length === undefined || this.length < length) {\n      this.resize(length);\n    }\n    return this;\n  }\n\n  bindToVertexAttrib(location: number) {\n    this.buffer.bindToVertexAttribI(location, 1, this.webglType);\n  }\n\n  bind(shader: ShaderProgram, divisor = 0) {\n    const location = shader.attribute('aIndexRaw');\n    if (location >= 0) {\n      this.bindToVertexAttrib(location);\n      if (divisor !== 0) {\n        this.gl.vertexAttribDivisor(location, divisor);\n      }\n    }\n  }\n}\n\nexport function disableCountingBuffer(gl: GL, shader: ShaderProgram, instanced = false) {\n  const location = shader.attribute('aIndexRaw');\n  if (location >= 0) {\n    if (instanced) {\n      gl.vertexAttribDivisor(location, 0);\n    }\n    gl.disableVertexAttribArray(location);\n  }\n}\n\nexport function getCountingBuffer(gl: GL) {\n  return gl.memoize.get('IndexBuffer', () => new CountingBuffer(gl));\n}\n\nexport function countingBufferShaderModule(builder: ShaderBuilder) {\n  builder.addAttribute('highp uint', 'aIndexRaw');\n  builder.addVertexCode(glsl_uint32);\n  builder.addVertexCode(`\nuint getPrimitiveIndex() {\n  return aIndexRaw;\n}\n`);\n}\n\n/**\n * Helper class for using a buffer containing uint32 index values as a vertex attribute.\n */\nexport class IndexBufferAttributeHelper {\n  constructor(public name: string) {}\n\n  defineShader(builder: ShaderBuilder) {\n    builder.addAttribute('highp uint', this.name);\n  }\n\n  bind(buffer: Buffer, shader: ShaderProgram) {\n    const attrib = shader.attribute(this.name);\n    buffer.bindToVertexAttribI(attrib, /*components=*/ 1, WebGL2RenderingContext.UNSIGNED_INT);\n  }\n\n  disable(shader: ShaderProgram) {\n    shader.gl.disableVertexAttribArray(shader.attribute(this.name));\n  }\n}\n\nexport function makeIndexBuffer(gl: WebGL2RenderingContext, data: Uint32Array) {\n  return Buffer.fromData(\n      gl, data, WebGL2RenderingContext.ARRAY_BUFFER, WebGL2RenderingContext.STATIC_DRAW);\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Facilities for drawing anti-aliased lines in WebGL as quads.\n */\n\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {Buffer} from 'neuroglancer/webgl/buffer';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {QuadRenderHelper, VERTICES_PER_QUAD} from 'neuroglancer/webgl/quad';\nimport {ShaderBuilder, ShaderProgram} from 'neuroglancer/webgl/shader';\nimport {getSquareCornersBuffer} from 'neuroglancer/webgl/square_corners_buffer';\n\nexport const VERTICES_PER_LINE = VERTICES_PER_QUAD;\n\nexport class LineShader extends RefCounted {\n  private lineOffsetsBuffer: Buffer;\n  private quadHelper: QuadRenderHelper;\n\n  constructor(gl: GL, public linesPerInstance: number = 1) {\n    super();\n    this.lineOffsetsBuffer =\n        getSquareCornersBuffer(gl, 0, -1, 1, 1, /*minorTiles=*/linesPerInstance, /*majorTiles=*/1);\n    this.quadHelper = this.registerDisposer(new QuadRenderHelper(gl, linesPerInstance));\n  }\n\n  defineShader(builder: ShaderBuilder) {\n    builder.addAttribute('highp vec2', 'aLineOffset');\n\n    // x: line width in normalized device x coordinates\n    // y: line height in normalized device y coordinates\n    // z: Fraction of line width that is feathered\n    builder.addUniform('highp vec3', 'uLineParams');\n    builder.addVarying('highp float', 'vLineCoord');\n\n    builder.addVertexCode(`\nuint getLineEndpointIndex() { return uint(aLineOffset.x); }\n`);\n\n    builder.addVertexCode(`\nvoid emitLine(mat4 projection, vec3 vertexA, vec3 vertexB) {\n  vec3 vertexPosition = mix(vertexA, vertexB, aLineOffset.x);\n  vec3 otherVertexPosition = mix(vertexB, vertexA, aLineOffset.x);\n\n  vec4 vertexPositionClip = projection * vec4(vertexPosition, 1.0);\n  vec4 otherVertexPositionClip = projection * vec4(otherVertexPosition, 1.0);\n\n  vec3 vertexPositionDevice = vertexPositionClip.xyz / vertexPositionClip.w;\n  vec3 otherVertexPositionDevice = otherVertexPositionClip.xyz / otherVertexPositionClip.w;\n\n  vec2 lineDirection = normalize(otherVertexPositionDevice.xy - vertexPositionDevice.xy);\n  vec2 lineNormal = vec2(lineDirection.y, -lineDirection.x);\n\n  gl_Position = vertexPositionClip;\n  gl_Position.xy += aLineOffset.y * (2.0 * aLineOffset.x - 1.0) * lineNormal * uLineParams.xy * 0.5 * gl_Position.w;\n  vLineCoord = aLineOffset.y;\n}\n`);\n\n    builder.addFragmentCode(`\nfloat getLineAlpha() {\n  return clamp((1.0 - abs(vLineCoord)) / uLineParams.z, 0.0, 1.0);\n}\n`);\n  }\n\n  draw(\n      shader: ShaderProgram, renderContext: {viewportWidth: number, viewportHeight: number},\n      lineWidthInPixels: number, featherWidthInPixels: number, numInstances: number) {\n    const aLineOffset = shader.attribute('aLineOffset');\n    this.lineOffsetsBuffer.bindToVertexAttrib(aLineOffset, /*components=*/2);\n\n    const lineWidthIncludingFeather = lineWidthInPixels + featherWidthInPixels;\n    const {gl} = shader;\n    gl.uniform3f(\n        shader.uniform('uLineParams'), lineWidthIncludingFeather / renderContext.viewportWidth,\n        lineWidthIncludingFeather / renderContext.viewportHeight,\n        featherWidthInPixels === 0 ? 1e-6 : featherWidthInPixels / lineWidthIncludingFeather);\n    this.quadHelper.draw(gl, numInstances);\n    gl.disableVertexAttribArray(aLineOffset);\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {identityMat4} from 'neuroglancer/util/geom';\nimport {getObjectId} from 'neuroglancer/util/object_id';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {ShaderModule, ShaderProgram} from 'neuroglancer/webgl/shader';\nimport {getSquareCornersBuffer} from 'neuroglancer/webgl/square_corners_buffer';\nimport {resizeTexture} from 'neuroglancer/webgl/texture';\nimport {defineCopyFragmentShader, elementWiseTextureShader} from 'neuroglancer/webgl/trivial_shaders';\n\nexport abstract class SizeManaged extends RefCounted {\n  width = Number.NaN;\n  height = Number.NaN;\n\n  hasSize(width: number, height: number) {\n    return this.width === width && this.height === height;\n  }\n\n  resize(width: number, height: number) {\n    if (this.hasSize(width, height)) {\n      return;\n    }\n    this.width = width;\n    this.height = height;\n\n    this.performResize();\n  }\n  protected abstract performResize(): void;\n}\n\nexport class Renderbuffer extends SizeManaged {\n  renderbuffer: WebGLRenderbuffer|null = null;\n\n  constructor(public gl: GL, public internalformat: number) {\n    super();\n    this.renderbuffer = gl.createRenderbuffer();\n  }\n\n  protected performResize() {\n    let {gl} = this;\n    gl.bindRenderbuffer(gl.RENDERBUFFER, this.renderbuffer);\n    gl.renderbufferStorage(gl.RENDERBUFFER, this.internalformat, this.width, this.height);\n    gl.bindRenderbuffer(gl.RENDERBUFFER, null);\n  }\n\n  disposed() {\n    this.gl.deleteRenderbuffer(this.renderbuffer);\n  }\n\n  attachToFramebuffer(attachment: number) {\n    let {gl} = this;\n    gl.framebufferRenderbuffer(gl.FRAMEBUFFER, attachment, gl.RENDERBUFFER, this.renderbuffer);\n  }\n}\n\nexport class DepthBuffer extends Renderbuffer {\n  constructor(public gl: GL, public includeStencilBuffer = false) {\n    super(gl, includeStencilBuffer ? gl.DEPTH_STENCIL : gl.DEPTH_COMPONENT16);\n  }\n  attachToFramebuffer() {\n    let {gl} = this;\n    super.attachToFramebuffer(\n        this.includeStencilBuffer ? gl.DEPTH_STENCIL_ATTACHMENT : gl.DEPTH_ATTACHMENT);\n  }\n}\n\nexport class DepthStencilBuffer extends DepthBuffer {\n  constructor(gl: GL) {\n    super(gl, /*includeStencilBuffer=*/true);\n  }\n}\n\nexport const StencilBuffer = DepthStencilBuffer;\n\nexport class Framebuffer extends RefCounted {\n  framebuffer = this.gl.createFramebuffer();\n  constructor(public gl: GL) {\n    super();\n  }\n  disposed() {\n    let {gl} = this;\n    gl.deleteFramebuffer(this.framebuffer);\n  }\n  bind() {\n    let {gl} = this;\n    gl.bindFramebuffer(gl.FRAMEBUFFER, this.framebuffer);\n  }\n  unbind() {\n    let {gl} = this;\n    gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n  }\n}\n\nexport class TextureBuffer extends SizeManaged {\n  texture: WebGLTexture|null;\n\n  constructor(public gl: GL, public internalFormat: number, public format: number, public dataType: number) {\n    super();\n    this.texture = gl.createTexture();\n  }\n\n  protected performResize() {\n    resizeTexture(this.gl, this.texture, this.width, this.height, this.internalFormat, this.format, this.dataType);\n  }\n\n  disposed() {\n    this.gl.deleteTexture(this.texture);\n  }\n\n  attachToFramebuffer(attachment: number) {\n    let {gl} = this;\n    gl.framebufferTexture2D(gl.FRAMEBUFFER, attachment, gl.TEXTURE_2D, this.texture, /*level=*/0);\n  }\n}\n\nexport function makeTextureBuffers(\n    gl: GL, count: number, internalFormat: number = WebGL2RenderingContext.RGBA8,\n    format: number = WebGL2RenderingContext.RGBA,\n    dataType: number = WebGL2RenderingContext.UNSIGNED_BYTE) {\n  let result = new Array<TextureBuffer>();\n  for (let i = 0; i < count; ++i) {\n    result[i] = new TextureBuffer(gl, internalFormat, format, dataType);\n  }\n  return result;\n}\n\nconst tempPixel = new Uint8Array(4);\nconst tempPixelUint32 = new Uint32Array(1);\nconst tempPixelFloat32 = new Float32Array(4);\nexport class FramebufferConfiguration<ColorBuffer extends TextureBuffer|Renderbuffer> extends\n    RefCounted {\n  width = Number.NaN;\n  height = Number.NaN;\n\n  colorBuffers: ColorBuffer[];\n  framebuffer: Framebuffer;\n  depthBuffer: DepthBuffer|undefined;\n  private fullAttachmentList = new Array<number>();\n  private attachmentVerified = false;\n  private singleAttachmentList = [this.gl.COLOR_ATTACHMENT0];\n\n  constructor(public gl: GL, configuration: {\n    framebuffer?: Framebuffer,\n    colorBuffers: ColorBuffer[],\n    depthBuffer?: DepthBuffer\n  }) {\n    super();\n    let {framebuffer = new Framebuffer(gl), colorBuffers, depthBuffer} = configuration;\n    this.framebuffer = this.registerDisposer(framebuffer);\n    this.colorBuffers = colorBuffers;\n    this.depthBuffer = depthBuffer;\n    if (depthBuffer !== undefined) {\n      this.registerDisposer(depthBuffer);\n    }\n    let {fullAttachmentList} = this;\n    colorBuffers.forEach((buffer, i) => {\n      this.registerDisposer(buffer);\n      fullAttachmentList[i] = gl.COLOR_ATTACHMENT0 + i;\n    });\n  }\n\n  hasSize(width: number, height: number) {\n    return this.width === width && this.height === height;\n  }\n\n  bind(width: number, height: number) {\n    this.width = width;\n    this.height = height;\n    this.framebuffer.bind();\n    let {gl, depthBuffer} = this;\n    if (depthBuffer !== undefined) {\n      depthBuffer.resize(width, height);\n      depthBuffer.attachToFramebuffer();\n    }\n    this.colorBuffers.forEach((buffer, i) => {\n      buffer.resize(width, height);\n      buffer.attachToFramebuffer(gl.COLOR_ATTACHMENT0 + i);\n    });\n    gl.drawBuffers(this.fullAttachmentList);\n    this.verifyAttachment();\n    gl.viewport(0, 0, width, height);\n  }\n\n  bindSingle(textureIndex: number) {\n    let {gl} = this;\n    this.framebuffer.bind();\n\n    // If this texture is still be bound to color attachment textureIndex, the attachment will fail\n    // (at least on some browsers).  Therefore, if textureIndex is not 0, we clear the attachment.\n    // In the case that textureIndex is 0, the attachment will be overridden anyway.\n    if (textureIndex !== 0) {\n      gl.framebufferTexture2D(\n          gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0 + textureIndex, gl.TEXTURE_2D, null, /*level=*/0);\n    }\n\n    gl.bindTexture(gl.TEXTURE_2D, null);\n    this.colorBuffers[textureIndex].attachToFramebuffer(gl.COLOR_ATTACHMENT0);\n    gl.drawBuffers(this.singleAttachmentList);\n  }\n\n  unbind() {\n    this.framebuffer.unbind();\n  }\n\n  /**\n   * Only supports UNSIGNED_BYTE RGBA textures.\n   */\n  readPixel(textureIndex: number, glWindowX: number, glWindowY: number): Uint8Array {\n    let {gl} = this;\n    try {\n      this.bindSingle(textureIndex);\n      gl.readPixels(glWindowX, glWindowY, 1, 1, gl.RGBA, gl.UNSIGNED_BYTE, tempPixel);\n    } finally {\n      this.framebuffer.unbind();\n    }\n    return tempPixel;\n  }\n\n  readPixelUint32(textureIndex: number, glWindowX: number, glWindowY: number): number {\n    let {gl} = this;\n    try {\n      this.bindSingle(textureIndex);\n      gl.readPixels(\n          glWindowX, glWindowY, 1, 1, WebGL2RenderingContext.RED_INTEGER,\n        WebGL2RenderingContext.UNSIGNED_INT, tempPixelUint32);\n    } finally {\n      this.framebuffer.unbind();\n    }\n    return tempPixelUint32[0];\n  }\n\n  readPixelFloat32(textureIndex: number, glWindowX: number, glWindowY: number): number {\n    let {gl} = this;\n    try {\n      this.bindSingle(textureIndex);\n      // Reading just the red channel using a format of RED fails with certain WebGL\n      // implementations.  Using RGBA seems to have better compatibility.\n      gl.readPixels(\n          glWindowX, glWindowY, 1, 1, WebGL2RenderingContext.RGBA, WebGL2RenderingContext.FLOAT,\n          tempPixelFloat32);\n    } finally {\n      this.framebuffer.unbind();\n    }\n    return tempPixelFloat32[0];\n  }\n\n  readPixelFloat32IntoBuffer(\n      textureIndex: number, glWindowX: number, glWindowY: number, offset: number, width: number = 1,\n      height: number = 1) {\n    let {gl} = this;\n    try {\n      this.bindSingle(textureIndex);\n      // Reading just the red channel using a format of RED fails with certain WebGL\n      // implementations.  Using RGBA seems to have better compatibility.\n      gl.readPixels(\n          glWindowX, glWindowY, width, height, WebGL2RenderingContext.RGBA,\n          WebGL2RenderingContext.FLOAT, offset);\n    } finally {\n      this.framebuffer.unbind();\n    }\n  }\n\n  verifyAttachment() {\n    if (this.attachmentVerified) {\n      return;\n    }\n    let {gl} = this;\n    let framebufferStatus = gl.checkFramebufferStatus(gl.FRAMEBUFFER);\n    if (framebufferStatus !== gl.FRAMEBUFFER_COMPLETE) {\n      throw new Error(`Framebuffer configuration not supported`);\n    }\n    this.attachmentVerified = true;\n  }\n}\n\nexport class OffscreenCopyHelper extends RefCounted {\n  constructor(public gl: GL, public shader: ShaderProgram) {\n    super();\n    this.registerDisposer(shader);\n  }\n  private copyVertexPositionsBuffer = getSquareCornersBuffer(this.gl);\n  private copyTexCoordsBuffer = getSquareCornersBuffer(this.gl, 0, 0, 1, 1);\n\n  draw(...textures: (WebGLTexture|null)[]) {\n    let {gl, shader} = this;\n    shader.bind();\n\n    let numTextures = textures.length;\n    for (let i = 0; i < numTextures; ++i) {\n      gl.activeTexture(gl.TEXTURE0 + i);\n      gl.bindTexture(gl.TEXTURE_2D, textures[i]);\n    }\n\n    gl.uniformMatrix4fv(shader.uniform('uProjectionMatrix'), false, identityMat4);\n\n    let aVertexPosition = shader.attribute('aVertexPosition');\n    this.copyVertexPositionsBuffer.bindToVertexAttrib(aVertexPosition, /*components=*/2);\n\n    let aTexCoord = shader.attribute('aTexCoord');\n    this.copyTexCoordsBuffer.bindToVertexAttrib(aTexCoord, /*components=*/2);\n\n    gl.drawArrays(gl.TRIANGLE_FAN, 0, 4);\n\n    gl.disableVertexAttribArray(aVertexPosition);\n    gl.disableVertexAttribArray(aTexCoord);\n\n    for (let i = 0; i < numTextures; ++i) {\n      gl.activeTexture(gl.TEXTURE0 + i);\n      gl.bindTexture(gl.TEXTURE_2D, null);\n    }\n  }\n\n  static get(\n      gl: GL, shaderModule: ShaderModule = defineCopyFragmentShader, numTextures: number = 1) {\n    return gl.memoize.get(\n        `OffscreenCopyHelper:${numTextures}:${getObjectId(shaderModule)}`,\n        () => new OffscreenCopyHelper(gl, elementWiseTextureShader(gl, shaderModule, numTextures)));\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Facilities for drawing quads in WebGL as two triangles.\n */\n\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {Buffer, getMemoizedBuffer} from 'neuroglancer/webgl/buffer';\nimport {GL} from 'neuroglancer/webgl/context';\n\nexport const VERTICES_PER_QUAD = 4;\nexport const TRIANGLES_PER_QUAD = 2;\nexport const INDICES_PER_QUAD = TRIANGLES_PER_QUAD * 3;\n\n/**\n * Returns a WebGL2RenderingContext.TRIANGLES index array for drawing an instance containing\n * `quadsPerInstance` quads.\n */\nfunction getQuadIndexArray(quadsPerInstance: number) {\n  const result = new Uint16Array(quadsPerInstance * INDICES_PER_QUAD);\n  for (let quad = 0; quad < quadsPerInstance; ++quad) {\n    const v = quad * VERTICES_PER_QUAD;\n    let i = quad * INDICES_PER_QUAD;\n    result[i] = v;\n    result[i + 1] = v + 1;\n    result[i + 2] = v + 2;\n    result[i + 3] = v + 2;\n    result[i + 4] = v + 3;\n    result[i + 5] = v;\n  }\n  return result;\n}\n\nexport class QuadRenderHelper extends RefCounted {\n  quadIndexBuffer: Buffer;\n  constructor(gl: GL, public quadsPerInstance: number) {\n    super();\n    if (quadsPerInstance !== 1) {\n      this.quadIndexBuffer =\n          this.registerDisposer(getMemoizedBuffer(\n                                    gl, WebGL2RenderingContext.ELEMENT_ARRAY_BUFFER,\n                                    getQuadIndexArray, quadsPerInstance))\n              .value;\n    }\n  }\n\n  draw(gl: GL, numInstances: number) {\n    if (this.quadsPerInstance === 1) {\n      gl.drawArraysInstanced(WebGL2RenderingContext.TRIANGLE_FAN, 0, 4, numInstances);\n    } else {\n      this.quadIndexBuffer.bind();\n      gl.drawElementsInstanced(\n          WebGL2RenderingContext.TRIANGLES, INDICES_PER_QUAD * this.quadsPerInstance,\n          WebGL2RenderingContext.UNSIGNED_SHORT, /*offset=*/0, numInstances);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {GL} from 'neuroglancer/webgl/context';\n\nconst DEBUG_SHADER = false;\n\nexport enum ShaderType {\n  VERTEX = WebGL2RenderingContext.VERTEX_SHADER,\n  FRAGMENT = WebGL2RenderingContext.FRAGMENT_SHADER\n}\n\nexport interface ShaderErrorMessage {\n  file?: number;\n  line?: number;\n  message: string;\n}\n\n/**\n * Parses the output of getShaderInfoLog into a list of messages.\n */\nexport function parseShaderErrors(log: string) {\n  log = log.replace('\\0', '');\n  let result: ShaderErrorMessage[] = [];\n  for (let line of log.split('\\n')) {\n    let m = line.match(/^ERROR:\\s*(\\d+):(\\d+)\\s*(.+)$/);\n    if (m !== null) {\n      result.push({message: m[3].trim(), file: parseInt(m[1], 10), line: parseInt(m[2], 10)});\n    } else {\n      m = line.match(/^ERROR:\\s*(.+)$/);\n      if (m !== null) {\n        result.push({message: m[1]});\n      } else {\n        line = line.trim();\n        if (line) {\n          result.push({message: line});\n        }\n      }\n    }\n  }\n  return result;\n}\n\nexport class ShaderCompilationError extends Error {\n  shaderType: ShaderType;\n  source: string;\n  log: string;\n  errorMessages: ShaderErrorMessage[];\n  constructor(\n      shaderType: ShaderType, source: string, log: string, errorMessages: ShaderErrorMessage[]) {\n    const message = `Error compiling ${ShaderType[shaderType].toLowerCase()} shader: ${log}`;\n    super(message);\n    this.name = 'ShaderCompilationError';\n    this.log = log;\n    this.message = message;\n    this.shaderType = shaderType;\n    this.source = source;\n    this.errorMessages = errorMessages;\n  }\n}\n\nexport class ShaderLinkError extends Error {\n  vertexSource: string;\n  fragmentSource: string;\n  log: string;\n  constructor(vertexSource: string, fragmentSource: string, log: string) {\n    const message = `Error linking shader: ${log}`;\n    super(message);\n    this.name = 'ShaderLinkError';\n    this.log = log;\n    this.message = message;\n    this.vertexSource = vertexSource;\n    this.fragmentSource = fragmentSource;\n  }\n}\n\nexport function getShader(gl: WebGL2RenderingContext, source: string, shaderType: ShaderType) {\n  var shader = gl.createShader(shaderType)!;\n  gl.shaderSource(shader, source);\n  gl.compileShader(shader);\n\n  if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n    let log = gl.getShaderInfoLog(shader) || '';\n\n    if (DEBUG_SHADER) {\n      let lines = source.replace('<', '&lt;').replace('>', '&gt;').split('\\n');\n      let s = '<pre>';\n      s += log.replace('<', '&lt;').replace('>', '&gt;') + '\\n';\n      lines.forEach((line, i) => {\n        s += `${i + 1}: ${line}\\n`;\n      });\n      s += `\\n</pre>`;\n      let w = window.open('about:blank', '_blank');\n      if (w !== null) {\n        try {\n          w.document.write(s);\n        } catch (writeError) {\n        }\n      }\n    }\n\n    throw new ShaderCompilationError(shaderType, source, log, parseShaderErrors(log));\n  }\n\n  return shader!;\n}\n\nexport type AttributeIndex = number;\n\nexport class ShaderProgram extends RefCounted {\n  program: WebGLProgram;\n  vertexShader: WebGLShader;\n  fragmentShader: WebGLShader;\n  attributes = new Map<string, AttributeIndex>();\n  uniforms = new Map<string, WebGLUniformLocation|null>();\n  textureUnits: Map<any, number>;\n\n  constructor(\n      public gl: GL, public vertexSource: string, public fragmentSource: string,\n      uniformNames?: string[], attributeNames?: string[]) {\n    super();\n    let vertexShader = this.vertexShader = getShader(gl, vertexSource, gl.VERTEX_SHADER);\n    let fragmentShader = this.fragmentShader = getShader(gl, fragmentSource, gl.FRAGMENT_SHADER);\n\n    let shaderProgram = gl.createProgram()!;\n    gl.attachShader(shaderProgram, vertexShader);\n    gl.attachShader(shaderProgram, fragmentShader);\n    gl.linkProgram(shaderProgram);\n    if (!gl.getProgramParameter(shaderProgram, gl.LINK_STATUS)) {\n      let log = gl.getProgramInfoLog(shaderProgram) || '';\n\n      // DEBUG\n      // {\n      //   let combinedSource = 'VERTEX SHADER\\n\\n' + vertexSource + '\\n\\n\\nFRAGMENT SHADER\\n\\n' +\n      //   fragmentSource + '\\n';\n      //   let w = window.open(\"about:blank\", \"_blank\");\n      //   w.document.write('<pre>' + combinedSource.replace('<', '&lt;').replace('>', '&gt;') +\n      //   '</pre>');\n      // }\n\n      throw new ShaderLinkError(vertexSource, fragmentSource, log);\n    }\n    this.program = shaderProgram!;\n\n    let {uniforms, attributes} = this;\n    if (uniformNames) {\n      for (let name of uniformNames) {\n        uniforms.set(name, gl.getUniformLocation(shaderProgram, name));\n      }\n    }\n\n    if (attributeNames) {\n      for (let name of attributeNames) {\n        attributes.set(name, gl.getAttribLocation(shaderProgram, name));\n      }\n    }\n  }\n\n  uniform(name: string): WebGLUniformLocation {\n    return this.uniforms.get(name)!;\n  }\n\n  attribute(name: string): number {\n    return this.attributes.get(name)!;\n  }\n\n  textureUnit(symbol: Symbol): number {\n    return this.textureUnits.get(symbol)!;\n  }\n\n  bind() {\n    this.gl.useProgram(this.program);\n  }\n\n  disposed() {\n    let {gl} = this;\n    gl.deleteShader(this.vertexShader);\n    this.vertexShader = <any>undefined;\n    gl.deleteShader(this.fragmentShader);\n    this.fragmentShader = <any>undefined;\n    gl.deleteProgram(this.program);\n    this.program = <any>undefined;\n    this.gl = <any>undefined;\n    this.attributes = <any>undefined;\n    this.uniforms = <any>undefined;\n  }\n}\n\nexport type ShaderCodePart = string|ShaderCodePartArray|ShaderCodePartFunction;\ninterface ShaderCodePartFunction {\n  (): ShaderCodePart;\n}\ninterface ShaderCodePartArray extends Array<ShaderCodePart> {}\n\nexport class ShaderCode {\n  code = '';\n  parts = new Set<ShaderCodePart>();\n  constructor() {}\n\n  add(x: ShaderCodePart) {\n    if (this.parts.has(x)) {\n      return;\n    }\n    this.parts.add(x);\n    switch (typeof x) {\n      case 'string':\n        this.code += x;\n        break;\n      case 'function':\n        this.add((<ShaderCodePartFunction>x)());\n        break;\n      default:\n        if (Array.isArray(x)) {\n          for (let y of x) {\n            this.add(y);\n          }\n        } else {\n          console.log('Invalid code type', x);\n          throw new Error('Invalid code type');\n        }\n    }\n  }\n\n  toString(): string {\n    return this.code;\n  }\n}\n\nexport type ShaderInitializer = ((x: ShaderProgram) => void);\nexport type ShaderModule = ((x: ShaderBuilder) => void);\n\nexport type ShaderSamplerPrefix = 'i'|'u'|'';\n\nexport type ShaderSamplerType =\n    'sampler2D'|'usampler2D'|'isampler2D'|'sampler3D'|'usampler3D'|'isampler3D';\n\nexport type ShaderInterpolationMode =\n    ''|'centroid'|'flat centroid'|'smooth centroid'|'flat'|'smooth';\n\nexport const textureTargetForSamplerType = {\n  'sampler2D': WebGL2RenderingContext.TEXTURE_2D,\n  'isampler2D': WebGL2RenderingContext.TEXTURE_2D,\n  'usampler2D': WebGL2RenderingContext.TEXTURE_2D,\n  'sampler3D': WebGL2RenderingContext.TEXTURE_3D,\n  'isampler3D': WebGL2RenderingContext.TEXTURE_3D,\n  'usampler3D': WebGL2RenderingContext.TEXTURE_3D,\n};\n\nexport class ShaderBuilder {\n  private nextSymbolID = 0;\n  private nextTextureUnit = 0;\n  private uniformsCode = '';\n  private attributesCode = '';\n  private varyingsCodeVS = '';\n  private varyingsCodeFS = '';\n  private fragmentExtensionsSet = new Set<string>();\n  private fragmentExtensions = '';\n  private vertexCode = new ShaderCode();\n  private vertexMain = '';\n  private fragmentCode = new ShaderCode();\n  private outputBufferCode = '';\n  private fragmentMain = '';\n  private required = new Set<ShaderModule>();\n  private uniforms = new Array<string>();\n  private attributes = new Array<string>();\n  private initializers: Array<ShaderInitializer> = [];\n  private textureUnits = new Map<Symbol, number>();\n  constructor(public gl: GL) {}\n\n  allocateTextureUnit(symbol: Symbol, count: number = 1) {\n    if (this.textureUnits.has(symbol)) {\n      throw new Error('Duplicate texture unit symbol: ' + symbol);\n    }\n    let old = this.nextTextureUnit;\n    this.nextTextureUnit += count;\n    this.textureUnits.set(symbol, old);\n    return old;\n  }\n\n  addTextureSampler(samplerType: ShaderSamplerType, name: string, symbol: Symbol, extent?: number) {\n    let textureUnit = this.allocateTextureUnit(symbol, extent);\n    this.addUniform(`highp ${samplerType}`, name, extent);\n    this.addInitializer(shader => {\n      if (extent) {\n        let textureUnits = new Int32Array(extent);\n        for (let i = 0; i < extent; ++i) {\n          textureUnits[i] = i + textureUnit;\n        }\n        shader.gl.uniform1iv(shader.uniform(name), textureUnits);\n      } else {\n        shader.gl.uniform1i(shader.uniform(name), textureUnit);\n      }\n    });\n    return textureUnit;\n  }\n\n  symbol(name: string) {\n    return name + (this.nextSymbolID++);\n  }\n\n  addAttribute(typeName: string, name: string) {\n    this.attributes.push(name);\n    this.attributesCode += `in ${typeName} ${name};\\n`;\n    return name;\n  }\n\n  addVarying(typeName: string, name: string, interpolationMode: ShaderInterpolationMode = '') {\n    this.varyingsCodeVS += `${interpolationMode} out ${typeName} ${name};\\n`;\n    this.varyingsCodeFS += `${interpolationMode} in ${typeName} ${name};\\n`;\n  }\n\n  addOutputBuffer(typeName: string, name: string, location: number|null) {\n    if (location !== null) {\n      this.outputBufferCode += `layout(location = ${location}) `;\n    }\n    this.outputBufferCode += `out ${typeName} ${name};\\n`;\n  }\n\n  addUniform(typeName: string, name: string, extent?: number) {\n    this.uniforms.push(name);\n    if (extent != null) {\n      this.uniformsCode += `uniform ${typeName} ${name}[${extent}];\\n`;\n    } else {\n      this.uniformsCode += `uniform ${typeName} ${name};\\n`;\n    }\n    return name;\n  }\n\n  addFragmentExtension(name: string) {\n    if (this.fragmentExtensionsSet.has(name)) {\n      return;\n    }\n    this.fragmentExtensionsSet.add(name);\n    this.fragmentExtensions += `#extension ${name} : require\\n`;\n  }\n\n  addVertexCode(code: ShaderCodePart) {\n    this.vertexCode.add(code);\n  }\n\n  addFragmentCode(code: ShaderCodePart) {\n    this.fragmentCode.add(code);\n  }\n\n  setVertexMain(code: string) {\n    this.vertexMain = code;\n  }\n  addVertexMain(code: string) {\n    this.vertexMain = (this.vertexMain || '') + code;\n  }\n\n  setFragmentMain(code: string) {\n    this.fragmentMain = `void main() {\n${code}\n}\n`;\n  }\n  setFragmentMainFunction(code: string) {\n    this.fragmentMain = code;\n  }\n\n  addInitializer(f: ShaderInitializer) {\n    this.initializers.push(f);\n  }\n\n  require(f: ShaderModule): void {\n    if (this.required.has(f)) {\n      return;\n    }\n    this.required.add(f);\n    f(this);\n  }\n\n  build() {\n    let vertexSource = `#version 300 es\nprecision highp float;\nprecision highp int;\n${this.uniformsCode}\n${this.attributesCode}\n${this.varyingsCodeVS}\n${this.vertexCode}\nvoid main() {\n${this.vertexMain}\n}\n`;\n    let fragmentSource = `#version 300 es\n${this.fragmentExtensions}\nprecision highp float;\nprecision highp int;\n${this.uniformsCode}\n${this.varyingsCodeFS}\n${this.outputBufferCode}\n${this.fragmentCode}\n${this.fragmentMain}\n`;\n    let shader =\n        new ShaderProgram(this.gl, vertexSource, fragmentSource, this.uniforms, this.attributes);\n    shader.textureUnits = this.textureUnits;\n    let {initializers} = this;\n    if (initializers.length > 0) {\n      shader.bind();\n      for (let initializer of initializers) {\n        initializer(shader);\n      }\n    }\n    return shader;\n  }\n}\n\nexport function shaderContainsIdentifiers(code: string, identifiers: Iterable<string>) {\n  let found = new Set<string>();\n  for (let identifier of identifiers) {\n    let pattern = new RegExp(`(?:^|[^a-zA-Z0-9_])${identifier}[^a-zA-Z0-9_])`);\n    if (code.match(pattern) !== null) {\n      found.add(identifier);\n    }\n  }\n  return found;\n}\n\nexport function emitterDependentShaderGetter(\n    refCounted: RefCounted, gl: GL,\n    defineShader: (builder: ShaderBuilder) => void): ((emitter: ShaderModule) => ShaderProgram) {\n  const shaders = new Map<ShaderModule, ShaderProgram>();\n  function getter(emitter: ShaderModule) {\n    let shader = shaders.get(emitter);\n    if (shader === undefined) {\n      const builder = new ShaderBuilder(gl);\n      builder.require(emitter);\n      defineShader(builder);\n      shader = refCounted.registerDisposer(builder.build());\n      shaders.set(emitter, shader);\n    }\n    return shader;\n  }\n  return getter;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {DataType} from 'neuroglancer/util/data_type';\n\n// Hue, saturation, and value are in [0, 1] range.\nexport var glsl_hsvToRgb = `\nvec3 hueToRgb(float hue) {\n  float hue6 = hue * 6.0;\n  float r = abs(hue6 - 3.0) - 1.0;\n  float g = 2.0 - abs(hue6 - 2.0);\n  float b = 2.0 - abs(hue6 - 4.0);\n  return clamp(vec3(r, g, b), 0.0, 1.0);\n}\nvec3 hsvToRgb(vec3 c) {\n  vec3 hueRgb = hueToRgb(c.x);\n  return c.z * ((hueRgb - 1.0) * c.y + 1.0);\n}\n`;\n\nexport const glsl_uint64 = `\nstruct uint64_t {\n  highp uvec2 value;\n};\nstruct uint64x2_t {\n  highp uvec4 value;\n};\nuint64_t toUint64(uint64_t x) { return x; }\n`;\n\nexport const glsl_unpackUint64leFromUint32 = [\n  glsl_uint64, `\nuint64_t unpackUint64leFromUint32(highp uvec2 x) {\n  uint64_t result;\n  result.value = x;\n  return result;\n}\nuint64x2_t unpackUint64leFromUint32(highp uvec4 x) {\n  uint64x2_t result;\n  result.value = x;\n  return result;\n}\n`];\n\nexport const glsl_equalUint64 = [\n  glsl_uint64, `\nbool equals(uint64_t a, uint64_t b) {\n  return a.value == b.value;\n}\n`\n];\n\nexport const glsl_uint8 = [\n  glsl_uint64, `\nstruct uint8_t {\n  highp uint value;\n};\nstruct uint8x2_t {\n  highp uvec2 value;\n};\nstruct uint8x3_t {\n  highp uvec3 value;\n};\nstruct uint8x4_t {\n  highp uvec4 value;\n};\nhighp uint toRaw(uint8_t x) { return x.value; }\nhighp float toNormalized(uint8_t x) { return float(x.value) / 255.0; }\nhighp uvec2 toRaw(uint8x2_t x) { return x.value; }\nhighp vec2 toNormalized(uint8x2_t x) { return vec2(x.value) / 255.0; }\nhighp uvec3 toRaw(uint8x3_t x) { return x.value; }\nvec3 toNormalized(uint8x3_t x) { return vec3(x.value) / 255.0; }\nhighp uvec4 toRaw(uint8x4_t x) { return x.value; }\nvec4 toNormalized(uint8x4_t x) { return vec4(x.value) / 255.0; }\nuint64_t toUint64(uint8_t x) {\n  uint64_t result;\n  result.value[0] = x.value;\n  result.value[1] = 0u;\n  return result;\n}\n`\n];\n\nexport const glsl_float = `\nfloat toRaw(float x) { return x; }\nfloat toNormalized(float x) { return x; }\nvec2 toRaw(vec2 x) { return x; }\nvec2 toNormalized(vec2 x) { return x; }\nvec3 toRaw(vec3 x) { return x; }\nvec3 toNormalized(vec3 x) { return x; }\nvec4 toRaw(vec4 x) { return x; }\nvec4 toNormalized(vec4 x) { return x; }\n`;\n\nexport const glsl_uint16 = [\n  glsl_uint64, `\nstruct uint16_t {\n  highp uint value;\n};\nstruct uint16x2_t {\n  highp uvec2 value;\n};\nhighp uint toRaw(uint16_t x) { return x.value; }\nhighp float toNormalized(uint16_t x) { return float(toRaw(x)) / 65535.0; }\nhighp uvec2 toRaw(uint16x2_t x) { return x.value; }\nhighp vec2 toNormalized(uint16x2_t x) { return vec2(toRaw(x)) / 65535.0; }\nuint64_t toUint64(uint16_t x) {\n  uint64_t result;\n  result.value[0] = x.value;\n  result.value[1] = 0u;\n  return result;\n}\n`\n];\n\nexport const glsl_uint32 = [\n  glsl_uint64, `\nstruct uint32_t {\n  highp uint value;\n};\nhighp float toNormalized(uint32_t x) { return float(x.value) / 4294967295.0; }\nhighp uint toRaw(uint32_t x) { return x.value; }\nuint64_t toUint64(uint32_t x) {\n  uint64_t result;\n  result.value[0] = x.value;\n  result.value[1] = 0u;\n  return result;\n}\n`\n];\n\nexport var glsl_getFortranOrderIndex = `\nhighp int getFortranOrderIndex(ivec3 subscripts, ivec3 size) {\n  return subscripts.x + size.x * (subscripts.y + size.y * subscripts.z);\n}\n`;\n\nexport function getShaderType(dataType: DataType, numComponents: number = 1) {\n  switch (dataType) {\n    case DataType.FLOAT32:\n      if (numComponents === 1) {\n        return 'float';\n      }\n      if (numComponents > 1 && numComponents <= 4) {\n        return `vec${numComponents}`;\n      }\n      break;\n    case DataType.UINT8:\n      if (numComponents === 1) {\n        return 'uint8_t';\n      }\n      if (numComponents > 1 && numComponents <= 4) {\n        return `uint8x${numComponents}_t`;\n      }\n      break;\n    case DataType.UINT16:\n      if (numComponents === 1) {\n        return 'uint16_t';\n      }\n      if (numComponents === 2) {\n        return `uint16x2_t`;\n      }\n      break;\n    case DataType.UINT32:\n      if (numComponents === 1) {\n        return 'uint32_t';\n      }\n      break;\n    case DataType.UINT64:\n      if (numComponents === 1) {\n        return 'uint64_t';\n      }\n      break;\n  }\n  throw new Error(`No shader type for ${DataType[dataType]}[${numComponents}].`);\n}\n","/**\n * @license\n * Copyright 2019 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {TrackableValue, TrackableValueInterface, WatchableValueInterface} from 'neuroglancer/trackable_value';\nimport {parseRGBColorSpecification, TrackableRGB} from 'neuroglancer/util/color';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {vec3} from 'neuroglancer/util/geom';\nimport {verifyFiniteFloat, verifyInt, verifyObject} from 'neuroglancer/util/json';\nimport {NullarySignal} from 'neuroglancer/util/signal';\nimport {Trackable} from 'neuroglancer/util/trackable';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {ShaderBuilder, ShaderProgram} from 'neuroglancer/webgl/shader';\n\nexport interface ShaderSliderControl {\n  type: 'slider';\n  valueType: 'int'|'uint'|'float';\n  min: number;\n  max: number;\n  step: number;\n  default: number;\n}\n\nexport interface ShaderColorControl {\n  type: 'color';\n  valueType: 'vec3';\n  defaultString: string;\n  default: vec3;\n}\n\nexport type ShaderUiControl = ShaderSliderControl|ShaderColorControl;\n\nexport interface ShaderControlParseError {\n  line: number;\n  message: string;\n}\n\nexport interface ShaderControlsParseResult {\n  source: string;\n  code: string;\n  controls: Map<string, ShaderUiControl>;\n  errors: ShaderControlParseError[];\n}\n\n// Strips comments from GLSL code.  Also handles string literals since they are used in ui control\n// directives.\nexport function stripComments(code: string) {\n  // https://stackoverflow.com/a/241506\n  const commentPattern = /\\/\\/.*?$|\\/\\*(?:.|\\n)*?\\*\\/|'(?:\\\\.|[^\\\\'])*'|\"(?:\\\\.|[^\\\\\"])*\"/mg;\n  return code.replace(commentPattern, m => {\n    if (m.startsWith('/')) {\n      return m.replace(/[^\\s]/g, ' ');\n    }\n    return m;\n  });\n}\n\ntype DirectiveParameters = Map<string, string|number>;\n\nexport function parseDirectiveParameters(input: string|undefined):\n    {parameters: DirectiveParameters, errors: string[]} {\n  let errors: string[] = [];\n  let parameters = new Map<string, number|string>();\n  if (input === undefined) {\n    return {errors, parameters};\n  }\n  const pattern =\n      /^[ \\t]*([_a-z][_a-zA-Z0-9]*)[ \\t]*=[ \\t]*(-?(?:0|[1-9]\\d*)(?:\\.\\d+)?(?:[eE][+-]?\\d+)?|\"(?:\\\\.|[^\\\\\"])*\")[ \\t]*/;\n  while (true) {\n    input = input.trim();\n    if (input.length == 0) break;\n    const m = input.match(pattern);\n    if (m === null) {\n      errors.push('Invalid #uicontrol parameter syntax, expected: <param>=<value>, ...');\n      break;\n    }\n    const name = m[1];\n    let value;\n    try {\n      value = JSON.parse(m[2]);\n    } catch {\n      errors.push(`Invalid #uicontrol parameter value: ${value}`);\n      break;\n    }\n    if (parameters.has(name)) {\n      errors.push(`Duplicate #uicontrol parameter: ${name}`);\n    } else {\n      parameters.set(name, value);\n    }\n    input = input.substring(m[0].length);\n    if (input.length > 0 && !input.startsWith(',')) {\n      errors.push('Invalid #uicontrol parameter syntax, expected: <param>=<value>, ...');\n    }\n    input = input.substring(1);\n  }\n  return {parameters, errors};\n}\n\ntype DirectiveParseResult = {\n  control: ShaderUiControl,\n  errors: undefined\n}|{errors: string[]};\n\nfunction parseSliderDirective(\n    valueType: string, parameters: DirectiveParameters): DirectiveParseResult {\n  let min: number|undefined;\n  let max: number|undefined;\n  let step: number|undefined;\n  let defaultValue: number|undefined;\n  let errors = [];\n  if (valueType !== 'float' && valueType !== 'uint' && valueType !== 'int') {\n    errors.push('type must be float, int, or uint');\n  }\n  for (const [key, value] of parameters) {\n    const getValue = (): number|undefined => {\n      if (typeof value !== 'number') {\n        errors.push(`Expected ${key} argument to be a number`);\n        return undefined;\n      }\n      if (valueType === 'int' || valueType === 'uint') {\n        if (!Number.isInteger(value)) {\n          errors.push(`Expected ${key} argument to be an integer`);\n        }\n        if (valueType === 'uint' && value < 0) {\n          errors.push(`Expected ${key} argument to be an unsigned integer`);\n        }\n      }\n      return value;\n    };\n    if (key === 'min') {\n      min = getValue();\n    } else if (key === 'max') {\n      max = getValue();\n    } else if (key === 'default') {\n      defaultValue = getValue();\n    } else if (key === 'step') {\n      step = getValue();\n    } else {\n      errors.push(`Invalid parameter: ${key}`);\n    }\n  }\n  if (min === undefined) {\n    errors.push('min must be specified');\n  }\n  if (max === undefined) {\n    errors.push('max must be specified');\n  }\n  if (min !== undefined && max !== undefined) {\n    if (min > max) {\n      errors.push('min must be less than max');\n    }\n    if (step === undefined) {\n      if (valueType === 'float') {\n        step = (max - min) / 100;\n      } else {\n        step = 1;\n      }\n    }\n    if (defaultValue !== undefined) {\n      if (defaultValue < min || defaultValue > max) {\n        errors.push('default must be within valid range');\n      }\n    } else {\n      if (valueType === 'float') {\n        defaultValue = (min + max) / 2;\n      } else {\n        defaultValue = min;\n      }\n    }\n  }\n  if (errors.length > 0) {\n    return {errors};\n  } else {\n    return {\n      control: {type: 'slider', valueType, min, max, step, default: defaultValue} as ShaderSliderControl,\n      errors: undefined,\n    };\n  }\n}\n\nfunction parseColorDirective(\n    valueType: string, parameters: DirectiveParameters): DirectiveParseResult {\n  let defaultColor = 'white';\n  let errors = [];\n  if (valueType !== 'vec3') {\n    errors.push('type must be vec3');\n  }\n  for (const [key, value] of parameters) {\n    if (key === 'default') {\n      if (typeof value !== 'string') {\n        errors.push(`Expected default argument to be a string`);\n      } else {\n        defaultColor = value;\n      }\n    } else {\n      errors.push(`Invalid parameter: ${key}`);\n    }\n  }\n  if (errors.length > 0) {\n    return {errors};\n  }\n  return {\n    control: {\n      type: 'color',\n      valueType,\n      defaultString: defaultColor,\n      default: parseRGBColorSpecification(defaultColor)\n    } as ShaderColorControl,\n    errors: undefined\n  };\n}\n\nconst controlParsers =\n    new Map<string, (valueType: string, parameters: DirectiveParameters) => DirectiveParseResult>(\n        [['slider', parseSliderDirective], ['color', parseColorDirective]]);\n\n\nexport function parseShaderUiControls(code: string): ShaderControlsParseResult {\n  code = stripComments(code);\n  // Matches any #uicontrols directive.  Syntax errors in the directive are handled later.\n  const directivePattern = /^[ \\t]*#[ \\t]*uicontrol[ \\t]+(.*)$/mg;\n  const innerPattern =\n      /^([_a-zA-Z][_a-zA-Z0-9]*)[ \\t]+([a-z][a-zA-Z0-9]*)[ \\t]+([a-z]+)[ \\t]*(?:\\([ \\t]*(.*)\\)[ \\t]*)?/;\n  let errors: {line: number, message: string}[] = [];\n  const controls = new Map<string, ShaderUiControl>();\n  const newCode = code.replace(directivePattern, (_match, innerPart: string, offset: number) => {\n    const m = innerPart.match(innerPattern);\n    const getLineNumber = () => {\n      return Math.max(0, code.substring(0, offset).split('\\n').length - 1);\n    };\n    if (m === null) {\n      errors.push({\n        line: getLineNumber(),\n        message:\n            'Invalid #uicontrol syntax, expected: #uicontrol <type> <name> <control>(<param>=<value>, ...)'\n      });\n      return '';\n    }\n    const typeName = m[1];\n    const variableName = m[2];\n    const controlName = m[3];\n    const parameterText = m[4];\n    const {parameters, errors: innerErrors} = parseDirectiveParameters(parameterText);\n    for (const error of innerErrors) {\n      errors.push({line: getLineNumber(), message: error});\n    }\n    if (controls.has(variableName)) {\n      errors.push(\n          {line: getLineNumber(), message: `Duplicate definition for control ${variableName}`});\n    }\n    if (innerErrors.length > 0) {\n      return '';\n    }\n    const parser = controlParsers.get(controlName);\n    if (parser === undefined) {\n      errors.push({line: getLineNumber(), message: `Invalid control type ${controlName}`});\n      return '';\n    }\n    const result = parser(typeName, parameters);\n    if (result.errors !== undefined) {\n      for (const error of result.errors) {\n        errors.push({line: getLineNumber(), message: error});\n      }\n      return '';\n    }\n    controls.set(variableName, result.control);\n    return '';\n  });\n  return {source: code, code: newCode, errors, controls};\n}\n\nexport type Controls = Map<string, ShaderUiControl>;\n\nfunction uniformName(controlName: string) {\n  return `u_shaderControl_${controlName}`;\n}\n\nexport function addControlsToBuilder(controls: Controls, builder: ShaderBuilder) {\n  for (const [name, control] of controls) {\n    builder.addUniform(`highp ${control.valueType}`, uniformName(name));\n    builder.addFragmentCode(`#define ${name} ${uniformName(name)}\\n`);\n  }\n}\n\nfunction objectFromEntries(entries: Iterable<[string, any]>) {\n  const obj: any = {};\n  for (const [key, value] of entries) {\n    obj[key] = value;\n  }\n  return obj;\n}\n\nfunction encodeControls(controls: Controls|undefined) {\n  if (controls === undefined) return undefined;\n  return JSON.stringify(objectFromEntries(controls));\n}\n\nexport class WatchableShaderUiControls implements WatchableValueInterface<Controls|undefined> {\n  changed = new NullarySignal();\n  controls: Controls|undefined = undefined;\n  get value() {\n    return this.controls;\n  }\n  set value(newControls: Controls|undefined) {\n    if (encodeControls(newControls) === encodeControls(this.controls)) {\n      return;\n    }\n    this.controls = newControls;\n    this.changed.dispatch();\n  }\n}\n\nfunction getControlTrackable(control: ShaderUiControl): TrackableValueInterface<any> {\n  switch (control.type) {\n    case 'slider':\n      return new TrackableValue<number>(control.default, x => {\n        let v: number;\n        if (control.valueType === 'float') {\n          v = verifyFiniteFloat(x);\n        } else {\n          v = verifyInt(x);\n        }\n        if (v < control.min || v > control.max) {\n          throw new Error(\n              `${JSON.stringify(x)} is outside valid range [${control.min}, ${control.max}]`);\n        }\n        return v;\n      });\n    case 'color':\n      return new TrackableRGB(control.default);\n  }\n}\n\nexport class ShaderControlState extends RefCounted implements Trackable {\n  changed = new NullarySignal();\n  controls = new WatchableShaderUiControls();\n  parseErrors: WatchableValueInterface<ShaderControlParseError[]>;\n  processedFragmentMain: WatchableValueInterface<string>;\n  parseResult: WatchableValueInterface<ShaderControlsParseResult>;\n  private fragmentMainGeneration = -1;\n  private parseErrors_: ShaderControlParseError[] = [];\n  private processedFragmentMain_ = '';\n  private parseResult_: ShaderControlsParseResult;\n  private controlsGeneration = -1;\n\n  constructor(public fragmentMain: WatchableValueInterface<string>) {\n    super();\n    this.registerDisposer(fragmentMain.changed.add(() => this.handleFragmentMainChanged()));\n    this.registerDisposer(this.controls.changed.add(() => this.handleControlsChanged()));\n    this.handleFragmentMainChanged();\n    const self = this;\n    this.parseErrors = {\n      changed: fragmentMain.changed,\n      get value() {\n        self.handleFragmentMainChanged();\n        return self.parseErrors_;\n      }\n    };\n    this.processedFragmentMain = {\n      changed: fragmentMain.changed,\n      get value() {\n        self.handleFragmentMainChanged();\n        return self.processedFragmentMain_;\n      }\n    };\n    this.parseResult = {\n      changed: fragmentMain.changed,\n      get value() {\n        return self.parseResult_;\n      }\n    };\n  }\n\n  private handleFragmentMainChanged() {\n    const generation = this.fragmentMain.changed.count;\n    if (generation === this.fragmentMainGeneration) return;\n    this.fragmentMainGeneration = generation;\n    const result = this.parseResult_ = parseShaderUiControls(this.fragmentMain.value);\n    this.parseErrors_ = result.errors;\n    this.processedFragmentMain_ = result.code;\n    if (result.errors.length === 0) {\n      this.controls.value = result.controls;\n    }\n  }\n\n  private handleControlsChanged() {\n    const generation = this.controls.changed.count;\n    if (generation === this.controlsGeneration) {\n      return;\n    }\n    this.controlsGeneration = generation;\n    const controls = this.controls.value;\n    if (controls === undefined) {\n      return;\n    }\n    let changed = false;\n    const {state_, unparsedJson} = this;\n    // Remove values in `state` not in `controls`.\n    for (const [name, controlState] of state_) {\n      const control = controls.get(name);\n      if (control === undefined) {\n        controlState.trackable.changed.remove(this.changed.dispatch);\n        state_.delete(name);\n        changed = true;\n        continue;\n      }\n    }\n    for (const [name, control] of controls) {\n      let controlState = state_.get(name);\n      if (controlState !== undefined &&\n          JSON.stringify(controlState.control) !== JSON.stringify(control)) {\n        controlState.trackable.changed.remove(this.changed.dispatch);\n        controlState = undefined;\n      }\n      if (controlState === undefined) {\n        controlState = {control, trackable: getControlTrackable(control)};\n        controlState.trackable.changed.add(this.changed.dispatch);\n        state_.set(name, controlState);\n        changed = true;\n      }\n      if (unparsedJson !== undefined && unparsedJson.hasOwnProperty(name)) {\n        changed = true;\n        try {\n          controlState.trackable.restoreState(unparsedJson[name]);\n        } catch {\n          // Ignore error\n        }\n      }\n    }\n    if (unparsedJson !== undefined) {\n      changed = true;\n    }\n    this.unparsedJson = undefined;\n    if (changed) {\n      this.changed.dispatch();\n    }\n  }\n\n  private state_ =\n      new Map<string, {control: ShaderUiControl, trackable: TrackableValueInterface<any>}>();\n\n  get state() {\n    if (this.controls.changed.count !== this.controlsGeneration) {\n      this.handleControlsChanged();\n    }\n    return this.state_;\n  }\n\n  private unparsedJson: any = undefined;\n\n  restoreState(value: any) {\n    if (value === undefined) return;\n    const {state} = this;\n    verifyObject(value);\n    const controls = this.controls.value;\n    if (controls === undefined) {\n      this.unparsedJson = value;\n      this.changed.dispatch();\n      return;\n    }\n    for (const [key, controlState] of state) {\n      const {trackable} = controlState;\n      trackable.reset();\n      if (value.hasOwnProperty(key)) {\n        try {\n          trackable.restoreState(value[key]);\n        } catch {\n          // Ignore error\n        }\n      }\n    }\n    this.unparsedJson = undefined;\n  }\n\n  reset() {\n    for (const controlState of this.state.values()) {\n      controlState.trackable.reset();\n    }\n    if (this.unparsedJson !== undefined) {\n      this.unparsedJson = undefined;\n      this.changed.dispatch();\n    }\n  }\n\n  toJSON() {\n    const {state} = this;\n    const {unparsedJson} = this;\n    if (unparsedJson !== undefined) return unparsedJson;\n    const obj: any = {};\n    let empty = true;\n    for (const [key, value] of state) {\n      const valueJson = value.trackable.toJSON();;\n      if (valueJson !== undefined) {\n        obj[key] = valueJson;\n        empty = false;\n      }\n    }\n    if (empty) return undefined;\n    return obj;\n  }\n}\n\nfunction setControlInShader(gl: GL, shader: ShaderProgram, name: string, control: ShaderUiControl, value: any) {\n  const uniform = shader.uniform(uniformName(name));\n  switch (control.type) {\n    case 'slider':\n      switch (control.valueType) {\n        case 'int':\n        case 'uint':\n          gl.uniform1i(uniform, value);\n          break;\n        case 'float':\n          gl.uniform1f(uniform, value);\n      }\n      break;\n    case 'color':\n      gl.uniform3fv(uniform, value);\n      break;\n  }\n}\n\nexport function setControlsInShader(\n    gl: GL, shader: ShaderProgram, shaderControlState: ShaderControlState, controls: Controls) {\n  const {state} = shaderControlState;\n  if (shaderControlState.controls.value === controls) {\n    // Case when shader doesn't have any errors.\n    for (const [name, controlState] of state) {\n      setControlInShader(gl, shader, name, controlState.control, controlState.trackable.value);\n    }\n  } else {\n    // Case when shader does have errors and we are using the fallback shader, which may have a\n    // different/incompatible set of controls.\n    for (const [name, control] of controls) {\n      const controlState = state.get(name);\n      const value = (controlState !== undefined &&\n                     JSON.stringify(controlState.control) === JSON.stringify(control)) ?\n          controlState.trackable.value :\n          control.default;\n      setControlInShader(gl, shader, name, control, value);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Facilities for drawing spheres in WebGL\n */\n\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {Buffer, getMemoizedBuffer} from 'neuroglancer/webgl/buffer';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {ShaderBuilder, ShaderProgram} from 'neuroglancer/webgl/shader';\n\nexport function getSphereVertexArray(latitudeBands: number, longitudeBands: number) {\n  const result = new Float32Array((latitudeBands + 1) * (longitudeBands + 1) * 3);\n  let i = 0;\n  for (let latIndex = 0; latIndex <= latitudeBands; ++latIndex) {\n    const theta = latIndex * Math.PI / latitudeBands;\n    const sinTheta = Math.sin(theta);\n    const cosTheta = Math.cos(theta);\n    for (let lonIndex = 0; lonIndex <= longitudeBands; ++lonIndex) {\n      const phi = lonIndex * 2 * Math.PI / longitudeBands;\n      const sinPhi = Math.sin(phi);\n      const cosPhi = Math.cos(phi);\n      result[i++] = cosPhi * sinTheta;  // x\n      result[i++] = cosTheta;           // y\n      result[i++] = sinPhi * sinTheta;  // z\n    }\n  }\n  return result;\n}\n\nexport function getSphereIndexArray(latitudeBands: number, longitudeBands: number) {\n  const result = new Uint16Array(latitudeBands * longitudeBands * 6);\n  let i = 0;\n  for (let latIndex = 0; latIndex < latitudeBands; latIndex++) {\n    for (let lonIndex = 0; lonIndex < longitudeBands; lonIndex++) {\n      const first = (latIndex * (longitudeBands + 1)) + lonIndex;\n      const second = first + longitudeBands + 1;\n      result[i++] = first;\n      result[i++] = second;\n      result[i++] = first + 1;\n\n      result[i++] = second;\n      result[i++] = second + 1;\n      result[i++] = first + 1;\n    }\n  }\n  return result;\n}\n\nexport class SphereRenderHelper extends RefCounted {\n  private vertexBuffer: Buffer;\n  private indexBuffer: Buffer;\n  private numIndices: number;\n\n  constructor(gl: GL, latitudeBands: number, longitudeBands: number) {\n    super();\n    this.vertexBuffer =\n        this.registerDisposer(getMemoizedBuffer(\n                                  gl, WebGL2RenderingContext.ARRAY_BUFFER, getSphereVertexArray,\n                                  latitudeBands, longitudeBands))\n            .value;\n    this.indexBuffer =\n        this.registerDisposer(getMemoizedBuffer(\n                                  gl, WebGL2RenderingContext.ELEMENT_ARRAY_BUFFER,\n                                  getSphereIndexArray, latitudeBands, longitudeBands))\n            .value;\n    this.numIndices = latitudeBands * longitudeBands * 6;\n  }\n\n  defineShader(builder: ShaderBuilder) {\n    builder.addAttribute('highp vec3', 'aSphereVertex');\n    builder.addVarying('highp float', 'vLightingFactor');\n\n    // projectionMatrix = cameraMatrix * modelViewMat\n    // normalTransformMatrix = (modelViewMat^{-1})^T\n\n    // eff modelViewMat = modelViewMat * scalMat(radii)\n    // normalTransformMatrix =  (modelViewMat * scalMat)^{-1}^T\n    // =   (scalMat^{-1} * modelViewMat^{-1})^T\n    // =   modelViewMat^{-1}^T * (scalMat^{-1})^T\n    builder.addVertexCode(`\nvoid emitSphere(mat4 projectionMatrix, mat4 normalTransformMatrix, vec3 centerPosition, vec3 radii, vec4 lightDirection) {\n  vec3 vertexPosition = aSphereVertex * radii + centerPosition;\n  gl_Position = projectionMatrix * vec4(vertexPosition, 1.0);\n  vec3 normal = normalize((normalTransformMatrix * vec4(aSphereVertex / radii, 0.0)).xyz);\n  vLightingFactor = abs(dot(normal, uLightDirection.xyz)) + uLightDirection.w;\n}\n`);\n  }\n\n  draw(shader: ShaderProgram, numInstances: number) {\n    const aSphereVertex = shader.attribute('aSphereVertex');\n    this.vertexBuffer.bindToVertexAttrib(\n        aSphereVertex, /*components=*/3, /*attributeType=*/WebGL2RenderingContext.FLOAT,\n        /*normalized=*/false);\n    this.indexBuffer.bind();\n    shader.gl.drawElementsInstanced(\n        WebGL2RenderingContext.TRIANGLES, this.numIndices, WebGL2RenderingContext.UNSIGNED_SHORT,\n        /*offset=*/0, numInstances);\n    shader.gl.disableVertexAttribArray(aSphereVertex);\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {tile2dArray} from 'neuroglancer/util/array';\nimport {getMemoizedBuffer} from 'neuroglancer/webgl/buffer';\nimport {GL} from 'neuroglancer/webgl/context';\n\nexport function getSquareCornersArray(\n    startX = -1, startY = -1, endX = 1, endY = 1, minorTiles = 1, majorTiles = 1) {\n  return tile2dArray(\n      new Float32Array([\n        startX, startY,  //\n        startX, endY,    //\n        endX, endY,      //\n        endX, startY,    //\n      ]),\n      /*majorDimension=*/2, minorTiles, majorTiles);\n}\n\nexport function getCubeCornersArray(\n    startX = -1, startY = -1, startZ = -1, endX = 1, endY = 1, endZ = 1, minorTiles = 1,\n    majorTiles = 1) {\n  return tile2dArray(\n      new Float32Array([\n        startX, startY, startZ,  //\n        endX,   startY, startZ,  //\n        startX, endY,   startZ,  //\n        endX,   endY,   startZ,  //\n        startX, startY, endZ,    //\n        endX,   startY, endZ,    //\n        startX, endY,   endZ,    //\n        endX,   endY,   endZ,    //\n      ]),\n      /*majorDimension=*/3, minorTiles, majorTiles);\n}\n\nexport function getSquareCornersBuffer(\n    gl: GL, startX = -1, startY = -1, endX = 1, endY = 1, minorTiles = 1, majorTiles = 1) {\n  return getMemoizedBuffer(\n             gl, WebGL2RenderingContext.ARRAY_BUFFER, getSquareCornersArray, startX, startY, endX,\n             endY, minorTiles, majorTiles)\n      .value;\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {GL} from 'neuroglancer/webgl/context';\n\n/**\n * Sets parameters to make a texture suitable for use as a raw array: NEAREST\n * filtering, clamping.\n */\nexport function setRawTextureParameters(gl: WebGL2RenderingContext) {\n  gl.texParameteri(WebGL2RenderingContext.TEXTURE_2D, WebGL2RenderingContext.TEXTURE_MIN_FILTER, WebGL2RenderingContext.NEAREST);\n  gl.texParameteri(WebGL2RenderingContext.TEXTURE_2D, WebGL2RenderingContext.TEXTURE_MAG_FILTER, WebGL2RenderingContext.NEAREST);\n  // Prevents s-coordinate wrapping (repeating).  Repeating not\n  // permitted for non-power-of-2 textures.\n  gl.texParameteri(WebGL2RenderingContext.TEXTURE_2D, WebGL2RenderingContext.TEXTURE_WRAP_S, WebGL2RenderingContext.CLAMP_TO_EDGE);\n  // Prevents t-coordinate wrapping (repeating).  Repeating not\n  // permitted for non-power-of-2 textures.\n  gl.texParameteri(WebGL2RenderingContext.TEXTURE_2D, WebGL2RenderingContext.TEXTURE_WRAP_T, WebGL2RenderingContext.CLAMP_TO_EDGE);\n}\n\nexport function setRawTexture3DParameters(gl: WebGL2RenderingContext) {\n  gl.texParameteri(WebGL2RenderingContext.TEXTURE_3D, WebGL2RenderingContext.TEXTURE_MIN_FILTER, WebGL2RenderingContext.NEAREST);\n  gl.texParameteri(WebGL2RenderingContext.TEXTURE_3D, WebGL2RenderingContext.TEXTURE_MAG_FILTER, WebGL2RenderingContext.NEAREST);\n  // Prevents s-coordinate wrapping (repeating).  Repeating not\n  // permitted for non-power-of-2 textures.\n  gl.texParameteri(WebGL2RenderingContext.TEXTURE_3D, WebGL2RenderingContext.TEXTURE_WRAP_S, WebGL2RenderingContext.CLAMP_TO_EDGE);\n  // Prevents t-coordinate wrapping (repeating).  Repeating not\n  // permitted for non-power-of-2 textures.\n  gl.texParameteri(WebGL2RenderingContext.TEXTURE_3D, WebGL2RenderingContext.TEXTURE_WRAP_T, WebGL2RenderingContext.CLAMP_TO_EDGE);\n  gl.texParameteri(WebGL2RenderingContext.TEXTURE_3D, WebGL2RenderingContext.TEXTURE_WRAP_R, WebGL2RenderingContext.CLAMP_TO_EDGE);\n}\n\nexport function resizeTexture(\n    gl: GL, texture: WebGLTexture|null, width: number, height: number,\n    internalFormat: number = WebGL2RenderingContext.RGBA8, format: number = WebGL2RenderingContext.RGBA,\n    dataType: number = WebGL2RenderingContext.UNSIGNED_BYTE) {\n  gl.activeTexture(WebGL2RenderingContext.TEXTURE0 + gl.tempTextureUnit);\n  gl.bindTexture(WebGL2RenderingContext.TEXTURE_2D, texture);\n  setRawTextureParameters(gl);\n  gl.texImage2D(\n      WebGL2RenderingContext.TEXTURE_2D, 0,\n      /*internalformat=*/internalFormat,\n      /*width=*/width,\n      /*height=*/height,\n      /*border=*/0,\n      /*format=*/format, dataType, <any>null);\n  gl.bindTexture(WebGL2RenderingContext.TEXTURE_2D, null);\n}\n\nexport function setTextureFromCanvas(\n    gl: GL, texture: WebGLTexture|null, canvas: HTMLCanvasElement) {\n  gl.activeTexture(WebGL2RenderingContext.TEXTURE0 + gl.tempTextureUnit);\n  gl.bindTexture(WebGL2RenderingContext.TEXTURE_2D, texture);\n  gl.texParameteri(\n      WebGL2RenderingContext.TEXTURE_2D, WebGL2RenderingContext.TEXTURE_MIN_FILTER,\n      WebGL2RenderingContext.LINEAR);\n  gl.texParameteri(\n      WebGL2RenderingContext.TEXTURE_2D, WebGL2RenderingContext.TEXTURE_MAG_FILTER,\n      WebGL2RenderingContext.LINEAR);\n  // Prevents s-coordinate wrapping (repeating).  Repeating not permitted for non-power-of-2\n  // textures.\n  gl.texParameteri(\n      WebGL2RenderingContext.TEXTURE_2D, WebGL2RenderingContext.TEXTURE_WRAP_S,\n      WebGL2RenderingContext.CLAMP_TO_EDGE);\n  // Prevents t-coordinate wrapping (repeating).  Repeating not permitted for non-power-of-2\n  // textures.\n  gl.texParameteri(\n      WebGL2RenderingContext.TEXTURE_2D, WebGL2RenderingContext.TEXTURE_WRAP_T,\n      WebGL2RenderingContext.CLAMP_TO_EDGE);\n  gl.pixelStorei(WebGL2RenderingContext.UNPACK_FLIP_Y_WEBGL, 1);\n  gl.pixelStorei(WebGL2RenderingContext.UNPACK_ALIGNMENT, 4);\n  gl.texImage2D(\n      WebGL2RenderingContext.TEXTURE_2D, /*level=*/ 0,\n      /*internalformat=*/ WebGL2RenderingContext.RGBA8,\n      /*format=*/ WebGL2RenderingContext.RGBA, WebGL2RenderingContext.UNSIGNED_BYTE, canvas);\n  gl.pixelStorei(WebGL2RenderingContext.UNPACK_FLIP_Y_WEBGL, 0);\n  gl.bindTexture(WebGL2RenderingContext.TEXTURE_2D, null);\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file\n * Facilities for reading various data types from 2-D and 3-D WebGL textures.\n *\n * WebGL2 only supports 2-D and 3-D textures, and because implementations typically limit the size\n * of each dimension, a large 1-D array has to be fit to a rectangular 2-D texture, which may\n * require padding.\n */\n\nimport {maybePadArray, TypedArray, TypedArrayConstructor} from 'neuroglancer/util/array';\nimport {DataType} from 'neuroglancer/util/data_type';\nimport {vec3} from 'neuroglancer/util/geom';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {ShaderBuilder, ShaderCodePart, ShaderProgram, ShaderSamplerPrefix} from 'neuroglancer/webgl/shader';\nimport {getShaderType, glsl_float, glsl_uint16, glsl_uint32, glsl_uint64, glsl_uint8, glsl_unpackUint64leFromUint32} from 'neuroglancer/webgl/shader_lib';\nimport {setRawTexture3DParameters, setRawTextureParameters} from 'neuroglancer/webgl/texture';\n\nexport type TextureAccessCoefficients = vec3;\n\nexport class OneDimensionalTextureLayout {\n  /**\n   * The x index is computed as `(index & ((1 << textureXBits) - 1))`, while the y index is computed\n   * as `index >> textureXBits`.\n   */\n  textureXBits: number;\n  textureWidth: number;\n  textureHeight: number;\n}\n\nexport class TextureFormat {\n  /**\n   * Number of texels per multi-channel element.\n   */\n  texelsPerElement: number;\n\n  /**\n   * Texture internal format to specify when uploading the texture data.\n   */\n  textureInternalFormat: number;\n\n  /**\n   * Texture format to specify when uploading the texture data.\n   */\n  textureFormat: number;\n\n  /**\n   * Texel type to specify when uploading the texture data.\n   */\n  texelType: number;\n\n  /**\n   * Number of typed array elements per texel.\n   */\n  arrayElementsPerTexel: number;\n\n  /**\n   * TypedArray type that must be used when uploading the texture data.\n   */\n  arrayConstructor: TypedArrayConstructor;\n\n  samplerPrefix: ShaderSamplerPrefix;\n}\n\nexport const integerTextureFormatForNumComponents = [\n    -1,\n    WebGL2RenderingContext.RED_INTEGER,\n    WebGL2RenderingContext.RG_INTEGER,\n    WebGL2RenderingContext.RGB_INTEGER,\n    WebGL2RenderingContext.RGBA_INTEGER];\nexport const floatTextureFormatForNumComponents = [\n    -1,\n    WebGL2RenderingContext.RED,\n    WebGL2RenderingContext.RG,\n    WebGL2RenderingContext.RGB,\n    WebGL2RenderingContext.RGBA];\nexport const textureSelectorForNumComponents = ['', 'r', 'rg', 'rgb', 'rgba'];\nexport const internalUint8FormatForNumComponents = [\n    -1,\n    WebGL2RenderingContext.R8UI,\n    WebGL2RenderingContext.RG8UI,\n    WebGL2RenderingContext.RGB8UI,\n    WebGL2RenderingContext.RGBA8UI];\nexport const internalUint16FormatForNumComponents = [\n    -1,\n    WebGL2RenderingContext.R16UI,\n    WebGL2RenderingContext.RG16UI,\n    WebGL2RenderingContext.RGB16UI,\n    WebGL2RenderingContext.RGBA16UI];\nexport const internalUint32FormatForNumComponents = [\n    -1,\n    WebGL2RenderingContext.R32UI,\n    WebGL2RenderingContext.RG32UI,\n    WebGL2RenderingContext.RGB32UI,\n    WebGL2RenderingContext.RGBA32UI];\nexport const internalFloatFormatForNumComponents = [\n    -1,\n    WebGL2RenderingContext.R32F,\n    WebGL2RenderingContext.RG32F,\n    WebGL2RenderingContext.RGB32F,\n  WebGL2RenderingContext.RGBA32F];\n\nexport function getSamplerPrefixForDataType(dataType: DataType): ShaderSamplerPrefix {\n  return dataType === DataType.FLOAT32 ? '' : 'u';\n}\n\n/**\n * Fills in a OneDimensionalTextureFormat object with the suitable texture format for the specified\n * DataType and number of components.\n */\nexport function computeTextureFormat(\n    format: TextureFormat, dataType: DataType, numComponents: number = 1) {\n  switch (dataType) {\n    case DataType.UINT8:\n      if (numComponents < 1 || numComponents > 4) {\n        break;\n      }\n      format.texelsPerElement = 1;\n      format.textureInternalFormat = internalUint8FormatForNumComponents[numComponents];\n      format.textureFormat = integerTextureFormatForNumComponents[numComponents];\n      format.texelType = WebGL2RenderingContext.UNSIGNED_BYTE;\n      format.arrayElementsPerTexel = numComponents;\n      format.arrayConstructor = Uint8Array;\n      format.samplerPrefix = 'u';\n      return format;\n    case DataType.UINT16:\n      if (numComponents < 1 || numComponents > 4) {\n        break;\n      }\n      format.texelsPerElement = 1;\n      format.textureInternalFormat = internalUint16FormatForNumComponents[numComponents];\n      format.textureFormat = integerTextureFormatForNumComponents[numComponents];\n      format.texelType = WebGL2RenderingContext.UNSIGNED_SHORT;\n      format.arrayElementsPerTexel = numComponents;\n      format.arrayConstructor = Uint16Array;\n      format.samplerPrefix = 'u';\n      return format;\n    case DataType.UINT64:\n      if (numComponents < 1 || numComponents> 2) {\n        break;\n      }\n      format.texelsPerElement = 1;\n      format.textureInternalFormat = internalUint32FormatForNumComponents[numComponents * 2];\n      format.textureFormat = integerTextureFormatForNumComponents[numComponents * 2];\n      format.texelType = WebGL2RenderingContext.UNSIGNED_INT;\n      format.arrayElementsPerTexel = 2 * numComponents;\n      format.arrayConstructor = Uint32Array;\n      format.samplerPrefix = 'u';\n      return format;\n    case DataType.UINT32:\n      if (numComponents < 1 || numComponents > 4) {\n        break;\n      }\n      format.texelsPerElement = 1;\n      format.textureInternalFormat = internalUint32FormatForNumComponents[numComponents];\n      format.textureFormat = integerTextureFormatForNumComponents[numComponents];\n      format.texelType = WebGL2RenderingContext.UNSIGNED_INT;\n      format.arrayElementsPerTexel = 1;\n      format.arrayConstructor = Uint32Array;\n      format.samplerPrefix = 'u';\n      return format;\n    case DataType.FLOAT32:\n      if (numComponents < 1 || numComponents > 4) {\n        break;\n      }\n      format.texelsPerElement = 1;\n      format.textureInternalFormat = internalFloatFormatForNumComponents[numComponents];\n      format.textureFormat = floatTextureFormatForNumComponents[numComponents];\n      format.texelType = WebGL2RenderingContext.FLOAT;\n      format.arrayElementsPerTexel = numComponents;\n      format.arrayConstructor = Float32Array;\n      format.samplerPrefix = '';\n      return format;\n  }\n  throw new Error(`No supported texture format for ${DataType[dataType]}[${numComponents}].`);\n}\n\nexport function compute1dTextureLayout(\n    layout: OneDimensionalTextureLayout, gl: GL, texelsPerElement: number, numElements: number) {\n  const {maxTextureSize} = gl;\n  if (numElements * texelsPerElement > maxTextureSize * maxTextureSize) {\n    throw new Error(\n        'Number of elements exceeds maximum texture size: ' + texelsPerElement + ' * ' +\n        numElements);\n  }\n  const minX = Math.ceil(numElements / maxTextureSize);\n  const textureXBits = layout.textureXBits = Math.ceil(Math.log2(minX));\n  layout.textureWidth = (1 << textureXBits) * texelsPerElement;\n  layout.textureHeight = Math.ceil(numElements / (1 << textureXBits));\n}\n\nexport function setOneDimensionalTextureData(\n    gl: GL, textureLayout: OneDimensionalTextureLayout, format: TextureFormat, data: TypedArray) {\n  const {\n    arrayConstructor,\n    arrayElementsPerTexel,\n    textureInternalFormat,\n    textureFormat,\n  } = format;\n  const {textureWidth, textureHeight} = textureLayout;\n  const requiredSize = textureWidth * textureHeight * arrayElementsPerTexel;\n  if (data.constructor !== arrayConstructor) {\n    data = new arrayConstructor(\n        data.buffer, data.byteOffset, data.byteLength / arrayConstructor.BYTES_PER_ELEMENT);\n  }\n  let padded = maybePadArray(data, requiredSize);\n  gl.pixelStorei(WebGL2RenderingContext.UNPACK_ALIGNMENT, 1);\n  setRawTextureParameters(gl);\n  gl.texImage2D(\n      WebGL2RenderingContext.TEXTURE_2D,\n      /*level=*/0,textureInternalFormat,\n      /*width=*/textureWidth,\n      /*height=*/textureHeight,\n      /*border=*/0, textureFormat, format.texelType, padded);\n}\n\nexport function setThreeDimensionalTextureData(\n    gl: GL, format: TextureFormat, data: TypedArray, width: number, height: number, depth: number) {\n  const {\n    arrayConstructor,\n    textureInternalFormat,\n    textureFormat,\n    texelsPerElement,\n  } = format;\n  if (data.constructor !== arrayConstructor) {\n    data = new arrayConstructor(\n        data.buffer, data.byteOffset, data.byteLength / arrayConstructor.BYTES_PER_ELEMENT);\n  }\n  gl.pixelStorei(WebGL2RenderingContext.UNPACK_ALIGNMENT, 1);\n  setRawTexture3DParameters(gl);\n  gl.texImage3D(\n      WebGL2RenderingContext.TEXTURE_3D,\n      /*level=*/ 0, textureInternalFormat,\n      /*width=*/ width * texelsPerElement,\n      /*height=*/ height,\n      /*depth=*/ depth,\n      /*border=*/ 0, textureFormat, format.texelType, data);\n}\n\nfunction getShaderCodeForDataType(dataType: DataType): ShaderCodePart {\n  switch (dataType) {\n    case DataType.UINT8:\n      return glsl_uint8;\n    case DataType.UINT16:\n      return glsl_uint16;\n    case DataType.UINT32:\n      return glsl_uint32;\n    case DataType.UINT64:\n      return glsl_uint64;\n    case DataType.FLOAT32:\n      return glsl_float;\n  }\n}\n\nfunction getAccessorFunction(\n    functionName: string, readTextureValue: string, samplerName: string, indexType: string,\n    dataType: DataType, numComponents: number): ShaderCodePart[] {\n  const shaderType = getShaderType(dataType, numComponents);\n  let parts: ShaderCodePart[] = [getShaderCodeForDataType(dataType)];\n  let code = `\n${shaderType} ${functionName}(${indexType} index) {\n`;\n  switch (dataType) {\n    case DataType.UINT8:\n    case DataType.UINT16:\n    case DataType.UINT32:\n      code += `\n  ${shaderType} result;\n  highp uvec4 temp;\n  ${readTextureValue}(${samplerName}, index, temp);\n  result.value = temp.${textureSelectorForNumComponents[numComponents]};\n  return result;\n`;\n      break;\n    case DataType.UINT64:\n      parts.push(glsl_unpackUint64leFromUint32);\n      code += `\n  highp uvec4 temp;\n  ${readTextureValue}(${samplerName}, index, temp);\n  return unpackUint64leFromUint32(temp.${\n          textureSelectorForNumComponents[numComponents * 2]});\n`;\n      break;\n    case DataType.FLOAT32:\n      parts.push(glsl_float);\n      code += `\n  highp vec4 temp;\n  ${readTextureValue}(${samplerName}, index, temp);\n  return temp.${textureSelectorForNumComponents[numComponents]};\n`;\n      break;\n  }\n  code += `\n}\n`;\n  parts.push(code);\n  return parts;\n}\n\nexport class OneDimensionalTextureAccessHelper {\n  uniformName = `uTextureXBits_${this.key}`;\n  readTextureValue = `readTextureValue_${this.key}`;\n  constructor(public key: string) {}\n  defineShader(builder: ShaderBuilder) {\n    let {uniformName} = this;\n    builder.addUniform('highp uint', uniformName);\n  }\n\n  getReadTextureValueCode(texelsPerElement: number, samplerPrefix: ShaderSamplerPrefix) {\n    let {uniformName} = this;\n    let code = `\nvoid ${this.readTextureValue}(highp ${samplerPrefix}sampler2D sampler, highp uint index`;\n    for (let i = 0; i < texelsPerElement; ++i) {\n      code += `, out ${samplerPrefix}vec4 output${i}`;\n    }\n    code += `) {\n\n  highp int y = int(index >> ${uniformName});\n  highp int x = int((index - (uint(y) << ${uniformName})) * ${texelsPerElement}u);\n`;\n    for (let i = 0; i < texelsPerElement; ++i) {\n      code += `\n  output${i} = texelFetch(sampler, ivec2(x + ${i}, y), 0);\n`;\n    }\n    code += `\n}\n`;\n    return code;\n  }\n\n  getAccessor(\n      functionName: string, samplerName: string, dataType: DataType, numComponents: number = 1) {\n    const samplerPrefix = getSamplerPrefixForDataType(dataType);\n    return [\n      this.getReadTextureValueCode(1, samplerPrefix),\n      ...getAccessorFunction(\n          functionName, this.readTextureValue, samplerName, 'highp uint', dataType, numComponents)\n    ];\n  }\n\n  setupTextureLayout(gl: GL, shader: ShaderProgram, textureLayout: OneDimensionalTextureLayout) {\n    gl.uniform1ui(shader.uniform(this.uniformName), textureLayout.textureXBits);\n  }\n}\n\nexport class ThreeDimensionalTextureAccessHelper {\n  readTextureValue = `readTextureValue_${this.key}`;\n  constructor(public key: string) {}\n  getReadTextureValueCode(texelsPerElement: number, samplerPrefix: ShaderSamplerPrefix) {\n    let code = `\nvoid ${this.readTextureValue}(highp ${samplerPrefix}sampler3D sampler, highp ivec3 p`;\n    for (let i = 0; i < texelsPerElement; ++i) {\n      code += `, out ${samplerPrefix}vec4 output${i}`;\n    }\n    code += `) {\n`;\n    for (let i = 0; i < texelsPerElement; ++i) {\n      code += `\n  output${i} = texelFetch(sampler, ivec3(p.x * ${texelsPerElement} + ${i}, p.y, p.z), 0);\n`;\n    }\n    code += `\n}\n`;\n    return code;\n  }\n\n  getAccessor(\n      functionName: string, samplerName: string, dataType: DataType, numComponents: number = 1) {\n    const samplerPrefix = getSamplerPrefixForDataType(dataType);\n    return [\n      this.getReadTextureValueCode(1, samplerPrefix),\n      ...getAccessorFunction(\n          functionName, this.readTextureValue, samplerName, 'highp ivec3', dataType, numComponents)\n    ];\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {getObjectId} from 'neuroglancer/util/object_id';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {ShaderBuilder, ShaderModule, ShaderProgram} from 'neuroglancer/webgl/shader';\n\nexport function defineCopyFragmentShader(builder: ShaderBuilder) {\n  builder.addOutputBuffer('vec4', 'v4f_fragColor', null);\n  builder.setFragmentMain('v4f_fragColor = getValue0();');\n}\n\nexport function elementWiseTextureShader(\n    gl: GL, shaderModule: ShaderModule = defineCopyFragmentShader,\n    numTextures: number = 1): ShaderProgram {\n  return gl.memoize.get(\n      `elementWiseTextureShader:${numTextures}:${getObjectId(shaderModule)}`, () => {\n        let builder = new ShaderBuilder(gl);\n        builder.addVarying('vec2', 'vTexCoord');\n        builder.addUniform('sampler2D', 'uSampler', numTextures);\n        builder.addInitializer(shader => {\n          let textureIndices: number[] = [];\n          for (let i = 0; i < numTextures; ++i) {\n            textureIndices[i] = i;\n          }\n          gl.uniform1iv(shader.uniform('uSampler'), textureIndices);\n        });\n        for (let i = 0; i < numTextures; ++i) {\n          builder.addFragmentCode(`\nvec4 getValue${i}() {\n  return texture(uSampler[${i}], vTexCoord);\n}\n`);\n        }\n        builder.addUniform('mat4', 'uProjectionMatrix');\n        builder.require(shaderModule);\n        builder.addAttribute('vec4', 'aVertexPosition');\n        builder.addAttribute('vec2', 'aTexCoord');\n        builder.setVertexMain(\n            'vTexCoord = aTexCoord; gl_Position = uProjectionMatrix * aVertexPosition;');\n        return builder.build();\n      });\n}\n\nexport function trivialTextureShader(gl: GL): ShaderProgram {\n  return elementWiseTextureShader(gl, defineCopyFragmentShader, 1);\n}\n\nexport function trivialColorShader(gl: GL): ShaderProgram {\n  return gl.memoize.get('trivialColorShader', () => {\n    let builder = new ShaderBuilder(gl);\n    builder.addVarying('vec4', 'vColor');\n    builder.addOutputBuffer('vec4', 'v4f_fragColor', null);\n    builder.setFragmentMain('v4f_fragColor = vColor;');\n    builder.addAttribute('vec4', 'aVertexPosition');\n    builder.addAttribute('vec4', 'aColor');\n    builder.addUniform('mat4', 'uProjectionMatrix');\n    builder.setVertexMain('vColor = aColor; gl_Position = uProjectionMatrix * aVertexPosition;');\n    return builder.build();\n  });\n}\n\nexport function trivialUniformColorShader(gl: GL): ShaderProgram {\n  return gl.memoize.get('trivialUniformColorShader', () => {\n    let builder = new ShaderBuilder(gl);\n    builder.addUniform('mat4', 'uProjectionMatrix');\n    builder.addAttribute('vec4', 'aVertexPosition');\n    builder.addUniform('vec4', 'uColor');\n    builder.addOutputBuffer('vec4', 'v4f_fragColor', null);\n    builder.setFragmentMain('v4f_fragColor = uColor;');\n    builder.setVertexMain('gl_Position = uProjectionMatrix * aVertexPosition;');\n    return builder.build();\n  });\n}\n","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport './annotation_tool_status.css';\n\nimport {SelectedLayerState} from 'neuroglancer/layer';\nimport {RefCounted} from 'neuroglancer/util/disposable';\n\nexport class AnnotationToolStatusWidget extends RefCounted {\n  element = document.createElement('div');\n  private unbindPreviousLayer: (() => void)|undefined;\n\n  constructor(public selectedLayer: SelectedLayerState) {\n    super();\n    const {element} = this;\n    element.className = 'neuroglancer-annotation-tool-status-widget';\n    this.registerDisposer(selectedLayer.changed.add(() => this.selectedLayerChanged()));\n    this.selectedLayerChanged();\n  }\n\n  private selectedLayerChanged() {\n    let {unbindPreviousLayer} = this;\n    if (unbindPreviousLayer !== undefined) {\n      unbindPreviousLayer();\n    }\n    const layer = this.selectedLayer.layer;\n    if (layer !== undefined) {\n      this.unbindPreviousLayer = layer.specificationChanged.add(() => {\n        this.updateView();\n      });\n    }\n    this.updateView();\n  }\n\n  disposed() {\n    const {unbindPreviousLayer} = this;\n    if (unbindPreviousLayer !== undefined) {\n      unbindPreviousLayer();\n    }\n    this.unbindPreviousLayer = undefined;\n  }\n\n  private getDescriptionText(): string|undefined {\n    const layer = this.selectedLayer.layer;\n    if (layer === undefined) {\n      return undefined;\n    }\n    const userLayer = layer.layer;\n    if (userLayer === null) {\n      return undefined;\n    }\n    const tool = userLayer.tool.value;\n    if (tool === undefined) {\n      return undefined;\n    }\n    return tool.description;\n  }\n\n  private updateView() {\n    this.element.textContent = this.getDescriptionText() || '';\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nlet nextElementId = 0;\n\nexport function associateLabelWithElement(label: HTMLLabelElement, element: HTMLInputElement) {\n  if (element.id === '') {\n    element.id = `unique-id-for-association-${nextElementId++}`;\n  }\n  label.setAttribute('for', element.id);\n}\n","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport debounce from 'lodash/debounce';\nimport {CancellationToken, CancellationTokenSource} from 'neuroglancer/util/cancellation';\nimport {BasicCompletionResult, Completion, CompletionWithDescription} from 'neuroglancer/util/completion';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {removeChildren, removeFromParent} from 'neuroglancer/util/dom';\nimport {positionDropdown} from 'neuroglancer/util/dropdown';\nimport {EventActionMap, KeyboardEventBinder, registerActionListener} from 'neuroglancer/util/keyboard_bindings';\nimport {longestCommonPrefix} from 'neuroglancer/util/longest_common_prefix';\nimport {scrollIntoViewIfNeeded} from 'neuroglancer/util/scroll_into_view';\nimport {Signal} from 'neuroglancer/util/signal';\nimport {associateLabelWithElement} from 'neuroglancer/widget/associate_label';\n\nexport {Completion, CompletionWithDescription} from 'neuroglancer/util/completion';\n\nimport './autocomplete.css';\n\nconst ACTIVE_COMPLETION_CLASS_NAME = 'autocomplete-completion-active';\n\nconst AUTOCOMPLETE_INDEX_SYMBOL = Symbol('autocompleteIndex');\n\nexport interface CompletionResult extends BasicCompletionResult {\n  showSingleResult?: boolean;\n  selectSingleResult?: boolean;\n  makeElement?: (completion: Completion) => HTMLElement;\n}\n\nexport function makeDefaultCompletionElement(completion: Completion) {\n  let element = document.createElement('div');\n  element.textContent = completion.value;\n  return element;\n}\n\nexport function makeCompletionElementWithDescription(completion: CompletionWithDescription) {\n  let element = document.createElement('div');\n  element.className = 'autocomplete-completion-with-description';\n  element.textContent = completion.value;\n  let descriptionElement = document.createElement('div');\n  descriptionElement.className = 'autocomplete-completion-description';\n  descriptionElement.textContent = completion.description || '';\n  element.appendChild(descriptionElement);\n  return element;\n}\n\nconst keyMap = EventActionMap.fromObject({\n  'arrowdown': {action: 'cycle-next-active-completion'},\n  'arrowup': {action: 'cycle-prev-active-completion'},\n  'tab': {action: 'choose-active-completion-or-prefix', preventDefault: false},\n  'enter': {action: 'choose-active-completion', preventDefault: false},\n  'escape': {action: 'cancel', preventDefault: false, stopPropagation: false},\n});\n\n\nexport type Completer = (value: string, cancellationToken: CancellationToken) =>\n    Promise<CompletionResult>| null;\n\nconst DEFAULT_COMPLETION_DELAY = 200;  // milliseconds\n\nexport class AutocompleteTextInput extends RefCounted {\n  element: HTMLDivElement;\n  promptElement: HTMLLabelElement;\n  inputWrapperElement: HTMLDivElement;\n  inputElement: HTMLInputElement;\n  hintElement: HTMLInputElement;\n  dropdownElement: HTMLDivElement;\n  inputChanged = new Signal<(value: string) => void>();\n  private prevInputValue = '';\n  private completionsVisible = false;\n  private activeCompletionPromise: Promise<CompletionResult>|null = null;\n  private activeCompletionCancellationToken: CancellationTokenSource|undefined = undefined;\n  private hasFocus = false;\n  private completionResult: CompletionResult|null = null;\n  private dropdownContentsStale = true;\n  private updateHintScrollPositionTimer: number|null = null;\n  private completionElements: HTMLElement[]|null = null;\n  private hasResultForDropdown = false;\n  private commonPrefix = '';\n\n  /**\n   * Index of the active completion.  The active completion is displayed as the hint text and is\n   * highlighted in the dropdown.\n   */\n  private activeIndex = -1;\n\n  private dropdownStyleStale = true;\n\n  private scheduleUpdateCompletions: () => void;\n  completer: Completer;\n\n  constructor(options: {completer: Completer, delay?: number}) {\n    super();\n    this.completer = options.completer;\n    let {delay = DEFAULT_COMPLETION_DELAY} = options;\n\n    let debouncedCompleter = this.scheduleUpdateCompletions = debounce(() => {\n      const cancellationToken = this.activeCompletionCancellationToken =\n          new CancellationTokenSource();\n      let activeCompletionPromise = this.activeCompletionPromise =\n          this.completer(this.value, cancellationToken);\n      if (activeCompletionPromise !== null) {\n        activeCompletionPromise.then(completionResult => {\n          if (this.activeCompletionPromise === activeCompletionPromise) {\n            this.setCompletions(completionResult);\n            this.activeCompletionPromise = null;\n          }\n        });\n      }\n    }, delay);\n    this.registerDisposer(() => {\n      debouncedCompleter.cancel();\n    });\n\n    let element = this.element = document.createElement('div');\n    element.className = 'autocomplete';\n\n    let dropdownAndInputWrapper = document.createElement('div');\n    dropdownAndInputWrapper.className = 'autocomplete-dropdown-wrapper';\n\n    let dropdownElement = this.dropdownElement = document.createElement('div');\n    dropdownElement.className = 'autocomplete-dropdown';\n\n    let promptElement = this.promptElement = document.createElement('label');\n    promptElement.className = 'autocomplete-prompt';\n\n    let inputWrapperElement = this.inputWrapperElement = document.createElement('div');\n    inputWrapperElement.className = 'autocomplete-input-wrapper';\n\n    element.appendChild(promptElement);\n\n    let inputElement = this.inputElement = document.createElement('input');\n    inputElement.type = 'text';\n    inputElement.autocomplete = 'off';\n    inputElement.spellcheck = false;\n    inputElement.className = 'autocomplete-input';\n    associateLabelWithElement(promptElement, inputElement);\n\n    let hintElement = this.hintElement = document.createElement('input');\n    hintElement.type = 'text';\n    hintElement.spellcheck = false;\n    hintElement.className = 'autocomplete-hint';\n    hintElement.disabled = true;\n    inputWrapperElement.appendChild(hintElement);\n    inputWrapperElement.appendChild(inputElement);\n\n    dropdownAndInputWrapper.appendChild(inputWrapperElement);\n    dropdownAndInputWrapper.appendChild(dropdownElement);\n    element.appendChild(dropdownAndInputWrapper);\n\n    this.registerInputHandler();\n    this.handleInputChanged('');\n\n    this.registerEventListener(this.inputElement, 'focus', () => {\n      if (!this.hasFocus) {\n        this.hasFocus = true;\n        this.dropdownStyleStale = true;\n        this.updateDropdown();\n      }\n    });\n    this.registerEventListener(this.inputElement, 'blur', () => {\n      if (this.hasFocus) {\n        this.hasFocus = false;\n        this.updateDropdown();\n      }\n    });\n    this.registerEventListener(element.ownerDocument!.defaultView!, 'resize', () => {\n      this.dropdownStyleStale = true;\n    });\n\n    this.registerEventListener(element.ownerDocument!.defaultView!, 'scroll', () => {\n      this.dropdownStyleStale = true;\n    });\n\n    this.registerEventListener(\n        this.dropdownElement, 'mousedown', this.handleDropdownMousedown.bind(this));\n\n    this.registerEventListener(this.inputElement, 'keydown', () => {\n      // User may have used a keyboard shortcut to scroll the input.\n      this.hintScrollPositionMayBeStale();\n    });\n\n    this.registerEventListener(this.inputElement, 'mousemove', (event: MouseEvent) => {\n      if (event.buttons !== 0) {\n        // May be dragging the text, which could cause scrolling.  This is not perfect, because we\n        // don't detect mouse movements outside of the input box.\n        this.hintScrollPositionMayBeStale();\n      }\n    });\n\n    const keyboardHandler = this.registerDisposer(new KeyboardEventBinder(inputElement, keyMap));\n    keyboardHandler.allShortcutsAreGlobal = true;\n\n    registerActionListener(inputElement, 'cycle-next-active-completion', () => {\n      this.cycleActiveCompletion(+1);\n    });\n\n    registerActionListener(inputElement, 'cycle-prev-active-completion', () => {\n      this.cycleActiveCompletion(-1);\n    });\n\n    registerActionListener(\n        inputElement, 'choose-active-completion-or-prefix', (event: CustomEvent) => {\n          if (this.selectActiveCompletion(/*allowPrefix=*/true)) {\n            event.preventDefault();\n          }\n        });\n    registerActionListener(inputElement, 'choose-active-completion', (event: CustomEvent) => {\n      if (this.selectActiveCompletion(/*allowPrefix=*/false)) {\n        event.preventDefault();\n      }\n    });\n    registerActionListener(inputElement, 'cancel', (event: CustomEvent) => {\n      event.stopPropagation();\n      if (this.cancel()) {\n        event.detail.preventDefault();\n        event.detail.stopPropagation();\n      }\n    });\n  }\n\n  private hintScrollPositionMayBeStale() {\n    if (this.hintElement.value !== '') {\n      this.scheduleUpdateHintScrollPosition();\n    }\n  }\n\n  get disabled() {\n    return this.inputElement.readOnly;\n  }\n\n  set disabled(value: boolean) {\n    this.inputElement.readOnly = value;\n  }\n\n  private handleDropdownMousedown(event: MouseEvent) {\n    this.inputElement.focus();\n    let {dropdownElement} = this;\n    for (let target: EventTarget|null = event.target; target instanceof HTMLElement;\n         target = target.parentElement) {\n      let index = (<any>target)[AUTOCOMPLETE_INDEX_SYMBOL];\n      if (index !== undefined) {\n        this.selectCompletion(index);\n        break;\n      }\n      if (target === dropdownElement) {\n        break;\n      }\n    }\n    event.preventDefault();\n  }\n\n  cycleActiveCompletion(delta: number) {\n    if (this.completionResult === null) {\n      return;\n    }\n    let {activeIndex} = this;\n    let numCompletions = this.completionResult.completions.length;\n    if (activeIndex === -1) {\n      if (delta > 0) {\n        activeIndex = 0;\n      } else {\n        activeIndex = numCompletions - 1;\n      }\n    } else {\n      activeIndex = (activeIndex + delta + numCompletions) % numCompletions;\n    }\n    this.setActiveIndex(activeIndex);\n  }\n\n  private registerInputHandler() {\n    const handler = (_event: Event) => {\n      let value = this.inputElement.value;\n      if (value !== this.prevInputValue) {\n        this.prevInputValue = value;\n        this.handleInputChanged(value);\n      }\n    };\n    for (let eventType of ['input']) {\n      this.registerEventListener(this.inputElement, eventType, handler, /*useCapture=*/false);\n    }\n  }\n\n  private shouldShowDropdown() {\n    let {completionResult} = this;\n    if (completionResult === null || !this.hasFocus) {\n      return false;\n    }\n    return this.hasResultForDropdown;\n  }\n\n  private updateDropdownStyle() {\n    let {dropdownElement, inputElement} = this;\n    positionDropdown(dropdownElement, inputElement, {horizontal: false});\n    this.dropdownStyleStale = false;\n  }\n\n  private updateDropdown() {\n    if (this.shouldShowDropdown()) {\n      let {dropdownElement} = this;\n      let {activeIndex} = this;\n      if (this.dropdownContentsStale) {\n        let completionResult = this.completionResult!;\n        let {makeElement = makeDefaultCompletionElement} = completionResult;\n        this.completionElements = completionResult.completions.map((completion, index) => {\n          let completionElement = makeElement.call(completionResult, completion);\n          (<any>completionElement)[AUTOCOMPLETE_INDEX_SYMBOL] = index;\n          completionElement.classList.add('autocomplete-completion');\n          if (activeIndex === index) {\n            completionElement.classList.add(ACTIVE_COMPLETION_CLASS_NAME);\n          }\n          dropdownElement.appendChild(completionElement);\n          return completionElement;\n        });\n        this.dropdownContentsStale = false;\n      }\n      if (this.dropdownStyleStale) {\n        this.updateDropdownStyle();\n      }\n      if (!this.completionsVisible) {\n        dropdownElement.style.display = 'block';\n        this.completionsVisible = true;\n      }\n      if (activeIndex !== -1) {\n        let completionElement = this.completionElements![activeIndex];\n        scrollIntoViewIfNeeded(completionElement);\n      }\n    } else if (this.completionsVisible) {\n      this.dropdownElement.style.display = 'none';\n      this.completionsVisible = false;\n    }\n  }\n\n  private setCompletions(completionResult: CompletionResult) {\n    this.clearCompletions();\n    let {completions} = completionResult;\n    if (completions.length === 0) {\n      return;\n    }\n    this.completionResult = completionResult;\n\n    if (completions.length === 1) {\n      let completion = completions[0];\n      if (completionResult.showSingleResult) {\n        this.hasResultForDropdown = true;\n      } else {\n        let value = this.prevInputValue;\n        if (!completion.value.startsWith(value)) {\n          this.hasResultForDropdown = true;\n        } else {\n          this.hasResultForDropdown = false;\n        }\n      }\n      if (completionResult.selectSingleResult) {\n        this.setActiveIndex(0);\n      } else {\n        this.setHintValue(this.getCompletedValueByIndex(0));\n      }\n    } else {\n      this.hasResultForDropdown = true;\n      // Check for a common prefix.\n      let commonResultPrefix = longestCommonPrefix(function*() {\n        for (let completion of completionResult.completions) {\n          yield completion.value;\n        }\n      }());\n      let commonPrefix = this.getCompletedValue(commonResultPrefix);\n      let value = this.prevInputValue;\n      if (commonPrefix.startsWith(value)) {\n        this.commonPrefix = commonPrefix;\n        this.setHintValue(commonPrefix);\n      }\n    }\n    this.updateDropdown();\n  }\n\n  private scheduleUpdateHintScrollPosition() {\n    if (this.updateHintScrollPositionTimer === null) {\n      this.updateHintScrollPositionTimer = setTimeout(() => {\n        this.updateHintScrollPosition();\n      }, 0);\n    }\n  }\n\n  setHintValue(hintValue: string) {\n    let value = this.prevInputValue;\n    if (hintValue === value || !hintValue.startsWith(value)) {\n      // If the hint value is identical to the current value, there is no need to show it.  Also,\n      // if it is not a prefix of the current value, then we cannot show it either.\n      hintValue = '';\n    }\n    this.hintElement.value = hintValue;\n    this.scheduleUpdateHintScrollPosition();\n  }\n\n  /**\n   * This sets the active completion, which causes it to be highlighted and displayed as the hint.\n   * Additionally, if the user hits tab then it is chosen.\n   */\n  private setActiveIndex(index: number) {\n    if (!this.dropdownContentsStale) {\n      let {activeIndex} = this;\n      if (activeIndex !== -1) {\n        this.completionElements![activeIndex].classList.remove(ACTIVE_COMPLETION_CLASS_NAME);\n      }\n      if (index !== -1) {\n        let completionElement = this.completionElements![index];\n        completionElement.classList.add(ACTIVE_COMPLETION_CLASS_NAME);\n        scrollIntoViewIfNeeded(completionElement);\n      }\n    }\n    if (index !== -1) {\n      this.setHintValue(this.getCompletedValueByIndex(index));\n    }\n    this.activeIndex = index;\n  }\n\n  private getCompletedValueByIndex(index: number) {\n    return this.getCompletedValue(this.completionResult!.completions[index].value);\n  }\n\n  private getCompletedValue(completionValue: string) {\n    let completionResult = this.completionResult!;\n    let value = this.prevInputValue;\n    return value.substring(0, completionResult.offset) + completionValue;\n  }\n\n  selectActiveCompletion(allowPrefix: boolean) {\n    let {activeIndex} = this;\n    if (activeIndex === -1) {\n      if (!allowPrefix) {\n        return false;\n      }\n      let {completionResult} = this;\n      if (completionResult !== null && completionResult.completions.length === 1) {\n        activeIndex = 0;\n      } else {\n        let {commonPrefix} = this;\n        if (commonPrefix.length > this.value.length) {\n          this.value = commonPrefix;\n          return true;\n        }\n        return false;\n      }\n    }\n    let newValue = this.getCompletedValueByIndex(activeIndex);\n    if (this.value === newValue) {\n      return false;\n    }\n    this.value = newValue;\n    return true;\n  }\n\n  selectCompletion(index: number) {\n    this.value = this.getCompletedValueByIndex(index);\n  }\n\n  /**\n   * Called when user presses escape.  Does nothing here, but may be overridden in a subclass.\n   */\n  cancel() {\n    return false;\n  }\n\n  /**\n   * Updates the hintElement scroll position to match the scroll position of inputElement.\n   *\n   * This is called asynchronously after the input changes because automatic scrolling appears to\n   * take place after the 'input' event fires.\n   */\n  private updateHintScrollPosition() {\n    this.updateHintScrollPositionTimer = null;\n    this.hintElement.scrollLeft = this.inputElement.scrollLeft;\n  }\n\n  private cancelActiveCompletion() {\n    const token = this.activeCompletionCancellationToken;\n    if (token !== undefined) {\n      token.cancel();\n    }\n    this.activeCompletionCancellationToken = undefined;\n    this.activeCompletionPromise = null;\n  }\n\n  private handleInputChanged(value: string) {\n    this.cancelActiveCompletion();\n    this.hintElement.value = '';\n    this.clearCompletions();\n    this.inputChanged.dispatch(value);\n    this.scheduleUpdateCompletions();\n  }\n\n  private clearCompletions() {\n    if (this.completionResult !== null) {\n      this.activeIndex = -1;\n      this.completionResult = null;\n      this.completionElements = null;\n      this.dropdownContentsStale = true;\n      this.dropdownStyleStale = true;\n      this.commonPrefix = '';\n      removeChildren(this.dropdownElement);\n      this.updateDropdown();\n    }\n  }\n\n  get value() {\n    return this.prevInputValue;\n  }\n\n  set value(value: string) {\n    if (value !== this.prevInputValue) {\n      this.inputElement.value = value;\n      this.prevInputValue = value;\n      this.handleInputChanged(value);\n    }\n  }\n\n  disposed() {\n    removeFromParent(this.element);\n    this.cancelActiveCompletion();\n    if (this.updateHintScrollPositionTimer !== null) {\n      clearTimeout(this.updateHintScrollPositionTimer);\n      this.updateHintScrollPositionTimer = null;\n    }\n    super.disposed();\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {makeTextIconButton} from 'neuroglancer/widget/text_icon_button';\n\nexport function makeCloseButton() {\n  return makeTextIconButton('');\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {TrackableRGB} from 'neuroglancer/util/color';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {removeFromParent} from 'neuroglancer/util/dom';\n\nexport class ColorWidget extends RefCounted {\n  element = document.createElement('input');\n\n  constructor(public model: TrackableRGB) {\n    super();\n    const {element} = this;\n    element.classList.add('neuroglancer-color-widget');\n    element.type = 'color';\n    element.addEventListener('change', () => this.updateModel());\n    this.registerDisposer(model.changed.add(() => this.updateView()));\n    this.updateView();\n  }\n  private updateView() {\n    this.element.value = this.model.toString();\n  }\n  private updateModel() {\n    this.model.restoreState(this.element.value);\n  }\n\n  disposed() {\n    removeFromParent(this.element);\n    super.disposed();\n  }\n}\n","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Tab for updating a coordinate transform.\n */\n\nimport './coordinate_transform.css';\n\nimport {CoordinateTransform} from 'neuroglancer/coordinate_transform';\nimport {float32ToString} from 'neuroglancer/util/float32_to_string';\nimport {Tab} from 'neuroglancer/widget/tab_view';\n\nexport class CoordinateTransformTab extends Tab {\n  private textArea = document.createElement('textarea');\n  private modelGeneration = -1;\n  constructor(public transform: CoordinateTransform) {\n    super();\n    const {element} = this;\n    element.classList.add('neuroglancer-coordinate-transform-widget');\n    const {textArea} = this;\n    const textAreaLabel = document.createElement('label');\n    textAreaLabel.className = 'neuroglancer-coordinate-transform-widget-homogeneous';\n    textAreaLabel.textContent = '34 Homogeneous transformation matrix';\n    textAreaLabel.appendChild(textArea);\n    element.appendChild(textAreaLabel);\n    this.registerDisposer(transform.changed.add(() => this.updateView()));\n    this.registerDisposer(this.visibility.changed.add(() => this.updateView()));\n    textArea.addEventListener('change', () => this.updateModel());\n    textArea.addEventListener('blur', () => this.updateModel());\n    textArea.title = 'Homogeneous transformation matrix';\n    textArea.rows = 3;\n    const resetButton = document.createElement('button');\n    resetButton.textContent = 'Reset to identity';\n    resetButton.addEventListener('click', () => this.transform.reset());\n    element.appendChild(resetButton);\n    this.updateView();\n  }\n\n  private updateView() {\n    if (!this.visible) {\n      return;\n    }\n    const generation = this.transform.changed.count;\n    if (this.modelGeneration !== generation) {\n      let value = '';\n      const {transform} = this.transform;\n      for (let i = 0; i < 3; ++i) {\n        if (i !== 0) {\n          value += '\\n';\n        }\n        for (let j = 0; j < 4; ++j) {\n          const x = transform[j * 4 + i];\n          if (j !== 0) {\n            value += ' ';\n          }\n          value += float32ToString(x);\n        }\n      }\n      this.textArea.value = value;\n      this.modelGeneration = generation;\n    }\n  }\n\n  private updateModel() {\n    const parts = this.textArea.value.split(/[\\s,\\[\\]\\(\\)\\{\\}]/).filter(x => x.length > 0);\n    if (parts.length === 12) {\n      const numbers: number[] = [];\n      for (let i = 0; i < 12; ++i) {\n        const n = parseFloat(parts[i]);\n        if (Number.isNaN(n)) {\n          return false;\n        }\n        numbers[i] = n;\n      }\n      const {transform} = this.transform;\n      transform[3] = transform[7] = transform[10] = 0;\n      transform[15] = 1;\n      for (let i = 0; i < 4; ++i) {\n        for (let j = 0; j < 3; ++j) {\n          transform[i * 4 + j] = numbers[i + j * 4];\n        }\n      }\n      this.transform.changed.dispatch();\n      return true;\n    }\n    return false;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {TrackableEnum} from 'neuroglancer/util/trackable_enum';\nimport {RefCounted} from 'neuroglancer/util/disposable';\n\nexport class EnumSelectWidget<T extends number> extends RefCounted {\n  element = document.createElement('select');\n  private valueIndexMap = new Map<T, number>();\n  constructor (public model: TrackableEnum<T>) {\n    super();\n    const {element, valueIndexMap} = this;\n    let index = 0;\n    for (const key of Object.keys(model.enumType)) {\n      if (isNaN(Number(key))) {\n        const option = document.createElement('option');\n        option.textContent = option.value = key.toLowerCase();\n        element.appendChild(option);\n        valueIndexMap.set(model.enumType[key], index);\n        ++index;\n      }\n    }\n    this.registerDisposer(model.changed.add(() => this.updateView()));\n    this.registerEventListener(element, 'change', () => this.updateModel());\n    this.registerEventListener(element, 'wheel', (event: WheelEvent) => {\n      let {deltaY} = event;\n      if (deltaY > 0) {\n        element.selectedIndex =\n            (element.options.length + element.selectedIndex - 1) % element.options.length;\n        this.updateModel();\n      } else if (deltaY < 0) {\n        element.selectedIndex =\n            (element.options.length + element.selectedIndex + 1) % element.options.length;\n        this.updateModel();\n      }\n    });\n    this.updateView();\n  }\n\n  private updateView() {\n    const {element} = this;\n    element.selectedIndex = this.valueIndexMap.get(this.model.value)!;\n  }\n\n  private updateModel() {\n    this.model.restoreState(this.element.value);\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * This creates a form submit button that is not displayed, in order that the form may be submitted\n * using the enter key.\n */\nexport function makeHiddenSubmitButton() {\n  let element = document.createElement('button');\n  element.type = 'submit';\n  element.className = 'hidden-submit-button';\n  // We apply these styles directly to the element rather than by styling the class in order to\n  // avoid them being overridden accidentally.\n  element.style.margin = '0';\n  element.style.border = '0';\n  element.style.padding = '0';\n  element.style.width = '0';\n  element.style.height = '0';\n  element.style.overflow = 'hidden';\n  element.tabIndex = -1;\n  return element;\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport debounce from 'lodash/debounce';\nimport {LayerReference} from 'neuroglancer/layer';\nimport {Owned, RefCounted} from 'neuroglancer/util/disposable';\nimport {removeChildren} from 'neuroglancer/util/dom';\n\nexport class LayerReferenceWidget extends RefCounted {\n  element = document.createElement('label');\n  private selectElement = document.createElement('select');\n  constructor(public ref: Owned<LayerReference>) {\n    super();\n    this.registerDisposer(ref);\n    const {element, selectElement} = this;\n    element.appendChild(selectElement);\n\n    this.updateView();\n    this.registerEventListener(selectElement, 'change', () => this.updateModel());\n    this.registerDisposer(this.ref.changed.add(debounce(() => this.updateView(), 0)));\n  }\n\n  private updateModel() {\n    this.ref.layerName = this.selectElement.value || undefined;\n  }\n\n  private updateView() {\n    const {selectElement, ref} = this;\n    const {filter} = ref;\n    removeChildren(selectElement);\n    const emptyOption = document.createElement('option');\n    selectElement.appendChild(emptyOption);\n    for (const layer of this.ref.layerManager.managedLayers) {\n      if (filter(layer)) {\n        const option = document.createElement('option');\n        const {name} = layer;\n        option.textContent = name;\n        option.value = name;\n        selectElement.appendChild(option);\n      }\n    }\n    selectElement.value = ref.layerName || '';\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {TrackableValue, WatchableValue} from 'neuroglancer/trackable_value';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {removeFromParent} from 'neuroglancer/util/dom';\n\nexport class NumberInputWidget extends RefCounted {\n  element = document.createElement('label');\n  inputElement = document.createElement('input');\n  validator: (x: number) => number;\n  constructor(public model: WatchableValue<number>, options: {\n    validator?: (x: number) => number,\n    label?: string\n  } = {}) {\n    super();\n    let {validator, label} = options;\n    const {element, inputElement} = this;\n    if (validator === undefined) {\n      if (model instanceof TrackableValue) {\n        validator = model.validator;\n      } else {\n        validator = x => x;\n      }\n    }\n    this.validator = validator;\n    if (label !== undefined) {\n      element.textContent = label;\n    }\n    element.appendChild(inputElement);\n    element.className = 'neuroglancer-number-input';\n    inputElement.type = 'input';\n    this.registerDisposer(this.model.changed.add(() => this.updateView()));\n    this.registerEventListener(inputElement, 'change', () => this.updateModel());\n    this.updateView();\n  }\n\n  private updateView() {\n    this.inputElement.value = '' + this.model.value;\n  }\n\n  private updateModel() {\n    let value = parseFloat(this.inputElement.value.trim());\n    if (Number.isNaN(value)) {\n      this.updateView();\n      return;\n    }\n    try {\n      value = this.validator(value);\n      this.model.value = value;\n    } catch {\n      this.updateView();\n    }\n  }\n\n  disposed() {\n    removeFromParent(this.element);\n    super.disposed();\n  }\n}\n","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {MouseSelectionState} from 'neuroglancer/layer';\nimport {SpatialPosition, VoxelSize} from 'neuroglancer/navigation_state';\nimport {StatusMessage} from 'neuroglancer/status';\nimport {animationFrameDebounce} from 'neuroglancer/util/animation_frame_debounce';\nimport {setClipboard} from 'neuroglancer/util/clipboard';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {removeChildren, removeFromParent} from 'neuroglancer/util/dom';\nimport {EventActionMap, registerActionListener} from 'neuroglancer/util/event_action_map';\nimport {vec3} from 'neuroglancer/util/geom';\nimport {KeyboardEventBinder} from 'neuroglancer/util/keyboard_bindings';\nimport {MouseEventBinder} from 'neuroglancer/util/mouse_bindings';\nimport {numberToStringFixed} from 'neuroglancer/util/number_to_string';\nimport {pickLengthUnit} from 'neuroglancer/widget/scale_bar';\n\nimport './position_widget.css';\nimport 'neuroglancer/ui/button.css';\n\nexport const positionDragType = 'neuroglancer-position';\n\nconst inputEventMap = EventActionMap.fromObject({\n  'tab': {action: 'tab-forward', preventDefault: false},\n  'arrowup': {action: 'adjust-up'},\n  'arrowdown': {action: 'adjust-down'},\n  'wheel': {action: 'adjust-via-wheel'},\n  'shift+tab': {action: 'tab-backward', preventDefault: false},\n  'backspace': {action: 'delete-backward', preventDefault: false},\n  'escape': {action: 'cancel'},\n  'mouseup0': {action: 'select-all-if-was-not-focused', preventDefault: false},\n});\n\nconst normalizedPrefixString = '  ';\nconst normalizedSeparatorString = ',   ';\n\nexport class PositionWidget extends RefCounted {\n  element = document.createElement('div');\n  inputContainer = document.createElement('div');\n  inputElement = document.createElement('input');\n  hintElement = document.createElement('input');\n\n  tempPosition = vec3.create();\n\n  inputFieldWidth: number;\n\n  constructor(public position: SpatialPosition, public maxNumberWidth = 6) {\n    super();\n    const {element, inputElement, hintElement, inputContainer} = this;\n    inputContainer.className = 'neuroglancer-position-widget-input-container';\n    inputElement.className = 'neuroglancer-position-widget-input';\n    hintElement.className = 'neuroglancer-position-widget-hint';\n\n    this.inputFieldWidth =\n        maxNumberWidth * 3 + normalizedPrefixString.length + normalizedSeparatorString.length * 2 + 1;\n\n    for (const x of [inputElement, hintElement]) {\n      x.spellcheck = false;\n      x.autocomplete = 'off';\n      x.type = 'text';\n      x.style.width = this.inputFieldWidth + 'ch';\n    }\n    hintElement.disabled = true;\n    const copyButton = document.createElement('div');\n    copyButton.textContent = '';\n    copyButton.className = 'neuroglancer-copy-button neuroglancer-button';\n    copyButton.title = 'Copy position to clipboard';\n    copyButton.addEventListener('click', () => {\n      const result = setClipboard(this.getPositionText());\n      StatusMessage.showTemporaryMessage(\n          result ? 'Position copied to clipboard' : 'Failed to copy position to clipboard');\n    });\n    copyButton.addEventListener('dragstart', event => {\n      event.dataTransfer!.setData(positionDragType, JSON.stringify(position.toJSON()));\n      event.dataTransfer!.setData('text', this.getPositionText());\n      event.stopPropagation();\n    });\n    copyButton.draggable = true;\n    element.appendChild(copyButton);\n    element.appendChild(inputContainer);\n    inputContainer.appendChild(inputElement);\n    inputContainer.appendChild(hintElement);\n    element.className = 'neuroglancer-position-widget';\n    this.registerDisposer(position.changed.add(\n        this.registerCancellable(animationFrameDebounce(() => this.updateView()))));\n\n    const keyboardHandler =\n        this.registerDisposer(new KeyboardEventBinder(inputElement, inputEventMap));\n    keyboardHandler.allShortcutsAreGlobal = true;\n    this.registerDisposer(new MouseEventBinder(inputElement, inputEventMap));\n\n    this.registerEventListener(inputElement, 'change', () => this.updatePosition());\n    this.registerEventListener(inputElement, 'blur', () => this.updatePosition());\n    this.registerEventListener(inputElement, 'input', () => this.cleanInput());\n    this.registerEventListener(inputElement, 'keydown', this.updateHintScrollPosition);\n    this.registerEventListener(inputElement, 'copy', (event: ClipboardEvent) => {\n      const {selectionStart, selectionEnd} = inputElement;\n      let selection = inputElement.value.substring(selectionStart || 0, selectionEnd || 0);\n      selection = selection.trim().replace(/\\s+/g, ' ');\n      const {clipboardData} = event;\n      if (clipboardData !== null) {\n        clipboardData.setData('text/plain', selection);\n      }\n      event.stopPropagation();\n      event.preventDefault();\n    });\n    let wasFocused = false;\n    this.registerEventListener(inputElement, 'mousedown', () => {\n      wasFocused = document.activeElement === inputElement;\n    });\n\n    this.registerDisposer(\n        registerActionListener(inputElement, 'select-all-if-was-not-focused', event => {\n          if (wasFocused) {\n            return;\n          }\n          inputElement.selectionStart = 0;\n          inputElement.selectionEnd = inputElement.value.length;\n          inputElement.selectionDirection = 'forward';\n          event.preventDefault();\n        }));\n\n    this.registerDisposer(registerActionListener(inputElement, 'tab-forward', event => {\n      const selectionStart =\n          Math.min(inputElement.selectionStart || 0, inputElement.selectionEnd || 0);\n      const valueSubstring = inputElement.value.substring(selectionStart);\n      const match = valueSubstring.match(/^([^,\\s]*)((?:\\s+)|(?:\\s*,\\s*))?([^,\\s]*)/);\n      if (match !== null) {\n        // Already on a field.  Pick the next field.\n        if (match[2] !== undefined) {\n          inputElement.selectionStart = selectionStart + match[1].length + match[2].length;\n          inputElement.selectionEnd = inputElement.selectionStart + match[3].length;\n          inputElement.selectionDirection = 'forward';\n          event.preventDefault();\n          return;\n        }\n      }\n    }));\n\n    this.registerDisposer(registerActionListener(inputElement, 'tab-backward', event => {\n      const selectionEnd =\n          Math.max(inputElement.selectionStart || 0, inputElement.selectionEnd || 0);\n      const valueSubstring = inputElement.value.substring(0, selectionEnd);\n      const match = valueSubstring.match(/([^,\\s]*)((?:\\s+)|(?:\\s*,\\s*))?([^,\\s]*)$/);\n      if (match !== null) {\n        // Already on a field.  Pick the previous field.\n        if (match[2] !== undefined) {\n          inputElement.selectionStart = match.index!;\n          inputElement.selectionEnd = inputElement.selectionStart + match[1].length;\n          inputElement.selectionDirection = 'forward';\n          event.preventDefault();\n          return;\n        }\n      }\n    }));\n\n    this.registerDisposer(registerActionListener(inputElement, 'delete-backward', event => {\n      if (inputElement.selectionStart === inputElement.selectionEnd &&\n          inputElement.selectionStart === inputElement.value.length) {\n        const match = inputElement.value.match(/^(.*)(?![\\s])(?:(?:\\s+)|(?:\\s*,\\s*))$/);\n        if (match !== null) {\n          inputElement.value = match[1];\n          this.cleanInput();\n          event.preventDefault();\n          return;\n        }\n      }\n    }));\n\n    this.registerDisposer(registerActionListener(inputElement, 'cancel', () => {\n      this.updateView();\n      this.inputElement.blur();\n    }));\n\n    this.registerDisposer(\n        registerActionListener<WheelEvent>(inputElement, 'adjust-via-wheel', actionEvent => {\n          const event = actionEvent.detail;\n          const {deltaY} = event;\n          if (deltaY === 0) {\n            return;\n          }\n          const mouseCursorPosition = Math.ceil(\n              (inputElement.scrollLeft + event.offsetX - inputElement.clientLeft) /\n              (inputElement.scrollWidth / this.inputFieldWidth));\n\n          this.adjustFromCursor(mouseCursorPosition, -Math.sign(deltaY));\n        }));\n\n    this.registerDisposer(registerActionListener<WheelEvent>(inputElement, 'adjust-up', () => {\n      this.adjustFromCursor(undefined, 1);\n    }));\n    this.registerDisposer(registerActionListener<WheelEvent>(inputElement, 'adjust-down', () => {\n      this.adjustFromCursor(undefined, -1);\n    }));\n    this.updateView();\n  }\n\n  private adjustFromCursor(cursorPosition: number|undefined, adjustment: number) {\n    const {inputElement} = this;\n    if (cursorPosition === undefined) {\n      cursorPosition =\n          (inputElement.selectionDirection === 'forward' ? inputElement.selectionEnd :\n                                                           inputElement.selectionStart) ||\n          0;\n    }\n    if (this.cleanInput() === undefined) {\n      return;\n    }\n\n    const substring = inputElement.value.substring(0, cursorPosition);\n    const axisIndex = substring.split(',').length - 1;\n    this.updatePosition();\n    const voxelCoordinates = this.tempPosition;\n    if (this.position.getVoxelCoordinates(voxelCoordinates)) {\n      voxelCoordinates[axisIndex] += adjustment;\n      this.position.setVoxelCoordinates(voxelCoordinates);\n      this.updateView();\n    }\n  }\n\n  private cleanInput(): {position?: vec3}|undefined {\n    const s = this.inputElement.value;\n    const cursorPosition = this.inputElement.selectionStart || 0;\n    const numberPattern = /(-?\\d+(?:\\.(?:\\d+)?)?)/.source;\n    const separatorPattern = /((?:\\s+(?![\\s,]))|(?:\\s*,\\s*))/.source;\n    const startAndEndPattern = /([\\[\\]{}()\\s]*)/.source;\n    const pattern = new RegExp(\n        `^${startAndEndPattern}(?![\\\\s])${numberPattern}?` +\n        `(?:${separatorPattern}${numberPattern}?(?:${separatorPattern}${numberPattern}?)?)?` +\n        `${startAndEndPattern}$`);\n\n    const match = s.match(pattern);\n    if (match !== null) {\n      let cleanInput = normalizedPrefixString;\n      let hint = 'x ';\n      let cleanCursor = 2;\n      let curFieldStart = match[1].length;\n\n      const processField =\n          (matchText: string|undefined, replacementText: string|undefined = undefined,\n           hintText: string|undefined = undefined) => {\n            if (matchText === undefined) {\n              return;\n            }\n            let curFieldEnd = curFieldStart + matchText.length;\n            if (replacementText === undefined) {\n              replacementText = matchText;\n              hintText = ' '.repeat(replacementText.length);\n            }\n\n            if (cursorPosition >= curFieldStart) {\n              if (cursorPosition === curFieldEnd) {\n                cleanCursor = cleanInput.length + replacementText.length;\n              } else {\n                cleanCursor = cleanInput.length +\n                    Math.min(replacementText.length, cursorPosition - curFieldStart);\n              }\n            }\n            cleanInput += replacementText;\n            hint += hintText;\n            curFieldStart = curFieldEnd;\n          };\n\n      processField(match[2]);\n      processField(match[3], normalizedSeparatorString, '  y ');\n      processField(match[4]);\n      processField(match[5], normalizedSeparatorString, '  z ');\n      processField(match[6]);\n      this.hintElement.value = hint;\n\n      if (this.inputElement.value !== cleanInput) {\n        this.inputElement.value = cleanInput;\n        this.inputElement.selectionEnd = cleanCursor;\n        this.inputElement.selectionStart = cleanCursor;\n      }\n\n      this.updateHintScrollPosition();\n\n      if (match[2] !== undefined && match[4] !== undefined && match[6] !== undefined) {\n        return {\n          position: vec3.set(\n              this.tempPosition, parseFloat(match[2]), parseFloat(match[4]), parseFloat(match[6]))\n        };\n      }\n      return {};\n    } else {\n      this.hintElement.value = '';\n    }\n    return undefined;\n  }\n\n  private updatePosition() {\n    const cleanResult = this.cleanInput();\n    if (cleanResult !== undefined && cleanResult.position !== undefined) {\n      this.position.setVoxelCoordinates(cleanResult.position);\n    }\n  }\n\n  private getPositionText() {\n    const {position} = this;\n    const voxelPosition = this.tempPosition;\n    if (position.getVoxelCoordinates(voxelPosition)) {\n      return `${Math.floor(voxelPosition[0])}, ${Math.floor(voxelPosition[1])}, ${\n          Math.floor(voxelPosition[2])}`;\n    } else {\n      return '<unspecified position>';\n    }\n  }\n\n  private updateHintScrollPosition = this.registerCancellable(animationFrameDebounce(() => {\n    this.hintElement.scrollLeft = this.inputElement.scrollLeft;\n  }));\n\n  private updateView() {\n    const {position} = this;\n    const voxelPosition = this.tempPosition;\n    if (position.getVoxelCoordinates(voxelPosition)) {\n      const {inputElement} = this;\n      const inputText = `  ${Math.floor(voxelPosition[0])},   ${Math.floor(voxelPosition[1])},   ${\n          Math.floor(voxelPosition[2])}`;\n      const firstComma = inputText.indexOf(',');\n      const secondComma = inputText.indexOf(',', firstComma + 1);\n      const xLen = firstComma - 2;\n      const yLen = secondComma - firstComma - 4;\n      let hintText = `x ${' '.repeat(xLen)}  y ${' '.repeat(yLen)}  z`;\n\n      const prevSelectionStart = inputElement.selectionStart || 0;\n      const prevSelectionEnd = inputElement.selectionEnd || 0;\n      const prevSelectionDirection: any = inputElement.selectionDirection || undefined;\n      inputElement.value = inputText;\n      inputElement.setSelectionRange(prevSelectionStart, prevSelectionEnd, prevSelectionDirection);\n      this.hintElement.value = hintText + ' '.repeat(inputText.length - hintText.length);\n      this.updateHintScrollPosition();\n    } else {\n      this.inputElement.value = '';\n      this.hintElement.value = '';\n    }\n  }\n\n  disposed() {\n    removeFromParent(this.element);\n    super.disposed();\n  }\n}\n\nexport class VoxelSizeWidget extends RefCounted {\n  dimensionsContainer = document.createElement('span');\n  unitsElement = document.createElement('span');\n\n  constructor (public element: HTMLElement, public voxelSize: VoxelSize) {\n    super();\n    const {dimensionsContainer, unitsElement} = this;\n    element.className = 'neuroglancer-voxel-size-widget';\n    element.title = 'Voxel size';\n    dimensionsContainer.className = 'neuroglancer-voxel-size-dimensions-container';\n    element.appendChild(dimensionsContainer);\n    element.appendChild(unitsElement);\n    unitsElement.className = 'neuroglancer-voxel-size-units';\n    this.registerDisposer(voxelSize.changed.add(\n        this.registerCancellable(animationFrameDebounce(() => this.updateView()))));\n    this.updateView();\n  }\n\n  private updateView() {\n    const {dimensionsContainer, unitsElement} = this;\n    removeChildren(dimensionsContainer);\n    if (!this.voxelSize.valid) {\n      this.element.style.display = 'none';\n    } else {\n      this.element.style.display = null;\n    }\n    const {size} = this.voxelSize;\n    const minVoxelSize = Math.min(size[0], size[1], size[2]);\n    const unit = pickLengthUnit(minVoxelSize);\n    unitsElement.textContent = unit.unit;\n    for (let i = 0; i < 3; ++i) {\n      const s = numberToStringFixed(size[i] / unit.lengthInNanometers, 2);\n      const dimElement = document.createElement('span');\n      dimElement.className = 'neuroglancer-voxel-size-dimension';\n      dimElement.textContent = s;\n      dimensionsContainer.appendChild(dimElement);\n    }\n  }\n  disposed() {\n    removeFromParent(this.element);\n    super.disposed();\n  }\n}\n\nexport class MousePositionWidget extends RefCounted {\n  tempPosition = vec3.create();\n  constructor (public element: HTMLElement, public mouseState: MouseSelectionState, public voxelSize: VoxelSize) {\n    super();\n    element.className = 'neuroglancer-mouse-position-widget';\n    const updateViewFunction =\n        this.registerCancellable(animationFrameDebounce(() => this.updateView()));\n    this.registerDisposer(mouseState.changed.add(updateViewFunction));\n    this.registerDisposer(voxelSize.changed.add(updateViewFunction));\n  }\n  updateView() {\n    let text = '';\n    const {mouseState, voxelSize} = this;\n    if (mouseState.active && voxelSize.valid) {\n      const p = this.tempPosition;\n      voxelSize.voxelFromSpatial(p, mouseState.position);\n      text = `x ${Math.floor(p[0])},  y ${Math.floor(p[1])},  z ${Math.floor(p[2])}`;\n    }\n    this.element.textContent = text;\n  }\n  disposed() {\n    removeFromParent(this.element);\n    super.disposed();\n  }\n}\n","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {TrackableValueInterface} from 'neuroglancer/trackable_value';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {removeFromParent} from 'neuroglancer/util/dom';\n\nimport './range.css';\n\nexport class RangeWidget extends RefCounted {\n  element = document.createElement('label');\n  promptElement = document.createElement('span');\n  inputElement = document.createElement('input');\n  numericInputElement = document.createElement('input');\n\n  constructor(public value: TrackableValueInterface<number>, {min = 0, max = 1, step = 0.01} = {}) {\n    super();\n    let {element, promptElement, inputElement, numericInputElement} = this;\n    element.className = 'range-slider';\n    promptElement.className = 'range-prompt';\n    const initInputElement = (el: HTMLInputElement) => {\n      el.min = '' + min;\n      el.max = '' + max;\n      el.step = '' + step;\n      el.valueAsNumber = this.value.value;\n      const inputValueChanged = () => {\n        this.value.value = el.valueAsNumber;\n      };\n      this.registerEventListener(el, 'change', inputValueChanged);\n      this.registerEventListener(el, 'input', inputValueChanged);\n      this.registerEventListener(el, 'wheel', (event: WheelEvent) => {\n        let {deltaY} = event;\n        if (deltaY > 0) {\n          el.stepUp();\n          inputValueChanged();\n        } else if (deltaY < 0) {\n          el.stepDown();\n          inputValueChanged();\n        }\n      });\n    };\n    inputElement.type = 'range';\n    initInputElement(inputElement);\n    numericInputElement.type = 'number';\n    const maxNumberWidth = Math.max(\n        min.toString().length, max.toString().length, Math.min(max, min + step).toString().length,\n        Math.max(min, max - step).toString().length);\n    numericInputElement.style.width = (maxNumberWidth + 2) + 'ch';\n    initInputElement(numericInputElement);\n    element.appendChild(promptElement);\n    element.appendChild(inputElement);\n    element.appendChild(numericInputElement);\n    value.changed.add(() => {\n      this.inputElement.valueAsNumber = this.value.value;\n      this.numericInputElement.valueAsNumber = this.value.value;\n    });\n  }\n  disposed() {\n    removeFromParent(this.element);\n    super.disposed();\n  }\n}\n","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2019 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport 'neuroglancer/widget/render_scale_widget.css';\n\nimport debounce from 'lodash/debounce';\nimport throttle from 'lodash/throttle';\nimport {getRenderScaleFromHistogramOffset, getRenderScaleHistogramOffset, numRenderScaleHistogramBins, RenderScaleHistogram} from 'neuroglancer/render_scale_statistics';\nimport {TrackableValueInterface, WatchableValue} from 'neuroglancer/trackable_value';\nimport {serializeColor} from 'neuroglancer/util/color';\nimport {hsvToRgb} from 'neuroglancer/util/colorspace';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {EventActionMap, registerActionListener} from 'neuroglancer/util/event_action_map';\nimport {vec3} from 'neuroglancer/util/geom';\nimport {MouseEventBinder} from 'neuroglancer/util/mouse_bindings';\nimport {numberToStringFixed} from 'neuroglancer/util/number_to_string';\nimport {pickLengthUnit} from 'neuroglancer/widget/scale_bar';\nimport ResizeObserver from 'resize-observer-polyfill';\n\nconst updateInterval = 200;\n\nconst inputEventMap = EventActionMap.fromObject({\n  'mousedown0': {action: 'set'},\n  'wheel': {action: 'adjust-via-wheel'},\n  'dblclick0': {action: 'reset'},\n});\n\n\nfunction formatPixelNumber(x: number) {\n  if (x < 1 || x > 1024) {\n    const exponent = Math.log2(x) | 0;\n    const coeff = x / 2 ** exponent;\n    return `${numberToStringFixed(coeff, 1)}p${exponent}`;\n  }\n  return Math.round(x) + '';\n}\n\nexport class RenderScaleWidget extends RefCounted {\n  label = document.createElement('div');\n  element = document.createElement('div');\n  canvas = document.createElement('canvas');\n  legend = document.createElement('div');\n  legendRenderScale = document.createElement('div');\n  legendSpatialScale = document.createElement('div');\n  legendChunks = document.createElement('div');\n  private ctx = this.canvas.getContext('2d')!;\n  hoverTarget = new WatchableValue<[number, number]|undefined>(undefined);\n  private throttledUpdateView = this.registerCancellable(\n      throttle(() => this.debouncedUpdateView(), updateInterval, {leading: true, trailing: true}));\n  private debouncedUpdateView = this.registerCancellable(debounce(() => this.updateView(), 0));\n\n\n  constructor(\n      public histogram: RenderScaleHistogram, public target: TrackableValueInterface<number>) {\n    super();\n    const {canvas, label, element, legend, legendRenderScale, legendSpatialScale, legendChunks} =\n        this;\n    label.className = 'neuroglancer-render-scale-widget-prompt';\n    element.className = 'neuroglancer-render-scale-widget';\n    element.title = inputEventMap.describe();\n    legend.className = 'neuroglancer-render-scale-widget-legend';\n    element.appendChild(label);\n    element.appendChild(canvas);\n    element.appendChild(legend);\n    legendRenderScale.title = 'Target resolution of data in screen pixels';\n    legendChunks.title = 'Number of chunks rendered';\n    legend.appendChild(legendRenderScale);\n    legend.appendChild(legendChunks);\n    legend.appendChild(legendSpatialScale);\n    this.registerDisposer(histogram.changed.add(this.throttledUpdateView));\n    this.registerDisposer(histogram.visibility.changed.add(this.debouncedUpdateView));\n    this.registerDisposer(target.changed.add(this.debouncedUpdateView));\n    this.registerDisposer(new MouseEventBinder(canvas, inputEventMap));\n    this.registerDisposer(target.changed.add(this.debouncedUpdateView));\n    this.registerDisposer(this.hoverTarget.changed.add(this.debouncedUpdateView));\n\n    const getTargetValue = (event: MouseEvent) => {\n      const position = event.offsetX / canvas.width * numRenderScaleHistogramBins;\n      return getRenderScaleFromHistogramOffset(position);\n    };\n    this.registerEventListener(canvas, 'pointermove', (event: MouseEvent) => {\n      this.hoverTarget.value = [getTargetValue(event), event.offsetY];\n    });\n\n    this.registerEventListener(canvas, 'pointerleave', () => {\n      this.hoverTarget.value = undefined;\n    });\n\n    this.registerDisposer(registerActionListener<MouseEvent>(canvas, 'set', actionEvent => {\n      this.target.value = getTargetValue(actionEvent.detail);\n    }));\n\n    this.registerDisposer(\n        registerActionListener<WheelEvent>(canvas, 'adjust-via-wheel', actionEvent => {\n          const event = actionEvent.detail;\n          const {deltaY} = event;\n          if (deltaY === 0) {\n            return;\n          }\n          this.hoverTarget.value = undefined;\n          this.target.value *= 2 ** Math.sign(deltaY);\n          event.preventDefault();\n        }));\n\n\n    this.registerDisposer(registerActionListener(canvas, 'reset', event => {\n      this.hoverTarget.value = undefined;\n      this.target.reset();\n      event.preventDefault();\n    }));\n    const resizeObserver = new ResizeObserver(() => this.debouncedUpdateView());\n    resizeObserver.observe(canvas);\n    this.registerDisposer(() => resizeObserver.disconnect());\n    this.updateView();\n  }\n\n  updateView() {\n    const {ctx} = this;\n    const {canvas} = this;\n    const width = canvas.width = canvas.offsetWidth;\n    const height = canvas.height = canvas.offsetHeight;\n    const targetValue = this.target.value;\n    const hoverValue = this.hoverTarget.value;\n\n    {\n      const {legendRenderScale} = this;\n      const value = hoverValue === undefined ? targetValue : hoverValue[0];\n      const valueString = formatPixelNumber(value);\n      legendRenderScale.textContent = valueString + ' px';\n    }\n\n    function binToCanvasX(bin: number) {\n      return bin * width / numRenderScaleHistogramBins;\n    }\n\n    ctx.clearRect(0, 0, width, height);\n\n    const {histogram} = this;\n    // histogram.begin(this.frameNumberCounter.frameNumber);\n    const {value: histogramData, spatialScales} = histogram;\n\n    if (!histogram.visibility.visible) {\n      histogramData.fill(0);\n    }\n\n    const sortedSpatialScales = Array.from(spatialScales.keys());\n    sortedSpatialScales.sort();\n\n    const tempColor = vec3.create();\n\n    let maxCount = 1;\n    const numRows = spatialScales.size;\n    let totalPresent = 0, totalNotPresent = 0;\n    for (let bin = 0; bin < numRenderScaleHistogramBins; ++bin) {\n      let count = 0;\n      for (let row = 0; row < numRows; ++row) {\n        const index = row * numRenderScaleHistogramBins * 2 + bin;\n        const presentCount = histogramData[index];\n        const notPresentCount = histogramData[index + numRenderScaleHistogramBins];\n        totalPresent += presentCount;\n        totalNotPresent += notPresentCount;\n        count += presentCount + notPresentCount;\n      }\n      maxCount = Math.max(count, maxCount);\n    }\n\n    const maxBarHeight = height;\n\n    const yScale = maxBarHeight / Math.log(1 + maxCount);\n\n    function countToCanvasY(count: number) {\n      return height - Math.log(1 + count) * yScale;\n    }\n\n    let hoverSpatialScale: number|undefined = undefined;\n    if (hoverValue !== undefined) {\n      const i = Math.floor(getRenderScaleHistogramOffset(hoverValue[0]));\n      if (i >= 0 && i < numRenderScaleHistogramBins) {\n        let sum = 0;\n        const hoverY = hoverValue[1];\n        for (let spatialScaleIndex = numRows - 1; spatialScaleIndex >= 0; --spatialScaleIndex) {\n          const spatialScale = sortedSpatialScales[spatialScaleIndex];\n          const row = spatialScales.get(spatialScale)!;\n          const index = 2 * row * numRenderScaleHistogramBins + i;\n          const count = histogramData[index] + histogramData[index + numRenderScaleHistogramBins];\n          if (count === 0) continue;\n          const yStart = Math.round(countToCanvasY(sum));\n          sum += count;\n          const yEnd = Math.round(countToCanvasY(sum));\n          if (yEnd <= hoverY && hoverY <= yStart) {\n            hoverSpatialScale = spatialScale;\n            break;\n          }\n        }\n      }\n    }\n    if (hoverSpatialScale !== undefined) {\n      totalPresent = 0;\n      totalNotPresent = 0;\n      const row = spatialScales.get(hoverSpatialScale)!;\n      const baseIndex = 2 * row * numRenderScaleHistogramBins;\n      for (let bin = 0; bin < numRenderScaleHistogramBins; ++bin) {\n        const index = baseIndex + bin;\n        totalPresent += histogramData[index];\n        totalNotPresent += histogramData[index + numRenderScaleHistogramBins];\n      }\n      if (Number.isFinite(hoverSpatialScale)) {\n        const unit = pickLengthUnit(hoverSpatialScale);\n        this.legendSpatialScale.textContent =\n            numberToStringFixed(hoverSpatialScale / unit.lengthInNanometers, 2) + ' ' + unit.unit;\n      } else {\n        this.legendSpatialScale.textContent = 'unknown';\n      }\n    } else {\n      this.legendSpatialScale.textContent = '';\n    }\n\n    this.legendChunks.textContent = `${totalPresent}/${totalPresent + totalNotPresent}`;\n\n    const spatialScaleColors = sortedSpatialScales.map(spatialScale => {\n      const saturation = spatialScale === hoverSpatialScale ? 0.5 : 1;\n      let hue;\n      if (Number.isFinite(spatialScale)) {\n        hue = (((Math.log2(spatialScale) * 0.1) % 1) + 1) % 1;\n      } else {\n        hue = 0;\n      }\n      hsvToRgb(tempColor, hue, saturation, 1);\n      const presentColor = serializeColor(tempColor);\n      hsvToRgb(tempColor, hue, saturation, 0.5);\n      const notPresentColor = serializeColor(tempColor);\n      return [presentColor, notPresentColor];\n    });\n\n    for (let i = 0; i < numRenderScaleHistogramBins; ++i) {\n      let sum = 0;\n      for (let spatialScaleIndex = numRows - 1; spatialScaleIndex >= 0; --spatialScaleIndex) {\n        const spatialScale = sortedSpatialScales[spatialScaleIndex];\n        const row = spatialScales.get(spatialScale)!;\n        const index = row * numRenderScaleHistogramBins * 2 + i;\n        const presentCount = histogramData[index];\n        const notPresentCount = histogramData[index + numRenderScaleHistogramBins];\n        const count = presentCount + notPresentCount;\n        if (count === 0) continue;\n        const xStart = Math.round(binToCanvasX(i));\n        const xEnd = Math.round(binToCanvasX(i + 1));\n        const yStart = Math.round(countToCanvasY(sum));\n        sum += count;\n        const yEnd = Math.round(countToCanvasY(sum));\n        const ySplit = (presentCount * yEnd + notPresentCount * yStart) / count;\n        ctx.fillStyle = spatialScaleColors[spatialScaleIndex][1];\n        ctx.fillRect(xStart, yEnd, xEnd - xStart, ySplit - yEnd);\n        ctx.fillStyle = spatialScaleColors[spatialScaleIndex][0];\n        ctx.fillRect(xStart, ySplit, xEnd - xStart, yStart - ySplit);\n      }\n    }\n\n    {\n      const value = targetValue;\n      ctx.fillStyle = '#fff';\n      const startOffset = binToCanvasX(getRenderScaleHistogramOffset(value));\n      const lineWidth = 1;\n      ctx.fillRect(Math.floor(startOffset), 0, lineWidth, height);\n    }\n\n    if (hoverValue !== undefined) {\n      const value = hoverValue[0];\n      ctx.fillStyle = '#888';\n      const startOffset = binToCanvasX(getRenderScaleHistogramOffset(value));\n      const lineWidth = 1;\n      ctx.fillRect(Math.floor(startOffset), 0, lineWidth, height);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Facility for drawing a scale bar to indicate pixel size in physical length\n * units.\n *\n * The physical length with which the scale bar is labeled will be of the form:\n *\n *   significand * 10^exponent\n *\n * Any exponent may be used, but the significand in the range [1, 10] will be\n * equal to one of a\n * discrete set of allowed significand values, in order to ensure that the scale\n * bar is easy to\n * understand.\n */\n\nimport {TrackableValue} from 'neuroglancer/trackable_value';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {verifyFloat, verifyObjectProperty, verifyString} from 'neuroglancer/util/json';\nimport {GL} from 'neuroglancer/webgl/context';\nimport {setTextureFromCanvas} from 'neuroglancer/webgl/texture';\n\n/**\n * Default set of allowed significand values.  1 is implicitly part of the set.\n */\nconst DEFAULT_ALLOWED_SIGNIFICANDS = [\n  1.5,\n  2,\n  3,\n  5,\n  7.5,\n  10,\n];\n\nexport interface LengthUnit {\n  unit: string;\n  lengthInNanometers: number;\n}\n\nexport const ALLOWED_UNITS: LengthUnit[] = [\n  {unit: 'km', lengthInNanometers: 1e12},\n  {unit: 'm', lengthInNanometers: 1e9},\n  {unit: 'mm', lengthInNanometers: 1e6},\n  {unit: 'm', lengthInNanometers: 1e3},\n  {unit: 'nm', lengthInNanometers: 1},\n  {unit: 'pm', lengthInNanometers: 1e-3},\n];\n\nexport function pickLengthUnit(lengthInNanometers: number) {\n  const numAllowedUnits = ALLOWED_UNITS.length;\n  let unit = ALLOWED_UNITS[numAllowedUnits - 1];\n  for (let i = 0; i < numAllowedUnits; ++i) {\n    const allowedUnit = ALLOWED_UNITS[i];\n    if (lengthInNanometers >= allowedUnit.lengthInNanometers) {\n      unit = allowedUnit;\n      break;\n    }\n  }\n  return unit;\n}\n\nexport function pickVolumeUnit(volumeInCubicNanometers: number) {\n  const numAllowedUnits = ALLOWED_UNITS.length;\n  let unit = ALLOWED_UNITS[numAllowedUnits - 1];\n  for (let i = 0; i < numAllowedUnits; ++i) {\n    const allowedUnit = ALLOWED_UNITS[i];\n    if (volumeInCubicNanometers >= Math.pow(allowedUnit.lengthInNanometers, 3)) {\n      unit = allowedUnit;\n      break;\n    }\n  }\n  return unit;\n}\n\nexport class ScaleBarDimensions {\n  /**\n   * Allowed significand values.  1 is not included, but is always considered\n   * part of the set.\n   */\n  allowedSignificands = DEFAULT_ALLOWED_SIGNIFICANDS;\n\n  /**\n   * The target length in pixels.  The closest\n   */\n  targetLengthInPixels: number = 0;\n\n  /**\n   * Pixel size in nanometers.\n   */\n  nanometersPerPixel: number = 0;\n\n  // The following three fields are computed from the previous three fields.\n\n  /**\n   * Length that scale bar should be drawn, in pixels.\n   */\n  lengthInPixels: number;\n\n  /**\n   * Physical length with which to label the scale bar.\n   */\n  physicalLength: number;\n  physicalUnit: string;\n\n  prevNanometersPerPixel: number = 0;\n  prevTargetLengthInPixels: number = 0;\n\n  /**\n   * Updates physicalLength, physicalUnit, and lengthInPixels to be the optimal\n   * values corresponding\n   * to targetLengthInPixels and nanometersPerPixel.\n   *\n   * @returns true if the scale bar has changed, false if it is unchanged.\n   */\n  update() {\n    let {nanometersPerPixel, targetLengthInPixels} = this;\n    if (this.prevNanometersPerPixel === nanometersPerPixel &&\n        this.prevTargetLengthInPixels === targetLengthInPixels) {\n      return false;\n    }\n    this.prevNanometersPerPixel = nanometersPerPixel;\n    this.prevTargetLengthInPixels = targetLengthInPixels;\n    const targetNanometers = targetLengthInPixels * nanometersPerPixel;\n    const exponent = Math.floor(Math.log(targetNanometers) / Math.LN10);\n    const tenToThePowerExponent = Math.pow(10, exponent);\n    const targetSignificand = targetNanometers / tenToThePowerExponent;\n\n    // Determine significand value in this.allowedSignificands that is closest\n    // to targetSignificand.\n    let bestSignificand = 1;\n    for (let allowedSignificand of this.allowedSignificands) {\n      if (Math.abs(allowedSignificand - targetSignificand) <\n          Math.abs(bestSignificand - targetSignificand)) {\n        bestSignificand = allowedSignificand;\n      } else {\n        // If distance did not decrease, then it can only increase from here.\n        break;\n      }\n    }\n\n    const physicalNanometers = bestSignificand * tenToThePowerExponent;\n    const unit = pickLengthUnit(physicalNanometers);\n    this.lengthInPixels = Math.round(physicalNanometers / nanometersPerPixel);\n    this.physicalUnit = unit.unit;\n    this.physicalLength = physicalNanometers / unit.lengthInNanometers;\n    return true;\n  }\n}\n\nfunction makeScaleBarTexture(\n    dimensions: ScaleBarDimensions, gl: GL, texture: WebGLTexture|null,\n    options: ScaleBarTextureOptions = defaultScaleBarTextureOptions) {\n  const canvas = document.createElement('canvas');\n  const ctx = canvas.getContext('2d')!;\n  const textHeight = options.textHeightInPixels * options.scaleFactor;\n  const font = `bold ${textHeight}px ${options.fontName}`;\n  ctx.font = font;\n  ctx.fillStyle = 'white';\n  const text = `${dimensions.physicalLength} ${dimensions.physicalUnit}`;\n  const textMetrics = ctx.measureText(text);\n  const innerWidth = Math.max(dimensions.lengthInPixels, textMetrics.width);\n  const barHeight = options.barHeightInPixels * options.scaleFactor;\n  const barTopMargin = options.barTopMarginInPixels * options.scaleFactor;\n  const innerHeight = barHeight + barTopMargin + textHeight;\n  const padding = options.paddingInPixels * options.scaleFactor;\n  const totalHeight = innerHeight + 2 * padding;\n  const totalWidth = innerWidth + 2 * padding;\n  canvas.width = totalWidth;\n  canvas.height = totalHeight;\n  ctx.font = font;\n  ctx.textAlign = 'center';\n  ctx.fillStyle = 'rgba(0, 0, 0, 0.3)';\n  ctx.fillRect(0, 0, totalWidth, totalHeight);\n  ctx.fillStyle = 'white';\n  ctx.fillText(text, totalWidth / 2, totalHeight - padding - barHeight - barTopMargin);\n  ctx.fillRect(padding, totalHeight - padding - barHeight, dimensions.lengthInPixels, barHeight);\n  setTextureFromCanvas(gl, texture, canvas);\n  return {width: totalWidth, height: totalHeight};\n}\n\nexport class ScaleBarTexture extends RefCounted {\n  texture: WebGLTexture|null = null;\n  width = 0;\n  height = 0;\n  private priorOptions: ScaleBarTextureOptions|undefined = undefined;\n\n  constructor(public gl: GL, public dimensions = new ScaleBarDimensions()) {\n    super();\n  }\n\n  update(options: ScaleBarTextureOptions) {\n    let {dimensions} = this;\n    let {texture} = this;\n    if (!dimensions.update() && texture !== null && options === this.priorOptions) {\n      return;\n    }\n    if (texture === null) {\n      texture = this.texture = this.gl.createTexture();\n    }\n    const {width, height} = makeScaleBarTexture(dimensions, this.gl, texture, options);\n    this.priorOptions = options;\n    this.width = width;\n    this.height = height;\n  }\n\n  disposed() {\n    this.gl.deleteTexture(this.texture);\n    this.texture = null;\n    super.disposed();\n  }\n}\n\nexport interface ScaleBarTextureOptions {\n  textHeightInPixels: number;\n  barTopMarginInPixels: number;\n  fontName: string;\n  barHeightInPixels: number;\n  paddingInPixels: number;\n  scaleFactor: number;\n}\n\nexport interface ScaleBarOptions extends ScaleBarTextureOptions {\n  maxWidthInPixels: number;\n  maxWidthFraction: number;\n  leftPixelOffset: number;\n  bottomPixelOffset: number;\n}\n\nexport const defaultScaleBarTextureOptions: ScaleBarTextureOptions = {\n  scaleFactor: 1,\n  textHeightInPixels: 15,\n  barHeightInPixels: 8,\n  barTopMarginInPixels: 5,\n  fontName: 'sans-serif',\n  paddingInPixels: 2,\n};\n\nexport const defaultScaleBarOptions: ScaleBarOptions = {\n  ...defaultScaleBarTextureOptions,\n  maxWidthInPixels: 100,\n  maxWidthFraction: 0.25,\n  leftPixelOffset: 10,\n  bottomPixelOffset: 10,\n};\n\nfunction parseScaleBarOptions(obj: any): ScaleBarOptions {\n  const result = {\n    ...defaultScaleBarOptions,\n  };\n  for (const k of <(keyof ScaleBarOptions)[]>[\n         'textHeightInPixels', 'barTopMarginInPixels', 'barHeightInPixels', 'paddingInPixels',\n         'scaleFactor', 'maxWidthInPixels', 'maxWidthFraction', 'leftPixelOffset',\n         'bottomPixelOffset'\n       ]) {\n    verifyObjectProperty(obj, k, x => {\n      if (x !== undefined) {\n        result[k] = verifyFloat(x);\n      }\n    });\n  }\n  verifyObjectProperty(obj, 'fontName', x => {\n    if (x !== undefined) {\n      result.fontName = verifyString(x);\n    }\n  });\n  return result;\n}\n\nexport class TrackableScaleBarOptions extends TrackableValue<ScaleBarOptions> {\n  constructor() {\n    super(defaultScaleBarOptions, parseScaleBarOptions);\n  }\n}\n","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {SegmentationDisplayState} from 'neuroglancer/segmentation_display_state/frontend';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {Uint64} from 'neuroglancer/util/uint64';\n\nimport 'neuroglancer/noselect.css';\nimport './segment_set_widget.css';\n\ntype ItemElement = HTMLButtonElement;\n\nlet temp = new Uint64();\n\nexport class SegmentSetWidget extends RefCounted {\n  element = document.createElement('div');\n  private clearButton = document.createElement('button');\n  private itemContainer = document.createElement('span');\n  private items = new Map<string, ItemElement>();\n\n  get visibleSegments() {\n    return this.displayState.visibleSegments;\n  }\n  get segmentColorHash() {\n    return this.displayState.segmentColorHash;\n  }\n  get segmentSelectionState() {\n    return this.displayState.segmentSelectionState;\n  }\n\n  constructor(public displayState: SegmentationDisplayState) {\n    super();\n    let {element, clearButton, itemContainer} = this;\n    element.className = 'segment-set-widget neuroglancer-noselect';\n    clearButton.className = 'clear-button';\n    clearButton.title = 'Remove all segment IDs';\n    this.registerEventListener(clearButton, 'click', () => {\n      this.visibleSegments.clear();\n    });\n\n    itemContainer.className = 'item-container';\n    element.appendChild(itemContainer);\n\n    itemContainer.appendChild(clearButton);\n\n    this.registerDisposer(displayState.visibleSegments.changed.add((x, add) => {\n      this.handleSetChanged(x, add);\n    }));\n    this.registerDisposer(displayState.segmentColorHash.changed.add(() => {\n      this.handleColorChanged();\n    }));\n\n    for (let x of displayState.visibleSegments) {\n      this.addElement(x.toString());\n    }\n    this.updateClearButtonVisibility();\n  }\n\n  private updateClearButtonVisibility() {\n    let {clearButton} = this;\n    clearButton.style.display = (this.displayState.visibleSegments.size > 0) ? '' : 'none';\n  }\n\n  private handleSetChanged(x: Uint64|null, added: boolean) {\n    this.updateClearButtonVisibility();\n    let {items} = this;\n    if (x === null) {\n      // Cleared.\n      let {itemContainer, clearButton} = this;\n      while (true) {\n        let lastElement = itemContainer.lastElementChild!;\n        if (lastElement === clearButton) {\n          break;\n        }\n        itemContainer.removeChild(lastElement);\n      }\n      items.clear();\n    } else if (added) {\n      this.addElement(x.toString());\n    } else {\n      let s = x.toString();\n      let itemElement = items.get(s)!;\n      itemElement.parentElement!.removeChild(itemElement);\n      items.delete(s);\n    }\n  }\n\n  private addElement(s: string) {\n    let itemElement = document.createElement('button');\n    itemElement.className = 'segment-button';\n    itemElement.textContent = s;\n    itemElement.title = `Remove segment ID ${s}`;\n    let widget = this;\n    itemElement.addEventListener('click', function(this: ItemElement) {\n      temp.tryParseString(this.textContent!);\n      widget.visibleSegments.delete(temp);\n    });\n    itemElement.addEventListener('mouseenter', function(this: ItemElement) {\n      temp.tryParseString(this.textContent!);\n      widget.segmentSelectionState.set(temp);\n    });\n    itemElement.addEventListener('mouseleave', function(this: ItemElement) {\n      temp.tryParseString(this.textContent!);\n      widget.segmentSelectionState.set(null);\n    });\n    this.setItemColor(itemElement);\n    this.itemContainer.appendChild(itemElement);\n    this.items.set(s, itemElement);\n  }\n\n  private setItemColor(itemElement: ItemElement) {\n    temp.tryParseString(itemElement.textContent!);\n    itemElement.style.backgroundColor = this.segmentColorHash.computeCssColor(temp);\n  }\n\n  private handleColorChanged() {\n    this.items.forEach(itemElement => {\n      this.setItemColor(itemElement);\n    });\n  }\n\n  disposed() {\n    let {element} = this;\n    let {parentElement} = element;\n    if (parentElement) {\n      parentElement.removeChild(element);\n    }\n    super.disposed();\n  }\n}\n","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport 'codemirror/addon/lint/lint.js';\nimport './shader_code_widget.css';\nimport 'codemirror/lib/codemirror.css';\nimport 'codemirror/addon/lint/lint.css';\n\nimport CodeMirror from 'codemirror';\nimport debounce from 'lodash/debounce';\nimport {WatchableValue} from 'neuroglancer/trackable_value';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {removeFromParent} from 'neuroglancer/util/dom';\nimport {WatchableShaderError} from 'neuroglancer/webgl/dynamic_shader';\nimport {ShaderCompilationError, ShaderLinkError} from 'neuroglancer/webgl/shader';\nimport {ShaderControlParseError, ShaderControlState} from 'neuroglancer/webgl/shader_ui_controls';\n\nrequire<(codeMirror: typeof CodeMirror) => void>('glsl-editor/glsl')(CodeMirror);\n\n/**\n * Time in milliseconds during which the input field must not be modified before the shader is\n * recompiled.\n */\nconst SHADER_UPDATE_DELAY = 500;\n\ninterface ShaderCodeState {\n  shaderError: WatchableShaderError;\n  shaderControlState?: ShaderControlState;\n  fragmentMain: WatchableValue<string>;\n  fragmentMainStartLine: string;\n}\n\nexport class ShaderCodeWidget extends RefCounted {\n  textEditor: CodeMirror.Editor;\n  get element() {\n    return this.textEditor.getWrapperElement();\n  }\n  private changingValue = false;\n  private debouncedValueUpdater = debounce(() => {\n    this.changingValue = true;\n    try {\n      this.state.fragmentMain.value = this.textEditor.getValue();\n    } finally {\n      this.changingValue = false;\n    }\n  }, SHADER_UPDATE_DELAY);\n\n  constructor(public state: ShaderCodeState) {\n    super();\n    this.textEditor = CodeMirror(_element => {}, {\n      value: this.state.fragmentMain.value,\n      mode: 'glsl',\n      gutters: ['CodeMirror-lint-markers'],\n    });\n    this.textEditor.on('change', () => {\n      this.setValidState(undefined);\n      this.debouncedValueUpdater();\n    });\n    this.registerDisposer(this.state.fragmentMain.changed.add(() => {\n      if (!this.changingValue) {\n        this.textEditor.setValue(this.state.fragmentMain.value);\n      }\n    }));\n    this.element.classList.add('neuroglancer-shader-code-widget');\n    this.registerDisposer(this.state.shaderError.changed.add(() => {\n      this.updateErrorState();\n    }));\n    const {shaderControlState} = this.state;\n    if (shaderControlState !== undefined) {\n      this.registerDisposer(shaderControlState.parseErrors.changed.add(() => {\n        this.updateErrorState();\n      }));\n    }\n    this.updateErrorState();\n  }\n\n  updateErrorState() {\n    const error = this.state.shaderError.value;\n    let controlParseErrors: ShaderControlParseError[];\n    const {shaderControlState} = this.state;\n    if (shaderControlState !== undefined) {\n      controlParseErrors = shaderControlState.parseErrors.value;\n    } else {\n      controlParseErrors = [];\n    }\n    if (error === undefined && controlParseErrors.length === 0) {\n      this.setValidState(undefined);\n    } else if (error != null || controlParseErrors.length !== 0) {\n      this.textEditor.setOption('lint', {\n        getAnnotations: () => {\n          const annotations = [];\n          for (const e of controlParseErrors) {\n            annotations.push({\n              message: e.message,\n              severity: 'error',\n              from: CodeMirror.Pos(e.line),\n            });\n          }\n          if (error != null) {\n            if (error.name === 'ShaderCompilationError') {\n              const fragmentMainStartLineNumber = (<ShaderCompilationError>error)\n                                                      .source.split('\\n')\n                                                      .indexOf(this.state.fragmentMainStartLine) +\n                  2;\n              for (const e of (error as ShaderCompilationError).errorMessages) {\n                annotations.push({\n                  message: e.message,\n                  severity: 'error',\n                  from: CodeMirror.Pos(\n                      e.line === undefined ? 0 : e.line - fragmentMainStartLineNumber),\n                });\n              }\n            } else if (error!.name === 'ShaderLinkError') {\n              annotations.push({\n                message: (<ShaderLinkError>error).log,\n                severity: 'error',\n                from: CodeMirror.Pos(0),\n              });\n            } else {\n              annotations.push({\n                message: error!.message,\n                severity: 'error',\n                from: CodeMirror.Pos(0),\n              });\n            }\n          }\n          return annotations;\n        },\n      });\n      this.setValidState(false);\n    } else {\n      this.textEditor.setOption('lint', undefined);\n      this.setValidState(true);\n    }\n  }\n\n  setValidState(valid?: boolean) {\n    let {element} = this;\n    element.classList.remove('invalid-input');\n    element.classList.remove('valid-input');\n    if (valid === true) {\n      element.classList.add('valid-input');\n    } else if (valid === false) {\n      element.classList.add('invalid-input');\n    }\n  }\n\n  disposed() {\n    (<{flush?: () => void}>this.debouncedValueUpdater).flush!();\n    this.debouncedValueUpdater = <any>undefined;\n    removeFromParent(this.element);\n    this.textEditor = <any>undefined;\n    super.disposed();\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport debounce from 'lodash/debounce';\nimport {TrackableRGB} from 'neuroglancer/util/color';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {removeChildren} from 'neuroglancer/util/dom';\nimport {ShaderControlState} from 'neuroglancer/webgl/shader_ui_controls';\nimport {ColorWidget} from 'neuroglancer/widget/color';\nimport {RangeWidget} from 'neuroglancer/widget/range';\n\n\nexport class ShaderControls extends RefCounted {\n  element = document.createElement('div');\n  private controlDisposer: RefCounted|undefined = undefined;\n\n  constructor(public state: ShaderControlState) {\n    super();\n    const {controls} = state;\n    this.registerDisposer(\n        controls.changed.add(this.registerCancellable(debounce(() => this.updateControls(), 0))));\n    this.updateControls();\n  }\n\n  updateControls() {\n    if (this.controlDisposer !== undefined) {\n      this.controlDisposer.dispose();\n      removeChildren(this.element);\n    }\n    const controlDisposer = this.controlDisposer = new RefCounted();\n    for (const [name, controlState] of this.state.state) {\n      const {control} = controlState;\n      switch (control.type) {\n        case 'slider': {\n          const widget = controlDisposer.registerDisposer(new RangeWidget(\n              controlState.trackable, {min: control.min, max: control.max, step: control.step}));\n          widget.promptElement.textContent = name;\n          this.element.appendChild(widget.element);\n          break;\n        }\n        case 'color': {\n          const label = document.createElement('label');\n          label.textContent = name;\n          const widget = controlDisposer.registerDisposer(\n              new ColorWidget(controlState.trackable as TrackableRGB));\n          this.element.appendChild(label);\n          label.appendChild(widget.element);\n          break;\n        }\n      }\n    }\n  }\n\n  disposed() {\n    const {controlDisposer} = this;\n    if (controlDisposer !== undefined) {\n      controlDisposer.dispose();\n    }\n    super.disposed();\n  }\n}\n","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Tabbed view widget.\n */\n\nimport 'neuroglancer/widget/tab_view.css';\n\nimport {Owned, RefCounted} from 'neuroglancer/util/disposable';\nimport {removeChildren, removeFromParent} from 'neuroglancer/util/dom';\nimport {NullarySignal, Signal} from 'neuroglancer/util/signal';\nimport {Trackable} from 'neuroglancer/util/trackable';\nimport {WatchableVisibilityPriority} from 'neuroglancer/visibility_priority/frontend';\n\nexport class Tab extends RefCounted {\n  element = document.createElement('div');\n\n  get visible() {\n    return this.visibility.visible;\n  }\n\n  constructor(public visibility = new WatchableVisibilityPriority()) {\n    super();\n    const {element} = this;\n    element.classList.add('neuroglancer-tab-content');\n  }\n\n  disposed() {\n    removeFromParent(this.element);\n    super.disposed();\n  }\n}\n\nexport class OptionSpecification<T> extends RefCounted implements Trackable {\n  changed = new NullarySignal();\n  options = new Map<string, T>();\n  optionsChanged = new NullarySignal();\n\n  private selectedValue: string|undefined = undefined;\n  private defaultValue: string|undefined = undefined;\n\n  get value() {\n    const {selectedValue} = this;\n    if (selectedValue !== undefined) {\n      return selectedValue;\n    }\n    return this.defaultValue;\n  }\n\n  set default(value: string|undefined) {\n    if (this.defaultValue !== value) {\n      this.defaultValue = value;\n      this.changed.dispatch();\n    }\n  }\n\n  get default() {\n    return this.defaultValue;\n  }\n\n  set value(value: string|undefined) {\n    if (value !== undefined && this.ready_ && !this.options.has(value)) {\n      value = undefined;\n    }\n    const {selectedValue} = this;\n    if (selectedValue !== value) {\n      this.selectedValue = value;\n      this.changed.dispatch();\n    }\n  }\n\n  get validValue() {\n    const value = this.selectedValue;\n    if (value === undefined || !this.options.has(value)) {\n      return this.defaultValue;\n    }\n    return value;\n  }\n\n  add(id: string, value: T) {\n    const {options} = this;\n    if (options.has(id)) {\n      throw new Error(`Option already defined: ${JSON.stringify(id)}.`);\n    }\n    options.set(id, value);\n    this.optionsChanged.dispatch();\n    if (this.defaultValue === undefined) {\n      this.default = id;\n    }\n  }\n\n  toJSON() {\n    const {value, defaultValue} = this;\n    if (value === defaultValue) {\n      return undefined;\n    }\n    return value;\n  }\n\n  reset() {\n    this.value = undefined;\n  }\n\n  ready_ = true;\n\n  /**\n   * When `ready` is `false`, the selected `value` may be set to an unknown option.\n   */\n  get ready() {\n    return this.ready_;\n  }\n\n  set ready(value: boolean) {\n    if (value !== this.ready_) {\n      this.ready_ = value;\n      if (value) {\n        this.value = this.value;\n      }\n      this.changed.dispatch();\n    }\n  }\n\n  restoreState(obj: any) {\n    if (typeof obj !== 'string') {\n      obj = undefined;\n    }\n    this.value = obj;\n  }\n}\n\nexport class StackView<TabId, TabType extends Tab = Tab> extends RefCounted {\n  element = document.createElement('div');\n  tabs = new Map<TabId, Owned<TabType>>();\n  tabVisibilityChanged = new Signal<(id: TabId, visible: boolean) => void>();\n\n  private selectedTabValue: TabId|undefined;\n  private displayedTab: TabId|undefined;\n\n  get visible() {\n    return this.visibility.visible;\n  }\n\n  get selected() {\n    return this.selectedTabValue;\n  }\n\n  set selected(id: TabId|undefined) {\n    this.selectedTabValue = id;\n    this.updateSelectedTab();\n  }\n\n  constructor(\n      public getter: (id: TabId) => Owned<TabType>,\n      public visibility = new WatchableVisibilityPriority()) {\n    super();\n\n    const {element} = this;\n    element.className = 'neuroglancer-stack-view';\n    this.registerDisposer(visibility.changed.add(() => this.updateSelectedTab()));\n    this.updateSelectedTab();\n  }\n\n  invalidate(id: TabId) {\n    const {tabs} = this;\n    const tab = tabs.get(id);\n    if (tab === undefined) {\n      return;\n    }\n    tab.dispose();\n    tabs.delete(id);\n    if (id === this.displayedTab) {\n      this.displayedTab = undefined;\n      this.updateSelectedTab();\n    }\n  }\n\n  private hideTab(id: TabId) {\n    const tab = this.tabs.get(id);\n    if (tab !== undefined) {\n      tab.visibility.value = WatchableVisibilityPriority.IGNORED;\n      tab.element.style.display = 'none';\n    }\n    this.tabVisibilityChanged.dispatch(id, false);\n  }\n\n  private showTab(id: TabId) {\n    const {tabs} = this;\n    let tab = tabs.get(id);\n    if (tab === undefined) {\n      tab = this.getter(id);\n      this.element.appendChild(tab.element);\n      tabs.set(id, tab);\n    }\n    tab.element.style.display = null;\n    tab.visibility.value = WatchableVisibilityPriority.VISIBLE;\n    this.tabVisibilityChanged.dispatch(id, true);\n  }\n\n  private updateSelectedTab() {\n    const {displayedTab} = this;\n    const newTab = this.visible ? this.selectedTabValue : undefined;\n    if (newTab === displayedTab) {\n      return;\n    }\n    if (displayedTab !== undefined) {\n      this.hideTab(displayedTab);\n    }\n    this.displayedTab = newTab;\n    if (newTab === undefined) {\n      return;\n    }\n    this.showTab(newTab);\n  }\n\n  invalidateAll() {\n    const {tabs} = this;\n    for (const tab of tabs.values()) {\n      tab.dispose();\n    }\n    tabs.clear();\n    this.updateSelectedTab();\n  }\n\n  disposed() {\n    this.selectedTabValue = undefined;\n    this.invalidateAll();\n    removeFromParent(this.element);\n    super.disposed();\n  }\n}\n\nexport class TabSpecification extends\n    OptionSpecification<{label: string, order?: number, getter: () => Owned<Tab>}> {}\n\nexport class TabView extends RefCounted {\n  element = document.createElement('div');\n  tabBar = document.createElement('div');\n\n  private stack: StackView<string>;\n  private tabLabels = new Map<string, HTMLElement>();\n\n  private tabsGeneration = -1;\n\n  get visible() {\n    return this.visibility.visible;\n  }\n\n  constructor(\n      public state: TabSpecification, public visibility = new WatchableVisibilityPriority()) {\n    super();\n\n    const {element, tabBar} = this;\n    element.className = 'neuroglancer-tab-view';\n    tabBar.className = 'neuroglancer-tab-view-bar';\n    element.appendChild(tabBar);\n    // It is important to register our visibility changed handler before the StackView registers its\n    // visibility changed handler, so that tab labels are created before tabVisibilityChanged\n    // signals are received.\n    this.registerDisposer(visibility.changed.add(() => {\n      this.updateTabs();\n    }));\n    const stack = this.stack = this.registerDisposer(\n        new StackView<string>(id => this.state.options.get(id)!.getter(), this.visibility));\n    element.appendChild(stack.element);\n\n    this.registerDisposer(this.state.changed.add(() => this.updateSelectedTab()));\n    this.registerDisposer(this.state.optionsChanged.add(() => this.updateTabs()));\n    this.stack.tabVisibilityChanged.add((id, visible) => {\n      const labelElement = this.tabLabels.get(id)!;\n      const className = 'neuroglancer-selected-tab-label';\n      if (visible) {\n        labelElement.classList.add(className);\n      } else {\n        labelElement.classList.remove(className);\n      }\n    });\n    this.updateTabs();\n  }\n\n  private updateTabs() {\n    if (this.tabsGeneration !== this.state.optionsChanged.count) {\n      this.destroyTabs();\n      if (this.visible) {\n        this.makeTabs();\n      }\n      this.updateSelectedTab();\n    }\n  }\n\n  private updateSelectedTab() {\n    this.stack.selected = this.state.value;\n  }\n\n  private destroyTabs() {\n    if (this.tabsGeneration === -1) {\n      return;\n    }\n    this.stack.selected = undefined;\n    this.tabLabels.clear();\n    removeChildren(this.tabBar);\n    this.tabsGeneration = -1;\n    this.stack.invalidateAll();\n  }\n\n  private makeTabs() {\n    const {tabBar, tabLabels} = this;\n    const optionsArray = Array.from(this.state.options);\n    optionsArray.sort(([, {order: aOrder = 0}], [, {order: bOrder = 0}]) => {\n      return aOrder - bOrder;\n    });\n    for (const [id, {label}] of optionsArray) {\n      const labelElement = document.createElement('div');\n      labelElement.classList.add('neuroglancer-tab-label');\n      labelElement.textContent = label;\n      labelElement.addEventListener('click', () => {\n        this.state.value = id;\n      });\n      tabLabels.set(id, labelElement);\n      tabBar.appendChild(labelElement);\n    }\n    this.tabsGeneration = this.state.optionsChanged.count;\n  }\n\n  disposed() {\n    removeChildren(this.tabBar);\n    this.tabLabels.clear();\n    removeFromParent(this.element);\n    super.disposed();\n  }\n}\n","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2018 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport './text_icon_button.css';\n\nexport function makeTextIconButton(iconText: string, title?: string) {\n  const element = document.createElement('div');\n  const innerElement = document.createElement('div');\n  innerElement.textContent = iconText;\n  element.className = 'neuroglancer-icon-button';\n  element.appendChild(innerElement);\n  if (title !== undefined) {\n    element.title = title;\n  }\n  return element;\n}\n","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Facilities for creating tooltips.\n */\n\nimport './tooltip.css';\n\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {removeFromParent} from 'neuroglancer/util/dom';\n\nexport class Tooltip extends RefCounted {\n  element = document.createElement('div');\n  constructor() {\n    super();\n    const {element} = this;\n    element.className = 'neuroglancer-tooltip';\n    element.style.visibility = 'hidden';\n    document.body.appendChild(element);\n  }\n\n  updatePosition(pageX: number, pageY: number) {\n    const {element} = this;\n    element.style.left = pageX + 'px';\n    element.style.top = pageY + 'px';\n    element.style.visibility = 'inherit';\n  }\n\n  disposed() {\n    removeFromParent(this.element);\n    super.disposed();\n  }\n}\n","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {removeFromParent} from 'neuroglancer/util/dom';\nimport {Signal} from 'neuroglancer/util/signal';\nimport {Uint64} from 'neuroglancer/util/uint64';\n\nimport 'neuroglancer/noselect.css';\nimport './uint64_entry_widget.css';\n\nexport class Uint64EntryWidget extends RefCounted {\n  element = document.createElement('form');\n  label = document.createElement('label');\n  input = document.createElement('input');\n  valuesEntered = new Signal<(values: Uint64[]) => void>();\n\n  constructor() {\n    super();\n    let {element, label, input} = this;\n    element.className = 'uint64-entry neuroglancer-noselect';\n    element.appendChild(label);\n    label.appendChild(input);\n    this.registerEventListener(element, 'submit', (event: Event) => {\n      event.preventDefault();\n      const values = this.validateInput();\n      if (values !== undefined) {\n        this.input.value = '';\n        this.input.classList.remove('valid-input', 'invalid-input');\n        this.valuesEntered.dispatch(values);\n      }\n    });\n    this.registerEventListener(element, 'input', () => {\n      if (this.input.value === '') {\n        this.input.classList.remove('valid-input', 'invalid-input');\n        return;\n      }\n      if (this.validateInput()) {\n        this.input.classList.remove('invalid-input');\n      } else {\n        this.input.classList.add('invalid-input');\n      }\n    });\n  }\n\n  validateInput(): Uint64[]|undefined {\n    let value = this.input.value;\n    value = value.replace(/[\\s,\\(\\)\\[\\]\\{\\};]+/g, ' ');\n    value = value.trim();\n    const parts = value.split(' ');\n    if (parts.length === 0) {\n      return undefined;\n    }\n    const results: Uint64[] = [];\n    for (const part of parts) {\n      const x = new Uint64();\n      if (!x.tryParseString(part)) {\n        return undefined;\n      }\n      results.push(x);\n    }\n    return results;\n  }\n\n  disposed() {\n    removeFromParent(this.element);\n    super.disposed();\n  }\n}\n","// extracted by mini-css-extract-plugin","/**\n * @license\n * Copyright 2017 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {TrackableVec3} from 'neuroglancer/trackable_vec3';\nimport {RefCounted} from 'neuroglancer/util/disposable';\nimport {vec3} from 'neuroglancer/util/geom';\nimport {verifyFiniteFloat} from 'neuroglancer/util/json';\nimport {Signal} from 'neuroglancer/util/signal';\n\nimport './vec3.css';\n\nexport class Vec3Widget extends RefCounted {\n  promptElement = document.createElement('span');\n  element = document.createElement('label');\n  inputx = document.createElement('input');\n  inputy = document.createElement('input');\n  inputz = document.createElement('input');\n  valueEntered = new Signal<(value: number) => void>();\n\n  constructor(public model: TrackableVec3) {\n    super();\n    let {inputx, inputy, inputz, element, promptElement} = this;\n\n    element.className = 'vec3-input-row';\n    promptElement.className = 'vec3-input-label';\n\n    element.appendChild(promptElement);\n\n    element.appendChild(inputx);\n    element.appendChild(inputy);\n    element.appendChild(inputz);\n\n    inputx.type = inputy.type = inputz.type = 'number';\n    this.updateInput();\n\n    const inputValueChanged = () => {\n      this.model.value = this.getVec3Values();\n    };\n    this.registerEventListener(inputx, 'change', inputValueChanged);\n    this.registerEventListener(inputy, 'change', inputValueChanged);\n    this.registerEventListener(inputz, 'change', inputValueChanged);\n\n    this.model.changed.add(() => {\n      this.updateInput();\n    });\n  }\n\n  getVec3Values(): vec3 {\n    let ret = vec3.create();\n    ret[0] = this.verifyValue(this.inputx.valueAsNumber);\n    ret[1] = this.verifyValue(this.inputy.valueAsNumber);\n    ret[2] = this.verifyValue(this.inputz.valueAsNumber);\n\n    return ret;\n  }\n\n  verifyValue(value: any) {\n    return verifyFiniteFloat(value);\n  }\n\n  updateInput() {\n    this.inputx.valueAsNumber = this.model.value[0];\n    this.inputy.valueAsNumber = this.model.value[1];\n    this.inputz.valueAsNumber = this.model.value[2];\n  }\n\n  disposed() {\n    let {inputx, inputy, inputz, element} = this;\n    if (inputx.parentElement) {\n      inputx.parentElement.removeChild(inputx);\n    }\n    if (inputy.parentElement) {\n      inputy.parentElement.removeChild(inputy);\n    }\n    if (inputz.parentElement) {\n      inputz.parentElement.removeChild(inputz);\n    }\n    if (element.parentElement) {\n      element.parentElement.removeChild(element);\n    }\n    super.disposed();\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google Inc.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {CANCELED, CancellationToken, CancellationTokenSource, makeCancelablePromise, uncancelableToken} from 'neuroglancer/util/cancellation';\nimport {RefCounted} from 'neuroglancer/util/disposable';\n\nexport type RPCHandler = (this: RPC, x: any) => void;\n\nexport type RpcId = number;\n\nconst IS_WORKER = !(typeof Window !== 'undefined' && self instanceof Window);\n\nconst DEBUG = false;\n\nconst DEBUG_MESSAGES = false;\n\nconst PROMISE_RESPONSE_ID = 'rpc.promise.response';\nconst PROMISE_CANCEL_ID = 'rpc.promise.cancel';\n\nvar handlers = new Map<string, RPCHandler>();\n\nexport function registerRPC(key: string, handler: RPCHandler) {\n  handlers.set(key, handler);\n}\n\nexport type RPCPromise<T> = Promise<{value: T, transfers?: any[]}>;\n\nexport class RPCError extends Error {\n  constructor(public name: string, public message: string) {\n    super(message);\n  }\n}\n\nexport function registerPromiseRPC<T>(\n    key: string,\n    handler: (this: RPC, x: any, cancellationToken: CancellationToken) => RPCPromise<T>) {\n  registerRPC(key, function(this: RPC, x: any) {\n    let id = <number>x['id'];\n    const cancellationToken = new CancellationTokenSource();\n    let promise = handler.call(this, x, cancellationToken) as RPCPromise<T>;\n    this.set(id, {promise, cancellationToken});\n    promise.then(\n        ({value, transfers}) => {\n          this.delete(id);\n          this.invoke(PROMISE_RESPONSE_ID, {'id': id, 'value': value}, transfers);\n        },\n        error => {\n          this.delete(id);\n          this.invoke(\n              PROMISE_RESPONSE_ID, {'id': id, 'error': error.message, 'errorName': error.name});\n        });\n  });\n}\n\nregisterRPC(PROMISE_CANCEL_ID, function(this: RPC, x: any) {\n  let id = <number>x['id'];\n  const request = this.get(id);\n  if (request !== undefined) {\n    let {cancellationToken} = request;\n    cancellationToken.cancel();\n  }\n});\n\nregisterRPC(PROMISE_RESPONSE_ID, function(this: RPC, x: any) {\n  let id = <number>x['id'];\n  let {resolve, reject} = this.get(id);\n  this.delete(id);\n  if (x.hasOwnProperty('value')) {\n    resolve(x['value']);\n  } else {\n    const errorName = x['errorName'];\n    if (errorName === CANCELED.name) {\n      reject(CANCELED);\n    } else {\n      reject(new RPCError(x['errorName'], x['error']));\n    }\n  }\n});\n\ninterface RPCTarget {\n  postMessage(message?: any, ports?: any): void;\n  onmessage: ((ev: MessageEvent) => any)|null;\n}\n\nconst INITIAL_RPC_ID = IS_WORKER ? -1 : 0;\n\nexport class RPC {\n  private objects = new Map<RpcId, any>();\n  private nextId: RpcId = INITIAL_RPC_ID;\n  constructor(public target: RPCTarget) {\n    target.onmessage = (e) => {\n      let data = e.data;\n      if (DEBUG_MESSAGES) {\n        console.log('Received message', data);\n      }\n      handlers.get(data.functionName)!.call(this, data);\n    };\n  }\n\n  get numObjects() {\n    return this.objects.size;\n  }\n\n  set(id: RpcId, value: any) {\n    this.objects.set(id, value);\n  }\n\n  delete(id: RpcId) {\n    this.objects.delete(id);\n  }\n  get(id: RpcId) {\n    return this.objects.get(id);\n  }\n  getRef<T extends SharedObject>(x: {'id': RpcId, 'gen': number}) {\n    let rpcId = x['id'];\n    let obj = <T>this.get(rpcId);\n    obj.referencedGeneration = x['gen'];\n    obj.addRef();\n    return obj;\n  }\n\n  invoke(name: string, x: any, transfers?: any[]) {\n    x.functionName = name;\n    if (DEBUG_MESSAGES) {\n      console.trace('Sending message', x);\n    }\n    this.target.postMessage(x, transfers);\n  }\n\n  promiseInvoke<T>(name: string, x: any, cancellationToken = uncancelableToken, transfers?: any[]):\n      Promise<T> {\n    return makeCancelablePromise<T>(cancellationToken, (resolve, reject, token) => {\n      const id = x['id'] = this.newId();\n      this.set(id, {resolve, reject});\n      this.invoke(name, x, transfers);\n      token.add(() => {\n        this.invoke(PROMISE_CANCEL_ID, {'id': id});\n      });\n    });\n  }\n  newId() {\n    return IS_WORKER ? this.nextId-- : this.nextId++;\n  }\n}\n\nexport class SharedObject extends RefCounted {\n  rpc: RPC|null = null;\n  rpcId: RpcId|null = null;\n  isOwner: boolean|undefined;\n  unreferencedGeneration: number;\n  referencedGeneration: number;\n\n  initializeSharedObject(rpc: RPC, rpcId = rpc.newId()) {\n    this.rpc = rpc;\n    this.rpcId = rpcId;\n    this.isOwner = false;\n    rpc.set(rpcId, this);\n  }\n\n  initializeCounterpart(rpc: RPC, options: any = {}) {\n    this.initializeSharedObject(rpc);\n    this.unreferencedGeneration = 0;\n    this.referencedGeneration = 0;\n    this.isOwner = true;\n    options['id'] = this.rpcId;\n    options['type'] = this.RPC_TYPE_ID;\n    rpc.invoke('SharedObject.new', options);\n  }\n\n  dispose() {\n    super.dispose();\n  }\n\n  /**\n   * Precondition: this.isOwner === true.\n   */\n  addCounterpartRef() {\n    return {'id': this.rpcId, 'gen': ++this.referencedGeneration};\n  }\n\n  protected refCountReachedZero() {\n    if (this.isOwner === true) {\n      if (this.referencedGeneration === this.unreferencedGeneration) {\n        this.ownerDispose();\n      }\n    } else if (this.isOwner === false) {\n      this.rpc!.invoke(\n          'SharedObject.refCountReachedZero', {'id': this.rpcId, 'gen': this.referencedGeneration});\n    } else {\n      super.refCountReachedZero();\n    }\n  }\n\n  /**\n   * Precondition: this.isOwner === true.\n   */\n  protected ownerDispose() {\n    if (DEBUG) {\n      console.log(`[${IS_WORKER}] #rpc object = ${this.rpc!.numObjects}`);\n    }\n    let {rpc, rpcId} = this;\n    super.refCountReachedZero();\n    rpc!.delete(rpcId!);\n    rpc!.invoke('SharedObject.dispose', {'id': rpcId});\n  }\n\n  /**\n   * Precondition: this.isOwner === true.\n   *\n   * This should be called when the counterpart's refCount is decremented and reaches zero.\n   */\n  counterpartRefCountReachedZero(generation: number) {\n    this.unreferencedGeneration = generation;\n    if (this.refCount === 0 && generation === this.referencedGeneration) {\n      this.ownerDispose();\n    }\n  }\n\n  /**\n   * Should be set to a constant specifying the SharedObject type identifier on the prototype of\n   * final derived owner classes.  It is not used on counterpart (non-owner) classes.\n   */\n  RPC_TYPE_ID: string;\n}\n\nexport function initializeSharedObjectCounterpart(obj: SharedObject, rpc?: RPC, options: any = {}) {\n  if (rpc != null) {\n    obj.initializeSharedObject(rpc, options['id']);\n  }\n}\n\n/**\n * Base class for defining a SharedObject type that will never be owned.\n */\nexport class SharedObjectCounterpart extends SharedObject {\n  constructor(rpc?: RPC, options: any = {}) {\n    super();\n    initializeSharedObjectCounterpart(this, rpc, options);\n  }\n}\n\n\nexport interface SharedObjectConstructor { new(rpc: RPC, options: any): SharedObjectCounterpart; }\n\nregisterRPC('SharedObject.dispose', function(x) {\n  let obj = <SharedObject>this.get(x['id']);\n  if (obj.refCount !== 0) {\n    throw new Error(`Attempted to dispose object with non-zero reference count.`);\n  }\n  if (DEBUG) {\n    console.log(`[${IS_WORKER}] #rpc objects: ${this.numObjects}`);\n  }\n  obj.disposed();\n  this.delete(obj.rpcId!);\n  obj.rpcId = null;\n  obj.rpc = null;\n});\n\nregisterRPC('SharedObject.refCountReachedZero', function(x) {\n  let obj = <SharedObject>this.get(x['id']);\n  let generation = <number>x['gen'];\n  obj.counterpartRefCountReachedZero(generation);\n});\n\nconst sharedObjectConstructors = new Map<string, SharedObjectConstructor>();\n\n/**\n * Register a class as a SharedObject owner type under the specified identifier.\n *\n * This is intended to be used as a decorator.\n */\nexport function registerSharedObjectOwner(identifier: string) {\n  return (constructorFunction: {prototype: {RPC_TYPE_ID: string}}) => {\n    constructorFunction.prototype.RPC_TYPE_ID = identifier;\n  };\n}\n\n/**\n * Register a class as a SharedObject counterpart type under the specified identifier.\n *\n * This is intended to be used as a decorator.\n *\n * Also register the type as a SharedObject owner, which is useful if this type is also used as a\n * SharedObject owner.\n */\nexport function registerSharedObject(identifier?: string) {\n  return (constructorFunction: SharedObjectConstructor) => {\n    if (identifier !== undefined) {\n      constructorFunction.prototype.RPC_TYPE_ID = identifier;\n    } else {\n      identifier = constructorFunction.prototype.RPC_TYPE_ID;\n      if (identifier === undefined) {\n        throw new Error('RPC_TYPE_ID should have already been defined');\n      }\n    }\n    sharedObjectConstructors.set(identifier, constructorFunction);\n  };\n}\n\nregisterRPC('SharedObject.new', function(x) {\n  let rpc = <RPC>this;\n  let typeName = <string>x['type'];\n  let constructorFunction = sharedObjectConstructors.get(typeName)!;\n  let obj = new constructorFunction(rpc, x);\n  // Counterpart objects start with a reference count of zero.\n  --obj.refCount;\n});\n"],"sourceRoot":""}